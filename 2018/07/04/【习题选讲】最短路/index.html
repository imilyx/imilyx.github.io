<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="1. [POJ3662]-Telephone Lines https://vjudge.net/problem/POJ-3662 题意：在无向图上求一条从 1 到 N 的路径，使得路径上第 K + 1 大的边权尽量小。 本题答案具有单调性，因为边权越大，合法的方案一定包含了边权更小的方案。所以我们可以二分答案，把问题转化为：是否存在一种合法的方案，使得第 K + 1 边权不超过 mid。 转">
<meta name="keywords" content="最短路">
<meta property="og:type" content="article">
<meta property="og:title" content="【习题选讲】最短路">
<meta property="og:url" content="http://yoursite.com/2018/07/04/【习题选讲】最短路/index.html">
<meta property="og:site_name" content="imily&#39;s notes">
<meta property="og:description" content="1. [POJ3662]-Telephone Lines https://vjudge.net/problem/POJ-3662 题意：在无向图上求一条从 1 到 N 的路径，使得路径上第 K + 1 大的边权尽量小。 本题答案具有单调性，因为边权越大，合法的方案一定包含了边权更小的方案。所以我们可以二分答案，把问题转化为：是否存在一种合法的方案，使得第 K + 1 边权不超过 mid。 转">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2020-12-13T11:04:40.312Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="【习题选讲】最短路">
<meta name="twitter:description" content="1. [POJ3662]-Telephone Lines https://vjudge.net/problem/POJ-3662 题意：在无向图上求一条从 1 到 N 的路径，使得路径上第 K + 1 大的边权尽量小。 本题答案具有单调性，因为边权越大，合法的方案一定包含了边权更小的方案。所以我们可以二分答案，把问题转化为：是否存在一种合法的方案，使得第 K + 1 边权不超过 mid。 转">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>【习题选讲】最短路</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    
    
</head>

<body>
    
      <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/posts/">Writing</a></li>
         
          <li><a href="http://github.com/sergodeeva">Projects</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/07/05/【习题选讲】最小生成树/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/07/04/[POJ1094]-Sorting It All Out/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/07/04/【习题选讲】最短路/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/07/04/【习题选讲】最短路/&text=【习题选讲】最短路"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/07/04/【习题选讲】最短路/&title=【习题选讲】最短路"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/07/04/【习题选讲】最短路/&is_video=false&description=【习题选讲】最短路"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=【习题选讲】最短路&body=Check out this article: http://yoursite.com/2018/07/04/【习题选讲】最短路/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/07/04/【习题选讲】最短路/&title=【习题选讲】最短路"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/07/04/【习题选讲】最短路/&title=【习题选讲】最短路"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/07/04/【习题选讲】最短路/&title=【习题选讲】最短路"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/07/04/【习题选讲】最短路/&title=【习题选讲】最短路"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/07/04/【习题选讲】最短路/&name=【习题选讲】最短路&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-POJ3662-Telephone-Lines"><span class="toc-number">1.</span> <span class="toc-text">1. [POJ3662]-Telephone Lines</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-CODEVS1173-最优贸易"><span class="toc-number">2.</span> <span class="toc-text">2. [CODEVS1173]-最优贸易</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-BZOJ2200-道路和航线"><span class="toc-number">3.</span> <span class="toc-text">3. [BZOJ2200]-道路和航线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-POJ1734-Sightseeing-trip"><span class="toc-number">4.</span> <span class="toc-text">4. [POJ1734]-Sightseeing trip</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-POJ3613-Cow-Relays"><span class="toc-number">5.</span> <span class="toc-text">5. [POJ3613]-Cow Relays</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        【习题选讲】最短路
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">imily's notes</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-07-04T09:56:40.000Z" itemprop="datePublished">2018-07-04</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/最短路/">最短路</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h3 id="1-POJ3662-Telephone-Lines"><a href="#1-POJ3662-Telephone-Lines" class="headerlink" title="1. [POJ3662]-Telephone Lines"></a>1. [POJ3662]-Telephone Lines</h3><hr>
<p><a href="https://vjudge.net/problem/POJ-3662" target="_blank" rel="noopener">https://vjudge.net/problem/POJ-3662</a></p>
<p>题意：在无向图上求一条从 1 到 N 的路径，使得路径上第 K + 1 大的边权尽量小。</p>
<p>本题答案具有单调性，因为边权越大，合法的方案一定包含了边权更小的方案。所以我们可以二分答案，把问题转化为：是否存在一种合法的方案，使得第 K + 1 边权不超过 mid。</p>
<p>转化后，需要把边权大于 mid 的边看作长度为 1 的边，其余看作长度为 0，然后求从 1 到 N 的最短路是否不超过 K 即可。</p>
<h3 id="2-CODEVS1173-最优贸易"><a href="#2-CODEVS1173-最优贸易" class="headerlink" title="2. [CODEVS1173]-最优贸易"></a>2. [CODEVS1173]-最优贸易</h3><hr>
<p><a href="http://codevs.cn/problem/1173/" target="_blank" rel="noopener">http://codevs.cn/problem/1173/</a></p>
<p>题意：在一张节点带有权值的图上找出一条从 1 到 N 的路径，使得路径上能够选出两个点 p，q（先经过 p 再经过 q），并且“节点 q 的权值减去节点 p 的权值”最大。</p>
<p>图中双向边可以看作两条有向边。我们可以另外建立一幅反图（图中所有边取反，例如原先 u 指向 v，反图中就是 v 指向 u），存在另一个邻接表中。</p>
<p>题中所求其实就是反着走的路上一个权值最大的点和正着走的路上一个权值最小的点。那么我们在正图中正着一遍最短路，反图中反着一遍最短路，求出 D[x] 表示节点 1 到节点 x 的所有路径中权值最小的权值，F[x] 表示节点 N 到节点 x 的所有路径中权值最大的权值。循环一遍求出最大的 F[x] - D[x] 即可。</p>
<h3 id="3-BZOJ2200-道路和航线"><a href="#3-BZOJ2200-道路和航线" class="headerlink" title="3. [BZOJ2200]-道路和航线"></a>3. [BZOJ2200]-道路和航线</h3><hr>
<p><a href="https://vjudge.net/problem/HYSBZ-2200" target="_blank" rel="noopener">https://vjudge.net/problem/HYSBZ-2200</a></p>
<p>题意：最短路，图中带有负权边。</p>
<p>那么只能用SPFA了。题测数据经过特殊构造，无法过。趁机学习一发SLF优化。</p>
<h3 id="4-POJ1734-Sightseeing-trip"><a href="#4-POJ1734-Sightseeing-trip" class="headerlink" title="4. [POJ1734]-Sightseeing trip"></a>4. [POJ1734]-Sightseeing trip</h3><hr>
<p><a href="https://vjudge.net/problem/POJ-1734" target="_blank" rel="noopener">https://vjudge.net/problem/POJ-1734</a></p>
<p>题意：给定一张无向图，求图中一个至少包含 3 个点的环，环上的节点不重复，并且环上的边的长度之和最小。该问题称为无向图的最小环问题。在本题中，你需要输出最小环的方案，若最小环不唯一，输出任意一个均可。若无解，输出“No solution.”。图中节点数不超过100.</p>
<p>不超过100，那么可以用 Floyd 啦。考虑 Floyd 算法，当外层循环 k 刚开始时，d[i, j] 保存着“经过编号不超过 k - 1 的节点”从 i 到 j 的最短路长度。</p>
<p>于是，</p>
<p>$$min_{1 \leq i &lt; j &lt; k} {d[i, j] + a[i, k] + a[k, j]}$$</p>
<p>就是满足以下两个条件的最小环长度：</p>
<ol>
<li>由编号不超过 k 的节点构成；</li>
<li>经过节点 k。</li>
</ol>
<p>上式中枚举的 i 和 j 都与 k 相邻，故以上结论成立。记录路径时可以用 vector。</p>
<h3 id="5-POJ3613-Cow-Relays"><a href="#5-POJ3613-Cow-Relays" class="headerlink" title="5. [POJ3613]-Cow Relays"></a>5. [POJ3613]-Cow Relays</h3><hr>
<p><a href="https://vjudge.net/problem/POJ-3613" target="_blank" rel="noopener">https://vjudge.net/problem/POJ-3613</a></p>
<p>题意：给定一张由 T (2 &lt;= T &lt;= 100) 条边构成的无向图，点的编号为 1 ～ 1000 之间的整数。求从起点 S 到起点 E 恰好经过 N (2 &lt;= N &lt;= 10^6) 的最短路。</p>
<p>虽然编号为 1 ～ 1000，但是边只有 100 条，我们使用离散化，把点的编号映射为 1 ～ P 的整数，其中 P &lt;= 2T。</p>
<p>若矩阵 $A^m$ 保存任意两点之间恰好经过 m 条边的最短路，则</p>
<p>$$(A^{r + m})[i, j] = min_{1 \leq k \leq P}{(A^r)[i, k] + (A^m)[k, j]}$$</p>
<p>其中 1 &lt;= i, j &lt;= P。</p>
<p>上式其实是矩阵乘法，我们用快速幂解决，只要将原来的乘法换为加法，原来的加法换为 min 运算。最后 $(A^N)[S, E]$ 即为本题答案。</p>
<p>时间复杂度 $O(T^3logN)$ 。</p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/posts/">Writing</a></li>
         
          <li><a href="http://github.com/sergodeeva">Projects</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-POJ3662-Telephone-Lines"><span class="toc-number">1.</span> <span class="toc-text">1. [POJ3662]-Telephone Lines</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-CODEVS1173-最优贸易"><span class="toc-number">2.</span> <span class="toc-text">2. [CODEVS1173]-最优贸易</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-BZOJ2200-道路和航线"><span class="toc-number">3.</span> <span class="toc-text">3. [BZOJ2200]-道路和航线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-POJ1734-Sightseeing-trip"><span class="toc-number">4.</span> <span class="toc-text">4. [POJ1734]-Sightseeing trip</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-POJ3613-Cow-Relays"><span class="toc-number">5.</span> <span class="toc-text">5. [POJ3613]-Cow Relays</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/07/04/【习题选讲】最短路/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/07/04/【习题选讲】最短路/&text=【习题选讲】最短路"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/07/04/【习题选讲】最短路/&title=【习题选讲】最短路"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/07/04/【习题选讲】最短路/&is_video=false&description=【习题选讲】最短路"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=【习题选讲】最短路&body=Check out this article: http://yoursite.com/2018/07/04/【习题选讲】最短路/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/07/04/【习题选讲】最短路/&title=【习题选讲】最短路"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/07/04/【习题选讲】最短路/&title=【习题选讲】最短路"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/07/04/【习题选讲】最短路/&title=【习题选讲】最短路"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/07/04/【习题选讲】最短路/&title=【习题选讲】最短路"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/07/04/【习题选讲】最短路/&name=【习题选讲】最短路&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2021 imily
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/posts/">Writing</a></li>
         
          <li><a href="http://github.com/sergodeeva">Projects</a></li>
        
      </ul>
    </nav>
  </div>
</footer><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>


    <!-- Google Analytics -->
    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-37473492-6', 'auto');
        ga('send', 'pageview');
    </script>




<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta property="og:type" content="website">
<meta property="og:title" content="imily&#39;s notes">
<meta property="og:url" content="http://yoursite.com/page/7/index.html">
<meta property="og:site_name" content="imily&#39;s notes">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="imily&#39;s notes">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/7/"/>





  <title> imily's notes </title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">imily's notes</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/01/ã€å­¦ä¹ ç¬”è®°ã€‘Boruvkaç®—æ³•/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/08/01/ã€å­¦ä¹ ç¬”è®°ã€‘Boruvkaç®—æ³•/" itemprop="url">
                  ã€å­¦ä¹ ç¬”è®°ã€‘Boruvkaç®—æ³•
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-08-01T10:12:40+08:00">
                2020-08-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>$Boruvka..Bvroukaâ€¦Brouvkaâ€¦.???$</p>
<p>$Boruvka$ æ˜¯ä¸€ä¸ªå¤è€çš„æœ€å°ç”Ÿæˆæ ‘ç®—æ³•ï¼Œç»¼åˆäº† $Kruskal$ å’Œ $Prim$.ï¼ˆæˆ‘è§‰å¾—æ›´åƒæ˜¯è¿›é˜¶ç‰ˆ $Prim$ï¼‰</p>
<p>å®ƒçš„ç®—æ³•æµç¨‹æ˜¯ï¼šåˆå§‹æ—¶æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªè¿é€šå—ï¼Œæ¯æ¬¡ä»<strong>æ¯ä¸ª</strong>å—ä¼¸å‡ºå»ä¸€æ¡æœ€çŸ­è¾¹ï¼Œç„¶åæŠŠæ–°å½¢æˆçš„è¿é€šå—ç¼©æˆä¸€ä¸ªæ–°çš„å—ã€‚æ¯æ¬¡ å—ä¸ªæ•°è‡³å°‘å‡åŠï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ˜¯ log çš„ã€‚ç®—æ³•æ­£ç¡®æ€§å¯ä»¥å‚è€ƒ $Prim$ çš„ï¼Œç›¸å½“äºæ¯æ¬¡æ‰©å±•å¤šæ£µå­æ ‘ã€‚</p>
<p>B <strong>åˆå¹¶åªæœ‰ log æ¬¡</strong>ï¼Œè¿™æ˜¯ K å’Œ P åšä¸åˆ°çš„ã€‚</p>
<p>é€šå¸¸å®ƒä½œä¸ºä¸€ç§<strong>æ€æƒ³</strong>ä¼šå¾ˆæœ‰ç”¨ï¼Œæ¯”å¦‚<strong>ä½è¿ç®—ç”Ÿæˆæ ‘</strong>ï¼Œé€šå¸¸æ˜¯è¾¹æƒéš¾ä»¥ç›´æ¥ç»´æŠ¤çš„ã€‚</p>
<h2 id="CF888G"><a href="#CF888G" class="headerlink" title="$[CF888G]$"></a>$[CF888G]$</h2><hr>
<p>é¢˜æ„ï¼šè¾¹ $&lt;i, j&gt;$ è¾¹æƒä¸º $a_i\ XOR\ a_j$ çš„æœ€å°ç”Ÿæˆæ ‘</p>
<p>è€ƒè™‘ $Trie$ æ ‘ï¼Œå…±æœ‰ $n - 1$ ä¸ª $LCA$ï¼ˆ$n - 1$ ä¸ªæœ‰ä¸¤ä¸ªå„¿å­çš„èŠ‚ç‚¹ï¼‰</p>
<p>æ ¹æ® B ç®—æ³•çš„<strong>æ€æƒ³</strong>ï¼Œï¼ˆå°†æ¯ä¸ªå­æ ‘è§†ä¸ºä¸€ä¸ªå—ï¼‰ï¼Œå®¹æ˜“å‘ç°è‹¥ $x$ åŒæ—¶æœ‰ $0/1$ å­æ ‘ï¼Œä¸¤ä¸ªå­æ ‘å°±ä¼šè¿è¾¹</p>
<p>éå† $Trie$ æ ‘ï¼Œåœ¨æ¯ä¸ª $LCA$ å¤„åšå¯å‘å¼åˆå¹¶ã€æŸ¥å·¦å³å­æ ‘è¿è¾¹çš„æœ€å°å€¼</p>
<h2 id="CF1305G"><a href="#CF1305G" class="headerlink" title="$[CF1305G]$"></a>$[CF1305G]$</h2><hr>
<p>é¢˜æ„ï¼šè¿è¾¹ $&lt;i, j&gt;$ è§„åˆ™ä¸º $a_i\ AND\ a_j = 0$ çš„æœ€å¤§ç”Ÿæˆæ ‘</p>
<p>æ³¨æ„åˆ°è¿™æ˜¯ä¸€æ£µæ ‘ï¼Œä¸”å®ƒçš„ç‰¹æ€§åœ¨äºï¼Œæ¯ä¸ªç‚¹çš„å…¥åº¦ä»…ä¸º 1.</p>
<p>äºæ˜¯æœ‰ä¸ªå¾ˆå¦™çš„æ–¹æ³•ï¼šå°†æ¯æ¡è¾¹æƒå€¼æ”¹ä¸º $a_i + a_j$ï¼Œæœ€ç»ˆç­”æ¡ˆæ˜¯è¾¹æƒå’Œ $- \sum{a_i}$ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±è½¬åŒ–æˆæœ€å¤§ç”Ÿæˆæ ‘ã€‚</p>
<p>$boruvka$ ç®—æ³•ç›´æ¥åšï¼Œæ¯ä¸€è½®å­é›† dp ç»´æŠ¤å‡ºæ¯ä¸ªäºŒè¿›åˆ¶é›†åˆå†…æœ€å¤§å’Œæ¬¡å¤§çš„ç‚¹æƒï¼Œ<strong>ä¸¤ä¸ªç‚¹æ‰€åœ¨é›†åˆä¸åŒ</strong>ï¼Œè¿™æ ·æŸ¥è¯¢çš„æ—¶å€™æŸ¥è¯¢è¡¥é›†ï¼Œå°±ç®—æœ€å¤§çš„ç‚¹æƒå’Œå½“å‰ç‚¹åœ¨åŒä¸€é›†åˆé‡Œï¼Œä¹Ÿèƒ½â€œæ’â€æ‰ï¼Œé€‰åˆ°æ¬¡å¤§ç‚¹ã€‚å¯ä»¥ç”¨ pair è®°å½• &lt;ç‚¹æƒï¼Œé›†åˆçš„id&gt;ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">10</span>, M = (<span class="number">1</span> &lt;&lt; <span class="number">18</span>);</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">int</span> n, a[N], fa[N], cnt;</span><br><span class="line">ll ans;</span><br><span class="line">pii mx[M][<span class="number">2</span>], cur[M];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fa[x] == x ? x : fa[x] = getfa(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    x = getfa(x), y = getfa(y);</span><br><span class="line">    <span class="keyword">if</span> (x == y) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    fa[x] = y;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]), fa[i] = i;</span><br><span class="line">        ans -= a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    cnt = n + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (cnt &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        rep(i, <span class="number">0</span>, M - <span class="number">1</span>)</span><br><span class="line">            rep(j, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">                mx[i][j] = make_pair(<span class="number">-1</span>, <span class="number">-1</span>);</span><br><span class="line">        rep(i, <span class="number">0</span>, n) &#123;</span><br><span class="line">            pii t = make_pair(a[i], getfa(i));</span><br><span class="line">            <span class="keyword">if</span> (mx[a[i]][<span class="number">0</span>] &lt; t) &#123;</span><br><span class="line">                <span class="keyword">if</span> (mx[a[i]][<span class="number">0</span>].se != t.se) mx[a[i]][<span class="number">1</span>] = mx[a[i]][<span class="number">0</span>];</span><br><span class="line">                mx[a[i]][<span class="number">0</span>] = t;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mx[a[i]][<span class="number">1</span>] &lt; t) &#123;</span><br><span class="line">                <span class="keyword">if</span> (mx[a[i]][<span class="number">0</span>].se != t.se) mx[a[i]][<span class="number">1</span>] = t;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i, <span class="number">0</span>, M - <span class="number">1</span>) &#123;</span><br><span class="line">            rep(j, <span class="number">0</span>, <span class="number">18</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i &amp; (<span class="number">1</span> &lt;&lt; j)) &#123;</span><br><span class="line">                    rep(k, <span class="number">0</span>, <span class="number">1</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (mx[i][<span class="number">0</span>] &lt; mx[i ^ (<span class="number">1</span> &lt;&lt; j)][k]) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (mx[i][<span class="number">0</span>].se != mx[i ^ (<span class="number">1</span> &lt;&lt; j)][k].se) mx[i][<span class="number">1</span>] = mx[i][<span class="number">0</span>];</span><br><span class="line">                            mx[i][<span class="number">0</span>] = mx[i ^ (<span class="number">1</span> &lt;&lt; j)][k];</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mx[i][<span class="number">1</span>] &lt; mx[i ^ (<span class="number">1</span> &lt;&lt; j)][k]) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (mx[i][<span class="number">0</span>].se != mx[i ^ (<span class="number">1</span> &lt;&lt; j)][k].se) mx[i][<span class="number">1</span>] = mx[i ^ (<span class="number">1</span> &lt;&lt; j)][k];</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i, <span class="number">0</span>, n)</span><br><span class="line">            cur[i] = make_pair(<span class="number">-1</span>, <span class="number">-1</span>);</span><br><span class="line">        rep(i, <span class="number">0</span>, n) &#123;</span><br><span class="line">            <span class="keyword">int</span> f = getfa(i);</span><br><span class="line">            <span class="keyword">int</span> t = ((M - <span class="number">1</span>) ^ a[i]);</span><br><span class="line">            <span class="keyword">if</span> (mx[t][<span class="number">0</span>].se != <span class="number">-1</span> &amp;&amp; mx[t][<span class="number">0</span>].se != f) &#123;</span><br><span class="line">                cur[f] = max(cur[f], make_pair(mx[t][<span class="number">0</span>].fi + a[i], mx[t][<span class="number">0</span>].se));</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mx[t][<span class="number">1</span>].se != <span class="number">-1</span> &amp;&amp; mx[t][<span class="number">1</span>].se != f) &#123;</span><br><span class="line">                cur[f] = max(cur[f], make_pair(mx[t][<span class="number">1</span>].fi + a[i], mx[t][<span class="number">1</span>].se));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i, <span class="number">0</span>, n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (fa[i] == i &amp;&amp; merge(i, cur[i].se)) &#123;</span><br><span class="line">                cnt--, ans += cur[i].fi;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>$O(2^{18} <em> 18 </em> logn)$</p>
<h2 id="UOJ176"><a href="#UOJ176" class="headerlink" title="$[UOJ176]$"></a>$[UOJ176]$</h2><hr>
<p>é¢˜æ„ï¼šè¾¹ $&lt;i, j&gt;$ è¾¹æƒä¸º $a_i\ AND\ a_j$ çš„æœ€å¤§ç”Ÿæˆæ ‘</p>
<p>é€šè¿‡ cf1305gï¼Œæˆ‘ä»¬ç§¯ç´¯äº†ä¸€å®šçš„ç»éªŒã€‚ç›´æ¥æƒ³åˆ° B ç®—æ³•ï¼Œç°åœ¨çš„é—®é¢˜å°±æ˜¯æ€ä¹ˆç»´æŠ¤ a &amp; b æœ€å¤§ã€‚</p>
<p>æšä¸¾å­é›†çš„è¯åº”è¯¥å¯ä»¥åšï¼Œä¸è¿‡æ˜¯ 3^18 çš„ï¼Ÿ</p>
<p>å†æƒ³æƒ³ trie æ ‘ï¼Œæˆ‘ä»¬å‘ç°è·Ÿ XOR ä¸åŒçš„æ˜¯ï¼Œ1 çš„è¯èµ° 1ï¼Œ0 çš„è¯èµ° 0/1 çš†å¯ï¼Œå¯è¿™æ ·çš„å¤æ‚åº¦æ˜¯ä¸å¯¹çš„å•Šï¼Œ$O(n<em>2^m</em>logn)$ ï¼</p>
<p>è¿™æ—¶åªè¦<strong>è‡ªåº•å‘ä¸Š</strong>ï¼ˆä¸ç„¶ä¼šå‡ºé—®é¢˜ï¼‰å°† 1 å­æ ‘åˆå¹¶åˆ° 0 å­æ ‘ä¸Šå°±å¥½äº†ï¼å°±å˜æˆäº† 1 èµ° 1ï¼Œ0 èµ° 0ï¼å¤æ‚åº¦å°±æ˜¯ $O((n + 2^m) * mlogn)$</p>
<p>å®ç°ç»†èŠ‚è·Ÿå‰ä¸€é¢˜ä¸€æ ·ï¼Œä¿ç•™ä¸¤ä¸ªæœ€å¤§çš„ idï¼Œä¿è¯â€œæ’â€æ‰è¿˜æœ‰ï¼ŒæŸ¥è¯¢çš„æ—¶å€™è¦æ±‚æ¯æ—¶æ¯åˆ»èµ°åˆ°çš„å­æ ‘éƒ½æœ‰ å’Œå½“å‰ç‚¹ä¸åœ¨åŒä¸€é›†åˆçš„ç‚¹</p>
<p>æ€»ä¹‹å°±æ˜¯èµ° ä¿è¯å­˜åœ¨åˆæ³•è§£çš„æœ€ä¼˜è·¯å¾„ï¼</p>
<p>ï¼ˆè¿˜æœ‰ä¸€ä¸ªå®Œå…¨ä¸åŒã€è€Œä¸”ç‰¹åˆ«ç®€å•æ˜“æ‡‚çš„<a href="http://vfleaking.blog.uoj.ac/blog/1244" target="_blank" rel="noopener">å¥½åŠæ³•</a>ï¼Œè¯¦è§ç®—æ³•ä¸ƒï¼‰</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>, M = <span class="number">8e6</span> + <span class="number">5</span>, inf = <span class="number">0x3f3f3f3f</span>;  <span class="comment">// æ— è¯­å­ğŸ˜“ M å¼€ 2 &lt;&lt; 18 å°± MLEï¼Œå¼€ 8e6 å°± ACã€‚ã€‚ã€‚</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">int</span> n, m, cnt, idx, rt, cas;</span><br><span class="line"><span class="keyword">int</span> a[N], fa[N], ch[M][<span class="number">2</span>], mx[M][<span class="number">2</span>];</span><br><span class="line">ll ans;</span><br><span class="line">pii cur[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fa[x] == x ? x : fa[x] = getfa(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x || !y) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (mx[x][<span class="number">0</span>] == mx[y][<span class="number">0</span>]) mx[x][<span class="number">1</span>] = max(mx[x][<span class="number">1</span>], mx[y][<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span> (mx[x][<span class="number">0</span>] &lt; mx[y][<span class="number">0</span>]) mx[x][<span class="number">1</span>] = max(mx[x][<span class="number">0</span>], mx[y][<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span> (mx[x][<span class="number">0</span>] &gt; mx[y][<span class="number">0</span>]) mx[x][<span class="number">1</span>] = max(mx[x][<span class="number">1</span>], mx[y][<span class="number">0</span>]);</span><br><span class="line">    mx[x][<span class="number">0</span>] = max(mx[x][<span class="number">0</span>], mx[y][<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">newnode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ++idx;</span><br><span class="line">    ch[idx][<span class="number">0</span>] = ch[idx][<span class="number">1</span>] = <span class="number">0</span>, mx[idx][<span class="number">0</span>] = mx[idx][<span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">return</span> idx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x || !y) <span class="keyword">return</span> x | y;</span><br><span class="line">    <span class="keyword">int</span> t = newnode();</span><br><span class="line">    ch[t][<span class="number">0</span>] = merge(ch[x][<span class="number">0</span>], ch[y][<span class="number">0</span>]);</span><br><span class="line">    ch[t][<span class="number">1</span>] = merge(ch[x][<span class="number">1</span>], ch[y][<span class="number">1</span>]);</span><br><span class="line">    upd(t, x), upd(t, y);</span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> dep)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep &lt; <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> ls = ch[x][<span class="number">0</span>], rs = ch[x][<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (ls) dfs(ls, dep - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (rs) dfs(rs, dep - <span class="number">1</span>);</span><br><span class="line">    ch[x][<span class="number">0</span>] = merge(ch[x][<span class="number">0</span>], ch[x][<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">unite</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    x = getfa(x), y = getfa(y);</span><br><span class="line">    <span class="keyword">if</span> (x == y) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    fa[x] = y;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> dep, <span class="keyword">int</span> val, <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x) x = ++idx;</span><br><span class="line">    <span class="keyword">if</span> (dep &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mx[x][<span class="number">0</span>] != id) &#123;</span><br><span class="line">            <span class="keyword">if</span> (mx[x][<span class="number">0</span>] &lt; id) mx[x][<span class="number">1</span>] = mx[x][<span class="number">0</span>], mx[x][<span class="number">0</span>] = id;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (mx[x][<span class="number">1</span>] &lt; id) mx[x][<span class="number">1</span>] = id;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> c = ((val &gt;&gt; dep) &amp; <span class="number">1</span>);</span><br><span class="line">    insert(ch[x][c], dep - <span class="number">1</span>, val, id);</span><br><span class="line">    mx[x][<span class="number">0</span>] = mx[x][<span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line">    upd(x, ch[x][<span class="number">0</span>]), upd(x, ch[x][<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">pii <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> dep, <span class="keyword">int</span> val, <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> make_pair(<span class="number">0</span>, (id == mx[x][<span class="number">0</span>] ? mx[x][<span class="number">1</span>] : mx[x][<span class="number">0</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> c = ((val &gt;&gt; dep) &amp; <span class="number">1</span>), ls = ch[x][<span class="number">0</span>], rs = ch[x][<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (c) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!rs || (id == mx[rs][<span class="number">0</span>] &amp;&amp; mx[rs][<span class="number">1</span>] == <span class="number">-1</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> query(ls, dep - <span class="number">1</span>, val, id);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            pii t = query(rs, dep - <span class="number">1</span>, val, id);</span><br><span class="line">            t.fi += (<span class="number">1</span> &lt;&lt; dep);</span><br><span class="line">            <span class="keyword">return</span> t;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> query(ls, dep - <span class="number">1</span>, val, id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">        fa[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    cnt = n;</span><br><span class="line">    <span class="keyword">while</span> (cnt &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        ++cas;</span><br><span class="line">        rep(i, <span class="number">0</span>, idx) &#123;</span><br><span class="line">            ch[i][<span class="number">0</span>] = ch[i][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">            mx[i][<span class="number">0</span>] = mx[i][<span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        idx = rt = <span class="number">0</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">            insert(rt, m, a[i], getfa(i));</span><br><span class="line">            cur[i] = make_pair(<span class="number">-1</span>, <span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        dfs(rt, m);</span><br><span class="line">        rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">            <span class="keyword">int</span> f = getfa(i);</span><br><span class="line">            pii t = query(rt, m, a[i], f);</span><br><span class="line">            cur[f] = max(cur[f], t);</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (fa[i] == i &amp;&amp; cur[i].se &gt; <span class="number">0</span> &amp;&amp; unite(i, cur[i].se)) &#123;</span><br><span class="line">                cnt--, ans += cur[i].fi;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/31/ã€è®¡åˆ’ã€‘20Jul AT&CF ç»ƒé¢˜æ±‡æ€»/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/07/31/ã€è®¡åˆ’ã€‘20Jul AT&CF ç»ƒé¢˜æ±‡æ€»/" itemprop="url">
                  20Jul CF&AT ç»ƒé¢˜æ±‡æ€»
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-07-31T23:59:59+08:00">
                2020-07-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="CF1039D"><a href="#CF1039D" class="headerlink" title="CF1039D"></a><a href="https://www.luogu.com.cn/problem/CF1039D" target="_blank" rel="noopener">CF1039D</a></h2><hr>
<p>æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹è‡³å¤šå±äºå…¶ä¸­ä¸€æ¡è·¯å¾„!!!</p>
<p>çœ‹åˆ°é¢˜ç›®ï¼šè¿™èƒ½åšï¼Ÿèƒ½åšï¼Ÿï¼Ÿèƒ½åšï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p>
<p>å¯¹ä¸èµ·ï¼Œç”¨æ ¹å·åˆ†æ²»å°±æ˜¯èƒ½åšï¼ˆçš®</p>
<ul>
<li>k &lt;= sqrt(n) çš„æš´åŠ›ç®—ï¼ŒO(nsqrt(n))</li>
<li>k &gt; sqrt(n) çš„ï¼Œå®¹æ˜“å‘ç°ç­”æ¡ˆä¸€å®šåœ¨ (0, sqrt(n)) çš„åŒºé—´å†…å•è°ƒä¸å¢ï¼Œæœ€å¤šåªæœ‰ sqrt(n) ç§ï¼Œæ‰€ä»¥å¯¹äºå½“å‰çš„ k äºŒåˆ†å‡ºä¸å®ƒç­”æ¡ˆç›¸åŒçš„æœ€å³ä½ç½®ï¼Œæ›´æ–°è¿™ä¸€æ®µçš„ç­”æ¡ˆ</li>
</ul>
<p>å¤æ‚åº¦ O(nsqrt(n)*logn)</p>
<p>HINTï¼šå¸¸æ•°å·¨å¤§ï¼Œæ™®é€š dfs é€’å½’ä¼š Tã€‚ã€‚è¦å…ˆå¤„ç† dfs åºç„¶åä»ä¸‹å¾€ä¸Š dpã€‚ã€‚ã€‚5070msã€‚ã€‚ã€‚</p>
<p>æ®è¯´èƒ½ç”¨æ•´ä½“äºŒåˆ†åšï¼Œå…ˆå’•å’•</p>
<h2 id="CF1039E"><a href="#CF1039E" class="headerlink" title="CF1039E"></a><a href="https://www.luogu.com.cn/problem/CF1039E" target="_blank" rel="noopener">CF1039E</a></h2><hr>
<p>LCT + åˆ†å—ï¼Œå…ˆå’•å’•</p>
<h2 id="CF455D"><a href="#CF455D" class="headerlink" title="CF455D"></a><a href="https://www.luogu.com.cn/problem/CF455D" target="_blank" rel="noopener">CF455D</a></h2><hr>
<p>æ“ä½œ 1 æ¯æ¬¡åªç§»åŠ¨ä¸¤ä½ï¼Œè€Œä¸”æ“ä½œ 2 è¯¢é—®çš„ä¿¡æ¯å¯åˆå¹¶ï¼Œå¯ä»¥ç”¨åˆ†å— + åŒç«¯é˜Ÿåˆ—ï¼ŒO(n <em> sqrt(n) </em> logn) cf ç¥è¯„æµ‹æœºå°±è·‘è¿‡å»äº†ï¼</p>
<h2 id="CF1045B"><a href="#CF1045B" class="headerlink" title="CF1045B"></a><a href="https://www.luogu.com.cn/problem/CF1045B" target="_blank" rel="noopener">CF1045B</a></h2><hr>
<p><a href="https://www.cnblogs.com/yyf0309/p/9808323.html" target="_blank" rel="noopener">é¢˜è§£</a></p>
<p>å¦™é¢˜ï¼Œå®¹æ˜“æƒ³åˆ° æ— æ³•æ„æˆçš„æ•°å¯ä»¥å…¨ç”¨ A ä¸­æˆ–å…¨ç”¨ B ä¸­çš„æ•°æ„æˆã€‚è®¾ä¸èƒ½æ„æˆçš„æ•°ä¸º tï¼ŒA ä¸­æ„æˆ t çš„æ•°ä¸º X å’Œ Yã€‚</p>
<p>ç”±æ¨¡çš„æ€§è´¨å¾—ï¼Œè‹¥ X &lt; t åˆ™ Y &lt; t, è‹¥ X &gt; t åˆ™ Y &gt; tï¼Œæ‰€ä»¥ä»»ä½•ä¸€ä¸ª t å°† A é›†åˆåˆ’ä¸ºä¸¤åŠï¼Œæ¯ä¸€éƒ¨åˆ†é¦–å°¾é…å¯¹åï¼Œæ¯å¯¹çš„å’Œéƒ½ç­‰äº t</p>
<p>å¦‚ä½•åˆ¤ 1 ~ i é¦–å°¾é…å¯¹çš„å€¼ç›¸åŒï¼Ÿè®¾ 1 &lt;= a &lt; b &lt; c &lt; d &lt;= i, è‹¥ a + d = b + c åˆ™ a - b = c - dï¼Œåšä¸€ä¸ªå·®åˆ†ç„¶åè·‘ manacher æˆ– hash åˆ¤å›æ–‡å°±å¥½äº†ï¼Œå¦™å•Šã€‚</p>
<h2 id="CF1249D2"><a href="#CF1249D2" class="headerlink" title="CF1249D2"></a><a href="https://www.luogu.com.cn/problem/CF1249D2" target="_blank" rel="noopener">CF1249D2</a></h2><hr>
<p>è´ªå¿ƒï¼Œæˆ‘çœŸçš„ä¸è¡Œã€‚ã€‚æŒ‰å·¦ç«¯ç‚¹æ’åºï¼Œä»å·¦å¾€å³æ‰«ï¼Œå¤§æ ¹å †ç»´æŠ¤å³ç«¯ç‚¹ï¼Œè‹¥å·¦ç«¯ç‚¹è¦†ç›–æ¬¡æ•°è¶…è¿‡ K åˆ™å¼¹å‡ºå †é¡¶çº¿æ®µ</p>
<h2 id="CF255E"><a href="#CF255E" class="headerlink" title="CF255E"></a><a href="https://www.luogu.com.cn/problem/CF255E" target="_blank" rel="noopener">CF255E</a></h2><hr>
<p>ç¬¬ä¸€æ¬¡æ„Ÿè§‰åšå¼ˆè®ºæ²¡é‚£ä¹ˆé«˜å†·å“ˆå“ˆå“ˆ</p>
<p>æ‰“å‡º 1e6 çš„è¡¨å‘ç° sg å€¼å¾ˆå°ï¼Œåªä¸º 0 ï½ 3ã€‚å°† a ä»å°åˆ°å¤§æ’åºï¼Œå°ºå–æ³•åšï¼ˆå°±æ˜¯åŒæŒ‡é’ˆä¸€æ ·çš„ï¼Œå·¦ç«¯ç‚¹æŒª+å³ç«¯ç‚¹æŒªï¼‰ã€‚</p>
<p>æˆ–è€…å¯ä»¥å‰ç¼€å’Œï¼Œè®°å½• sum(i, j) è¡¨ç¤º 1 ~ i å†… sg = j çš„ä¸ªæ•°ï¼Œè¿™æ ·å°±å¯ä»¥ O(1) ç®—ï¼ï¼</p>
<h2 id="CF280C"><a href="#CF280C" class="headerlink" title="CF280C"></a><a href="https://www.luogu.com.cn/problem/CF280C" target="_blank" rel="noopener">CF280C</a></h2><hr>
<p>ä¸€ä¸ªèŠ‚ç‚¹æœ‰è´¡çŒ® 1 ï¼Œå½“ä¸”ä»…å½“å®ƒåˆ°æ ¹çš„è·¯å¾„ä¸Šæ²¡æœ‰ç‚¹æŸ“é»‘ã€‚æ‰€ä»¥é€‰åˆ°å®ƒçš„æ¦‚ç‡æ˜¯ 1 / dep[x], æœŸæœ›æ˜¯ 1 * 1 / dep[x]ï¼Œè·Ÿé™¤ç¥–å…ˆä»¬å¤–çš„èŠ‚ç‚¹æ— å…³ï¼ˆå…¶ä»–ä¸äº§ç”Ÿå½±å“çš„å°±å¯ä»¥ä¸ç®¡äº†ï¼Œåæ­£å¯¹äºä¸€ä¸ªå±€éƒ¨æ¥è¯´å•¥éƒ½æ²¡å‘ç”Ÿï¼‰</p>
<h2 id="CF200A"><a href="#CF200A" class="headerlink" title="CF200A"></a><a href="https://www.luogu.com.cn/problem/CF200A" target="_blank" rel="noopener">CF200A</a></h2><hr>
<p>æš´åŠ›ä¼˜åŒ–ï¼Œéå¸¸ä¹‹å‰å®³</p>
<p>è€ƒè™‘å¤šæ¬¡è¯¢é—®ä¸€ä¸ªä½ç½®ï¼Œæš´åŠ›æŸ¥è¯¢çš„è¯ä¼šé‡å¤æŸ¥è¯¢ä¸€äº›è·ç¦»ï¼Œå¼€æ•°ç»„å­˜ä¸€ä¸‹å°±å¥½äº†ã€‚</p>
<p>æ¯æ¬¡è¯¢é—®æ—¶æ›´æ–°ï¼ŒO(èƒ½è¿‡) ç³»åˆ—ä½†çœŸçš„è·‘çš„å¾ˆå¿«ï¼</p>
<h2 id="CF208B"><a href="#CF208B" class="headerlink" title="CF208B"></a><a href="https://www.luogu.com.cn/problem/CF208B" target="_blank" rel="noopener">CF208B</a></h2><hr>
<p>n å¾ˆå°ï¼Œè®°å¿†åŒ–æœç´¢ã€‚æ³¨æ„åˆ°æ¯ä¸€ä½åªå—åç¬¬ä¸€ä½å’Œåç¬¬ä¸‰ä½å½±å“ï¼ŒçŠ¶æ€åªè¦è®°å½•è¿ç»­ä¸‰ä½ã€‚</p>
<h2 id="CF187D"><a href="#CF187D" class="headerlink" title="CF187D"></a><a href="https://www.luogu.com.cn/problem/CF187D" target="_blank" rel="noopener">CF187D</a></h2><hr>
<p>å‘ç°è¢«ä¸€ä¸ªçº¢ç¯å¡äº†åï¼Œä¹‹åçš„èŠ±è´¹éƒ½æ˜¯å¯ä»¥é¢„å¤„ç†çš„ï¼ˆæ±‚ä¸€ä¸‹æ¯ä¸ªç‚¹ä» 0 æ—¶åˆ»èµ°åˆ°ç»ˆç‚¹çš„æ—¶é—´ï¼‰ã€‚æŠŠ dist éƒ½ mod(g + r)ï¼Œé—®é¢˜å°±å˜æˆäº†æ±‚å³è¾¹æœ€è¿‘çš„ dist åœ¨ [g, r - 1] å†…çš„ä½ç½®ï¼Œæƒå€¼çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´æœ€å°å€¼</p>
<h2 id="CF190E"><a href="#CF190E" class="headerlink" title="CF190E"></a><a href="https://www.luogu.com.cn/problem/CF190E" target="_blank" rel="noopener">CF190E</a></h2><hr>
<p>å¤æ‚åº¦æ˜¯å…³äº m çš„ã€‚ã€‚é“¾è¡¨æˆ– set ä¼˜åŒ– bfsï¼Œæ¯ä¸ªç‚¹åªä¼šè¢«è®¿é—®åº¦æ•°æ¬¡ï¼Œå¤æ‚åº¦ O(mlogn)</p>
<h2 id="CF191E"><a href="#CF191E" class="headerlink" title="CF191E"></a><a href="https://www.luogu.com.cn/problem/CF191E" target="_blank" rel="noopener">CF191E</a></h2><hr>
<p>æ±‚ç¬¬ K å¤§è¿ç»­åŒºé—´çš„ val å’Œã€‚è€ƒè™‘äºŒåˆ†åˆ¤å®šï¼Œç¦»æ•£åŒ– + æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ã€‚</p>
<h2 id="CF185D"><a href="#CF185D" class="headerlink" title="CF185D"></a><a href="https://www.luogu.com.cn/problem/CF185D" target="_blank" rel="noopener">CF185D</a></h2><hr>
<p>å¾ˆå¥½çš„æ•°å­¦é¢˜</p>
<p>è®¾ $x = k^{2^l} + 1$</p>
<p>$k^{2^{l + 1}} + 1 = (x - 1)^2 + 1$</p>
<p>$gcd(x, (x - 1)^2 + 1) = gcd(x, x^2 - 2x + 1) = gcd(x, 2)$</p>
<ul>
<li>k ä¸ºå¥‡æ•°ï¼šans = $\frac{PROD}{2^{r - l}}$</li>
<li>k ä¸ºå¶æ•°ï¼šans = $PROD$</li>
</ul>
<p>æ ¹æ®ç­‰æ¯”æ•°åˆ—çš„çŸ¥è¯†ï¼Œ$PROD = \frac{(k^{2^{r + 1}} - 1)}{(k^{2^l} - 1)}$</p>
<h2 id="CF432D"><a href="#CF432D" class="headerlink" title="CF432D"></a><a href="https://www.luogu.com.cn/problem/CF432D" target="_blank" rel="noopener">CF432D</a></h2><hr>
<p><a href="https://ouuan.github.io/post/cf432d-prefixes-and-suffixeskmp/" target="_blank" rel="noopener">è®²å¾—å¥½çš„é¢˜è§£</a></p>
<p>KMP æ€§è´¨é¢˜ï¼Œf[nxt[i]] = 1 + sum{f[i]}</p>
<h2 id="CF1107F"><a href="#CF1107F" class="headerlink" title="CF1107F"></a><a href="https://www.luogu.com.cn/problem/CF1107F" target="_blank" rel="noopener">CF1107F</a></h2><hr>
<p>è´·æ¬¾æœ‰ä¸‰ç§ï¼šä¸ç”¨ï¼Œä»˜å®Œï¼Œæ²¡ä»˜å®Œ</p>
<p>è€ƒè™‘æ²¡ä»˜å®Œçš„è´·æ¬¾ï¼Œb å¤§çš„é åä¹°æ›´ä¼˜ï¼Œæ‰€ä»¥å¯ä»¥å…ˆå°† b ä»å¤§åˆ°å°æ’åº</p>
<p>f[i, j] è¡¨ç¤ºåœ¨å‰ i ä¸ªä¸­é€‰ï¼Œj ä¸ªæ²¡ä»˜å®Œçš„ C æœ€å¤§å€¼</p>
<h2 id="CF687C"><a href="#CF687C" class="headerlink" title="CF687C"></a><a href="https://www.luogu.com.cn/problem/CF687C" target="_blank" rel="noopener">CF687C</a></h2><hr>
<p>é—®èƒ½æ‹¼å‡ºå“ªäº›ï¼Œå°±æƒ³åˆ°äº† bitsetï¼šf[i, j] è¡¨ç¤ºå‰ i ä¸ªå…± j å…ƒèƒ½æ‹¼å‡ºçš„é›†åˆï¼Œf[i, j] = f[i - 1, j] | f[i - 1, j - c[i]] | (f[i - 1, j - c[i]] &lt;&lt; c[i])</p>
<h2 id="LightOJ1422"><a href="#LightOJ1422" class="headerlink" title="LightOJ1422"></a><a href="https://vjudge.net/problem/LightOJ-1422" target="_blank" rel="noopener">LightOJ1422</a></h2><hr>
<p>åŒºé—´ dpï¼Œf[l, r] = min(f[l + 1, r] + 1, (f[l + 1, i - 1] + 1) + (f[i, r] - 1)(å…¶ä¸­ c[l] = c[i]))</p>
<p>å°ç»†èŠ‚æ˜¯ f[i, r] - 1ï¼Œç”±äº i å¯èƒ½å¯¹ [i + 1, r] åŒé¢œè‰²çš„è¡£æœæœ‰å½±å“ï¼Œæ‰€ä»¥ä¸æ˜¯ f[i + 1, r]; ä½†è¦å‡å»é‡å¤ä¹°çš„é’±ã€‚</p>
<h2 id="CF840C"><a href="#CF840C" class="headerlink" title="CF840C"></a><a href="https://www.luogu.com.cn/problem/CF840C" target="_blank" rel="noopener">CF840C</a></h2><hr>
<p><a href="https://blog.csdn.net/can919/article/details/80154917" target="_blank" rel="noopener">å¥½çš„é¢˜è§£</a></p>
<p>å°†ç›¸ä¹˜ä¸ºå®Œå…¨å¹³æ–¹æ•°çš„æ•°æ”¾åœ¨åŒä¸€ç»„é‡Œï¼Œé—®é¢˜è½¬åŒ–æˆäº†ç»å…¸é—®é¢˜ï¼šæœ‰å¤šå°‘ä¸ªæ’åˆ—ä½¿å¾—ç›¸é‚»ä¸¤æ•°ä¸åœ¨åŒä¸€ç»„é‡Œã€‚</p>
<p>å®¹æ–¥ + dpï¼Œans = (è‡³å°‘ 0 ç›¸é‚»ç›¸åŒçš„æ–¹æ¡ˆæ•°) - (è‡³å°‘ 1 ç›¸é‚»ç›¸åŒçš„æ–¹æ¡ˆæ•°) + (è‡³å°‘ 2 ç›¸é‚»ç›¸åŒçš„æ–¹æ¡ˆæ•°) â€¦</p>
<p>dp[i, j] è¡¨ç¤ºå‰ i ç§æ•°åˆ†ä¸º j å—çš„æ–¹æ¡ˆæ•°ï¼ˆæ— åºï¼‰ï¼Œç›¸åŒå—ä¸­çš„æ•°ç›¸åŒã€‚å³è‡³å¤š j - 1 ä¸ç›¸åŒï¼Œå³è‡³å°‘ (n - 1) - (j - 1) = n - j ç›¸åŒã€‚</p>
<p>$dp[i, k] = \sum{ dp[i - 1, k - j] \times C(ni - 1, j - 1) \times \frac{n_i!}{j!} }$</p>
<p>é™¤ä»¥ j! è¡¨ç¤ºä½¿å—æ— åºï¼Œä¹˜ä»¥ n_i! è¡¨ç¤ºæ€»æ’åˆ—æ•°ï¼ˆè¿·æƒ‘ï¼‰</p>
<hr>
<p>updï¼š<a href="https://blog.csdn.net/qq_31759205/article/details/77487920" target="_blank" rel="noopener">å¦ä¸€å¥½çš„é¢˜è§£</a></p>
<p>è¿˜æ˜¯è¿™ä¸ªå¥½æ‡‚ä¸”æ­£å¸¸ğŸ‘</p>
<p>è½¬ç§»çš„æ—¶å€™æšä¸¾æŠŠå½“å‰é›†åˆåˆ†æˆå¤šå°‘æ®µï¼Œæœ‰å¤šå°‘æ®µæ’åœ¨ä¹‹å‰ç›¸åŒçš„ç›¸é‚»å…ƒç´ é—´</p>
<p>æ³¨æ„ç”±äº size ä¹‹å’Œæ˜¯ nï¼Œå¤æ‚åº¦ä¸æ˜¯ O(n^4) æ˜¯ O(n^3)</p>
<h2 id="CF15E"><a href="#CF15E" class="headerlink" title="CF15E"></a><a href="https://www.luogu.com.cn/problem/CF15E" target="_blank" rel="noopener">CF15E</a></h2><hr>
<p><a href="https://www.cnblogs.com/yyf0309/p/8418287.html" target="_blank" rel="noopener">é¢˜è§£é¢˜++ qwq</a></p>
<p>æ‰¾è§„å¾‹å®¹æ˜“å‘ç°ï¼šè·¯çº¿æ˜¯ä» H ä¸€ç›´æ²¿ç€è¾¹æ²¿æ–œçº¿èµ°ï¼Œæ‹ä¸€åœˆèµ°åˆ° H æ­£ä¸‹æ–¹ç¬¬ä¸€ä¸ªç‚¹å†æ‹ä¸€åœˆèµ°åˆ°å¦ä¸€æ–œçº¿ï¼Œèµ°å› Hã€‚</p>
<p>ä½†åé¢å°±ä¸çŸ¥é“æ€ä¹ˆåšäº†qaqï¼Ÿçœ‹å¤§ä½¬åšå®¢å§ã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/31/XJOI200731 é¢˜è§£/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/07/31/XJOI200731 é¢˜è§£/" itemprop="url">
                  XJOI200731 é¢˜è§£
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-07-31T13:58:40+08:00">
                2020-07-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><hr>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">æˆ‘ä»¿ä½›æ™ºéšœäº†= =</span></span><br><span class="line"><span class="comment">è¿™ä¸€çœ‹å°±å¾ˆå¯ä»¥é€’æ¨çš„æ ·å­å•Šï¼Œæ•°ä½ dp çœŸçš„ä¸æ˜¯å¾ˆéš¾ï¼Œæ˜¯æˆ‘æ•°ä½ dp å¤ªå¼±äº†</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>, N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line">ll T, K, l, r, f[<span class="number">2</span>][<span class="number">3</span>][<span class="number">65</span>], bit2[<span class="number">65</span>];</span><br><span class="line"><span class="comment">// f[0, ,] æ˜¯å·²ç»æœ‰ä¸€ä½å–å°ã€åé¢å°±æ²¡æœ‰é™åˆ¶çš„æ–¹æ¡ˆæ•°</span></span><br><span class="line"><span class="comment">// f[1, ,] æ˜¯å—/ä¸å—åˆ°æ•°ä½é™åˆ¶çš„æ€»æ–¹æ¡ˆæ•°</span></span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">sub</span><span class="params">(ll a, ll b)</span> </span>&#123; <span class="keyword">return</span> (a - b + mod) % mod; &#125;</span><br><span class="line"><span class="function">ll <span class="title">add</span><span class="params">(ll a, ll b)</span> </span>&#123; <span class="keyword">return</span> (a + b + mod) % mod; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    bit2[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        bit2[i] = bit2[i - <span class="number">1</span>] * <span class="number">2</span> % mod;</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">3</span>;  <span class="comment">// è¿™é‡Œçš„ 0 æ˜¯ (1 &lt;&lt; 0)ï¼Œä¹Ÿå°±æ˜¯ 1ï¼1 æœ‰ 3 ç§æ–¹æ¡ˆï¼ï¼ï¼</span></span><br><span class="line">    f[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">2</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        f[<span class="number">0</span>][<span class="number">0</span>][i] = (f[<span class="number">0</span>][<span class="number">0</span>][i - <span class="number">1</span>] + <span class="number">2</span> * f[<span class="number">0</span>][<span class="number">0</span>][i - <span class="number">1</span>]) % mod;</span><br><span class="line">        f[<span class="number">0</span>][<span class="number">1</span>][i] = (f[<span class="number">0</span>][<span class="number">1</span>][i - <span class="number">1</span>] + <span class="number">2</span> * f[<span class="number">0</span>][<span class="number">1</span>][i - <span class="number">1</span>] % mod + bit2[i] * f[<span class="number">0</span>][<span class="number">0</span>][i - <span class="number">1</span>] % mod) % mod;</span><br><span class="line">        f[<span class="number">0</span>][<span class="number">2</span>][i] = (f[<span class="number">0</span>][<span class="number">2</span>][i - <span class="number">1</span>] + <span class="number">2</span> * f[<span class="number">0</span>][<span class="number">2</span>][i - <span class="number">1</span>] % mod + <span class="number">2</span> * f[<span class="number">0</span>][<span class="number">1</span>][i - <span class="number">1</span>] % mod * bit2[i] % mod + bit2[i] * bit2[i] % mod * f[<span class="number">0</span>][<span class="number">0</span>][i - <span class="number">1</span>] % mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">calc</span><span class="params">(ll n, <span class="keyword">int</span> K)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!n) <span class="keyword">return</span> <span class="number">0</span>;  <span class="comment">// !!!</span></span><br><span class="line">    ll cnt = <span class="number">0</span>, x = n;</span><br><span class="line">    <span class="keyword">while</span> (x) x &gt;&gt;= <span class="number">1</span>, ++cnt;</span><br><span class="line">    f[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>] = (n &amp; <span class="number">1</span>) ? <span class="number">3</span> : <span class="number">1</span>;</span><br><span class="line">    f[<span class="number">1</span>][<span class="number">1</span>][<span class="number">0</span>] = (n &amp; <span class="number">1</span>) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">    f[<span class="number">1</span>][<span class="number">2</span>][<span class="number">0</span>] = (n &amp; <span class="number">1</span>) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, cnt) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((n &gt;&gt; i) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">            f[<span class="number">1</span>][<span class="number">0</span>][i] = (f[<span class="number">0</span>][<span class="number">0</span>][i - <span class="number">1</span>] + <span class="number">2</span> * f[<span class="number">1</span>][<span class="number">0</span>][i - <span class="number">1</span>] % mod) % mod;</span><br><span class="line">            f[<span class="number">1</span>][<span class="number">1</span>][i] = (f[<span class="number">0</span>][<span class="number">1</span>][i - <span class="number">1</span>] + <span class="number">2</span> * f[<span class="number">1</span>][<span class="number">1</span>][i - <span class="number">1</span>] % mod + bit2[i] * f[<span class="number">1</span>][<span class="number">0</span>][i - <span class="number">1</span>] % mod) % mod;</span><br><span class="line">            f[<span class="number">1</span>][<span class="number">2</span>][i] = (f[<span class="number">0</span>][<span class="number">2</span>][i - <span class="number">1</span>] + <span class="number">2</span> * f[<span class="number">1</span>][<span class="number">2</span>][i - <span class="number">1</span>] % mod + <span class="number">2</span> * f[<span class="number">1</span>][<span class="number">1</span>][i - <span class="number">1</span>] % mod * bit2[i] % mod + bit2[i] * bit2[i] % mod * f[<span class="number">1</span>][<span class="number">0</span>][i - <span class="number">1</span>] % mod) % mod;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            rep(j, <span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">                f[<span class="number">1</span>][j][i] = f[<span class="number">1</span>][j][i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[<span class="number">1</span>][K][cnt];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T &gt;&gt; K;</span><br><span class="line">    init(<span class="number">60</span>);</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;l, &amp;r);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, sub(calc(r, K), calc(l - <span class="number">1</span>, K)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><hr>
<p>è€ƒè™‘è´ªå¿ƒï¼Œä¸æ–­åˆå¹¶å¹³å‡å€¼æœ€å¤§çš„å—å’Œå®ƒçš„çˆ¶äº²æ‰€åœ¨è¿é€šå—ã€‚</p>
<p>è¯æ˜çš„è¯ï¼Œsum1 <em> num2 &lt; sum2 </em> num1, sum1 / num1 &lt; sum2 / num2ï¼ŒæŒ‰å¹³å‡å€¼ä»å¤§åˆ°å°æ’åºï¼Œå †ç»´æŠ¤ã€‚</p>
<p>è¿›é˜¶ç‰ˆçš„ poj-2054ï¼Œå¾ˆåƒ AGC023f-01 on treeï¼Œç»å…¸è´ªå¿ƒäº†ã€‚</p>
<p><strong>æ³¨æ„ï¼ï¼ï¼æˆ‘è‡ªå·±å†™çš„æ—¶å€™ç”¨äº†priority_queueï¼Œä½†å¯¹ sum å’Œ num çš„æ“ä½œå´æ˜¯åœ¨å¤–é¢åšçš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹pqæ²¡æœ‰ä¿®æ”¹ï¼è€Œä¸”è¿™æ ·è¿˜ç ´åäº†pqçš„ç»“æ„ï¼ï¼ï¼æœ€å WA æˆäº† 15ptsï¼ï¼ï¼ç—›å¿ƒ</strong> </p>
<p><strong>æ­£ç¡®çš„åšæ³•æ˜¯æ¯æ¬¡å°† fa ä»å †é‡Œå¼¹å‡ºæ¥ï¼Œå¯¹ fa çš„æ“ä½œåšå®Œåå† push ä¸€ä¸ªæ–°çš„ fa è¿›å»ã€‚ä¸ºäº†æ–¹ä¾¿æ‰§è¡Œâ€œå¼¹å‡ºæ“ä½œâ€ï¼Œæˆ‘ä»¬ç”¨ set ç»´æŠ¤ä¼˜å…ˆé˜Ÿåˆ—ã€‚</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line">ll n, rt, c[N], fa[N], num[N], sum[N], ans, fat[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nxt[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node &amp;a) <span class="keyword">const</span> &#123;</span><br><span class="line">        ll t2 = sum[id] * num[a.id], t1 = sum[a.id] * num[id];</span><br><span class="line">        <span class="keyword">return</span> t1 &lt; t2 || (t1 == t2 &amp;&amp; id &gt; a.id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">set</span>&lt;node&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> f)</span> </span>&#123;</span><br><span class="line">    fat[x] = f;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nxt[x].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = nxt[x][i];</span><br><span class="line">        <span class="keyword">if</span> (y == f) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(y, x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fa[x] == x ? x : fa[x] = getfa(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; rt;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;sum[i]);</span><br><span class="line">        num[i] = <span class="number">1</span>;</span><br><span class="line">        fa[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        nxt[x].push_back(y), nxt[y].push_back(x);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(rt, rt);</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> (i != rt) q.insert((node)&#123;i&#125;);</span><br><span class="line">    <span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.begin()-&gt;id;</span><br><span class="line">        q.erase(q.begin());</span><br><span class="line">        <span class="keyword">int</span> f = getfa(fat[x]);</span><br><span class="line">        q.erase((node)&#123;f&#125;);</span><br><span class="line">        ans += sum[x] * num[f];</span><br><span class="line">        sum[f] += sum[x], num[f] += num[x];</span><br><span class="line">        fa[x] = f;</span><br><span class="line">        <span class="keyword">if</span> (f != rt) q.insert((node)&#123;f&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans + sum[rt]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/30/ã€ä¹ é¢˜é€‰è®²ã€‘zzdã€ŠFFTå…¥é—¨ã€‹/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/07/30/ã€ä¹ é¢˜é€‰è®²ã€‘zzdã€ŠFFTå…¥é—¨ã€‹/" itemprop="url">
                  ã€ä¹ é¢˜é€‰è®²ã€‘zzdã€ŠFFTå…¥é—¨ã€‹
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-07-30T20:27:40+08:00">
                2020-07-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="å¥—è·¯1-å­—ç¬¦ä¸²åŒ¹é…"><a href="#å¥—è·¯1-å­—ç¬¦ä¸²åŒ¹é…" class="headerlink" title="å¥—è·¯1. å­—ç¬¦ä¸²åŒ¹é…"></a><strong>å¥—è·¯1. å­—ç¬¦ä¸²åŒ¹é…</strong></h1><hr>
<p>æˆ‘ä»¬å‘ç°åŒ¹é…çš„å­—ç¬¦å¯¹<strong>ä¸‹æ ‡ä¹‹å·®æ˜¯å®šå€¼</strong>ï¼Œç¿»è½¬å…¶ä¸­ä¸€ä¸ªä¸²ä»¥åå°±å˜æˆäº†ï¼ŒåŒ¹é…çš„å­—ç¬¦å¯¹<strong>ä¸‹æ ‡ä¹‹å’Œæ˜¯å®šå€¼</strong>ï¼Œè¿™æ˜¯æ»¡è¶³å·ç§¯å½¢å¼çš„ã€‚ï¼ˆå¥½å¦™å•ŠQAQï¼Œå·ç§¯å½¢å¼çœŸçš„ä¸‡èƒ½</p>
<h2 id="BZOJ4503"><a href="#BZOJ4503" class="headerlink" title="${[BZOJ4503]}$"></a>${[BZOJ4503]}$</h2><p>ä¸èƒ½ç›´æ¥ kmp å•Šï¼Œé€šé…ç¬¦çš„ fail æŒ‡é’ˆä¸å¥½å®šã€‚è€ƒè™‘å·ç§¯ã€‚</p>
<p>æˆ‘ä»¬å¸Œæœ›é€šè¿‡æŸä¸€ä½æ˜¯å¦ä¸º 0 æ¥åˆ¤æ–­èƒ½å¦åœ¨æŸä½åŒ¹é…ä¸Šã€‚å¯ä»¥è®©ç›¸åŒå­—ç¬¦å·®ä¸º 0ï¼Œåšä¸€ä¸ªå¹³æ–¹å°±ä¸ä¼šæœ‰â€œæ­£ + è´Ÿ = é›¶â€çš„æƒ…å†µå‘ç”Ÿã€‚</p>
<p>ä½†é€šé…ç¬¦æ€ä¹ˆæï¼Ÿå®ƒå¯ä»¥ä¸ä»»ä½•å­—ç¬¦é…å•Šã€‚æˆ‘ä»¬å¸Œæœ›æœ‰é€šé…ç¬¦å­˜åœ¨ å°±æ˜¯ 0ï¼Œé‚£ä¹ˆé€šé…ç¬¦å€¼ = 0ï¼Œä¹˜åˆ°æŸ¿å­é‡Œå»å°±å¥½äº†ã€‚</p>
<h3 id="sum-limits-i-1-n-sum-limits-j-1-m-S-i-T-j-2-S-i-T-j"><a href="#sum-limits-i-1-n-sum-limits-j-1-m-S-i-T-j-2-S-i-T-j" class="headerlink" title="$$\sum\limits_{i = 1}^n\sum\limits_{j = 1}^ m (S_i - T_j)^2 S_i T_j$$"></a>$$\sum\limits_{i = 1}^n\sum\limits_{j = 1}^ m (S_i - T_j)^2 S_i T_j$$</h3><p>è¿™ä¸ªä¸œè¥¿æ‹†å¼€æ¥ï¼Œåšä¸‰æ¬¡ FFTã€‚</p>
<h2 id="CF528D"><a href="#CF528D" class="headerlink" title="${[CF528D]}$"></a>${[CF528D]}$</h2><p>æŒ‰ç…§ä¸Šä¸€é¢˜çš„å¥—è·¯ï¼Œæˆ‘ä»¬è®¾ $f[i, c]$ è¡¨ç¤º $[A çš„ä½ç½® i åŒ¹é…å­—ç¬¦ c]$ï¼Œ$g[i, c]$ è¡¨ç¤º $[B çš„ä½ç½® i == c]$ã€‚ç›¸å‡ä¹‹ååšå¹³æ–¹ï¼Œè¿™ä¸ªä¸œè¥¿å±•å¼€å¤ªå›°éš¾äº†ï¼Œè€Œä¸”è¦åšå¾ˆå¤šæ¬¡ FFTï¼Œå¸¸æ•°çˆ†ç‚¸ï¼Œè€ƒè™‘åˆ«çš„æ–¹æ³•ã€‚</p>
<p>æ˜¾ç„¶ $f[i, c]$ å’Œ $g[i, c]$ åªæ˜¯ 0/1ï¼Œè‹¥ $A[i]$ èƒ½åŒ¹é…ä¸Š $B[j]$ï¼Œé‚£ä¹ˆå­˜åœ¨ä¸€ä¸ª $c$ï¼Œ$f[i, c] \times g[j, c] = 1$ã€‚</p>
<p>å‘ç°å­—ç¬¦é›†å¾ˆå°ï¼Œæˆ‘ä»¬åˆ†åˆ«å¯¹æ¯ç§å­—ç¬¦åšä¸€æ¬¡å·ç§¯ï¼Œè‹¥ä½ç½® i çš„å››ç§å€¼ä¹‹å’Œ == $|B|$ åˆ™ä½ç½® $i - |B| + 1$ å¯ä»¥åŒ¹é…ã€‚å¤æ‚åº¦$O(4nlogn)$.</p>
<h1 id="å¥—è·¯2-å·ç§¯å½¢å¼å˜å½¢"><a href="#å¥—è·¯2-å·ç§¯å½¢å¼å˜å½¢" class="headerlink" title="å¥—è·¯2. å·ç§¯å½¢å¼å˜å½¢"></a><strong>å¥—è·¯2. å·ç§¯å½¢å¼å˜å½¢</strong></h1><hr>
<p>å¸¸ç”¨æŠ€å·§æ˜¯ç¿»è½¬å’Œæ›´æ¢æ±‚å’ŒæŒ‡æ ‡ã€‚</p>
<h2 id="ZJOI2014-åŠ›"><a href="#ZJOI2014-åŠ›" class="headerlink" title="${[ZJOI2014]-åŠ›}$"></a>${[ZJOI2014]-åŠ›}$</h2><p>è‡ªå·±è¿˜æ¨äº†ä¸€éƒ¨åˆ†ï¼Œhh</p>
<p>è®¾ $F(i) = \frac{1}{i^2}$ï¼Œ$G(i) = q_i$ï¼Œä¸€äº›ä¸åˆæ³•çš„ä¸‹æ ‡ï¼Œå€¼ä¸º 0.</p>
<p>$$E(i) = (\sum\limits_{j = 0}^iF(j) \times G(i - j)) - (\sum\limits_{j = i}^m F(j - i) \times G(j))$$</p>
<p>ç¬¬ä¸€ä¸ªæ‹¬å·é‡Œæ˜¯è£¸çš„å·ç§¯å½¢å¼ï¼Œç¬¬äºŒä¸ªæ‹¬å·è¦å†åšä¸€åšã€‚</p>
<p>æ›´æ¢æ±‚å’ŒæŒ‡æ ‡ï¼š</p>
<p>$$\sum\limits_{j = 0}^{m - i} F(j) \times G(j + i)$$</p>
<p>ç¿»è½¬ï¼šï¼ˆå…¶ä¸­ $G^r(i)$ è¡¨ç¤º $G(m - i)$ï¼‰</p>
<p>$$\sum\limits_{j = 0}^{m - i} F(j) \times G^r(m - i - j)$$</p>
<h1 id="å¥—è·¯3-èƒŒåŒ…é—®é¢˜ç›¸å…³"><a href="#å¥—è·¯3-èƒŒåŒ…é—®é¢˜ç›¸å…³" class="headerlink" title="å¥—è·¯3. èƒŒåŒ…é—®é¢˜ç›¸å…³"></a><strong>å¥—è·¯3. èƒŒåŒ…é—®é¢˜ç›¸å…³</strong></h1><hr>
<h2 id="CF286E-Ladiesâ€™-Shop"><a href="#CF286E-Ladiesâ€™-Shop" class="headerlink" title="${[CF286E]-Ladiesâ€™\ Shop}$"></a>${[CF286E]-Ladiesâ€™\ Shop}$</h2><p>æ¯”è¾ƒè‡ªç„¶çš„æƒ³æ³•ï¼Œf[a[i]] = 1ï¼Œf[0] = 1ï¼Œf ä¸è‡ªå·±åšå·ç§¯ï¼Œåšæœ€å¤š m æ¬¡å°±å¾—åˆ°äº†æ‰€æœ‰èƒ½è¡¨ç¤ºçš„æ•°ã€‚ä½†è¿™æ ·æ˜¯ O(m log^2 m)çš„ã€‚</p>
<p>ä½†å…¶å®å¹¶ä¸ç”¨åš m æ¬¡ã€‚å®é™…ä¸Šä¸€æ¬¡å·ç§¯å°±èƒ½å¾—å‡ºç­”æ¡ˆã€‚</p>
<p>ä¸€æ¬¡å·ç§¯åï¼Œé‚£äº› f[i] &gt; 2 çš„ i å°±æ˜¯å¯ä»¥çœç•¥çš„ã€‚ä¸ºä»€ä¹ˆï¼Ÿåˆå§‹ä¸€æ¬¡ï¼Œf[i] ä¸ f[0] ç›¸ä¹˜ä¸€æ¬¡ï¼Œè¿˜æœ‰å…¶ä»–èƒ½ç»„æˆ i çš„æ•°å­—çš„è´¡çŒ®â€¦ åè¿‡æ¥è¯´ï¼Œf[i] = 2 çš„ i å°±æ˜¯å¿…é€‰çš„ã€‚</p>
<h1 id="å¥—è·¯4-åˆ†æ²»FFT"><a href="#å¥—è·¯4-åˆ†æ²»FFT" class="headerlink" title="å¥—è·¯4. åˆ†æ²»FFT"></a><strong>å¥—è·¯4. åˆ†æ²»FFT</strong></h1><hr>
<p>ï¼ˆå¥½éš¾å•Š QAQ æˆ‘æ²¡æœ‰è„‘å­ï¼‰</p>
<h2 id="Lydsy1704æœˆèµ›-äºŒå…ƒè¿ç®—"><a href="#Lydsy1704æœˆèµ›-äºŒå…ƒè¿ç®—" class="headerlink" title="${[Lydsy1704æœˆèµ›]-äºŒå…ƒè¿ç®—}$"></a>${[Lydsy1704æœˆèµ›]-äºŒå…ƒè¿ç®—}$</h2><p>å…ˆä¸è€ƒè™‘æ‹¬å·é‡Œçš„é™åˆ¶ã€‚åŠ æ³•å¯ä»¥ç›´æ¥ç®—ï¼Œå‡æ³•è¦å˜ä¸€ä¸‹ï¼š</p>
<p>$$ans_k = \sum\limits_{i = k}^n a_i \times b_{i - k}$$</p>
<p>$$ans_k = \sum\limits_{i = 0}^{n - k} a_{i + k} \times b_i$$</p>
<p>ç¿»è½¬ï¼Œå†å°† ans ä¸‹æ ‡åŠ  nï¼Œå‡‘ä¸€ä¸ªå·ç§¯å½¢å¼ï¼š</p>
<p>$$ans_{n + k} = \sum\limits_{i = 0}^{n - k}a_{i + k} \times b_{n - i}^r$$</p>
<p>è€ƒè™‘æ‹¬å·é‡Œçš„é™åˆ¶ï¼Œå®¹æ˜“å‘ç°åœ¨å€¼åŸŸä¸Šï¼Œå·¦åŒºé—´å¯¹å³åŒºé—´ä¸€å®šæœ‰è´¡çŒ®ï¼Œäºæ˜¯æƒ³åˆ°<strong>åˆ†æ²»å€¼åŸŸ</strong>ã€‚å…·ä½“æ¥è¯´ï¼Œå¯¹äºæ¯ä¸ªæ•°å€¼åŒºé—´ [l, r]ï¼š</p>
<ul>
<li>$x = y$: è´¡çŒ®ç»™ $0$</li>
<li>$x &lt; y$: $a[l, mid]$ å· $b[mid + 1, r]$</li>
<li>$x &gt; y$: $a[mid + 1, r]$ å· $b[l, mid]$</li>
</ul>
<p>ï¼ˆæˆ‘ä»Šå¤©æ‰çŸ¥é“åœ¨é€’å½’è¿‡ç¨‹ä¸­è®¡ç®—ä¸€ä¸ªå­é—®é¢˜å¯¹å¦ä¸€ä¸ªå­é—®é¢˜çš„è´¡çŒ®çš„åˆ†æ²»å°±å« CDQ åˆ†æ²»ï¼Ÿï¼Ÿï¼Ÿï¼‰</p>
<h2 id="CF553E-Kyoya-and-Train"><a href="#CF553E-Kyoya-and-Train" class="headerlink" title="${[CF553E]-Kyoya\ and\ Train}$"></a>${[CF553E]-Kyoya\ and\ Train}$</h2><p>ä¹ä¸€çœ‹æ›´åƒæ˜¯ dp é¢˜ï¼Œäºæ˜¯è€ƒè™‘ dpï¼š$f[i, j]$ è¡¨ç¤ºåˆ° $i$ ä½ç½®è€—æ—¶ $j$ çš„æœ€å°æœŸæœ›ä»£ä»·ï¼Œ$f[x, t] = min{c(x, y) + f[y, t + k] \times P_{e, k}}$ï¼Œå…¶ä¸­ P è¡¨ç¤ºç»è¿‡ e è¾¹è€—æ—¶ k çš„æ¦‚ç‡ã€‚</p>
<p>æ³¨æ„åˆ°åé¢é‚£å¨ä¸œè¥¿å¯ä»¥ç¿»è½¬å˜æˆå·ç§¯å½¢å¼ï¼Œç„¶åè¿™ç©æ„å°±æ˜¯åˆ†æ²» FFT å•¦ï¼Œåˆ†æ²»æ—¶é—´ï¼Œå¯¹äº $[l, r]$ å…ˆåš $[mid, r]$ å†åš $[l, mid)$ã€‚å¤æ‚åº¦ $O(mTlog^2T)$.</p>
<h1 id="æ‚é¢˜"><a href="#æ‚é¢˜" class="headerlink" title="æ‚é¢˜"></a><strong>æ‚é¢˜</strong></h1><hr>
<h2 id="BZOJ3160-ä¸‡å¾„äººè¸ªç­"><a href="#BZOJ3160-ä¸‡å¾„äººè¸ªç­" class="headerlink" title="${[BZOJ3160]-ä¸‡å¾„äººè¸ªç­}$"></a>${[BZOJ3160]-ä¸‡å¾„äººè¸ªç­}$</h2><p>æˆ‘ä»¬å…ˆå¿½ç•¥æ¡ä»¶ 2ï¼Œæœ€åå‡å»æ¡ä»¶ 2 çš„å°±å¥½äº†ï¼ˆç”¨ manacher ç®—ï¼‰</p>
<p>æŒ‰ç…§æœ´ç´ çš„è§£æ³•ï¼Œå±•å¼€åšå¤šæ¬¡ FFT ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œç„¶è€Œè¿˜æœ‰æ›´ç®€ä¾¿çš„æ–¹æ³•ã€‚è€ƒè™‘<strong>åªæœ‰ a å’Œ b</strong>ï¼Œåˆ†å¼€æ¥åšå†åŒä¸€ä½ç½®çš„ç›¸ä¹˜ï¼Œæ­£ç¡®æ€§æ˜¾ç„¶ã€‚</p>
<h2 id="Cerc2015-Frightful-Formula"><a href="#Cerc2015-Frightful-Formula" class="headerlink" title="${[Cerc2015]-Frightful\ Formula}$"></a>${[Cerc2015]-Frightful\ Formula}$</h2><p>é¦–å…ˆå‡è£…å·²ç»çŸ¥é“è¿™æ˜¯ FFT é¢˜ï¼ç„¶åå¿«ä¹æ¨æŸ¿å­ã€‚æ˜¾ç„¶ç­”æ¡ˆåªåˆ†ä¸º $(i, 1)/(1, i)$ åˆå§‹å€¼çš„è´¡çŒ® å’Œ $(i, j)$ é¢å¤–åŠ ä¸Šçš„ $c$ çš„è´¡çŒ®ã€‚</p>
<p>$(i, 1)/(1, i)$:</p>
<p>$$\sum\limits_{i = 1}^n C(n - i + n - 1, n - i)\times  a^{n - i} b^{n - 1}$$</p>
<p>$(i, j)$:</p>
<p>$$\sum\limits_{i = 2}^n \sum\limits_{j = 2}^n C(n - i + n - j, n - i) \times a^{n - i} b^{n - j} c$$</p>
<p>è®¾ $A_i = \frac{a^{n - i}}{(n - i)!}$, $B_i = \frac{b^{n - i}}{(n - i)!}$:</p>
<p>$$c\sum\limits_{i = 2}^n \sum\limits_{j = 2}^n (2n - i - j)! \times A_iB_j$$</p>
<p>æšä¸¾ i + j:</p>
<p>$$c\sum\limits_{i = 4}^{2n} (2n - i)! \sum\limits_{j = 2}^{i - 2} A_jB_{i - j}$$</p>
<p>è¿™å°±æ˜¯å·ç§¯å½¢å¼äº†ã€‚</p>
<h2 id="Hnoi2017-ç¤¼ç‰©"><a href="#Hnoi2017-ç¤¼ç‰©" class="headerlink" title="${[Hnoi2017]-ç¤¼ç‰©}$"></a>${[Hnoi2017]-ç¤¼ç‰©}$</h2><p>æˆ‘ä»¬è®¾å¾—åˆ°åºåˆ—ä¸º a å’Œ bï¼Œè®¾ç»™ a æ¯ä¸€ä½åŠ  c</p>
<p>$$ans = \sum (a_i + c - b_i)^2$$</p>
<p>$$ans = \sum a_i^2 + \sum b_i^2 + n \times c^2 + 2c \times (\sum a_i - \sum b_i) - 2 \sum a_ib_i$$</p>
<p>å’Œ c æœ‰å…³çš„é¡¹å¯ä»¥æšä¸¾æˆ–ç”¨äºŒæ¬¡å‡½æ•°æ±‚æå€¼ï¼Œæœ€åä¸€é¡¹ç”¨å·ç§¯æ±‚ï¼Œè€ƒè™‘æ€ä¹ˆæï¼Œæ˜¾ç„¶å°† a ç¿»è½¬åå¤åˆ¶ä¸€ä»½å°±å¥½å•¦ã€‚</p>
<h2 id="CF958F3-Lightsabers-hard"><a href="#CF958F3-Lightsabers-hard" class="headerlink" title="${[CF958F3]-Lightsabers(hard)}$"></a>${[CF958F3]-Lightsabers(hard)}$</h2><p>æŠŠæ¯ç§é¢œè‰²èƒ½é€‰çš„ 01 ç”Ÿæˆå‡½æ•°ä¹˜èµ·æ¥ï¼Œæœ´ç´ åšæ³•ä¼š TLEï¼Œè€ƒè™‘<strong>å¯å‘å¼åˆå¹¶</strong>ï¼Œå † + vector ç»´æŠ¤ã€‚$O(nlog^2n)$</p>
<p>ï¼ˆåˆ†æ²»ä¹Ÿèƒ½åšï¼</p>
<h2 id="CF623E-Transforming-Sequence"><a href="#CF623E-Transforming-Sequence" class="headerlink" title="${[CF623E]-Transforming\ Sequence}$"></a>${[CF623E]-Transforming\ Sequence}$</h2><p>æ˜¾ç„¶ $n &gt; k$ çš„æ—¶å€™æ— è§£ã€‚</p>
<p>å®¹æ˜“å‘ç°è·Ÿæ•°å€¼å…·ä½“å¤§å°æ²¡æœ‰å…³ç³»ï¼Œå…³é”®æ˜¯æ¯æ¬¡éƒ½æœ‰<strong>æ–°çš„äºŒè¿›åˆ¶ä½è¢«å¡«ä¸Š</strong>ã€‚</p>
<p>å°æ•°æ®çš„è¯å¯ä»¥ dpï¼Œ$f[i, j]$ è¡¨ç¤ºå‰ $i$ ä¸ªæ•°æœ‰ $j$ ä¸ªäºŒè¿›åˆ¶ä½ä¸º $1$ï¼Œè½¬ç§» $f[i, j] = \sum\limits_{k = 0}^{j - 1} f[i - 1, k] \times 2^k \times C(j, k)$ï¼Œå…¶ä¸­ $2^k$ è¡¨ç¤ºåŸæ¥å·²æœ‰çš„å¯æ”¾å¯ä¸æ”¾ã€‚</p>
<p>è€ƒè™‘ä¼˜åŒ–ï¼š</p>
<p>$$\frac{f[i, j]}{j!} = \sum\limits_k \frac{f[i - 1, k] \times 2^k}{k!} \times \frac{1}{(j - k)!}$$</p>
<p>è¿™æ ·æ˜¯ $O(n^2 log n)$ çš„ï¼Œç„¶åæˆ‘å°±æƒ³ä¸å‡ºäº†ã€‚ã€‚ä½†è¿˜èƒ½ä¼˜åŒ–ï¼ï¼è€ƒè™‘åˆ°è¿™æ ·ä¸€æ¬¡ä¸€æ¬¡è½¬ç§»å¤ªæ…¢äº†ï¼Œæˆ‘ä»¬<strong>åŠ å¤§è½¬ç§»çš„æ­¥é•¿</strong>ï¼Œå€å¢ï¼Œåˆå¹¶æ¯æ®µçš„ dp å€¼ï¼Œç›¸å½“äº dp[n &amp; (2 ^ 0)] å· dp[n &amp; (2 ^ 1)] â€¦ å·dp[n &amp; (2 ^ æœ€é«˜ä½)]ï¼Œè¿™æ ·å°±èƒ½åœ¨ $O(k log^2 k)$ çš„æ—¶é—´å¤æ‚åº¦å†…æ±‚å‡ºäº†ã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/30/ã€ä¹ é¢˜é€‰è®²ã€‘Jcvbã€Šç»„åˆè®¡æ•°é—®é¢˜ã€‹/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/07/30/ã€ä¹ é¢˜é€‰è®²ã€‘Jcvbã€Šç»„åˆè®¡æ•°é—®é¢˜ã€‹/" itemprop="url">
                  Jcvbã€Šç»„åˆè®¡æ•°é—®é¢˜ã€‹é¢˜è§£
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-07-30T18:25:40+08:00">
                2020-07-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>ç»„åˆæ•°ã€stirlingæ•°</li>
<li>ç”Ÿæˆå‡½æ•° + FFT/NTT</li>
<li>ä¸€äº›ç‰¹å®šçš„ç»“è®ºï¼ˆçŸ©é˜µæ ‘ï¼Œburnsideï¼Œpruferâ€¦ï¼‰</li>
<li>ä¸€äº›æ€æƒ³ï¼ˆå®¹æ–¥ã€è¡¥é›†è½¬åŒ–ï¼‰</li>
</ul>
<p>éƒ½æ˜¯å¸¸ç”¨çš„æŠ€å·§ï¼</p>
<p>DP æ¯é“éƒ½æ˜¯å§ qvq å¤ªé‡è¦äº†ï¼Œæœ‰æ—¶ç”¨ FFT/NTT åŠ é€Ÿã€‚</p>
<h2 id="TC12004-SetAndSet"><a href="#TC12004-SetAndSet" class="headerlink" title="$[TC12004]-SetAndSet$"></a><a href="https://vjudge.net/problem/Topcoder-12004" target="_blank" rel="noopener">$[TC12004]-SetAndSet$</a></h2><hr>
<p>æŒ‰ä½è€ƒè™‘ã€‚</p>
<p>è‹¥å¯¹äºæŸä¸€ä½ï¼Œå­˜åœ¨ä¸€ä¸ªæ•°å½“å‰ä½ä¸º 0ï¼Œåˆ™è¿™ä¸€ä½ä¸º 0 çš„æ•°ä¸èƒ½å…¨åœ¨ä¸€è¾¹ã€‚</p>
<p>ä¸èƒ½å…¨åœ¨ä¸€è¾¹ å°±å¾ˆéš¾åšï¼Œè€ƒè™‘<strong>è¡¥é›†è½¬åŒ–</strong>ï¼Œè®¡ç®— å…¨åœ¨ä¸€è¾¹ çš„ã€‚æˆ‘ä»¬å‘ç°è¿™æ ·ä¼šç®—é‡ï¼Œå‡†ç¡®æ¥è¯´ç®—çš„æ˜¯â€œè‡³å°‘æœ‰å‡ ä½ä¸åŒâ€ã€‚</p>
<p>è€ƒè™‘<strong>å®¹æ–¥æ€æƒ³</strong>ï¼Œç­”æ¡ˆ = æ€»æ•° - è‡³å°‘ 1 ä½ä¸åŒ + è‡³å°‘ 2 ä½ä¸åŒ - â€¦</p>
<p>ç”¨ dfs æšä¸¾ï¼Œå¹¶æŸ¥é›†ç»´æŠ¤å³å¯ï¼Œå°†æšä¸¾ä½ä¸º 0 çš„å¹¶åˆ°ä¸€å—å„¿å»ã€‚</p>
<h2 id="BZOJ1471-ä¸ç›¸äº¤è·¯å¾„"><a href="#BZOJ1471-ä¸ç›¸äº¤è·¯å¾„" class="headerlink" title="$[BZOJ1471]-ä¸ç›¸äº¤è·¯å¾„$"></a>$[BZOJ1471]-ä¸ç›¸äº¤è·¯å¾„$</h2><hr>
<p>ä¸ç›¸äº¤éš¾åšï¼Œç›¸äº¤å¥½åšã€‚è€ƒè™‘<strong>å®¹æ–¥</strong>ç¬¬ä¸€ä¸ªç›¸äº¤çš„ç‚¹ã€‚è®¡ç®—æ€»æ–¹æ¡ˆæ•°çš„æ—¶å€™ç”¨åˆ°äº†æ‹“æ‰‘åºï¼ˆè·¯å¾„ä¸Šæ’åœ¨ x å‰é¢çš„ç‚¹ yï¼Œæ‹“æ‰‘åºä¸€å®šæ¯” x å°ï¼‰</p>
<h2 id="SHOI2009-èˆä¼š"><a href="#SHOI2009-èˆä¼š" class="headerlink" title="$[SHOI2009]-èˆä¼š$"></a>$[SHOI2009]-èˆä¼š$</h2><hr>
<p>å°±æ˜¯é‚£é“-å·²ç»æ²¡æœ‰ä»€ä¹ˆå¥½å®³æ€•çš„äº†ï¼Œdp è®¡ç®— g æ•°ç»„ï¼Œf[i, j] è¡¨ç¤ºå‰ i ä¸ªå¥³ç”Ÿæœ‰ j ä¸ªåŒ¹é…äº†ã€‚</p>
<h2 id="æŸCEOIé¢˜"><a href="#æŸCEOIé¢˜" class="headerlink" title="$[æŸCEOIé¢˜]$"></a>$[æŸCEOIé¢˜]$</h2><hr>
<p>ä»€ä¹ˆå®¹æ–¥å°äºå·æ”¹ä¸ºå¤§äºå·çš„ï¼Œå’•å’•</p>
<h2 id="TC14170-Divfree"><a href="#TC14170-Divfree" class="headerlink" title="$[TC14170]-Divfree$"></a>$[TC14170]-Divfree$</h2><hr>
<p>æƒ³ä¸åˆ°çš„å®¹æ–¥dpã€‚ã€‚</p>
<p>ä¸åˆæ³•çš„çŠ¶æ€ (A, B) æ˜¯ B æ˜¯ A çš„çœŸçº¦æ•°æ—¶ã€‚æ•°å­— k çš„çœŸçº¦æ•°åªæœ‰ log(k) ä¸ªï¼Œk æ˜¯ 50000ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸åˆæ³•çš„é“¾çš„é•¿åº¦æœ€å¤š 16ã€‚</p>
<p>è€ƒè™‘å®¹æ–¥ï¼Œf[i] è¡¨ç¤º<strong>åˆæ³•çš„</strong>é•¿åº¦ä¸º i çš„é“¾æ–¹æ¡ˆæ•°ï¼Œg[i] è¡¨ç¤º<strong>ä¸åˆæ³•çš„</strong>é•¿åº¦ä¸º i çš„é“¾æ–¹æ¡ˆæ•°ã€‚g å¯ä»¥é¢„å¤„ç†ã€‚</p>
<p>$f[n] = f[n - 1] <em> g[1] - f[n - 2] </em> g[2] + f[n - 3] * g[3]â€¦$ å¤ªå¦™äº†ã€‚</p>
<h2 id="ç¨³å®šå¤šç±³è¯ºè¦†ç›–"><a href="#ç¨³å®šå¤šç±³è¯ºè¦†ç›–" class="headerlink" title="$[ç¨³å®šå¤šç±³è¯ºè¦†ç›–]$"></a>$[ç¨³å®šå¤šç±³è¯ºè¦†ç›–]$</h2><hr>
<p><a href="https://imilyx.github.io/2020/07/30/[51nod1518]-%E7%A8%B3%E5%AE%9A%E5%A4%9A%E7%B1%B3%E8%AF%BA%E8%A6%86%E7%9B%96/" target="_blank" rel="noopener">é“¾æ¥</a></p>
<h2 id="TC13891-Gxor"><a href="#TC13891-Gxor" class="headerlink" title="$[TC13891]-Gxor$"></a>$[TC13891]-Gxor$</h2><hr>
<p>ä¸€é“æ–¯ç‰¹æ—æ•°ç›¸å…³çš„æ•°å­¦é¢˜</p>
<p>f[i] è¡¨ç¤ºè‡³å°‘ i ä¸ªè¿é€šå—ï¼Œg[i] è¡¨ç¤ºæ°å¥½ i ä¸ªè¿é€šå—ï¼Œæˆ‘ä»¬è¦æ±‚ g[1]</p>
<p>è€ƒè™‘ä¸€ä¸ªå®é™…è¿é€šå—æ•°é‡ä¸º p çš„å›¾ï¼Œå®ƒä¼šåœ¨æˆ‘ä»¬æšä¸¾ k ä¸ªè¿é€šå—çš„æ—¶å€™è¢«ç®— $S_2(p, k)$ æ¬¡</p>
<p>æœ‰ä¸ªæŸ¿å­ï¼š$\sum_i (-1)^{i - 1} S_2(n, i) * (i - 1)! = [n = 1]$</p>
<p><a href="https://blog.csdn.net/qq_35950004/article/details/106126524" target="_blank" rel="noopener">æ¯”è¾ƒæ¸…æ¥šçš„è¯æ˜</a></p>
<p>å¥½ç¥å¥‡å•Šï¼Œæ¶ˆåŒ–æ¶ˆåŒ–ã€‚ã€‚ã€‚</p>
<p>$g[1] = \sum\limits_{i = 1}^n f[i] <em> S_1(i, 1) </em> (-1)^{i - 1}$</p>
<p>f[k] å¾ˆéš¾ç®—çš„æ ·å­ï¼Œæ€ä¹ˆåŠï¼Ÿæ³¨æ„åˆ° n åªæœ‰ 9ï¼Œæš´æœï¼Œå¼ºåˆ¶å—ä¸å—ä¹‹é—´çš„è¾¹ä¸èƒ½è¿ï¼ˆè¿™ä¸ªé«˜æ–¯æ¶ˆå…ƒè§£å¼‚æˆ–æ–¹ç¨‹ç»„æ¥æï¼‰ã€‚C(17, 9) å·¦å³ï¼Œå—¯å¾ˆç¨³ï¼</p>
<p>ä»£ç æœ‰ä¸€äº›å°ç»†èŠ‚ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Gxor</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ll T, n, ans, len, tot;</span><br><span class="line">    ll fac[<span class="number">15</span>], a[N], b[N], col[N], lg[<span class="number">1</span> &lt;&lt; <span class="number">11</span>];</span><br><span class="line">    <span class="keyword">char</span> s[<span class="number">15</span>][N];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> d)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!x) &#123;</span><br><span class="line">            <span class="keyword">int</span> t = <span class="number">0</span>;</span><br><span class="line">            tot = <span class="number">0</span>;</span><br><span class="line">            rep(u, <span class="number">0</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">                rep(v, u + <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (col[u] != col[v]) a[tot++] = b[t];</span><br><span class="line">                    ++t;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            a[tot] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> cur = <span class="number">0</span>;</span><br><span class="line">            rep(i, <span class="number">0</span>, T - <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!((a[cur] &gt;&gt; i) &amp; <span class="number">1</span>)) &#123;</span><br><span class="line">                    rep(j, cur + <span class="number">1</span>, tot - <span class="number">1</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> ((a[j] &gt;&gt; i) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">                            swap(a[j], a[cur]); <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                rep(j, cur + <span class="number">1</span>, tot - <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> ((a[j] &gt;&gt; i) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">                        <span class="comment">// swap(a[j], a[cur]);</span></span><br><span class="line">                        a[j] ^= a[cur];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> ((a[cur] &gt;&gt; i) &amp; <span class="number">1</span>) ++cur;</span><br><span class="line">            &#125;</span><br><span class="line">            ans += fac[d] * (<span class="number">1l</span>l &lt;&lt; (T - cur));</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> t = x; t; t = (t - <span class="number">1</span>) &amp; x)</span><br><span class="line">            <span class="keyword">if</span> (t &amp; (x &amp; -x)) &#123;  <span class="comment">// åŒ…å« x çš„æœ«å°¾ 1 ä½ç½®ï¼Œè¿™æ ·ä¸ä¼šé‡å¤æšä¸¾</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> u = t; u; u = (u - <span class="number">1</span>) &amp; u)</span><br><span class="line">                    col[lg[u &amp; -u]] = lg[x &amp; -x];</span><br><span class="line">                dfs(x - t, d + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">ll <span class="title">countsubs</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; s)</span> </span>&#123;</span><br><span class="line">        T = s.size();</span><br><span class="line">        len = s[<span class="number">0</span>].length();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; ; i++) <span class="keyword">if</span> (i * (i - <span class="number">1</span>) / <span class="number">2</span> == len) &#123; n = i; <span class="keyword">break</span>; &#125;</span><br><span class="line">        rep(i, <span class="number">0</span>, T - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> t = <span class="number">0</span>;</span><br><span class="line">            rep(u, <span class="number">0</span>, n - <span class="number">1</span>)</span><br><span class="line">                rep(v, u + <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (s[i][t] == <span class="string">'1'</span>) b[t] |= (<span class="number">1l</span>l &lt;&lt; i);</span><br><span class="line">                    ++t;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        fac[<span class="number">0</span>] = fac[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        rep(i, <span class="number">0</span>, <span class="number">10</span>) lg[(<span class="number">1</span> &lt;&lt; i)] = i;</span><br><span class="line">        rep(i, <span class="number">2</span>, <span class="number">10</span>) fac[i] = fac[i - <span class="number">1</span>] * (i - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= <span class="number">10</span>; i += <span class="number">2</span>) fac[i] = -fac[i];</span><br><span class="line">        dfs((<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/30/[51nod1518]-ç¨³å®šå¤šç±³è¯ºè¦†ç›–/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/07/30/[51nod1518]-ç¨³å®šå¤šç±³è¯ºè¦†ç›–/" itemprop="url">
                  [51nod1518]-ç¨³å®šå¤šç±³è¯ºè¦†ç›–
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-07-30T18:18:11+08:00">
                2020-07-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>æˆ‘ä»¬å‘ç°æ°å¥½ k æ¡çº¿ä¸è¢«è·¨è¿‡å¾ˆéš¾æï¼Œä½†æ˜¯è‡³å°‘ k æ¡çº¿ä¸è¢«è·¨è¿‡å°±å¯ä»¥ dpï¼Œæƒ³åˆ°å®¹æ–¥ï¼ˆäºŒé¡¹å¼åæ¼”ï¼‰ã€‚</p>
<p>åŒæ—¶æšä¸¾è¡Œå’Œåˆ—çš„å¤æ‚åº¦å¤ªé«˜ï¼Œä½†æ˜¯æšä¸¾ä¸€ç»´åï¼Œå¦ä¸€ç»´å°±å¯ä»¥ dp äº†ã€‚</p>
<p>æˆ‘ä»¬é€‰æ‹©æšä¸¾åˆ—ï¼Œè¡Œåš dpï¼š</p>
<ul>
<li>f[i, j] è¡¨ç¤º i è¡Œ j åˆ—æ°å¥½å¡«æ»¡çš„æ–¹æ¡ˆæ•°ï¼ˆæ’å¤´dpé¢„å¤„ç†ï¼‰ï¼Œ</li>
<li>g[k] è¡¨ç¤º<strong>è‡³å°‘</strong> k æ¡<strong>åˆ—çº¿</strong>ï¼Œ0 æ¡è¡Œçº¿çš„æ–¹æ¡ˆæ•°ï¼ˆ0 æ¡è¡Œçº¿ é€šè¿‡å®¹æ–¥å®ç°ï¼‰</li>
</ul>
<p><strong>æ³¨æ„ï¼šè¿™é‡Œæ’å¤´dp è½®å»“çº¿ å’Œå›è·¯è®¡æ•°çš„<a href="https://www.cnblogs.com/iiyiyi/p/5846864.html" target="_blank" rel="noopener">ä¸å¤ªä¸€æ ·</a></strong></p>
<p>ï¼ˆæ‰€ä»¥è¦å°±é¢˜è®ºé¢˜çš„è®¾è®¡è½®å»“çº¿å•Šï¼ï¼ï¼ï¼‰</p>
<p>é‡ç‚¹æ€»ç»“ï¼š1. æƒ³åˆ°å®¹æ–¥ 2. æƒ³åˆ°æšä¸¾ä¸€ç»´å dp å¦ä¸€ç»´</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line">ll dp[<span class="number">2</span>][<span class="number">1</span> &lt;&lt; <span class="number">16</span>], f[<span class="number">20</span>][<span class="number">20</span>], ans, g[<span class="number">20</span>], row[<span class="number">20</span>];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vec;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> lim)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="keyword">sizeof</span>(dp));</span><br><span class="line">    <span class="keyword">int</span> tot = (<span class="number">1</span> &lt;&lt; lim) - <span class="number">1</span>, p = <span class="number">1</span>;</span><br><span class="line">    dp[<span class="number">0</span>][tot] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">1</span>, lim) &#123;</span><br><span class="line">            <span class="built_in">memset</span>(dp[p], <span class="number">0</span>, <span class="keyword">sizeof</span>(dp[p]));</span><br><span class="line">            rep(s, <span class="number">0</span>, tot) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!((s &gt;&gt; (lim - <span class="number">1</span>)) &amp; <span class="number">1</span>)) &#123;</span><br><span class="line">                    (dp[p][(s &lt;&lt; <span class="number">1</span> | <span class="number">1</span>) &amp; tot] += dp[p ^ <span class="number">1</span>][s]) %= mod;  <span class="comment">// ç«–æ”¾ä¸€å— </span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (!(s &amp; <span class="number">1</span>) &amp;&amp; j &gt; <span class="number">1</span>)</span><br><span class="line">                        (dp[p][(s &lt;&lt; <span class="number">1</span> | <span class="number">3</span>) &amp; tot] += dp[p ^ <span class="number">1</span>][s]) %= mod;  <span class="comment">// æ¨ªæ”¾ä¸€å—</span></span><br><span class="line">                    (dp[p][(s &lt;&lt; <span class="number">1</span>) &amp; tot] += dp[p ^ <span class="number">1</span>][s]) %= mod;  <span class="comment">// ä¸æ”¾</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            p ^= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        f[i][lim] = dp[p ^ <span class="number">1</span>][tot];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prework</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) calc(i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    n = m = <span class="number">16</span>;</span><br><span class="line">    prework();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m) &#123;</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        rep(s, <span class="number">1</span> &lt;&lt; (m - <span class="number">1</span>), (<span class="number">1</span> &lt;&lt; m) - <span class="number">1</span>) &#123;</span><br><span class="line">            vec.clear();</span><br><span class="line">            <span class="keyword">int</span> lst = <span class="number">0</span>;</span><br><span class="line">            rep(i, <span class="number">1</span>, m)</span><br><span class="line">                <span class="keyword">if</span> ((s &gt;&gt; (i - <span class="number">1</span>)) &amp; <span class="number">1</span>) vec.push_back(i - lst), lst = i;</span><br><span class="line">            rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">                row[i] = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; vec.size(); j++)</span><br><span class="line">                    (row[i] *= f[i][vec[j]]) %= mod;</span><br><span class="line">            &#125;</span><br><span class="line">            rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">                g[i] = row[i];</span><br><span class="line">                rep(j, <span class="number">1</span>, i - <span class="number">1</span>)</span><br><span class="line">                    (g[i] -= row[i - j] * g[j] % mod) %= mod;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ((vec.size()) &amp; <span class="number">1</span>) (ans += g[n]) %= mod;</span><br><span class="line">            <span class="keyword">else</span> (ans -= g[n]) %= mod;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, (ans + mod) % mod);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/30/XJOI200730 é¢˜è§£/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/07/30/XJOI200730 é¢˜è§£/" itemprop="url">
                  XJOI200730 é¢˜è§£
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-07-30T17:42:40+08:00">
                2020-07-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><hr>
<p>æ±‚æœ€å°ç”Ÿæˆæ ‘è¾¹æƒæœŸæœ›ã€‚</p>
<p>â€œä¿è¯è·ç¦»å€¼ç›¸åŒçš„é“è·¯æ•°å°äº 30â€ï¼Œæ˜¾ç„¶å¯ä»¥ç”¨çŸ©é˜µæ ‘å®šç†ã€‚</p>
<p>æ ¹æ®æœŸæœ›çš„å¯åŠ æ€§ï¼Œæ•´æ£µæ ‘çš„æœŸæœ› = æ¯æ¡è¾¹çš„æœŸæœ› ä¹‹å’Œã€‚è€ƒè™‘æœ€å°ç”Ÿæˆæ ‘çš„æ€§è´¨ï¼ˆå…·ä½“å¯è§ JSOI2008-æœ€å°ç”Ÿæˆæ ‘è®¡æ•°ï¼‰ï¼Œæˆ‘ä»¬åˆ†åˆ«å¤„ç†ä¸åŒé•¿åº¦çš„è¾¹ã€‚è€Œæ¯æ¡è¾¹çš„æ¦‚ç‡æ˜¯ï¼šï¼ˆåŒ…å«è¿™æ¡è¾¹çš„ç”Ÿæˆæ ‘ä¸ªæ•°ï¼‰/ï¼ˆæ€»ç”Ÿæˆæ ‘ä¸ªæ•°ï¼‰ã€‚åˆ†å¼€åšå°±å¯ä»¥è¿‡äº†ï¼Œè™½ç„¶æ—¶é—´å¤æ‚åº¦æ˜¯ä¸å¯¹çš„ã€‚</p>
<p>ç„¶è€Œè¿˜æœ‰ä¸€ä¸ªç¥ä»™åšæ³•ï¼š<a href="https://www.cnblogs.com/Flying2018/p/13406278.html" target="_blank" rel="noopener">flying2018å¤§ä½¬åšå®¢</a></p>
<h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><hr>
<p>ä¸ºä»€ä¹ˆæ²¡å¾€æ•°æ®ç»“æ„æƒ³å‘¢ã€‚ã€‚ã€‚è¦åæ€ï¼Œè¿™ä¸€çœ‹å°±å¾ˆçº¿æ®µæ ‘å˜›</p>
<p>å¿½ç•¥ limit çš„é™åˆ¶â€”â€”æœ€å·¦çš„ä½ç½®å¯ä»¥äºŒåˆ†ã€‚</p>
<p>maxå€¼æ˜¯<strong>å•è°ƒä¸å¢</strong>çš„ã€‚</p>
<p>çº¿æ®µæ ‘ç»´æŠ¤æ¯ä¸€ä¸ª f[i] å’Œ max{â€¦}ã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/29/ã€å­¦ä¹ ç¬”è®°ã€‘æ’å¤´dp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/07/29/ã€å­¦ä¹ ç¬”è®°ã€‘æ’å¤´dp/" itemprop="url">
                  ã€å­¦ä¹ ç¬”è®°ã€‘æ’å¤´dp
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-07-29T17:50:40+08:00">
                2020-07-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://www.cnblogs.com/zinthos/p/3897854.html" target="_blank" rel="noopener">è¿™ä¸ªè®²çš„è¿˜ä¸é”™</a></p>
<p>é‡ä¿®æ’å¤´dpï¼ä»Šæ—¥ä¸»é¢˜ï¼šè®²è®²é‚£äº›å¥‡æ€ªçš„æ’å¤´ä»¬</p>
<ul>
<li>åˆ’åˆ†é˜¶æ®µï¼ˆä»ä¸Šåˆ°ä¸‹ã€ä»å·¦åˆ°å³é€æ ¼é€’æ¨ï¼‰ï¼šqvqï¼Œè½®å»“çº¿ä»¥ä¸Šå°±æ˜¯å·²ç»å¤„ç†å¥½çš„çŠ¶æ€ï¼Œåªç­‰ç€æ ¹æ®å½“å‰æ ¼çš„æ’å¤´çŠ¶æ€å¾€ä¸‹æ¨äº†ã€‚</li>
<li>æ ¹æ®å½“å‰æ ¼æœ‰æ— å·¦ã€ä¸Šæ’å¤´ï¼Œæ¨å‘æœ‰æ— å³ã€ä¸‹æ’å¤´çš„çŠ¶æ€ã€‚</li>
<li>å…³äºæ¢è¡Œï¼Œæˆ‘ä»¬ç¼–å· m + 1 ä¸ªä½ç½® 0 ~ m, æ˜¾ç„¶å½“å‰è¡Œ 0 ~ m - 1 çš„ä¼šè½¬ç§»åˆ° 1 ~ mï¼Œå³ç§»ä¸€ä½å°±å¥½äº†ã€‚</li>
<li>æœ´ç´ çš„è½®å»“çº¿åªæœ‰ 0/1 è¡¨ç¤ºæœ‰æ— æ’å¤´ï¼Œä½†ä»¥æ´›è°·é‚£é“ä¾‹é¢˜ä¸ºä¾‹ï¼Œè¿™æ ·å¤„ç†æ˜¯ä¼šå‡ºç°å¤šä¸ªå›è·¯çš„æƒ…å†µçš„ã€‚è¿™æ—¶å€™éœ€è¦ç”¨æ‹¬å·è¡¨ç¤ºæ³• + Xè¿›åˆ¶ï¼ˆX &gt; 2, é€šå¸¸å–X = 4ä¸ºå®œå› ä¸ºä½è¿ç®—å¾ˆå¿«ä¸”å†™èµ·æ¥æ–¹ä¾¿ï¼‰æ¥ç»´æŠ¤æ’å¤´ä¹‹é—´çš„è”é€šæ€§ï¼ˆé™åˆ¶äº†ä¸€äº›éæ³•çŠ¶æ€çš„è½¬ç§»ï¼‰ï¼Œå½“ç„¶ï¼Œåˆ†ç±»æƒ…å†µä¹Ÿå¤šäº†ä¸å°‘ã€‚ã€‚ã€‚</li>
<li>Hashè¡¨å¯ä»¥é€šè¿‡å»é‡ä»¥åŠæ’é™¤æ— ç”¨çŠ¶æ€æå¤§çš„åŠ é€Ÿæ’å¤´dpçš„é€Ÿåº¦ã€‚</li>
<li>ç†è§£ä¸äº†çš„è¯ï¼Œå»ºè®®ç”»å›¾ qvqï¼</li>
</ul>
<h2 id="hdu1693"><a href="#hdu1693" class="headerlink" title="hdu1693"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=1693" target="_blank" rel="noopener">hdu1693</a></h2><hr>
<p>å¯ä»¥æœ‰å¤šä¸ªå›è·¯ã€‚æœ´ç´ è½®å»“çº¿ï¼Œå¯ä»¥å¼€ f[i, j, s]ï¼Œä¹Ÿå¯ä»¥æ»šåŠ¨æ•°ç»„ï¼ˆç»†èŠ‚æ³¨æ„ï¼ï¼ï¼ï¼‰</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll T, n, m, cas;</span><br><span class="line">ll mp[<span class="number">15</span>][<span class="number">15</span>], f[<span class="number">2</span>][<span class="number">1</span> &lt;&lt; <span class="number">13</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">        <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">        rep(i, <span class="number">1</span>, n)</span><br><span class="line">            rep(j, <span class="number">1</span>, m)</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;mp[i][j]);</span><br><span class="line">        <span class="keyword">int</span> cur = <span class="number">1</span>, pre = <span class="number">0</span>, tot = (<span class="number">1</span> &lt;&lt; (m + <span class="number">1</span>)) - <span class="number">1</span>;</span><br><span class="line">        f[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">            swap(cur, pre);  <span class="comment">// !!!</span></span><br><span class="line">            <span class="built_in">memset</span>(f[cur], <span class="number">0</span>, <span class="keyword">sizeof</span>(f[cur]));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> s = (<span class="number">1</span> &lt;&lt; m) - <span class="number">1</span>; s &gt;= <span class="number">0</span>; --s)</span><br><span class="line">                f[cur][s &lt;&lt; <span class="number">1</span>] = f[pre][s];</span><br><span class="line">            rep(j, <span class="number">1</span>, m) &#123;</span><br><span class="line">                swap(pre, cur);</span><br><span class="line">                <span class="built_in">memset</span>(f[cur], <span class="number">0</span>, <span class="keyword">sizeof</span>(f[cur]));</span><br><span class="line">                rep(s, <span class="number">0</span>, tot) &#123;</span><br><span class="line">                    <span class="keyword">bool</span> is_r = (s &gt;&gt; (j - <span class="number">1</span>)) &amp; <span class="number">1</span>, is_d = (s &gt;&gt; j) &amp; <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">if</span> (!mp[i][j]) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (!is_r &amp;&amp; !is_d)</span><br><span class="line">                            f[cur][s] = f[pre][s];</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (is_r &amp;&amp; is_d) &#123;</span><br><span class="line">                            f[cur][s] = f[pre][s - (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>)) - (<span class="number">1</span> &lt;&lt; j)];</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (is_r ^ is_d) &#123;</span><br><span class="line">                            <span class="keyword">int</span> ss = s | (<span class="number">1</span> &lt;&lt; j) | (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>));</span><br><span class="line">                            f[cur][s] = f[pre][ss - (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))] + f[pre][ss - (<span class="number">1</span> &lt;&lt; j)];</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            f[cur][s] = f[pre][s + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>)) + (<span class="number">1</span> &lt;&lt; j)];</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Case %d: There are %lld ways to eat the trees.\n"</span>, ++cas, f[cur][<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æ´›è°·æ¨¡æ¿"><a href="#æ´›è°·æ¨¡æ¿" class="headerlink" title="æ´›è°·æ¨¡æ¿"></a><a href="https://www.luogu.com.cn/problem/P5056" target="_blank" rel="noopener">æ´›è°·æ¨¡æ¿</a></h2><hr>
<p>åªèƒ½æœ‰ä¸€ä¸ªé—­åˆå›è·¯ã€‚</p>
<p>ï¼ˆä¸€äº›åºŸè¯ï¼šè¿™æ˜¯æˆ‘ä¸Šæ¥å¯¹ç€é¢˜è§£å†™çš„ç¬¬ä¸€é“æ’å¤´dpï¼Œhashä¼˜åŒ– + æ‹¬å·è¡¨ç¤ºä¸€ä¸ªæ²¡å°‘ã€‚ã€‚qwq è¢«æ¯’æ­»äº†å‘€</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">590027</span>, N = <span class="number">6e5</span> + <span class="number">10</span>;</span><br><span class="line">ll n, m, ans, ex, ey, pre, cur = <span class="number">1</span>;</span><br><span class="line">ll bits[<span class="number">30</span>], tots[<span class="number">2</span>], lnk[N], nxt[N], to[N], cnt, sta[<span class="number">2</span>][N], dp[<span class="number">2</span>][N];</span><br><span class="line"><span class="keyword">bool</span> mp[<span class="number">15</span>][<span class="number">15</span>];</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">15</span>][<span class="number">15</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">hsh</span><span class="params">(ll state, ll val)</span> </span>&#123;</span><br><span class="line">    ll x = state % mod;</span><br><span class="line">    <span class="keyword">for</span> (ll i = lnk[x]; i; i = nxt[i])</span><br><span class="line">        <span class="keyword">if</span> (sta[cur][to[i]] == state) &#123;</span><br><span class="line">            dp[cur][to[i]] += val; <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    tots[cur]++;</span><br><span class="line">    sta[cur][tots[cur]] = state;</span><br><span class="line">    dp[cur][tots[cur]] = val;</span><br><span class="line"></span><br><span class="line">    to[++cnt] = tots[cur], nxt[cnt] = lnk[x], lnk[x] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DP</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll cursta, curans;</span><br><span class="line">    <span class="keyword">int</span> is_d, is_r;</span><br><span class="line">    dp[cur][tots[cur] = <span class="number">1</span>] = <span class="number">1</span>, sta[cur][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">1</span>, tots[cur]) sta[cur][j] &lt;&lt;= <span class="number">2</span>;</span><br><span class="line">        rep(j, <span class="number">1</span>, m) &#123;</span><br><span class="line">            swap(pre, cur);</span><br><span class="line">            <span class="built_in">memset</span>(lnk, <span class="number">0</span>, <span class="keyword">sizeof</span>(lnk));</span><br><span class="line">            tots[cur] = cnt = <span class="number">0</span>;</span><br><span class="line">            rep(k, <span class="number">1</span>, tots[pre]) &#123;</span><br><span class="line">                cursta = sta[pre][k], curans = dp[pre][k];</span><br><span class="line">                is_r = (cursta &gt;&gt; bits[j - <span class="number">1</span>]) % <span class="number">4</span>, is_d = (cursta &gt;&gt; bits[j]) % <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (!mp[i][j]) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (!is_r &amp;&amp; !is_d)</span><br><span class="line">                        hsh(cursta, curans);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (!is_r &amp;&amp; !is_d) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (mp[i + <span class="number">1</span>][j] &amp;&amp; mp[i][j + <span class="number">1</span>])</span><br><span class="line">                        hsh(cursta + (<span class="number">1</span> &lt;&lt; bits[j - <span class="number">1</span>]) + <span class="number">2</span> * (<span class="number">1</span> &lt;&lt; bits[j]), curans);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (is_r &amp;&amp; !is_d) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (mp[i][j + <span class="number">1</span>])</span><br><span class="line">                        hsh(cursta - is_r * (<span class="number">1</span> &lt;&lt; bits[j - <span class="number">1</span>]) + is_r * (<span class="number">1</span> &lt;&lt; bits[j]), curans);</span><br><span class="line">                    <span class="keyword">if</span> (mp[i + <span class="number">1</span>][j])</span><br><span class="line">                        hsh(cursta, curans);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (!is_r &amp;&amp; is_d) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (mp[i][j + <span class="number">1</span>])</span><br><span class="line">                        hsh(cursta, curans);</span><br><span class="line">                    <span class="keyword">if</span> (mp[i + <span class="number">1</span>][j])</span><br><span class="line">                        hsh(cursta + is_d * (<span class="number">1</span> &lt;&lt; bits[j - <span class="number">1</span>]) - is_d * (<span class="number">1</span> &lt;&lt; bits[j]), curans);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (is_r == <span class="number">1</span> &amp;&amp; is_d == <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">int</span> cnt = <span class="number">1</span>;</span><br><span class="line">                    rep(l, j + <span class="number">1</span>, m) &#123;</span><br><span class="line">                        <span class="keyword">int</span> t = (cursta &gt;&gt; bits[l]) % <span class="number">4</span>;</span><br><span class="line">                        <span class="keyword">if</span> (t == <span class="number">1</span>) ++cnt;</span><br><span class="line">                        <span class="keyword">if</span> (t == <span class="number">2</span>) --cnt;</span><br><span class="line">                        <span class="keyword">if</span> (!cnt) &#123;</span><br><span class="line">                            hsh(cursta - (<span class="number">1</span> &lt;&lt; bits[j - <span class="number">1</span>]) - (<span class="number">1</span> &lt;&lt; bits[j]) - (<span class="number">1</span> &lt;&lt; bits[l]), curans);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (is_r == <span class="number">2</span> &amp;&amp; is_d == <span class="number">2</span>) &#123;</span><br><span class="line">                    <span class="keyword">int</span> cnt = <span class="number">-1</span>;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> l = j - <span class="number">2</span>; l; --l) &#123;</span><br><span class="line">                        <span class="keyword">int</span> t = (cursta &gt;&gt; bits[l]) % <span class="number">4</span>;</span><br><span class="line">                        <span class="keyword">if</span> (t == <span class="number">1</span>) ++cnt;</span><br><span class="line">                        <span class="keyword">if</span> (t == <span class="number">2</span>) --cnt;</span><br><span class="line">                        <span class="keyword">if</span> (!cnt) &#123;</span><br><span class="line">                            hsh(cursta - <span class="number">2</span> * (<span class="number">1</span> &lt;&lt; bits[j - <span class="number">1</span>]) - <span class="number">2</span> * (<span class="number">1</span> &lt;&lt; bits[j]) + (<span class="number">1</span> &lt;&lt; bits[l]), curans);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (is_r == <span class="number">2</span> &amp;&amp; is_d == <span class="number">1</span>) &#123;</span><br><span class="line">                    hsh(cursta - <span class="number">2</span> * (<span class="number">1</span> &lt;&lt; bits[j - <span class="number">1</span>]) - (<span class="number">1</span> &lt;&lt; bits[j]), curans);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (is_r == <span class="number">1</span> &amp;&amp; is_d == <span class="number">2</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (i == ex &amp;&amp; j == ey)</span><br><span class="line">                        ans += curans;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s[i] + <span class="number">1</span>);</span><br><span class="line">        rep(j, <span class="number">1</span>, m)</span><br><span class="line">            <span class="keyword">if</span> (s[i][j] == <span class="string">'.'</span>) ex = i, ey = j, mp[i][j] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> mp[i][j] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, <span class="number">25</span>) bits[i] = (i &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    DP();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="51nod1518-ç¨³å®šå¤šç±³è¯ºè¦†ç›–"><a href="#51nod1518-ç¨³å®šå¤šç±³è¯ºè¦†ç›–" class="headerlink" title="51nod1518-ç¨³å®šå¤šç±³è¯ºè¦†ç›–"></a><a href="https://vjudge.net/problem/51Nod-1518" target="_blank" rel="noopener">51nod1518-ç¨³å®šå¤šç±³è¯ºè¦†ç›–</a></h2><hr>
<p>ç»ˆäºåˆ°ä½ äº†ï¼Œæ„ŸåŠ¨ä¸­å›½ï¼</p>
<p><a href="https://imilyx.github.io/2020/07/30/[51nod1518]-%E7%A8%B3%E5%AE%9A%E5%A4%9A%E7%B1%B3%E8%AF%BA%E8%A6%86%E7%9B%96/" target="_blank" rel="noopener">é“¾æ¥</a></p>
<p>æš‚æ—¶å°±æ›´è¿™ä¹ˆå¤šå§ï¼Œåç»­è¿˜ä¼šåšé¢˜ &amp; å†™å•ç¯‡åšï¼ˆå¯èƒ½</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/28/XJOI200728 é¢˜è§£/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/07/28/XJOI200728 é¢˜è§£/" itemprop="url">
                  XJOI200728 é¢˜è§£
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-07-28T14:42:40+08:00">
                2020-07-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>ä¸¤é“æ•°æ®ç»“æ„é¢˜ç»™æˆ‘æåäº†ã€‚ã€‚ã€‚</p>
<h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><hr>
<p>åŸé¢˜æ˜¯ CF418E</p>
<p>å®¹æ˜“å‘ç°çŸ©é˜µçš„å¥‡æ•°è¡Œï¼ˆé™¤äº†1ï¼‰å’Œå¶æ•°è¡Œæ˜¯ç›¸åŒçš„. æ„Ÿæ€§ç†è§£å°±æ˜¯æŠŠå¾ˆå¤šä¸² 1ï¼Œ2ï¼Œ3 â€¦ ç©¿æ’åœ¨ä¸€èµ·ï¼Œæ¯æ¬¡è½¬æ¢ä¸€ä¸‹ã€‚</p>
<p>åˆ†å—åšï¼Œf[i, j] è¡¨ç¤ºç¬¬ä¸€è¡Œå‰ i å—ä¸­æ•°å­— j å‡ºç°çš„æ¬¡æ•°ï¼Œg[i, j] è¡¨ç¤ºç¬¬äºŒè¡Œå‰ i å—ä¸­æ•°å­— j å‡ºç°çš„æ¬¡æ•°</p>
<p>ç»´æŠ¤çš„æ—¶å€™æ³¨æ„ f å’Œ g çš„åŠ å‡é¡ºåºï¼ï¼ï¼</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>, M = <span class="number">110</span>;</span><br><span class="line"><span class="keyword">int</span> h, n, m, idx, unit = <span class="number">1000</span>, num;</span><br><span class="line"><span class="keyword">int</span> a[N], f[M][N], g[M][N], val[N];</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mp;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; h &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    num = n / unit + (n % unit &gt; <span class="number">0</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">        <span class="keyword">if</span> (!mp[a[i]]) &#123;</span><br><span class="line">            mp[a[i]] = ++idx;</span><br><span class="line">            val[idx] = a[i];</span><br><span class="line">        &#125;</span><br><span class="line">        a[i] = mp[a[i]];</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, num) &#123;</span><br><span class="line">        <span class="keyword">int</span> l = (i - <span class="number">1</span>) * unit + <span class="number">1</span>, r = min(i * unit, n);</span><br><span class="line">        rep(j, <span class="number">1</span>, n)  <span class="comment">// ä¸Šç•Œå– idx æ˜¯ä¸è¡Œçš„ï¼ï¼ï¼gæ•°ç»„æœ€å¤§å€¼ä¸º nï¼ï¼ï¼</span></span><br><span class="line">            f[i][j] = f[i - <span class="number">1</span>][j], g[i][j] = g[i - <span class="number">1</span>][j];</span><br><span class="line">        rep(j, l, r)</span><br><span class="line">            f[i][a[j]]++, g[i][f[i][a[j]]]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="keyword">int</span> op, x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;op, &amp;x, &amp;y);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!mp[y]) &#123;</span><br><span class="line">                mp[y] = ++idx;</span><br><span class="line">                val[idx] = y;</span><br><span class="line">            &#125;</span><br><span class="line">            y = mp[y];</span><br><span class="line">            rep(i, (x - <span class="number">1</span>) / unit + <span class="number">1</span>, num)</span><br><span class="line">                g[i][f[i][a[x]]]--, f[i][a[x]]--;</span><br><span class="line">            a[x] = y;</span><br><span class="line">            rep(i, (x - <span class="number">1</span>) / unit + <span class="number">1</span>, num)</span><br><span class="line">                f[i][a[x]]++, g[i][f[i][a[x]]]++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (x == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, val[a[y]]); <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            rep(i, y / unit * unit + <span class="number">1</span>, y) &#123;</span><br><span class="line">                f[y / unit][a[i]]++, g[y / unit][f[y / unit][a[i]]]++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, x &amp; <span class="number">1</span> ? g[y / unit][f[y / unit][a[y]]] : f[y / unit][a[y]]);</span><br><span class="line">            rep(i, y / unit * unit + <span class="number">1</span>, y) &#123;</span><br><span class="line">                g[y / unit][f[y / unit][a[i]]]--, f[y / unit][a[i]]--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><hr>
<p>ç»“è®ºé¢˜ï¼Œå°±æ˜¯åˆ æ‰å‰ n ä¸ª</p>
<p>è¿™ç§é¢˜åº”è¯¥è¦æ‰“è¡¨ + æ‰¾è§„å¾‹ + ç‰¹åˆ¤å•Šï¼Œåˆ«æ„£åœ¨é‚£é‡Œã€‚ã€‚ã€‚</p>
<h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><hr>
<p>è€ƒè™‘æ²¡æœ‰æ“ä½œ 2ï¼Œæ˜¾ç„¶ä¸€é dfs å°±èƒ½è§£å†³ï¼ˆè€ƒè™‘èŠ‚ç‚¹ xï¼Œå®ƒä½œä¸º lca çš„è´¡çŒ®å¯ä»¥ç”¨ è¯¢é—®çš„aåœ¨å­æ ‘ä¸­çš„ä¸ªæ•° å’Œ å­æ ‘ä¸­é»‘è‰²ç‚¹çš„idå’Œ æ¥ç®—ï¼‰</p>
<p>è€ƒè™‘æœ‰æ“ä½œ 2ï¼Œæœ¬è´¨ä¸Šå¤šäº†æ—¶é—´è¿™ä¸€ç»´åº¦ï¼ˆç»å…¸å¥—è·¯ï¼‰ï¼Œç”¨çº¿æ®µæ ‘åˆå¹¶ï¼ˆæ—¶é—´ä¸ºä¸‹æ ‡ï¼‰</p>
<p>ç‚¹ x ä½œä¸º lca çš„è´¡çŒ®å°±åœ¨åˆå¹¶çš„æ—¶å€™ç®—ã€‚æ˜¾ç„¶æ—¶é—´è¾ƒå°çš„idå’Œå¯¹æ—¶é—´è¾ƒå¤§çš„è¯¢é—®æœ‰å½±å“ã€‚å› æ­¤è¦è®¡ç®— å·¦åŠè¾¹çš„idå’Œ ä¸ å³åŠè¾¹çš„è¯¢é—®ä¸ªæ•° ä¹‹ç§¯ï¼ˆçº¿æ®µæ ‘ä¸Šåˆ†æ²»å¤„ç†ï¼‰</p>
<p>O(nlogn)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, m, idx;</span><br><span class="line"><span class="keyword">int</span> col[N], lst[N], rt[N];</span><br><span class="line">ll val[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nxt[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span> <span class="keyword">int</span> cnt, ls, rs; ll sum; &#125;tr[N * <span class="number">60</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ls = tr[x].ls, rs = tr[x].rs;</span><br><span class="line">    tr[x].cnt = tr[ls].cnt + tr[rs].cnt;</span><br><span class="line">    tr[x].sum = tr[ls].sum + tr[rs].sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> pos, <span class="keyword">int</span> v1, <span class="keyword">int</span> v2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x) x = ++idx;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        tr[x].cnt += v1;</span><br><span class="line">        tr[x].sum += v2;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (pos &lt;= mid) modify(tr[x].ls, l, mid, pos, v1, v2);</span><br><span class="line">    <span class="keyword">else</span> modify(tr[x].rs, mid + <span class="number">1</span>, r, pos, v1, v2);</span><br><span class="line">    upd(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x || !y) &#123;</span><br><span class="line">        x = (x | y); <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        tr[x].cnt += tr[y].cnt, tr[x].sum += tr[y].sum; <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    val[id] += <span class="number">1l</span>l * tr[tr[x].rs].cnt * tr[tr[y].ls].sum;</span><br><span class="line">    val[id] += <span class="number">1l</span>l * tr[tr[x].ls].sum * tr[tr[y].rs].cnt;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    merge(tr[x].ls, tr[y].ls, l, mid, id);</span><br><span class="line">    merge(tr[x].rs, tr[y].rs, mid + <span class="number">1</span>, r, id);</span><br><span class="line">    upd(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nxt[x].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = nxt[x][i];</span><br><span class="line">        <span class="keyword">if</span> (y == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(y, x);</span><br><span class="line">        merge(rt[x], rt[y], <span class="number">0</span>, m, x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;col[i]);</span><br><span class="line">        <span class="keyword">if</span> (col[i]) modify(rt[i], <span class="number">0</span>, m, <span class="number">0</span>, <span class="number">0</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        nxt[x].push_back(y), nxt[y].push_back(x);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="keyword">int</span> op, x; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;op, &amp;x);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">            modify(rt[x], <span class="number">0</span>, m, i, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> (col[x]) val[x] += x;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            col[x] ^= <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (col[x]) &#123;</span><br><span class="line">                modify(rt[x], <span class="number">0</span>, m, i, <span class="number">0</span>, x);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                modify(rt[x], <span class="number">0</span>, m, i, <span class="number">0</span>, -x);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, val[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/28/XJOI200727 é¢˜è§£/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/07/28/XJOI200727 é¢˜è§£/" itemprop="url">
                  XJOI200727 é¢˜è§£
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-07-28T08:29:40+08:00">
                2020-07-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>åªè®¢äº† A Bï¼Œé¢˜çœŸå¥½ï¼ˆnÃ¡nï¼‰å•Š ~</p>
<h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><hr>
<p>ç­”æ¡ˆæ˜¯ $\sum (ai + k - a[i]\ mod\ k)$</p>
<p>è€ƒè™‘ a[i] &lt; k çš„æ—¶å€™ï¼Œè¿™æ®µé•¿åº¦å°±æ˜¯ k</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°† k ä»å°åˆ°å¤§æ’åºï¼Œå¯¹äºæ¯ä¸ª k åˆ æ‰ &lt; k çš„ a[i]ï¼Œå¯¹äºå‰©ä¸‹çš„ç‚¹åšå‰ç¼€å’Œã€äºŒåˆ†ï¼Œè¾¹ç•Œç‰¹æ®Šå¤„ç†</p>
<p>ä¸ºä»€ä¹ˆè¿™æ ·å¤æ‚åº¦æ˜¯å¯¹çš„å‘¢ï¼Ÿ<strong>æ¯ä¸ª a[i] è¢«è®¡ç®—å®ƒçš„å¤§å°æ¬¡</strong>ï¼Œæ‰€ä»¥æ˜¯ O(n + Qlogn) çš„ï¼ˆç“¶é¢ˆåœ¨äºäºŒåˆ†ï¼‰</p>
<p>å¤ªå¦™äº†ï¼</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e6</span> + <span class="number">10</span>, M = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, Q, tot;</span><br><span class="line">ll cur[N], a[N], b[N], pos[N], pre[N], ans[M];</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">que</span> &#123;</span> ll l, r, k, id; &#125;q[M];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(que a, que b)</span> </span>&#123; <span class="keyword">return</span> a.k &lt; b.k; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">    n = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (s[i] == <span class="string">'T'</span>) &#123;</span><br><span class="line">            pos[++tot] = i;</span><br><span class="line">            a[tot] = i - <span class="number">1</span> - pos[tot - <span class="number">1</span>];</span><br><span class="line">            b[tot] = tot;</span><br><span class="line">        &#125;</span><br><span class="line">        cur[i] = tot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; Q;</span><br><span class="line">    rep(i, <span class="number">1</span>, Q) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>, &amp;q[i].l, &amp;q[i].r, &amp;q[i].k);</span><br><span class="line">        q[i].id = i;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(q + <span class="number">1</span>, q + Q + <span class="number">1</span>, cmp);</span><br><span class="line">    rep(i, <span class="number">1</span>, Q) &#123;</span><br><span class="line">        ll l = q[i].l, r = q[i].r, k = q[i].k;</span><br><span class="line">        <span class="keyword">if</span> (k != q[i - <span class="number">1</span>].k) &#123;</span><br><span class="line">            <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">            rep(j, <span class="number">1</span>, tot)</span><br><span class="line">                <span class="keyword">if</span> (a[j] &gt;= k) a[++cnt] = a[j], b[cnt] = b[j];</span><br><span class="line">            tot = cnt;</span><br><span class="line">            rep(j, <span class="number">1</span>, tot) pre[j] = pre[j - <span class="number">1</span>] + a[j] / k;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (cur[l - <span class="number">1</span>] == cur[r]) &#123;</span><br><span class="line">            ans[q[i].id] = r - l + <span class="number">1</span>; <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> x = lower_bound(b + <span class="number">1</span>, b + tot + <span class="number">1</span>, cur[l - <span class="number">1</span>] + <span class="number">2</span>) - b;</span><br><span class="line">        <span class="keyword">int</span> y = upper_bound(b + <span class="number">1</span>, b + tot + <span class="number">1</span>, cur[r]) - b - <span class="number">1</span>;</span><br><span class="line">        ans[q[i].id] = (r - pos[cur[r]]) + k * (cur[r] - cur[l - <span class="number">1</span>] + (pre[y] - pre[x - <span class="number">1</span>]) + (pos[cur[l - <span class="number">1</span>] + <span class="number">1</span>] - l) / k);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, Q) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><hr>
<p>å®¹æ˜“åˆ—å‡º dp æŸ¿å­ $f[i, j] = \sum\limits_k f[i - 1, j - a_k]$ï¼Œç­”æ¡ˆå°±æ˜¯ $f<a href="i\ mod\ n = 0">l, i</a>$</p>
<p>å®¹æ˜“æƒ³åˆ°çŸ©é˜µå¿«é€Ÿå¹‚ï¼Œä½†æ˜¯å¤æ‚åº¦å¤ªé«˜ä¼šçˆ†ç‚¸</p>
<p>ä»ç”Ÿæˆå‡½æ•°çš„è§†è§’å‡ºå‘ï¼Œè®¾ $g(x) = \sum\limits_i x^{a_i}$ï¼Œåˆ™ $[j + a_k] f^i = \sum [j]f^{i - 1} \times [a_k] g$ï¼Œè¿™æ˜¯<a href="https://www.cnblogs.com/birchtree/p/12287474.html" target="_blank" rel="noopener">å¾ªç¯å·ç§¯</a>çš„å½¢å¼ã€‚æ‰€ä»¥è¯´æˆ‘ä»¬å¹³æ—¶å†™çš„ fft/ntt å…¶å®å°±æ˜¯å¿½è§†äº† 2^? çš„å¾ªç¯å·ç§¯ï¼æœ¬é¢˜ n æ˜¯ 2^?ï¼Œè‹¥ä¸æ˜¯ï¼Œåˆ™éœ€è¦åšä»»æ„é•¿åº¦fftäº†ã€‚ï¼ˆæˆ‘ä¸ä¼š</p>
<p>å·ç§¯å¿«é€Ÿå¹‚å…¶å®å°±æ˜¯è½¬åŒ–æˆç‚¹å€¼å½¢å¼ï¼Œç‚¹å¯¹ç‚¹ç›´æ¥åšå¿«é€Ÿå¹‚ã€‚</p>
<p>m ä¸ªé™åˆ¶å¯ä»¥åˆ†æ®µåšå†ä¹˜èµ·æ¥ï¼Œæ¯åšå®Œä¸€ä¸ªé™åˆ¶å°±æŠŠä¸‹ä¸€ä¸ªé™åˆ¶ä½ç½®çš„æ–¹æ¡ˆæ•°ç½®ä¸º 0ï¼Œå¤æ‚åº¦æ˜¯ O(mnlog^2n)</p>
<p><a href="https://www.cnblogs.com/Flying2018/p/13387482.html" target="_blank" rel="noopener">æ®è¯´è¿˜èƒ½å®¹æ–¥ï¼Ÿï¼Ÿï¼Ÿå’•å’•</a></p>
<p>codeï¼ˆåˆ†æ®µåšï¼‰ï¼š<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>, N = <span class="number">66000</span> * <span class="number">2</span>, G = <span class="number">3</span>, G1 = (mod + <span class="number">1</span>) / G;</span><br><span class="line">ll n, L, m, Q, lim = <span class="number">1</span>;</span><br><span class="line">ll r[N], f[N], g[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">limits</span> &#123;</span> ll x, y; &#125;li[<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(limits a, limits b)</span> </span>&#123; <span class="keyword">return</span> a.x &lt; b.x; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quick_pow</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ret = ret * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">    &#125; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(ll a[], <span class="keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">0</span>, lim - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i]) swap(a[i], a[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; lim; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        ll W = quick_pow(op == <span class="number">1</span> ? G : G1, (mod - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; lim; j += (mid &lt;&lt; <span class="number">1</span>)) &#123;</span><br><span class="line">            ll w = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k++, w = w * W % mod) &#123;</span><br><span class="line">                ll x = a[j + k], y = w * a[j + k + mid] % mod;</span><br><span class="line">                a[j + k] = (x + y) % mod, a[j + k + mid] = (x - y + mod) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">-1</span>) &#123;</span><br><span class="line">        ll inv = quick_pow(lim, mod - <span class="number">2</span>);</span><br><span class="line">        rep(i, <span class="number">0</span>, lim - <span class="number">1</span>) a[i] = a[i] * inv % mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; L &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;li[i].x, &amp;li[i].y);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; Q;</span><br><span class="line">    rep(i, <span class="number">1</span>, Q) &#123;</span><br><span class="line">        <span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x); f[x]++;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    li[++m] = (limits)&#123;L, <span class="number">0</span>&#125;;</span><br><span class="line">    sort(li + <span class="number">1</span>, li + m + <span class="number">1</span>, cmp);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (lim &lt; n) lim &lt;&lt;= <span class="number">1</span>, ++l;  <span class="comment">// &lt; n å“¦ï¼Œæ˜¯å¾ªç¯å·ç§¯</span></span><br><span class="line">    rep(i, <span class="number">0</span>, lim - <span class="number">1</span>) r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>));</span><br><span class="line">    ntt(f, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    g[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        ntt(g, <span class="number">1</span>);</span><br><span class="line">        rep(j, <span class="number">0</span>, n - <span class="number">1</span>) g[j] = g[j] * quick_pow(f[j], li[i].x - li[i - <span class="number">1</span>].x) % mod;  <span class="comment">// ç‚¹å€¼ç›´æ¥åšå¿«é€Ÿå¹‚</span></span><br><span class="line">        ntt(g, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">if</span> (i &lt; m) g[li[i].x] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, g[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><hr>
<p>çœ‹äº† <a href="https://www.cnblogs.com/Flying2018/p/13399374.html" target="_blank" rel="noopener">Flying2018å¤§ä½¬åšå®¢</a> æ¥è®¢æ­£äº†ã€‚ã€‚ã€‚</p>
<p><strong>æœ¬é¢˜æ‰€æœ‰æ€è€ƒåŸºäºä¸€ä¸ªæ€§è´¨ï¼šå¯¹äº $gcd(a, b) = 1$ï¼Œ$l = a \times b$, $len(l) = lcm(len(a), len(b))$</strong></p>
<p>æ‰€ä»¥åªè¦è€ƒè™‘æ‰€æœ‰ = è´¨æ•°çš„ m å°±å¥½äº†ã€‚</p>
<p>è€ƒè™‘ f(n) æ€ä¹ˆç®—ï¼Œæ˜¾ç„¶ $f(n) = x \times a^n + \sum\limits_{i &lt; n} c \times a^i$</p>
<p>é‚£ä¹ˆå°±æ˜¯è¦æ±‚ $x \times a^n + \sum\limits_{i &lt; n} c \times a^i \equiv x (mod\ m)$ çš„æœ€å° n</p>
<p>å³ $\frac{a^n - 1}{a - 1} \equiv x(1 - a^n) (mod\ m)$ </p>
<p>ç„¶åå¼€å§‹åˆ†è®¨ï¼š</p>
<ul>
<li>a = 0ï¼šå¾ªç¯èŠ‚ä¸º 1</li>
<li>a = 1ï¼š</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><span class="space">&hellip;</span><a class="page-number" href="/page/32/">32</a><a class="extend next" rel="next" href="/page/8/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="imily" />
          <p class="site-author-name" itemprop="name">imily</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">312</span>
                <span class="site-state-item-name">æ—¥å¿—</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index-1.html">
                <span class="site-state-item-count">110</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">imily</span>
</div>


<div class="powered-by">
  ç”± <a class="theme-link" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨
</div>

<div class="theme-info">
  ä¸»é¢˜ -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  






  





  

  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  


  

</body>
</html>

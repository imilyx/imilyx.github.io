<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta property="og:type" content="website">
<meta property="og:title" content="imily&#39;s notes">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="imily&#39;s notes">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="imily&#39;s notes">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title> imily's notes </title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">imily's notes</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/12/27/ã€å­¦ä¹ ç¬”è®°ã€‘LCT/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/12/27/ã€å­¦ä¹ ç¬”è®°ã€‘LCT/" itemprop="url">
                  ã€å­¦ä¹ ç¬”è®°ã€‘LCT
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-12-27T17:47:40+08:00">
                2020-12-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>ä¹‹å‰å­¦çš„ã€‚ä»¥ å¤‡ é‡ ä¿® qwq</p>
<p>æŠŠæ ‘å‰–æˆè®¸å¤šé“¾ï¼Œæ¯æ¡é“¾ç”¨ $splay$ ç»´æŠ¤ï¼Œä¸­åºéå†æ·±åº¦é€’å¢ã€‚</p>
<h3 id="access-x"><a href="#access-x" class="headerlink" title="$access(x)$"></a>$access(x)$</h3><ul>
<li><p>æ‰“é€š $x$ åˆ°æ ¹çš„é€šè·¯ã€‚è¿‡ç¨‹æ˜¯å…ˆæŠŠ $x$ è½¬åˆ° $x$ æ‰€åœ¨ $splay$ çš„æ ¹ï¼Œç„¶åè®© $x$ å¸¦ç€ $x$ çš„å·¦å­æ ‘å¹¶åˆ° $fa[x]$ æ‰€åœ¨ $splay$ ä¸­å……ä½œ $fa[x]$ å³å„¿å­</p>
</li>
<li><p>è¿™ä¸ªè¿‡ç¨‹ $x$ å’Œ $fa[x]$ éƒ½å’Œå®ƒä»¬åŸæœ¬çš„å³å„¿å­æ–­å¼€äº†ï¼Œä½†å³å„¿å­ä¾ç„¶ä¿ç•™â€œçˆ¶äº²æ˜¯è°â€çš„ä¿¡æ¯ï¼‰</p>
</li>
</ul>
<h3 id="makeroot-x"><a href="#makeroot-x" class="headerlink" title="$makeroot(x)$"></a>$makeroot(x)$</h3><ul>
<li>å…ˆ $access$ï¼Œæ­¤æ—¶ $x$ æˆäº†å’Œæ ¹åœ¨åŒä¸€ $splay$ ä¸­æ·±åº¦æœ€å¤§ã€ä¸­åºéå†æœ€æœ«çš„ç‚¹</li>
<li>å† $splay$ï¼Œæ­¤æ—¶ $x$ æˆäº†æ‰€åœ¨ $splay$ çš„æ ¹ï¼Œä½†ä»æ˜¯æ·±åº¦æœ€å¤§ã€‚ä¸ºäº†è®© $x$ æˆä¸ºæ ¹ã€å˜å¾—æ·±åº¦æœ€å°ï¼Œæˆ‘ä»¬ç¿»è½¬ $x$ çš„å·¦å³å­æ ‘ã€‚<strong>æ³¨æ„ï¼šæ­¤æ“ä½œä¸å½±å“å…¶ä»– $splay$ çš„æ·±åº¦é¡ºåºã€‚</strong></li>
</ul>
<h3 id="findroot-x"><a href="#findroot-x" class="headerlink" title="$findroot(x)$"></a>$findroot(x)$</h3><ul>
<li>ä¸æ–­è·³å·¦å„¿å­</li>
<li><h2 id="ççˆ±ç”Ÿå‘½ï¼Œè¿œç¦»-findroot-ã€‚ã€‚ã€‚-cut-é‡Œåˆ¤èƒ½å¦-cut-çš„éƒ¨åˆ†è¿˜æ˜¯è¿™æ ·å§ï¼š"><a href="#ççˆ±ç”Ÿå‘½ï¼Œè¿œç¦»-findroot-ã€‚ã€‚ã€‚-cut-é‡Œåˆ¤èƒ½å¦-cut-çš„éƒ¨åˆ†è¿˜æ˜¯è¿™æ ·å§ï¼š" class="headerlink" title="ççˆ±ç”Ÿå‘½ï¼Œè¿œç¦» $findroot$ã€‚ã€‚ã€‚$cut()$ é‡Œåˆ¤èƒ½å¦ $cut$ çš„éƒ¨åˆ†è¿˜æ˜¯è¿™æ ·å§ï¼š"></a>ççˆ±ç”Ÿå‘½ï¼Œè¿œç¦» $findroot$ã€‚ã€‚ã€‚$cut()$ é‡Œåˆ¤èƒ½å¦ $cut$ çš„éƒ¨åˆ†è¿˜æ˜¯è¿™æ ·å§ï¼š</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (ch[y][<span class="number">0</span>] == x &amp;&amp; !ch[x][<span class="number">1</span>]) &#123;</span><br><span class="line">    cut;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="LCT-å¥½åƒæ²¡æ³•åŒæ—¶ä¿è¯ä¸¤ä¸ªèŠ‚ç‚¹çš„å­æ ‘ä¿¡æ¯éƒ½æ˜¯å¯¹çš„ã€‚ã€‚æ— å¥ˆã€‚ã€‚"><a href="#LCT-å¥½åƒæ²¡æ³•åŒæ—¶ä¿è¯ä¸¤ä¸ªèŠ‚ç‚¹çš„å­æ ‘ä¿¡æ¯éƒ½æ˜¯å¯¹çš„ã€‚ã€‚æ— å¥ˆã€‚ã€‚" class="headerlink" title="$LCT$ å¥½åƒæ²¡æ³•åŒæ—¶ä¿è¯ä¸¤ä¸ªèŠ‚ç‚¹çš„å­æ ‘ä¿¡æ¯éƒ½æ˜¯å¯¹çš„ã€‚ã€‚æ— å¥ˆã€‚ã€‚"></a>$LCT$ å¥½åƒæ²¡æ³•åŒæ—¶ä¿è¯ä¸¤ä¸ªèŠ‚ç‚¹çš„å­æ ‘ä¿¡æ¯éƒ½æ˜¯å¯¹çš„ã€‚ã€‚æ— å¥ˆã€‚ã€‚</h2><p>ï¼ˆæ¨¡æ‹Ÿèµ›å¤§çˆ†ç‚¸</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/12/27/ã€å­¦ä¹ ç¬”è®°ã€‘æœ€é•¿åé“¾å’Œå®ƒå…¨å®¶ï¼ˆè¯¦ç»†æ­ç§˜ï¼‰/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/12/27/ã€å­¦ä¹ ç¬”è®°ã€‘æœ€é•¿åé“¾å’Œå®ƒå…¨å®¶ï¼ˆè¯¦ç»†æ­ç§˜ï¼‰/" itemprop="url">
                  ã€å­¦ä¹ ç¬”è®°ã€‘æœ€é•¿åé“¾å’Œå®ƒå…¨å®¶ï¼ˆè¯¦ç»†æ­ç§˜ï¼‰
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-12-27T17:47:40+08:00">
                2020-12-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åŒå¿—ï¼Œæ‰«ç›²äº†ï¼</span><br></pre></td></tr></table></figure>
<ul>
<li><p>é“¾ï¼šååºå…³ç³»ä¸­ï¼Œé“¾æ˜¯å½¢å¦‚ $a \leq b$ çš„è®¸å¤šå…³ç³»ï¼›$DAG$ ä¸Šï¼Œé“¾æ˜¯ä¸€ä¸ªç‚¹é›†ï¼Œå…¶ä¸­ä»»æ„ä¸¤ä¸ªç‚¹ $x$, $y$ éƒ½èƒ½ä» $x$ åˆ° $y$ æˆ–ä» $y$ åˆ° $x$ã€‚</p>
</li>
<li><p>åé“¾ï¼šåé“¾ä¹Ÿæ˜¯ç‚¹é›†ï¼Œä¸è¿‡å…¶ä¸­ä»»æ„ä¸¤ä¸ªç‚¹éƒ½ä¸èƒ½èµ°åˆ°å½¼æ­¤ã€‚</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æœ€é•¿åé“¾ = æœ€å°é“¾è¦†ç›–ï¼ˆDilworth å®šç†ï¼šæœ€é•¿åé“¾ = æœ€å°é“¾ç²¾ç¡®ï¼ˆå³ä¸å¯é‡ï¼‰è¦†ç›–ï¼Œé€šè¿‡ä¼ é€’é—­åŒ…å¯ä»¥è½¬ä¸ºæœ€å°é“¾å¯é‡è¦†ç›–ï¼Œç„¶è€Œå®ç°æ—¶éƒ½ç”¨ç½‘ç»œæµï¼‰</span><br><span class="line">æœ€é•¿é“¾ = æœ€å°åé“¾è¦†ç›–</span><br></pre></td></tr></table></figure>
<ul>
<li><p>æœ€å¤§åŒ¹é…ï¼š$DAG$ çš„æœ€å¤§åŒ¹é…æ¦‚å¿µåŒäºŒåˆ†å›¾çš„ã€‚</p>
</li>
<li><p>æœ€å°é“¾è¦†ç›–ï¼šä¹Ÿå«æœ€å°è·¯å¾„è¦†ç›–ï¼Œä½œç”¨å¦‚å…¶åï¼Œåˆ†ä¸ºå¯é‡å’Œä¸å¯é‡ã€‚</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æœ€å°é“¾è¦†ç›– = é¡¶ç‚¹æ•° - æœ€å¤§åŒ¹é…ï¼ˆåˆšå¼€å§‹æ²¡æœ‰åŒ¹é…ï¼Œæ˜¾ç„¶æˆç«‹ï¼›æ¥ä¸‹æ¥æ¯åŒ¹é…ä¸€å¯¹ç‚¹ï¼ŒåŒ¹é…æ•° +1ï¼Œè·¯å¾„æ•° -1ã€‚åŒ¹é…æ•° = æ¯æ¡è·¯å¾„ç‚¹æ•°è¾¹æ•°å’Œã€‚ï¼‰</span><br></pre></td></tr></table></figure>
<ul>
<li><p>æœ€å°ä¸å¯é‡é“¾è¦†ç›–ï¼šæ‹†ç‚¹ï¼Œç”¨åŒˆç‰™åˆ©ç®—æ³•æˆ–è€…ç½‘ç»œæµæ±‚è§£ï¼Œè¿ $(x_{out}, y_{in})$</p>
</li>
<li><p>æœ€å°å¯é‡é“¾è¦†ç›–ï¼šå…ˆä¼ é€’é—­åŒ…ï¼Œå†åœ¨å½¢æˆçš„ååºé›†ä¸Šåšæœ€å°ä¸å¯é‡é“¾è¦†ç›–ï¼Œè·³è¿‡çš„ç‚¹è¢«å½“ä½œé‡å¤ç»è¿‡ï¼Œç„¶è€Œå®ç°æ—¶ä¸€èˆ¬ç”¨ç½‘ç»œæµå»º $(xâ€™, x, \infty)$ è¿™æ ·çš„åè¾¹è¡¨ç¤ºæŸäº›ç‚¹è¢«å½“ä½œä¸­é—´ç‚¹åšäº†ä¼ é€’é—­åŒ…ã€‚</p>
</li>
<li><p>æœ€å¤§ç‹¬ç«‹é›†ï¼šé€‰å‡ºæœ€å¤šçš„ç‚¹ï¼Œå…¶ä¸­ä¸¤ä¸¤æ— è¾¹ç›¸è¿ã€‚</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">äºŒåˆ†å›¾ æœ€å¤§å›¢ = è¡¥å›¾æœ€å¤§ç‹¬ç«‹é›†</span><br></pre></td></tr></table></figure>
<ul>
<li><p>æœ€å°ç‚¹è¦†ç›–ï¼šé€‰æ‹©æœ€å°‘çš„ç‚¹è¦†ç›–æ‰€æœ‰è¾¹ã€‚</p>
</li>
<li><p>æœ€å°è¾¹è¦†ç›–ï¼šé€‰æ‹©æœ€å°‘çš„è¾¹è¦†ç›–æ‰€æœ‰ç‚¹ã€‚</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">äºŒåˆ†å›¾ æœ€å¤§åŒ¹é… = æœ€å°ç‚¹è¦†ç›–</span><br><span class="line">    æ¯æ¡è¾¹ä¸€å®šè¿ç€ä¸€ä¸ªåŒ¹é…ç‚¹ï¼Œå¦åˆ™è¿ä¸¤ä¸ªæœªåŒ¹é…ç‚¹åŒ¹é…æ•°åº”è¯¥ +1ã€‚</span><br><span class="line">äºŒåˆ†å›¾ æœ€å¤§ç‹¬ç«‹é›† = é¡¶ç‚¹æ•° - æœ€å°ç‚¹è¦†ç›–</span><br><span class="line">    æŠŠæœ€å°ç‚¹è¦†ç›–å‰”é™¤ï¼Œå‰©ä¸‹çš„ç‚¹å°±æ²¡æœ‰è¾¹ç›¸è¿äº†ã€‚</span><br><span class="line">äºŒåˆ†å›¾ æœ€å°è¾¹è¦†ç›– = é¡¶ç‚¹æ•° - æœ€å¤§åŒ¹é…</span><br><span class="line">    æ˜¾ç„¶ã€‚åŒæ—¶ä¹Ÿå‘Šè¯‰æˆ‘ä»¬æœ€å°è¾¹è¦†ç›–å°±æ˜¯åœ¨æœ€å¤§åŒ¹é…çš„åŸºç¡€ä¸ŠåŠ è¾¹ï¼Œå˜æˆå®Œç¾åŒ¹é…ã€‚</span><br><span class="line">äºŒåˆ†å›¾ æœ€å°å‰² = æœ€å°ç‚¹æƒè¦†ç›–é›† = ç‚¹æƒå’Œ - æœ€å¤§ç‚¹æƒç‹¬ç«‹é›†</span><br></pre></td></tr></table></figure>
<p>æ„Ÿè§‰ç±»ä¼¼é¢˜ç›®ï¼ˆä¸ sb çš„é‚£ç§ï¼‰éƒ½æ˜¯ç”¨ğŸ‘†ä¸Šé¢è¿™å¥—ç†è®ºææ¥æå»ï¼Œæ¯”å¦‚ <a href="https://www.luogu.com.cn/problem/P4298" target="_blank" rel="noopener">$CTSC2008-ç¥­ç¥€$</a>ï¼šéš¾ç‚¹åœ¨æ„é€ æ–¹æ¡ˆã€‚</p>
<p>ç¬¬äºŒé—®å¥½æƒ³ï¼Œæ¯ä¸ªç‚¹åˆ é™¤ååšä¸€éæœ€é•¿åé“¾çœ‹æ˜¯å¦åªå‡å°äº† $1$ã€‚</p>
<p>ç¬¬ä¸€é—®ï¼Œå…ˆè¯´ç»“è®ºï¼šé€‰å‡ºæ–°å›¾æ‰€æœ‰ $x_{out}$ å’Œ $x_{in}$ éƒ½åœ¨æœ€å¤§ç‹¬ç«‹é›†é‡Œçš„ç‚¹ï¼Œå°±æ˜¯åŸå›¾æœ€é•¿åé“¾ã€‚</p>
<p>è¯æ˜ï¼š<br>æœ‰æœ€å¤§ç‹¬ç«‹é›†åˆ $I$ = é¡¶ç‚¹æ•° $2n$ - æœ€å¤§åŒ¹é… $m$ï¼Œè®¾æœ€é•¿åé“¾é›†åˆä¸º $A$ï¼Œ$I - A$ ä¸ºã€Œ$x_{out}$ æˆ– $x_{in}$ åœ¨æœ€å¤§ç‹¬ç«‹é›†é‡Œã€çš„ç‚¹é›†ï¼Œ$|I| - |A| \leq n$, $|A| \geq |I| - n = n - m$, è€Œ $|A| \leq n - m$ï¼Œæ‰€ä»¥ $|A| = n - m =$ åŸå›¾æœ€é•¿åé“¾ã€‚</p>
<p>æ‰€ä»¥åŒˆç‰™åˆ©æˆ–è€… $dinic$ æ‰¾æœ€å¤§åŒ¹é…ï¼Œå† dfs æ‰¾æœ€å°ç‚¹è¦†ç›–ï¼Œæœ€å¤§ç‹¬ç«‹é›† = æœ€å°ç‚¹è¦†ç›–è¡¥é›†ã€‚æ³¨æ„è¿™é¢˜å¯é‡ã€‚</p>
<p><em>å½©è›‹ï¼š$dinic$ åœ¨äºŒåˆ†å›¾ä¸Šæ˜¯ $O(n\sqrt{n})$ çš„å“¦</em></p>
<p>upd: $96$ åˆ†æˆ‘å¤ªç–‘æƒ‘äº†ï¼Ÿ</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/12/26/ã€å­¦ä¹ ç¬”è®°ã€‘æœ€å¤§æƒé—­åˆå­å›¾/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/12/26/ã€å­¦ä¹ ç¬”è®°ã€‘æœ€å¤§æƒé—­åˆå­å›¾/" itemprop="url">
                  ã€å­¦ä¹ ç¬”è®°ã€‘æœ€å¤§æƒé—­åˆå­å›¾
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-12-26T09:47:40+08:00">
                2020-12-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="æœ€å¤§æƒé—­åˆå­å›¾"><a href="#æœ€å¤§æƒé—­åˆå­å›¾" class="headerlink" title="æœ€å¤§æƒé—­åˆå­å›¾"></a>æœ€å¤§æƒé—­åˆå­å›¾</h2><hr>
<p>çœ‹åˆ°ä¸€ç¯‡å¾ˆå¥½çš„åšå®¢ï¼Œç»ˆäºä¼šäº†è¿™ç©æ„å„¿ï¼qwq å’±ä¸æ¥è™šçš„å“ˆï¼Œç›´æ¥ä¸Šæ­£é¢˜</p>
<ul>
<li><p>ä»€ä¹ˆæ˜¯æœ€å¤§æƒé—­åˆå­å›¾ï¼š</p>
<p>  æ¯ä¸ªç‚¹æœ‰ç‚¹æƒï¼Œç‚¹æƒå’Œæœ€å¤§çš„é—­åˆå­å›¾å³ä¸ºæœ€å¤§æƒé—­åˆå­å›¾</p>
</li>
<li><p>å¦‚ä½•æ±‚è§£</p>
<p>  å…ˆè¯´ç»“è®ºï¼š$S$ å‘æ­£æƒç‚¹è¿ï¼Œè¾¹æƒä¸ºæƒå€¼ï¼Œ$T$ å‘è´Ÿæƒç‚¹è¿ï¼Œè¾¹æƒä¸ºæƒå€¼ç»å¯¹å€¼ã€‚<strong>æœ€å¤§æƒé—­åˆå­å›¾æƒå€¼å³ä¸ºæ­£æƒå’Œ - æœ€å¤§æµã€‚</strong></p>
<p>  è¯æ˜ï¼ˆåŠæ„Ÿæ€§ï¼‰ï¼š<strong>$S -&gt; T$ çš„æµé‡å°±æ˜¯æŸå¤±ã€‚</strong> å°½é‡é€‰æ­£æƒç‚¹ä¸ºèµ·ç‚¹ï¼Œæ‰€ä»¥ $S$ å‘æ­£æƒç‚¹è¿ã€‚ä¸€ä¸ªæ­£æƒç‚¹é€‰ä¼šå¯¼è‡´åç»­é€‰ä¸€äº›è´Ÿæƒç‚¹ï¼Œä½†æˆ‘ä»¬ä¸çŸ¥é“é€‰å½“å‰æ­£æƒç‚¹æ˜¯å¦ä¼˜ï¼Œå°±å…ˆé€‰ä¸Šï¼Œé¡¶å¤šåé¢è¢«è´Ÿæƒç‚¹æŸå¤±æ‰ä¸º $0$ï¼Œä¸ä¼šäºã€‚</p>
</li>
</ul>
<p>ä¹ é¢˜ï¼š</p>
<h3 id="Salty-Fish"><a href="#Salty-Fish" class="headerlink" title="$Salty\ Fish$"></a><a href="https://vjudge.net/problem/HDU-6634" target="_blank" rel="noopener">$Salty\ Fish$</a></h3><p>æ˜¾ç„¶çš„æœ€å¤§æƒé—­åˆå­å›¾æ¨¡å‹ã€‚æœ¬è´¨å´æ˜¯è´ªå¿ƒâ€”â€”ä¸€ä¸ªæ‘„åƒå¤´å°½å¯èƒ½çš„æ¸…ç†æ‰å­æ ‘é‡Œå‰©ä¸‹çš„è‹¹æœä¸­ï¼Œæ·±åº¦å¤§çš„ã€‚</p>
<p>ä¸æ·±åº¦æœ‰å…³å°±é•¿é“¾å‰–åˆ†ï¼Œå¼€ä¸€ä¸ª $map$ï¼Œ$mp[x, d]$ ç»´æŠ¤ $x$ å­æ ‘ä¸­æ·±åº¦ä¸º $d$ çš„è‹¹æœä¸ªæ•°ã€‚æ¯ä¸ªè‹¹æœåªåœ¨æ‰€åœ¨é•¿é“¾çš„æ ¹å¤„è¢«åˆå¹¶ä¸€æ¬¡ï¼Œ$O((n + m)logn)$</p>
<p>ç„¶è€Œè¿™é¢˜è¦ç›´æ¥ç»§æ‰¿é‡å„¿å­çš„ $map$ï¼Œä¸ç„¶å°± $MLE$ã€‚ã€‚ä»¥åå†™ä»£ç ä¹Ÿæ³¨æ„ä¸€ç‚¹ã€‚</p>
<p><a href="http://acm.hdu.edu.cn/viewcode.php?rid=34972168" target="_blank" rel="noopener">$Code$</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/12/22/[THUWC2017]-å¤§è‘±çš„ç¥åŠ›/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/12/22/[THUWC2017]-å¤§è‘±çš„ç¥åŠ›/" itemprop="url">
                  [THUWC2017]-å¤§è‘±çš„ç¥åŠ›
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-12-22T12:50:40+08:00">
                2020-12-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>ç©ç©æç­”ï¼qwqã€‚çœ‹åˆ°ä¸€å¥è¯ï¼šæç­”çš„æœ¬è´¨æ˜¯æ¨¡æ‹Ÿé€€ç«å’Œæ‰¾è§„å¾‹ã€‚å“¦è¿™æ ·å—ï¼é‚£æˆ‘å»å­¦æ¨¡æ‹Ÿé€€ç«ï¼ˆ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">æ¨¡æ‹Ÿé€€ç«ç®—æ³•æµç¨‹ï¼ˆè´ºï¼‰ï¼š</span><br><span class="line">éšæœºå˜åŒ–åæ ‡ï¼Œå¹…åº¦ä¸º T</span><br><span class="line">è®¡ç®—æ–°è§£ä¸å½“å‰è§£çš„å·® deltaã€‚</span><br><span class="line">ä»¥æœ€å¤§åŒ–ç­”æ¡ˆä¸ºä¾‹ï¼Œè‹¥ delta &gt; 0 åˆ™ç”¨æ–°è§£æ›¿æ¢å½“å‰è§£ï¼›å¦åˆ™ä»¥ exp(-delta / T) çš„æ¦‚ç‡ç”¨æ–°è§£æ›¿æ¢å½“å‰è§£ã€‚</span><br><span class="line">æ¸©åº¦ä¹˜ä¸Šä¸€ä¸ªå°äº 1 çš„ç³»æ•°ï¼Œå³é™æ¸©ã€‚</span><br><span class="line">éšç€æ¸©åº¦ä¸æ–­é™ä½ï¼Œå˜åŒ–å¹…åº¦ä¹Ÿä¸æ–­å‡å°ï¼Œæ¥å—ä¸€ä¸ªæ›´åŠ£è§£çš„æ¦‚ç‡ä¹Ÿè¶Šæ¥è¶Šå°ã€‚</span><br></pre></td></tr></table></figure>
<p>è°ƒå‚çœ‹è„¸ã€‚æœ‰äººè¯´å¯ä»¥è§‚å¯Ÿç­”æ¡ˆçš„å˜åŒ–ç‡ä»€ä¹ˆçš„ï¼Œæ€»ä¹‹æ˜¯ä¸ªå®Œå…¨ç„å­¦çš„ä¸œè¥¿ã€‚</p>
<p>å¥½ï¼Œä¸Šæ­£æ–‡ï¼ï¼ˆå…¶å®æ˜¯æƒ³å­˜ä»£ç ï¼Œå¥½æœ‰æˆå°±æ„Ÿçš„è¯´ qwq</p>
<p>æ¯ä¸ª case éƒ½æœ‰ç‰¹æ€§ï¼Œéœ€è¦è§‚å¯Ÿæ‰¾è§„å¾‹ã€‚</p>
<h3 id="Case-1-amp-2"><a href="#Case-1-amp-2" class="headerlink" title="Case 1 &amp; 2"></a>Case 1 &amp; 2</h3><p>æš´æœ + ï¼ˆæˆ‘çš„åƒåœ¾ï¼‰å‰ªæ</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">30</span>], b[<span class="number">30</span>], mp[<span class="number">30</span>][<span class="number">30</span>], sum, to[<span class="number">30</span>], ans, pos[<span class="number">30</span>];</span><br><span class="line"><span class="keyword">int</span> used[<span class="number">30</span>], mx[<span class="number">30</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (sum + mx[x] &lt; ans) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x == n + <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (sum &gt; ans) &#123;</span><br><span class="line">            rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">                pos[i] = to[i];</span><br><span class="line">            &#125; ans = sum;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(x + <span class="number">1</span>);</span><br><span class="line">    rep(y, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="keyword">if</span> (used[y] + a[x] &lt;= b[y]) &#123;</span><br><span class="line">            sum += mp[x][y];</span><br><span class="line">            to[x] = y;</span><br><span class="line">            used[y] += a[x];</span><br><span class="line">            dfs(x + <span class="number">1</span>);</span><br><span class="line">            sum -= mp[x][y];</span><br><span class="line">            used[y] -= a[x];</span><br><span class="line">            to[x] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// freopen("drawer2.in", "r", stdin);</span></span><br><span class="line">    <span class="comment">// freopen("drawer2.out", "w", stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; b[i];</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">1</span>, m) &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; mp[i][j];</span><br><span class="line">            mx[i] = max(mx[i], mp[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i; --i) mx[i] += mx[i + <span class="number">1</span>];</span><br><span class="line">    dfs(<span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, pos[i]); <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Case-3"><a href="#Case-3" class="headerlink" title="Case 3"></a>Case 3</h3><p>æŠ½å±‰å”¯ä¸€ï¼Œè·‘èƒŒåŒ…ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">10005</span>, M = <span class="number">2e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, a[M], w[M], f[M][N], lst[M][N], ans[M];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (y ^ lst[x][y]) ans[x] = <span class="number">1</span>;</span><br><span class="line">    work(x - <span class="number">1</span>, lst[x][y]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> tmp; <span class="built_in">cin</span> &gt;&gt; tmp;</span><br><span class="line">    <span class="built_in">memset</span>(f, ~<span class="number">0x3f</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;w[i]);</span><br><span class="line">        rep(j, <span class="number">0</span>, <span class="number">10000</span>) &#123;</span><br><span class="line">            f[i][j] = f[i - <span class="number">1</span>][j], lst[i][j] = j;</span><br><span class="line">            <span class="keyword">if</span> (j &gt;= a[i]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (f[i][j] &lt; f[i - <span class="number">1</span>][j - a[i]] + w[i]) &#123;</span><br><span class="line">                    f[i][j] = f[i - <span class="number">1</span>][j - a[i]] + w[i];</span><br><span class="line">                    lst[i][j] = j - a[i];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> id = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">0</span>, <span class="number">10000</span>) <span class="keyword">if</span> (f[n][i] &gt; f[n][id]) &#123;</span><br><span class="line">        id = i;</span><br><span class="line">    &#125;</span><br><span class="line">    work(n, id);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans[i]); <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Case-4-amp-5-amp-6"><a href="#Case-4-amp-5-amp-6" class="headerlink" title="Case 4 &amp; 5 &amp; 6"></a>Case 4 &amp; 5 &amp; 6</h3><p>å¤§è‘±ä½“ç§¯å”¯ä¸€ä¸”æŠ½å±‰ä½“ç§¯æ˜¯å¤§è‘±ä½“ç§¯å€æ•°â€”â€”è£¸çš„è´¹ç”¨æµã€‚</p>
<p>å€¼å¾—ä¸€æçš„æ˜¯æœ‰ä¸ª Case å¤§è‘±ä½“ç§¯éƒ½åœ¨ <del>19260817</del>19900000 å·¦å³ï¼Œå¯è§†ä¸ºå¾®å°çš„æ‰°åŠ¨ï¼Œä¸ä¼šå½±å“æœ€ç»ˆç­”æ¡ˆï¼Œå–æœ€å¤§å€¼ä½œä¸ºä½“ç§¯å°±å¥½ã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e3</span> + <span class="number">5</span>, M = <span class="number">205</span>, E = N * M * <span class="number">2</span> + N + M, inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> S, T, n, m;</span><br><span class="line"><span class="keyword">int</span> a[N], b[M], mp[N][N], ans[N];</span><br><span class="line"><span class="keyword">int</span> fr[E], to[E], nxt[E], lnk[N * <span class="number">2</span>], val[E], cap[E], cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> dis[N * <span class="number">2</span>], pre[N * <span class="number">2</span>], inq[N * <span class="number">2</span>], rest[N * <span class="number">2</span>];</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> c, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">    fr[++cnt] = x, to[cnt] = y, nxt[cnt] = lnk[x], lnk[x] = cnt, val[cnt] = w, cap[cnt] = c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> S, <span class="keyword">int</span> T, <span class="keyword">int</span> &amp;flow, <span class="keyword">int</span> &amp;cost)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(dis));</span><br><span class="line">    <span class="built_in">memset</span>(pre, <span class="number">0</span>, <span class="keyword">sizeof</span>(pre));</span><br><span class="line">    <span class="built_in">memset</span>(rest, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(rest));</span><br><span class="line">    <span class="built_in">memset</span>(inq, <span class="number">0</span>, <span class="keyword">sizeof</span>(inq));</span><br><span class="line">    dis[S] = <span class="number">0</span>, inq[S] = <span class="number">1</span>, rest[S] = inf, pre[S] = <span class="number">0</span>;</span><br><span class="line">    q.push(S);</span><br><span class="line">    <span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front(); q.pop(); inq[x] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = to[i];</span><br><span class="line">            <span class="keyword">if</span> (cap[i] &amp;&amp; dis[y] &gt; dis[x] + val[i]) &#123;</span><br><span class="line">                dis[y] = dis[x] + val[i];</span><br><span class="line">                pre[y] = i;</span><br><span class="line">                rest[y] = min(rest[x], cap[i]);</span><br><span class="line">                <span class="keyword">if</span> (!inq[y])</span><br><span class="line">                    inq[y] = <span class="number">1</span>, q.push(y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (dis[T] &gt; <span class="number">1e9</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    flow += rest[T];</span><br><span class="line">    cost += rest[T] * dis[T];</span><br><span class="line">    <span class="keyword">int</span> u = T;</span><br><span class="line">    <span class="keyword">while</span> (u != S) &#123;</span><br><span class="line">        cap[pre[u]] -= rest[T];</span><br><span class="line">        cap[pre[u] ^ <span class="number">1</span>] += rest[T];</span><br><span class="line">        u = fr[pre[u]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Mcmf</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> flow = <span class="number">0</span>, cost = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (spfa(S, T, flow, cost));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    S = <span class="number">0</span>, T = n + m + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> v = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">        v = max(v, a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        add(S, i, <span class="number">1</span>, <span class="number">0</span>), add(i, S, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;b[i]);</span><br><span class="line">        add(i + n, T, b[i] / v, <span class="number">0</span>), add(T, i + n, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">1</span>, m) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;mp[i][j]);</span><br><span class="line">            add(i, j + n, <span class="number">1</span>, -mp[i][j]), add(j + n, i, <span class="number">0</span>, mp[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Mcmf();</span><br><span class="line">    rep(x, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = to[i];</span><br><span class="line">            <span class="keyword">if</span> (!y) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (!cap[i]) &#123;</span><br><span class="line">                ans[x] = y - n; <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans[x]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Case-7"><a href="#Case-7" class="headerlink" title="Case 7"></a>Case 7</h3><p>åªæœ‰ç¬¬ä¸€ä¸ªå¤§è‘±ä½“ç§¯ä¸åŒï¼Œæšä¸¾å®ƒæ”¾åœ¨å“ªï¼Œè·‘å¤šæ¬¡è´¹ç”¨æµã€‚è·‘äº†ä¸€åˆ†å¤šé’Ÿï¼Œåæ­£æ˜¯æç­” ~</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">505</span>, M = <span class="number">205</span>, E = N * M * <span class="number">2</span> + N + M, inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> S, T, n, m, Cost, V;</span><br><span class="line"><span class="keyword">int</span> a[N], b[M], mp[N][N], ans[N];</span><br><span class="line"><span class="keyword">int</span> fr[E], to[E], nxt[E], lnk[N * <span class="number">2</span>], val[E], cap[E], cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> dis[N * <span class="number">2</span>], pre[N * <span class="number">2</span>], inq[N * <span class="number">2</span>], rest[N * <span class="number">2</span>];</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> c, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">    fr[++cnt] = x, to[cnt] = y, nxt[cnt] = lnk[x], lnk[x] = cnt, val[cnt] = w, cap[cnt] = c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> S, <span class="keyword">int</span> T, <span class="keyword">int</span> &amp;flow, <span class="keyword">int</span> &amp;cost)</span> </span>&#123;</span><br><span class="line">    rep(i, S, T) &#123;</span><br><span class="line">        dis[i] = inf;</span><br><span class="line">        pre[i] = <span class="number">0</span>;</span><br><span class="line">        inq[i] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dis[S] = <span class="number">0</span>, inq[S] = <span class="number">1</span>, rest[S] = inf, pre[S] = <span class="number">0</span>;</span><br><span class="line">    q.push(S);</span><br><span class="line">    <span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front(); q.pop(); inq[x] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = to[i];</span><br><span class="line">            <span class="keyword">if</span> (cap[i] &amp;&amp; dis[y] &gt; dis[x] + val[i]) &#123;</span><br><span class="line">                dis[y] = dis[x] + val[i];</span><br><span class="line">                pre[y] = i;</span><br><span class="line">                rest[y] = min(rest[x], cap[i]);</span><br><span class="line">                <span class="keyword">if</span> (!inq[y])</span><br><span class="line">                    inq[y] = <span class="number">1</span>, q.push(y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (dis[T] &gt; <span class="number">1e9</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    flow += rest[T];</span><br><span class="line">    cost += rest[T] * dis[T];</span><br><span class="line">    <span class="keyword">int</span> u = T;</span><br><span class="line">    <span class="keyword">while</span> (u != S) &#123;</span><br><span class="line">        cap[pre[u]] -= rest[T];</span><br><span class="line">        cap[pre[u] ^ <span class="number">1</span>] += rest[T];</span><br><span class="line">        u = fr[pre[u]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Mcmf</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> flow = <span class="number">0</span>, cost = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (spfa(S, T, flow, cost));</span><br><span class="line">    <span class="keyword">return</span> cost;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    S = <span class="number">0</span>, T = n + m + <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    V = a[<span class="number">2</span>];</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;b[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">1</span>, m) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;mp[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    b[<span class="number">48</span>] -= a[<span class="number">1</span>];</span><br><span class="line">    rep(i, <span class="number">2</span>, n) &#123;</span><br><span class="line">        add(S, i, <span class="number">1</span>, <span class="number">0</span>), add(i, S, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        add(i + n, T, b[i] / V, <span class="number">0</span>), add(T, i + n, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">2</span>, n) &#123;</span><br><span class="line">        rep(j ,<span class="number">1</span>, m) &#123;</span><br><span class="line">            add(i, j + n, <span class="number">1</span>, -mp[i][j]), add(j + n, i, <span class="number">0</span>, mp[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> cost = Mcmf() - mp[<span class="number">1</span>][<span class="number">48</span>];</span><br><span class="line">    ans[<span class="number">1</span>] = <span class="number">48</span>;</span><br><span class="line">    rep(x, <span class="number">2</span>, n) &#123;</span><br><span class="line">        ans[x] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = to[i];</span><br><span class="line">            <span class="keyword">if</span> (!y) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (!cap[i]) &#123;</span><br><span class="line">                ans[x] = y - n; <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(x, <span class="number">1</span>, n) <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans[x]);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Case-8-amp-9-amp-10"><a href="#Case-8-amp-9-amp-10" class="headerlink" title="Case 8 &amp; 9 &amp; 10"></a>Case 8 &amp; 9 &amp; 10</h3><p>æ²¡æœ‰ä»»ä½•è§„å¾‹ã€‚äºæ˜¯å°±ä¸Šæ¨¡æ‹Ÿé€€ç«ï¼ˆå­¦ä»¥è‡´ç”¨</p>
<p>æˆ‘æ˜¯ rand æ’åˆ—ï¼Œéšä¾¿è°ƒå‚ï¼Œæœ€ä¼˜è§£åªæœ‰ 51 ä¸‡å·¦å³ï¼Œç„¶è€Œå…¶ä»–äººéƒ½æ˜¯ 60 ä¸‡å·¦å³ï¼Œå¿ƒæ…Œæ…Œ</p>
<p>äº¤ä¸€å‘ç«Ÿç„¶ä¹Ÿæ˜¯ 4 + 2 + 1ï¼Œå¼€å¿ƒã€‚</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e3</span> + <span class="number">10</span>, M = <span class="number">305</span>;</span><br><span class="line"><span class="keyword">const</span> db down = <span class="number">0.986</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> a[N], b[M], mp[N][M], to[N], idb[N], ida[N];</span><br><span class="line"><span class="keyword">int</span> used[N], tmp[N];</span><br><span class="line">ll ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    db T = <span class="number">30000</span>;</span><br><span class="line">    <span class="keyword">while</span> (T &gt; <span class="number">1e-15</span>) &#123;</span><br><span class="line">        random_shuffle(ida + <span class="number">1</span>, ida + n + <span class="number">1</span>);</span><br><span class="line">        random_shuffle(idb + <span class="number">1</span>, idb + m + <span class="number">1</span>);</span><br><span class="line">        rep(i, <span class="number">1</span>, n) tmp[i] = <span class="number">0</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, m) used[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> cur = <span class="number">1</span>;</span><br><span class="line">        ll sum = <span class="number">0</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (used[idb[cur]] + a[ida[i]] &lt;= b[idb[cur]]) &#123;</span><br><span class="line">                used[idb[cur]] += a[ida[i]];</span><br><span class="line">                tmp[ida[i]] = idb[cur];</span><br><span class="line">                sum += mp[ida[i]][idb[cur]];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                ++cur; --i;</span><br><span class="line">                <span class="keyword">if</span> (cur &gt; m) <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ll del = sum - ans;</span><br><span class="line">        <span class="keyword">if</span> (del &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            ans = sum;</span><br><span class="line">            rep(i, <span class="number">1</span>, n) to[i] = tmp[i];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">exp</span>(-del / T) * RAND_MAX &gt; rand()) &#123;</span><br><span class="line">                ans = sum;</span><br><span class="line">                rep(i, <span class="number">1</span>, n) to[i] = tmp[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        T *= down;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    rep(o, <span class="number">1</span>, <span class="number">5</span>) &#123;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) ida[i] = idb[i] = i;</span><br><span class="line">        work();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    srand(time(<span class="number">0</span>) * clock() % <span class="number">114514</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;b[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">1</span>, m) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;mp[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    solve();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld :\n"</span>, ans);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, to[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="https://loj.ac/s/1017355" target="_blank" rel="noopener">è¯„æµ‹è®°å½•</a></p>
<p>$10 * 7 + 4 + 2 + 1 = 77$ï¼Œæµ·æ˜Ÿ</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/12/13/ã€å­¦ä¹ ç¬”è®°ã€‘å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/12/13/ã€å­¦ä¹ ç¬”è®°ã€‘å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨/" itemprop="url">
                  ã€å­¦ä¹ ç¬”è®°ã€‘å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-12-13T18:49:40+08:00">
                2020-12-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>æ˜¯ç…§ç€ <a href="https://www.cnblogs.com/zhouzhendong/p/Cayley-Hamilton.html" target="_blank" rel="noopener">zhouzhendong</a> å’Œ <a href="https://www.cnblogs.com/Winniechen/p/10246295.html" target="_blank" rel="noopener">Winniechen</a> çš„åšå®¢å­¦ä¹ çš„ã€‚ä¹Ÿå¯ä»¥å‚è€ƒ <a href="https://oi-wiki.org/math/linear-recurrence/" target="_blank" rel="noopener">OI-wiki</a>ï¼Œæ˜¯ä¸¤ç§è§£é‡Šï¼Œæ²¡æœ‰é‚£ä¹ˆå¤šçº¿ä»£å‰ç½®èŠå£«ã€‚</p>
<p>å…¶å®æˆ‘è®²ä¸æ¸…æ¥šï¼Œå»ºè®®ç‚¹ OI-wikiï¼Œå®ƒç‰¹åˆ«æ¸…æ¥šã€‚</p>
<h2 id="é—®é¢˜å¼•å…¥"><a href="#é—®é¢˜å¼•å…¥" class="headerlink" title="$é—®é¢˜å¼•å…¥$"></a>$é—®é¢˜å¼•å…¥$</h2><p>ç»™å®šä¸€ä¸ªæ•°åˆ—ï¼Œæ»¡è¶³:</p>
<ul>
<li>$n \leq k$ æ—¶ï¼Œ$f_n = a_n$</li>
<li>$n &gt; k$ æ—¶ï¼Œ$f_n = \sum\limits_{i = 1}^k f_{n - i} * a_i$</li>
</ul>
<p>ä¼—æ‰€å‘¨çŸ¥çŸ©é˜µç”Ÿæ¥å°±åšè¿™äº‹å„¿çš„ï¼Œ$O(k^3\ log\ n)$. å½“ $n$ æ¯”è¾ƒå¤§çš„æ—¶å€™å°±æ²¡å‰é€”ã€‚</p>
<p>äºæ˜¯å°±å‡ºç°äº†â€”â€”ç‰¹å¾å¤šé¡¹å¼ä¼˜åŒ–çŸ©é˜µå¿«é€Ÿå¹‚ã€‚æ±‚ç¬¬ $n$ é¡¹å¤æ‚åº¦ä¸º $O(k^2 log n)$</p>
<h2 id="å‰ç½®æ•°å­¦èŠå£«"><a href="#å‰ç½®æ•°å­¦èŠå£«" class="headerlink" title="$å‰ç½®æ•°å­¦èŠå£«$"></a>$å‰ç½®æ•°å­¦èŠå£«$</h2><ol>
<li><p>çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡</p>
<ul>
<li><p>è‹¥å¯¹äº $n$ é˜¶çŸ©é˜µ $A$ï¼Œæœ‰å¸¸æ•° $\lambda$ã€éé›¶åˆ—å‘é‡ $\vec{v}$ æ»¡è¶³ $\lambda \vec{v} = A \vec{v}$ï¼Œåˆ™ç§° $\lambda$ ä¸ºçŸ©é˜µ $A$ çš„<strong>ç‰¹å¾å€¼</strong>ï¼Œ$\vec{v}$ ä¸ºçŸ©é˜µ $A$ çš„<strong>ç‰¹å¾å‘é‡</strong>ã€‚</p>
</li>
<li><p>ä¸ŠæŸ¿å¯ä»¥å†™ä½œ $(\lambda I - A)\vec{v} = 0$, å·¦è¾¹æ‹¬å·é‡Œé‚£ç©æ„æ˜¯çŸ©é˜µçš„è¡Œåˆ—å¼ï¼Œè®°åš $f(\lambda)$ï¼Œå³ä¸ºçŸ©é˜µ $A$ çš„<strong>ç‰¹å¾å¤šé¡¹å¼</strong>ï¼Œåˆ™å¯¹äºæŸä¸ªçŸ©é˜µçš„ç‰¹å¾å€¼ $\lambda_0$, æœ‰ $f(\lambda_0) = 0$ã€‚</p>
</li>
<li><p>ï¼ˆæ³¨æ„ï¼šè¡Œåˆ—å¼å’ŒçŸ©é˜µä¹˜ä»¥ä¸€ä¸ªæ•° $k$ æ—¶æ˜¯ä¸åŒçš„ï¼Œè¡Œåˆ—å¼æ˜¯æŸè¡Œæˆ–æŸåˆ—ä¹˜ $k$ï¼ŒçŸ©é˜µæ˜¯æ‰€æœ‰æ•°ä¹˜ $k$ã€‚åˆ«é—®ä¸ºå•¥ï¼Œè¿™å°±æ˜¯å®šä¹‰ã€‚ï¼‰</p>
</li>
</ul>
</li>
<li><p>çŸ©é˜µç‰¹å¾å¤šé¡¹å¼å’Œä¸€ä¸ªè‘—åå®šç†</p>
<ul>
<li><p>å‡¯è±-å“ˆå¯†é¡¿å®šç†ï¼š$f(A) = 0$.</p>
</li>
<li><p>æ±‚è§£ï¼š$f(\lambda) = |\lambda I - A| = \lambda^m - \sum\limits_{i = 0}^{k - 1} a_{k - i} \lambda^i$</p>
</li>
</ul>
</li>
</ol>
<p>ç”±ä¸Šé¢é‚£ä¸ªæŸ¿å­å¾—åˆ° $f(A) = A^k - b_1A^{k - 1} - c_2A^{k - 2}  â€¦ - c_k = 0$, å³ $A^k = c_1A^{k - 1} + â€¦ + c_k$ï¼Œè¿™å‘Šè¯‰æˆ‘ä»¬ $A_k$ å¯ä»¥è¢« $A^0$ ~ $A^{k - 1}$ çš„çŸ©é˜µçº¿æ€§è¡¨å‡ºï¼ï¼ˆå“‡ï¼Œæœ‰çº¿ä»£å†…å‘³äº†</p>
<p>$A^{x + y} = A^x * A^y$,</p>
<p>$A^x = \sum b_i A^i$, $A^y = \sum c_i A^i$</p>
<p>å› ä¸ºæœ‰ $f(A) = 0$ï¼Œæ‰€ä»¥ $A^{x + y} = \sum\limits_{k = 0}^{2K - 2} (\sum\limits_{i = 0}^{K - 1} b_ic_{k - i})A^k\ mod\ f(A)$ï¼Œè¿™ä¸ªå–æ¨¡è¾¾åˆ°äº†é™æ¬¡çš„æ•ˆæœã€‚ç”¨å¿«é€Ÿå¹‚å°±æ˜¯ $O(K^2 logn)$ çš„ã€‚</p>
<p>zhouzhendong å¤§ä½¬åšå®¢é‡Œæœ‰<del>éäºº</del>ç¥ä»™ $O(klogklogn)$ å¤šé¡¹å¼æ“ä½œï¼Œç„¶è€Œå¸¸äººéƒ½å†™ä¸åŠ¨å§ QAQï¼Ÿï¼ˆå°±å…ˆä¸å­¦äº†</p>
<p>$Template$ï¼š<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bzoj_4161</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>, N = <span class="number">4e3</span> + <span class="number">5</span>;</span><br><span class="line">ll n, K, a[N], b[N], len;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(ll &amp;x, ll y)</span> </span>&#123; x = (x + y) % mod; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Mul</span><span class="params">(ll x[], ll y[])</span> </span>&#123;</span><br><span class="line">    ll tmp[N];</span><br><span class="line">    <span class="built_in">memset</span>(tmp, <span class="number">0</span>, <span class="keyword">sizeof</span>(tmp));</span><br><span class="line">    rep(i, <span class="number">0</span>, len)</span><br><span class="line">        rep(j, <span class="number">0</span>, len)</span><br><span class="line">            add(tmp[i + j], x[i] * y[j] % mod);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> * len; i &gt; len; i--) &#123;  <span class="comment">// åœ¨å–æ¨¡</span></span><br><span class="line">        <span class="keyword">if</span> (!tmp[i]) <span class="keyword">continue</span>;</span><br><span class="line">        rep(j, <span class="number">1</span>, len + <span class="number">1</span>)</span><br><span class="line">            add(tmp[i - j], a[j] * tmp[i] % mod);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">0</span>, len)</span><br><span class="line">        x[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll c[N];  <span class="comment">// ç³»æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fpow</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> ll tmp[N];</span><br><span class="line">    <span class="built_in">memset</span>(tmp, <span class="number">0</span>, <span class="keyword">sizeof</span>(tmp));</span><br><span class="line">    <span class="built_in">memset</span>(c, <span class="number">0</span>, <span class="keyword">sizeof</span>(c));</span><br><span class="line">    c[<span class="number">0</span>] = tmp[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; n; n &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &amp; <span class="number">1</span>) Mul(c, tmp);</span><br><span class="line">        Mul(tmp, tmp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; K;</span><br><span class="line">    len = K - <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, K) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">0</span>, K - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;b[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    fpow(n);</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">0</span>, len)</span><br><span class="line">        add(ans, b[i] * c[i] % mod);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, (ans % mod + mod) % mod);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><a href="https://loj.ac/p/2981" target="_blank" rel="noopener">$THUSCH2017-å¦‚æœå¥‡è¿¹æœ‰é¢œè‰²$</a></p>
<p>è¿™é¢˜æ¯”æ´›è°·ä¸Šçš„æ¨¡æ¿é¢˜å¤šäº†ä¸ªç›¸é‚» m é¡¹é¢œè‰²ä¸èƒ½å…¨ä¸åŒçš„é™åˆ¶ã€‚</p>
<p>$|X/G| = \frac{1}{|G|} \sum_g m^{c(g)} = \frac{1}{|G|} \sum_k \phi(n / k) * f(k)$</p>
<p>ç°åœ¨è¦ç®— $f(gcd = k)$ çš„æŸ“è‰²æ–¹æ¡ˆæ•°ã€‚å¯ä»¥çŠ¶å‹è®¡ç®—ï¼ŒçŠ¶æ€æ•°æ˜¯ $m^{m}$ï¼Œç›´æ¥è·‘çŸ©é˜µå¿«é€Ÿå¹‚èƒ½æ‹¿åˆ° $55$ åˆ†çš„å¥½æˆç»©ï¼Œç„¶åæˆ‘å°±ä¸ä¼šäº†</p>
<p>é¢˜è§£å‘Šè¯‰æˆ‘è¦å»å­¦å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨ï¼Œæˆ‘å°±æ»šå»å­¦äº†ã€‚åšåšï¼Œæ–°çŸ¥è¯†ï¼ï¼ˆäºæ˜¯å°±æœ‰äº†è¿™ç¯‡æ‹¼å‡‘èµ·æ¥çš„ç¬”è®°</p>
<p>çŒœæµ‹é€’æ¨å¼é•¿åº¦å°äº $m^{m}$ï¼Œå€ŸåŠ©è¶…èƒ½åŠ›ï¼ˆæ‰“è¡¨ï¼‰å‘ç° $m = 7$ å°± $409$.</p>
<p><a href="https://loj.ac/s/1012066" target="_blank" rel="noopener">$Code$</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/12/11/[ZJOI2019]-å¼€å…³/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/12/11/[ZJOI2019]-å¼€å…³/" itemprop="url">
                  [ZJOI2019]-å¼€å…³
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-12-11T14:53:05+08:00">
                2020-12-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="æ–¹æ³•ä¸€-ç”Ÿæˆå‡½æ•°"><a href="#æ–¹æ³•ä¸€-ç”Ÿæˆå‡½æ•°" class="headerlink" title="$æ–¹æ³•ä¸€:ç”Ÿæˆå‡½æ•°$"></a>$æ–¹æ³•ä¸€:ç”Ÿæˆå‡½æ•°$</h2><p>â€œç¥ä»™é¢˜ï¼â€ï¼ˆå¹³åº¸çš„ xml å‘å‡ºæƒŠå¹ï¼‰</p>
<p>ç”Ÿæˆå‡½æ•°æ€ä¹ˆæƒ³åˆ°çš„å•Šï¼Ÿ/yiw ä½†çš„ç¡®å¾ˆç¬¦åˆï¼Œå› ä¸ºæŒ‰é”®æ˜¯æœ‰é¡ºåºçš„ï¼Œè€Œæ¯ä¸ªé”®æŒ‰å¤šå°‘æ¬¡æ¦‚ç‡ä¹Ÿä¸åŒï¼Œé€‚åˆç”¨å½¢å¼å¹‚çº§æ•°è¡¨ç¤ºã€‚</p>
<p>è®¾ $P = \sum p$.</p>
<p>åˆ†å¼€è€ƒè™‘æ¯ä¸ªé”®ã€‚è€ƒè™‘ $[x^k]F_i(x)$ è¡¨ç¤ºç¬¬ $i$ ä¸ªä½ç½®æŒ‰äº† $k$ æ¬¡çš„æ¦‚ç‡è´¡çŒ®ã€‚å½“ç„¶æ˜¯ EGF å•¦å› ä¸ºæ˜¯æœ‰é¡ºåºçš„æŒ‰ã€‚<br>$$F_i(x) = \sum\limits_{n \geq 0} [n\ mod\ 2 == s_i] \frac{ ( \frac{p_i}{P} ) ^n}{n!} x^n$$<br>$$F(x) = \prod F_i(x)$$<br>å†™æˆ OGF $$f(x) = \sum_k (k! <em> [x^k]F(x)) </em> x^k$$</p>
<p>$[x^k]G_i(x)$ è¡¨ç¤ºç¬¬ $i$ ä¸ªä½ç½®æŒ‰äº† $k$ æ¬¡ï¼ŒçŠ¶æ€ä¸å˜çš„æ¦‚ç‡ã€‚</p>
<p>ç„¶è€Œåªæœ‰ $F$ èƒ½å¹²å•¥å‘¢ï¼Ÿæˆ‘ä»¬è¦æ±‚çš„æ˜¯<strong>ç¬¬ä¸€æ¬¡</strong>åˆ°è¾¾ç›®æ ‡çŠ¶æ€ï¼Œæ‰€ä»¥éœ€è¦å®¹æ–¥ã€‚å…·ä½“æ¥è¯´ï¼Œè®¾ $g(x)$ è¡¨ç¤º $k$ æ¬¡çŠ¶æ€ä¸å˜çš„ OGFï¼Œå¯æŒ‰ä¸Šè¿°æ–¹æ³•æ±‚å‡ºï¼›è®¾ $h(x)$ ä¸ºç­”æ¡ˆ OGFï¼Œåˆ™ $f(x) = g(x) \cdot h(x)$, åˆ™ $h(x) = \frac{f(x)}{g(x)}$.</p>
<p>æ ¹æ®æœŸæœ›çš„å®šä¹‰ï¼Œç­”æ¡ˆå½¢å¦‚ $\sum_i if(i)$ ã€‚å•Šè¿™ä¸å°±æ˜¯ $h(1)$ çš„å¯¼æ•°å˜›ï¼$hâ€™(1)$ å°±æ˜¯æœ€ç»ˆç­”æ¡ˆã€‚</p>
<p>$$G_i(x) = \sum\limits_{n \geq 0} [n\ mod\ 2 == 0] \frac{( \frac{p_i}{P} )^n}{n!} x^n$$<br>$$G(x) = \prod G_i(x)$$<br>å†™æˆ OGF $$g(x) = \sum_k (k! <em> [x^k]G(x)) </em> x^k$$</p>
<p>å†™æˆå°é—­å½¢å¼<br>$$F_i(x) = \frac{e^{\frac{p_i}{P}x} + (-1)^{s_i} e^{-\frac{p_i}{P}x}}{2}$$<br>$$F(x) = \prod \frac{e^{\frac{p_i}{P}x} + (-1)^{s_i} e^{-\frac{p_i}{P}x}}{2}$$<br>$$G_i(x) = \frac{e^{\frac{p_i}{P}x} + e^{-\frac{p_i}{P}x}}{2}$$<br>$$G(x) = \frac{e^{\frac{p_i}{P}x} + e^{-\frac{p_i}{P}x}}{2}$$<br>å°† $F(x)$ å†™æˆ $\sum c_i e^{\frac{i}{P}x}$ çš„å½¢å¼ï¼Œåˆ™æœ‰</p>
<p>$$f(x) = \sum_k \left( k![x^k]F(x) \right) x^k$$</p>
<p>$$= \sum_k k<img src="\sum_i c_i ( \sum_j \frac{(\frac{i}{P}x" alt="x^k">^j}{j!} ) )x^k$$</p>
<p>$$= \sum_k ( k! \sum_i c_i \frac{(\frac{i}{P})^k}{k!} ) x^k = \sum_k  (\sum_i c_i (\frac{i}{P})^k) x^k $$</p>
<p>$$= \sum_i c_i \sum_k (\frac{i}{P})^k x^k = \sum_i \frac{c_i}{1 - \frac{i}{P}x} $$</p>
<p>åŒç†æœ‰ $g(x) = \sum_i \frac{d_i}{1 - \frac{i}{P}x}$ã€‚$c_i$, $d_i$ å¯ä»¥ç®€å• $O(nP)$ èƒŒåŒ…å¾—å‡ºï¼</p>
<p>è¡¥å……æ±‚å¯¼åŠ å‡ä¹˜é™¤æ³•æ³•åˆ™ï¼š</p>
<p>$$(f(x) + g(x))â€™ = fâ€™(x) + gâ€™(x)$$</p>
<p>$$(f(x) - g(x))â€™ = fâ€™(x) - gâ€™(x)$$</p>
<p>$$(f(x) \cdot g(x))â€™ = fâ€™(x)g(x) + f(x)gâ€™(x)$$</p>
<p>$$(\frac{f(x)}{g(x)})â€™ = \frac{fâ€™(x)g(x) - f(x)gâ€™(x)}{g(x)^2}$$</p>
<p>æ‰€ä»¥è¦æ±‚ $hâ€™(x)$ï¼Œåªè¦è®¡ç®—å‡º $f(1)$, $fâ€™(1)$, $g(1)$, $gâ€™(1)$.</p>
<p><strong>ç„¶ååˆæ˜¯å¸¸è¯†é—®é¢˜ï¼šæ— çŸ¥å¦‚æˆ‘å°±æƒ³ç›´æ¥å¸¦ 1 è¿›å»äº†ï¼Œä½†è¿™ä¸è¡Œï¼ï¼ï¼å› ä¸º $i = P$ é¡¹çš„å­˜åœ¨ï¼Œå‡½æ•°ä¸æ”¶æ•›ï¼ï¼ï¼</strong></p>
<p>æ€ä¹ˆåŠï¼Ÿä¹˜ä¸Š $1 - x$</p>
<p>$$f(x) = c_P + \sum\limits_{i \neq P} \frac{c_i(1 - x)}{1 - \frac{i}{P}x}$$</p>
<p>$$f(1) = c_P$$</p>
<p>$$fâ€™(x) = \sum\limits_i \frac{ -c_i(1 - \frac{i}{P}x) - (c_i - c_ix)(-\frac{i}{P}) }{(1 - \frac{i}{P}x)^2} = \sum\limits_i \frac{ (\frac{i}{P} - 1)c_i }{ (\frac{i}{P}x - 1)^2 } $$</p>
<p>$$fâ€™(1) = \sum\limits_{i \neq P} \frac{c_i}{\frac{i}{P} - 1}$$</p>
<p>åŒç† $g(1) = d_P$, $gâ€™(1) = \sum\limits_{i \neq P} \frac{d_i}{\frac{i}{P} - 1}$</p>
<p>$$hâ€™(1) = \sum\limits_{i \neq P} \frac{c_id_P - c_Pd_i}{(i - 1)d_P^2}$$</p>
<p>ç¥å¥‡ï¼</p>
<p><a href="https://loj.ac/s/1010266" target="_blank" rel="noopener">$Code$</a></p>
<p>ä»ä¸­è·å¾—çš„å¯ç¤ºï¼š</p>
<ul>
<li>å¤šè€ƒè™‘å®é™…æ„ä¹‰ï¼Œä¾‹å¦‚æœ¬é¢˜ä¸­æœŸæœ› -&gt; å¯¼æ•°ã€‚</li>
<li>æ¨æŸ¿å­ï¼šé¢å¯¹å¤šé¡¹å¼æŸæ‰‹æ— ç­–ï¼Œä¸å¦‚æŠŠå®ƒå˜æˆå°é—­å½¢å¼æäº‹æƒ…ï¼Œå¤šé¡¹å¼çš„åŠ å‡ä¹˜é™¤å’Œæ•°çš„åŠ å‡ä¹˜é™¤ç±»ä¼¼çš„ï¼Œè¿˜å¯ä»¥æ±‚å¯¼ã€lnã€expï¼Œå¤šå¥½å•Šï¼</li>
<li>æ¨æŸ¿å­ï¼šæŠŠ $\prod_{i = l}^{r}$ å˜æˆä¸€ä¸ª $r - l + 1$ æ¬¡çš„å¤šé¡¹å¼ï¼Œå°±å¯ä»¥ $\sum$ å•¦ï¼$\sum$ å°±èƒ½æäº‹æƒ…å•¦ï¼</li>
</ul>
<h2 id="æ–¹æ³•äºŒï¼šå¼‚æˆ–å·ç§¯"><a href="#æ–¹æ³•äºŒï¼šå¼‚æˆ–å·ç§¯" class="headerlink" title="$æ–¹æ³•äºŒï¼šå¼‚æˆ–å·ç§¯$"></a>$æ–¹æ³•äºŒï¼šå¼‚æˆ–å·ç§¯$</h2><p>å’•å’•ï¼Ÿ<del>ï¼ˆç”Ÿæˆå‡½æ•°æç´¯äº†</del></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/12/07/ã€è®¡åˆ’ã€‘åäºŒæœˆå­¦ä¹ è®¡åˆ’/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/12/07/ã€è®¡åˆ’ã€‘åäºŒæœˆå­¦ä¹ è®¡åˆ’/" itemprop="url">
                  åäºŒæœˆå­¦ä¹ è®¡åˆ’
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-12-07T07:36:40+08:00">
                2020-12-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><del>æˆ‘å°±æ˜¯å–œæ¬¢æŒ–æ·±å‘!</del></p>
<p>é•¿æ–‡ç»™æˆ‘çš„æ„Ÿè§‰ç‰¹åˆ«å®‰å¿ƒå•¦å…¶å®æ˜¯ã€‚ç„¶åä¸€äº›é¢˜ç›®çš„é¢˜è§£ä¹Ÿè¦æ•´ç†æ•´ç†ï¼Œå­¦ä¹ è®¡åˆ’ä¹Ÿè¦å®‰æ’ç»™è‡ªå·±çœ‹ã€‚</p>
<p>$1.16$ å‰çš„å­¦ä¹ è®¡åˆ’å°±, åˆ·</p>
<ul>
<li>$CodePlus$ï¼ˆé€‰ï¼‰</li>
<li>$NOI$ï¼ˆ12 ~ 20ï¼‰</li>
<li>$JOI$ï¼ˆé€‰ï¼‰â˜‘ï¸</li>
<li>æ¸…åé›†è®­ï¼ˆ14 ~ ?ï¼‰</li>
</ul>
<p>å¤šå­¦æ•°å­¦çŸ¥è¯†:</p>
<ul>
<li>ç¾¤è®ºâ˜‘ï¸</li>
<li>ç”Ÿæˆå‡½æ•°â˜‘ï¸</li>
<li>å•ä½æ ¹åæ¼”</li>
<li>æ–¯ç‰¹æ—ç›¸å…³</li>
</ul>
<p>updï¼šå®Œæˆåº¦æ„Ÿäººã€‚</p>
<hr>
<h2 id="mathcal-12-7"><a href="#mathcal-12-7" class="headerlink" title="$\mathcal{12.7}$"></a>$\mathcal{12.7}$</h2><hr>
<p>å†™äº† $Polya$ æ¿é¢˜ï¼Œå¤šé¡¹å¼ $exp$ æ¿é¢˜ï¼Œç„¶åç°åœ¨å·¨æƒ³å†™ä¸æ¿çš„é¢˜ï¼ˆ</p>
<h3 id="æ´›è°·4980-Polya-æ¿é¢˜"><a href="#æ´›è°·4980-Polya-æ¿é¢˜" class="headerlink" title="$æ´›è°·4980-Polya æ¿é¢˜$"></a><a href="https://www.luogu.com.cn/problem/P4980" target="_blank" rel="noopener">$æ´›è°·4980-Polya æ¿é¢˜$</a></h3><p>$Polya$ å®šç†ï¼š<br>$|X/G| = \frac{1}{|G|} \sum\limits_{g \in G} |M|^{c(g)}$</p>
<p>å…¶ä¸­</p>
<ul>
<li>$X$ æ˜¯ä¸è€ƒè™‘æœ¬è´¨ä¸åŒçš„æŸ“è‰²æ–¹æ¡ˆé›†åˆ</li>
<li>$G$ æ˜¯å„ç§ç¿»è½¬å•Šæ—‹è½¬å•Šç­‰æ“ä½œæ„æˆçš„ç½®æ¢ç¾¤</li>
<li>$X/G$ æ˜¯æœ¬è´¨ä¸åŒçš„æŸ“è‰²æ–¹æ¡ˆé›†åˆ</li>
<li>$M$ æ˜¯é¢œè‰²æ•°</li>
<li>$c(g)$ æ˜¯ç½®æ¢ $g$ çš„ä¸ç›¸äº¤å¾ªç¯ç½®æ¢ä¸ªæ•°</li>
</ul>
<p>ç„¶åè¿™é¢˜æˆ‘ä»¬ç›´æ¥å¥—å…¬å¼å°±å¯ä»¥åšï¼<br>$ans = \frac{1}{n} \sum\limits_{g \in G} n^{c(g)}$</p>
<p>æšä¸¾ $c(g)$ï¼Œè®¾ $g$ æ—‹è½¬äº† $i$ï¼Œåˆ™ $c(g) = gcd(n, i)$ï¼Œå› ä¸ºæŸä¸ªç‚¹åœ¨ç½®æ¢ $g$ çš„é‡å¤ä½œç”¨ä¸‹ç»è¿‡ $lcm(n, i)$ æ¬¡æ“ä½œå›åˆ°è‡ªèº«ï¼Œæ‰€ä»¥ $c(g) = \frac{n * i}{lcm(n, i)} = gcd(n, i)$</p>
<p>$\phi(n / i)$ ä¸ºå…¶ç³»æ•°ï¼Œä¸ºå•¥ï¼Ÿ</p>
<p>$\sum\limits_{k = 1}^{n} [gcd(n, k) == i]= \sum\limits_{k = 1}^{n / i} [gcd(n, k * i) == i]$</p>
<p>$= \sum\limits_{k = 1}^{n / i} [gcd(n / i, k) == 1] = \phi(n / i)$</p>
<p>æ‰€ä»¥æœ‰ $ans = \frac{1}{n} \sum\limits_{i | n} \phi(n / i) * n^i$, $O(\sqrt{n})$</p>
<h3 id="æ´›è°·5574-ä»»åŠ¡åˆ†é…é—®é¢˜"><a href="#æ´›è°·5574-ä»»åŠ¡åˆ†é…é—®é¢˜" class="headerlink" title="$æ´›è°·5574-ä»»åŠ¡åˆ†é…é—®é¢˜$"></a><a href="https://www.luogu.com.cn/problem/P5574" target="_blank" rel="noopener">$æ´›è°·5574-ä»»åŠ¡åˆ†é…é—®é¢˜$</a></h3><p>ä¸ºäº†é¡ºå£æˆ‘ä»¬æ±‚é€†åºå¯¹æœ€å°‘ï¼ˆç¿»è½¬ä¸€ä¸‹ $a[i]$ å°±å¥½ï¼‰</p>
<p>$calc(l, r)$ ä¸º $[l, r]$ çš„é€†åºå¯¹ä¸ªæ•°ã€‚çœ‹èµ·æ¥åƒæ–œç‡ä¼˜åŒ–ä½†å®ƒä¸èƒ½ã€‚ã€‚æˆ‘ç›¸ä¿¡ä¸€å®šå¯ä»¥ä¼˜åŒ–ï¼</p>
<p>å‘ç°æœ‰å†³ç­–å•è°ƒæ€§ï¼š$calc(l - 1, r + 1) + calc(l, r) \geq calc(l - 1, r) + calc(l, r + 1)$<br>æ˜“è¯ã€‚<br>äºæ˜¯å¯ä»¥ç»å…¸å†³ç­–å•è°ƒåˆ†æ²» + æ ‘çŠ¶æ•°ç»„æ¨åŒºé—´ã€‚<br>$O(Knlog^2n)$</p>
<h2 id="mathcal-12-8"><a href="#mathcal-12-8" class="headerlink" title="$\mathcal{12.8}$"></a>$\mathcal{12.8}$</h2><hr>
<h3 id="æ´›è°·4128-æœ‰è‰²å›¾"><a href="#æ´›è°·4128-æœ‰è‰²å›¾" class="headerlink" title="$æ´›è°·4128-æœ‰è‰²å›¾$"></a><a href="https://www.luogu.com.cn/problem/P4128" target="_blank" rel="noopener">$æ´›è°·4128-æœ‰è‰²å›¾$</a></h3><p>æŸ“è‰²çš„æ˜¯è¾¹ï¼Œè½¬çš„æ˜¯ç‚¹ã€‚è€ƒè™‘å¯¹äºæŸç§è½¬ç‚¹æ–¹æ¡ˆï¼Œå…¶ç­‰ä»·ç±»ä¸ªæ•°ã€‚é‚£è¾¹å°±è¦åˆ†<em>è¿æ¥åŒä¸ªå¾ªç¯çš„ç‚¹</em>å’Œ<em>è¿æ¥ä¸åŒå¾ªç¯çš„ç‚¹</em>è®¨è®ºã€‚</p>
<p>åŒä¸ªå¾ªç¯ï¼šè®¾é•¿åº¦ä¸º $b_i$ï¼Œæœ‰ $b_i / 2$ ç§ç­‰ä»·ç±»</p>
<p>ä¸åŒå¾ªç¯ï¼šç­‰ä»·ç±»å¤§å°ä¸º $lcm(b_i, b_j)$ï¼Œç­‰ä»·ç±»ä¸ªæ•°ä¸º $b_i * b_j / lcm(b_i, b_j) = gcd(b_i, b_j)$</p>
<p>ç°åœ¨çŸ¥é“äº†å…·ä½“ $b_i$ å°±èƒ½ç®—ç­”æ¡ˆäº†ã€‚<br>è€ƒè™‘ $n$ çš„åˆ†æ‹†ï¼Œ$n$ åªæœ‰ $53$ï¼Œååˆ†ç¨³ï¼ˆå®é™…ä¸Šè¦ $7e7$ï¼‰ï¼ˆé—®é¢˜ä¸å¤§ï¼‰</p>
<p>æˆ‘ä»¬æšä¸¾ $b$ çš„å¤šé‡é›†ï¼Œç³»æ•°ä¹ŸæŒºæ­£å¸¸çš„ï¼š$\frac{n!}{\prod b_i!} <em> \prod (b_i - 1)! </em> \frac{1}{c_i!}$</p>
<p>å…¶ä¸­ç¬¬ä¸€é¡¹æ˜¯æŠŠç‚¹åˆ†é…åˆ°å¤šé‡é›†é‡Œï¼Œç¬¬äºŒé¡¹æ˜¯æ¯ä¸ªé›†åˆæ’é¡ºåºï¼ˆæ˜¯ç½®æ¢å˜›ï¼‰ï¼Œç¬¬ä¸‰é¡¹æ˜¯é™¤æ‰å¤§å°ç›¸åŒçš„é›†åˆç®—é‡çš„æ–¹æ¡ˆã€‚</p>
<p>æœ‰åŒå€ç»éªŒé¢˜ï¼šHNOI2009-å›¾çš„åŒæ„è®¡æ•°ã€‚ç¬¬ä¸€ååº”æ˜¯æ— æ ‡å·è¿é€šå›¾è®¡æ•° + èƒŒåŒ…â€”â€”ä¸å¯¹åŠ²ï¼Œæˆ‘åªä¼šæœ‰æ ‡å·çš„ã€‚å†ä¸€æƒ³ï¼Œè¾¹çš„æœ‰æ— ä¸æ­£å¯¹åº”ç€æ­¤é¢˜ä¸­æŸ“æˆé»‘æˆ–ç™½è‰²å—ï¼Ÿäºæ˜¯çœ‹é¢˜è§£ï¼ŒæœçœŸå°±æ˜¯æœ‰è‰²å›¾çš„å¡å¸¸ç‰ˆâ€”â€”æŠŠ gcd åœ¨ä¸­é€”è®¡ç®—æ‰å°±èƒ½ AC æ­¤é¢˜ã€‚</p>
<h2 id="mathcal-12-9"><a href="#mathcal-12-9" class="headerlink" title="$\mathcal{12.9}$"></a>$\mathcal{12.9}$</h2><hr>
<h2 id="mathcal-12-10"><a href="#mathcal-12-10" class="headerlink" title="$\mathcal{12.10}$"></a>$\mathcal{12.10}$</h2><hr>
<h3 id="ZJOI2019-å¼€å…³"><a href="#ZJOI2019-å¼€å…³" class="headerlink" title="$ZJOI2019-å¼€å…³$"></a><a href="https://www.luogu.com.cn/problem/P5326" target="_blank" rel="noopener">$ZJOI2019-å¼€å…³$</a></h3><p>å•ç‹¬å†™åšå®¢äº†</p>
<h2 id="mathcal-12-11"><a href="#mathcal-12-11" class="headerlink" title="$\mathcal{12.11}$"></a>$\mathcal{12.11}$</h2><hr>
<h3 id="BZOJ4221-Kangaroo"><a href="#BZOJ4221-Kangaroo" class="headerlink" title="$BZOJ4221-Kangaroo$"></a><a href="https://darkbzoj.tk/problem/4221" target="_blank" rel="noopener">$BZOJ4221-Kangaroo$</a></h3><p>æˆ‘ä»¬å‘ç°è¢‹é¼ å’Œè¢‹å­å¯æ‹†ã€‚ä¸å¦¨åˆ†åˆ«å‡åºæ’åˆ—ï¼Œçœ‹èµ·æ¥å¾ˆå¯ä»¥ dpã€‚æˆ‘ä»¬è¦åšåˆ°çš„å°±æ˜¯æ²¡åŒ¹é…çš„ $min(a) \geq max(b)$ã€‚</p>
<p>æšä¸¾ä»å·¦å¾€å³ç¬¬ä¸€ä¸ªæ²¡æœ‰è¢«å¡åˆ°è¢‹å­é‡Œçš„è¢‹é¼  $s$ï¼Œå¯¹äºè¿™ä¸ª $s$ æ‰¾åˆ°å®ƒèƒ½åŒ¹é…çš„æœ€å°çš„è¢‹å­ $t$ã€‚ç”±äº $s$ æ˜¯ç¬¬ä¸€ä¸ªæ²¡åŒ¹é…çš„è¢‹é¼ ï¼Œ$s$ å·¦è¾¹çš„è¢‹é¼ å’Œ $t$ åŠå…¶å³è¾¹çš„è¢‹å­éƒ½è¢«åŒ¹é…äº†ã€‚æ€ä¹ˆç»Ÿè®¡æ–¹æ¡ˆæ•°ï¼Ÿæšä¸¾è·¨è¶Š $(s, t)$ çš„å¯¹æ•°ï¼Œå³å°äº $s$ çš„è¢‹é¼ åŒå¤§äº $t$ çš„è¢‹å­åŒ¹é…ã€‚é™¤å»è¿™äº›ï¼Œå‰©ä¸‹çš„åŒ¹é…å¯¹å°±æ˜¯å°äº $s$ å’Œå°äº $t$ï¼Œå¤§äº $s$ å’Œå¤§äº $t$ã€‚å·¦å³åˆ†åˆ« $n^2$ dpã€‚</p>
<p><a href="https://darkbzoj.tk/submission/99567" target="_blank" rel="noopener">$Code$</a></p>
<h2 id="mathcal-12-12"><a href="#mathcal-12-12" class="headerlink" title="$\mathcal{12.12}$"></a>$\mathcal{12.12}$</h2><hr>
<p>ä¸‹åˆçš„ THUPC2020ï¼Œäº«å—æ¯”èµ›ï¼Œå¥½å¥½æ‰“å§ï¼</p>
<h2 id="mathcal-12-13"><a href="#mathcal-12-13" class="headerlink" title="$\mathcal{12.13}$"></a>$\mathcal{12.13}$</h2><hr>
<p>ä¸ºäº†åšã€Œå¦‚æœå¥‡è¿¹æœ‰é¢œè‰²ã€ï¼Œå­¦ä¹ äº†åŠä¸ªå¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨ã€‚éå¸¸é¢“åºŸï¼Œè‚äº† 15 é¡µç”Ÿç‰©ã€‚</p>
<h2 id="mathcal-12-14"><a href="#mathcal-12-14" class="headerlink" title="$\mathcal{12.14}$"></a>$\mathcal{12.14}$</h2><hr>
<p>AC äº†ã€Œå¦‚æœå¥‡è¿¹æœ‰é¢œè‰²ã€ã€‚é¢˜è§£åœ¨ã€Œã€å­¦ä¹ ç¬”è®°ã€‘å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨ã€é‡Œã€‚ç°åœ¨æƒ³å»æ•°æ•°ã€‚</p>
<p>åšäº†ã€Œçƒ·åŸºè®¡æ•°ã€ï¼Œé¢˜è§£åœ¨ã€Œã€å­¦ä¹ ç¬”è®°ã€‘ç”Ÿæˆå‡½æ•°ã€</p>
<h3 id="comet2280-å¦ä¸€é“æ ‘é¢˜"><a href="#comet2280-å¦ä¸€é“æ ‘é¢˜" class="headerlink" title="$comet2280-å¦ä¸€é“æ ‘é¢˜$"></a><a href="https://cometoj.com/contest/48/problem/D?problem_id=2280" target="_blank" rel="noopener">$comet2280-å¦ä¸€é“æ ‘é¢˜$</a></h3><p>è®¡æ•°è½¬æœŸæœ›ï¼ŒæœŸæœ›ç”¨æ•´æ•°æ¦‚ç‡å…¬å¼æ‹†åˆ†ã€‚è¿™æ ·å°±åŒ–â€œæ°å¥½â€ä¸ºâ€œè‡³å°‘â€äº†ï¼Œç°åœ¨æˆ‘ä»¬è¦ç»Ÿè®¡èµ° $i - 1$ æ­¥ä¸ä¼šèµ°åˆ°ä¸€å—çš„æ–¹æ¡ˆæ•°ã€‚åªè¦å¹¶æŸ¥é›†æŠŠèµ°åˆ°ä¸€å—çš„å¹¶èµ·æ¥ï¼Œæ–¹æ¡ˆæ•°å°±æ˜¯ $(\prod (siz + 1)) - n$ï¼Œæœ€åè¿˜è¦å‡å» $n$ã€‚</p>
<h3 id="PKUWC2018-Slay-the-Spire"><a href="#PKUWC2018-Slay-the-Spire" class="headerlink" title="[$PKUWC2018-Slay the Spire$]"></a>[$PKUWC2018-Slay the Spire$]</h3><p>è¿™æ˜¯ä¸€é“æ±‚å’Œé¢˜ã€‚<br>å‡è®¾é€‰äº† $i$ å¼ å¼ºåŒ–ç‰Œå’Œ $m - i$ å¼ æ”»å‡»ç‰Œ</p>
<ol>
<li>$i &lt; K$ï¼Œ$i$ å¼ å¼ºåŒ–ç‰Œï¼Œ$K - i$ å¼ æœ€å¤§çš„æ”»å‡»ç‰Œ</li>
<li>$i \geq K$ï¼Œ$K - 1$ å¼ æœ€å¤§çš„å¼ºåŒ–ç‰Œï¼Œä¸€å¼ æœ€å¤§çš„æ”»å‡»ç‰Œã€‚</li>
</ol>
<p>æ­£ç¡®æ€§æ˜“è¯ã€‚æ‰€ä»¥åªè¦ $dp$ å°±å¥½äº†ï¼Ÿ$f[i, j]$ è¡¨ç¤ºå‰ $i$ å¼ å¼ºåŒ–ç‰Œæ‘¸äº† $j$ å¼ çš„å€æ•°å’Œï¼Œ$g[i, j]$ è¡¨ç¤ºå‰ $i$ å¼ æ”»å‡»ç‰Œæ‘¸äº† $j$ å¼ çš„å’Œã€‚æ³¨æ„ $dp$ çš„æ—¶å€™å¦‚æœæ”»å‡»ç‰Œæ•° $j \leq m - (K - 1)$ï¼Œé‚£åªèƒ½å–ä¸€å¼ ç‰Œï¼Œä¸ºäº†æ–¹ä¾¿ $dp$ æˆ‘ä»¬æŠŠæ”»å‡»ç‰Œå‡åºæ’åºï¼Œè¿™æ ·å–çš„ç‰Œå°±æ˜¯å½“å‰è¿™å¼ ã€‚ç¬¬ä¸€ç»´å¯ä»¥å€’åºææ‰ã€‚</p>
<h2 id="mathcal-12-15"><a href="#mathcal-12-15" class="headerlink" title="$\mathcal{12.15}$"></a>$\mathcal{12.15}$</h2><hr>
<p>åšäº†ã€Œçƒ·çƒƒè®¡æ•°ã€ï¼Œé¢˜è§£åœ¨ã€Œã€å­¦ä¹ ç¬”è®°ã€‘ç”Ÿæˆå‡½æ•°</p>
<h3 id="æ‰¾æ ‘"><a href="#æ‰¾æ ‘" class="headerlink" title="$æ‰¾æ ‘$"></a><a href="https://loj.ac/p/6622" target="_blank" rel="noopener">$æ‰¾æ ‘$</a></h3><p>è¦ç†è§£é€ã€‚è§£æ³•æ˜¯çŸ©é˜µæ ‘çš„å˜å½¢åº”ç”¨ï¼šä¼—æ‰€å‘¨çŸ¥çŸ©é˜µæ ‘åªèƒ½æ±‚ç”Ÿæˆæ ‘ä¸ªæ•°å’Œç”Ÿæˆæ ‘è¾¹ç§¯å’Œã€‚è€ƒè™‘å…¨æ˜¯å¼‚æˆ–æ€ä¹ˆåšï¼Œå°±æ˜¯åŠ ä¸€ç»´ $a[x, y, z]$ è¡¨ç¤ºçŸ©é˜µ $[x, y]$ ä½ç½®å€¼ä¸º $[z]$ çš„ä¸ªæ•°ï¼Œé‚£ä¹ˆæ±‚è¡Œåˆ—å¼çš„æ—¶å€™ä¹˜æ³•å˜æˆ $FWT$ å°±è¡Œäº†ã€‚</p>
<p>ä½†ä½ æ€ä¹ˆå®šä¹‰ $FWT$ çš„é€†å…ƒï¼Ÿå¤ª $naive$ äº†è¿˜æ˜¯ï¼</p>
<p>å…ˆ $FWT$ï¼Œå¯¹äºæ¯ä¸ª $[z]$ æ±‚å‡ºè¡Œåˆ—å¼æ”¾åœ¨ç­”æ¡ˆæ•°ç»„é‡Œï¼Œå†æŠŠç­”æ¡ˆæ•°ç»„ $IFWT$ å›å»å°±å¥½äº†ã€‚å¤æ‚åº¦ $O(n^32^w + n^2w2^w)$ï¼Œ$1e9$ï¼Œåœ¨æ±‚è¡Œåˆ—å¼é‚£é‡Œç‰¹åˆ¤ä¸€ä¸‹å¦‚æœå‡ºç° $0$ å°±ç›´æ¥è¿”å› $0$ï¼Œå°± $AC$ äº†ã€‚è¿™æ˜¯æ€ä¹ˆä¸€å›äº‹å‘¢ï¼Œå°ç¼–ä¹Ÿå¾ˆæƒŠè®¶ã€‚</p>
<h3 id="å¸Œæœ›"><a href="#å¸Œæœ›" class="headerlink" title="$å¸Œæœ›$"></a><a href="https://loj.ac/p/3053" target="_blank" rel="noopener">$å¸Œæœ›$</a></h3><p>ä¹‹å‰åšçš„ï¼Œè®°å½•ä¸€ä¸‹ã€‚</p>
<p>åˆ«è¢«é«˜å¤§ä¸Šçš„é¢˜ç›®å”¬ä½äº†ï¼æ€è·¯å°±æ˜¯ç®—ä¸€ä¸ªæ•‘æ´é˜Ÿçš„ç­”æ¡ˆï¼Œç„¶å $k$ æ¬¡æ–¹ã€‚ç‚¹ $x$ å­æ ‘é‡Œå’Œå­æ ‘å¤–çš„è¦åˆ†å¼€ç®—ã€‚è€ƒè™‘ç›´æ¥ç®—ä¼šç®—é‡â€”â€”ä¸€ä¸ªè¿é€šå—ä¼šè¢«ç®—å¤šæ¬¡ï¼Œåº”ç”¨ç»å…¸â€œç‚¹å‡è¾¹â€æ€æƒ³â€”â€”è¿é€šå—ä¸­ç‚¹æ•° = è¾¹æ•° + 1ï¼Œå°±ç”¨ç‚¹çš„ç­”æ¡ˆå‡å»è¾¹çš„ç­”æ¡ˆã€‚</p>
<p>$f[x, i]$ è¡¨ç¤ºå­æ ‘é‡Œæ·±åº¦ä¸è¶…è¿‡ $i$ çš„è¿é€šå—æ–¹æ¡ˆæ•°ï¼Œ$g[x, i]$ è¡¨ç¤ºä¸åŒ…æ‹¬å­æ ‘é‡Œï¼ˆä½†åŒ…æ‹¬ $x$ï¼‰çš„æ·±åº¦ä¸è¶…è¿‡ $i$ çš„è¿é€šå—æ–¹æ¡ˆæ•°ï¼Œä¸¤ä¸ªä¸€ä¹˜å²‚ä¸ç¾å“‰ï¼Ÿ</p>
<p>è½¬ç§»æ–¹ç¨‹è¶…å¥½å†™ï¼š</p>
<ul>
<li>$f[x, i] = (\prod f[y, i - 1]) + 1$</li>
<li>$g[x, i] = (g[fa[x], i - 1] \prod f[son[fa[x]], i - 2]) + 1$</li>
</ul>
<p>$n$ $1e6$, $dp$ åˆä¸æ·±åº¦æœ‰å…³ï¼Œäºæ˜¯æƒ³åˆ°é•¿å‰–ä¼˜åŒ–ã€‚æœ¬é¢˜çš„æ€è·¯åˆ°æ­¤ä¸ºæ­¢ï¼Œæ¥ä¸‹æ¥ éƒ½ æ˜¯ ç»† èŠ‚</p>
<p>$f$ å¯ä»¥ç›´æ¥ç®—ï¼Œä½†æ˜¯ $g$ é‡Œé¢é‚£ä¸ª $\prod$ ä¸å¥½æã€‚</p>
<p>ç”¨å›é€€æ ˆå¯ä»¥ç»´æŠ¤ï¼Œåš $f$ çš„æ—¶å€™ä»é•¿åˆ°çŸ­éå†å­æ ‘ï¼Œåš $g$ çš„æ—¶å€™ä»çŸ­åˆ°é•¿éå†å­æ ‘ã€‚</p>
<h2 id="mathcal-12-16"><a href="#mathcal-12-16" class="headerlink" title="$\mathcal{12.16}$"></a>$\mathcal{12.16}$</h2><hr>
<p>æ¸æ¸ï¼Œå¯¹äºå®‰é€¸äº«ä¹çš„äººå®ƒæ˜¯ä¸€æ¡é•¿é•¿çš„ä¸‹å¡è·¯ï¼Œé€šå‘æ·±æ¸Šï¼›å¯¹äºä¸Šè¿›çš„äººå®ƒæ˜¯ä¸€æ¡é•¿é•¿çš„é˜¶æ¢¯ï¼Œé€šå‘å¤©å ‚ã€‚</p>
<p>ä¸ºäº†ä¸æ»‘è¿›æ·±æ¸Šæˆ‘åªæœ‰æ‹¼å°½å…¨åŠ›ã€‚<strong>æˆ‘è¦ç»ˆæ­¢çœ‹é¢˜è§£çš„ä¸è‰¯ä¹ æƒ¯â€”â€”å†è¿™æ ·ä¸‹å»ï¼Œxmlï¼Œä½ ä¼šå…‰é€Ÿé€€å½¹çš„ã€‚</strong></p>
<p>cometç¬¬å…­åœº Eï¼Œuoj311ï¼Œuoj370ï¼Œuoj316ï¼Œloj2570, vp ä¸€åœº cfï¼ˆå“¼ï¼Œç—´äººè¯´æ¢¦ï¼‰</p>
<h3 id="LOJ6356-å››è‰²ç¯"><a href="#LOJ6356-å››è‰²ç¯" class="headerlink" title="$LOJ6356-å››è‰²ç¯$"></a><a href="https://loj.ac/p/6356" target="_blank" rel="noopener">$LOJ6356-å››è‰²ç¯$</a></h3><p>$O(nm)$ æ˜¯éå¸¸å¥½åšçš„å•Šï¼Œç®—å‡ºæ¯ä¸ªä½ç½®è¢«ç»è¿‡çš„æ¬¡æ•° $cnt$ï¼Œè´¡çŒ®å°±æ˜¯ $\sum_k C(cnt, 4k) * 2^{m - cnt}$</p>
<p>è€ƒè™‘ $cnt \in [0, 20]$ï¼Œæˆ‘ä»¬æšä¸¾é€‰äº†å“ªäº› $x_i$ã€‚è®¾è¯¥é›†åˆä¸º $s$ï¼Œé‚£ä¹ˆè¢« $lcm(x \in S)$ ç»è¿‡çš„ç‚¹åº”å½“æœ‰è´¡çŒ®ã€‚ä½†æ˜¯å¯¹äº $s \subset sâ€™$ï¼Œ$sâ€™$ ç»è¿‡çš„ç‚¹ $s$ ä¹Ÿç»è¿‡äº†ï¼Œæ‰€ä»¥éœ€è¦å®¹æ–¥å‡ºè¢« $s$ ç»è¿‡ä¸”ä¸è¢«ä»»ä½• $s$ çš„è¶…é›†ç»è¿‡çš„ç‚¹ä¸ªæ•°ï¼Œè¡¨ç¤ºä¸º $g[s]$ã€‚</p>
<p>ç›´æ¥æšä¸¾è¶…é›† $O(3^m)$ï¼ŒTLEï¼›è€ƒè™‘è¿›ä¸€æ­¥ä¼˜åŒ–ã€‚å†™å‡ºæŸ¿å­ï¼š$\sum_s g[s] \sum_k C(|S|, 4k) * 2^{m - |S|}$ï¼Œå‘ç° $|S|$ ç›¸åŒçš„å¯ä»¥æ‹¢åˆ°ä¸€èµ·ã€‚è®¾ $G[i] = \sum\limits_{|S| = i} g[s]$ï¼Œ$G$ å¾ˆå®¹æ˜“å®¹æ–¥å¾—åˆ°ï¼Œæ¯”å¦‚ $j &gt; i$ï¼Œè€ƒè™‘ $G[j]$ å¯¹ $G[i]$ çš„å®¹æ–¥è´¡çŒ®ï¼Œåªæ˜¯æŠŠåŸå…ˆåˆ†é¡¹å¹¶åˆ°äº†ä¸€èµ·ï¼Œä¹˜ç»„åˆæ•° $C(j, i)$ å°±å¥½ã€‚</p>
<p><a href="https://loj.ac/s/1013566" target="_blank" rel="noopener">$Code$</a></p>
<h2 id="mathcal-12-17"><a href="#mathcal-12-17" class="headerlink" title="$\mathcal{12.17}$"></a>$\mathcal{12.17}$</h2><hr>
<p>æ„Ÿè§‰åšäº‹åƒæœ‰é˜»åŠ›ä¸€æ ·ã€‚è¿™é˜»åŠ›æ¥è‡ªå“ªé‡Œï¼Ÿè¿‡äºæ³¨é‡å½¢å¼ï¼Œä¾¿é¢“åºŸäº†ã€‚è¿™é˜»åŠ›ä¹Ÿæ˜¯çŠ¹è±«ä¸å†³ï¼Œæ˜¯è‡ªæˆ‘æ€€ç–‘ï¼Œè™½ç„¶å·²ç»æ¯”å‰å‡ ä¸ªæœˆçš„æˆ‘ç—‡çŠ¶è½»å¤šäº†ã€‚åŒè„šå¾€å‰æŠµç€æ€ä¹ˆä¼šèµ°çš„å¿«ã€èµ°å¾—è½»æ¾å‘¢ï¼Ÿ</p>
<p>çœ‹é¢˜è§£è¿™ä¸ªäº‹æƒ…ï¼Œæœ¬è´¨æ˜¯æ€¥äºæ±‚æˆï¼Œä½†åªæ˜¯ä¸€æ—¶ä¹‹åˆ©ï¼Œäºé•¿è¿œåˆ™æ˜¯é€€å½¹çš„åŠ é€Ÿå™¨ã€‚æ€è€ƒçš„å……åˆ†ä¸€ç‚¹ï¼Œä¸€é“é¢˜åšå‡ ä¸ªå°æ—¶ä¹Ÿæ˜¯ä¸äºçš„ã€‚<strong>åŠ¡å¿…ä»ç°åœ¨å¼€å§‹åŠ å¼ºç‹¬ç«‹æ€è€ƒï¼ï¼ï¼</strong></p>
<p>æœºæˆ¿çš„å¤§ç¯å¢ƒä¸æˆ‘æ˜¯ä¸¤ä¸ªä¸–ç•Œï¼Œå¸¦ä¸Šè€³å¡ï¼Œæ²‰æµ¸åœ¨è‡ªå·±çš„æ¢ç©¶ä¸­ã€‚å…¥ç¥æ—¶ä¾¿ä¸å—å¤§ç¯å¢ƒå½±å“äº†ã€‚</p>
<p>åšé¢˜é‡è¦é‡‡å–ç­–ç•¥æ¥ä¿è¯ï¼Œä¸€å¤©ä¸€å¥— CFã€‚æˆ‘æ˜¯è¯´ï¼Œåœ¨å­¦æ•°å­¦çš„åŒæ—¶ä¹Ÿåˆ«å¿˜äº† CFï¼Œä½ çœ‹ zjyã€kqh CF éƒ½åˆ‡çš„å¾ˆå¤šã€‚åšå¥½é¢˜ï¼Œä¸è¦åšç½‘çº¢é¢˜ï¼Œè¦æŒ‰ç…§è‡ªå·±çš„å¼±ç‚¹æ¥é€‰é¢˜ã€‚æœ€è¿‘çš„çœé€‰æ¨¡æ‹Ÿèµ›ï¼Œæ‰“æ»¡æ—¶é—´æ„Ÿè§‰ä¸ç°å®ï¼Œä½†æ¯é“é¢˜éƒ½è¦æ€è€ƒé€ã€‚</p>
<p>å†™é¢˜ï¼Œæ€è€ƒé€å†å¼€ç ã€‚</p>
<p>æ¯å¤©åšæŒç€å……å®ç€ï¼Œæœ‰ä»˜å‡ºæœ‰æ”¶è·ï¼Œä¸€åˆ‡éƒ½ä¼šå˜å¥½çš„ï¼ï¼ï¼ï¼ˆæœ€è¿‘å°±æ˜¯æ•ˆç‡ä½ä¸‹ï¼Œæ„Ÿåˆ°ç©ºè™šäº†ã€‚</p>
<p>åŠ³è°¦å›å­ï¼Œæœ‰ç»ˆå‰ã€‚</p>
<h3 id="XJOI1626-T3"><a href="#XJOI1626-T3" class="headerlink" title="$XJOI1626 T3$"></a>$XJOI1626 T3$</h3><p>$n = 50$ æ˜¯ $TC$ åŸé¢˜ã€‚ä½†æ˜æ˜¾å¯ä»¥ä¼˜åŒ–å˜›ã€‚å‘ç°ç“¶é¢ˆåœ¨äºå®¹æ–¥æ—¶å¹¶æŸ¥é›†çš„æ“ä½œã€‚æƒ³åˆ°æ¯ä¸€ä½å»ºè™šç‚¹ã€‚è¿é€šå—æ•°ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šè¢«é€‰çš„è™šç‚¹å’Œä¸å®ƒç›¸è¿çš„ç‚¹ä»¬ï¼Œæ²¡è¢«é€‰çš„ç‚¹ä»¬ã€‚å¤§æ¦‚å¯ä»¥é«˜ç»´å‰ç¼€å’Œã€‚ï¼ˆé«˜ç»´å‰ç¼€å’Œè¿™ä¸ªä¸œè¥¿å°±æ˜¯ FMT å•¦ã€‚</p>
<h3 id="XJOI1627"><a href="#XJOI1627" class="headerlink" title="$XJOI1627$"></a>$XJOI1627$</h3><h4 id="T1"><a href="#T1" class="headerlink" title="$T1$"></a>$T1$</h4><p>ç»å…¸å¥—è·¯ï¼Œæ ‘ä¸Šè·¯å¾„é—®é¢˜è€ƒè™‘è¾¹åˆ†æ²»æˆ–è€…ç‚¹åˆ†æ²» + å †ã€‚æˆ‘åŸæ¥å†™çš„è¾¹åˆ†ï¼Œä¹Ÿå¯ä»¥å§ï¼Œä½†æ˜¯ç‚¹åˆ†å¤šé¦™å•Šï¼Œä¸ç”¨ä¸‰åº¦åŒ–ã€‚</p>
<p>ä¸ºä»€ä¹ˆä¸èƒ½å¯¹æ¯ä¸ªé‡å¿ƒå°†å­æ ‘å¤§å°æ’åºç®—ç­”æ¡ˆï¼Ÿæ¯ä¸ªé‡å¿ƒä¸¢ $K$ ä¸ªè·ç¦»åˆ°ç­”æ¡ˆå †é‡Œï¼Œå †ä¸å¾—ç‚¸æ‰ã€‚ã€‚å¤æ‚åº¦ä¹Ÿä¸å¯¹å˜›ã€‚â€”â€”é‚£å°±åˆ«æ€¥ç€ç®—å‡ºå½“å‰æœ€ä¼˜å•Šï¼Œä¸å¦‚æŠŠæ‰€æœ‰é‡å¿ƒå…¨éƒ¨è·‘å®Œå†ç®—æœ€ä¼˜ã€‚è¿™å°±æ˜¯è¶…çº§é’¢ç´çš„å¥—è·¯äº†ã€‚</p>
<p>å¯¹æ¯ä¸ªé‡å¿ƒï¼Œå®ƒçš„å­æ ‘ä¸­ç‚¹çš„è¿è¾¹æƒ…å†µæ˜¯ä¸€ä¸ªåŒºé—´ã€‚ä¸¢åŒºé—´è¿›å †ï¼Œ$st$ è¡¨ç»´æŠ¤ $\max$ã€‚æ¯æ¬¡å–åŒºé—´ï¼Œç»Ÿè®¡ç­”æ¡ˆï¼Œè£‚æˆä¸¤åŠã€‚</p>
<p>ç‚¹åˆ†æ²»çš„ä¼˜ç‚¹åœ¨å“ªå„¿å‘¢ï¼Ÿç‚¹å’Œç‚¹çš„è·ç¦»å¯ä»¥ç›´æ¥ç›¸åŠ å¾—å‡ºã€‚$O(nlog^2n + mlogn)$ï¼ŒAC ä¸äº†å°±å¾ˆéš¾å—ã€‚</p>
<p>updï¼šè¿™é¢˜é‡ç‚¹åœ¨è¶…çº§é’¢ç´å•Šï¼Œå‰é¢çš„æœ‰ä¸€ç™¾ç§åšæ³•ï¼Œåªè¦ä¿è¯è·ç¦»å¯ä»¥ç›´æ¥ç›¸åŠ å¾—å‡ºå°±å¥½ã€‚ç®€å•çš„ dfs åºä¸Šè·‘ä¹Ÿå¯ä»¥é¢ã€‚æˆ–è€…çº¿æ®µæ ‘ç»´æŠ¤ç›´å¾„é›†åˆã€‚</p>
<h4 id="T2"><a href="#T2" class="headerlink" title="$T2$"></a>$T2$</h4><p><a href="https://www.cnblogs.com/chdy/p/13114664.html" target="_blank" rel="noopener">é¢˜è§£</a></p>
<p>æˆ‘æƒ³äº†ä¸ª $O(\frac{n^4}{32})$ çš„ bitset å‡åšæ³•ï¼Œè¢«å¤§æ†ç»‘æ€äº†</p>
<p>çœ‹åˆ°è¿™ä¸ªçŸ©é˜µé‡Œæ’åˆ—çš„å½¢å¼å®¹æ˜“æƒ³åˆ°è¡Œåˆ—å¼çš„å®šä¹‰ï¼Œåˆ©ç”¨æŒ‡æ•°åŒ–åŠ ä¸ºä¹˜ï¼Œå¾—åˆ°ä¸€ä¸ªé¡¹æ•°ä¸º $nk$ çš„å¤šé¡¹å¼ï¼Œæˆ‘ä»¬åªå…³å¿ƒ $k$ çš„å€æ•°é¡¹ç³»æ•°æ˜¯å¦æœ‰ä¸ä¸º $0$ çš„ã€‚ä½†æ˜¯ç›´æ¥ç…§ç€ç®—è¡Œåˆ—å¼æ˜¯ä¸å¯¹çš„ï¼Œå› ä¸ºè¡Œåˆ—å¼æŸ¿å­é‡Œæœ‰ä¸ª $(-1)^{é€†åºå¯¹æ•°}$ çš„ç©æ„ï¼Œå¾ˆå®¹æ˜“æŠµæ¶ˆã€‚</p>
<p>ç›´æ¥ä¹˜ä¸€ä¸ª $rand$ å°±å¯ä»¥å•¦ï¼</p>
<p>ç„¶åä¹Ÿä¸ç”¨çœŸçš„æ‹‰æ ¼æœ—æ—¥æ’å€¼ï¼Œå¯ä»¥ç”¨å•ä½æ ¹çš„ç¥å¥‡æ€§è´¨ä¼˜åŒ–ã€‚å¾€é‡Œå¸¦ $mod - 1$ çš„ $K$ æ¬¡å•ä½æ ¹ $wn$ï¼Œå…¶ä¸­ $mod = vk + 1$ï¼Œå¸¦ $k$ æ¬¡ã€‚æ­£ç¡®æ€§è§å¤§ä½¬åšå®¢ï¼Œorzï¼</p>
<p>äº¤äº† $114514$ æ¬¡æ‰è¿‡çš„ã€‚å¤§æ†ç»‘æˆ‘åï¼</p>
<h4 id="T3"><a href="#T3" class="headerlink" title="$T3$"></a>$T3$</h4><p>ä¸€ä¸ªå¾ªç¯èŠ‚ $2$ çš„ä¸²ä¼šè¢« $4$ çš„æ—¶å€™å†ç»Ÿè®¡ä¸€æ¬¡ï¼Œè€ƒè™‘åæ¼”å‡ºæ¥ï¼š$f[i, j]$ è¡¨ç¤ºä»¥ $i$ ä¸ºç»“å°¾çš„ä¸²ï¼Œå¾ªç¯èŠ‚æ°å¥½ä¸º $j$ çš„ä¸ªæ•°ï¼Œ$g[i, j]$ è¡¨ç¤ºä»¥ $i$ ä¸ºèŠ‚ç‚¹çš„ä¸²ï¼Œå¾ªç¯èŠ‚æ˜¯ $j$ çš„å› æ•°çš„ä¸ªæ•°ã€‚é‚£ä¹ˆæ˜¾ç„¶æœ‰ $g[i, j] = \sum\limits_{d | j} f[i, d]$, $f[i, j] = \sum\limits_{d | j} g[i, d] * \mu(\frac{j}{d})$ã€‚ç­”æ¡ˆæ˜¯ $C(n + 1, 2) - \sum{f[i, j]}$ï¼Œç°åœ¨è€ƒè™‘æ€ä¹ˆç®— $g$.</p>
<p>æšä¸¾ $d$ï¼ŒæŠŠæ•´ä¸ªä¸²åˆ’åˆ†ä¸ºé•¿åº¦ä¸º $d$ çš„å—ï¼Œå—ä¸å—ä¹‹é—´çš„ä½ç½®æˆ‘ä»¬ç§°ä¸ºå…³é”®ç‚¹ï¼Œç®—å‡ºç›¸é‚»å…³é”®ç‚¹å‘å·¦çš„æœ€é•¿å…¬å…±åç¼€å’Œå‘å³çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚è¦ç›¸åŠ  $\geq d$ æ‰è¡Œï¼Œç»´æŠ¤åˆ°å½“å‰å—çš„æœ€é•¿åˆæ³•å—ä½ç½®å°±å¥½äº†ï¼Œæ˜¯ $O(nlogn)$ çš„ï¼$hehezhou$ $nb$ï¼ï¼ï¼</p>
<p>è¿˜æœ‰ä¸€ç§åšæ³•å°±æ˜¯å‘ç°æŸä¸ªç­”æ¡ˆä¸²å¿…ç„¶åŒ…å«äº† $Lyndon\ root$ï¼Œç„¶åè·‘ $Runs$ã€‚ï¼ˆè™½ç„¶æ²¡å¬æ‡‚ä½†è¿˜æ˜¯è¦è®°ä¸‹æ¥</p>
<h3 id="ZJOI2020-ä¼ ç»Ÿè‰ºèƒ½"><a href="#ZJOI2020-ä¼ ç»Ÿè‰ºèƒ½" class="headerlink" title="$ZJOI2020-ä¼ ç»Ÿè‰ºèƒ½$"></a><a href="https://loj.ac/p/3312" target="_blank" rel="noopener">$ZJOI2020-ä¼ ç»Ÿè‰ºèƒ½$</a></h3><p>å’Œ 19 å¹´çš„ä¸€æ ·è®¨è®ºå•Šã€‚ã€‚$K$ å¦‚æ­¤ä¹‹å¤§ï¼Œåˆ—å‡º $dp$ æ–¹ç¨‹åå®¹æ˜“æƒ³åˆ°çŸ©é˜µå¿«é€Ÿå¹‚å§ã€‚ç®—æ˜¯ 2.0 ç‰ˆæœ¬å§ï¼Œä¾æ—§è§‰å¾—ç»´æŠ¤è¿™äº”ä¸ªé‡â€”â€”è®¿é—®ç¥–å…ˆ/è‡ªå·±/å­æ ‘/å…„å¼Ÿ/ä¸äº¤ï¼ŒæŒºå·§å¦™çš„ã€‚$O(n3^3logK)$</p>
<p><a href="https://loj.ac/s/1014629" target="_blank" rel="noopener">$Code$</a></p>
<h2 id="mathcal-12-18"><a href="#mathcal-12-18" class="headerlink" title="$\mathcal{12.18}$"></a>$\mathcal{12.18}$</h2><hr>
<p>åˆšåˆšå»å¬äº†èŒä¸šè§„åˆ’çš„è®¡ç®—æœºä¸“åœºã€‚é«˜è–ªã€åˆ›æ–° å¤§æ¦‚æ˜¯ä¸€äº›å…³é”®è¯å§ã€‚ç†ç§‘è¦å¥½ã€‚èŒä¸šçš„æ´»åŠ¨æ€§å¾ˆå¤§ï¼ˆæˆ‘åœ¨è¯´ä»€ä¹ˆå•Šï¼‰å¯èƒ½æ€§å¾ˆå¤šã€‚ä¸»è¦æ˜¯åšå¤§æ•°æ®ï¼Œç½‘ç»œä¹‹ç±»çš„ã€‚è¯´å®è¯ç›®å‰çœŸæ²¡ä»€ä¹ˆå…´è¶£ã€‚å•è®ºå…´è¶£çš„è¯æœ€ç°å®çš„åº”è¯¥æ˜¯å°æç´å§ï¼ˆä½ è¿½çš„ä¸Šäººå®¶ä¸“ä¸šç”Ÿå˜›ï¼‰è¿˜æ²¡æƒ³å¥½ï¼Œæ€»ä¹‹å…ˆèµ°ç€å§ï¼Œâ€œå¦‚æœæ²¡æœ‰å‘ï¼Œå°±å…ˆè®©è‡ªå·±æˆä¸ºèåœâ€ã€‚</p>
<h3 id="UOJ549-åºåˆ—å¦™å¦™å€¼"><a href="#UOJ549-åºåˆ—å¦™å¦™å€¼" class="headerlink" title="[$UOJ549-åºåˆ—å¦™å¦™å€¼$]"></a>[$UOJ549-åºåˆ—å¦™å¦™å€¼$]</h3><p>åˆ† subtask dp æœ‰ 60 åˆ†ã€‚æ­£è§£æ€ä¹ˆåšï¼Ÿçœ‹åˆ° $2^8$ å’Œ $2^{16}$ï¼Œå®¹æ˜“æƒ³åˆ°å€¼åŸŸåˆ†å—ï¼Œé«˜ä½å…«ä½åˆ†å—åšï¼ˆâ€”â€”è¯´èµ·æ¥è¿˜æ˜¯åœ¨ä»Šå¹´åˆèµ›ç¬¬ä¸€æ¬¡ç¢°è§çš„è¿™ç§å¥—è·¯= = æœç„¶å¤ªé—­å¡äº†ï¼‰$f[i, j, s1, s2]$ è¡¨ç¤ºå‰ $i$ ä½ï¼Œåˆ† $j$ æ®µï¼Œé«˜å…«ä½å‰ç¼€å¼‚æˆ–å€¼æ˜¯ $s1$ï¼Œé¢„è®¡ä¸‹ä¸€ä¸ªè½¬ç§»çš„æ•°ä½å…«ä½ä¸º $s2$ã€‚æœ¬è´¨è¿˜æ˜¯å‡æ‘Šå¤æ‚åº¦ã€‚</p>
<h2 id="mathcal-12-20"><a href="#mathcal-12-20" class="headerlink" title="$\mathcal{12.20}$"></a>$\mathcal{12.20}$</h2><hr>
<h3 id="XJOI1629"><a href="#XJOI1629" class="headerlink" title="$XJOI1629$"></a>$XJOI1629$</h3><h4 id="T1-1"><a href="#T1-1" class="headerlink" title="$T1$"></a>$T1$</h4><p>éª—äº† 20 åˆ†ã€‚ã€‚= = æ„Ÿæ€§ç†è§£ä¸‹æœ€ä¼˜è§£ä¸€å®šæ˜¯ $max$ é‡Œçš„ $\sum$ ç›¸ç­‰çš„æƒ…å†µï¼ˆæ­£è§£å‘Šè¯‰ä½ å°±æ˜¯ä¸€å †ä¸€æ¬¡å‡½æ•°çš„äº¤ç‚¹ï¼‰ï¼Œç›´æ¥ $n^3$ é«˜æ–¯æ¶ˆå…ƒè§£æ–¹ç¨‹å°±èƒ½è·å¾— $60$ åˆ†çš„å¥½æˆç»©ã€‚</p>
<p>å…³äºæ­£è§£â€”â€”åˆ†æ²»ï¼ˆ$height$ ä¸Šå»ºç¬›å¡å°”æ ‘ï¼‰æ˜¯ç¥ï¼Œä» $height$ æœ€å°å¤„åˆ’æˆä¸¤åŠï¼Œåˆ† $k$ å°±å…ˆåˆ†ç»™ä¸€è¾¹ $1$ï¼Œå¤šäº†å¯ä»¥åšå®Œåä¹˜æ¯”ä¾‹ï¼Œè¿™ä¸ªä¹Ÿè¶…å¦™ã€‚åˆ†é…çš„æ¯”ä¾‹è¶Šå¤§ï¼Œ$max$ è¶Šå¤§ï¼Œæ¯”ä¾‹ä¸ $max$ æˆæ­£æ¯”ï¼Œè¿™è¿˜æ˜¯æ˜¾ç„¶çš„ã€‚</p>
<p>å·¦å³åˆå¹¶ï¼Œç­”æ¡ˆæ˜¯ $max( lans <em> x + (1 - x) </em> h, rans <em> (1 - x) + x </em> h )$ï¼Œæ˜¯ä¸¤ä¸ªä¸€æ¬¡å‡½æ•°ï¼Œå¿…ç„¶å­˜åœ¨ä¸€ä¸ªäº¤ç‚¹ï¼Œå³ä¸¤è€…ç›¸ç­‰ï¼Œå°±æ˜¯æœ€å°å€¼ï¼Œè§£æ–¹ç¨‹ç®— $x$ã€‚</p>
<p>ä¹Ÿå¯ä»¥ç”¨ $SAM$ çš„ $parent$ æ ‘ï¼Œæ ‘å½¢ $dp$ï¼Œåˆå¹¶ä¸¤ä¸ªå­æ ‘çš„æ—¶å€™è·Ÿä¸Šé¢ä¸€æ ·åˆ†é…æ¯”ä¾‹ã€‚</p>
<h4 id="T2-1"><a href="#T2-1" class="headerlink" title="$T2$"></a>$T2$</h4><p>hhz è®²äº†ä»çŸ©é˜µå¿«é€Ÿå¹‚åˆ‡å…¥çš„æ–¹æ³•ï¼Œä¸æ–­ä¼˜ä¼˜ä¼˜åŒ–ã€‚</p>
<p>é¦–å…ˆè€ƒè™‘æœ¬è´¨ä¸åŒå­åºåˆ—æ€ä¹ˆ $dp$ï¼š$dp[i]$ è¡¨ç¤ºä»¥ $i$ ç»“å°¾çš„æœ¬è´¨ä¸åŒå­åºåˆ—ä¸ªæ•°ï¼Œ$dp[i] = 1 + \sum\limits_{j = 1}^n dp[lst_j]$</p>
<p>ä¹˜æ³•æ˜¯ä¸€ä¸ªåˆ—å‘é‡ä¹˜ä¸€ä¸ªè½¬ç§»çŸ©é˜µçš„å½¢å¼ï¼Œåˆ—å‘é‡é‡Œè®°å½•çš„æ˜¯ $dp[lst_1]$, $dp[lst_2]$, â€¦ $dp[lst_m]$, $1$ã€‚è½¬ç§»çŸ©é˜µæœ‰ä¸€è¡Œå…¨æ˜¯ $1$ï¼Œè¿™æ ·é•¿çš„ç‰¹æ®Šçš„çŸ©é˜µå¾ˆç¨€ç–ï¼Œåªæœ‰ $O(n)$ ä¸ªä½ç½®ä¸º $1$ï¼Œä¹˜æ³•å¤æ‚åº¦å°±å˜çº¿æ€§äº†ã€‚è¯¢é—®ç¦»çº¿åšå³å¯ã€‚</p>
<h4 id="T3-1"><a href="#T3-1" class="headerlink" title="$T3$"></a>$T3$</h4><p>åŠ ä¸€ç»´æ—¶é—´ã€‚é‚£æ¯ä¸ªæ“ä½œå°±æ˜¯ä¸€ä¸ªé¢ä¸Šçš„ä¸€ä¸ªçŸ©å½¢ï¼Œæ¯æ¬¡è¯¢é—®ç©¿è¿‡ä¸€äº›çŸ©å½¢ã€‚è€ƒè™‘å¯¹äºä¸€æ¡çº¿ï¼Œç©¿è¿‡çš„æœ‰çŸ©å½¢è¦†ç›–çš„ç‚¹ $(p, q)$ï¼Œæ— çŸ©å½¢è¦†ç›–çš„ $(1, 0)$ï¼Œå°±çº¿æ®µæ ‘ç»´æŠ¤ã€‚</p>
<p>ç§»åŠ¨æ˜¯ $O(log)$ çš„ï¼Œè«é˜Ÿå¯ä»¥åšåˆ° $O(n\sqrt(n)logn)$ï¼Œ$kd-tree$ å¯ä»¥åšåˆ° $O(n\sqrt(n))$ï¼ˆä¸€æ—¶å£èƒ¡ä¸€æ—¶çˆ½</p>
<h3 id="THUSC2016-æˆç»©å•"><a href="#THUSC2016-æˆç»©å•" class="headerlink" title="$THUSC2016-æˆç»©å•$"></a><a href="https://loj.ac/p/2292" target="_blank" rel="noopener">$THUSC2016-æˆç»©å•$</a></h3><p>ç¥ä»™é¢˜ï¼Ÿ</p>
<p>é¦–å…ˆè‚¯å®šæ˜¯åŒºé—´ dpã€‚æœ€ååˆ é™¤çš„æ˜¯ä¸€ä¸ªé¢œè‰²åŒºé—´çš„ç‰©å“ï¼Œæ ¹æ®è¿™ä¸ªåˆ é™¤çš„è§„å¾‹æ¥è®¾è®¡æ–¹æ¡ˆã€‚</p>
<p>$f[i, j, l, r]$ è¡¨ç¤º $[i, j]$ åªå‰©ä¸‹ $[l, r]$ é¢œè‰²åŒºé—´çš„ç‰©å“æ²¡åˆ çš„æœ€å°ä»£ä»·, $g[i, j]$ è¡¨ç¤º $[i, j]$ åŒºé—´æ¶ˆå®Œäº†çš„æœ€å°ä»£ä»·ã€‚è½¬ç§» $f$ï¼Œæœ‰ä¸¤ç§ï¼šä¸€æ˜¯ $j$ å’Œä¹‹å‰çš„å¹¶ä¸€èµ·ï¼›äºŒæ˜¯æšä¸¾æ–­è£‚ç‚¹ã€‚<br>ç¬¬äºŒç§æƒ…å†µè¦åˆ†ç±»è®¨è®º $[l, r]$ é¢œè‰²åŒºé—´çš„ç‰©å“åˆ†æ•£åœ¨æ–­è£‚ç‚¹çš„å“ªä¸€è¾¹ï¼š1. åªæœ‰å·¦ 2. åªæœ‰å³ 3. ä¸¤è¾¹éƒ½æœ‰</p>
<h2 id="mathcal-12-21"><a href="#mathcal-12-21" class="headerlink" title="$\mathcal{12.21}$"></a>$\mathcal{12.21}$</h2><hr>
<h3 id="XJOI1630"><a href="#XJOI1630" class="headerlink" title="$XJOI1630$"></a>$XJOI1630$</h3><h4 id="T1-2"><a href="#T1-2" class="headerlink" title="$T1$"></a>$T1$</h4><p>æˆ‘æ˜æ˜å†™çš„å°±æ˜¯å€å¢å˜›(;Â´à¼àº¶Ğ”à¼àº¶`) æƒ¨æ­»äº†ï¼Œæš´åŠ›éƒ½ WA é£äº†ã€‚å€å¢å°±ä¸€æ­¥ä¸€æ­¥è·³ï¼Œä¸è¦å­¦ xml æ€¥äºæ±‚æˆä¸€æ¬¡è·³ä¸€å—å¯¼è‡´å…¨æ˜¯é”™çš„ã€‚</p>
<h4 id="T2-2"><a href="#T2-2" class="headerlink" title="$T2$"></a>$T2$</h4><p>å†™äº† $40$ åˆ†ï¼Œ$XJ$ åˆyÃ²uåŒshuÄngå’ruÃ²å•zhuÃ³æ²¡æœ‰ $SPJ$ï¼ï¼ˆupdï¼šè¡¥äº†ã€‚æ„ŸåŠ¨ã€‚ï¼‰</p>
<p>æ­£è§£æ˜¯æœ€å°åœ†è¦†ç›–ï¼ŒåŠå¾„çš„ä¸Šç•Œå¿…ç„¶æ˜¯çœ‹ä½œåŒä¸ªå¹³é¢ä¸Šæ—¶è¦†ç›–äº†æ‰€æœ‰ç‚¹çš„æœ€å°åœ†åŠå¾„ï¼Œæšä¸¾é«˜åº¦ï¼ŒåŠå¾„çš„å‡å°é‡éšç€é«˜åº¦çš„å¢åŠ è€Œå‡å°ã€‚ä¼—æ‰€å‘¨çŸ¥æœ€å°åœ†è¦†ç›–å¤æ‚åº¦ $O(n)$ï¼Œå› ä¸ºä¸€ä¸ªç‚¹è´¡çŒ®åˆ°åœ†ä¸Šçš„æœŸæœ›æ˜¯ $\frac{3}{i}$ã€‚</p>
<h4 id="T3-2"><a href="#T3-2" class="headerlink" title="$T3$"></a>$T3$</h4><p>$40$ åˆ† $Tarjan$ ç¼©è¾¹åŒã€‚è®°å¾—åˆ¤è¿›æ¥çš„è¾¹å•Šï¼æ­£è§£æ˜¯ LCTï¼Œé“¾èµ‹å€¼ã€‚</p>
<p><a href="https://www.luogu.com.cn/problem/P5489" target="_blank" rel="noopener">æŒ‡è·¯</a></p>
<h3 id="LOJ6611-æ‘§æ¯æ—¶é—´çº¿"><a href="#LOJ6611-æ‘§æ¯æ—¶é—´çº¿" class="headerlink" title="$LOJ6611-æ‘§æ¯æ—¶é—´çº¿$"></a><a href="https://loj.ac/p/6611" target="_blank" rel="noopener">$LOJ6611-æ‘§æ¯æ—¶é—´çº¿$</a></h3><p>æœ‰ sb $18$ åˆ†åšæ³•â€”â€”çŠ¶å‹ã€‚ä¸è¦å‚»æ‰äº†å•Šï¼å¦‚æœæ²¡æœ‰ $i + 1$ å’Œ $i + 2$ çš„è¦æ±‚ï¼Œæ˜¾ç„¶å¯ä»¥åŒºé—´ $dp$ å•Šï¼Œ$f[i, j]$ è¡¨ç¤º $[i, j]$ æ¯” $i - 1$ å’Œ $j + 1$ å…ˆæ¶ˆã€‚<br>è€ƒè™‘ $i + 1$ å’Œ $i + 2$ï¼Œä¿¡æ¯å¤šäº†ï¼Œå¤šè®°å½•å‡ ç»´å°±è¡Œ:<br>$f[i, j, t, u]$ è¡¨ç¤º $[i, j]$ æ—©äº $i - 1$ å’Œ $j + 1$ è¢«åˆ ï¼Œ$i + 2$ æ˜¯ $t$ï¼Œ$[i, u)$ éƒ½è¦æ—©äº $u$ è¢«åˆ ã€‚å…¶ä¸­ $[i, j]$ çš„æ–­è£‚ç‚¹ $k \in [u, j]$. $O(n^6)$</p>
<p><a href="https://loj.ac/s/1016858" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="UOJ165-Flea"><a href="#UOJ165-Flea" class="headerlink" title="$UOJ165-Flea$"></a><a href="https://uoj.ac/problem/165" target="_blank" rel="noopener">$UOJ165-Flea$</a></h3><p>å¥½å¦™ã€ç—´å‚»ã€‘å¤æ‚åº¦è‚¯å®šæ˜¯å»å’Œ $n$ æ‰¯å…³ç³»çš„ã€‚</p>
<p>æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªå‡½æ•°åŠ å…¥ã€‚è¿™æ˜¯ä¸ªåˆ†æ®µäºŒæ¬¡å‡½æ•°ã€‚ä¸€ä¸ªå¾ˆé‡è¦çš„äº‹æƒ…ï¼šå‡½æ•°åªæœ‰ $n$ æ®µã€‚å¯¹æ¯æ®µå•ç‹¬åšâ€”â€”æ˜¾ç„¶æˆ‘ä»¬åªå…³æ³¨ç«¯ç‚¹ã€‚<br>äºŒåˆ†ç«¯ç‚¹ä½ç½® $x$ ç„¶åæ›´æ–° $x$ çš„ç­”æ¡ˆã€‚</p>
<p>è¯¢é—®å¾ˆçè´µï¼Œé€‰å“ªä¸ªç‚¹è¯¢é—®å‘¢ï¼Ÿå‡è®¾å½“å‰åœ¨é—®ç¬¬ $i$ ä¸ªå‡½æ•°ï¼ˆä¸è¦æ±‚æŒ‰é¡ºåºæ¥ï¼‰ï¼Œé€‰å‰ $i - 1$ æ¬¡è·³å¾—æœ€é«˜çš„è·³èš¤ï¼›è‹¥è·å¾—çš„å‡½æ•°ä¸ä¹‹å‰ç›¸åŒé‚£è¯¥è·³èš¤é«˜åº¦å°±æ˜¯ç­”æ¡ˆï¼ˆå› ä¸ºå…¶ä»–è·³èš¤é«˜åº¦åªä¼šå˜å°ï¼‰ï¼Œå¦åˆ™å°±åŠ å…¥æ–°çš„å‡½æ•°ã€‚$O(n^2)$</p>
<p><a href="https://uoj.ac/submission/443496" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="å¤§è‘±çš„ç¥åŠ›"><a href="#å¤§è‘±çš„ç¥åŠ›" class="headerlink" title="$å¤§è‘±çš„ç¥åŠ›$"></a><a href="https://loj.ac/p/2288" target="_blank" rel="noopener">$å¤§è‘±çš„ç¥åŠ›$</a></h3><p>å•ç‹¬å†™åšå®¢äº†ã€‚</p>
<h2 id="mathcal-12-22"><a href="#mathcal-12-22" class="headerlink" title="$\mathcal{12.22}$"></a>$\mathcal{12.22}$</h2><hr>
<h3 id="XJOI1631"><a href="#XJOI1631" class="headerlink" title="$XJOI1631$"></a>$XJOI1631$</h3><p>ä»Šå¤©æ•°å­¦åœºï¼Œé¢˜ç›®æœ‰äº›è®¸æ¯’ç˜¤ï¼Œæˆ‘æœ‰äº›è®¸è‡ªé—­ã€‚</p>
<h4 id="T1-3"><a href="#T1-3" class="headerlink" title="$T1$"></a>$T1$</h4><p>å’•å’•ï¼Œé¸½é¸½</p>
<h4 id="T2-3"><a href="#T2-3" class="headerlink" title="$T2$"></a>$T2$</h4><p>åŸºç¯æ ‘æœ¬è´¨ä¸åŒæŸ“è‰²æ•°ã€‚å…ˆæ ‘å“ˆå¸Œåˆ¤ç¯ä¸Šæ ‘åŒæ„ï¼Œå¹¶ç®—å‡ºæ¯ä¸ªæ ‘ç­‰ä»·ç±»çš„æŸ“è‰²æ•°ã€‚åš $burnside$ çš„æ—¶å€™ï¼Œä¸èƒ½åƒä»¥å‰ä¸€æ ·æšä¸¾ $gcd$ äº†ï¼Œå› ä¸ºæ¯ç§æ—‹è½¬æ–¹æ¡ˆçš„ç­‰ä»·ç±»æŸ“è‰²æ•°éƒ½ä¸åŒã€‚ç”±äº $n$ å¾ˆå°ï¼Œä»…æšä¸¾å› æ•°å³å¯ï¼Œå› ä¸ºä¸æ˜¯å› æ•°çš„è·³å‡ºæ¥ä¹Ÿæ˜¯è·ç¦»ç›¸ç­‰çš„å› æ•°å½¢æ€ï¼ˆè¡¨è¾¾ä¸å¤ªæ¸…æ¥šï¼Œæ„ä¼šä¸€ä¸‹</p>
<p>æ‰¾åˆ°æœ€å°çš„åˆæ³•æ—‹è½¬è·ç¦» $d$ã€‚å®é™…ä¸Š $d$ å°±æ˜¯æ‰€æœ‰å¯è¡Œæ­¥é•¿çš„ $gcd$ã€‚æŠŠç›¸é‚» $d$ ä¸ªçœ‹ä½œä¸€å—å†åš $burnside$ã€‚</p>
<h4 id="T3-3"><a href="#T3-3" class="headerlink" title="$T3$"></a>$T3$</h4><p>å¥½å¦™å•Šã€‚å°±æœ‰è¿™ä¹ˆä¸ª $trick$ï¼šå°äºæŸä¸ª $limit$ çš„æ“ä½œéƒ½è¢«æ‰§è¡Œï¼Œå°±å¯ä»¥ä»å°å¾€å¤§æ‰§è¡Œæ“ä½œã€‚</p>
<p>æ³¨æ„åˆ°ä¸€ä¸ªæ“ä½œåªæœ‰åœ¨ $gap \leq T$ çš„æ—¶å€™æ‰ä¼šè¢«æ‰§è¡Œï¼Œå°±æŒ‰ $gap$ ä»å°å¾€å¤§åŠ å…¥æ“ä½œï¼Œçº¿æ®µæ ‘ç»´æŠ¤æ¯ä¸ªæ“ä½œåŒºé—´èƒ½èµ°åˆ°çš„åŒºé—´ã€‚</p>
<h3 id="åäºŒçœè”è€ƒ2019-å­—ç¬¦ä¸²é—®é¢˜"><a href="#åäºŒçœè”è€ƒ2019-å­—ç¬¦ä¸²é—®é¢˜" class="headerlink" title="$åäºŒçœè”è€ƒ2019-å­—ç¬¦ä¸²é—®é¢˜$"></a><a href="https://loj.ac/p/3049" target="_blank" rel="noopener">$åäºŒçœè”è€ƒ2019-å­—ç¬¦ä¸²é—®é¢˜$</a></h3><p>å¾ˆè‡ªç„¶<del>å¥—è·¯</del>çš„é¢˜ï¼Œå®¹æ˜“æƒ³åˆ°å»ºè¾¹ç”¨å›¾åšï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª $A$ å‘å®ƒæ”¯é…çš„ $B$ è¿è¾¹ï¼Œè¿™ä¸ª $B$ å†å‘ä»¥å®ƒä¸ºå‰ç¼€çš„ $A$ è¿è¾¹ï¼Œæš´åŠ›è¿ $O(n^2)$ï¼Œè€ƒè™‘ä¼˜åŒ–ã€‚</p>
<p>è€å¥—è·¯ï¼Œè€ƒè™‘å›¾/æ ‘ä¼˜åŒ–å»ºè¾¹ï¼Œè¿™é‡Œå¯¹åä¸²å»º $SAM$ï¼ŒæŠŠ $A$ ä¸²å’Œ $B$ ä¸²æŒ‚åœ¨å¯¹åº”çš„åç¼€æ ‘èŠ‚ç‚¹ä¸‹ï¼ŒåŒä¸ªèŠ‚ç‚¹æŒ‚ç€çš„ä¸²ç›¸é‚»è¿è¾¹å°±é¿å…äº†ä¸€ä¸ª $A$ å‘ä¸€å † $A$ è¿çš„æƒ…å†µã€‚</p>
<p><a href="https://loj.ac/s/1017579" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="åäºŒçœè”è€ƒ-çš®é…"><a href="#åäºŒçœè”è€ƒ-çš®é…" class="headerlink" title="$åäºŒçœè”è€ƒ-çš®é…$"></a><a href="https://loj.ac/p/3051?keyword=3051" target="_blank" rel="noopener">$åäºŒçœè”è€ƒ-çš®é…$</a></h3><p>è¿™é¢˜ä¸è®²å””å¾—ï¼Œå®ƒç”¨ç¹å¤šçš„å˜é‡æ¥æä½ å¿ƒæ€ï¼<del>å¤§æ„äº†å•Šæ²¡æœ‰é—ª</del></p>
<p>æ’‡å¼€è¿™ç‚¹ï¼Œé¢˜å¹¶ä¸éš¾ï¼ˆä½†æœ‰ç‚¹è€ƒé€»è¾‘</p>
<p>é¦–å…ˆå‘ç°æ´¾ç³»å’Œé˜µè¥æ˜¯äº¤é”™çš„ï¼Œä¸ç®¡åŸå¸‚é€‰ä»€ä¹ˆé˜µè¥ï¼Œé‡Œé¢çš„å­¦æ ¡éƒ½å¯ä»¥ä»»æ„é€‰æ´¾ç³»ï¼ŒåŸå¸‚çš„å†³å®šå’Œå­¦æ ¡çš„å†³å®šå…±åŒå†³å®šäº†å¯¼å¸ˆã€‚<strong>ä¹Ÿå°±æ˜¯è¯´åŸå¸‚å’Œå­¦æ ¡ç‹¬ç«‹ã€‚</strong></p>
<p>å…ˆè€ƒè™‘ $k = 0$ çš„æƒ…å†µï¼Œåˆ†åˆ« $dp$ ç®—å‡º $f[i, j]$ è¡¨ç¤ºå‰ $i$ ä¸ªåŸå¸‚ï¼Œ$j$ ä¸ªäººåœ¨è“é˜µè¥çš„æ–¹æ¡ˆæ•°ï¼›<br>$g[i, j]$ è¡¨ç¤ºå‰ $i$ ä¸ªåŸå¸‚ï¼Œ$j$ ä¸ªäººåœ¨é¸­æ´¾ç³»çš„æ–¹æ¡ˆæ•°ã€‚åˆæ³•çš„ç›¸ä¹˜ã€‚</p>
<p>æŒ‰ç…§é€‰è¯¾çš„å¥—è·¯ï¼Œ$k = 0$ çš„æƒ…å†µï¼Œæ²¡æœ‰é™åˆ¶çš„åŸå¸‚å’Œå­¦æ ¡åŒä¸Šåšï¼›<br>$k \neq 0$ï¼Œæœ‰é™åˆ¶çš„åŸå¸‚éœ€è¦é€‰åŒä¸ªé˜µè¥ï¼ŒåŒåŸå¸‚çš„å­¦æ ¡å°±å¿…é¡»æ†ç»‘è€ƒè™‘äº†ï¼š$f[i, j, k]$ è¡¨ç¤ºå‰ $i$ ä¸ªåŸå¸‚è“é˜µè¥äººæ•°ä¸º $j$ï¼Œé¸­æ´¾ç³»äººæ•°ä¸º $k$ çš„æ–¹æ¡ˆæ•°ã€‚</p>
<p>ç„¶åæ»šæ‰ä¸€ç»´å°±èƒ½ AC è¾£!</p>
<p><a href="https://loj.ac/s/1017744" target="_blank" rel="noopener">$Code$</a></p>
<p><del>è‡³æ­¤åäºŒçœè”è€ƒåªå·®ä¸€é“éª—åˆ†è¿‡æ ·ä¾‹äº†ï¼ˆè¿™é“æ‰“ç®—å’•æ‰ï¼‰</del></p>
<h2 id="mathcal-12-23"><a href="#mathcal-12-23" class="headerlink" title="$\mathcal{12.23}$"></a>$\mathcal{12.23}$</h2><hr>
<h3 id="XJOI1632"><a href="#XJOI1632" class="headerlink" title="$XJOI1632$"></a>$XJOI1632$</h3><p>XJ ç°åœ¨é¢˜å¥½åƒä¸é‚£ä¹ˆæ—§äº†ï¼Ÿç‚¹èµï¼æˆ‘éƒ½è¦è®¢ï¼</p>
<h4 id="T1-4"><a href="#T1-4" class="headerlink" title="$T1$"></a>$T1$</h4><p>æ±‚æœ¬è´¨ä¸åŒå­ä¸²çš„æœ¬è´¨ä¸åŒå­ä¸²ï¼Œ</p>
<p>å’•å’•ï¼Œé¸½é¸½ï¼ˆåŒºé—´æœ¬è´¨ä¸åŒå­ä¸²åšæ³•ï¼ŸLCT + SAMï¼Ÿæœ‰ç©ºå†è¡¥</p>
<h4 id="T2-4"><a href="#T2-4" class="headerlink" title="$T2$"></a>$T2$</h4><p>åŸé¢˜ $HNOI2016-åºåˆ—$ã€‚å®¹æ˜“å‘ç°å°±æ˜¯è¦ç»´æŠ¤æ‰€æœ‰å­åŒºé—´æœ€å¤§å€¼ä¹‹å’Œã€‚</p>
<p>å¤„ç†åŒºé—´çš„å¥—è·¯ï¼šå›ºå®šä¸€ç»´å…ˆç®—ï¼Œå†æ±‚å’Œã€‚ï¼ˆæ¯”èµ›æ—¶å°±è¿™ä¸ªå¦¹æƒ³åˆ°ï¼ï¼‰</p>
<p>$f[i]$ è¡¨ç¤ºä»¥ $i$ ä¸ºå³ç«¯ç‚¹çš„åŒºé—´ç­”æ¡ˆå’Œã€‚è®¾ $pre[i]$ è¡¨ç¤º $i$ å‰é¢æœ€è¿‘çš„å°äº $a[i]$ çš„ä½ç½®ï¼Œåˆ™ $f[i] = f[pre[i]] + a[i] * (i - pre[i])$ã€‚å¯¹ $f$ æ±‚å‰ç¼€å’Œè®¾ä¸º $g$ã€‚</p>
<p>æ€ä¹ˆå›ç­”ä¸€ä¸ª $[l, r]$ çš„è¯¢é—®ï¼Ÿè®¾ $pos$ è¡¨ç¤º $[l, r]$ ä¸­æœ€å°çš„ä½ç½®ï¼Œé—®é¢˜å°±åœ¨äºæ€ä¹ˆè®¡ç®— $(pos, r]$ çš„å­åŒºé—´ç­”æ¡ˆã€‚ç­”æ¡ˆå°±æ˜¯ $g[r] - g[pos] - f[pos] * (r - pos)$ï¼ŒæŒºå¥½ç†è§£ã€‚$[l, pos)$ ä¸€ä¸ªé“ç†ã€‚</p>
<h4 id="T3-4"><a href="#T3-4" class="headerlink" title="$T3$"></a>$T3$</h4><p>è€ƒå¯Ÿè€ƒç”Ÿç†Ÿç»ƒæ¢ç»´ $dp$ çš„èƒ½åŠ›ã€‚</p>
<p>$bitset$ å¥½æƒ³ï¼Œ$30$ åˆ†æš´åŠ›æ‹¿åˆ°ã€‚æ¥ç€æ€è·¯æƒ³ä¸‹å»ï¼Œè€ƒè™‘ä¼˜åŒ–ã€‚</p>
<p>$f[i, j]$ è¡¨ç¤ºå‰ $i$ ç§ç‰©å“ï¼Œé€‰äº† $j$ ç§ï¼Œèƒ½é€‰çš„ä½“ç§¯ï¼Œç¬¬ä¸‰ç»´ç”¨ $bitset$ è¡¨ç¤ºã€‚</p>
<p>æ¢äºŒä¸‰ç»´ã€‚</p>
<p>$$f[i, j] = f[i - 1, j]\ |\ OR_{k = 1}^{c[i]} (f[i - 1, j - k * v[i]] &lt;&lt; 1)$$</p>
<p>æ¢ä¸€äºŒç»´ã€‚</p>
<p>$$f[j] = f[j]\ |\ OR_{k = 1}^{c[i]} (f[j - k * v[i]] &lt;&lt; 1)$$</p>
<p>å‘ç°å¯¹ $j$ ä»¥ $mod\ v[i]$ å€¼åˆ†ç±»ï¼Œæ¯ç±»äº’ä¸å¹²æ‰°ï¼Œäºæ˜¯å¯ä»¥åˆ†åˆ«æ‹å‡ºæ¥ç®—ï¼Œé‚£å°±æ˜æ˜¾äº†ï¼šæ±‚åŒºé—´æˆ–ã€‚</p>
<p><del>é‚£ä¸ç›´æ¥ st è¡¨å˜›</del>æ¸…é†’ç‚¹ï¼Œå¹³ç™½å¤šä¸ª $log$ï¼ˆæ®è¯´å¯ä»¥ç”¨ $\pm1\ rmq$ å®ç°ï¼Œç”¨äººè¯å°±æ˜¯åˆ†å— $st$ è¡¨ï¼‰</p>
<p><del>é‚£ä¸ç›´æ¥å‰åç¼€å˜›</del>æ¸…é†’ç‚¹ï¼Œä¸å¯é€†</p>
<p>äºæ˜¯å·§å¦™åˆ†å—ï¼Œä»¥ $c[i]$ ä¸ºå—å¤§å°ï¼Œæ¯å—ç»´æŠ¤å‰åç¼€æˆ–å°±å¯ä»¥äº†ã€‚ç„¶åè¦åŠ ä¸€äº›æŒ‡æ ‡é›†ä¼˜åŒ–ä¸ç„¶ä¼š T æˆ 40ã€‚</p>
<p>å­¦ä¹ äº†æœ€å°åœ†è¦†ç›–ã€‚</p>
<h3 id="JOI2017-æ˜¥å­£åˆå®¿"><a href="#JOI2017-æ˜¥å­£åˆå®¿" class="headerlink" title="$JOI2017-æ˜¥å­£åˆå®¿$"></a><a href="https://uoj.ac/problem/355" target="_blank" rel="noopener">$JOI2017-æ˜¥å­£åˆå®¿$</a></h3><p><strong>å‘ç°çºµå‘é•¿åº¦å’Œæ¨ªå‘é•¿åº¦å›ºå®šäº†ï¼Œæ¯ä¸ªç§å­éƒ½è´¡çŒ®ä¸€å—å½¢çŠ¶å¤§å°ç›¸åŒçš„çŸ©å½¢ï¼Œæ‰€ä»¥é¡ºåºæ— å…³ã€‚</strong></p>
<p>å›ºå®šä¸€ç»´å¤„ç†å¦ä¸€ç»´çš„æ€è·¯ã€‚æšä¸¾çºµå‘é•¿åº¦ï¼Œå‘ç°æœ‰ä¸¤ç§æƒ…å†µçºµå‘é•¿åº¦ä¼šå½±å“æ¨ªå‘é•¿åº¦ï¼š$1$. çºµå‘ä¸¤ä¸ªç§å­åˆ°äº†è¾¹ç•Œ $2$. ä¸¤ä¸ªç§å­ç¢°åˆ°å½¼æ­¤äº†ã€‚æ‰€ä»¥å…±æœ‰ $O(n^2)$ ç§ã€‚</p>
<p>å†è®¡ç®—æœ€å°æ¨ªå‘é•¿åº¦ï¼Œè®¾æœ€å·¦è¾¹çš„ç§å­åˆ°å·¦è¾¹ç•Œä¸º $a$ï¼Œæœ€å³è¾¹çš„ç§å­åˆ°å³è¾¹ç•Œè·ç¦»ä¸º $b$ï¼Œç§å­æ¨ªåæ ‡å·®æœ€å¤§ä¸º $c$ï¼Œé‚£ä¹ˆæœ€å°æ¨ªå‘é•¿åº¦å°±æ˜¯ $\max(a + b, c)$ã€‚</p>
<p>è¾¹ç•Œå¾ˆæ¶å¿ƒï¼Œäºæ˜¯è´ºäº†ä»£ç ï¼Œå¯è€» à²¥_à²¥</p>
<p><a href="https://loj.ac/s/1019368" target="_blank" rel="noopener">$Code$</a></p>
<h2 id="mathcal-12-24"><a href="#mathcal-12-24" class="headerlink" title="$\mathcal{12.24}$"></a>$\mathcal{12.24}$</h2><hr>
<h3 id="XJOI1633"><a href="#XJOI1633" class="headerlink" title="$XJOI1633$"></a>$XJOI1633$</h3><h4 id="T1-5"><a href="#T1-5" class="headerlink" title="$T1$"></a>$T1$</h4><p>æ•°è®ºé¢˜ï¼å®¹æ˜“å‘ç°æ˜¯åæ¼”ï¼Œéœ€è¦ä¸€ä¸ªå…³é”®æŸ¿å­ï¼ˆæˆ‘ä¸ä¼šæ‰€ä»¥å°± ggï¼‰ï¼ˆxml ä½ çœŸå¾—æ¡æ•°è®ºäº†ï¼‰ï¼š$\sum\limits_{i = 1}^n \cos\frac{2\pi i}{n} = [n = 1]$ï¼Œè¯æ˜å¯ä»¥è€ƒè™‘å¤æ•°å¹³é¢ä¸Šçš„å•ä½æ ¹ï¼š$\sum\limits_{i = 1}^n \omega_n^i = [n = 1]$</p>
<p>ç­”æ¡ˆåšå·®åˆ†å¾—: $f(r + 1) - f(l)$ï¼Œè€ƒè™‘ $f(n) = \sum\limits_{d = 1}^n \mu(\frac{n}{d})g(d)$ï¼Œæ˜¾ç„¶å¯ä»¥æ•´æ•°åˆ†å— + æœæ•™ç­›æ±‚ $\mu$; $g(n) = C(n, 2) + 1 - n$ï¼Œåé¢è¿™ä¸ªä¸œè¥¿æ˜¯ $(\sum\limits_{i = 1}^n \sum\limits_{j = 1}^i cos\frac{2\pi j}{i}) - (\sum\limits_{i = 1}^n cos\frac{2\pi i}{i})$</p>
<h4 id="T2-5"><a href="#T2-5" class="headerlink" title="$T2$"></a>$T2$</h4><p>ã€Œæœ‰è‰²å›¾ã€ä¸‰å€ç»éªŒé¢˜ï¼Œæ²¡åˆ‡ä¸åº”è¯¥â€”â€”æˆ‘è„‘æŠ½è§‰å¾— $C_{i, j, k}$ åªæœ€å¤šåœ¨ä¸¤ä¸ªç½®æ¢ä¸­ã€‚å¥½å¯æƒœå•Šå•Šå•Šå•Šå•Šå•Šï¼ï¼ï¼å°±å·®è·¨è¶Šä¸‰ä¸ªç½®æ¢çš„æƒ…å†µæˆ‘å°± AC äº†ï¼ˆåè¡€ï¼‰ç¥­å¥ æˆ‘è€ƒåœºä¸Šé“å¤´çš„ä¸¤å°æ—¶ (;Â´à¼àº¶Ğ”à¼àº¶`)</p>
<p><del>ä¹Ÿè®¸ä»¥ååŠŸæˆåå°±æ¥å‡ºé¢˜ï¼Œå¯ä»¥å‡ºå››å€ç»éªŒé¢˜ï¼Œæ¥ä¸€ä¸ª $D_{i, j, k, l}$ï¼ˆä½ è¿™å‡ºé¢˜äººä¸è®²å””å¾—ï¼ï¼‰</del></p>
<h4 id="T3-5"><a href="#T3-5" class="headerlink" title="$T3$"></a>$T3$</h4><p>è€é¢˜ï¼Ÿç‰›å®¢ç½‘ä¸Šè§è¿‡æ²¡åˆ‡æˆ‘çˆªå·´ã€‚åšæ³•æœ‰ä¸€åƒç§ï¼Œæ ¹å·ã€$2$/$3$ åª $log$ ç­‰ç­‰ã€‚</p>
<p>è€ƒè™‘ç‚¹åˆ†æ²»ï¼Œç¦»çº¿è¯¢é—®ï¼Œæ¯æ¬¡å¤„ç†è¿‡åˆ†æ²»é‡å¿ƒçš„è¯¢é—®ï¼Œå¯¹äº $S -&gt; lca$ å°±ç»´æŠ¤å’Œä»¥åŠæœ€åçš„é‚£ä¸ªæœ€å°å€¼ï¼ˆå¯ä»¥å€å¢æ‰¾ä½ç½®ï¼‰ï¼Œå¯¹äº $lca -&gt; T$ å°±ç»´æŠ¤ç¬¬ä¸€ä¸ªå°äº $S -&gt; lca$ æœ€å°å€¼çš„ä½ç½®ï¼ˆå¯ä»¥äºŒåˆ†ï¼‰</p>
<p>æ€è·¯å¾ˆæ¸…æ¥šï¼Œç„¶åå°±æ˜¯å¤§åŠ›å †ä»£ç ã€‚æœ‰ä¸ªåœ°æ–¹æ²¡å†™<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (mark[x]) continue;</span><br></pre></td></tr></table></figure></p>
<p>T é£äº† = =</p>
<p>hhzï¼šä¸ç”¨äºŒåˆ†ï¼Œå¯¹äº $S -&gt; lca$ æœ€å°å€¼ä»å°åˆ°å¤§æ’åºä¾æ¬¡åšï¼ŒæŠŠæ¯”å½“å‰æœ€å°å€¼ä¾¿å®œçš„ç‚¹åŠ è¿›å›¾é‡Œï¼Œå¹¶æŸ¥é›†ç»´æŠ¤æ ¹å°±å¯ä»¥å•¦ä¸è¿‡æ˜¯ $O(nlogn\alpha)$ çš„ï¼Œå¯ä»¥ $O(1)$ æ ‘ä¸Šå¹¶æŸ¥é›†å»æ‰ $\alpha$ã€‚ï¼ˆæ˜¯æˆ‘ä¸ä¼šçš„ç§‘æŠ€ï¼‰</p>
<h3 id="æ­Œå”±ç‹å›½"><a href="#æ­Œå”±ç‹å›½" class="headerlink" title="$æ­Œå”±ç‹å›½$"></a><a href="https://www.luogu.com.cn/problem/P4548" target="_blank" rel="noopener">$æ­Œå”±ç‹å›½$</a></h3><p>å¦™è¯¶ã€‚ã€‚æ·éª°å­ç±»å‹é¢˜çš„æ¦‚ç‡ç”Ÿæˆå‡½æ•°ï¼š$F(x)$ è¡¨ç¤ºæ‰” $i$ æ¬¡æˆåŠŸçš„æ¦‚ç‡ï¼Œ$G(x)$ è¡¨ç¤ºæ‰” $i$ æ¬¡ä¸æˆåŠŸçš„æ¦‚ç‡ã€‚ç„¶åæ ¹æ®æ‰”éª°å­çš„åç»§å¯èƒ½èƒ½åˆ—å‡ºä¿©æŸ¿å­ï¼š</p>
<ol>
<li>$xG(x) + 1 = F(x) + G(x)$</li>
<li>$G(x) \cdot (\frac{1}{n})^m = \sum\limits_{i = 1}^m [name_{1\ to\ i}\ is\ a\ border] F(x) (\frac{1}{n})^{m - i}$</li>
</ol>
<p>æ±‚çš„æ˜¯æœŸæœ›ä¹Ÿå°±æ˜¯ $Fâ€™(1)$ï¼Œå¯¹ä¸Šä¸¤æŸ¿åŒ–å¾—ï¼š</p>
<ol>
<li><p>$xGâ€™(x) + G(x) = Fâ€™(x) + Gâ€™(x) \Rightarrow Fâ€™(x) = (x - 1)Gâ€™(x) + G(x) \Rightarrow Fâ€™(1) = G(1)$</p>
</li>
<li><p>$G(x) = \sum\limits_{i = 1}^m [name_{1\ to\ i}\ is\ a\ border] F(x) (\frac{1}{n})^{i} \Rightarrow G(1) = \sum\limits_{i = 1}^m [name_{1\ to\ i}\ is\ a\ border] F(1) (\frac{1}{n})^{i} = \sum\limits_{i = 1}^m [name_{1\ to\ i}\ is\ a\ border] (\frac{1}{n})^{i}$</p>
</li>
</ol>
<p>è”ç«‹ä¸¤æŸ¿å¾— $Fâ€™(1)$ã€‚ç®€å• $kmp$ å°±å¥½äº† hohoï¼</p>
<h2 id="mathcal-12-25"><a href="#mathcal-12-25" class="headerlink" title="$\mathcal{12.25}$"></a>$\mathcal{12.25}$</h2><hr>
<p>åœ£è¯èŠ‚ï¼ï¼ï¼ğŸ„ğŸ…ğŸğŸ° æˆ‘ä»¬éƒ½æ˜¯å»¶ç†„äººã€è¡¥è¯¾äººã€åƒé¥ºå­äººï¼Œæˆ‘å¦ˆè¯´å¥¹æ˜¯åšé¥ºå­äºº qwq</p>
<h3 id="XJOI1634"><a href="#XJOI1634" class="headerlink" title="$XJOI1634$"></a>$XJOI1634$</h3><h4 id="T1-6"><a href="#T1-6" class="headerlink" title="$T1$"></a>$T1$</h4><p>$O(n2^{n/2})$ çŠ¶å‹ï¼Œæƒ³åˆ°äº†ä½†æ˜¯è¦ $EXCRT$ åˆå¹¶ /è‚‹æœ¨</p>
<h4 id="T2-6"><a href="#T2-6" class="headerlink" title="$T2$"></a>$T2$</h4><p>åŸé¢˜ $BZOJ3838$.</p>
<p>hhz ä¸€è¯­é“ç ´å¤©æœºï¼šæ¨¡æ‹Ÿè´¹ç”¨æµæ¨¡æ‹Ÿçš„æ˜¯æœ€çŸ­è·¯å¢å¹¿çš„è¿‡ç¨‹â€”â€”æ¢ç”¨æ•°æ®ç»“æ„ç»´æŠ¤æµã€‚è¿™ç±»é¢˜ä¸€èˆ¬é¬¼ç•œï¼Œä½†å®¹æ˜“å»ºå‡ºè´¹ç”¨æµæ¨¡å‹ï¼Œå‘ç°æ¨¡å‹ä¸€èˆ¬å¾ˆç®€å•ï¼Œå°±å¯ä»¥è€ƒè™‘å®ƒå¢å¹¿åˆ°åº•åœ¨å¹²å•¥äº†ã€‚æ¨èåšé¢˜ï¼š<a href="https://loj.ac/p/6405" target="_blank" rel="noopener">$Conquer the World$</a></p>
<p>å»ºå‡ºæ¨¡å‹ï¼šâ€™(â€˜ å‘æºç‚¹è¿è¾¹ï¼Œâ€™)â€™ å‘æ±‡ç‚¹è¿è¾¹ï¼Œ$K / 2$ æ¬¡å¢å¹¿è·‘è´¹ç”¨æµã€‚æ¨¡å‹éå¸¸ç®€å•ï¼Œè€ƒè™‘æ¨¡æ‹Ÿè´¹ç”¨æµï¼</p>
<p>è¿™è´¹ç”¨æµåœ¨å¹²å•¥ï¼Ÿæ¯æ¬¡å–ä¸€å¯¹æ‹¬å·, ä½ç½®åˆ†åˆ«ä¸º $l$ å’Œ $r$, å¦‚æœå–çš„æ˜¯ â€˜()â€™ åˆ™å¯¹ $[l, r)$ åŒºé—´ $+1$ï¼›å¦‚æœå–çš„æ˜¯ â€˜)(â€˜ åˆ™å¯¹ $[r, l)$ åŒºé—´ $-1$ï¼ŒåŒæ—¶è¦éè´Ÿã€‚</p>
<p>å°±å¯ä»¥çº¿æ®µæ ‘ç»´æŠ¤å–çš„è¿‡ç¨‹ï¼Œç»´æŠ¤ä¸€å †é‡ï¼š</p>
<ul>
<li>$tag$</li>
<li>$min$ï¼ˆå‡å®šåŒºé—´æœ€å°å€¼ä¸º $0$ï¼Œä»¥æœ€å°å€¼ä¸ºå‚ç…§è€ƒè™‘æŸä¸ª $a$ æˆ– $b$ èƒ½å¦å–ï¼‰</li>
<li>$min_a$, $min_b$ï¼ˆåŒºé—´æœ€å° $a$/$b$ï¼‰</li>
<li>$lmin_a$, $rmin_b$ï¼ˆä¸ºäº†ä¸è·¨è¶Šæœ€å°å€¼ï¼ŒåŒºé—´è¢«åˆ†æˆè®¸å¤šæ®µï¼Œæ˜¾ç„¶æˆ‘ä»¬åˆå¹¶æ—¶åªç”¨åˆ°æœ€å·¦æ®µæœ€å° $a$ å’Œæœ€å³æ®µæœ€å° $b$ï¼‰</li>
</ul>
<p>è¿˜æœ‰ä¸€ç§åšæ³•â€”â€”å¸¦æ‚”è´ªå¿ƒï¼Œä»å·¦å¾€å³æ’å…¥ â€˜(â€˜ å’Œ â€˜)â€™ï¼Œâ€™)â€™ çš„æ—¶å€™å¯ä»¥é€‰æ–°çš„ â€˜(â€˜ ä¹Ÿå¯ä»¥é€‰ä¸€ä¸ªä»¥å‰åŒ¹é…æ‰çš„ â€˜(â€˜ã€‚æ‰€ä»¥åŒ¹é…ä¸Šè¿˜è¦ä¸¢ä¸€ä¸ª $-a[]$ ä»¥å¤‡åæ‚”ã€‚ä½†æ˜¯è¿™æ ·è¿˜æ˜¯é”™çš„ï¼Œå› ä¸ºæ²¡æœ‰æ¯æ¬¡ä¸ªæ•°å¢åŠ  $1$ çš„é˜¶æ®µæ€§ã€‚æœ‰ç¥ä»™æ›°ï¼š$wqs$ äºŒåˆ†ï¼Œ<strong>å°±å¯ä»¥ä¸¢æ‰ä¸ªæ•°çš„é™åˆ¶äº†ï¼</strong> äºŒåˆ†æ–œç‡ $k$ï¼ŒåŒ¹é…ä¸Šè¦ä¸¢çš„ä¸œè¥¿å°±å˜æˆ $-a[] - k$ äº†ã€‚</p>
<h4 id="T3-6"><a href="#T3-6" class="headerlink" title="$T3$"></a>$T3$</h4><p>è¿™é¢˜ä¸éš¾ï¼Œæƒ³åˆ°æ­£è§£äº†ã€‚</p>
<p>æœ€ç»ˆæ˜¯å¾ˆå¤šä¸ªæ–­å¼€çš„è¿ç»­æ®µï¼Œè€ƒè™‘æŸä¸ªåŒºé—´æ˜¯å¦å¯ä»¥ä½œä¸ºè¿ç»­æ®µï¼Œåªè¦ç»´æŠ¤æ¯ä¸ªä½ç½®å‘å·¦æœ€è¿œä½ç½®ï¼ˆ$mn$ï¼‰å’Œå‘å³æœ€è¿œä½ç½®ï¼ˆ$mx$ï¼‰ï¼Œæ ‘çŠ¶æ•°ç»„ $O(nlogn)$ã€‚</p>
<p>$dp$ï¼Œ$dp[i]$ è¡¨ç¤º $i$ ä¸ºæœ€åä¸€ä¸ªè¿ç»­æ®µå³ç«¯ç‚¹çš„ $dp$ å€¼ï¼Œæ˜¾ç„¶å½“ $p$ ä¸ºå·¦ç«¯ç‚¹æ—¶è´¡çŒ®æ˜¯ $sum[p - 2]$ï¼Œ$sum$ æ˜¯ $dp$ æ•°ç»„å‰ç¼€å’Œã€‚</p>
<p>æšä¸¾å³ç«¯ç‚¹ $r$ï¼Œæˆ‘ä»¬åªè¦ç»´æŠ¤å·¦ç«¯ç‚¹åœ¨ $[mn[r], r]$ ä¸­ä¸”å‘å³æœ€è¿œä½ç½® $\geq r$ çš„è¿ç»­æ®µè´¡çŒ®å°±å¥½ï¼Œå‘ç°è¿™æ ·è¿ç»­æ®µå·¦ç«¯ç‚¹éšç€å³ç«¯ç‚¹å•è°ƒï¼Œäºæ˜¯å¯ä»¥æ ‘çŠ¶æ•°ç»„åšã€‚</p>
<p>å‘ç°è‡ªå·±æƒ³åˆ°è§£æ³•ï¼Œè¯´å‡ºæ¥æˆ–è€…å†™å‡ºæ¥ä¼šæ¸…æ¥šå¾ˆå¤šã€‚æ²¡å•¥å¥½è¯´çš„ï¼Œæš´åŠ›éƒ½å†™æŒ‚äº†ï¼ï¼ï¼ï¼ˆåæ¥å‘ç° bug åœ¨é¢„å¤„ç†æœ€è¿œä½ç½® = =</p>
<h3 id="çç "><a href="#çç " class="headerlink" title="$çç $"></a><a href="https://loj.ac/p/3120" target="_blank" rel="noopener">$çç $</a></h3><p>å†™åœ¨ã€Œç”Ÿæˆå‡½æ•°ã€é‡Œäº†ã€‚</p>
<p><a href="https://loj.ac/s/1019774" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="ICPC-World-Final-2018-Conquer-the-World"><a href="#ICPC-World-Final-2018-Conquer-the-World" class="headerlink" title="$ICPC\ World\ Final\ 2018\ Conquer\ the\ World$"></a><a href="https://loj.ac/p/6405" target="_blank" rel="noopener">$ICPC\ World\ Final\ 2018\ Conquer\ the\ World$</a></h3><p>æ‹†è·ç¦»ä¸º $dist = dep_x + dep_y - 2 * dep_{lca}$ã€‚æ³¨æ„å› ä¸ºå¼ºåˆ¶æ´å…¨éƒ¨æ»¡ï¼Œæ´çš„ $dep$ å¯ä»¥å‡å» $\infty$ æœ€åå†åŠ å›æ¥ã€‚</p>
<p>åœ¨æ¯ä¸ª $x$ ä½œä¸º $LCA$ æ—¶æ“ä½œæ‰å­æ ‘é‡Œæ‰€æœ‰åŒ¹é…èµ·æ¥è´¡çŒ® $&lt; 0$ çš„å¯¹ï¼Œç„¶åä¸ºäº†åœ¨ç¥–å…ˆå¤„å¯ä»¥åæ‚”ï¼Œè¿˜è¦åˆ†åˆ«ä¸¢è¿›å † $dist - dep_x$ å’Œ $dist - dep_y$ã€‚ä¸ä¼šå‡ºç°è·¯å¾„é‡åˆçš„å¯¹å› ä¸ºé‚£è‚¯å®šä¸ä¼˜ã€‚</p>
<h2 id="mathcal-12-26"><a href="#mathcal-12-26" class="headerlink" title="$\mathcal{12.26}$"></a>$\mathcal{12.26}$</h2><hr>
<p>å­¦ä¹ äº†æœ€å¤§æƒé—­åˆå­å›¾ã€‚</p>
<h3 id="Salty-Fish"><a href="#Salty-Fish" class="headerlink" title="$Salty\ Fish$"></a><a href="https://vjudge.net/problem/HDU-6634" target="_blank" rel="noopener">$Salty\ Fish$</a></h3><p>å†™åœ¨ã€Œæœ€å¤§æƒé—­åˆå­å›¾ã€å­¦ä¹ ç¬”è®°é‡Œäº†ã€‚</p>
<h3 id="CF280D-k-Maximum-Subsequence-Sum"><a href="#CF280D-k-Maximum-Subsequence-Sum" class="headerlink" title="$CF280D-k-Maximum Subsequence Sum$"></a><a href="https://www.luogu.com.cn/problem/CF280D" target="_blank" rel="noopener">$CF280D-k-Maximum Subsequence Sum$</a></h3><p>å®¹æ˜“å»ºå‡ºè´¹ç”¨æµæ¨¡å‹ã€‚å‘ç°ä¸€æ¬¡å¢å¹¿åæ²¿é€”çš„è´¹ç”¨è¢«å–è´Ÿï¼Œçº¿æ®µæ ‘æ¨¡æ‹Ÿç»´æŠ¤æµå³å¯ã€‚</p>
<p><a href="https://codeforces.com/contest/280/submission/102359458" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="BZOJ4977-è·³ä¼æ±‚ç”Ÿ"><a href="#BZOJ4977-è·³ä¼æ±‚ç”Ÿ" class="headerlink" title="[$BZOJ4977-è·³ä¼æ±‚ç”Ÿ$]"></a>[$BZOJ4977-è·³ä¼æ±‚ç”Ÿ$]</h3><p>å¸¦æ‚”è´ªå¿ƒï¼Œå¥½åƒä¸å¤ªå¯ä»¥ä»æ¨¡æ‹Ÿè´¹ç”¨æµçš„è§’åº¦è§£é‡Šï¼ŸæŒ‰è¡€é‡å‡åºæ’åºï¼Œæ¯ä¸ªè€é¼ å¿…é¡»åŒ¹é…ï¼Œæ¯ä¸ªæ´ä¸ä¸€å®šè¦åŒ¹é…ï¼Œäºæ˜¯è€é¼ æ‰¾å·²åœ¨çš„æœªåŒ¹é…çš„æ´ï¼Œæˆ–è€…å·²åœ¨çš„å·²åŒ¹é…çš„æ´ã€‚è¿™é‡Œæ¶‰åŠçš„åæ‚”æ“ä½œå¾ˆç®€å•â€”â€”æ¶ˆé™¤è€é¼ çš„è´¡çŒ®å°±å¥½ã€‚</p>
<h3 id="LOJ6289-èŠ±æœµ"><a href="#LOJ6289-èŠ±æœµ" class="headerlink" title="$LOJ6289-èŠ±æœµ$"></a><a href="https://loj.ac/problem/6289" target="_blank" rel="noopener">$LOJ6289-èŠ±æœµ$</a></h3><p>å•ç‹¬å†™åšå®¢äº†ã€‚</p>
<h3 id="CF995F"><a href="#CF995F" class="headerlink" title="$CF995F$"></a><a href="https://www.luogu.com.cn/problem/CF995F" target="_blank" rel="noopener">$CF995F$</a></h3><p>ï¼ˆæ„Ÿè§‰è¿™ç©æ„ä»¥å‰åœ¨ h2 åšåˆ°è¿‡ï¼‰</p>
<p>æš´åŠ› $dp$, $f[x, c]$ è¡¨ç¤º $x$ æƒå€¼ä¸º $c$ çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™ $f[x, c] = \prod s[y, c]$ å…¶ä¸­ $s$ æ˜¯ $f$ çš„å‰ç¼€å’Œ</p>
<p>$D$ å¤ªå¤§äº†ï¼Œä½†è€ƒè™‘åˆ°åªä¼šå‡ºç° $n$ ç§æƒå€¼ï¼Œå¯ä»¥ä»¥ç¦»æ•£åŒ–çš„æ€æƒ³æ±‚å‡º $f[x, c]$ è¡¨ç¤º $x$ çš„æƒå€¼åœ¨å½“å‰æœ‰çš„æƒå€¼ä¸­æ’åç¬¬ $c$ å°ã€‚ä½†ç»„åˆæ•°å°±ä¸èƒ½ç›´æ¥æ±‚äº†â€”â€”å‡ºç°çš„æƒå€¼ç§ç±»ä¸çŸ¥é“ã€‚</p>
<p>è€ƒè™‘ $f[1, i]$ æ˜¯å•¥ï¼Œå°±æ˜¯ç”¨äº† $\leq i$ ç§æƒå€¼ä¸”ä¸€å®šç”¨äº†ç¬¬ $i$ ç§æƒå€¼çš„æ–¹æ¡ˆæ•°ï¼Œé‚£å®¹æ–¥ä¸å°±å¥½äº†ä¹ˆï¼Ÿ</p>
<p>$$F[i] = f[1, i] - \sum\limits_{j = 1}^{i - 1} C(i - 1, j - 1) * F[j]$$</p>
<p><a href="http://codeforces.com/contest/995/submission/102377434" target="_blank" rel="noopener">$Code$</a></p>
<h2 id="mathcal-12-27"><a href="#mathcal-12-27" class="headerlink" title="$\mathcal{12.27}$"></a>$\mathcal{12.27}$</h2><hr>
<h3 id="XJOI1628"><a href="#XJOI1628" class="headerlink" title="XJOI1628"></a>XJOI1628</h3><h4 id="T3-7"><a href="#T3-7" class="headerlink" title="T3"></a>T3</h4><p>æ„é€ ä¸€ä¸ªæ’åˆ—ä½¿å¾—æƒå€¼æœ€å¤§â€”â€”ç”¨è´¹ç”¨æµæ±‚è§£ã€‚åªæœ‰ä¸‰ç§è¿è¾¹ï¼Œçº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾å³å¯ã€‚</p>
<h4 id="T4"><a href="#T4" class="headerlink" title="T4"></a>T4</h4><p>ä¸€çœ¼å¹¿ä¹‰ SAM ä½†æ˜¯æ ¹æœ¬ä¸ä¼šï¼ˆé‚£æ˜¯ä¸æ˜¯ä¸å«â€œä¸€çœ¼â€ï¼Ÿ</p>
<h3 id="åŒºé—´æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°"><a href="#åŒºé—´æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°" class="headerlink" title="$åŒºé—´æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°$"></a><a href="https://www.luogu.com.cn/problem/P6292" target="_blank" rel="noopener">$åŒºé—´æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°$</a></h3><p>å†™åœ¨ã€ŒSAMã€å­¦ä¹ ç¬”è®°é‡Œäº†ã€‚</p>
<h2 id="mathcal-12-28"><a href="#mathcal-12-28" class="headerlink" title="$\mathcal{12.28}$"></a>$\mathcal{12.28}$</h2><hr>
<h3 id="XJOI1634-1"><a href="#XJOI1634-1" class="headerlink" title="$XJOI1634$"></a>$XJOI1634$</h3><h4 id="T1-7"><a href="#T1-7" class="headerlink" title="$T1$"></a>$T1$</h4><p>å‰–é“¾ï¼Œæ¯æ¡é“¾åšï¼ŒæŠŠå°ç«è½¦æ‹†æˆ $O(logn)$ æ®µï¼Œä¸€äº›æ–œç‡ä¸º $1$ å’Œ $-1$ çš„çº¿æ®µï¼Œæ±‚äº¤ç‚¹ã€‚æ–œç‡ç›¸åŒè¦ä¹ˆé‡åˆè¦ä¹ˆåŒèµ·ç‚¹ï¼Œå˜æˆä¸€ç»´é—®é¢˜ï¼Œç»å…¸ç‚¹å‡è¾¹æ±‚å‡ºç›¸äº¤å¯¹æ•°ï¼›æ–œç‡ä¸åŒæ—‹è½¬ $45$ åº¦æ‰«æçº¿ï¼Œä¸ç”¨ç‚¹å‡è¾¹ã€‚</p>
<h4 id="T2-7"><a href="#T2-7" class="headerlink" title="$T2$"></a>$T2$</h4><p>$T2$ æ²¡åšå‡ºæ¥å¤ªä¸åº”è¯¥äº†ã€‚åæ€ä¸€ä¸‹åˆ°åº•æ˜¯å“ªå„¿å‡ºäº†é—®é¢˜ï¼Ÿä¹Ÿè®¸æˆ‘è„‘è¢‹ä¸­æœ‰è¿‡ä¸€é—ªè€Œè¿‡çš„â€œæšä¸¾æœ€å€¼â€çš„æƒ³æ³•ã€‚</p>
<p>è¿™é¢˜è¦åšä¸ªè½¬åŒ–â€”â€”æƒå€¼ $\geq$ æœ€å°å€¼çš„è¾¹æƒå€¼ä¸å˜ï¼Œæƒå€¼ $&lt;$ æœ€å°å€¼çš„è¾¹æƒå€¼ä¸º $0$. è€ƒè™‘åˆ°è¾¹åªæœ‰ $3e3$ æ¡ï¼Œä¾æ¬¡æšä¸¾ + æœ€çŸ­è·¯å³å¯ã€‚</p>
<h4 id="T3-8"><a href="#T3-8" class="headerlink" title="$T3$"></a>$T3$</h4><p>äºŒç»´çº¿æ®µæ ‘æ˜¾ç„¶</p>
<h2 id="mathcal-12-29"><a href="#mathcal-12-29" class="headerlink" title="$\mathcal{12.29}$"></a>$\mathcal{12.29}$</h2><hr>
<p>ä»Šå¤©æ”¾äº†ä¸€å † $ACM$ é¢˜ã€‚æŠ±çµè¾£</p>
<h4 id="T1-8"><a href="#T1-8" class="headerlink" title="$T1$"></a>$T1$</h4><p>ä¸€ç›´åœ¨è€ƒè™‘ä¸€æ®µçš„è¿›ä½ã€‚ã€‚æˆ‘æ˜¯ sbï¼Œçœ‹å“ªä½ç›´æ¥æŠŠé‚£ä½ä¹‹å‰çš„æ‹å‡ºæ¥è®°ä½œ $b[i]$, $b[i] + b[j] \geq 10^p$ å°±æ˜¯è¿›ä½ï¼Œæ˜¾ç„¶æ’åº + åŒæŒ‡é’ˆç®—å¯¹æ•°å°±å¥½äº†ã€‚</p>
<h4 id="T2-8"><a href="#T2-8" class="headerlink" title="$T2$"></a>$T2$</h4><p>å®¹æ˜“æƒ³åˆ°ç¬›å¡å°”æ ‘ä¹‹ç±»çš„ï¼Œæ¯ä¸ªæ•°æœ‰ä¸€ä¸ªç®¡è¾–èŒƒå›´ï¼Œå¹¶ä¸”ç»„æˆæ–°åºåˆ—çš„æ•°å­—é¡ºåºä¸å˜ $unique$ åæ˜¯åŸæ•°åˆ—çš„ä¸€ä¸ªå­åºåˆ—, $dp[i, j, k]$ è¡¨ç¤ºåˆ°åŸåºåˆ—ç¬¬ $i$ ä¸ªï¼Œç»„æˆæ–°åºåˆ—å‰ $j$ ä¸ªï¼Œï¼ˆæœ€å°ï¼‰æ¬¡æ•°ä¸º $k$ çš„æ–¹æ¡ˆæ•°ã€‚</p>
<p>cly è¯´ä¹Ÿå¯ä»¥ç¬›å¡å°”æ ‘ä¸Š $dp$ï¼Œ$dp[i, j, k]$ è¡¨ç¤º $i$ èŠ‚ç‚¹å‰/åç¼€ä¸º $j$ï¼Œæ¬¡æ•° $= k$ çš„æ–¹æ¡ˆæ•°ï¼Œè½¬ç§»è¦é«˜ç»´å‰ç¼€å’Œã€‚</p>
<h4 id="T3-9"><a href="#T3-9" class="headerlink" title="$T3$"></a>$T3$</h4><p>åˆ©ç”¨ç±»ä¼¼ $Hash$ çš„çº¿æ€§æ¢æµ‹æ³•å³å¯ $AC$ã€‚</p>
<h4 id="T4-1"><a href="#T4-1" class="headerlink" title="$T4$"></a>$T4$</h4><p>åœ¨ $\sqrt{S}$ é™„è¿‘æš´æœå³å¯ã€‚ï¼ˆ$T3$ &amp; $T4$ éƒ½å¥½æš´åŠ›å•Šï¼</p>
<h4 id="T5"><a href="#T5" class="headerlink" title="$T5$"></a>$T5$</h4><p>é¢˜ç›®çœ‹é”™ $* n$ã€‚é¦–å‘çš„ $A$ å’Œ $B$ ä¼šé€‰ä¸¤ä¸ªä¸åŒè¡Œä¸åŒåˆ—çš„ï¼Œå‰©ä¸‹ $6$ ä¸ªè·Ÿä¹‹å‰é€‰çš„åŒè¡ŒåŒåˆ—çš„æ ¼å­ï¼Œå’Œ $1$ ä¸ªä¸åŒè¡Œä¸åŒåˆ—çš„æ ¼å­ï¼Œå¿…è´¥çŠ¶æ€æ˜¯ $6$ ä¸ªå…¨ä¸º $1$ï¼Œ$1$ ä¸ªä¸º $0$ï¼Œ$sg\ å€¼\ =\ XOR(\ a[i, j]\ åŒè¡ŒåŒåˆ—\ ?\ a[i, j] - 1\ :\ a[i, j]\ )$</p>
<h4 id="T6"><a href="#T6" class="headerlink" title="$T6$"></a>$T6$</h4><ul>
<li><p>ç«èµ›å›¾å³æ˜¯æœ‰å‘å®Œå…¨å›¾ã€‚</p>
</li>
<li><p>$kosaraju$ æ˜¯å•¥ï¼Ÿå’•ä¸€ä¸ª</p>
</li>
</ul>
<p>å¬è¯´æ˜¯ åŒ—å¤§é›†è®­$2020$ æŸé¢˜çš„å¼±åŒ–ç‰ˆã€‚å…ˆæ‰¾ä¸€ä¸ªå“ˆå¯†é¡¿å›è·¯ï¼ˆ$Graph\ Theory$ï¼šç«èµ›å›¾ä¸€å®šå­˜åœ¨å“ˆå¯†é¡¿é€šè·¯ï¼‰ï¼Œå›è·¯å¤–çš„è¾¹ä¿®æ”¹éƒ½ä¸å½±å“å¼ºè¿é€šæ€§ï¼Œè€Œç¿»è½¬å›è·¯ä¸Šçš„è¾¹ä¼šå½¢æˆé“¾ï¼ŒåŸæœ¬ä¸åœ¨å›è·¯ä¸Šçš„è¾¹ç°åœ¨è¦†ç›–äº†ä¸€äº›åŒºé—´ï¼Œç„¶ååˆ†ç±»è®¨è®ºï¼Œç¼©ç‚¹å•Šä»€ä¹ˆçš„ã€‚</p>
<h4 id="T7"><a href="#T7" class="headerlink" title="$T7$"></a>$T7$</h4><p>æˆ‘çœ‹åˆ°é‚£ä¸ª $3$ æ“ä½œå•Šæˆ‘å°±å¤§æ„äº†ï¼æˆ‘ä»¥ä¸ºæ˜¯ $splay$ï¼Œæ ¹æœ¬ä¸ç”¨çš„å•Šï¼å°±çœ‹ä½œç¯å½¢ç§»ä½å°±å¥½äº†å•Šï¼æ›´æ”¹èµ·ç‚¹å°±å¥½äº†å•Šï¼è¢«å·è¢­äº†å•Šï¼</p>
<p><strong>$FLAG$ï¼šä»Šæ˜ä¸¤å¤©æå®Œ $SAM$ï¼Œå¾—ç«‹åˆ»å›å»æ $AGC$ å’Œé›†è®­é˜Ÿä½œä¸šå’Œ $TC$ å¥½é¢˜äº†å•Šï¼Œè½åäºå½“ä»£ $OI$ äº†å•Šå•Šã€‚ã€‚äººå‚»æ²¡æ•‘äº†å•Šå•Šã€‚ã€‚</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OI is full of Theories...</span><br></pre></td></tr></table></figure>
<h2 id="mathcal-12-30"><a href="#mathcal-12-30" class="headerlink" title="$\mathcal{12.30}$"></a>$\mathcal{12.30}$</h2><hr>
<p>æ—¶å…‰é£é€ï¼Œæ—¥æœˆå¦‚æ¢­ï¼Œå…‰é˜´èè‹’â€¦ï¼ˆå’³å’³ï¼‰xml è¿˜æ˜¯è¿™ä¹ˆèœï¼$2021\ is\ coming$ï¼å†å†²ä¸¤å¤©å°±å¿«å¿«ä¹ä¹è·¨å¹´å’¯ ~</p>
<h3 id="BJWC2018-Border-çš„å››ç§æ±‚æ³•"><a href="#BJWC2018-Border-çš„å››ç§æ±‚æ³•" class="headerlink" title="$BJWC2018-Border çš„å››ç§æ±‚æ³•$"></a><a href="https://www.luogu.com.cn/problem/P4482" target="_blank" rel="noopener">$BJWC2018-Border çš„å››ç§æ±‚æ³•$</a></h3><p>å†™åœ¨ã€ŒSAMã€é‡Œäº†ã€‚</p>
<h3 id="CF1326F2"><a href="#CF1326F2" class="headerlink" title="$CF1326F2$"></a><a href="https://codeforces.com/contest/1326/problem/F2" target="_blank" rel="noopener">$CF1326F2$</a></h3><p>$nb$ é¢˜ã€‚å®¹æ˜“æƒ³åˆ° $dp$ å‡ºé›†åˆ $s$ é‡Œçš„ç‚¹å½¢æˆé“¾çš„æ–¹æ¡ˆæ•°å†æ‹¼èµ·æ¥ï¼Œä½†è¿™ä¸å¯¹å› ä¸ºè¿æ¥å¤„ç‚¹ä¸ä¸€å®šæ²¡è¾¹ã€‚</p>
<p>è€ƒè™‘å­é›†åæ¼”ã€‚è®¾ç­”æ¡ˆæ•°ç»„ä¸º $f$ï¼Œåˆ™è®¾ $g[S] = \sum\limits_{S \subseteq T} f[T]$ï¼Œä»æ„ä¹‰ä¸Šç†è§£ $g$ å°±æ˜¯ä»»é€‰ä¸€äº›é“¾ï¼Œä¸ç®¡è¿æ¥å¤„ï¼Œæ‹¼èµ·æ¥çš„æ–¹æ¡ˆæ•°ã€‚åªè¦æ±‚å‡º $g$ å°±å¥½äº†ã€‚</p>
<p>å¯¹äºé“¾é•¿åº¦é›†åˆç›¸åŒçš„æ–¹æ¡ˆåªæ˜¯äº¤æ¢é¡ºåºï¼Œæ–¹æ¡ˆæ•°ç›¸åŒï¼Œæˆ‘ä»¬ä»…è€ƒè™‘æšä¸¾ $n$ çš„åˆ†æ‹†ã€‚</p>
<p>ç›´æ¥ $dp$ï¼ˆ$dpâ€™[s] = \sum dp[s - t] <em> g[t]$ï¼‰è¦åš $n$ çš„æ‹†åˆ†æ•°æ¬¡å­é›†å·ç§¯ï¼Œå¤æ‚åº¦å¤§çº¦æ˜¯ $P(n) </em> n * 2^n$, åƒä¸æ¶ˆã€‚</p>
<p>æœ‰ç¥ä»™ç”¨å®¹æ–¥ä¼˜åŒ–ï¼šå¯¹ $dp$ è¿›è¡Œå®¹æ–¥ï¼Œæ•æ‰å®¹æ–¥åˆ‡å£ï¼šä»¤ $g[s]$ è¡¨ç¤ºä½¿ç”¨ $s$ é›†åˆé‡Œçš„ç‚¹æ„æˆçš„æŸäº›é•¿åº¦çš„é“¾æ–¹æ¡ˆæ•°ï¼Œ$dp$ è‹¥é‡å¤ç”¨ç‚¹åˆ™å¿…ç„¶ä¼šæ¼æ‰ä¸€äº›ç‚¹ä¸ç”¨ï¼Œå°±å¯ä»¥å®¹æ–¥äº†ã€‚å¿«åœ¨å“ªå„¿å‘¢ï¼ŸåŸå…ˆä¸­é€”è¾¹æšä¸¾æ‹†åˆ†è¾¹å·ï¼Œç°åœ¨åªè¦æšä¸¾å®Œå·ä¸€æ¬¡å†å®¹æ–¥ä¸€æ¬¡ï¼Œå¤æ‚åº¦æ˜¯ $P(n) * 2^n$ â€”â€”ç¨³äº†ï¼</p>
<p><a href="https://codeforces.com/contest/1326/submission/102753163" target="_blank" rel="noopener">$Code$</a></p>
<h2 id="mathcal-12-31"><a href="#mathcal-12-31" class="headerlink" title="$\mathcal{12.31}$"></a>$\mathcal{12.31}$</h2><hr>
<p>è·¨å¤§å¹´è¾£ï¼ï¼ï¼ï¼ï¼<del>è¿™ç¯‡åšå®¢ä¹Ÿå®Œç»“äº†QWQ</del></p>
<h3 id="XJOI1639"><a href="#XJOI1639" class="headerlink" title="$XJOI1639$"></a>$XJOI1639$</h3><h4 id="T1-9"><a href="#T1-9" class="headerlink" title="$T1$"></a>$T1$</h4><p>hhz: è¿™ä¹ˆè¾“å…¥åªæœ‰ä¸¤ç§ç›®çš„ï¼š1. åŠ å¿«è¯»å…¥ 2. æ•°æ®éšæœºã€‚è¿™é¢˜æ˜æ˜¾æ˜¯éšæœºã€‚</p>
<p>è¿™æ˜¯é“è¯¯å·®åˆ†æé¢˜ï¼Œä»»ä½•æ•°é™¤ä»¥ 999â€¦ éƒ½æ˜¯å¾ªç¯èŠ‚ï¼Œæƒ³åˆ°æŠŠ $\lfloor \frac{x}{111â€¦} \rfloor$ å˜æˆ $\lfloor \frac{9x}{10^i - 1} \rfloor$ã€‚æ•´æ•°ä½å…ˆåŠ ï¼Œå†åŠ å°æ•°ä½ã€‚</p>
<p>ç„¶åå’•å’•äº†ï¼Œå®åœ¨å˜æ€å•Šã€‚ã€‚</p>
<h4 id="T2-9"><a href="#T2-9" class="headerlink" title="$T2$"></a>$T2$</h4><p>å¥½é¢˜ã€‚å®¹æ˜“æƒ³åˆ° $n^2$ dp: $f[i, j]$ è¡¨ç¤ºåˆ°ç¬¬ $i$ ä½ï¼Œä¸¤æ”¯é˜Ÿä¼ç»“å°¾åˆ†åˆ«æ˜¯å½“å‰æœ€é«˜é«˜åº¦ä½ç½®ï¼ˆè¿™æ˜¯å›ºå®šçš„ï¼‰å’Œ $j$ çš„æœ€å°ä¸æ»¡åº¦ã€‚è¿™å¤§æ¦‚æ˜¯æ²¡æœ‰å‰é€”çš„æ€è·¯ã€‚</p>
<p>è€ƒè™‘å¦ä¸€ç§æš´åŠ›: è®¾ $Max$ ä¸ºå½“å‰å‡ºç°çš„æœ€å¤§é«˜åº¦ï¼Œ$max$ ä¸ºå½“å‰å‡ºç°çš„æ¬¡å¤§é«˜åº¦ï¼Œ$f[i, max]$ è¡¨ç¤ºåˆ°ç¬¬ $i$ ä½ï¼Œæ¬¡é«˜é«˜åº¦ä¸º $max$ çš„æœ€å°ä¸æ»¡åº¦ï¼Œåˆ™æ–°åŠ ä¸€ä¸ª $h$ è¿›æ¥æœ‰ä¸¤ç§è½¬ç§»â€”â€” $max$ å˜ä¸ä¸å˜ã€‚å°±åƒæœ€çŸ­è·¯ä¸€æ ·è½¬ç§»ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">h &gt; Max:</span><br><span class="line">    i  i+1</span><br><span class="line"> ä½  â—‹   â—‹</span><br><span class="line">     â—‹ â†˜ â—‹ è¾¹æƒ 0</span><br><span class="line"> é«˜  â—‹   â—‹</span><br><span class="line"></span><br><span class="line">h &lt; Max:</span><br><span class="line">    â—‹ â†’ â—‹ è¾¹æƒ max - h</span><br><span class="line">    â—‹   â—‹</span><br><span class="line">    â—‹   â—‹</span><br><span class="line"></span><br><span class="line">    â—‹ â†’ â—‹ è¾¹æƒ a</span><br><span class="line">    â—‹ â†’ â—‹ è¾¹æƒ a + 1</span><br><span class="line">    â—‹ â†’ â—‹ è¾¹æƒ a + 2</span><br><span class="line">    ã€‚ã€‚ã€‚</span><br><span class="line">    å°±æ˜¯åŠ ç­‰å·®æ•°åˆ—å•¦ã€‚</span><br></pre></td></tr></table></figure></p>
<p>ä¸¤ç§åšæ³•ï¼Œæ­£åšååšã€‚</p>
<p>æ­£åšéœ€è¦åŒºé—´åŠ ç­‰å·®æ•°åˆ—å’Œç»´æŠ¤å‰ç¼€ $min$ï¼Œé‡‡å–å·®åˆ†æ€æƒ³ï¼Œç­‰å·®æ•°åˆ—å˜æˆåŒºé—´åŠ å¸¸æ•°ï¼Œç¦»æ•£åŒ–ä¸‹æ ‡ï¼Œåˆ©ç”¨å¹³è¡¡æ ‘ç»´æŠ¤ã€‚</p>
<p>ååšå°±æ¯”è¾ƒå·§å¦™äº†ï¼Œç›¸å½“äºåè·‘æœ€çŸ­è·¯ï¼Œæ¯ä¸€åˆ—ç‚¹ä¸€å®šä¸Šå°ä¸‹å¤§ï¼Œä¸ºå•¥ï¼Ÿåˆ†æ®µè¯ï¼Œ$h &lt; max$ æ—¶ä¸Šå°ä¸‹å¤§åºåˆ— + ä¸Šå°ä¸‹å¤§ç­‰å·®æ•°åˆ—ï¼Œå•è°ƒæ€§æ˜¾ç„¶ï¼›$h &gt; max$ æ—¶åªä¼šå¹³ç§»å’Œä¸Šç§»å– $min$ï¼Œå•è°ƒæ€§æ˜¾ç„¶ã€‚</p>
<p>æœ‰äº†å•è°ƒæ€§å°±ä¸ç”¨ç»´æŠ¤å‰ç¼€ $min$ äº†ï¼Œçº¿æ®µæ ‘ç»´æŠ¤åŒºé—´åŠ å¸¸æ•°ã€åŒºé—´å– $min$ã€åŒºé—´åŠ ç­‰å·®æ•°åˆ—ã€‚é‡‡å–å·®åˆ†æ€æƒ³ï¼Œå˜æˆå•ç‚¹åŠ ã€åŒºé—´å– $min$ã€åŒºé—´åŠ å¸¸æ•°ã€‚</p>
<p>PSï¼šè¿™ç±»é¢˜å…¶å®ä¹‹å‰æ¨¡æ‹Ÿèµ›é‡åˆ°è¿‡ï¼Œä¹Ÿæ˜¯ç¬¬ä¸€ç§æš´åŠ›æ²¡å‰é€”ã€ç¬¬äºŒç§æš´åŠ›å¯ä»¥ç”¨ $Trie$ æ ‘ä¼˜åŒ–ã€‚</p>
<h4 id="T3-10"><a href="#T3-10" class="headerlink" title="$T3$"></a>$T3$</h4><p>è®¾ $f[i, j]$ è¡¨ç¤ºå·²ç»è€ƒè™‘äº†è¿ç»­çš„ $i$ ä¸ªï¼Œé€‰äº†é‡Œé¢ $j$ ä¸ªäººï¼Œè®¨è®ºæ–°åŠ ä¸€ä¸ªäººåˆ°å¼€å¤´/ç»“å°¾ï¼Œæœ‰ï¼š</p>
<ul>
<li>$f[i, j] = f[i - 1, j] <em> p^j + f[i - 1, j - 1] </em> q^{i - j}$</li>
<li>$f[i, j] = f[i - 1, j] <em> q^j + f[i - 1, j - 1] </em> p^{i - j}$</li>
</ul>
<p>è”ç«‹è§£å¾— $f[i - 1, j]$ å…³äº $f[i - 1, j - 1]$ çš„é€’æ¨å¼ï¼Œç›´æ¥æ¨å°±å®Œäº‹äº†ï¼ï¼ï¼$f[i - 1, j] = \frac{ p^{i - j} - (1 - p)^{i - j} }{ p^j - (1 - p)^j } f[i - 1, j - 1]$ï¼Œæ³¨æ„åˆ¤ $p = \frac{1}{2}$ çš„æƒ…å†µã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/12/06/ã€å­¦ä¹ ç¬”è®°ã€‘ç”Ÿæˆå‡½æ•°/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/12/06/ã€å­¦ä¹ ç¬”è®°ã€‘ç”Ÿæˆå‡½æ•°/" itemprop="url">
                  ã€å­¦ä¹ ç¬”è®°ã€‘ç”Ÿæˆå‡½æ•°
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-12-06T23:14:05+08:00">
                2020-12-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>è¿æ°”å¥½çš„è¯ä¹Ÿè®¸ä¸ç”¨é‡ä¿®ï¼Ÿæ„Ÿè§‰æŒºå¥½ç†è§£å‘€ï¼</p>
<h2 id="æ— è¶£çš„-åŸºæœ¬æ¦‚å¿µå’ŒæŠ€æœ¯"><a href="#æ— è¶£çš„-åŸºæœ¬æ¦‚å¿µå’ŒæŠ€æœ¯" class="headerlink" title="æ— è¶£çš„$åŸºæœ¬æ¦‚å¿µå’ŒæŠ€æœ¯$"></a><del>æ— è¶£çš„</del>$åŸºæœ¬æ¦‚å¿µå’ŒæŠ€æœ¯$</h2><hr>
<ul>
<li>çº¦å®šï¼š$fâ€™(x)$ è¡¨ç¤ºå¯¹ $f(x)$ æ±‚å¯¼</li>
</ul>
<p>ç”Ÿæˆå‡½æ•°çš„ç³»æ•°ä»å…·ä½“çš„æ•°è¢«æ¨å¹¿åˆ°äº†<strong>å½¢å¼å¹‚çº§æ•°</strong>ã€‚</p>
<p>å¤§å°å‡½æ•°ï¼šå¥½éš¾è¯´æ¸…æ¥šï¼Ÿå°±æ˜¯æ¯”å¦‚æŸä¸ªç”Ÿæˆå‡½æ•°ç¬¬ $n$ é¡¹çš„å¤§å°å‡½æ•° $= n$ã€‚ä¸åŒçš„æƒ…å¢ƒä¸‹å¤§å°å‡½æ•°è¢«èµ‹äºˆä¸åŒçš„å®é™…æ„ä¹‰ã€‚</p>
<p>æ™®é€šç”Ÿæˆå‡½æ•°ï¼šOGF</p>
<ul>
<li>æ— æ ‡å·xxè®¡æ•°</li>
</ul>
<p>æŒ‡æ•°ç”Ÿæˆå‡½æ•°ï¼šEGF</p>
<ul>
<li>æœ‰æ ‡å·xxè®¡æ•°ï¼Œæ˜¯æ³°å‹’çº§æ•°çš„å½¢å¼ã€‚åˆå¹¶çš„æ—¶å€™ä¼š $C(n + m, n)$ é‡æ–°åˆ†é…æ ‡å·ï¼š$[x^n]f(x) = a_n\frac{x^n}{n!}$, $[x^m]g(x) = b_m\frac{x^m}{m!}$, åˆå¹¶èµ·æ¥å°±å¯¹ $[x^{n + m}]$ æœ‰è´¡çŒ®ï¼š$a_nb_m\frac{x^{n + m}}{n!m!}$ã€‚</li>
</ul>
<p>æ³°å‹’çº§æ•°ï¼š</p>
<ul>
<li><p>$e^x = \sum\limits_{k \geq 0} \frac{x^k}{k!}$</p>
</li>
<li><p><a href="https://baike.baidu.com/item/%E6%B3%B0%E5%8B%92%E5%85%AC%E5%BC%8F/7681487?fr=aladdin" target="_blank" rel="noopener">æ³°å‹’å±•å¼€</a></p>
</li>
</ul>
<p>æ±‚å¯¼ï¼š$x^n = nx^{n - 1}$ï¼Œä¸ç”Ÿæˆå‡½æ•°çš„å·¦ç§»ä½ç›¸å¯¹åº”ã€‚</p>
<p>æ±‚ç§¯åˆ†ï¼š$\int x^n dx = \frac{1}{n + 1} x^{n + 1}$ï¼Œä¸ç”Ÿæˆå‡½æ•°çš„å³ç§»ä½ç›¸å¯¹åº”ã€‚</p>
<p>ä¹˜æ³•é€†å…ƒï¼š</p>
<ul>
<li><p>$A(x)B(x) \equiv 1 \pmod {x^n}$</p>
</li>
<li><p>$A(x)$ æœ‰ä¹˜æ³•é€†å…ƒçš„å……è¦æ¡ä»¶æ˜¯ $A(x)$ çš„å¸¸æ•°é¡¹æœ‰ä¹˜æ³•é€†å…ƒã€‚å¿…è¦æ€§ï¼š$[x^0] A(x) [x^0] B(x) = 1$</p>
</li>
<li><p>æœ‰<a href="https://www.luogu.com.cn/paste/2x7n21r1" target="_blank" rel="noopener">æ±‚æ³•</a>,ï¼ˆæ³¨ï¼šè¿™é‡Œçš„ $Bâ€™$ ä¸æ˜¯æ±‚å¯¼ï¼Œå°±æ˜¯å•çº¯è¡¨ç¤ºå¦ä¸€ä¸ªç”Ÿæˆå‡½æ•°ï¼‰æ¯æ¬¡ç®—å‡º $2Bâ€™ - ABâ€™^2$ èµ‹ç»™ $B$ï¼Œæ¯æ¬¡è§„æ¨¡å‡å°ä¸€åŠï¼Œ$T(n) = T(n/2)+O(nlogn) = O(nlogn)$ï¼ˆæ˜¯ä¸æ˜¯å¾ˆåƒç‰›é¡¿è¿­ä»£ï¼Ÿï¼‰</p>
</li>
</ul>
<p>å¤åˆé€†ï¼šè‹¥å¯¹äºä¿©å‡½æ•° $f(x)$ å’Œ $g(x)$ è€Œè¨€æœ‰ $g(f(x)) = x$ï¼Œåˆ™å¯ä»¥çœ‹ä½œ $x$ åœ¨ $g \cdot f$ çš„ä½œç”¨ä¸‹ä¿æŒä¸å˜ï¼Œç§° $g$ ä¸º $f$ çš„å¤åˆé€†ã€‚<strong>å¯¹ $f$ å’Œ $g$ æœ‰è¦æ±‚ï¼šå¸¸æ•°é¡¹ä¸º 0 ä¸”ä¸€æ¬¡é¡¹ç³»æ•°ä¸ä¸º 0</strong>ã€‚</p>
<ul>
<li><p>æœ‰ç»“è®ºï¼šè‹¥ $g(f(x)) = x$ åˆ™ $f(g(x)) = x$ï¼Œ$f$ ä¸ $g$ äº’ä¸ºå¤åˆé€†ã€‚</p>
</li>
<li><p>æœ‰æ±‚å¯¼æ–¹å¼ï¼š$f(g(x))â€™ = fâ€™(g(x))gâ€™(x)$</p>
</li>
<li><p>æœ‰æ±‚æ³•ï¼šğŸ‘‡</p>
</li>
</ul>
<p>æ±‚æ³•å°±æ˜¯æ‹‰æ ¼æœ—æ—¥åæ¼”ï¼š</p>
<ul>
<li><p>å·²çŸ¥ $f(x)$ æ±‚ $g(x)$ï¼Œ$[x^n] g(x) = \frac{1}{n} [w^{n - 1}] (\frac{w}{f(w)})^n$</p>
</li>
<li><p>æ¨å¹¿å½¢å¼ï¼š$[x^n]h(g(x)) = \frac{1}{n} [w^{n - 1}] hâ€™(w) (\frac{w}{f(w)})^n$</p>
</li>
</ul>
<p>å¯¹æ•°å‡½æ•°ï¼š$ln$</p>
<ul>
<li><p>$ln(A(x)) = \sum\limits_{i \geq 1} \frac{A(x)^i}{i}$</p>
</li>
<li><p>æœ‰ç»“è®ºï¼š$lnâ€™(x) = \frac{1}{x}$</p>
</li>
<li><p>æœ‰æ±‚æ³•ï¼š$ln(A(x)) = \int (ln A(x))â€™ = \int \frac{Aâ€™(x)}{A(x)}$ï¼Œæ‰€ä»¥å¯¹ $A(x)$ æ±‚å¯¼ä½œä¸º $a$ï¼Œæ±‚é€†ä½œä¸º $b$ï¼Œ$a * b$ å†ç§¯åˆ†å°±å¾—åˆ°äº† $ln$ã€‚</p>
</li>
</ul>
<p>æŒ‡æ•°å‡½æ•°ï¼š$exp$</p>
<ul>
<li><p>$exp(A(x)) = \sum\limits_{i \geq 0} \frac{A(x)^i}{i!}$</p>
</li>
<li><p>æœ‰æ±‚æ³•ï¼šğŸ‘‡</p>
</li>
</ul>
<p>æ±‚æ³•å°±æ˜¯ç‰›é¡¿è¿­ä»£ï¼š</p>
<ul>
<li>è®¾ $f(x) = e^{A(x)}$, åˆ™å¾—åˆ°æ–¹ç¨‹ $g(f(x)) = ln(f(x)) - A(x) = 0$. è®¾å·²æ±‚å¾— $f$ å‰ $n$ é¡¹ $f_0(x)$ï¼Œå³ $f(x) \equiv f_0(x) \pmod {x^n}$. å¯¹ $g(f(x))$ ä½œæ³°å‹’å±•å¼€ï¼Œæ•´ç†å¯å¾— $f(x) \equiv f_0(x) - \frac{g(f_0(x))}{gâ€™(f_0(x))} \pmod {x^{2n}}$, å¸¦å…¥ $g(f(x))$ å®šä¹‰å¯å¾— $f(x) = f_0(x)(1 - ln(f_0(x)) + A(x))$ï¼ŒæŒ‰æ­¤è¿­ä»£ï¼Œ$T(n) = T(n/2)+O(nlogn) = O(nlogn)$</li>
</ul>
<p>å¯¹æ•°å‡½æ•°å’ŒæŒ‡æ•°å‡½æ•°çš„æ€§è´¨åœ¨è¿™é‡Œä»ç„¶æˆç«‹ã€‚</p>
<p>å¤šé¡¹å¼å¿«é€Ÿå¹‚ï¼šæ±‚ $A(x)^k$</p>
<ul>
<li>ç›´æ¥å¿«é€Ÿå¹‚æ˜¯ $O(n\ logn\ logk)$ çš„</li>
<li>æœ‰ $O(nlogn)$ æ±‚æ³•ï¼š$A(x)^k = exp(k\ ln\ A(x))$</li>
</ul>
<h2 id="æœ‰è¶£çš„è¡¨ç¤ºï¼"><a href="#æœ‰è¶£çš„è¡¨ç¤ºï¼" class="headerlink" title="$æœ‰è¶£çš„è¡¨ç¤ºï¼$"></a>$æœ‰è¶£çš„è¡¨ç¤ºï¼$</h2><hr>
<p>æœ‰æ ‡å·ç®€å•æ— å‘å›¾çš„ EGFï¼š$G(x) = \sum\limits_{n \geq 0} 2^{\binom{n}{2}} \frac{x^n}{n!}$</p>
<p>æœ‰æ ‡å·æ— å‘è¿é€šå›¾çš„ EGFï¼š$C(x) = ln(G(x))$</p>
<p>æ— æ ‡å·ç¯çš„ OGFï¼š$-\sum\limits_{d \geq 1} \frac{\phi(d)}{d} ln(1 - A(x^d))$, $ln(1 - A(x^d))$ ä¸­åªæœ‰ $n/d$ é¡¹æ˜¯æœ‰ç”¨çš„</p>
<h2 id="æœ‰è¶£çš„é¢˜ç›®ï¼"><a href="#æœ‰è¶£çš„é¢˜ç›®ï¼" class="headerlink" title="$æœ‰è¶£çš„é¢˜ç›®ï¼$"></a>$æœ‰è¶£çš„é¢˜ç›®ï¼$</h2><hr>
<h3 id="åŸå¸‚è§„åˆ’"><a href="#åŸå¸‚è§„åˆ’" class="headerlink" title="$åŸå¸‚è§„åˆ’$"></a><a href="https://www.luogu.com.cn/problem/P4841" target="_blank" rel="noopener">$åŸå¸‚è§„åˆ’$</a></h3><p>$G(x) = e^{C(x)} = \sum\limits_{n \geq 0} 2^{\binom{n}{2}} \frac{x^n}{n!}$ï¼Œç›´æ¥æ±‚ $ln(G(x))$ å³å¯</p>
<h3 id="The-Child-and-Binary-Tree"><a href="#The-Child-and-Binary-Tree" class="headerlink" title="$The\ Child\ and\ Binary\ Tree$"></a><a href="https://www.luogu.com.cn/problem/CF438E" target="_blank" rel="noopener">$The\ Child\ and\ Binary\ Tree$</a></h3><h3 id="ZJOI2019-å¼€å…³"><a href="#ZJOI2019-å¼€å…³" class="headerlink" title="$ZJOI2019-å¼€å…³$"></a><a href="https://www.luogu.com.cn/problem/P5326" target="_blank" rel="noopener">$ZJOI2019-å¼€å…³$</a></h3><p>å•å†™åšå®¢äº†</p>
<h3 id="LOJ6538-çƒ·åŸºè®¡æ•°"><a href="#LOJ6538-çƒ·åŸºè®¡æ•°" class="headerlink" title="$LOJ6538-çƒ·åŸºè®¡æ•°$"></a><a href="https://loj.ac/p/6538" target="_blank" rel="noopener">$LOJ6538-çƒ·åŸºè®¡æ•°$</a></h3><p>æ…•åè€Œæ¥ï¼</p>
<p>å“¦ï¼Œæ‰€ä»¥æ— æ ‡å·è®¡æ•°ä¸€èˆ¬ä¼šç”¨åˆ°ç¾¤è®ºé‚£å¥—ç†è®ºæ˜¯å—ï¼Ÿå¦ˆå¦ˆæˆ‘ $burnside$ å­¦å€¼äº†ï¼</p>
<p>è®¾çƒ·åŸºç”Ÿæˆå‡½æ•°ä¸º $A(x)$ã€‚$A(x) = 1 + xA(x)^3$ æ˜¾ç„¶ä¸è¡Œã€‚è€ƒè™‘ $burnside$ï¼Œä¸€ä¸ªç‚¹åªæœ‰ä¸‰ä¸ªå„¿å­å…± $3! = 6$ ç§ç½®æ¢ï¼š</p>
<ul>
<li>$(1, 2, 3): A(x)^3$</li>
<li>$(1, 3, 2)(3, 2, 1)(2, 1, 3): 3A(x)A(x^2)$</li>
<li>$(2, 3, 1)(3, 1, 2): 2A(x^3)$</li>
</ul>
<p>æ‰€ä»¥ $A(x) = 1 + \frac{x}{6}(A(x)^3 + 3A(x)A(x^2) + 2A(x^3))$</p>
<p>åˆ†æ²» NTT $O(nlog^2n)$, ç‰›é¡¿è¿­ä»£ $O(nlogn)$</p>
<p>æˆ‘åªä¼šåˆ†æ²» NTTã€‚ã€‚å·å•Šå·å·å•Šå· å°±å¯ä»¥äº†ã€‚å…·ä½“æ¥è¯´å·çš„æ–¹æ³•åˆ†åˆ«å¦‚ä¸‹ï¼š</p>
<ul>
<li>$A(x)^3$: $[l, mid]$ ä¸‰æ¬¡</li>
<li>$3A(x)A(x^2)$: $[l, mid]$ ä¸€æ¬¡ï¼Œ$[mid + 1, r]$ ä¸€æ¬¡</li>
<li>$2A(x^3)$: $l \neq 0$ çš„æ—¶å€™ $2l &gt; r$ï¼Œæ‰€ä»¥ $[l, mid]$ ä¸€æ¬¡ï¼Œ$[0, r - l]$ ä¸¤æ¬¡ï¼›$l = 0$ çš„æ—¶å€™ $[l, mid]$ ä¸‰æ¬¡ã€‚</li>
</ul>
<p><a href="https://loj.ac/s/1012212" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="LOJ6512-çƒ·çƒƒè®¡æ•°"><a href="#LOJ6512-çƒ·çƒƒè®¡æ•°" class="headerlink" title="$LOJ6512-çƒ·çƒƒè®¡æ•°$"></a><a href="https://loj.ac/p/6512" target="_blank" rel="noopener">$LOJ6512-çƒ·çƒƒè®¡æ•°$</a></h3><p>ä¸ä¸Šä¸€é¢˜çš„åŒºåˆ«ä¹Ÿæ˜¯æ­¤é¢˜çš„éš¾ç‚¹ï¼Œæ˜¯<strong>æ— æ ¹æ ‘</strong>ã€‚ä¸éš¾æƒ³åˆ°æ ‘çš„é‡å¿ƒï¼Œç”šè‡³ $4$ ä¸ªå„¿å­çš„ $burnside$ å¼•ç†ä½ éƒ½æƒ³å¥½äº†ä½†è¿˜æ˜¯ä¸çŸ¥é“æ€ä¹ˆåˆ‡å…¥ã€‚</p>
<p>è®¾çƒ·çƒƒç”Ÿæˆå‡½æ•°ä¸º $B(x)$ã€‚</p>
<blockquote>
<p>æœ‰ç»“è®ºï¼š$c - d + e = 1$</p>
<p>$c$ ä¸ºç‚¹ç­‰ä»·ç±»ä¸ªæ•°ã€‚ä¸¤ä¸ªç‚¹åœ¨ä¸€ä¸ªç­‰ä»·ç±»ä¸­ï¼Œå½“ä¸”ä»…å½“åˆ†åˆ«ä»¥ä¸¤ä¸ªç‚¹ä¸ºæ ¹çš„æœ‰æ ¹æ ‘åŒæ„ã€‚</p>
<p>$d$ ä¸ºè¾¹ç­‰ä»·ç±»ä¸ªæ•°ã€‚ä¸¤æ¡è¾¹åœ¨ä¸€ä¸ªç­‰ä»·ç±»ä¸­ï¼Œå½“ä¸”ä»…å½“åˆ†åˆ«åˆ å»ä¸¤æ¡è¾¹å¾—åˆ°çš„æœ‰æ ¹æ ‘åŒæ„ã€‚</p>
<p>$e$ ä¸ºæ˜¯å¦å­˜åœ¨ä¸€æ¡è¾¹ä½¿å¾—æ–­æ‰åä¸¤è¾¹ä»¥æ–­è¾¹ç«¯ç‚¹ä¸ºæ ¹çš„å­æ ‘åŒæ„ã€‚</p>
<p>è¯æ˜ï¼š</p>
<ol>
<li>$e = 0$ï¼Œæ ¹ä¸ºé‡å¿ƒï¼Œè‡ªæˆä¸€ä¸ªç­‰ä»·ç±»ï¼›å¯¹äºå‰©ä¸‹çš„ç‚¹ï¼Œå®ƒä»¬çš„çˆ¶è¾¹åœ¨åŒä¸€ä¸ªè¾¹ç­‰ä»·ç±»ä¸­ï¼Œå½“ä¸”ä»…å½“å®ƒä»¬åœ¨åŒä¸€ä¸ªç‚¹ç­‰ä»·ç±»ä¸­ï¼Œ$c - d = 1$.</li>
<li>$e = 1$ï¼Œåœ¨è¿æ¥ä¸¤ä¸ªé‡å¿ƒçš„è¾¹ä¸ŠåŠ å…¥ä¸€ä¸ªç‚¹å˜æˆæœ‰æ ¹æ ‘ï¼Œè½¬ä¸ºæƒ…å†µ 1.</li>
</ol>
</blockquote>
<p>æ¨åˆ°ç”Ÿæˆå‡½æ•°å½¢å¼ï¼Œ$C(x) - D(x) + E(x) = B(x)$</p>
<p>$C(x)$ å¯ä»¥çœ‹ä½œæ‰€æœ‰ä¸åŒæ„çš„æ— æ ‡å·æ— æ ¹æ ‘çš„ $c$ ä¹‹å’Œï¼Œå³æ‰€æœ‰ä¸åŒæ„çš„æ— æ ‡å·æœ‰æ ¹æ ‘ä¸ªæ•°ï¼Œ$C(x) = \frac{x}{24} ( A(x)^4 + 6A(x)^2A(x^2) + 3A^2(x^2) + 8A(x)A(x^3) + 6A(x^4) )$</p>
<p>$D(x)$ å¯ä»¥çœ‹ä½œåœ¨è¾¹ä¸ŠåŠ ä¸€ä¸ªç‚¹èƒ½æ„æˆå¤šå°‘ä¸ªä¸åŒçš„æœ‰æ ¹æ ‘ï¼Œ$D(x) = \frac{(A(x) - 1)^2 + (A(x^2) - 1)}{2}$</p>
<p>$E(x)$ å¯ä»¥çœ‹ä½œåŒæ„æœ‰æ ¹æ ‘ä¸ªæ•°ï¼Œ$E(x) = A(x^2)$</p>
<p><a href="https://loj.ac/s/1012789" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="çç "><a href="#çç " class="headerlink" title="$çç $"></a><a href="https://loj.ac/p/3120" target="_blank" rel="noopener">$çç $</a></h3><p>æ¦‚ç‡ç”Ÿæˆå‡½æ•°ç›¸å…³ã€‚</p>
<p>ã€ç™½äº‘ç™½å…”å¯çˆ±ï¼å–œæ¬¢é¢˜é¢ã€‘.jpg</p>
<p>å·§å¦™ç”Ÿæˆå‡½æ•°ï¼$\sum\limits_{i = 1}^D \lfloor \frac{cnt_i}{2} \rfloor \geq m \Rightarrow \sum\limits_{i = 1}^D cnt_i \% 2 \leq n - 2m$ï¼Œç‰¹åˆ¤ä¸åˆæ³•æƒ…å†µã€‚</p>
<p>æšä¸¾ $cnt_i \% 2 = 1$ å³å¥‡æ•°çš„ä¸ªæ•°ï¼Œè®¾ $odd_i$ è¡¨ç¤ºæœ‰ $i$ ä¸ªå¥‡æ•°çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™ $ans = \sum\limits_{i = 1}^{n - 2m}$</p>
<p>$odd$ æ˜¯æ°å¥½ï¼Œä¸å¥½ç®—ï¼ŒäºŒé¡¹å¼åæ¼”ä¸€æ³¢ï¼šè®¾ $f$ è¡¨ç¤ºè‡³å°‘, æ¥ä¸‹æ¥å°±ç®— $f$</p>
<p>$$odd_i = \sum\limits_{j = i}^D (-1)^{j - i} C(j, i) f_j$$</p>
<p>$$= \sum\limits_j (-1)^{j - i} \frac{j!}{i!(j - i)!} f_j$$</p>
<p>$$= \frac{1}{i!} \sum_j \frac{(-1)^{j - i}}{(j - i)!} j!f_j$$</p>
<p>æ˜¾ç„¶çš„å·ç§¯å½¢å¼ã€‚</p>
<p>ä¼šæƒ³èµ·æ•°åˆ— ${0, 1, 0, 1, \cdots}$ çš„ $EGF$ ä¸º $\frac{e^x - e^{-x}}{2}$ï¼Œæœ‰ï¼š</p>
<p>$$f_k = C(D, k) n! [x^n] ( (\frac{e^x - e^{-x}}{2})^k (e^x)^{D - k} )$$</p>
<p>$$= C(D, k) \frac{n!}{2^k}\sum\limits_{j = 0}^k C(k, j) (-1)^{k - j} e^{(D + 2(j - k))x}$$</p>
<p>$$= \frac{C(D, k)}{2^k} \sum\limits_{j = 0}^k \frac{k!}{j!(k - j)!} (-1)^j (D - 2j)^n$$</p>
<p>$$= \frac{D!}{2^k(D - k)!} \sum\limits_{j = 0}^k \frac{(-1)^j (D - 2j)^n}{j!} \frac{1}{(k - j)!}$$</p>
<p>å·ç§¯ï¼å®Œäº‹äº†ã€‚</p>
<h3 id="CF755G-Poland-Ball-and-many-other-Balls"><a href="#CF755G-Poland-Ball-and-many-other-Balls" class="headerlink" title="CF755G-Poland Ball and many other Balls"></a><a href="https://www.luogu.com.cn/problem/CF755G" target="_blank" rel="noopener">CF755G-Poland Ball and many other Balls</a></h3><p>æ€è·¯ç®€å•ï¼Œé€‚åˆç»ƒä¹ å¤„ç†ç”Ÿæˆå‡½æ•°çš„ Trickã€‚</p>
<p>å®¹æ˜“å†™å‡º $dp$ æŸ¿å­ï¼š$f_{n, k} = f_{n - 1, k} + f_{n - 1, k - 1} + f_{n - 2, k - 1}$</p>
<h3 id="1-ç‰¹å¾æ–¹ç¨‹"><a href="#1-ç‰¹å¾æ–¹ç¨‹" class="headerlink" title="$1. ç‰¹å¾æ–¹ç¨‹$"></a>$1. ç‰¹å¾æ–¹ç¨‹$</h3><p>æœ‰é€’æ¨å…³ç³»â€”â€” $K$ ç”± $K$ å’Œ $K - 1$ æ¨å¾—ï¼Œäºæ˜¯è®¾ $F(x)$ è¡¨ç¤º $\sum_k f_{n, k}x^k$, åˆ—å‡ºç”Ÿæˆå‡½æ•°ï¼š$F_n(x) = F_{n - 1}(x) + xF_{n - 1}(x) + xF_{n - 2}(x)$ï¼Œå³ $F_n(x) = (1 + x)F_{n - 1}(x) + xF_{n - 2}(x)$</p>
<p>è¿™ç©æ„é•¿å¾—ä¸€è„¸ç‰¹å¾æ–¹ç¨‹ï¼Œäºæ˜¯å¼•å…¥æ–°çš„å…ƒ $z$ï¼Œè§£å‡º $z = \frac{ 1 + x \pm \sqrt{ 1 + 6x + x^2 } }{2}$</p>
<p>ç®—å‡ºé€’æ¨å¼çš„ $c_1$ å’Œ $c_2$ ä»¥åå¤šé¡¹å¼å…¨å®¶æ¡¶å°±å®Œäº‹äº†ã€‚ç„¶è€Œè’Ÿè’»å¹¶ä¸ä¼šç®—ï¼Ÿ</p>
<h3 id="2-å€å¢"><a href="#2-å€å¢" class="headerlink" title="$2. å€å¢$"></a>$2. å€å¢$</h3><p>è¿˜æ˜¯ä¸Šé¢é‚£ä¸ªæŸ¿å­ï¼Œä¸ä¸€æ ·çš„è§’åº¦çœ‹åˆ°çš„æ˜¯åŠ å¤§æ­¥é•¿è½¬ç§»â€”â€” æ ¹æ®ä¸­é—´æ˜¯å¦å‰²å¼€ä¸€ä¸ªç›¸é‚»çš„å—åˆ†ç±»è®¨è®ºï¼Œ$F_{n + m}(x) = F_n(x)F_m(x) + xF_{n - 1}(x)F_{m - 1}(x)$</p>
<p>$F_{2n}(x) = F_n^2(x) + xF_{n - 1}^2(x)$</p>
<p>$F_{2n - 1}(x) = F_n(x)F_{n - 1}(x) + xF_{n - 1}(x)F_{n - 2}(x)$</p>
<p>$F_{2n - 2}(x) = F_{n - 1}^2(x) + xF_{n - 2}^2(x)$</p>
<p>äºæ˜¯å°±å¯ä»¥ç”± $F_n(x)$, $F_{n - 1}(x)$, $F_{n - 2}(x)$ å¾—åˆ° $F_{2n}(x)$, $F_{2n - 1}(x)$, $F_{2n - 2}(x)$ å•¦</p>
<h3 id="3-ç»„åˆå®¹æ–¥"><a href="#3-ç»„åˆå®¹æ–¥" class="headerlink" title="$3. ç»„åˆå®¹æ–¥$"></a>$3. ç»„åˆå®¹æ–¥$</h3><p>è¿™ä¸ªæ¯”è¾ƒæœ‰æ„æ€ï¼ˆé›¾ï¼‰ï¼Œè’Ÿè’»æƒ³å†™è¿™ä¸ªæ–¹æ³•ã€‚ä¸èƒ½ä¸€ä¸Šæ¥å°±è¯´â€œæ»¡è„¸â€/â€œä¸€çœ¼â€ä¹‹ç±»çš„è¯å•Šï¼Œä½ æ ¹æœ¬éƒ½è¿˜æ²¡çœ‹å‡ºé—¨é“å‘¢ã€‚</p>
<p>æšä¸¾ä¸¤çƒç»„çš„ä¸ªæ•°ï¼Œ$f(k) = \sum_i \binom{n - i}{k} \binom{k}{i}$ã€‚ç„¶åå°±ä¸ä¼šäº†ï¼Œè¿™ç©æ„å’‹æ•´å•Šï¼Ÿ</p>
<p>é¢˜è§£æœ‰ç¥ä»™åŠæ³•ï¼Œéœ€è¦ä½ è¶³å¤Ÿçµæ´»ï¼šç»„åˆæ„ä¹‰ï¼Œå…ˆä»å‰ $K$ ä¸ªé‡Œé€‰ä»»æ„ä¸ªï¼Œå†ä»å‰©ä¸‹çš„é‡Œé€‰ $K$ ä¸ªã€‚</p>
<p>è¿™æœ‰ä¸ªè›‹ç”¨ï¼Ÿ</p>
<p>éšè—å…³ç³»ï¼š<em>ä¸é‡å¤</em>ã€‚é‡å¤è¿™ç©æ„å°±å¯ä»¥å®¹æ–¥ï¼Œè®¾ $F(k)$ è¡¨ç¤ºæ°å¥½é‡å¤ $k$ ä¸ªï¼Œ$G(k)$ è¡¨ç¤ºè‡³å°‘é‡å¤ $k$ ä¸ªã€‚</p>
<p>$$G(i) = \binom{k}{i} \binom{n - i}{k - i} 2^{k - i}$$</p>
<p>$$F(0) = \sum\limits_{i = 0}^k (-1)^i G(i)$$</p>
<p>$$= \frac{k!}{(n - k)!} \sum\limits_{i = 0}^k \frac{(-1)^i(n - i)!}{i!} \cdot \frac{2^{k - i}}{((k - i)!^2)}$$</p>
<p>$n$ è¿‡å¤§ï¼Œæ€ä¹ˆåŠï¼ŸåŒ–ä¸‹é™å¹‚ã€‚ã€‚è¿™å…¶å®æ˜¯ä¸€ä¸ªè‡ªç„¶çš„äº‹æƒ…ï¼Œå¯èƒ½æˆ‘è¿˜æ²¡é€‚åº”ç½¢ã€‚</p>
<p>$$= \frac{k!n!}{(n - k)!} \sum\limits_{i = 0}^k \frac{(-1)^i(n - i)!}{i!n!} \cdot \frac{2^{k - i}}{((k - i)!^2)}$$</p>
<p>$$= k!n^{\underline{k}} \sum\limits_{i = 0}^k \frac{(-1)^i}{i!n^{\underline{i}}} \cdot \frac{2^{k - i}}{((k - i)!^2)}$$</p>
<p><a href="https://codeforces.com/problemset/submission/755/102687760" target="_blank" rel="noopener">$Code$</a></p>
<p>æ³¨æ„ç©ºé—´è¦å¼€è¶³ã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/12/05/ã€è®¡åˆ’ã€‘NOIP2020èµ›å‰è®­ç»ƒå°ç»“/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/12/05/ã€è®¡åˆ’ã€‘NOIP2020èµ›å‰è®­ç»ƒå°ç»“/" itemprop="url">
                  NOIP2020èµ›å‰è®­ç»ƒå°ç»“
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-12-05T23:59:59+08:00">
                2020-12-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>å¼€ä¸€ç¯‡åšå®¢ï¼ŒåŠ©åŠ› $NOIP2020$</p>
<p>å°‘æµªè´¹æ—¶é—´åœ¨æ— æ„ä¹‰çš„è‡ªæˆ‘æ€€ç–‘ä¸­ï¼Œ$you\ do\ have\ a\ lot\ to\ learn$ï¼Œä¿æŒç¨³å®šè€Œæ¬£å–œçš„å¿ƒæ€ å¥”è·‘å§ï¼</p>
<p><em>çœ¼é«˜æ‰‹ä½é€šè¿‡ç»ƒä¹ æ‰‹ä¼šæ…¢æ…¢å˜é«˜ï¼Œçœ¼ä½æ‰‹ä½ç»ƒåˆ°æ­»éƒ½æ˜¯èœã€‚</em></p>
<p><em>æŠ±æ€¨èº«å¤„é»‘æš—ï¼Œä¸å¦‚æç¯å‰è¡Œã€‚æ„¿ 11.7 å‡ºè€ƒåœºçš„æˆ‘ä¸ç•™é—æ†¾ï¼</em></p>
<p><em>ä¸éª„ï¼Œä¸èºï¼Œä¸æƒ§ï¼Œä¸æ‚”ã€‚</em></p>
<hr>
<h3 id="9-5"><a href="#9-5" class="headerlink" title="9.5"></a>9.5</h3><p>noi2019D1T1ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰ï¼Œapio2020T2ï¼ˆkruskalé‡æ„æ ‘ï¼‰, ä¸€é“çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾ï¼Œæ˜¥èŠ‚åäºŒå“ï¼ˆå †å’Œè´ªå¿ƒï¼‰</p>
<h3 id="9-6"><a href="#9-6" class="headerlink" title="9.6"></a>9.6</h3><p>uoj455ï¼ˆå¯æ’¤é”€è´ªå¿ƒæ¨¡æ‹Ÿè´¹ç”¨æµï¼‰ï¼Œluogu4260ï¼ˆè®¡æ•° + è«é˜Ÿç®—ç»„åˆæ•°å‰ç¼€å’Œï¼‰</p>
<h3 id="9-7"><a href="#9-7" class="headerlink" title="9.7"></a>9.7</h3><p>cf558eï¼ˆçº¿æ®µæ ‘åŒºé—´æ’åºï¼Œå®è´¨æ˜¯åŒºé—´èµ‹å€¼ï¼‰ï¼Œcf1194fï¼ˆæœŸæœ›è®¡æ•° + å¤æ‚åº¦åˆ†æï¼‰ï¼Œcf round 664 div1 A ~ C</p>
<h3 id="9-8"><a href="#9-8" class="headerlink" title="9.8"></a>9.8</h3><p>luogu2542ï¼ˆæœ‰ç‚¹ç‚¹å¥—è·¯çš„æ ‘å‰–é¢˜ï¼‰ï¼Œcf1327fï¼ˆé™åˆ¶dpï¼‰ï¼Œuoj209ï¼ˆæ€ç»´ï¼‰ï¼Œuoj210ï¼ˆ2-satï¼‰</p>
<h3 id="9-9"><a href="#9-9" class="headerlink" title="9.9"></a>9.9</h3><p>loj3158ï¼ˆè´ªå¿ƒ + å †ï¼Œæ¨¡æ‹Ÿè´¹ç”¨æµï¼‰ï¼Œuoj58</p>
<h3 id="9-10"><a href="#9-10" class="headerlink" title="9.10"></a>9.10</h3><p>9.10 çš„è®­ç»ƒè®°å½•è¢«åäº†</p>
<h3 id="9-14"><a href="#9-14" class="headerlink" title="9.14"></a>9.14</h3><p>cf986cï¼ˆç®€å•äºŒè¿›åˆ¶é¢˜ï¼‰ï¼Œloj3303ï¼ˆçº¿æ®µæ ‘åˆå¹¶ 01 trieï¼‰ï¼Œuoj137ï¼ˆå·§å¦™åŠ ç»´ dpï¼‰ï¼Œuoj134ï¼ˆå›¾çš„è¿é€šæ€§ï¼‰ï¼Œç‰›å®¢ç»ƒä¹ èµ›69ï¼ˆABCEï¼‰ï¼Œæ€»ç»“å°±æ˜¯åˆ‡äº†ä¸€å¤©æ°´é¢˜</p>
<hr>
<p>æˆ‘æ¥å¡«å‘ï¼Œåˆèµ› 90.5 ç¨³ç¨³é£è¿‡ï¼Œå¸Œæœ›å¤èµ›ä¹Ÿèƒ½ç¨³ç¨³çš„å‘€ ~ å‰æ®µæ—¶é—´å¤ªå¿™äº†ï¼Œä½†æ˜¯è§‰å¾—è®­ç»ƒå°ç»“å¾ˆé‡è¦ï¼Œå¸Œæœ›å¯¹è‡ªå·±çš„ç¨‹åº¦æœ‰æ¸…æ™°çš„è®¤çŸ¥ã€‚</p>
<h3 id="10-17"><a href="#10-17" class="headerlink" title="10.17"></a>10.17</h3><p>æ¨¡æ‹Ÿèµ›ç®€å•æ•°è®ºï¼ˆå at é£ï¼‰+ èƒŒåŒ…åˆ†æ²»ï¼ˆå¥—è·¯é£ç„¶è€Œè¿˜æ˜¯ä¸ä¼šã€‚ã€‚ï¼‰+ è®¡æ•°æ¨æŸ¿å­ï¼Œæ„Ÿè§‰è‡ªå·±è®¡æ•°çš„æ°´å¹³æœ‰é•¿è¿›ä½†è¿˜ä¸å¤Ÿã€‚<strong>dp å¤šç»ƒï¼</strong></p>
<h3 id="10-18"><a href="#10-18" class="headerlink" title="10.18"></a>10.18</h3><p>cf div2 æ‰‹é€Ÿåœº 4 é“ã€‚wxw 26 min AC 2E å¥½å¼ºå‘€ï¼cf ç°åœºçœŸçš„è·Ÿ vp ä¸ä¸€æ ·ã€‚ç»“è®ºï¼š<strong>å¤šæ‰“ cfï¼</strong>ï¼ˆæœ‰æ—¶é—´ vp å°±ä¸é”™äº†= =</p>
<p>AT ä¸¤é“ï¼Œä¸€æ˜¯ç¥å¥‡çš„å¼‚æˆ–è½¬ % 2 æ„ä¹‰ä¸‹åŠ æ³•ï¼Œç”¨å¤šé¡¹å¼ gcd åšï¼›äºŒæ˜¯ä¸éš¾ä½†å°å·§æ¸…æ–°çš„åŒä½™æœ€çŸ­è·¯ã€‚</p>
<h3 id="10-19"><a href="#10-19" class="headerlink" title="10.19"></a>10.19</h3><p>è¢«åäº†ï¼ˆå¿˜è®°è®°å½•äº†</p>
<h3 id="10-20"><a href="#10-20" class="headerlink" title="10.20"></a>10.20</h3><p>æ•ˆç‡ä½çš„ä¸€å¤©â€¦qaq å†™äº† LCT æ¿å­ï¼Œè¿˜æœ‰ä¸€å †ç®€å•é¢˜</p>
<h3 id="10-21"><a href="#10-21" class="headerlink" title="10.21"></a>10.21</h3><p>ä»Šå¤©ä¹Ÿæ²¡æœ‰æ¨¡æ‹Ÿèµ›ã€‚ã€‚å¼€å¿ƒ ä½†æ˜¯æœ‰ç‚¹æ…Œï¼Œæ„Ÿè§‰è‡ªå·±å¤èµ›æ°´å¹³ååˆ†ä¸ç¨³</p>
<h3 id="10-22"><a href="#10-22" class="headerlink" title="10.22"></a>10.22</h3><p>XJ æ¨¡æ‹Ÿèµ›åæ°´äº†ï¼Œvp cf è¿œå¤åœºï¼ˆæ‰ä¿¡å¿ƒï¼‰å§ï¼è¿˜å†™äº†ä¸¤é“ at</p>
<h3 id="10-23"><a href="#10-23" class="headerlink" title="10.23"></a>10.23</h3><p>ä»Šå¤©æ•ˆç‡ä¸é«˜ã€‚ä¸è¿‡å¼€å§‹å¬è¯¾å•¦ï¼åŠ æ²¹åŠ æ²¹åŠ åŠ æ²¹ï¼ï¼ï¼ï¼</p>
<p>ç®€å•é¢˜åŠ ä¸Šå¯¹æ‹éƒ½èƒ½ä¿è¯å†™å‡ºäº†ï¼Œç°åœ¨å°±æ˜¯é•¿ä»£ç çš„è°ƒå†™å’Œæ€ç»´è¦åŠ é‡è®­ç»ƒã€‚</p>
<hr>
<p>CSP æ²¡æœ‰è€ƒå¥½ï¼Œå‰æœŸçš„è®­ç»ƒè¿˜æ˜¯æŒºæµ®èºçš„ï¼Œå¿ƒæ€ä¹Ÿæ²¡å…»å¥½ã€‚ä¸éª„ä¸èºï¼Œä¸æƒ§ä¸æ‚”ï¼Œåšå®šçš„æ²‰é™çš„èµ°è‡ªå·±çš„è®¡åˆ’ã€‚ç»§ç»­å¼€å‘ã€‚</p>
<h3 id="11-19"><a href="#11-19" class="headerlink" title="11.19"></a>11.19</h3><p>å­¦äº†æ–¯å¦çº³æ ‘ã€‚åšäº† THUSCH-å·§å…‹åŠ›ã€‚vp å¹¶è®¢æ­£äº† CF185(Div1) BCDã€‚åšäº† loj2277, loj6033ã€‚çœ‹åˆ°æœ‰è¶£çš„é¢˜ä¼šåŠ è¿›é¢˜å•é‡Œçš„ã€‚</p>
<p>psï¼šæˆ‘çœŸçš„å¥½å–œæ¬¢ LOJ å‘€ ~</p>
<h3 id="11-20"><a href="#11-20" class="headerlink" title="11.20"></a>11.20</h3><p>To do listï¼šuer 4 å’Œ 6 çš„ T3, å¤§å‰å¤© T3ï¼Œæ¨æŸ¿å­</p>
<p>vp å¹¶è®¢æ­£äº† CF#FF(Div1) çš„ BCDã€‚åšäº† loj2118ã€‚è‡ªå·±æ¨äº†ä¸€ä¸ªå¹³å¹³æ— å¥‡çš„æŸ¿å­ï¼ˆ</p>
<h3 id="11-21"><a href="#11-21" class="headerlink" title="11.21"></a>11.21</h3><ul>
<li>ä»Šå¤©æ¨¡æ‹Ÿèµ›æ²¡æœ‰ fstï¼300ï¼ï¼ˆæœ‰ç”Ÿä¹‹å¹´ç³»åˆ— (<em>â—‘âˆ‡â—‘)çˆ»(â—âˆ‡â—</em>)ï¼ˆè™½ç„¶å¤§å®¶ä»Šå¤©åˆ†éƒ½å¾ˆé«˜ï¼ˆä½†æ˜¯æˆ‘å’Œ LMOliver ç¥ä»™åŒåˆ†è¯¶ï¼ˆä¸è¦ä¹æç”Ÿæ‚²= = å¹³é™ä¸€ç‚¹ï¼ˆä½ çš„å†…å¿ƒæˆå·²ç»æº¢å‡ºå±å¹•äº†^-^</li>
</ul>
<p>To do list: è®¢æ­£ monisaiï¼Œuer 4 å’Œ 6 çš„ T3ï¼Œå¤§å¤§å‰å¤© T3</p>
<p>è®¢æ­£äº† monisaiï¼Œåšäº† uer 4 çš„ T3</p>
<h3 id="11-22"><a href="#11-22" class="headerlink" title="11.22"></a>11.22</h3><p>To do list: uer 6 çš„ T3ï¼Œuoj274, å¤§å¤§å¤§å‰å¤© T3ï¼Œè®¢æ­£ vp, litble * 1</p>
<p>åšäº† uer 6 çš„ T3ï¼Œè®¢æ­£äº† vp çš„ CF1163C2ã€Eã€F</p>
<h3 id="11-23"><a href="#11-23" class="headerlink" title="11.23"></a>11.23</h3><p>To do list: è®¢æ­£æ¨¡æ‹Ÿèµ›ã€vpï¼Œåˆ‡æ ‘æ¸¸æˆ, å›½ç‹é¥®æ°´è®°ï¼Œæ—¶ç©ºæ—…è¡Œï¼Œloj3057</p>
<p>è®¢æ­£äº†æ¨¡æ‹Ÿèµ›ï¼Œvp CF516 BCDEï¼Œåˆ‡æ ‘æ¸¸æˆ</p>
<h3 id="11-24"><a href="#11-24" class="headerlink" title="11.24"></a>11.24</h3><p>âš ï¸ ä»Šå¤©çš„æ¨¡æ‹Ÿèµ›ğŸ’¥äº†ï¼ˆæ‰¾å€Ÿå£ï¼šæ¯”èµ›çš„æ—¶å€™ç©¿çš„å¤ªå¤šäº†</p>
<p>å®é™…ä¸Šæ˜¯ï¼Œè·Ÿ T2 åˆšäº†æ¯”è¾ƒä¹…ï¼Œè‡ªä»¥ä¸ºå†™äº†æ­£ç¡®çš„åšæ³•å°±ä¸¢äº†ï¼Œåˆå†™äº† T3 çš„ 40 åˆ†æš´åŠ›å°±å¿ƒæ»¡æ„è¶³ä»¥ä¸ºå…¶ä»–äººä¹Ÿä¸è¿‡ 40 åˆ†ï¼Œå› ä¸ºæˆ‘ä»¥ä¸º T3 æ˜¯ç¥ä»™æ–œç‡ä¼˜åŒ–ï¼Œäº‹å®è¯æ˜æˆ‘å®Œå…¨æƒ³éš¾äº†ï¼æŠŠ w_i æ‹†å¼€å°±æ˜¯ä¸ª sb è´ªå¿ƒï¼æ‰€ä»¥å°±ç‚¸çš„å¾ˆå½»åº•äº†ã€‚äººå‡ 300 çš„åœºå­æˆ‘ 182ï¼Œå¾—æ·±åˆ»åæ€äº†ã€‚</p>
<p>ä¸éª„ä¸èºï¼Œä¸èƒ½å› ä¸ºå‰ä¸¤å¤©æ‰“å¾—è¿˜è¡Œå°±é£˜äº†ï¼Œnoip æ‰æ˜¯å®šèƒœè´Ÿçš„ä¸€å±€ã€‚ä¸è¿‡ä¹Ÿåˆ«ç´§å¼ äº†ï¼Œæ¯•ç«Ÿåªæ˜¯äººç”Ÿæ¼«æ¼«é•¿è·¯çš„ä¸€å¹•è€Œå·²</p>
<p>è¿˜æœ‰å°±æ˜¯ï¼Œå›ºå®šæ€ç»´æ˜¯æœ€å¯æ€•çš„ï¼Œä¸èƒ½å› ä¸ºå‰ä¸¤å¤©æ–œç‡ä¼˜åŒ–åšå¤šäº†å°±çœ‹å•¥éƒ½æ˜¯æ–œç‡ä¼˜åŒ–ï¼Œå®ƒæ¥ä¸ªè´ªå¿ƒä½ å°±çŒä¸åŠé˜²ã€‚å‰å‡ å¤©æ‰“å¾—ä¸é”™ä¹Ÿæ˜¯å› ä¸ºæ•¢ä¸æ–­å»å°è¯•æ–°çš„è§’åº¦ã€‚ï¼ˆè¯¶ï¼Œè¿™é¢˜è¿™ä¹ˆåšå¥½åƒæœ‰é«˜åˆ†æš´åŠ›æ‹¿/å¥½åƒå¯ä»¥è‰¹æ ‡ï¼‰æœ€è¿‘é¢˜åˆç®€å•ï¼ŒçœŸçš„ï¼Œå‚»é€¼é¢˜ä¸ä¼šåšå¤ªå¯æ€•äº†ï¼ˆå›æƒ³èµ· csp é¢å¯¹ T3 çš„æ— åŠ©å’Œèµ›åçš„ç—›å¿ƒç–¾é¦–äº†å—ï¼Ÿï¼‰</p>
<p><strong>æŠŠé—®é¢˜æƒ³å¤æ‚ï¼Œæœ¬è´¨å°±æ˜¯æ²¡æœ‰ä»”ç»†åˆ†æé—®é¢˜æ€§è´¨ï¼</strong> æœç„¶è¿˜æ˜¯æµ®èºäº†å—ã€‚</p>
<p><strong>å¬ç€ xmlï¼æ¥ä¸‹æ¥çš„ä¸¤å‘¨ï¼Œè¦é¿å…ä¸€åˆ‡å¯èƒ½ä¼šè®©å¿ƒèºèµ·æ¥çš„äº‹æƒ…ã€‚è™½ç„¶å¬ç€å¥½ç¬‘ï¼Œä½†çš„ç¡®æ˜¯è¿™ä¹ˆå›äº‹ã€‚</strong></p>
<p>To do list: è®¢æ­£ T4ï¼Œå›½ç‹é¥®æ°´è®°ï¼Œvpï¼Œbzoj3636ï¼Œloj3057ï¼Œæ´›è°·3553ã€3558</p>
<p>T4 æ˜¯é“æ²¡æ„æ€çš„å¤§æ•°æ®ç»“æ„ï¼ŒLCT ä»€ä¹ˆçš„â€¦?ï¼ˆæˆ‘ä¸ç²¾é€š LCT å•Š qaqï¼‰æœ¬è´¨æ˜¯ä¸ª easy çš„é˜¶æ¢¯ nimï¼Œæˆ‘ç«Ÿç„¶ä¸€ç›´åœ¨æƒ³åˆå¹¶å’‹åœ°å’‹åœ°ã€‚ã€‚ã€‚éƒ½è¯´æ˜¯é˜¶æ¢¯ nim äº†ï¼ï¼ï¼æœç„¶è¿˜æ˜¯å­¦è‰ºä¸ç²¾å—ï¼ï¼ï¼</p>
<p>èƒ¡äº†å›½ç‹é¥®æ°´è®°ï¼ˆä¸æƒ³å†™ï¼‰ï¼ˆåªä¼šæ–œç‡ä¼˜åŒ–ä¸ä¼šè´ªå¿ƒï¼‰ï¼Œvp CF461 BCDEï¼Œbzj3636</p>
<h3 id="11-25"><a href="#11-25" class="headerlink" title="11.25"></a>11.25</h3><p>ä»Šå¤©æ”¾äº†ä»¥å‰å“¥å“¥ç»™æˆ‘åšè¿‡çš„ mjy çš„ä¸€å¥—é¢˜ï¼ŒT2 ä¸å¹³ç­‰åšå¼ˆæˆ‘å†™ sgã€‚ã€‚ã€‚å…‰è£çˆ† 5ptsã€‚å¦å¤– T3 å‡äº†å¥½å‡ ç§åšæ³•ï¼›æƒ³åˆ°äº†åˆ†æ²»ï¼Œè§‰å¾—ååˆ†æœ‰å‰é€”ï¼Œä½†æ˜¯æ‰‹ç©å°æ ·ä¾‹æŠŠè‡ªå·±å‰äº†ï¼Œåæ¥äº‹å®è¯æ˜è¿™æ˜¯é“ä¸å¯åšé¢˜ï¼Œé¢˜è§£å†™çš„å§å•¦é•¿ï¼Œæœ€å°å‰² dp æ˜¯ä»€ä¹ˆç¥ä»™ç©æ„å•Š (â€ºÂ´Ï‰`â€¹ )ï¼ˆä½†æ˜¯è«åè§‰å¾—åˆ†æ²»æœ‰äº›æ­è¾¹ï¼Ÿ</p>
<p>To do listï¼šè®¢æ­£æ¨¡æ‹Ÿèµ› T3ï¼Œcf468dï¼Œloj3057, sp3734ï¼Œæ¸¸æˆ</p>
<p>åšäº† loj3057, cf468d, sp3734ï¼Œæ¸¸æˆ</p>
<h3 id="11-26"><a href="#11-26" class="headerlink" title="11.26"></a>11.26</h3><p>ä»Šå¤©ä¹Ÿé­é‡äº†ä½ç´ è´¨å‡ºé¢˜äººçš„ç‹‚è½°æ»¥ç‚¸ã€‚T3 polya æ¿é¢˜ä¸ä¼šï¼ŒT4 å®ƒ nã€mã€p çš„æœ€å¤§å€¼éƒ½ä¸åœ¨åŒä¸€æ¡£åˆ†å®³æˆ‘ RE æŒ‚äº† 80ï¼Ÿï¼Ÿï¼Ÿï¼ˆè¿™å¹´å¤´ä»€ä¹ˆæ²™é›•éƒ½æœ‰</p>
<p>To do listï¼šè®¢æ­£ vpï¼Œå­¦ä¹ polyaï¼ˆé€‰ï¼‰ï¼ŒDruzynyï¼Œuoj390, åºåˆ—, AGC011F</p>
<ul>
<li><p>å› ä¸ºå¤šäººè®²è¯¾ï¼ˆtyy &amp; kqhï¼‰æ‰€ä»¥è®¡åˆ’å’•äº†ä¸€å¤§åŠ</p>
</li>
<li><p>å‘ç° kqh è®²è¯¾éå¸¸å½¢è±¡ï¼Œå„ç§ç®—æ³•éƒ½èƒ½éšä¾¿ç”»ç¤ºæ„å›¾ï¼Œå¤§æ¦‚è¿™æ ·ä¼šå¸®åŠ©åŠ æ·±ç†è§£ã€‚æˆ‘ä¹Ÿè¯•è¯•ï¼Ÿï¼</p>
</li>
</ul>
<p>åšäº† CF578 çš„ CDE, Druzyny</p>
<h3 id="11-27"><a href="#11-27" class="headerlink" title="11.27"></a>11.27</h3><p>ä»Šå¤©ä¹Ÿé­é‡äº† sb çš„è‡ªå·±ã€‚ç¬¬ä¸‰æ¬¡åœ¨æ’åºå‰æ±‚å‰ç¼€å’Œäº† æˆ‘æ˜¯ sbï¼ï¼ï¼</p>
<p>To do listï¼šè®¢æ­£æ˜¨å¤© Fï¼Œuoj390ï¼ŒAGC011Fï¼Œloj3276, å­¦ä¹  polya &amp; è®¢æ­£æ˜¨å¤© T3ï¼Œvp</p>
<p>æ²¡é”™ï¼Œåšä¸å®Œå‰é¢çš„ä»Šå¤©ä½  xml å°±åˆ«æƒ³ vpã€‚</p>
<p>åšäº† æ˜¨å¤© Fï¼Œuoj390ï¼Œç–«æƒ…æ§åˆ¶ï¼ŒåŠé“ AGC011Fï¼ŒåŠé“ loj3276</p>
<h3 id="11-28"><a href="#11-28" class="headerlink" title="11.28"></a>11.28</h3><p>ä»Šå¤©æ˜¯ Fuyuki å‡ºçš„å¤šæ ¡è”è€ƒé¢˜ã€‚æ²¡æ‰“æŒ‚ï¼hohoï¼280ï¼ï¼ˆå…¶å®æ˜¯æ•°æ®æ°´ï¼Œå¤šç»™æˆ‘ 30ï¼ˆç„¶åæ‰“å‡ºäº† 100 80 60 40 è¿™æ ·æ¼‚äº®çš„ç­‰å·®æ•°åˆ—åˆ†</p>
<p>ä½ çœ‹äººå®¶ ä¸‡è€çˆ·ï¼ŒåŒæ · 280ï¼Œäººå®¶ T1 fst æˆ 0ï¼Œæœ¬æ¥åŠæ‰“æˆ‘ 100 åˆ†å‘¢ï¼ä¸éª„ä¸èºï¼Œä»è¦å‘ä¸‹æ‰æ ¹ï¼Œå‘ä¸Šç»“æœã€‚æˆ‘ä»¬æ¯ä¸€ä¸ªäººéƒ½è¦ç ¥ç ºå‰è¡Œã€‚</p>
<p>åŒºé—´å‘åŒºé—´è¿è¾¹ï¼Œå¦‚æœæœ‰åºå°±å¯ä»¥è€ƒè™‘å€å¢å¹¶æŸ¥é›†æˆ–è€…çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾ä»€ä¹ˆçš„â€¦</p>
<p>To do list: loj3276, 3277, 3278, å­¦ä¹  polya è®¢æ­£ T3ï¼ŒAGC011F</p>
<p>åšäº† loj3276. æ‰€ä»¥ä»Šå¤©æ˜¯å¾—æ„å¿˜å½¢çš„é¢“åºŸçš„ä¸€å¤©ï¼Œè¶…çº§å·®è¯„ï¼Œxml ä½ æ¸…é†’ä¸€ç‚¹ï¼Ÿï¼Ÿï¼Ÿ</p>
<h3 id="11-29"><a href="#11-29" class="headerlink" title="11.29"></a>11.29</h3><p>æ‰“äº†å›¾çµæ¯ï¼Œzzq å‡ºçš„é¢˜çœŸçš„ä¸€è¨€éš¾å°½ã€‚ã€‚ã€‚</p>
<p>çŸ¥é“æœ‰ä¸€ç§å¿«é€Ÿé˜¶ä¹˜ç®—æ³•ï¼š<a href="https://www.cnblogs.com/gryzy/p/6015485.html" target="_blank" rel="noopener">https://www.cnblogs.com/gryzy/p/6015485.html</a></p>
<p>To do listï¼šloj3277ï¼Œloj3278ï¼Œvp cfï¼ŒAGC011Fï¼Œå“¥å“¥çš„ SRM</p>
<p>åšäº† loj3277ï¼Œloj3278ï¼Œvp CF657 AB</p>
<h3 id="11-30"><a href="#11-30" class="headerlink" title="11.30"></a>11.30</h3><p>æœ€è¿‘è”è€ƒé¢˜ï¼Œè´¨é‡æ¯” XJ è‡ªå·±çš„æ¨¡æ‹Ÿèµ›å¥½å¤šäº†ï¼ï¼ï¼ï¼ˆæ„Ÿè§‰åƒé¥¿ä¹…äº†çš„å­©å­åƒåˆ°è‚‰çš„å¿ƒæƒ…</p>
<p>å¸¦æ‚”è´ªå¿ƒçœŸçš„å–µå–µ!! ,,Ô¾ã…‚Ô¾,,</p>
<p>To do list: è®¢æ­£ CF657 CDEï¼ŒAGC011Fï¼Œè®¢æ­£æ¨¡æ‹Ÿèµ›ï¼Œloj3275, loj3271, loj3281ï¼Œå“¥å“¥çš„ SRM</p>
<p>è®¢æ­£ CF657 CDEã€æ¨¡æ‹Ÿèµ›ï¼Œåšäº† AGC011F, loj3271</p>
<ul>
<li>å†™åæ‚”è´ªå¿ƒçš„æ€»ç»“ï¼Ÿä»Šå¤© T4 + é›ªç¾ä¸å¤–å–ï¼ˆæ¨¡æ‹Ÿè´¹ç”¨æµä¹Ÿå®‰æ’ä¸Šï¼‰</li>
</ul>
<h3 id="12-1"><a href="#12-1" class="headerlink" title="12.1"></a>12.1</h3><p>ä»Šå¤©å‡ ä¹ AK äº†ã€‚ã€‚é¢˜è¿˜ä¸é”™å§æˆ‘è§‰å¾—ï¼ˆï¼Ÿï¼‰T4 çº¯ç²¹æ˜¯å†™æ³•é—®é¢˜å•¦ã€‚ã€‚åœ¨çº¿çº¿æ®µæ ‘å°±æ˜¯è·‘ä¸è¿‡ç¦»çº¿æ ‘çŠ¶æ•°ç»„å˜›ï¼Œæ— è®ºä»ç©ºé—´è¿˜æ˜¯æ—¶é—´ä¸Šçœ‹ã€‚</p>
<p>To do listï¼šè®¢æ­£ T4ï¼Œloj3275, vpï¼Œå“¥å“¥çš„ SRMï¼Œbzoj3864</p>
<p>è®¢æ­£ T4ï¼Œvp CF673 EFï¼Œloj3275</p>
<h3 id="12-2"><a href="#12-2" class="headerlink" title="12.2"></a>12.2</h3><p>csp T2 é¢˜ç›®æ¼æ‰ä¸€å¥è¯ï¼Œå†™äº†ç¦»æ•£åŒ–è¢«å¡äº† 35 åˆ†ã€‚ã€‚ã€‚<strong>xml ä½ ä¸è¦å†è¯»é”™é¢˜äº†å•Šï¼</strong></p>
<p>ä¸ºäº†ä¸è¯»é”™é¢˜ï¼Œç¬¬ä¸€éå°±è¦å¾ˆè®¤çœŸå¾ˆä»”ç»†ã€‚æˆ‘è§‰å¾—æœ€å¥½çš„åŠæ³•å°±æ˜¯å¼€è€ƒé€šè¯»æ‰€æœ‰é¢˜ï¼Œè¿™æ—¶å€™å› ä¸ºè¿˜æ²¡å¼€è°ƒï¼Œå¿ƒæ€æ˜¯æ¯”è¾ƒç¨³å¥çš„ã€‚å…³äºæ•°æ®èŒƒå›´ã€æ®µæœ«æ®µä¸­çš„ç»†èŠ‚ä¹‹å¤„ï¼Œå„ç§å¥‡æ€ªçš„â€œä¿è¯â€ï¼Œåˆ‡è«å¿½è§†äº†ï¼è€Œä¸”ç¬¬ä¸€éå¦‚æœè¯»é”™ï¼Œåé¢å°±æå®¹æ˜“é™·å…¥æƒ¯æ€§æ€ç»´ï¼Œå°±æ— æ„ä¸­çŠ¯ä¸‹äº†æ¯”èµ›å¤§å¿Œã€‚</p>
<p>å…³äºä»Šå¤©çš„æ¨¡æ‹Ÿèµ›ï¼Œæ¬äº† LOJ é¦–é¡µ COCI2020 å››é“åŸé¢˜ã€‚ã€‚ã€‚T2 æœ¬è¯¥æƒ³å‡ºæ¥çš„ï¼Œæ ‘çš„é‡å¿ƒä¹Ÿæ²¡é”™ï¼Œä½†åŒä¸€ä¸ªå­æ ‘é‡Œä¹Ÿå¯ä»¥é€‰ä¸¤ä¸ªå°å­æ ‘å•Šã€‚ã€‚T3 æ ‘å½¢ dp æ²¡å†™å‡ºæ¥ï¼Œç»†èŠ‚è´¼å¤šã€‚ã€‚T4 å£èƒ¡åº”è¯¥æ˜¯å¯¹çš„ï¼Œç¬›å¡å°”æ ‘ + çº¿æ®µæ ‘ç»´æŠ¤å‡¸åŒ…ï¼ˆæˆ–ç»´æŠ¤å•è°ƒæ ˆï¼Œåº”è¯¥å·®ä¸ç¦»ï¼‰ï¼Œä½†å¥½éš¾å†™çš„æ„Ÿè§‰ = = æœ‰äº›è®¸è‡ªé—­ã€‚ã€‚ã€‚</p>
<p>ã€Œæˆ‘ä¼šå˜æˆä¸€ä¸ªæ›´å¥½çš„äººå— / ç›¸æ¯”è‡ªå·± ç›¸æ¯”æ˜¨å¤© / â€œä½ ä¼šå•Šâ€ã€</p>
<p>To do list: è®¢æ­£ T2ã€T3ã€T4ï¼Œè®¢æ­£æ˜¨å¤© vp çš„ Fï¼Œloj3280ï¼Œbzoj3864, å“¥å“¥çš„ SRMï¼Œéº»å°†</p>
<p>è®¢æ­£äº† T2ï¼ŒT3ï¼ŒT4ï¼Œæ˜¨å¤© Fï¼Œbzoj3864, loj3272</p>
<h3 id="12-3"><a href="#12-3" class="headerlink" title="12.3"></a>12.3</h3><p>ä»Šå¤© T2 æš´åŠ›æ²¡æŒ‚ï¼rush äº† T2 ä¸¤åª log åšæ³•ç»“æœ wa å¾—æ¸£éƒ½ä¸å‰© ğŸ˜ŠğŸ’¢ T1 äººç±»æ™ºæ…§é¢˜æˆ‘è®¤è¾“ï¼ˆè™½ç„¶ä¸éš¾ï¼‰ï¼ŒT3 å…¶å®ä¸éš¾æƒ³ï¼è€ƒåœºä¸Šå°±ä»¥ä¸ºåªæœ‰ LCT èƒ½åšï¼Œå®é™…ä¸ŠæŠŠæ“ä½œæ”¾åˆ°æ ‘å½¢ç»“æ„ä¸Šçœ‹å°±å¯ä»¥ç”¨æ¸…çœŸçš„å¹¶æŸ¥é›†ç»´æŠ¤ã€‚</p>
<p>æ„Ÿè§‰è‡ªå·±æœ€è¿‘æ‡‚å¾—ä¸œè¥¿å¤šä¸€äº›äº†ï¼Œå°±è€æŠŠé¢˜å¾€éš¾äº†æƒ³ï¼ˆè¿˜æ˜¯èœçš„ä¸€ç§ä½“ç°ï¼‰ï¼Œè®¸å¤šé¢˜éƒ½æœ‰æ¸…çœŸçš„ç²¾å¦™åšæ³•å•Šã€‚</p>
<p>To do list: è®¢æ­£æ¨¡æ‹Ÿèµ› T2ã€T3ï¼Œloj3280ï¼Œvpï¼Œæ¸¸å›­ä¼šï¼Œéº»å°†ï¼Œå“¥å“¥çš„ SRMï¼Œxza åœº</p>
<ul>
<li>å¥—è·¯ï¼šç®€å• dp å±•å¼€ï¼Œå¦‚ f[i] = min(f[i - 1] + 1, a[i]) å¯å±•å¼€æˆ f[r] = min(f[l - 1] + 1, a[l], a[l + 1], â€¦ a[r]) ç„¶åå°±èƒ½ä¸Šæ•°æ®ç»“æ„äº†ã€‚</li>
</ul>
<p>è®¢æ­£äº† T3ã€T2ï¼Œvp äº† CF806 Dï¼ˆE å£èƒ¡ï¼ŒF æŒ–å‘ã€‚ã€‚ï¼‰loj3280ï¼ˆå£èƒ¡ï¼‰, æ¸¸å›­ä¼šï¼ˆæˆ‘çˆ± dp å¥— dpï¼ï¼‰</p>
<h3 id="12-4"><a href="#12-4" class="headerlink" title="12.4"></a>12.4</h3><p>è€ƒå‰æœ€åä¸€å¤©ï¼å¥¥åˆ©ç»™ï¼ï¼ï¼</p>
<p>To do listï¼šè®¢æ­£ vpï¼Œéº»å°†ï¼Œå“¥å“¥çš„ SRMï¼Œxza åœºï¼Œloj3280ï¼Œloj6302ï¼Œä¸€äº›å›é¡¾ã€‚</p>
<ul>
<li>çœ‹<a href="https://www.cnblogs.com/owenyu/p/7815234.html" target="_blank" rel="noopener">è¿™ä¸ª</a></li>
</ul>
<p>æ²¡å®Œæ²¡äº†çš„è‡ªé—­ï¼Œxml ä½ çƒ¦ä¸çƒ¦å•Šä½ ï¼</p>
<p>ä»Šå¤©æ¨¡æ‹Ÿèµ›ï¼Œä¿¡å¿ƒèµ›ï¼Œå´æ¥è¿è¯»é”™ä¸¤é“é¢˜ã€‚è¦æ˜¯åœ¨æ˜å¤©çš„ NOIP è€ƒåœºä¸Šå› ä¸ºè¯»é¢˜å¤±åˆ†é‚£çœŸæ˜¯è¿½æ‚”è«åŠäº†å•Šï¼ä¸è¦è®©æœªæ¥ä¸ºäº†è‡ªå·±çš„å‚»é€¼ä¹°å•ã€‚å› ä¸ºæ˜å¤©å°±è¦æ¯”èµ›ï¼Œä»Šå¤©çš„å¿ƒæ€ä¸å¹³å’Œã€‚è¦æ˜¯è¿™æ ·åˆ°æ˜å¤©çš„èµ›åœºä¸Šå²‚ä¸æ˜¯é‡è¹ˆ CSP çš„è¦†è¾™ï¼Ÿæ²‰ç¨³ä¸‹æ¥ï¼Œä¸“æ³¨äºé¢˜ç›®ï¼Œæœ‰æ—¶é—´ä¸€å®šè¦å¯¹æ‹ã€‚</p>
<p>æ˜¯æŒ‘æˆ˜ï¼Œä¹Ÿæ˜¯æœºé‡ã€‚Hope it can bring out the best in me.</p>
<p>åšäº† éº»å°†ï¼loj6302ï¼Œloj3280, è®¢æ­£äº† vp çš„ D</p>
<p>å®šä¸€ä¸‹æ˜å¤©çš„è€ƒè¯•ç­–ç•¥ï¼šå¼€åœºè¯»é¢˜ï¼Œè®¤çœŸä»”ç»†ï¼Œpdf è§å…‰ç¬”åˆ’å‡ºå‘ç‚¹ï¼Œè€ƒè™‘æ¯é“é¢˜çš„æ—¶é—´å¸ƒå±€ï¼›æ‰“é¢˜ä»”ç»†ä¸¥è°¨ï¼Œæ³¨æ„ç©ºé—´å’Œæ¨¡æ•°ä¸ä¸º 0 ç­‰å‘ç‚¹ï¼Œå¾ˆä¹…éƒ½è°ƒè¯•ä¸å‡ºæ¥ä¸å¦‚å…ˆå¼ƒæ‰å»å†™å…¶ä»–é¢˜çš„æš´åŠ›ï¼›æœ€åæ£€æŸ¥ä¸€éæ€è·¯å’Œä»£ç å®ç°æœ‰æ— æ‰‹è¯¯ï¼Œæœ€åäº”åˆ†é’Ÿç¼–è¯‘ä¸€æ¬¡ï¼Œåˆ é™¤è°ƒè¯•è¯­å¥ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">namespace NOIP &#123;</span><br><span class="line">    struct OIer &#123;</span><br><span class="line">        int rp = inf;</span><br><span class="line">    &#125; xml;</span><br><span class="line">&#125; NOIP2020;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    while(1) NOIP2020::xml.rp++!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="12-5"><a href="#12-5" class="headerlink" title="12.5"></a>12.5</h3><p>åƒåœ¾æ„é€ æ¯æˆ‘é’æ˜¥ã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/12/05/ã€è®¡åˆ’ã€‘NOIP2020 å‰çš„åšé¢˜è®°å½•æ•´ç†/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="imily">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="imily's notes">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2020/12/05/ã€è®¡åˆ’ã€‘NOIP2020 å‰çš„åšé¢˜è®°å½•æ•´ç†/" itemprop="url">
                  NOIP2020 å‰çš„åšé¢˜è®°å½•æ•´ç†
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2020-12-05T23:58:59+08:00">
                2020-12-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>NOIP å‰ä¹Ÿåšäº†ä¸å°‘å¥½é¢˜ï¼ä½†æ˜¯ä¾ç„¶è€ƒçš„é‚£ä¹ˆå·®ã€‚ã€‚ã€‚QAQ æ¯é“é¢˜éƒ½å¾ˆå¥½ï¼ä½†å¤ªéš¾äº†éƒ½æ²¡åšå¤ªæ·±å…¥çš„æ€è€ƒ QAQã€‚ã€‚ã€‚æ‰€ä»¥æ¥ä¸‹æ¥åˆ° NOIP2021 çš„ 300 å¤šå¤©è¦å°½å¯èƒ½äº‰å–å®Œæ•´çš„åšå‡ºé¢˜ã€‚</p>
<h1 id="ç«‹ä¸‹-Flagï¼ˆå¸Œæœ›å®ƒæ°¸è¿œä¸å€’ï¼‰ï¼šæ¯å¤©éƒ½è‡ªå·±ç‹¬ç«‹åšå‡ºä¸€é“æœ‰è´¨é‡çš„é¢˜"><a href="#ç«‹ä¸‹-Flagï¼ˆå¸Œæœ›å®ƒæ°¸è¿œä¸å€’ï¼‰ï¼šæ¯å¤©éƒ½è‡ªå·±ç‹¬ç«‹åšå‡ºä¸€é“æœ‰è´¨é‡çš„é¢˜" class="headerlink" title="ç«‹ä¸‹ Flagï¼ˆå¸Œæœ›å®ƒæ°¸è¿œä¸å€’ï¼‰ï¼šæ¯å¤©éƒ½è‡ªå·±ç‹¬ç«‹åšå‡ºä¸€é“æœ‰è´¨é‡çš„é¢˜"></a>ç«‹ä¸‹ Flagï¼ˆå¸Œæœ›å®ƒæ°¸è¿œä¸å€’ï¼‰ï¼šæ¯å¤©éƒ½è‡ªå·±ç‹¬ç«‹åšå‡ºä¸€é“æœ‰è´¨é‡çš„é¢˜</h1><h3 id="ZJOI2019-éº»å°†"><a href="#ZJOI2019-éº»å°†" class="headerlink" title="$ZJOI2019-éº»å°†$"></a><a href="https://loj.ac/p/3042" target="_blank" rel="noopener">$ZJOI2019-éº»å°†$</a></h3><hr>
<p>$dp$ å¥— $dp$ å°±æ˜¯çŠ¶æ€é—´çš„è½¬ç§»ä¹Ÿæœ‰ $dp$ å…³ç³»ï¼Œ$f[i]$ è½¬ç§»åˆ° $f[j]$, $i$ å’Œ $j$ æœ‰ dp å…³ç³»ã€‚æ‰€ä»¥è¦ $dp$ é¢„å¤„ç†çŠ¶æ€å’ŒçŠ¶æ€çš„è½¬ç§»è¾¹ã€‚ï¼ˆè¿™ä¸å°±æ˜¯è‡ªåŠ¨æœºå˜›ï¼Ÿï¼‰</p>
<p>æˆ‘ä»¬éœ€è¦å¯¹å­æ•°å’Œé¢å­æ•°æ¥è¡¨ç¤ºæ‘¸å‡ºçš„ç‰Œçš„çŠ¶æ€ã€‚</p>
<p>åˆ»å­ç”¨åˆ°çš„æ˜¯åŒç§ç‰Œï¼Œæ‰€ä»¥å¯ä»¥è½¬ç§»æ—¶æšä¸¾ä¸ªæ•°ï¼Œä¸ç”¨è¡¨ç¤ºåˆ°çŠ¶æ€é‡Œå› ä¸ºå¯¹åç»­æ— å½±å“ã€‚</p>
<p>å¯¹åç»­æœ‰å½±å“çš„å°±æ˜¯é¡ºå­ã€‚<br>$f[i, 0/1, j, k]$ è¡¨ç¤ºè€ƒè™‘åˆ°ç¬¬ $i$ ç§ç‰Œï¼Œæ˜¯å¦æœ‰è¿‡å¯¹å­ï¼Œæˆ‘å†³å®šåˆ†å‡ºçš„ $(i - 1, i, i + 1)$ å‹çš„é¡ºå­ä¸ªæ•°ä¸º $j$ï¼Œæˆ‘å†³å®šåˆ†å‡ºçš„ $(i, i + 1, i + 2)$ å‹çš„é¡ºå­ä¸ªæ•°ä¸º $k$ï¼Œæ­¤æ—¶å·²ç»å‡‘å‡ºçš„æœ€å¤§é¢å­æ•°ã€‚<br>äºæ˜¯è½¬ç§»åˆ° $i + 1$ çš„æ—¶å€™ $j + k$ å¼ å’Œä¹‹å‰çš„ç»„é¡ºå­ï¼ˆæ­¤æ—¶æœ‰ $j$ ä¸ªé¢å­è¯ç”Ÿäº†ï¼‰<br>$j$, $k$ å¿…ç„¶ä¸ä¼šå¤§äº 2 å¦åˆ™å°±æ˜¯ä¸‰å¼ åˆ»å­ï¼ˆæ•°é‡ç›¸ç­‰çš„æƒ…å†µä¸‹ä¼˜å…ˆå‡‘åˆ»å­ï¼‰<br>å‘ç°ç”¨ $cnt$ï¼ˆå¯¹å­ä¸ªæ•°ï¼‰å’Œ $f[0/1, j, k]$ å°±å¯ä»¥è¡¨ç¤ºçŠ¶æ€ã€‚</p>
<p>å› ä¸ºä½ å‘ç°è¿™å°±æ˜¯ä¸ªåœ¨çŠ¶æ€é—´ä¸æ–­è½¬ç§»çš„è·³ $n$ æ­¥çš„ä¸œè¥¿ï¼Œæ‰€ä»¥å¯ä»¥å‘½åä¸ºâ€œéº»å°†è‡ªåŠ¨æœºâ€ 2333ï¼<br>è‡ªåŠ¨æœºä¸Šçš„èŠ‚ç‚¹è¡¨ç¤ºçš„çŠ¶æ€å°±æ˜¯æŠŠ $cnt$ å’Œ $[0/1, j, k]$ å‹åœ¨ä¸€å—<br>å‚ç…§åœ¨ $AC$ è‡ªåŠ¨æœºä¸Š $dp$ çš„å¥—è·¯ï¼Œæˆ‘ä»¬æ•²å®šæœ€ç»ˆ $dp$ çŠ¶æ€ï¼š$f[i, j, k]$ è¡¨ç¤ºè€ƒè™‘åˆ°ç¬¬ $i$ ç§ç‰Œï¼Œåœ¨è‡ªåŠ¨æœºä¸Šç¬¬ $j$ ä¸ªèŠ‚ç‚¹ï¼Œå…±æ‘¸äº† $k$ å¼ ç‰Œçš„æ–¹æ¡ˆæ•°</p>
<p>æ ¹æ®æœŸæœ›çš„çº¿æ€§æ€§å’Œæ•´æ•°æ¦‚ç‡å…¬å¼ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠç­”æ¡ˆæ‹†åˆ†ä¸º $P$ çš„æƒå€¼çš„æ¯ä¸ª $1$ å¯¹ç­”æ¡ˆçš„è´¡çŒ®ï¼Œå³æ¯ä¸ªæ—¶åˆ»æ²¡èƒ¡ç‰Œçš„æ–¹æ¡ˆæ•° $*$ æ¦‚ç‡ã€‚<br>é‚£ä¸ªæ–¹æ¡ˆæ•°ç›´æ¥å–è‡ªåŠ¨æœºä¸Šçš„å°±å¥½ï¼Œå› ä¸ºèƒ½å¾…åœ¨è‡ªåŠ¨æœºä¸Šçš„å°±ä¸€å®šæ²¡èƒ¡ã€‚</p>
<p>ä»”ç»†æƒ³æƒ³å¥½åƒä¹‹å‰å†™çš„ä¸¤é“ $dp$ å¥— $dp$ ä¹Ÿå¾ˆè‡ªåŠ¨æœºå•Šã€‚</p>
<p><a href="https://loj.ac/s/1005925" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="LOJ3280-é¦–éƒ½åŸå¸‚"><a href="#LOJ3280-é¦–éƒ½åŸå¸‚" class="headerlink" title="$LOJ3280-é¦–éƒ½åŸå¸‚$"></a><a href="https://loj.ac/p/3280" target="_blank" rel="noopener">$LOJ3280-é¦–éƒ½åŸå¸‚$</a></h3><hr>
<p>è€ƒè™‘é€‰é¢œè‰² a ä¼šè®©é¢œè‰² b ä¹Ÿå¿…é€‰ï¼Œä¸å¦¨ a -&gt; b è¿è¾¹ã€‚ä½†æ˜¯é¢œè‰² -&gt; é¢œè‰²è¿è¾¹ä¸å®¹æ˜“ï¼Œè€ƒè™‘è®©ç‚¹ä½œä¸ºä¸­è½¬ç«™ï¼Œé¢œè‰² -&gt; ç‚¹ (å¯ä»¥é€šè¿‡æ ‘ä¸Šå€å¢ä¼˜åŒ–å»ºå›¾) å† ç‚¹ -&gt; é¢œè‰²ã€‚</p>
<p><a href="https://loj.ac/s/1006784" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="CF673F-Bearish-Fanpages"><a href="#CF673F-Bearish-Fanpages" class="headerlink" title="$CF673F-Bearish Fanpages$"></a><a href="https://www.luogu.com.cn/problem/CF643D" target="_blank" rel="noopener">$CF673F-Bearish Fanpages$</a></h3><hr>
<p><del>å˜Ÿå˜Ÿ</del>è¯»æ‡‚é¢˜æ„ä½ å°±ä¼šå‘ç°è¿™æ˜¯é“æ¨¡æ‹Ÿé¢˜ã€‚å› ä¸ºæ ¹æ®è€å¥—è·¯ï¼Œä¿®æ”¹åªè¦æ”¹å¯¹çˆ¶äº²çš„ï¼Œçˆ¶äº²å¯¹å„¿å­çš„æŸ¥è¯¢æ—¶åŠ ä¸Šã€‚ï¼ˆæ‰€ä»¥å®ƒä¸ºä»€ä¹ˆé»‘äº†å•Šï¼Ÿ</p>
<p>è¿™é¢˜å·¨çƒ¦å¥¥ï¼ä¸€ä¸ªç‚¹çš„åº¦æ•°å½±å“å®ƒçš„å„¿å­ï¼Œå®ƒçš„çˆ¶äº²ï¼Œå®ƒè‡ªå·±</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">x -&gt; f -&gt; ff -&gt; fff</span><br><span class="line">    son   son   son</span><br><span class="line">    val   val</span><br><span class="line">    deg</span><br><span class="line">ï¼ˆä¸‹é¢æ˜¯å½±å“çš„ä¸œè¥¿ï¼‰</span><br></pre></td></tr></table></figure>
<p>ä½†æ˜¯æ€ä¹ˆå¤„ç†çˆ¶äº²åº¦æ•°å˜äº†ï¼Œå„¿å­åœ¨å…¨å±€ set é‡Œçš„å˜åŒ–å‘¢ï¼Ÿæˆ‘ä»¬å¯¹æ¯ä¸ªç‚¹å¼€ä¸€ä¸ª setï¼Œç»´æŠ¤å…¶å„¿å­é›†åˆçš„æœ€å¤§æœ€å°æƒå€¼ã€‚æ‰€ä»¥å…¨å±€ set å…¶å®è£…çš„å°±æ˜¯æ¯ä¸ª set çš„æœ€å¤§æœ€å°æƒå€¼ã€‚</p>
<p><a href="http://codeforces.com/contest/643/submission/100179942" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="CF806D-Perishable-Roads"><a href="#CF806D-Perishable-Roads" class="headerlink" title="$CF806D-Perishable Roads$"></a><a href="https://www.luogu.com.cn/problem/CF773D" target="_blank" rel="noopener">$CF806D-Perishable Roads$</a></h3><hr>
<p>é¦–å…ˆä¼šæƒ³åˆ°è´ªå¿ƒçš„æŠŠç‚¹éƒ½æŒ‚åˆ°æœ€çŸ­è¾¹çš„ä¸€ç«¯ï¼Œåƒä¸ªæ‰«å¸šã€‚ä½†è¿™æ˜¯æœ‰é—®é¢˜çš„ï¼šå¦‚æœæœ€çŸ­è¾¹ä¸æ ¹ä¸ç›´æ¥ç›¸è¿ï¼Œæœ‰äº›ç‚¹å°±å¤„äºæ ¹åˆ°æœ€çŸ­è¾¹çš„è·¯å¾„ä¸Šï¼Œæ²¡æ³•æŒ‚è¿‡å»ã€‚</p>
<p>å°†é™¤äº†æœ€çŸ­è¾¹å¤–çš„æ‰€æœ‰è¾¹æƒå€¼å‡å»æœ€çŸ­è¾¹æƒå€¼ï¼Œè·‘æ ¹åˆ°æœ€çŸ­è¾¹çš„æœ€çŸ­è·¯å°±å¥½ã€‚</p>
<h3 id="LOJ3385-Svjetlo"><a href="#LOJ3385-Svjetlo" class="headerlink" title="$LOJ3385-Svjetlo$"></a><a href="https://loj.ac/p/3385" target="_blank" rel="noopener">$LOJ3385-Svjetlo$</a></h3><hr>
<p>è¢«å‡ºåˆ°æ¨¡æ‹Ÿèµ›é‡Œäº†ã€‚è€ƒåœºä¸Šæˆ‘çš„ dp çŠ¶æ€æ˜¯ $f[x, 0/1, 0/1]$ è¡¨ç¤º $x$ å›ä¸å›æ¥ï¼Œ$x$ å½“å‰çš„é¢œè‰²ã€‚ç„¶è€Œå·¨éš¾å†™ï¼ï¼ˆè€Œä¸”è¿˜æ˜¯é”™çš„ã€‚æ­£è§£ $f[x, 0/1/2, 0/1]$ è¡¨ç¤º x å­æ ‘å†…çš„è·¯å¾„æ¥å£çŠ¶æ€å’Œ x å½“å‰çš„é¢œè‰²ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f çš„å®šä¹‰æ˜¯ åŒ…æ‹¬èµ·å§‹ç‚¹ï¼Œä¹ŸåŒ…æ‹¬ç»ˆç‚¹ã€‚</span><br><span class="line">0: â¬‡ï¸â¬†ï¸  1: â¬†ï¸æˆ–â¬‡ï¸  2: â¬†ï¸â¬‡ï¸</span><br></pre></td></tr></table></figure></p>
<p>è¿™ç§çŠ¶æ€è®¾è®¡æ˜¯æ€ä¹ˆæƒ³åˆ°çš„å‘¢ï¼Ÿ<br>ä¸€æ¡è·¯å¾„ï¼Œç”±ï¼šâ¬†ï¸ / â¬‡ï¸â¬†ï¸ / â¬‡ï¸ ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå…¶ä¸­ä¸€å’Œä¸‰éƒ½æœ€å¤šåªæœ‰ä¸€ä¸ªï¼›ä¸ºäº†æ–¹ä¾¿è®¨è®ºï¼Œæˆ‘ä»¬è§„å®šå•ä¸ªç‚¹ä¹Ÿå¯ä»¥çœ‹ä½œ â¬†ï¸ æˆ– â¬‡ï¸ã€‚dp å°±å¯ä»¥åƒèƒŒåŒ…ä¸€æ ·åšäº†ã€‚</p>
<p><a href="https://loj.ac/s/1003823" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="LOJ3370-Histogram"><a href="#LOJ3370-Histogram" class="headerlink" title="$LOJ3370-Histogram$"></a><a href="https://loj.ac/p/3370" target="_blank" rel="noopener">$LOJ3370-Histogram$</a></h3><hr>
<p>è¿˜æ˜¯æ¨¡æ‹Ÿèµ›é¢˜ QAQï¼ˆå£èƒ¡å·®ç‚¹æ­£ç¡®ï¼è€¶ï¼</p>
<p>æˆ‘å£èƒ¡çš„æ˜¯æŒ‰ $a$ é™åºåˆ†æ²»ï¼ˆå°±æ˜¯ç¬›å¡å°”æ ‘ï¼‰ï¼Œæ¯ä¸ªå—ç”¨ä¸¤ä¸ªçº¿æ®µæ ‘ç»´æŠ¤ä¸¤ä¸ªå•è°ƒæ ˆç„¶åä¸Šçº¿æ®µæ ‘åˆå¹¶ï¼Œä½†é‚£æ ·å¥½åƒæœ‰äº¿ç‚¹è›‹ç–¼ï¼ˆå› ä¸ºç¬›å¡å°”æ ‘åˆ†æ²» $n$ æ¬¡ï¼Œå•æ¬¡æŸ¥è¯¢ &amp; åˆå¹¶åªèƒ½æ˜¯ $log$ çº§åˆ«çš„</p>
<p>æ­£è§£å°±æ˜¯ç®€å•ç²—æš´ï¼Œæ¯æ¬¡æŠŠåŒºé—´åˆ’ä¸¤åŠçš„åˆ†æ²»ï¼Œè®¡ç®—è·¨ä¸­ç‚¹çš„åŒºé—´è´¡çŒ®ã€‚</p>
<p>è®¨è®º $a$ å’Œ $b$ æœ€å°å€¼åŒåœ¨ä¸€è¾¹å’Œä¸åœ¨ä¸€è¾¹ä¸¤ç§æƒ…å†µã€‚åŒåœ¨ä¸€è¾¹æ˜¯æœ‰å•è°ƒæ€§çš„ï¼Œç›´æ¥åŒæŒ‡é’ˆã€‚ä¸åœ¨ä¸€è¾¹çš„è¯å°±è¦éº»çƒ¦ä¸€äº›ï¼šè€ƒè™‘ $b$ æœ€å°å€¼åœ¨å·¦è¾¹ï¼Œç°åœ¨è¦åœ¨å³è¾¹æ‰¾ä¸€ä¸ª $a$ æœ€å°å€¼ã€‚</p>
<p>è®¾ $r_1$ æ¯” $r_2$ ä¼˜ï¼Œåˆ™ $a[r_1] <em> b </em> (r_1 - l + 1) \geq a[r_2] <em> b </em> (r_2 - l + 1)$<br>åŒ–æˆæ–œç‡ä¼˜åŒ–çš„æŸ¿å­å°±æ˜¯ $(a[r_2] <em> (r_2 + 1) - a[r_1] </em> (r_1 + 1)) / (a[r_2] - a[r_1]) \geq l$ï¼Œè€Œ $l$ å•è°ƒé€’å‡ã€‚</p>
<p>çº¿æ®µæ ‘ç»´æŠ¤å‡¸åŒ…å°±å¯ä»¥æ”¯æŒåŒºé—´æŸ¥è¯¢å•¦ï¼$O(n log^2 n)$ å› ä¸ºæœ‰ $logn$ ä¸ªåŒºé—´ï¼Œæ¯ä¸ªåŒºé—´è¦ $logn$ å‡¸åŒ…æŸ¥è¯¢</p>
<p><a href="https://loj.ac/s/1004609" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="JOI2020-æ±‰å ¡è‚‰"><a href="#JOI2020-æ±‰å ¡è‚‰" class="headerlink" title="$JOI2020-æ±‰å ¡è‚‰$"></a><a href="https://loj.ac/p/3272" target="_blank" rel="noopener">$JOI2020-æ±‰å ¡è‚‰$</a></h3><hr>
<p>å¾ˆå¦™å•Šï¼ï¼ˆ$K \geq 4$ å°±æ˜¯äººç±»æ™ºæ…§é¢˜</p>
<p>é¦–å…ˆå››ä¸ªç­¾åªä¼šå‡ºç°åœ¨å››æ¡çº¿ä¸Šï¼š$max(L)$, $min(R)$, $max(D)$, $min(U)$ã€‚</p>
<p>è¯æ˜ï¼š</p>
<ol>
<li>$max(L) \leq min(R)$, $max(D) \leq min(U)$ï¼Œåªè¦å¾€å›´æˆçš„çŸ©å½¢é‡Œæ’ä¸€æ ¹ç­¾</li>
<li>$max(L) &gt; min(R)$, $max(D) \leq min(U)$ï¼Œ$max(L)$ å³è¾¹å¿…ç„¶æœ‰ç­¾ï¼Œ$min(R)$ å·¦è¾¹å¿…ç„¶æœ‰ç­¾ï¼Œå¹¶ä¸”ä¸¤è¾¹çš„ç­¾é€šè¿‡å¹³ç§»éƒ½å¯ä»¥ç§»åŠ¨åˆ°ä¸¤æ¡çº¿ä¸Šã€‚å¦ä¸€ç§ç›¸åæƒ…å†µä¹Ÿå¦‚æ­¤ã€‚</li>
<li>$max(L) &gt; min(R)$, $max(D) &gt; min(U)$ï¼Œé“ç†åŒä¸Šã€‚</li>
</ol>
<p>è¯æ¯•ã€‚</p>
<p>$max$ å’Œ $min$ éå¸¸å¥½ï¼Œä¸ºä»€ä¹ˆï¼Ÿä»¥ $max(L)$ ä¸ºä¾‹åˆ†æï¼Œé¦–å…ˆå®ƒå³è¾¹å¿…å®šè¦æœ‰ç­¾ï¼Œåœ¨æœ‰ç­¾çš„æƒ…å†µä¸‹è¿™ç­¾å°½é‡å·¦åˆæ˜¯æœ€ä¼˜çš„ï¼Œè€Œç«–ç›´æ–¹å‘å¯¹å®ƒæ— å½±å“å› ä¸ºå·²ç»æ˜¯ $max$ äº†ã€‚</p>
<p>$K \leq 3$ æ ¹æ®æŠ½å±‰åŸç†å°±ä¸€å®šæœ‰ç­¾å‡ºç°åœ¨äº¤ç‚¹ä¸Šäº†ã€‚æœ‰ç­¾åœ¨äº¤ç‚¹ä¸Šçš„æƒ…å†µå¯ä»¥ç›´æ¥æš´æœå‡ºè§£ï¼ˆæ¯æ¬¡é€‰äº¤ç‚¹ï¼Œåˆ æ‰è¦†ç›–åˆ°çš„çŸ©å½¢ï¼Œå‰©ä¸‹çš„ç»§ç»­é€’å½’é€‰äº¤ç‚¹ï¼‰ã€‚å‰©ä¸‹å°±æ˜¯ç­¾éƒ½åœ¨çº¿æ®µä¸Šçš„æƒ…å†µã€‚</p>
<p>é¦–å…ˆæŸå—æ±‰å ¡è‚‰å¦‚æœç›¸é‚»ä¸‰è¾¹éƒ½æ˜¯ä»¥ä¸Šé‚£å››ç§çº¿æ®µä¹‹ä¸€ï¼ˆå³åŒ…å«äº†ä¸€æ•´æ¡è¾¹ï¼‰ï¼Œå®ƒå¿…å®šæ’ç­¾ï¼Œå¯ä»¥ä¸ç”¨è€ƒè™‘ï¼›å¦åˆ™ç¦»æ•£åŒ–ï¼ˆä¸ç”¨çœŸçš„ç¦»æ•£åŒ–ï¼‰çŸ©å½¢è¾¹åæ ‡ï¼Œå¯¹æ¯æ¡è¾¹å¯ä»¥å•ç‹¬åšå‰åç¼€è¿è¾¹çš„ $2-SAT$ã€‚</p>
<p>ä¸¥è°¨åœ°è¯´ï¼Œè¦åˆ¤æ— è§£ï¼Œä½†æ˜¯æœ¬é¢˜ä¿è¯æœ‰è§£ qwq</p>
<p>ç„¶åè¿™é¢˜éšæœºåŒ–ä¹Ÿèƒ½è‰¹è¿‡å»ï¼Œå¥½åƒæ˜¯ä»€ä¹ˆåˆ† $K$ ç±»ï¼Œæ¯ç±»ç®—çŸ©å½¢å¹¶ï¼Œè®©çŸ©å½¢å¹¶æœ€å¤§</p>
<p><a href="https://loj.ac/s/1002813" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="JOI2020-å»ºç­‘è£…é¥°4"><a href="#JOI2020-å»ºç­‘è£…é¥°4" class="headerlink" title="$JOI2020-å»ºç­‘è£…é¥°4$"></a><a href="https://loj.ac/p/3271" target="_blank" rel="noopener">$JOI2020-å»ºç­‘è£…é¥°4$</a></h3><hr>
<p>$n^2$ dp è¿˜æ˜¯å¾ˆå¥½æƒ³çš„ã€‚$dp[i, 0/1, j]$ è¡¨ç¤ºåˆ° $i$ï¼Œç¬¬ $i$ ä½æ˜¯å¦ä¸º $A$ï¼Œé€‰äº† $j$ ä¸ª $A$ çš„å€¼ï¼Œåªä¸º $1$ æˆ– $0$ã€‚æœ‰ä¸€ç§åšæ³•æ˜¯ï¼ˆçŒœï¼‰ç»“è®ºï¼š$dp[i, 0/1]$ å€¼ä¸º $1$ çš„æ˜¯ä¸€æ®µåŒºé—´ã€‚å½’çº³å¯è¯ï¼Ÿä½†æ˜¯è¿™å°±æ²¡æ„æ€äº†å•Š qwq</p>
<p>è€ƒè™‘å…¶ä»–åšæ³•ã€‚ä¸å¦¨äº¤æ¢çŠ¶æ€ä¸å€¼ï¼š$dp[i, 0/1, 0/1]$ è¡¨ç¤ºåˆ° $i$ï¼Œç¬¬ $i$ ä½æ˜¯å¦ä¸º $A$ï¼Œ$A$/$B$ çš„æœ€å¤šä¸ªæ•°èƒ½æ˜¯å¤šå°‘ã€‚å®¹æ˜“è®°å½•è·¯å¾„ã€‚è¾“å‡ºæ–¹æ¡ˆæ—¶ä»åå¾€å‰ã€‚</p>
<p><a href="https://loj.ac/s/1001454" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="JOI2020-æœ‰è¶£çš„-Joitter-äº¤å‹"><a href="#JOI2020-æœ‰è¶£çš„-Joitter-äº¤å‹" class="headerlink" title="$JOI2020-æœ‰è¶£çš„ Joitter äº¤å‹$"></a><a href="https://loj.ac/p/3275" target="_blank" rel="noopener">$JOI2020-æœ‰è¶£çš„ Joitter äº¤å‹$</a></h3><hr>
<p>æœ€å¤§å€¼æ˜¯å”¬ä½ çš„ï¼Œå°±æ˜¯èƒ½å…³æ³¨åˆ™å…³æ³¨ã€‚è€ƒè™‘ä¸€ä¸ªå…³æ³¨äº‹ä»¶ä¼šæœ‰ä»€ä¹ˆâ€œå‰¯äº§å“â€ï¼šæ‰€æœ‰å’Œ $B$ ç”¨æˆ·äº’ç›¸å…³æ³¨çš„ $C$ éƒ½ä¼šè¢« $A$ å…³æ³¨ã€‚è¿™äº’ç›¸å…³æ³¨çš„å…³ç³»å…·æœ‰ä¼ é€’æ€§ï¼Œå…³æ³¨å…³ä¸€å›¢ï¼Œå¯å‘æˆ‘ä»¬æŠŠæœ‰åŒå‘è¾¹çš„ç‚¹å¯¹ç¼©ç‚¹ã€‚å‘ç°ç­”æ¡ˆç­‰äº $\sum_S sz(S)(sz(S) - 1) + sz(S)in_deg(S)$</p>
<p>ç°åœ¨è¦åˆå¹¶ä¸¤ä¸ªå›¢ï¼Œè¦ç»´æŠ¤ $sz(sz - 1)$ å’Œ $sz * in_deg$ çš„å˜åŒ–ï¼Œè¿˜è¦åˆå¹¶ $in$ å’Œ $out$ çš„ç‚¹å¯¹ã€‚ç”¨å¯å‘å¼åˆå¹¶ + set å­˜å…¥è¾¹å‡ºè¾¹ + å¹¶æŸ¥é›†ï¼ˆåˆå¹¶çš„æ—¶å€™æŠŠä¿¡æ¯éƒ½æ‹¢åˆ°æ ¹ä¸Šï¼Œå¹¶æŸ¥é›†å¸®åŠ©æ‰¾æ ¹ï¼‰å¯ä»¥åšåˆ° $O(nlog^2n)$ï¼</p>
<p>è¿˜æœ‰ä¸€ä¸ªç»†èŠ‚ï¼Œåˆå¹¶å¯èƒ½é€ æˆè¿é”ååº”ï¼Œé‚£ä¹ˆå¯¹äºæ–°çš„è¦åˆå¹¶çš„ç‚¹å¯¹é€’å½’å¤„ç†å°±å¥½ã€‚</p>
<p><a href="https://loj.ac/s/1002124" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="JOI2020-é—è¿¹"><a href="#JOI2020-é—è¿¹" class="headerlink" title="$JOI2020-é—è¿¹$"></a><a href="https://loj.ac/p/3276" target="_blank" rel="noopener">$JOI2020-é—è¿¹$</a></h3><hr>
<p><a href="https://blog.csdn.net/qq_39972971/article/details/105074251" target="_blank" rel="noopener">CCCOrz</a></p>
<p><a href="https://blog.csdn.net/jokerwyt/article/details/105116540" target="_blank" rel="noopener">CCCOrz</a></p>
<p>å¾ˆå¦™çš„é¢˜ï¼æ²¡æœ‰æ€è·¯ï¼Œä¸€å®šå…ˆå‰–æè¿™ä¸ªæ“ä½œçš„åŸç†ï¼šæ€ä¹ˆæ‰¾é•¿åº¦ä¸º $2N$ çš„åºåˆ—çš„ç»“æœåºåˆ—ã€‚</p>
<p>å‘ç°å…¶ä¸­ä¸€ç§æ–¹æ³•æ˜¯ä»åå¾€å‰ï¼Œå¯¹äºæ¯ä¸ª $a[i]$ å¦‚æœ $\leq a[i]$ æœ‰ç©ºç€çš„ä½ç½®å°±é€‰ $i$ å¹¶ä¸”å¡«ä¸Šç©ºä½ã€‚å‘ç°è¿™ç§æ–¹æ³•å¾ˆåˆ©äº $dp$ã€‚æœ‰ä¸ª $simple$ çš„æƒ³æ³•æ˜¯ $O(n2^n)$ çš„çŠ¶å‹ï¼Œ$dp[i, S]$ è¡¨ç¤º $i$ ~ $2N$ é€‰çš„ä½å¡«çš„é›†åˆæ˜¯ $S$<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ä¸é€‰ï¼šç³»æ•°ä¸º j - [å·²å¡«çš„ä½ç½®æ•°]</span><br><span class="line">è¦é€‰ï¼šf[i, j] = f[i + 1, j]</span><br><span class="line">     f[i, j + k] = f[i + 1, j] * C([i ~ 2N è¦é€‰çš„ä½ç½®æ•°] - j, k - 1) * (k + 1) * g[k - 1, k - 1] * fac[k - 1]</span><br><span class="line">     ï¼ˆä¸ä¸ 1 ç›¸è¿çš„ è´¡çŒ®å¯ä»¥ä¹‹åç®— â€”â€” è¿™æ­¥å®åœ¨å¤ªå¦™äº†ï¼Œé¿å…äº†è®°å½•çŠ¶æ€ï¼‰</span><br><span class="line">    å…¶ä¸­ g[i, j] è¡¨ç¤º j ä¸ªå…³é”®ä½å¡«äº† &lt;= i çš„æ•°ï¼Œdp é¢„å¤„ç†çš„æ—¶å€™è¦æ»¡è¶³ [1, i] å†…çš„ä¸ªæ•° &lt;= i</span><br></pre></td></tr></table></figure></p>
<p>æœ€åé™¤ä»¥ $2^n$ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ä¸€å¼€å§‹å°±å†³å®šä¸ºäº†æ–¹ä¾¿ï¼ŒæŠŠä¸¤ä¸ªç›¸åŒçš„æ•°ä¹Ÿçœ‹ä½œæœ‰æ ‡å·çš„ã€‚</p>
<p>è¿™é¢˜çš„æŸä¸ªéš¾ç‚¹åœ¨äºâ€œè™šå®ç»“åˆâ€ï¼Œå®é™…å¡«çš„æ•°åœ¨æœ€åå¯¹åº”çš„æ˜¯å¦ä¸€ä¸ªæ•°</p>
<p><a href="https://loj.ac/s/999539" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="JOI2020-æ˜Ÿåº§-3"><a href="#JOI2020-æ˜Ÿåº§-3" class="headerlink" title="$JOI2020-æ˜Ÿåº§ 3$"></a><a href="https://loj.ac/p/3277" target="_blank" rel="noopener">$JOI2020-æ˜Ÿåº§ 3$</a></h3><hr>
<p>å¤§å£°å–Šå‡ºæ¥ï¼šç½‘ æ ¼ å›¾ çš„ å¥— è·¯ æ˜¯ ä»€ ä¹ˆï¼Ÿâ€”â€”ç¬›â€”â€”å¡â€”â€”å°”â€”â€”æ ‘</p>
<p>ï¼ˆå¤§é›¾</p>
<p>æ¯æ¬¡ä»æœ€å¤§çš„ä½ç½® $x$ pia å¼€ï¼Œæ˜Ÿç©ºè¢«åˆ†æˆä¸‰éƒ¨åˆ†ï¼šå·¦ï¼Œ$x$ å¤´é¡¶çš„ï¼Œå³</p>
<p>$dp[x, i]$ è¡¨ç¤ºç¬›å¡å°”æ ‘ç¬¬ $x$ ä¸ªèŠ‚ç‚¹æœ€å¤§çš„ä½ç½®å¤´ä¸Šæœ€é«˜çš„æ˜Ÿæ˜Ÿé«˜åº¦ä¸º $i$ã€‚åˆå¹¶çš„æ—¶å€™ä¸‰éƒ¨åˆ†åªèƒ½æœ‰æœ€å¤šä¸€é¢—æ˜Ÿæ˜Ÿæ¯”æœ€å¤§ä½ç½®é«˜ã€‚ç”¨ $pair$ï¼ˆæœ€é«˜æ˜Ÿæ˜Ÿé«˜åº¦ + $dp$ å€¼ï¼‰+ $set$ å¯ä»¥è½»æ¾å®ç°ï¼Œå¯å‘å¼åˆå¹¶ $O(n log^2 n)$</p>
<p><a href="https://loj.ac/s/1000065" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="JOI2020-æ”¶è·"><a href="#JOI2020-æ”¶è·" class="headerlink" title="$JOI2020-æ”¶è·$"></a><a href="https://loj.ac/p/3278" target="_blank" rel="noopener">$JOI2020-æ”¶è·$</a></h3><hr>
<p>æ¶å¿ƒ &amp; æœ‰æ„æ€çš„é¢˜ã€‚</p>
<p>å‘˜å·¥æ˜¯ä¸å®šçš„ï¼Œè€Œè‹¹æœæˆç†Ÿçš„æ—¶é—´éƒ½ç›¸åŒï¼Œå› ä¸ºè¯¢é—®çš„æ˜¯äººï¼Œè€ƒè™‘äººä¸åŠ¨ï¼Œè‹¹æœåŠ¨ï¼Œä¹Ÿè®¸ä¼šæœ‰ä¸€äº›ç»å¦™çš„å‘ç°ã€‚ä»è‹¹æœå‘ç¬¬ä¸€ä¸ªé‡‡æ‘˜å®ƒçš„å‘˜å·¥ 1 è¿è¾¹ï¼Œå†ä»å‘˜å·¥ 1 å‘ç¬¬äºŒä¸ªé‡‡æ‘˜å®ƒçš„å‘˜å·¥ 2 è¿è¾¹â€¦ æ¯ä¸ªå‘˜å·¥éƒ½æœ‰ä¸€ä¸ªå‡ºè¾¹ï¼Œå½¢æˆäº†åŸºç¯å†…å‘æ ‘æ£®æ—ã€‚åˆ†åˆ«å¯¹æ¯æ£µåŸºç¯å†…å‘æ ‘ç»Ÿè®¡ç­”æ¡ˆã€‚æŠŠè¯¢é—®ç¦»çº¿ä¸‹æ¥æ”¾åœ¨èŠ‚ç‚¹ä¸Šã€‚</p>
<p>ä¸€ä¸ªè‹¹æœçš„è´¡çŒ®æ€ä¹ˆç®—ï¼Ÿå…ˆæ–­ç¯æˆé“¾ï¼Œæœ‰ä¸¤ç§æƒ…å†µï¼š</p>
<ol>
<li>è‹¹æœåˆ°è¯¥ç‚¹æ²¡æœ‰ç»è¿‡æ–­è¾¹</li>
<li>ç»è¿‡äº†æ–­è¾¹</li>
</ol>
<p>ç¬¬ä¸€ç§æƒ…å†µå°±åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ï¼ˆä¸‹æ ‡ä¸ºæ—¶é—´ï¼‰ï¼Œç¬¬äºŒç§å¯ä»¥åŒ–æˆä¸‹å–æ•´æŸ¿å­ç„¶åç»´æŠ¤ä½™æ•°ã€‚ä¸€ä¸ªå­æ ‘çš„è´¡çŒ®å¯ä»¥è¿›å»å’Œå‡ºå»æ—¶åšå·®å¾—åˆ°ã€‚</p>
<p><a href="https://loj.ac/s/1000206" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="CF436E"><a href="#CF436E" class="headerlink" title="$CF436E$"></a><a href="https://www.luogu.com.cn/problem/CF436E" target="_blank" rel="noopener">$CF436E$</a></h3><hr>
<p>å‡ºåˆ°æ¨¡æ‹Ÿèµ›é‡Œï¼Œæ¯”èµ›æ—¶å°±çŸ¥é“è‚¯å®šæ˜¯åæ‚”è´ªå¿ƒäº†ï¼Œä½†æˆ‘å°±æ˜¯ä¸ä¼šã€‚ã€‚</p>
<p>åæ‚”è´ªå¿ƒå…ˆå›ºå®šä¸€ç§é¡ºåºï¼Œä¸€èˆ¬æ˜¯ä¸ªæ•°æ¯æ¬¡åŠ ä¸€ï¼Œç„¶åæ¯æ­¥è¦ä¹ˆé€‰æ‹©ï¼Œè¦ä¹ˆåæ‚”ã€‚ä¸€èˆ¬ç”¨å †æ¥ç»´æŠ¤å†³ç­–é›†åˆã€‚ï¼ˆä¸ºä»€ä¹ˆç”¨å †å°±ä¸ç”¨è¯´äº†å§ï¼Ÿï¼ï¼‰</p>
<p>æœ¬é¢˜å…±æœ‰å››ç§å†³ç­–ï¼š</p>
<ul>
<li>é€‰æ‹©<ol>
<li>é€‰ä¸€ä¸ªæ–°çš„ $i$, $a_i$</li>
<li>ä»é€‰äº†ä¸€ä¸ªçš„ $i$ é‡Œå†é€‰ä¸€ä¸ª, $b_i - a_i$</li>
</ol>
</li>
<li>åæ‚”<ol>
<li>å»æ‰åªé€‰äº†ä¸€ä¸ªçš„ $i$ï¼Œå†é€‰ä¸¤ä¸ª $j$ï¼Œ$b_j - a_i$</li>
<li>å»æ‰é€‰äº†ä¸¤ä¸ªçš„ $i$ çš„ç¬¬äºŒä¸ªï¼Œå†é€‰ä¸¤ä¸ª $j$ï¼Œ$b_j - (b_i - a_i)$<br>ç”¨å››ä¸ªå †åˆ†åˆ«ç»´æŠ¤è¿™å››ç§å†³ç­–ã€‚</li>
</ol>
</li>
</ul>
<p>è¿™é¢˜æœ‰å¥½å¤šç§ä¹±æåšæ³•ã€‚<br>æ¯”å¦‚ $dst$ çš„ï¼š<br>æŒ‰ç…§ $a_i$ å’Œ $b_i - a_i$ çš„å¤§å°å…³ç³»åˆ†ç±»<br>$a_i \leq b_i - a_i$ æ²¡æœ‰ä¾èµ–å…³ç³»ï¼Œå¯ä»¥å•ç‹¬è€ƒè™‘ï¼›<br>ä½†æ˜¯ $a_i &gt; b_i - a_i$ çš„å°±è¦æ†ç»‘äº†<br>æœ€åå¯èƒ½ä¼šæœ‰å‰©ä¸€ä¸ªç©ºçš„æƒ…å†µï¼Œé‚£ä¹ˆæšä¸¾ + åˆ†è®¨å°±å¥½äº†ï¼Ÿ</p>
<h3 id="WC2008-æ¸¸è§ˆè®¡åˆ’"><a href="#WC2008-æ¸¸è§ˆè®¡åˆ’" class="headerlink" title="$WC2008-æ¸¸è§ˆè®¡åˆ’$"></a><a href="https://www.luogu.com.cn/problem/P4294" target="_blank" rel="noopener">$WC2008-æ¸¸è§ˆè®¡åˆ’$</a></h3><hr>
<p>ä¸€çœ¼æœ€å°ç”Ÿæˆæ ‘ã€‚ä½†æ˜¯ä¸Šæ–¹æ ¼å›¾äº†ï¼Ÿï¼Ÿï¼Ÿ</p>
<p>æ–¯å¦çº³æ ‘ï¼Œä¸€ç§ å¥‡ å½¢ æ€ª çŠ¶ çš„çŠ¶å‹æœ€å°ç”Ÿæˆæ ‘ç®—æ³•ã€‚</p>
<p>$dp[i, S]$ è¡¨ç¤ºä¸²èµ·äº† $S$ é›†åˆçš„ç‚¹ï¼Œæ ¹ä¸º $i$ã€‚ä¸¤ç§è½¬ç§»ï¼š</p>
<ol>
<li>æ¯æ¬¡å°±æŠŠä¸€ä¸ªé›†åˆå¾€æ ¹ä¸Šå¹¶å°±å¥½: $dp[i, S | Sâ€™] = min{ dp[i, S] + dp[i, Sâ€™] - val[i] }$</li>
<li>æ¢æ ¹å°±ä¸€æ­¥ä¸€æ­¥å¾€èº«è¾¹çš„èŠ‚ç‚¹æ¢: $dp[i, S] = min{ dp[j, S] + val[i], (i, j) \in E }$</li>
</ol>
<p>å‘ç°ç¬¬ä¸€ä¸ªè½¬ç§»æŒ‰ç§©ï¼Œç¬¬äºŒä¸ªè½¬ç§»æ— æ˜æ˜¾é¡ºåºï¼Œå¹²è„†å¥—ä¸ª $spfa$ï¼Œå°±åšå®Œäº†ã€‚ä»¥ $s$ ä¸ºåˆ’åˆ†é˜¶æ®µã€‚</p>
<p>è¿™æ˜¯æ–¯å¦çº³æ ‘çš„å¸¸è§„å¥—è·¯ã€‚</p>
<h3 id="THUSCH2017-å·§å…‹åŠ›"><a href="#THUSCH2017-å·§å…‹åŠ›" class="headerlink" title="$THUSCH2017-å·§å…‹åŠ›$"></a><a href="https://loj.ac/p/2977" target="_blank" rel="noopener">$THUSCH2017-å·§å…‹åŠ›$</a></h3><p>å¾ˆå¥½çš„ <del>éš æœº åŒ–</del> æ–¯å¦çº³æ ‘é¢˜ã€‚é¦–å…ˆå¦‚æœ $C$ å¾ˆå°çš„è¯æ€ä¹ˆåšï¼Ÿæˆ‘ä»¬å¯ä»¥äºŒåˆ†ä¸­ä½æ•°ï¼ˆå˜æƒå€¼ä¸º $0$/$1$ï¼‰ + çŠ¶å‹è·‘æ–¯å¦çº³æ ‘ã€‚ä½†æ˜¯æˆ‘ä»¬é¦–è¦çš„æ˜¯é€‰çš„å—æ•°å°½é‡å°‘ï¼Œæ¬¡è¦çš„æ˜¯é€‰çš„ $0$ å°½é‡å¤šï¼Œæ€ä¹ˆ $dp$ï¼Ÿ<strong>è¿™é‡Œæœ‰ä¸ªè¶…å¥½çš„ Trickï¼šæŠŠ $0$ èµ‹ä¸º $inf - 1$ï¼ŒæŠŠ $1$ èµ‹ä¸º $inf + 1$ï¼Œå—æ•°å°±æ˜¯ $\lfloor \frac{val + 300}{1000} \rfloor$</strong></p>
<p>ä½†æ˜¯ $C$ å¤§è€Œ $K$ å°ã€‚äºæ˜¯æƒ³åˆ°æŠŠ $C$ ç§é¢œè‰²éšæœºåˆ†ä¸º $K$ ç±»è·‘çŠ¶å‹ã€‚æ­£ç¡®ç‡æ˜¯ $\frac{k!}{k^k}$ï¼Œçº¦ç­‰äº $0.0384$, è·‘ä¸ªå‡ ç™¾æ¬¡å°±æ²¡é—®é¢˜äº†ã€‚</p>
<p><a href="https://loj.ac/s/991228" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="HNOI2013-ä¸æˆ–é"><a href="#HNOI2013-ä¸æˆ–é" class="headerlink" title="$HNOI2013-ä¸æˆ–é$"></a><a href="https://www.luogu.com.cn/problem/P3220" target="_blank" rel="noopener">$HNOI2013-ä¸æˆ–é$</a></h3><hr>
<p>ï¼ˆåŸæ¥ä¸éï¼ˆ$nand$ï¼‰æ˜¯çœŸçš„å­˜åœ¨å•Šï¼Œï¼Œä¸æ˜¯ä¸ºé¢˜è€Œç¼–å‡ºæ¥çš„ï¼Œï¼Œï¼‰</p>
<p>è¿™æ˜¯ä¸ªå¾ˆå¼ºå¤§çš„è¿ç®—ï¼Œ$and$ã€$or$ã€$xor$ã€$not$ å‡å¯ç”¨ $nand$ æ¥è¡¨ç¤ºã€‚$not\ A = A\ nand\ A$, $A\ and\ B = not\ (A\ nand\ B)$, $A\ or\ B = (not\ A)\ nand\ (not\ B)$ï¼Œè€Œ $xor$ æ˜¾ç„¶å¯ä»¥ç”±å¦å¤–ä¸‰ç§è¡¨å‡ºã€‚</p>
<p>æ‰€ä»¥é¢˜ç›®ç­‰ä»·äºå¯ä»¥å°† $n$ ä¸ªæ•°ä»»æ„ä½è¿ç®—èµ·æ¥ï¼å¼å¼</p>
<p>å˜ä¸­æ‰¾ä¸å˜ã€‚è‹¥å­˜åœ¨ä¸¤ä¸ªä½ç½® $i$ å’Œ $j$ ä½¿å¾— $n$ ä¸ªæ•°çš„ $i$ å’Œ $j$ ä½éƒ½ç›¸åŒï¼Œæ˜¾ç„¶æœ€ç»ˆæå‡ºçš„æ•° $i$ å’Œ $j$ ä½ä¹Ÿæ˜¯ç›¸åŒçš„ã€‚å› æ­¤æ•°ä½ $dp$ çš„æ—¶å€™ä»é«˜ä½åˆ°ä½ä½è€ƒè™‘ï¼Œç¡®å®šå½“å‰ä½åå¿…é¡»å°†å’Œå®ƒç›¸åŒçš„ä½æ ‡è®°ä¸€ä¸‹ã€‚</p>
<p>å‰©ä½™æ²¡æœ‰äº’ç›¸é™åˆ¶çš„ä½ç½®å¯ä»¥ä»»æ„å– $0$ æˆ– $1$ã€‚ä¸ºä»€ä¹ˆï¼Ÿï¼Ÿè€ƒè™‘ç”¨çº¿æ€§åŸºçš„æ€æƒ³æ„é€ è§£ï¼ˆå‡è®¾å½“å‰è¦å–ç¬¬ $x$ ä½ä¸º $1$ï¼‰ï¼šé€šè¿‡ä¸€äº›æ“ä½œæŠŠ $n$ ä¸ªæ•°æ¶ˆæˆä¸Šä¸‰è§’ï¼›å¯¹äºç¬¬ $x$ ä½ä¸º $0$ çš„ $a_i$ æŠŠ $a_i$ å–åï¼Œå¦åˆ™ä¸åŠ¨ã€‚æŠŠ $a$ å…¨éƒ¨ &amp; èµ·æ¥ï¼Œ$x$ ä½ä¸Šå¿…ç„¶æ˜¯ $1$ï¼›åŒæ—¶ç”±äº $x$ æ²¡æœ‰äº’ç›¸é™åˆ¶çš„ä½ç½®ï¼Œæ²¡æœ‰å…¶ä»–ä½ä¸Šä¸º $1$ã€‚</p>
<h3 id="é‡è¿”ç°ä¸–"><a href="#é‡è¿”ç°ä¸–" class="headerlink" title="$é‡è¿”ç°ä¸–$"></a><a href="https://www.luogu.com.cn/problem/P4707" target="_blank" rel="noopener">$é‡è¿”ç°ä¸–$</a></h3><hr>
<p>å¥½åƒç¬¬ä¸€æ¬¡åš $k-th\ \min-\max$ å®¹æ–¥çš„é¢˜ã€‚ã€‚å¯èƒ½åªæ˜¯æ¿å­é¢˜ï¼Œä½†æ˜¯ $dp$ å®¹æ–¥ç³»æ•°çš„æ–¹æ³•æŒºé‡è¦ï¼Œç¢°åˆ°å¥½å‡ æ¬¡äº†è®°å½•ä¸€ä¸‹ã€‚</p>
<p>$\min_k$ å’Œ $\max_k$ å¯ä»¥è½¬åŒ–ã€‚<br>$$E(\max_k(S)) = \sum\limits_{T \subset S} (-1)^{|T| - k} C(|T| - 1, k - 1) * E(\min(T))$$<br>$$E(\min(T)) = \frac{m}{\sum\limits_{t \in T} p_t}$$<br>å®¹æ–¥è¿™ä¸œè¥¿çš„ç³»æ•°æ˜¾ç„¶å¯ä»¥ $dp$ï¼Œè€å¥—è·¯äº†ã€‚</p>
<p>è€ƒè™‘çŠ¶æ€æ€ä¹ˆè®¾è®¡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ $k$ å’Œ $E(\min(T))$ ç»™è¡¨ç¤ºåˆ°çŠ¶æ€é‡Œï¼š$f[i, j, k]$ è¡¨ç¤º, å½“å‰åˆ°ç¬¬ $i$ ç§åŸæ–™ï¼Œ$\sum p_t = j$, æŸ¿å­ä¸­çš„ $k = k$ æ—¶, $\sum\limits_{T \subset S} (-1)^{|T| - k} C(|T| - 1, k - 1)$ çš„å’Œã€‚è½¬ç§»ï¼š</p>
<p>$f[i, j, k] = f[i - 1, j, k]$ (ä¸é€‰ $i$)</p>
<p>$+ f[i - 1, j - p_i, k - 1] - f[i - 1, j - p_i, k]$ï¼ˆé€‰ $i$ï¼‰</p>
<p>è¿™æ˜¯å› ä¸º $|T|$ å¢åŠ  $1$ æ—¶, $C(|T| - 1, k - 1) = C(|T| - 2, k - 1) + C(|T| - 2, k - 2)$ï¼ˆæ ¹æ®ç»„åˆæ•°çš„å®šä¹‰ï¼‰ç„¶å $-1$ çš„æŒ‡æ•°ä¹Ÿæ”¹å˜äº†ï¼Œè´Ÿè´Ÿå¾—æ­£ã€‚</p>
<p>è¾¹ç•Œï¼š$f[0, 0, k] = 0$,<br>$f[i, p_i, k] = f[i - 1, p_i, k] + (-1)^{1 - k}C(0, k - 1)$ï¼Œåé¢è¿™å¨ç­‰ä»·äº $[k == 1]$</p>
<h3 id="è½¬ç›˜"><a href="#è½¬ç›˜" class="headerlink" title="$è½¬ç›˜$"></a><a href="http://loj.ac/p/2495" target="_blank" rel="noopener">$è½¬ç›˜$</a></h3><hr>
<p>æˆ‘ä»¬å‘ç°å¦‚æœæ—¶é—´è¢«æŸä¸ªç‚¹é™åˆ¶ä½ï¼Œå°±æ²¡å¿…è¦åœ¨èµ°åˆ°é‚£ä¸ªç‚¹çš„è·¯ä¸Šèµ°èµ°åœåœï¼Œç›´æ¥åœ¨å‡ºå‘å‰ä¸€æ¬¡åœä¸ªå¤Ÿã€‚</p>
<p>ç ´ç¯æˆé“¾ï¼Œåœ¨èµ·å§‹ç‚¹åœæ»¡æ—¶é—´ã€‚æšä¸¾èµ·å§‹ç‚¹ï¼Œå‡è®¾ä» $st$ å¼€å§‹ï¼Œ$ans = \min\limits_{st}( \max\limits_i( T_i - dist(i, st) ) ) + n - 1$</p>
<p>æš´åŠ›è®¡ç®—æ˜¯ $O(n^2)$ çš„ï¼Œè€ƒè™‘æ•°æ®ç»“æ„ç»´æŠ¤</p>
<p>æ‹†ä¸€æ³¢ $dist$ï¼ˆå»æ‰ç¯çš„å½±å“ï¼‰ï¼š<br>$ans = \min\limits_{ 1 \leq i \leq n }( \max\limits_{ 0 \leq j \le n }(T_{i + j} - j) ) + n - 1$</p>
<p>è®¾ $a_i = T_i - i$ï¼Œ$ans = \min\limits_{ 1 \leq i \leq n }( \max\limits_{ i \leq j \le i + n - 1 }{a_j} + i ) + n - 1$ï¼Œå‘ç°æ˜¯ä¸€ä¸ªåç¼€ $\max$ çš„ $\min$ï¼Œ$\min$ ç›´æ¥çº¿æ®µæ ‘ï¼Œ<br>åç¼€ $\max$ æ€ä¹ˆæï¼Ÿå•è°ƒé˜Ÿåˆ— $O(n)$ï¼Œçº¿æ®µæ ‘ç»´æŠ¤ $a$ çš„å•è°ƒå¢çš„é˜Ÿåˆ—å°±å¥½äº†ï¼</p>
<p>ç”¨ <a href="https://www.luogu.com.cn/problem/P4198" target="_blank" rel="noopener">è¿™é¢˜</a> çš„åšæ³•ï¼Œåˆ†æ²»çš„åˆå¹¶ï¼Œéå¸¸å¼ºã€‚</p>
<p>æ¥ä¸‹æ¥è¯æ˜æˆ‘ä»¬å¯ä»¥ç»Ÿè®¡çª—å£å¤§å° $= n$ çš„ç­”æ¡ˆã€‚å› ä¸º $a_i = T_i - i, a_{i + n} = T_i - i - n$, æ‰€ä»¥çª—å£å¤§å° <strong>$\leq n$</strong>;<br>åˆå› ä¸ºçª—å£å¤§å° $\geq \frac{1}{2}$ åŒºé—´é•¿åº¦ï¼Œå¯¹äºæœ€å¤§çš„åŒºé—´ $[1, 2n]$ è€Œè¨€ <strong>$\geq n$</strong>ã€‚</p>
<p><a href="https://loj.ac/s/985524" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="ZJOI2019-çº¿æ®µæ ‘"><a href="#ZJOI2019-çº¿æ®µæ ‘" class="headerlink" title="$ZJOI2019-çº¿æ®µæ ‘$"></a><a href="https://uoj.ac/problem/467" target="_blank" rel="noopener">$ZJOI2019-çº¿æ®µæ ‘$</a></h3><hr>
<p>ç°åœ¨çœ‹çœ‹ï¼Œä¸€çœ¼æœŸæœ›å˜›ã€‚ã€‚è€å¥—è·¯äº†ï¼šç”¨æœŸæœ›åšè®¡æ•°é¢˜</p>
<p>æ¯”è¾ƒå·§å¦™çš„æ˜¯çŠ¶æ€è®¾è®¡ï¼Œé™¤äº†ç»´æŠ¤æœ¬ç‚¹ä¸º $1$ çš„æ¦‚ç‡å¤–ï¼Œè¿˜ç»´æŠ¤ç¥–å…ˆä¸º $1$ çš„æ¦‚ç‡ã€‚è®¾å…¶åˆ†åˆ«ä¸º $f$ å’Œ $g$ã€‚</p>
<p>ä¸‹é¢åˆ†äº”ç§æƒ…å†µï¼š</p>
<ol>
<li>å…¨è¦†ç›–çš„ç‚¹: $g_i = \frac{1}{2} g_i + \frac{1}{2}$</li>
<li>æœ¬ç‚¹: $f_i = \frac{1}{2}f_i + \frac{1}{2}$, $g_i = \frac{1}{2}g_i + \frac{1}{2}$</li>
<li>åˆ°æ ¹ç»è¿‡çš„è·¯å¾„ä¸Šç‚¹: $f_i = \frac{1}{2}f_i$, $g_i = \frac{1}{2}g_i$</li>
<li>é è¿‘è·¯å¾„ä½†å…¨ä¸è¦†ç›–çš„ç‚¹: $f_i = \frac{1}{2}f_i + \frac{1}{2}g_i$, $g_i = g_i$</li>
<li>æ¯«æ— å½±å“çš„ç‚¹: $f_i = f_i$, $g_i = g_i$</li>
</ol>
<p>$2$, $3$ å’Œ $4$ éƒ½æ˜¯ $modify$ çš„æ—¶å€™ä¼š $psd$ çš„ï¼Œæ‰€ä»¥ç›´æ¥æ“ä½œå°±å¥½ã€‚å”¯ç‹¬è¦ç»™ $1$ æ‰“ $tag$ï¼šæˆ‘ä»¬è®©è¿™ä¸ª $tag$ æ‰“åœ¨ç³»æ•°å’Œå¸¸æ•°ä¸Šï¼Œå‘ç°è‹¥æ‰“äº† $k$ ä¸ª $\frac{1}{2}$ï¼Œç³»æ•°å°±æ˜¯ $(\frac{1}{2})^k$, å¸¸æ•°æ˜¯ $1 - (\frac{1}{2})^k$</p>
<p><a href="https://uoj.ac/submission/438768" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="ä¸‰è§’å½¢"><a href="#ä¸‰è§’å½¢" class="headerlink" title="$ä¸‰è§’å½¢$"></a><a href="https://uoj.ac/problem/418" target="_blank" rel="noopener">$ä¸‰è§’å½¢$</a></h3><hr>
<p>æ­£ç€åšï¼Œæ¯ä¸ªç‚¹å—åˆ°å®ƒæ‰€æœ‰å„¿å­çš„é™åˆ¶ï¼Œæ— æ³•é¿å…è¿™ä¸ªé™åˆ¶ï¼Œæ²¡æ³•åšã€‚æŠ€å·§ï¼šå¾—å¤±è½¬æ¢é¢˜è€ƒè™‘å€’ä¸€ä¸‹é¡ºåºï¼Œ<strong>æ¯ä¸ªç‚¹å°±åªå—çˆ¶äº²å½±å“äº†</strong></p>
<p>æ¯æ¬¡æ“ä½œå¯ä»¥ç”¨äºŒå…ƒç»„ $((\sum w_{son}) - w_i$, $\sum w_{son})$æ¥è¡¨ç¤ºï¼Œåˆ†åˆ«æ˜¯æœ€ç»ˆå½±å“å’Œæ“ä½œè¿‡ç¨‹ä¸­è¾¾åˆ°çš„æœ€å¤§å€¼</p>
<p>ä¼˜å…ˆçº§å¥½ç®—ï¼Œå †ç»´æŠ¤ï¼Œå–é˜Ÿé¦–å’Œçˆ¶äº²ç»‘ä¸€å—ï¼Œè€å¥—è·¯äº†ã€‚</p>
<p><strong>æ“ä½œä¼˜å…ˆçº§æ€ä¹ˆç®—ï¼Ÿ</strong>å°†äºŒå…ƒç»„çœ‹ä½œ $(x, y)$ï¼Œæ¯”è¾ƒ $(x, y)$ å’Œ $(xâ€™, yâ€™)$ã€‚æˆ‘ä»¬æ¯”è¾ƒçš„å®—æ—¨æ˜¯è®©ç¬¬äºŒç»´æœ€å°ï¼Œå³å¦‚æœ $\max(y, x + yâ€™) &lt; \max(yâ€™, xâ€™ + y)$ é‚£å…ˆä¸€åäºŒï¼Œå¦åˆ™å…ˆäºŒåä¸€ã€‚</p>
<p>æœ€æ¶å¿ƒçš„æ¥äº†â€”â€”<strong>è¿™æ ·å†™ä¼š Tï¼</strong><br>æ‰€ä»¥è€å®åˆ†ç±»è®¨è®ºå§ã€‚æ³¨æ„æ‹†æ‰ $x + yâ€™ &lt; \max(xâ€™ + y, yâ€™)$ å³è¾¹çš„ $\max$ æ—¶ $x$ å¿…é¡» $\geq 0$ï¼Œæ‰€ä»¥ $x$ã€$xâ€™ &lt; 0$ çš„æ—¶å€™è¦ç‰¹æ®Šè®¨è®ºã€‚</p>
<p>ç»‘çš„æ—¶å€™åˆå¹¶æ“ä½œï¼Œå½±å“ç›¸åŠ ï¼Œæœ€å¤§å€¼æ›´æ–°ã€‚è¿™æ ·å°±ç®—å‡ºäº†å…¨å±€æœ€ä¼˜è§£ã€‚</p>
<p>è€Œæ ¹æ®æ“ä½œåºåˆ—åæ¨å‡ºæ¯ä¸ªå­æ ‘ç­”æ¡ˆçš„æ–¹æ³•ä¹Ÿå¾ˆå·§å¦™ï¼šè€ƒè™‘æ¯ä¸ªå­æ ‘çš„æ“ä½œåºåˆ—æ˜¯å…¨å±€çš„ä¸€ä¸ªå­åºåˆ—ï¼Œæˆ‘ä»¬ç”¨çº¿æ®µæ ‘åˆå¹¶æ±‚è§£æ‰€æœ‰å­æ ‘çš„ç­”æ¡ˆå°±å¯ä»¥äº†ã€‚çº¿æ®µæ ‘ä¸Šä»¥æ—¶é—´ä¸ºä¸‹æ ‡ã€‚</p>
<p><a href="https://uoj.ac/submission/438673" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="UOJ211-é€ƒè·‘"><a href="#UOJ211-é€ƒè·‘" class="headerlink" title="$UOJ211-é€ƒè·‘$"></a><a href="https://uoj.ac/problem/211" target="_blank" rel="noopener">$UOJ211-é€ƒè·‘$</a></h3><p>æ±‚æ–¹å·®å°±æ˜¯æ±‚æ¯ç§æƒ…å†µç»è¿‡ä½ç½®ä¸ªæ•°å’Œï¼Œä»¥åŠç»è¿‡ä½ç½®ä¸ªæ•°å¹³æ–¹å’Œã€‚ä¸ªæ•°å’Œå¯ä»¥ $dp$: $f[i, x, y]$ è¡¨ç¤ºèµ°äº† $i$ æ­¥ç¬¬ä¸€æ¬¡åˆ°è¾¾ $(x, y)$ çš„æ¦‚ç‡ï¼Œ$g[i, x, y]$ è¡¨ç¤ºèµ°äº† $i$ æ­¥åˆ°è¾¾ $(x, y)$ çš„æ¦‚ç‡ï¼Œæ˜¾ç„¶ $f$ å¯ä»¥ç”± $f$ å’Œ $g$ å®¹æ–¥å¾—åˆ°ã€‚</p>
<p>å¹³æ–¹å’Œè€å¥—è·¯ï¼ŒæŠŠ $x^2$ æ‹†æˆ $C(x, 2) + x$ï¼Œè€ƒè™‘å…¶å®é™…æ„ä¹‰å°±æ˜¯åˆ°è¾¾äº†ä¸¤ä¸ªåœ°ç‚¹çš„æ¦‚ç‡â€”â€”è¿™æ€ä¹ˆæï¼Ÿ$h[i, x, y]$ è¡¨ç¤ºèµ°äº† $i$ æ­¥åœ¨åˆ°è¾¾ $(a, b)$ å‰åˆ°è¾¾è¿‡ $(a - x, b - y)$ çš„æ¦‚ç‡å’Œï¼Œè¦å‡å»åœ¨åˆ°è¾¾ $(a - x, b - y)$ å‰åˆ°è¾¾è¿‡ $(a, b)$ çš„æ¦‚ç‡å’Œã€‚</p>
<p><a href="https://uoj.ac/submission/440153" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="UOJ141-é‡å­æ€çš„æ£‹ç›˜"><a href="#UOJ141-é‡å­æ€çš„æ£‹ç›˜" class="headerlink" title="$UOJ141-é‡å­æ€çš„æ£‹ç›˜$"></a><a href="https://uoj.ac/problem/141" target="_blank" rel="noopener">$UOJ141-é‡å­æ€çš„æ£‹ç›˜$</a></h3><hr>
<p>é¦–å…ˆé‚£ä¹ˆå¤šçƒæ˜¯å”¬ä½ çš„ï¼šå‡è®¾æœ‰ $a$ ä¸ªçƒæµåˆ° $(x, y)$ ä¸Šï¼Œé‚£ä¹ˆä¼šåˆ†ä¸ºä¸¤ä¸ªæ”¯æµï¼Œåˆ†åˆ«ä¸º $a / 2$ å’Œ $(a + 1) / 2$ï¼Œå°±çœ‹ $(x, y)$ åˆå§‹çŠ¶æ€å†³å®šé‚£ä¸ªæ”¯æµåˆ°é‚£ä¸ªæ–¹å‘ã€‚$n$ã€$m$ é‚£ä¹ˆå°ï¼Œç›´æ¥ $80$ è¿›åˆ¶çŠ¶å‹ï¼Œæ€»çŠ¶æ€æ•°åªæœ‰å‡ åä¸‡ï¼Œ$hashmap$ å†²ä¸€å‘å°±å¥½ã€‚</p>
<p><a href="https://uoj.ac/submission/440103" target="_blank" rel="noopener">$Code$</a></p>
<h3 id="CF1163E"><a href="#CF1163E" class="headerlink" title="$CF1163E$"></a><a href="https://www.luogu.com.cn/problem/CF1163E" target="_blank" rel="noopener">$CF1163E$</a></h3><hr>
<p><a href="https://www.cnblogs.com/p-b-p-b/p/11741238.html" target="_blank" rel="noopener">é¢˜è§£</a></p>
<p>è¿™é¢˜å¥½å¦™ï¼æ„Ÿè§‰çº¿æ€§åŸºçš„é¢˜ç›®æƒ³è·Ÿæˆ‘è®²é“ç†éƒ½ä¸è¡Œ= = æ„è¯†æµèµ›é«˜ã€‚ã€‚</p>
<p>å¤§æ¦‚æ˜¯åªèƒ½ç”¨ $&lt; 2^x$ çš„æ•°ï¼›åŒæ—¶æ„æˆå¤§å°ä¸º $k$ çš„çº¿æ€§æ— å…³ç»„ï¼ˆçº¿æ€§åŸºï¼‰ï¼Œè¿™ä¸ªçº¿æ€§åŸºèƒ½å¼‚æˆ–å‡º $2^x - 1$ ä¸ªæ•°ï¼Œæ„é€ å°±éšæ€§ä¸€ç‚¹ï¼Œæ¯æ¬¡ pia ä¸¤åŠï¼Œå·¦å³å› ä¸ºä¸­é—´æœ‰ä¸ªæ•°ï¼ˆåŸºé‡Œçš„æ•°ï¼Œä»€ä¹ˆæ•°éƒ½è¡Œï¼Œæœ¬ä»£ç ä¸­ä¸æ·±åº¦æœ‰å…³ï¼‰ï¼Œå¿…ç„¶æ˜¯ä¸åŒçš„ã€‚<br>å¤ªå¦™äº†ï¼ŒæŠŠçº¿æ€§æ— å…³è¿ç”¨çš„æ·‹æ¼“å°½è‡´ã€‚</p>
<h3 id="CF1163F"><a href="#CF1163F" class="headerlink" title="$CF1163F$"></a><a href="https://www.luogu.com.cn/problem/CF1163F" target="_blank" rel="noopener">$CF1163F$</a></h3><hr>
<p>è¯»å®Œé¢˜æˆ‘æƒ³ï¼šå¦‚æœèƒ½ç»´æŠ¤ä¸ç»è¿‡æŸæ¡è¾¹çš„æœ€çŸ­è·¯å°±å¥½äº†ã€‚ã€‚</p>
<p>æ­£è§£å¾ˆç¡¬æ ¸ï¼Œç›´æ¥æœ€çŸ­è·¯æ ‘ + åˆ†è®¨</p>
<ol>
<li>$(u, v)$ ä¸åœ¨æœ€çŸ­è·¯ä¸Šï¼Œå˜å°ï¼Œæ–°å€¼ä¸åˆå§‹ç­”æ¡ˆå–ä¸ª $\min$</li>
<li>$(u, v)$ ä¸åœ¨æœ€çŸ­è·¯ä¸Šï¼Œå˜å¤§ï¼Œæ— å½±å“</li>
<li>$(u, v)$ åœ¨æœ€çŸ­è·¯ä¸Šï¼Œå˜å°ï¼Œç­”æ¡ˆå‡å°å¯¹åº”çš„å€¼ï¼›</li>
<li>$(u, v)$ åœ¨æœ€çŸ­è·¯ä¸Šï¼Œå˜å¤§ï¼Œè¿™ä¸ªæ¯”è¾ƒéº»çƒ¦ã€‚<br>å›ç­”ä¸Šé¢é‚£ä¸ªé—®é¢˜ï¼çº¿æ®µæ ‘ï¼</li>
</ol>
<p>æ‡‚äº†å—ï¼Ÿçº¿æ®µæ ‘åªè¦ç»´æŠ¤åŸå§‹æœ€çŸ­è·¯çš„æ–­è¾¹æƒ…å†µã€‚$[L, R]$ è¡¨ç¤ºä¸ç”¨åŒºé—´ $[L, R]$ çš„è¾¹çš„æœ€çŸ­è·¯</p>
<p>ç»å…¸å¥—è·¯ï¼š<strong>æ‰¹é‡</strong>ç»´æŠ¤åˆ é™¤æŸä¸ªç‚¹æˆ–è¾¹çš„å¯ä»¥å°è¯•åˆ†æ²»</p>
<p>æŸæ¡è¾¹ $(u, v)$ æ‰€åœ¨çš„æœ€çŸ­è·¯ï¼Œå¯¹åˆ é™¤<em>è¿æ¥ $u$ çš„ã€åœ¨ $u$ ä¹‹å‰ï¼Œåœ¨æœ€çŸ­è·¯ä¸Šçš„æœ€åç‚¹</em> ~ <em>è¿æ¥ $v$ çš„ã€åœ¨ $v$ ä¹‹åï¼Œåœ¨æœ€çŸ­è·¯ä¸Šçš„æœ€å‰ç‚¹</em>ä¹‹é—´çš„è¾¹æœ‰è´¡çŒ®</p>
<h3 id="CF516E"><a href="#CF516E" class="headerlink" title="$CF516E$"></a><a href="https://www.luogu.com.cn/problem/CF516E" target="_blank" rel="noopener">$CF516E$</a></h3><p>æˆ‘å³æ•°å­¦é»‘æ´ï¼</p>
<p>è®¾ $x = i % n$, $y = i % m$</p>
<p>$i = k1 <em> n + x = k2 </em> m + y$</p>
<p>$x \equiv y \pmod {gcd(n, m)}$</p>
<p>è®¾ $d = gcd(n, m)$, äºæ˜¯å°±å¯ä»¥æŠŠç”·å¥³ç”Ÿå…³äº $d$ å½’ä¸º $0 ~ d - 1$ ç±»ï¼Œä¸åŒç±»é—´äº’ä¸å½±å“ï¼Œäºæ˜¯å˜æˆäº† $d$ ä¸ªå­é—®é¢˜ã€‚ä¸€ä¸ªå­é—®é¢˜çš„è´¡çŒ®æ˜¯è¿™ä¸€ç±»çš„æ‰€æœ‰ç”·å¥³ç”Ÿå˜å¼€å¿ƒçš„æ—¶é—´ã€‚ï¼ˆæ¥ä¸‹æ¥çš„ $n$ å’Œ $m$ æ˜¯é™¤ä»¥ $d$ åçš„ï¼Œäº’è´¨ï¼‰</p>
<p>å¦‚æœ $i % n$ ç”·ç”Ÿè®© $i % m$ å¥³ç”Ÿå˜å¼€å¿ƒäº†ï¼Œé‚£ $(i + n) % m$ å¥³ç”Ÿåœ¨ $n$ æ—¶é—´åä¹Ÿä¼šå˜å¼€å¿ƒï¼Œ<br>æ‰€ä»¥è¿è¾¹ï¼š$i -&gt; (i + n) % m$, $n$</p>
<p>å†å¯¹äºæ‰€æœ‰åˆå§‹å°±å¼€å¿ƒçš„ $i$ è¿è¾¹ï¼š$S -&gt; i$, $i$</p>
<p>ç„¶åè·‘æœ€çŸ­è·¯ã€‚ä½†æ˜¯å›¾å¤ªå¤§äº†ã€‚</p>
<p>è€ƒè™‘ç¬¬ä¸€ç§è¾¹ï¼Œå› ä¸º $n$ å’Œ $m$ äº’è´¨ï¼Œæ‰€ä»¥ä¼šè¿æˆä¸€ä¸ªå¤§ç¯ï¼Œæˆ‘ä»¬æŠŠä¸ $S$ ç›¸è¿çš„ç‚¹ç§°ä¸ºå…³é”®ç‚¹ï¼ŒæŠŠæ‰€æœ‰å…³é”®ç‚¹æ‹å‡ºæ¥ï¼Œå¯¹æœ€å¤§æ—¶é—´æœ‰è´¡çŒ®çš„å¿…ç„¶æ˜¯ç›¸é‚»ä¸¤ç‚¹ä¹‹é—´æœ€é å³çš„éå…³é”®ç‚¹ï¼ˆç”»å›¾å°±æ˜ç™½äº†ï¼‰</p>
<p>é‚£æ€ä¹ˆç»™æ‹å‡ºæ¥çš„å…³é”®ç‚¹é‡æ ‡å·ï¼ˆæ’åºï¼‰å‘¢ï¼Ÿ$exgcd$ ç®—èµ·ç‚¹åˆ°å®ƒä»¬çš„è·ç¦»ï¼Œå°±åšå®Œäº†ã€‚</p>
<p>åè®°ï¼šxml å› ä¸ºè´ºäº†ä¸€æ•´é¢˜æ‰€ä»¥éå¸¸éš¾å—ã€‚</p>
<h3 id="BZOJ3636-æ•™ä¹‰é—®ç­”æ‰‹å†Œ"><a href="#BZOJ3636-æ•™ä¹‰é—®ç­”æ‰‹å†Œ" class="headerlink" title="$BZOJ3636-æ•™ä¹‰é—®ç­”æ‰‹å†Œ$"></a><a href="https://darkbzoj.tk/problem/3636" target="_blank" rel="noopener">$BZOJ3636-æ•™ä¹‰é—®ç­”æ‰‹å†Œ$</a></h3><p>ä¸èƒ½é‡å ï¼Œè€Œä¸”æ˜¯è‹¥å¹²æ¡ã€‚</p>
<p>é¦–å…ˆæœ‰æ˜¾ç„¶çš„ $n^2$ $dp$ï¼š<br>$f[l, r]$ è¡¨ç¤ºåŒºé—´ $[l, r]$ çš„ç­”æ¡ˆï¼Œé‚£ä¹ˆ<br>$f[l, r] = max(f[l, r - 1], f[l, r - L] + s[r] - s[r - L])$</p>
<p>å½“ç„¶ä¹Ÿå¯ä»¥åå‘ï¼š<br>$f[l, r] = max(f[l + 1, r], f[l + L, r] + s[l + L - 1] - s[l - 1])$</p>
<p>æ‰€ä»¥æˆ‘ä»¬çŸ¥é“äº†æŸä¸ªç«¯ç‚¹å°±å¯ä»¥ $O(n)$ è®¡ç®—æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿</p>
<p>ç¥ litbleï¼šä¸èƒ½ $AC$ ä½†å¾ˆå¦™çš„åˆ†å—ï¼ˆæ­£è§£æ— å…³ï¼‰ï¼šå¯¹äºæ¯ä¸ªå—çš„å·¦ç«¯ç‚¹ $l$ï¼Œé¢„å¤„ç†æ‰€æœ‰ç‚¹ä½œä¸º $r$ çš„ $f$ã€‚</p>
<p>æ­£è§£ï¼šå¯¹äºæ¯ä¸ªä¸­ç‚¹å¤„ç†è¿‡ä¸­ç‚¹çš„è¯¢é—®ã€‚<br>è¦ä¹ˆä¸å–è·¨ä¸­ç‚¹çš„åŒºé—´ï¼Œè¦ä¹ˆå–ï¼Œ$O(L)$ æšä¸¾è·¨ä¸­ç‚¹åŒºé—´çš„å·¦ç«¯ç‚¹å† $O(n)$ è®¡ç®—æœªè¢«åŒ…æ‹¬åœ¨è·¨ä¸­ç‚¹åŒºé—´é‡Œçš„åŒºé—´ç­”æ¡ˆï¼ˆç”¨ä¸Šé¢çš„ $dp$ï¼‰</p>
<p>æ‰€ä»¥æ˜¯ $O(nL log n)$</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/32/">32</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="imily" />
          <p class="site-author-name" itemprop="name">imily</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">312</span>
                <span class="site-state-item-name">æ—¥å¿—</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index-1.html">
                <span class="site-state-item-count">110</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">imily</span>
</div>


<div class="powered-by">
  ç”± <a class="theme-link" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨
</div>

<div class="theme-info">
  ä¸»é¢˜ -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  






  





  

  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  


  

</body>
</html>

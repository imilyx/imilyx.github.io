<!DOCTYPE html>
<html lang=zh>
<head><meta name="generator" content="Hexo 3.9.0">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="网络流咱不聊 EK 哈，EK 莫得用处。 Dinic构建分层图，在分层图上增广。 一般图：$O(n * nm)$每次构建分层图，残量网络上 $s$ 到 $t$ 的最短路严格递增，至多重建 $n - 1$ 次分层图。 至于 dfs 增广复杂度，构建一次分层图至多增广 $m$ 次，每条路径长度至多 $n$。 单位图：$O(\sqrt{n} * nm)$每个点要么入度为 $1$ 且连进来的边容量为 $1">
<meta name="keywords" content="网络流,学习笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="【学习笔记】网络流">
<meta property="og:url" content="http://yoursite.com/2021/02/14/【学习笔记】网络流/index.html">
<meta property="og:site_name" content="imily&#39;s notebook">
<meta property="og:description" content="网络流咱不聊 EK 哈，EK 莫得用处。 Dinic构建分层图，在分层图上增广。 一般图：$O(n * nm)$每次构建分层图，残量网络上 $s$ 到 $t$ 的最短路严格递增，至多重建 $n - 1$ 次分层图。 至于 dfs 增广复杂度，构建一次分层图至多增广 $m$ 次，每条路径长度至多 $n$。 单位图：$O(\sqrt{n} * nm)$每个点要么入度为 $1$ 且连进来的边容量为 $1">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2021-02-18T08:16:44.904Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="【学习笔记】网络流">
<meta name="twitter:description" content="网络流咱不聊 EK 哈，EK 莫得用处。 Dinic构建分层图，在分层图上增广。 一般图：$O(n * nm)$每次构建分层图，残量网络上 $s$ 到 $t$ 的最短路严格递增，至多重建 $n - 1$ 次分层图。 至于 dfs 增广复杂度，构建一次分层图至多增广 $m$ 次，每条路径长度至多 $n$。 单位图：$O(\sqrt{n} * nm)$每个点要么入度为 $1$ 且连进来的边容量为 $1">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon-cactus.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>【学习笔记】网络流</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- rss --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    
    
</head>

<body>
    
      <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/posts/">归档</a></li>
         
          <li><a href="/tags/">标签</a></li>
         
          <li><a href="/friends/">友人帐</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2021/02/16/【学习笔记】类欧几里得/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2021/02/08/AGC027E、ARC110E 等一类删除计数问题/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2021/02/14/【学习笔记】网络流/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2021/02/14/【学习笔记】网络流/&text=【学习笔记】网络流"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2021/02/14/【学习笔记】网络流/&title=【学习笔记】网络流"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2021/02/14/【学习笔记】网络流/&is_video=false&description=【学习笔记】网络流"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=【学习笔记】网络流&body=Check out this article: http://yoursite.com/2021/02/14/【学习笔记】网络流/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2021/02/14/【学习笔记】网络流/&title=【学习笔记】网络流"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2021/02/14/【学习笔记】网络流/&title=【学习笔记】网络流"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2021/02/14/【学习笔记】网络流/&title=【学习笔记】网络流"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2021/02/14/【学习笔记】网络流/&title=【学习笔记】网络流"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2021/02/14/【学习笔记】网络流/&name=【学习笔记】网络流&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#网络流"><span class="toc-number">1.</span> <span class="toc-text">网络流</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Dinic"><span class="toc-number">1.1.</span> <span class="toc-text">Dinic</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#一般图：-O-n-nm"><span class="toc-number">1.1.1.</span> <span class="toc-text">一般图：$O(n * nm)$</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#单位图：-O-sqrt-n-nm"><span class="toc-number">1.1.2.</span> <span class="toc-text">单位图：$O(\sqrt{n} * nm)$</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#单位容量图：-O-min-n-2-3-m-1-2-nm"><span class="toc-number">1.1.3.</span> <span class="toc-text">单位容量图：$O(\min(n^{2/3}, m^{1/2}) * nm)$</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bonus-LCT-优化-Dinic-分层图上增广过程"><span class="toc-number">1.1.4.</span> <span class="toc-text">Bonus: LCT 优化 Dinic 分层图上增广过程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#上下界网络流"><span class="toc-number">1.2.</span> <span class="toc-text">上下界网络流</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#无源汇有上下界可行流（即可行循环流）"><span class="toc-number">1.2.1.</span> <span class="toc-text">无源汇有上下界可行流（即可行循环流）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#有源汇有上下界可行流"><span class="toc-number">1.2.2.</span> <span class="toc-text">有源汇有上下界可行流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#有源汇有上下界最大流"><span class="toc-number">1.2.3.</span> <span class="toc-text">有源汇有上下界最大流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#有源汇有上下界最小流"><span class="toc-number">1.2.4.</span> <span class="toc-text">有源汇有上下界最小流</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#费用流"><span class="toc-number">2.</span> <span class="toc-text">费用流</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Primal-Dual-原始对偶算法"><span class="toc-number">2.1.</span> <span class="toc-text">Primal-Dual 原始对偶算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#上下界费用流"><span class="toc-number">2.2.</span> <span class="toc-text">上下界费用流</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#最小费用无源汇有上下界可行流"><span class="toc-number">2.2.1.</span> <span class="toc-text">最小费用无源汇有上下界可行流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#最小费用有源汇有上下界可行流"><span class="toc-number">2.2.2.</span> <span class="toc-text">最小费用有源汇有上下界可行流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#最小费用有上下界最大流"><span class="toc-number">2.2.3.</span> <span class="toc-text">最小费用有上下界最大流</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#建模技巧"><span class="toc-number">3.</span> <span class="toc-text">建模技巧</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#应用"><span class="toc-number">4.</span> <span class="toc-text">应用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#最大权闭合子图"><span class="toc-number">4.1.</span> <span class="toc-text">最大权闭合子图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最大密度子图"><span class="toc-number">4.2.</span> <span class="toc-text">最大密度子图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#混合图欧拉路径、回路"><span class="toc-number">4.3.</span> <span class="toc-text">混合图欧拉路径、回路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#区间-k-覆盖"><span class="toc-number">4.4.</span> <span class="toc-text">区间 $k$ 覆盖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DAG-最小路径覆盖问题"><span class="toc-number">4.5.</span> <span class="toc-text">DAG 最小路径覆盖问题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#习题"><span class="toc-number">5.</span> <span class="toc-text">习题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#机场Airport"><span class="toc-number">5.1.</span> <span class="toc-text">机场Airport</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#无限之环"><span class="toc-number">5.2.</span> <span class="toc-text">无限之环</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        【学习笔记】网络流
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">imily's notebook</span>
      </span>
      
    <div class="postdate">
        <time datetime="2021-02-14T05:11:40.000Z" itemprop="datePublished">2021-02-14</time>
    </div>


      
    <div class="article-tags">
        <i class="fa fa-tags"></i>
        <a class="tag-link" href="/tags/学习笔记/">学习笔记</a>, <a class="tag-link" href="/tags/网络流/">网络流</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="网络流"><a href="#网络流" class="headerlink" title="网络流"></a>网络流</h1><p>咱不聊 EK 哈，EK 莫得用处。</p>
<h2 id="Dinic"><a href="#Dinic" class="headerlink" title="Dinic"></a>Dinic</h2><p>构建分层图，在分层图上增广。</p>
<h3 id="一般图：-O-n-nm"><a href="#一般图：-O-n-nm" class="headerlink" title="一般图：$O(n * nm)$"></a>一般图：$O(n * nm)$</h3><p>每次构建分层图，残量网络上 $s$ 到 $t$ 的最短路严格递增，至多重建 $n - 1$ 次分层图。</p>
<p>至于 dfs 增广复杂度，构建一次分层图至多增广 $m$ 次，每条路径长度至多 $n$。</p>
<h3 id="单位图：-O-sqrt-n-nm"><a href="#单位图：-O-sqrt-n-nm" class="headerlink" title="单位图：$O(\sqrt{n} * nm)$"></a>单位图：$O(\sqrt{n} * nm)$</h3><p>每个<strong>点</strong>要么入度为 $1$ 且连进来的边容量为 $1$，要么出度为 $1$ 且连出去的边容量为 $1$。</p>
<p>定义流图 $f$ 的 $|f|$ 表示该图上的流的个数，即流形成的路径数。</p>
<p>设当前流的图为 $P$，目标最大流的图为 $Q$，$P$ 的残量网络是 $R$，那么 $Q - P$ 是 $R$ 上的一个流，有许多路径，可能还有环。<strong>因为 $R$ 是单位图，除了 $s$ 和 $t$ 以外的每个点至多属于一条路径</strong>，$dis(s, t) \leq \frac{n - 2}{|Q| - |P|} + 1$（每次增广最短路严格递增）</p>
<p>经过 $\sqrt{n - 2}$ 次增广后，$dis(s, t)$ $\geq \sqrt{n - 2} + 1$，即 $|Q| - |P| \leq \sqrt{n - 2}$，即至多再增广 $\sqrt{n - 2}$ 次就可以结束算法。</p>
<h3 id="单位容量图：-O-min-n-2-3-m-1-2-nm"><a href="#单位容量图：-O-min-n-2-3-m-1-2-nm" class="headerlink" title="单位容量图：$O(\min(n^{2/3}, m^{1/2}) * nm)$"></a>单位容量图：$O(\min(n^{2/3}, m^{1/2}) * nm)$</h3><p>每条<strong>边</strong>容量为 $1$。</p>
<p>结论：这样的图设其最大流为 $M$，$dis(s, t) \leq \frac{2n}{\sqrt{M}}$。</p>
<p>证明：设最短路长度为 $l$，即分层图有 $l$ 层，设第 $i$ 层点集为 $V_i$, 则 $M \leq |V_i|\cdot|V_{i + 1}|$，所以 $V_i$ 和 $V_{i + 1}$ 必有一个 $\geq \sqrt{M}$，所以 $\frac{l + 1}{2} * \sqrt{M} \leq n$，即 $l \leq \frac{2n}{\sqrt{M}}$。</p>
<p>当前已有流 $F \leq M - n^{2/3}$ 时，残量网络最大流 $= n^{2/3}$，$l \leq 2n^{2/3}$；$F &gt; M - n^{2/3}$ 时，残量网络最大流 $&lt; n^{2/3}$，至多进行 $n^{2/3}$ 次增广。</p>
<p>至于 $m^{1/2}$，证明同「单位图」，只是<strong>每条边至多属于一条路径</strong>。</p>
<h3 id="Bonus-LCT-优化-Dinic-分层图上增广过程"><a href="#Bonus-LCT-优化-Dinic-分层图上增广过程" class="headerlink" title="Bonus: LCT 优化 Dinic 分层图上增广过程"></a>Bonus: LCT 优化 Dinic 分层图上增广过程</h3><p>LCT 可以很好的维护加边、寻找路径上最小值、路径减一个值和删边等操作，复杂度 $O(nmlogm)$ <del>然而赛场上没人写它</del></p>
<h2 id="上下界网络流"><a href="#上下界网络流" class="headerlink" title="上下界网络流"></a>上下界网络流</h2><h3 id="无源汇有上下界可行流（即可行循环流）"><a href="#无源汇有上下界可行流（即可行循环流）" class="headerlink" title="无源汇有上下界可行流（即可行循环流）"></a>无源汇有上下界可行流（即可行循环流）</h3><p>令每条边的流量等于下界，得到一个初始流。考虑在残量网络上求出一个不满足流量平衡限制的附加流使得附加流和初始流合并后满足流量平衡。构造残量网络使得 $[l, r]$ 的边容量为 $r - l$。</p>
<p>若初始流中 $i$ 点流入比流出多 $x$，那在附加流中就要流出比流入多 $x$。少 $x$ 亦然。</p>
<p>建立虚源汇点 $s_0$, $t_0$。若在附加流中 $i$ 点需要流入比流出多 $x$，则连边 $(s_0, i, x)$，否则连边 $(i, t_0, -x)$。</p>
<h3 id="有源汇有上下界可行流"><a href="#有源汇有上下界可行流" class="headerlink" title="有源汇有上下界可行流"></a>有源汇有上下界可行流</h3><p>连边 $(t, s, \infty)$。最后得到的有源汇流的流量即为 $(t, s, \infty)$ 的流量。</p>
<h3 id="有源汇有上下界最大流"><a href="#有源汇有上下界最大流" class="headerlink" title="有源汇有上下界最大流"></a>有源汇有上下界最大流</h3><p>先求一个有源汇有上下界可行流，然后在残量网络上跑 $s-t$ 最大流。</p>
<h3 id="有源汇有上下界最小流"><a href="#有源汇有上下界最小流" class="headerlink" title="有源汇有上下界最小流"></a>有源汇有上下界最小流</h3><p>利用反向边——先求有源汇有上下界可行流，再在残量网络上跑 $t-s$ 最大流。</p>
<h1 id="费用流"><a href="#费用流" class="headerlink" title="费用流"></a>费用流</h1><p>分为最小费用流和最小费用最大流。</p>
<p>复杂度 $= |f| * (spfa ? nm; dij ? mlogm)$</p>
<h2 id="Primal-Dual-原始对偶算法"><a href="#Primal-Dual-原始对偶算法" class="headerlink" title="Primal-Dual 原始对偶算法"></a>Primal-Dual 原始对偶算法</h2><p>初始运行一遍 Bellman-Ford 求出初始 $s$ 到每个点最短路。定义势函数 $h_u = dist(s, u)$，对于一条边 $(u, v)$ 将其边权修改为 $cost(u, v) + h_u - h_v$，显然非负，接下来都跑 Dijkstra，并更新势函数。</p>
<h2 id="上下界费用流"><a href="#上下界费用流" class="headerlink" title="上下界费用流"></a>上下界费用流</h2><h3 id="最小费用无源汇有上下界可行流"><a href="#最小费用无源汇有上下界可行流" class="headerlink" title="最小费用无源汇有上下界可行流"></a>最小费用无源汇有上下界可行流</h3><p>同无源汇有上下界可行流</p>
<h3 id="最小费用有源汇有上下界可行流"><a href="#最小费用有源汇有上下界可行流" class="headerlink" title="最小费用有源汇有上下界可行流"></a>最小费用有源汇有上下界可行流</h3><p>建边 $(t, s, \infty, 0)$，跑最小费用无源汇有上下界可行流</p>
<h3 id="最小费用有上下界最大流"><a href="#最小费用有上下界最大流" class="headerlink" title="最小费用有上下界最大流"></a>最小费用有上下界最大流</h3><p>一定保证「不存在源到汇的负权路径」。跟去掉「费用」的差不多嘛，无非是记得构建残量网络的时候带上边的费用。</p>
<h1 id="建模技巧"><a href="#建模技巧" class="headerlink" title="建模技巧"></a>建模技巧</h1><ul>
<li>顶点限流：拆点</li>
<li>多源多汇：super $S$ &amp; $T$！</li>
<li>费用分段递增：拆边</li>
</ul>
<h1 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h1><h2 id="最大权闭合子图"><a href="#最大权闭合子图" class="headerlink" title="最大权闭合子图"></a>最大权闭合子图</h2><p><a href="https://imilyx.github.io/2020/12/26/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9C%80%E5%A4%A7%E6%9D%83%E9%97%AD%E5%90%88%E5%AD%90%E5%9B%BE/" target="_blank" rel="noopener">Jump!</a></p>
<h2 id="最大密度子图"><a href="#最大密度子图" class="headerlink" title="最大密度子图"></a>最大密度子图</h2><p>给定正点权、正边权的有向图 $(V, E)$，求一个子图使得边权与点权的比值尽量大。</p>
<p>选了边就必须选点，所以分数规划 + 边建点，跑最大权闭合子图。</p>
<h2 id="混合图欧拉路径、回路"><a href="#混合图欧拉路径、回路" class="headerlink" title="混合图欧拉路径、回路"></a>混合图欧拉路径、回路</h2><p><strong>先判断底图连通性</strong></p>
<p>随便定向，再利用网络流来判断能否使得流量平衡，即 $\forall x, d_x = in_x - out_x = 0$。</p>
<ul>
<li>对于原图可以反向的边 $(u, v)$，连边 $(v, u, 2)$，表示反向 $(u, v)$ 可以使得 $d_u + 2$, $d_v - 2$</li>
<li>若 $d_u$ 应该 $+ x$，则连边 $(u, t, x)$</li>
<li>若 $d_u$ 应该 $- x$，则连边 $(s, u, x)$</li>
</ul>
<p>若与 $s$、$t$ 相连的边全部满流，则有解。输出方案就将 $(v, u, 2)$ 满流的 $(u, v)$ 反向。</p>
<h2 id="区间-k-覆盖"><a href="#区间-k-覆盖" class="headerlink" title="区间 $k$ 覆盖"></a>区间 $k$ 覆盖</h2><p>要求任意<strong>一个点</strong>至多被 $k$ 个区间覆盖。</p>
<p>转化为左闭右开区间。</p>
<ul>
<li>连边 $(s, 1, k, 0)$</li>
<li>设端点为 $1$ ~ $m$，连边 $(i, i + 1, \infty, 0)$</li>
<li>设区间 $[u, v)$ 权值为 $w$，连边 $(u, v, 1, w)$</li>
</ul>
<h2 id="DAG-最小路径覆盖问题"><a href="#DAG-最小路径覆盖问题" class="headerlink" title="DAG 最小路径覆盖问题"></a>DAG 最小路径覆盖问题</h2><p><a href="https://imilyx.github.io/2020/12/27/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9C%80%E9%95%BF%E5%8F%8D%E9%93%BE%E5%92%8C%E5%AE%83%E5%85%A8%E5%AE%B6%EF%BC%88%E8%AF%A6%E7%BB%86%E6%8F%AD%E7%A7%98%EF%BC%89/" target="_blank" rel="noopener">Jump!</a></p>
<h1 id="习题"><a href="#习题" class="headerlink" title="习题"></a>习题</h1><h2 id="机场Airport"><a href="#机场Airport" class="headerlink" title="机场Airport"></a>机场Airport</h2><p><strong>真 正 的 题 意</strong>：一架 $x$ 人的飞机进行一次移动产生 $x * p$ 的代价。一架飞机在登机时若出现在坏的停机坪上则产生 $x$ 的代价。摆渡车好像是无限的？</p>
<p>「你一开始都坏了就别动了吧！」基于这样的思想，坏的停机坪可以看作无限。而飞机分三种：</p>
<ul>
<li>一直好，代价 $0$</li>
<li>出身好，第二天就坏了，代价 $x * p$</li>
<li>一直坏，代价 $x$</li>
</ul>
<p>把登机和起飞时间点离散化，共有 $2n$ 个时间点。画一张 $a * 2n$ 的表格，表示每块好停机坪的使用情况。那么一架登机 $l$ 起飞 $r$ 的飞机，前两种决策分别为：</p>
<ul>
<li>占用 $[l, r)$</li>
<li>占用 $[l, l + 1)$</li>
</ul>
<p>但是实际不可能建出表格，考虑压成 $1 * 2n$，类似于区间 $k$ 覆盖——每列（每格）不超过 $a$。要保证两个决策不同时进行，还得把飞机拆点咯。</p>
<p>点数 $3n + 1$, 边数 $5n$，流量上限 $a$。primal-dual, 第一次用 dp 计算。</p>
<p><a href="https://loj.ac/s/1067724" target="_blank" rel="noopener">$Code(Dij)$</a><br><a href="https://loj.ac/s/1067716" target="_blank" rel="noopener">$Code(Spfa)$</a></p>
<p><del>Dij 还是快的啊</del></p>
<h2 id="无限之环"><a href="#无限之环" class="headerlink" title="无限之环"></a>无限之环</h2><p><a href="http://imilyx.github.io/2020/08/06/%5B%E6%B8%85%E5%8D%8E%E9%9B%86%E8%AE%AD2017%5D-%E6%97%A0%E9%99%90%E4%B9%8B%E7%8E%AF/" target="_blank" rel="noopener">Jump!</a></p>
<p>感谢学长们绝妙的讲授和课件！</p>
<p><del>写完都不认得「流」了 (|||o_o)</del></p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/posts/">归档</a></li>
         
          <li><a href="/tags/">标签</a></li>
         
          <li><a href="/friends/">友人帐</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#网络流"><span class="toc-number">1.</span> <span class="toc-text">网络流</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Dinic"><span class="toc-number">1.1.</span> <span class="toc-text">Dinic</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#一般图：-O-n-nm"><span class="toc-number">1.1.1.</span> <span class="toc-text">一般图：$O(n * nm)$</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#单位图：-O-sqrt-n-nm"><span class="toc-number">1.1.2.</span> <span class="toc-text">单位图：$O(\sqrt{n} * nm)$</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#单位容量图：-O-min-n-2-3-m-1-2-nm"><span class="toc-number">1.1.3.</span> <span class="toc-text">单位容量图：$O(\min(n^{2/3}, m^{1/2}) * nm)$</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bonus-LCT-优化-Dinic-分层图上增广过程"><span class="toc-number">1.1.4.</span> <span class="toc-text">Bonus: LCT 优化 Dinic 分层图上增广过程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#上下界网络流"><span class="toc-number">1.2.</span> <span class="toc-text">上下界网络流</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#无源汇有上下界可行流（即可行循环流）"><span class="toc-number">1.2.1.</span> <span class="toc-text">无源汇有上下界可行流（即可行循环流）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#有源汇有上下界可行流"><span class="toc-number">1.2.2.</span> <span class="toc-text">有源汇有上下界可行流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#有源汇有上下界最大流"><span class="toc-number">1.2.3.</span> <span class="toc-text">有源汇有上下界最大流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#有源汇有上下界最小流"><span class="toc-number">1.2.4.</span> <span class="toc-text">有源汇有上下界最小流</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#费用流"><span class="toc-number">2.</span> <span class="toc-text">费用流</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Primal-Dual-原始对偶算法"><span class="toc-number">2.1.</span> <span class="toc-text">Primal-Dual 原始对偶算法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#上下界费用流"><span class="toc-number">2.2.</span> <span class="toc-text">上下界费用流</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#最小费用无源汇有上下界可行流"><span class="toc-number">2.2.1.</span> <span class="toc-text">最小费用无源汇有上下界可行流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#最小费用有源汇有上下界可行流"><span class="toc-number">2.2.2.</span> <span class="toc-text">最小费用有源汇有上下界可行流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#最小费用有上下界最大流"><span class="toc-number">2.2.3.</span> <span class="toc-text">最小费用有上下界最大流</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#建模技巧"><span class="toc-number">3.</span> <span class="toc-text">建模技巧</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#应用"><span class="toc-number">4.</span> <span class="toc-text">应用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#最大权闭合子图"><span class="toc-number">4.1.</span> <span class="toc-text">最大权闭合子图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最大密度子图"><span class="toc-number">4.2.</span> <span class="toc-text">最大密度子图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#混合图欧拉路径、回路"><span class="toc-number">4.3.</span> <span class="toc-text">混合图欧拉路径、回路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#区间-k-覆盖"><span class="toc-number">4.4.</span> <span class="toc-text">区间 $k$ 覆盖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DAG-最小路径覆盖问题"><span class="toc-number">4.5.</span> <span class="toc-text">DAG 最小路径覆盖问题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#习题"><span class="toc-number">5.</span> <span class="toc-text">习题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#机场Airport"><span class="toc-number">5.1.</span> <span class="toc-text">机场Airport</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#无限之环"><span class="toc-number">5.2.</span> <span class="toc-text">无限之环</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2021/02/14/【学习笔记】网络流/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2021/02/14/【学习笔记】网络流/&text=【学习笔记】网络流"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2021/02/14/【学习笔记】网络流/&title=【学习笔记】网络流"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2021/02/14/【学习笔记】网络流/&is_video=false&description=【学习笔记】网络流"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=【学习笔记】网络流&body=Check out this article: http://yoursite.com/2021/02/14/【学习笔记】网络流/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2021/02/14/【学习笔记】网络流/&title=【学习笔记】网络流"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2021/02/14/【学习笔记】网络流/&title=【学习笔记】网络流"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2021/02/14/【学习笔记】网络流/&title=【学习笔记】网络流"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2021/02/14/【学习笔记】网络流/&title=【学习笔记】网络流"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2021/02/14/【学习笔记】网络流/&name=【学习笔记】网络流&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa fa-list fa-lg" aria-hidden="true"></i> TOC</a></li>
        <li id="share"><a class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> Share</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a></li>
        <li id="menu"><a class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa fa-bars fa-lg" aria-hidden="true"></i> Menu</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2021 imily
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">关于</a></li>
         
          <li><a href="/posts/">归档</a></li>
         
          <li><a href="/tags/">标签</a></li>
         
          <li><a href="/friends/">友人帐</a></li>
         
          <li><a href="/search/">搜索</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="/lib/meslo-LG/styles.css">
<link rel="stylesheet" href="/lib/justified-gallery/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>


    <!-- Google Analytics -->
    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-37473492-6', 'auto');
        ga('send', 'pageview');
    </script>




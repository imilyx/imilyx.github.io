<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ã€ç½®é¡¶ã€‘æš‚æ—¶èƒœåˆ©</title>
      <link href="2099/11/30/%E3%80%90%E7%BD%AE%E9%A1%B6%E3%80%91%E6%9A%82%E6%97%B6%E8%83%9C%E5%88%A9/"/>
      <url>2099/11/30/%E3%80%90%E7%BD%AE%E9%A1%B6%E3%80%91%E6%9A%82%E6%97%B6%E8%83%9C%E5%88%A9/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="1706fe1325faecbc7f1a29c714cddf4353a6d89444148c199f6a3d10bd27cb11">37607bd7f710506cba05cf6b4d6f87fc10d78e4a73f1c974271870f30cb759601a3204c1f7e0c789f40ed22f9b74bafed42dd4050ab060eaa4f71790a23d51463575de0e264cd8791f54cc173f252b3708d604060be37c9abdbd8bd219a1ac127dfa5ba74483541abf2bc6190bfdc6d8112db19f7aceda7fd0a7139846a096dcd6c44ca3bec188e46aec1ee9a4808906fd4e60be0132d9a5e9b433ceaff8dddf8edb0ad7e85df1b7f8ee1fee4a946497ba8884a275c53779f4653d29519ebb859969c17e99c376b47c4c00950214877094a6a5be51c5e6544aa21c336792e5c7f43a5aeb96f0c9ef2dbca48b793a35f98aa90ea8aa130290b5d910d804170e5dba2b703681917a9385fbdb3fc49c4b0bef1492dca450a2503407d4186c9d269bf7505a75b1bcc377c4417b0e049067e64969fe2f6091dde2e794babdc374b08a1a4edc427764f248179976ee55e6c83d0c8fe12b40546c920d6772f2c05beefb13bb9c5188230e36c4fe910cdac1e605845beb4b98c5cb9a2bd4eb0730ca6f7f32fb3366ae6f52d7579621e0a346da44f01c670ec2f06e1e44c04ce0da71256a1380155ca7b82084d3de262724af4ba8b321ce737ef0e5313946a67ff23c38ba938f802615d72a6dd188d0ff8b00abc474b2285cd55ba72f6642e265aabb2e74d1628ca4226671c0342262f36974c818e99af54fc7f3172374eee3cbeb3534a84422a1c5eb580d9b0108ebe7b6d99e43b8ff4ac72bdf251dea222aa0ec7c95375684c6a36678d8a4620fd9547a50eaca1be957d78f72cf057ec1c4e558f43c3cdb07d59d5ce7c6b74c6f90dcb903f4e92210d2d0b3eb29c31027dadbd12bbd0793adb1136d6f1abf619707405add4075679ae93106a81e943032190adc49d6180c8477b33837762ad5ae5e7a42017455c2d83705ac73cd9fd6aa4d927848dbc2c890296fc03ec0569761d5a560ddc75853511ab24b2d820db0ec5bddecf03b6800409748acfc4710755d14a89b88f22475f991810dd728ecc59f4e87835addea86a003314104160d4885b7edcc08443494868807eadcf0d2899f4446024f4d9beaa10245a366911fed8f649e0b69a78cf967a7fa0d76eb16d67ced91b47ac2fa4fc86878d1b0d4ae18981ca9906b01eaecd0fa86f84c14368a32702c17337345687b70a2e9d29cdb41ffafd6817f45c4b883c1baced0219281e9febb67d0d29d88c1d85a14820915bfb87beed4759a7fb396f6906e1ddc9ceff000b7201bb0b6a3bfc32f4a424b1eb0ea1a22e72970044342264d6045d9d5139cc14c54b59e4db2e0e2a1cf3cf9b588b5cb7da673c4641d582a7acc3addd20901d6c85bf849b5a15489567dd149694ab84fd80433b6d9a2da52bf396f5577a71c0710e64630516c4fa1a0e05af9ad7da9ccf4a3d07f9721a490238a351d620a75daa0090be693cfdef8b93fdcfb54471e2409d694d8c1b961449adf755195735b643b1d7e686412bb973257bbc8b92f47ff42ba43e248d569f27ab6c86d61c05dfff3df4116f30c6095974fab3e60e477fde7a98782b58c65c81468f6de81401ed1121c224c4f81dba2df07049ecac36958b33b5729a1d9635e47dfb28d795cc42d34b400cb20116ca31cb851cbcac6928b3d46baae677565ecf2818074159ea54439c5843c2982f267f6c077901097c9b7505df6ab8ea65f95bead9e86f96c67049da5a2f5b20c154c55f1d3bfafe7bd613cc8e9aa6e4dc0a77798e5af73d660de89235837e822f3fc603b033cca36a7f61f50aabb44b88b56ff9ce0424ba323e49fa6be2280fd8d41687ac5bf7b8aa1ef10a78140565759b6af5bcd408759dd260d4359838faca44b327e11b2dea65fd441513c622de5077a8ee12c553db7c842abbf782a2b1687a756a9527e2fd69a3d5725235b23fe74737c1e0930e6095181a039da661deb5f0def1bb37549b8a99a468bf3ab77bf65775c7fff2a50c702da484d9b40d317d2253f2687433f1536c3bec11ebe0c89c48d12eaf88ae140b784919e4ad5127720e3163c962684de36edd619ba24f531659d7eb6030b4a64e5fe25a2f78ea262f55639ae7a4d78a4e93bc7c6ecc97356c12ce191fb931f775bc3eef499c61359094dab193eb5df5f0bfb646d677136bee9f895467a0bffb9f4605427278d4f9eda45f829873c65f5e5b141b2e62e8b0bc5a8e90da11064421d612dee9a8c75dd5a518b5981b6f10142cc0315ec2e0c9dc194ca97c14e89a859408088b6956f415c6712cc2f463ffda6fa4e0ccd99072d2b93cd7a0473df37c10fb40f5da58b0a6c20257ba2f524228790625d2d075b9d1a8ab0f7ab51ef188f866761e4f397be3a81baecc92ec5e31ec8a9e3c4f26735f4c01f5079b4a9f938101b8092c2066564592bef32870953ee8c3f87b5c9bb7177114f67f4471ebcad760a4313e9b72a4e08f81271d41cec48d24612c772a6007a55818ac00f63b64768f2cac37d321346265cb9b6c39c520ce749e9929ae0a533edb82af2e6ba77720b7e9cece98c0852354425547655ea9f7eac5909f95d006d6e17be55c988953b51e3f78886aab6a6d4bc58abdd3722237847af0165ff953f28b89ca82383562d1f0131875216eea21fb0df81dd0c64665b0e61aee362b2bacb56d054e875f1f8527bb34f0dcc72b138c7f99b056f4a38d07f44f7be56dcf9db05a3d1e89c5c660212574badc73e4fda7392444a4bc5374cc03dda822431da615e4542cea00af8a7015296b806e3029b6053b5ea801e24270ab0292dee9561a3118a2c5f70f46cdbf095e1d2390c3558b9aca0835fb004762b3cdf160e12b95f7bacac5287a46f247d2e1988dc75bbb9858593825adebfc1d1377eb5db5eccaa5546c09b376993ae1ef3372f7fc76bfbae02b8ce66252daa31141b743b44b4c6295d53b5aa806fa8dae9371b4d59ccd4a1eeb80a46da93f995a0fa0a0b16bd1517a8c4a25f965c97adb2b4fd331af31f8f3d03ad1b2db83e4033362d9f5dcc99cbad86cdb134edf31424e2d0558c9314c6333122d9b25caf9e2a7230d1027f9622040a342fc945ef5f83eca0e1b82d3df44029adc28f6dd588b036d815c3b54e7073ffdc552ae884f431d64e24c44a8640cae7b60f66afe2929ed628fd7159b50c7ea7d98c30f021d31d378b39ab3ad71612b21b963cfd47e0e5ed3464e6e87eeade62d7665eb23c9c4eed3cd1184db7ee9edd415e00f7917d6d0ea561f919b5cc84b810fd8ac08597150254a31adee68f98a9f2807f4a0be822d6e956f21e894fab94b38bcbe42f11798101f1b3692046a21dc22d228a0f47deb2bcfa8f41795c3e95e80c8f8dd57d18acb15ffdedc09c60f4555405e5a69e134e5571ea3ba0bb1e15cf319c0b2d8bf7a4777e5ac6895eaf873c786fcca26884b335f525a02e1ac82f0d1bf59394d98885064a6227c161da6207072379e09b892d1475d131906cfbed10418197738c2a79bac0174a83f83a0dbe264db780b381d4f85bcb270cdffb2c7f653b28b42f55e235c54a0ca3b613171a68d4c3be9b0867b87ec92b92c862192b94c14ca3dfdc60199ada27a2a55e7e87d5e12b46d4c635299fea7ac8849f724b71387f26388eede01095d3c25cae3e4471ed26e117645b336ce7f7a7bf1ac9b25387d2dabf930ea413f87764d253a2fa55442627c08db06a47cf5bb5dc7739a0ed93360981dd495693f3e38b167d3fe389aac85305f52439e153a3e38a61e5c00c3807f3731f9643b36e59614c7cd8e25e26bcca1ba41b39b07600065aba3981f9e0a4d28dcebc7bdc6dc1ef2e7ef7f200dc0a61d7b64bb084d93894612d9960d74dc601e3f6cb02eb46eb0b582f82650ce059069f29be8125893127e00d4e0cf5e618d36569e2762fcfa5572d4129288df2944bc6fea8daa392b82cfeb04a7b7bda146dac8e17ac7660b2249feb1d2543354bc7e39298cab119ae477da21d92d96a7515247888ad39e18728d287cc15de6e48f23fb77e82cdd72c3ef31e854f6ae43ba83bfbce708064b72731237fd1f9590f8e6e4c92ae72335e9ba30bd9faf8ad1672893df3a8087cbeccdc59465f2a735ae462733cb2bb7b8e44cea69120849b5e18784215094464a8559088a96c93cd917b275d8877e72ab65206b218f6056e1307c86c356f4d43ce834c9d0ec287b25f3783e38739f5dbc7c6732f166b9b29ecb8e28f613998cf709c00c188572ba90c0f126e47f8ae9d88a3ec12b4d7a95d0dee3f5c4197bab5c630fb6fe38fd6d0555216f7d86a80103fd1c67582324ff7e69e361be1baf0ed722705a007ec25aa981e1148d0ac9ac8c8f2e1d3c85adbcb9eaa50b19c4dab956598ee92be2521f9c0de18e2bf0b4abc728aa573b748baf27cf3d22005bd602584b3ab2d0ee7f76cd6480ea3efdd3843a806fe6732483a2df46ca7b06ff5a79c2ebd4b64d553bfb68fe5cd949ee06df885adea83c9bdaeac14bf69629934447b19b9b13ccebc61b88fc22c81f819e292bcbd51d212465ee99f3ed3c51a7752930c7a9fb55aa0ef4e1be6b74da14d74e727ffa5f91e6d956ff6681a0e0d29e77997951514bc9c8c3d5c0b1b32eeb92a5ace9d8e010970d2820527a8ed9e2e51a9689517d8e491d642aa4978b5eb7f37630ff2b5b49e0963b4b041b0842a2f5a12d7357b3415aa6d5f591ae7d005eed760038b4951435cf7202e34d034a3e7d361837ddba5c7b46961dd14f8a3dc8948e127a08e799e9d615301523f67326e358f0acf91cfa1ba909962e120feea554c63decbb6a415a9ed882aa1d0fb000390095e5aa8f01e3c2c1c2ef662a4bfe80e56265011252a882b91b957a8026d64138ec8ae77dd086a133b11c5187891c894e52dcdf4680644334f173a6cf09c2ac4bbb61f3f036a6d42af74dc10b1556621af7bcdd89d0da2be6cd8af81e55c182041bd3439b0b29be93bba6101af0ed8a032937b85026abb5cfffa1ca5d1e297a7238dac08502209b5a755ac2cfcf5245456a6f45c18a8e6387289c008235a39a5e480f050fe55d1ddec2f0b2be8d3b252f4ac5d4f859bf036f351df4e20a656eff0808e610cc069759c9cc011b0c434b49128a94d423cc30cd0667ffdf65471d5cafbbc5b68bab2706b56e24aa9035f366f84ab282718008d706d6f809f5c4a610b1f2ba51d302313c3f2dd43e4c6f35cf2fc824128f492f06273b7bca2b9b673cf54f63663bbab892791ad7a9ef260077a1d609efa0b4f0e3f5fe08cc27903363137e4874eaed14878408cf2569ea7f218418886b72b3befff4ab26cba417c574c07439f0d812cd574f4999f77ddcf0c8e22b25967915bdd5cc51a79061ac2229f65c629fee52d37a6ba997a7583fede4d05b4153a40fd2a18ecc64494a88e1b6942c4f75760ab0e268a0d934f2f0694573ffb38a779d27fc986004495daf9b2ced6ae7056ed7ce18a9d0fa9c7d0cf872b0c8fb40e8b0574d5dd59b93e3c1c03c528f941a3a3a5e1c494fb6b8b4dd567d15ee1e4773bd95377c9f724ee4b7a0c4c202047c126b5de566e444cd8b999258960351808d492fd304322afec0a8db3257f9069779fa499cbbe2a7fa820bc7e15107aa078ac8f65dbfedf0d0112f5daaa46b72f7d18491854cd98eeddefbbff08410ecbfeb8ea1b6143f307dad95f3e7a52b90055e97b573c0d6d1da28b8a1a0dd25fc6303a25bd066c8836f7099e5fcc3a2fca14f0b5405bb13ec7112cda38f4853d43e8e9c70f2b877628abdf5daa26eb3f0d79d5a3d22adff5cb3bebc80d12016ea1015a02bdc57421147ba40c86297b3f174f85480703f5bab210fdb5af817336b9bb8a15c0034025feacc0fa538661af651401780a891615b129b29c62bb25960ff08f8c830a484b8a148cb8499b0eefb4f0bd3fe537a8f0218083d9705529450f289ddaa141cd4cb31df2e32da0b944c77627d2ab3e37a8455e815290dc6594bc1d23ba5a7f244b68d622fbcfdd1bd40777d1a1b66b8c42a80c818b91adb2aad29ab2dc485ca8351fccb94e09b6470fd3ac5cd218a1474c8f027534832441ebb4850c779eea28c6990e85a4140b2505071cb3fa4a6635107f5dda369ac6aa389c2336a8cb890c48990683b1a347efc605a32f67533fdb480bac9de37108dc82b9b92cadc05bd7009ff76651f93e4b3858fe7d9bdc26c9551d1482f8ab296c7ab0347df087c00ea74f9dabffdc21fd076907719063081f3dbed177bcdbda9a03ee95f7902b992791edd0e32d68313dbc98d9780865e4733fae732d74e5f3980e0670fa26b9e4e39893a3e92c4a412e99b34079b6a64be085d84819b69a7e9bf53662ba29cf78b4ece52d345004c8b72693f2b88bce822f929e1f3767120322c2731b3552fe6f6dbce164ec86e208359a255d41219d95dfa9a29d9c5f646b0df4054610e7d742d40e713477169bd50d712800e27a7a8592f3e461ae4cad8b8f264367918b530a1f34a1c11ba0ff026cb39292451edd31d1ebad01ee793475526709926fa86cc12fd17a84492ee5ee4dc6c4295b2fe7cefb542ef8a4057fd98b7f2583e7696c23f1146c89413382e49a152d483459edd44198ea8b41f368334dc063f16c82cf40a42ea78db6c01a93169f91d9df60ab8552ea9b539c8c2c9467e9bcadb5b7da0b2f0b748a612c671f5952d993d74b54a9fc7d05fd627ab4c548b96d4123c5b59fe149caeadc1be0ae707ceae4009e590b6ab2431d27ecd1d60d71b56f4902887c2336e9b9fbc90677ef76c0a915c5a1f79f0ae96e63510f575c134f449339c41a90a25c4f10505dd223ac6362fc7388f917dfe1d237754ad04fc123c76bc70c1745fcdc5720d2cd94d72c71b57833fe0ff7dbd4f75170686af292a1ca9d9d445720a43d886ca63185856dda78943f277e04660fc6e2c3eb184456c58134f7cf4c46272fa4855a0876f0eb193dd00c5b43677872c8802536faee61fcf6d87b2771fad821ab2d630032f8516aacd4682cf578e18fe116bdd6cbc3bc85499537621464add3fb6c47539bdb378e3417e890243c84a84083ddf3fdc3b8568f43ab5362fc7843071308bbe6611716b1916a59b80141e3c3a5188bf31c05d38d177e48a762dfa93765e674bfdbe28ffd8d7c007f08415c9f365de5408dfb1fe3e531a6d41a78f008f0cb3656309ee472fde330a78c2f9ee5876926116556fc56e50b9605ef9d2f769db193750f5b01e3f27917052fb13caae23c279c4bda09303ad7f09cc5a3b9cf344bc8ea43ea1a323a586c7f06e7e2f878a0fd04e0de8985d60222d9c68fefd0172d4504690b0dfe188f1440b53816ec773d262feadaf3b8eaba6baacb166e8f6c068d8744c7fdeebf0bed9c2524226fc7a93562ba3b75b7f9feb9a35567e31208250bf25be28df58aa4f067d91bd74d824ecdcdab81ec71ef1817fb6140ec1ba992a8c7f8e837a9f7413e10636fcf9fe2625474d3ee94307ca7c6d6a213b0d53708cf802f15bbfc021bcc628ca1e9bba485e3b19d1c86cd6ce34136473c81dafc848577b6bfe0e6598c02064b07a6751a8e855c876a0e3e9cf26b2b69c83996e92323d22a58622e46824a0530cd2f2e41f9cb4c2296002c7ef70181b144a892324919ced1d8ac44b4d97b3af7745256defcf9c756a71803afac42b96d979c0eb6d1931d6f0d18a2614486e960110e069989a1b9075375ec62986bb92b2d132fa4cb923c1c861ff4666904229508feffffea5f72e738fb84d75989e034bc7bec76f4fcfa2e44d399cd2884125a89b7a86e782ab0c6b997ada86257174be81e4518b7b92a9bc19cc6b14c366d73c27ea3d1a37ceb549ba938a5ff5adab6e4251478386f9985ce8ffb1eafcf5645efa92e82c66718687ace005279166fa6e3feaf0f34427c69d550e71b93a1ebc2859797359c3068a14b2edf34237abb4aa03bfc161fcff0205609ebf454ab7e2b400fc87a048a6352022f08330352298804e9f630c13dd11c4f9f8e5d01d4df7be428b6db5fd5b8194083250b07f0fd8baad89a58011ac0abdeace944a575993216ecfbc79b3ad63febb0670c5ae3de207b68b594431f65bd1946398dfd1ec756864bf480c6e9d0fd097d454b432e6faea210594f20d2add19d7619bcc5efb95ad2426e3711e45ee6c854777fdcfeddb68496a9c94143410a6081113069b587d3327abfc051de4f95ae41789deffd3e1b565d2318c439c4a2704101ebc5cf3828ded3dca44764d3f144bcfe0a35e364387704cd13d5618d214f45e8b49bcb296308c7ab95dc148b3addfa12d834fc95efee6b21837324d78a5c8610eb8e095386484707466f46550b9b47b8adf09469d73190996bb4fbb15a560e4d1c11e563658dae1701b5c9ac2f8bb6a0ab0995463a66cb161dfaf4192c7503dd3e1075b51799778945c81f319646a92d43e92d32329dde2e506b18d1189b08b266ebffef68f5f32cd312b60ec701cc2d97db9c3d32e1c041283224aabbb1b3f6c63f500e2eb8bf5835477b93c9dc14af35edf9c386d5cbd7c500be6503c03dfabb2246fdae74e830de45f456d2ea8d363a62726c8d51fee595fb25b3b48469444413498fb3bce70fe807dccee6ec3cbca3313180bb4f064224593eaaacf78e88bcdfe38a92f387b49857139649dadf763f040ca058ca8aab500cf5ee21df4f7fa52a27299fb61b059b45e6c2007f9b84a2cd061767c1cdf4ea91f805e8367fe5fa7dbde8059347274fc2d9b239149750131ea7693cd73aacb86267a6247e52b3129612ced34edef8d553598e2f7f224dbccd80399dc2246f8dce01bf6c8834ae9db04c1d4431543c5a5d99993f2f8b747c36ae4184d2f838ad7ce05594b92f4e2dec6634b3b32b4b3ed8dd2abf30b1cf1e1f2c66e9ea59e977c200962f5cea935dc02ca4c9f2abe612381ee968b4b2eb1eeec20d621e14fb1ddf142cae3ece8ef1161c6ffde3825b2dff539da839cb70d828b1ccfb500b79e59ff1e2a8e1963c04e369d4a1b85c0e292b345f9fc1b672455af571528b3334b046efc829c35009ab2c4677d94e21062c09f67c367712177ad2923713d1a75c2a51aaddebc731b6c0237719d5b0db9f85925a03043197aef679f8ba07b96cd539061ebd2c029cfdd72cd16aed76e435c45370709b77bb96de6adddf6e49f62e17429eca47cf33af2d55f5e69056f1670420e67cd879e14842f0fbe79f4849707acf0856c4f41e4ab7f73be1decd6a2863009e5860ce6da4be4f929259a714fad07c04b1c7336d7c863d3af0729809d67dae123c70580715386a6bc1604965ebdeddd7004d56790e9c790279209391985209bb49fe164f3426a8f3207ee2c459c031ee188a1f63aba1a1c6195c7a6567dc103ceb30a050bdda35132c17d99188e42be93e3d4c528e96bb944dcea27b581f9994018581b4df54a418c2d1c5c1a76760f61f9413e0392e346ef283c566c7cd810d5e43c39a988671ac8122bcfd0594bdfbd374e8f906595232986b2fc2a7f092dd5fa1120ff820de9e32ba5ed52e718565d6ae8461e9212b77fa2fa7d8ca51c1244de7d774c15022122d250837b465164a8cb703bc29b36712d976b88d9e3d691d4a7654fbec4d454ac409716c72d9026afeacc5f568241dbd7412ed442a5dee59afb5b755a0a13bc748b871ccbfab8667adda9c37353e72e912774062659857fde5137979dc9575a1ef49ea72447cf8434285b9de19191142edb269b6af1874027d4ea26541504df7ca8815817665da108faf5c45bb03052f690c53eb119ef6f79fa960036e53b9341b50de1f3924565cd20679cf4f7be395f41b975b9ca7570a410a580a7c8c5e082771269ff4771e2b91886c55754266f8899798f56e25f250ed99420c191a89dd2c6b1a60f4494981750507dfa7fe5e850e257b7b00d59d435bf03ef35ed0844d3633cc4f4a9ecf9ae504217dfd95bee2b9ea22f52f5b7f7e6e3360c1b0dabe92c8093c0309d66e1981471c7082a029d6b3777c64c57c6a595f8419156509f13da674fb9fbab3d32b81423e7b3aaf36d8efff64e00bf02d9d93d9a59423fb68588ce853b965fdce753e6f3107777f5f29999f0f65709965d6a6fb83d14cb5e58a266a62b33b9f7003eb7d52c04a937beecc48f5cb704df722b7235b75c198206bc2ec4ece2153a007438145859f3440b2a9bd09f223fa58ed86b2486aeb1e4b1804cd8a88e51e8fe9717d184c2569960ea694f476da650727f42dbd79809fb50068691ea1d13329b6f98bea44482808d842cadeea99a9457e857705cee0faf217c3af5e16373e0a93c4e7cfa9ec10eab9ed6c2d011cb58d88195975fb2c2bd532d17bdd8e6e33856fec6a307f936000bd84c4216979be850f8cc59afc684722522ede85ae8787e99740f3dce6236ae7a10f98ffcf931fc89860d863cbccf7e01ffcbb6077852d47da3598739219a60484579ed269e6986ecc73664dcb53b0d727f408326db1c281cda06224d736d3b87031dde43a4f8e50c88c1fefb383b2915be40f1ad9888f9a350c9748da94fc5aa8d7e8f3795025284b65a996a6a456e1eb966e2dad471d668fe7693757c16841278ddf7702c3010fa0da42ca115ed1ba41d4a279bdcc643dfa5c4666ca7711041392782ceba29dda6baa86e37839feec0c72fc56e4a234be90f0427e3f17fa920ca77d0077952756be7d6f4eb3d170c9e783034aa46690abe2c5c061b4433bfff3ec0b47abe9be7926bc1b6b72b461a6b3d2d4556b9f79b923a5cf6fbd95747e7755145b1fab98a13e8618a83ddd879769c82e7c9796788d14edf8ec8b45a9044ce0aeb2c7b1cd2064aa844df7c281d97382a8a4b9be04503eeaf26b30ec5096b37f1fc44722e808f48e297b63cd1a6f2a3f367af808b2e9226eb94470c23f3b4eafeb786acf4cd71270192abc5a3111ae65ef61325974c2c2b81dd780079bcdb992c6208c04f904d409ac4e085d7b36678c020a907a25c2a061c58fa939291bef3deb405aaaf7aedcc05241d9f1661fe0b6308b185fd3fc7b140794556bd9808263c6b81d4c5fcdd799a29bcb64fd5cdc4720e3da22139b821cd858f8d8f6bf33da5b5f1ec9387c6600115d0e42a9048b9d10ea44432c8841152ba3ea0b8323be596dcff52eee8f75abc0d6397c3330a5d814205c52ee97107f1f4d44e35d2fc960e75b2fa3dbbff1f539c98a4a63803eb32ac22d55577d11db1eb4916438d6fb41c1886c857c820895d34489dcbdb056daabba249cf76b28f954e95ecbe74d3a94131aae077349d12731420cf1ae132ad4d022ea790d27ba4dfbd0f49854199aa2165be18e49e4c3dedafbb6bdfc094cebb40bf839e3273f3a4b6094f165f928d1c2a2ea14c424f5f481ee5fa43058b51b70b95e063cc3c85e3c3b7a09f2540abe7f21d522fe9bc487f9b52174e51db3e45bc0e346a3a5d237497938c171f2b6d2b587e8dbe838f02de3539bcbedadb516d906d8fb44eda9ebc623919eed730cf7bcb57dee04861502ca2d7bd0c46f76798ca37bacc47b74da6259c96dc0788cb6a385028de15a07f73dd90139e36d7dcf01a27a8019f192ed3006a42b3da9a04ab5167a26c12d56490a115b24eb89d4d76070a783ff152ec498163b8aef708bd3295b21f6e0a912682af75512f06114fc9481c07c71b01632e57828c2a65134e3a561b35bcc4bc3c8a228777ab37f84d1c1295fb95a57767d849237726bedd4d591268f74f24e425bb42ed313208f8d2daf2a4b86e4afec5869b1b190fd897fb9aa6ef7c488bfe0989208313ae2a37f90bc235dd66354300a799c656d50ada28a49cf00e4cdcb9754d017c6e0e5ea4fa98673bf2a5f60e252a62e31230935a1fca603d5f58889dafd079af3b592d4e8c40239640200369e074312da64eedf0f929627efcee6715a025f3e72246bc77b21ac68dcba4079bce236bb31875a0020c7dd001077bd48e2018a273ac8fc403ec645138208107b7c2f4b8763b14113e1ab44f65c6f1cab84ba5295d7f5481a0a94df1ef9db435865618e73556355bceb79fc7ff7b26ab3398c8d4b4feeefcb573f0d267c339ad6e5ca96eca14233fa3b350e4d06810f53a39939f2c126d0aa83984cc5b20a275c2d8262168baf67d3ee4633111c94de8e246fe9cde95b49f3985f3ac23bded9a19b35c79a965380c56b32d36c71a9e2e21d0bbbc0dbcb75c5c37e109e791e919980338de26dcd6bf602f4a6b700173133b1eb4b1705372e62f2e5b97140cdaa5f2457c8a663a5242e6672f8fac95e27678846157a119086f1eed5859f8f06c390f630b049dfceb9dbf9c8c5ab20a9848ebeedf52c52ba8b9a187513fcc325f34320d8587a2aaab0076d0e34bb3f5b1883316f4707aa53cb5cdb0ba43a60b6f2f0dcb4b9deec05b166a9e5f1f5d8f5bf7fd7c65e1bccc63f8b8ac8237ce42d786f5dc5ede3256dc1c46d7dbc8497eb0f41e99f723c7ce1d4c6a07a95720a1551eb66859a0711a4d4d22ecc279bf02d8628738b9b8ff7bf024dcb47411575d1d2ce62b9c70ffd8dfeeb2815cea450449b3ff0dde6324c9ffebd77b527abdbd856d15afd2309f60c98e6185959f2186e20c4a6d4cb4fac2af8ed380adc7990e4f3388578d0352e0a353fdba40e8d52b4e5cae80eb87684d7765ff8eb6dbae84beaa084474b56f1dc920b30a77d488bd2b93ed777e6a0f3aec49e70fb3f332c46076fefdaa2a5e3afb5a14a0d41ec2cad1b12d62edf12873d37faed776307bf295a21d5510e44edd7a48860b8477d5b2e1d04582f8c86bb233fbd0fc00dd2c939f5e9865ece583a80fd5db48ee0ab49d4dce65e6bc2e8bdff5728b45f1b1bcab6356d1e2138b64496dce861645d4a6d31fc2dbeb9c5ead7eb4f95bc3bff5410a0e33f798a5fc018b3b9afcd16fcf56e242ca073c08883b32ed138fa50d89042e8e73bb21842e2350f0488643be195f27b9dc9770bc233c1c2081663ab0e15432e5b5e0e935f432056768f014296aa76c1d9c05f79c5bd1356cb6f7a4050125c7fa3c21f61645b072a5d6114e06c004fd566afb2c217c04a1faddaf4f638f683b34422d5827fc37cc1a6f391b15cfbcc69c3dd7c9ed5dfba9794ec6e60befd8506e225f475a0360bb36808e0c898db567dc46848dcfb4031b0a6d54931506513f830397d2a2b010eba0a329ccc39da070270ce7c6b0c612205cec9cd9a250d5e4d3d684f0d28d1ef83d35418d339aaecc8becf60e1000956d6080949cbfaef2908581f76c2ce82ba0bbff1ef86538e761214f2d8d79ce6e6990edc9bfdc86292ac3636ee5db9c447006fb8f75e38ede5a01911df5638dde550a7c9220f05e3b18895bf8cf6e89a3435b53c6dc716edb5ba1239585596ec00fdc4663c7a1d812aa1dabfc054d0208826ead88c16acd40676353caf7c6afe28545043e2a8fb40b583f059a9055dbd3f847f405e674d69095e5118141ac1fd20930b2581a7a317dbd4c14963f80d4b14e7a5dbf31506ec9c8daa398b9d93390c13361258068eddf83eadc2d69334c24a0046c01387f0531f3906a5ef061ff55b8600d332ba9a658d5f3adff07c5e9a3564cf519cb49ff10eb4b8510e898a08c9fdb7b194e7658217fa792df2ad434ee9389d0364fec10a1adc65e3d2bb4b1f6263790b04b86a222caf6ed8ac69c0c67b8d9c838e13f836930a4d63583ac8b1f0b63d849be95171f1fd61b7c28d65655d071db2977ce21236b9b5ea3183badb81a6aca16b6022090d8f10ac5f58201f6a2f1774a563825ca78c14fbcd041e0b5304fb927d74fa2f598f6041d4c3c996bf232a1e4b0a73c146e63e66586991a33095c1ba4d25c7d48a55ef27f153418af8fdf1075a2f6db972204f1400d8594a04e068892604a25c78f58a7c8f24bde45558a3fe9ada0cb62dd4912b9d212487a699764fa93284de1c425d169b8bd36f2043110c4c79696d6548f1da4290ded2a3480f9938f7131d7dff5053e3a8cada6c023711bc2f69a03d1daf3b0d662f8c2b425cb6e96cb2066b586151f927f40ee2d0a52a33b8e06ad328f646350ce6a11f192bd46eed7d461ce24c959da378c071a523286e6d05151d2bf3aa1a93c347af9a747958d63b98152067ad4662f4f3a7cf5c009d9fed2a2ba716458151a45776d946f3fdbabdefbb8adc5e61330818390b494cf233feae49dd9957d87cebeb1206b7eab65d5c9b543607895719d9eae609066cbda267072e2455beb61fc0cd71c57bd8943d70bb9f64b3e532f71971dbbc29d3f915db8ba611f49ce448e9cb09fbec97bba7edd00b40b139fd588509f861edd3b7cbb288df30756c5888843596059325eda17fa84205933b4c4ef4c1d4b03a31b5b9e0a919a3215d84c9d7f311a014a61739f6f3384808fb742ed56dc248b43db7b09d0925fa3694a77dc78026c8e67fcfb208318f7c1a250a6e83e4d26f74607cae3ecafc43dc7321197d6489b5a797680aae2024f8ee7916427704834203b8cbf7eb378da20d8eac05e522bfdff19ecbb8ba63f3220b45dc16202fd0c4b574087e862100bf7f165560f30675aa3b020855347119831fbf5ee48fe619c7fd80def26c184ed1017f66ae623b04e8e66942a0a6a5e912c03fc2094e6e517b6fd7828ca1c41039080ea40d2e70fa7b0d5c86e67e77ac26aa5b241472c63c994a5ebf614b83f9fa506d49baf872a9a6d5070cc71f9698b60b6766a2f443d15bc4b3d6a8541baf893029bae49363dadcd97d96b03bf3d1ce5a72c20aa6cca72abafa4334ad4d0ca1f98c0270f41e50812aea02ec45e7083a5b5b239ed91cd6201bfec01c59195f64ffd25dbdbf11e2554f03919337b700671de7e6724b4f40ac4830e3ee98699136ebb5d337d96b5a7d33e6281c182eb5859f3ae026214d20346fc5b8861a8089b48e04bec14693948754ff1cd9cfeb001d66b62a1beac6cf82effc33eed8e31b2624d22e021b1f7b7b22168e731d1b36b1c69a9ad57f8ea04e3e5e07764bb4eca9ff3ff64226d1093addd3917725d749e5815ad35553297294df1d0c2a0615873cf5d6a0bf4593d445b1214a80bf51ae829d7cf0db51ae0ab5774f1859d8c836a5b0cdd577f450ef33a3ab01b759d4f65acc57100e87a648f235525abac8b3be397daf3ee9768db2b28a93585726aea388aa49b528224eb9ddd5e6918e5a3214a45279920163e66b693749634639befea9aacb6282a835d23de8b0ffeb34df52dd25a893621b464d4ad807b20510850ca1979659a527b221bad0655c7c977bd21a5807666ebc0ff2808bbf9d9c57443c3d4b6ddfc84ce51ee50c9d0df776ea0ee12ee94820681cc7c82c7a2fdeabb5ba2780239abb58fa1e80d35a4f6bde65183c6459f35fa4bb5881d7e6f3130585419a1f60f8a53bb595123b52b9d6f1878fbadf02db42a65cb6ca16f64742fd62fedbc73282e5cee5d20642fc05b206368c7a762786bf0edb073c197c020c97620ed40d3f03cc091a59e63c34381f65ed83e1dc17db905190c0ba07e9874c28f0efda91856a7b9889cf02de227abe3025a3c8bd2de8cb3992ce60dd82230a891a0f603b4c12dc5373fc970845c3f20f68bc0ba06c015af4a91ff6079563698dbf6b098348652fe4f68f1b545a4be1869ebe931921d03dfe2302a77334babb78470d784f2df5ee868d26f37053ec969b66311e36dfbc341ba6348839993419969d04353684a7cfe30de02032802131e3bbbcd73bd1f84b7b1c19903b48191a6bff6c7104616941e393a7dca138e4f339b9817f917e855b65e0607ed6d8784807a95b5282e05739b5662eb03e684d99cd0e3b6afc0afd1453bae00612753482e1a40d7d2e34289224718fbb7549961225b516f312fa520eb7b52c855af52f947c25cf425db0f879621a4786c16375c11efecb424e75f9d6aa8d49963a4774736d31fa664d4d1a040cbe8a429b213f258c42b3c1b31e83d45eede67fdc2cbedbb3d91b3a76429b30fb2236841ff51ca81d5266d1b06c13d9c6925c56318ea24228ee2eb0231737c0cc01fbe85e192c69f9b8ae89c2c7cbf2767075d5bfbbfa63a0db8a989580b46165037cfc6454b55f8ec5b068a714c5b68246788f060b9231107e7d6a4f6dd0245711ddf164607b906278fc4817ef91fbf44aff07adcc06508134f263a0233c128de52b51cce00ca774c2a541240421772871793127163994ffee42ead38fdb9fe67e52f5e285c4c8e02c4275d1e5b31912a3bd62e4492cb3abaa9c4bdca6257e2a9a55deec7a7552faf32865750d4d0c5e17f92ef772e9d332463934a2773377ba7fd145ef44bcac6858ff529e40c24ab2aaa81f7977b3063487fa5b2dd92c337154d6f9df8c1c78e6dd9f6991f6e65e9920ce17ea1106ba1ed245c4803619045ab0551f9c65d5e7797577d633c60b3dc73aa21576ffbe68c4d8390f8555b19738c7aef5fafa57a9ed4007fdaaba1cbb7cff5188509b5202a21aa5a39fcf2a982ced827479122b08254a98340106e864093fd1bc755d30aaa0b3cfcae96a1c2b44f4f189816790c2f86a7f44720edc47c6dc0d51e1e06ef3187837ee11c3785383f5fadb68c4864eeaef783c3ecccb1a7ef7b40d094d1798bd860aaa6808eafea34410fdb25fb6a178dc6139da6861a0197dff93b1e485ee90373998da252978c543ffc49a0c175976657dbecf4ffe8073d3fd405bb50fd6be0b3cbd3f777dd88030b219847d2b04a6c1aec511dcc2fbd0a26f77e5022f299a09021d22f7cc36c4bd4d1da2e4d56022001c6f9a6f3b186c082a2a36d59cc5930fe4d12ddf299d0ff52441d938049f103e791d944b9bc5412e2cd02ec728fe723297cbd3bb9320df77c46135e7294d15bcf13c001bb0fee38a9010949eab95a8f38ba5224069881ed145c82afa2ef40b1014cca54a79b9593d3d636b04d53d8bdd5bd7bcf87993feb5be95a0ccf5906d655f16739d1b07954132e5a71966aa00541d912f0538f2e2f9978a7564db54978e24116e86eb38c4157fc97396bb06321d42ed588969ffa6f774f63f417838355e13dbdc6cebcb31fad4905245dc3c44999a3c3ec3a794b8ca76404a63a837a0c97f783d0251b5a902055f02a6337f06b8203af468edd2028ef131a957fe74829cb938c8537eed4d25b7d20dec16fd4fd68522114c571031512e544fc5fca42a241e5b98333d75191a9833e1f90c268f1f4687d08ae240c04b3281c8bfa2679c61d683eabfcb103be2a4a4d4fb31ec3e7f6fae8cae6043c4e800810007c0f07a8ef308546a17e7b2d929b3bf9e15dad6c24c5d701ec622b561dcfdd86bd1c93e1cedb7b3def4a1e66bbe9e1ebf401f595bae1400011d1e02393e8f659d9da81fa9841ac697b955ab14973764eadef1300a44a02dafd919a359467e25d197dd6afaaa631eae93ec04016a4dd8c49df395ddf863a7bc4ca64717b0fdc6214d5db4fe1edf42fd9a20977a18550b31eb68d50ada829457769f6e14527837f245fe5c2f80bdaf183f637c9b06bc11950e315b595cfcd125dead2f7bc449824912a27ed224f835292af4c7bb53a8729de2f787e9734b07ee8059ec2d5cb8eaf7f4b4bc9452b24d135ae26f02f0b0ec6a222f440c38f216798eaa19f6a64940bdc7e29b02640c17fe1b3957f8c8b9ef00bc981a20a43b4a790a4ce2a02fa46be0818be27ea15b0bda89e009d02bc51c81a117a014307c6936ab34c88be30f7652dc3fe3e94cf6365e88327c78be30c471895aa4a5bddaddf3096c09f710b6f5cf02c240a787cd67bbff8fb78c1f1c9fbb1f96f2d24a17ffae3f611bf4e607ae00afa2fe61eeaaecb3dc349e6d6b02c9a7b3162a6cf1ab073159a7e00b50f040885d30cadea5e68c8801f7200096a593d00fd8f2f7c8ef3a70ed2ac690ab0f7338de10657b495e1ae65225e3d753bb34ab7e41c8d06428ecf39ac61f1080c5a46f29f5f81e31d568c19f63acdba9c7523679fb1a2305493dcaa0ad6d1e9ca61fe97a75663283068df29fd8b5078e093c8d6a18b9b5586f7947353e183e23c721ead1ae34540defc8fa1fe259693220a0e73ae551a432d0c929a9ef39afad270f22de67bcb872bd28441a646428191b088df5b16c21d0d56d4340d4e6e33ba813d6f469c4f3350c3de94a</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">Hey, password is required here.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€ç½®é¡¶ã€‘é”™è¯¯é›†é”¦</title>
      <link href="2099/11/30/%E3%80%90%E7%BD%AE%E9%A1%B6%E3%80%91%E9%94%99%E8%AF%AF%E9%9B%86%E9%94%A6/"/>
      <url>2099/11/30/%E3%80%90%E7%BD%AE%E9%A1%B6%E3%80%91%E9%94%99%E8%AF%AF%E9%9B%86%E9%94%A6/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘è¦æŠŠ fst åˆ†çš„åœºå­é’‰åœ¨è€»è¾±æŸ±ä¸Š</span><br></pre></td></tr></table></figure><h2 id="å¤šæµ‹æ¸…ç©ºï¼šç‰¹åˆ«æ˜¯å»ºå›¾ï¼Œcntæ¸…å¦ï¼Ÿlnkæ¸…å¦ï¼Ÿdegæ¸…å¦ï¼Ÿ"><a href="#å¤šæµ‹æ¸…ç©ºï¼šç‰¹åˆ«æ˜¯å»ºå›¾ï¼Œcntæ¸…å¦ï¼Ÿlnkæ¸…å¦ï¼Ÿdegæ¸…å¦ï¼Ÿ" class="headerlink" title="å¤šæµ‹æ¸…ç©ºï¼šç‰¹åˆ«æ˜¯å»ºå›¾ï¼Œcntæ¸…å¦ï¼Ÿlnkæ¸…å¦ï¼Ÿdegæ¸…å¦ï¼Ÿ"></a>å¤šæµ‹æ¸…ç©ºï¼šç‰¹åˆ«æ˜¯å»ºå›¾ï¼Œcntæ¸…å¦ï¼Ÿlnkæ¸…å¦ï¼Ÿdegæ¸…å¦ï¼Ÿ</h2><h2 id="setï¼šä¸èƒ½åœ¨-it-çš„-for-å¾ªç¯ä¸­-erase-it"><a href="#setï¼šä¸èƒ½åœ¨-it-çš„-for-å¾ªç¯ä¸­-erase-it" class="headerlink" title="setï¼šä¸èƒ½åœ¨ it çš„ for å¾ªç¯ä¸­ erase(it)"></a>setï¼šä¸èƒ½åœ¨ it çš„ for å¾ªç¯ä¸­ erase(it)</h2><h2 id="dp-è¦æ³¨æ„å¦‚æœæœ‰-f-i-min-f-i-j-g-j-ï¼Œæ³¨æ„åˆ¤-f-i-j-g-j-ä¼šä¸ä¼šç‚¸-long-longï¼ˆåˆå§‹å€¼æ˜¯-1e18-çš„è¯ä¼šç‚¸ï¼ï¼ï¼ï¼‰"><a href="#dp-è¦æ³¨æ„å¦‚æœæœ‰-f-i-min-f-i-j-g-j-ï¼Œæ³¨æ„åˆ¤-f-i-j-g-j-ä¼šä¸ä¼šç‚¸-long-longï¼ˆåˆå§‹å€¼æ˜¯-1e18-çš„è¯ä¼šç‚¸ï¼ï¼ï¼ï¼‰" class="headerlink" title="dp è¦æ³¨æ„å¦‚æœæœ‰ f[i] = min(f[i - j] + g[j])ï¼Œæ³¨æ„åˆ¤ f[i - j] + g[j] ä¼šä¸ä¼šç‚¸ long longï¼ˆåˆå§‹å€¼æ˜¯ 1e18 çš„è¯ä¼šç‚¸ï¼ï¼ï¼ï¼‰"></a>dp è¦æ³¨æ„å¦‚æœæœ‰ f[i] = min(f[i - j] + g[j])ï¼Œæ³¨æ„åˆ¤ f[i - j] + g[j] ä¼šä¸ä¼šç‚¸ long longï¼ˆåˆå§‹å€¼æ˜¯ 1e18 çš„è¯ä¼šç‚¸ï¼ï¼ï¼ï¼‰</h2><p>â€”â€”wc2020 åœºå¤–èµ› 25 pts$</p><h2 id="åˆ†æ¯æ˜¯å¦ä¸º-0ï¼Ÿnanï¼"><a href="#åˆ†æ¯æ˜¯å¦ä¸º-0ï¼Ÿnanï¼" class="headerlink" title="åˆ†æ¯æ˜¯å¦ä¸º 0ï¼Ÿnanï¼"></a>åˆ†æ¯æ˜¯å¦ä¸º 0ï¼Ÿnanï¼</h2><p>â€”â€”æ¨¡æ‹Ÿèµ› 100 -&gt; 0</p><h2 id="å–æ¨¡æ¨¡-0-äº†å—ï¼ŸREï¼"><a href="#å–æ¨¡æ¨¡-0-äº†å—ï¼ŸREï¼" class="headerlink" title="å–æ¨¡æ¨¡ 0 äº†å—ï¼ŸREï¼"></a>å–æ¨¡æ¨¡ 0 äº†å—ï¼ŸREï¼</h2><p>â€”â€”åšé¢˜ï¼Œwa äº† inf æ¬¡</p><h2 id="å–æ¨¡å–å¯¹äº†å—ï¼Ÿæ­£è´Ÿå¯¹äº†å—ï¼Ÿæœ€å¥½è¾“å‡ºå‰-ans-mod-modï¼"><a href="#å–æ¨¡å–å¯¹äº†å—ï¼Ÿæ­£è´Ÿå¯¹äº†å—ï¼Ÿæœ€å¥½è¾“å‡ºå‰-ans-mod-modï¼" class="headerlink" title="å–æ¨¡å–å¯¹äº†å—ï¼Ÿæ­£è´Ÿå¯¹äº†å—ï¼Ÿæœ€å¥½è¾“å‡ºå‰ (ans += mod) %= modï¼"></a>å–æ¨¡å–å¯¹äº†å—ï¼Ÿæ­£è´Ÿå¯¹äº†å—ï¼Ÿæœ€å¥½è¾“å‡ºå‰ (ans += mod) %= modï¼</h2><p>â€”â€”noi2020åŒæ­¥èµ› D1T2 ï¼Ÿåˆ†</p><h2 id="å­—æ¯æ‰“é”™äº†å—ï¼Ÿ"><a href="#å­—æ¯æ‰“é”™äº†å—ï¼Ÿ" class="headerlink" title="å­—æ¯æ‰“é”™äº†å—ï¼Ÿ"></a>å­—æ¯æ‰“é”™äº†å—ï¼Ÿ</h2><p>â€”â€”noi2020åŒæ­¥èµ› D1T3 24 åˆ†ï¼Œr1ã€r2 æ‰“æˆ c1ã€c2</p><h2 id="ç©ºé—´å¼€å¤§äº†å—ï¼Ÿå“ªæ€•å¡ç€éƒ½ä¸è¡Œï¼"><a href="#ç©ºé—´å¼€å¤§äº†å—ï¼Ÿå“ªæ€•å¡ç€éƒ½ä¸è¡Œï¼" class="headerlink" title="ç©ºé—´å¼€å¤§äº†å—ï¼Ÿå“ªæ€•å¡ç€éƒ½ä¸è¡Œï¼"></a>ç©ºé—´å¼€å¤§äº†å—ï¼Ÿå“ªæ€•å¡ç€éƒ½ä¸è¡Œï¼</h2><p>â€”â€”æ¨¡æ‹Ÿèµ› 80 -&gt; 0</p><h2 id="ç©ºé—´å¼€å°äº†å—ï¼Ÿ2e5-å¼€äº†-1e5ï¼Ÿ"><a href="#ç©ºé—´å¼€å°äº†å—ï¼Ÿ2e5-å¼€äº†-1e5ï¼Ÿ" class="headerlink" title="ç©ºé—´å¼€å°äº†å—ï¼Ÿ2e5 å¼€äº† 1e5ï¼Ÿ"></a>ç©ºé—´å¼€å°äº†å—ï¼Ÿ2e5 å¼€äº† 1e5ï¼Ÿ</h2><p>â€”â€”æ¨¡æ‹Ÿèµ› 80 -&gt; 50</p><h2 id="floor-x-æ˜¯å°äºç­‰äº-x-çš„æœ€å¤§æ•´æ•°ï¼Œceil-x-æ˜¯å¤§äº-x-çš„æœ€å°æ•´æ•°"><a href="#floor-x-æ˜¯å°äºç­‰äº-x-çš„æœ€å¤§æ•´æ•°ï¼Œceil-x-æ˜¯å¤§äº-x-çš„æœ€å°æ•´æ•°" class="headerlink" title="floor(x) æ˜¯å°äºç­‰äº x çš„æœ€å¤§æ•´æ•°ï¼Œceil(x) æ˜¯å¤§äº x çš„æœ€å°æ•´æ•°"></a>floor(x) æ˜¯å°äºç­‰äº x çš„æœ€å¤§æ•´æ•°ï¼Œceil(x) æ˜¯<strong>å¤§äº</strong> x çš„æœ€å°æ•´æ•°</h2><p>â€”â€”æ¨¡æ‹Ÿèµ› fst äº†ä¸€å®šåˆ†</p><h2 id="C-n-m-é‡Œå†™-if-n-lt-m-return-0-äº†å—ï¼Ÿ"><a href="#C-n-m-é‡Œå†™-if-n-lt-m-return-0-äº†å—ï¼Ÿ" class="headerlink" title="C(n, m) é‡Œå†™ if (n &lt; m) return 0; äº†å—ï¼Ÿ"></a>C(n, m) é‡Œå†™ if (n &lt; m) return 0; äº†å—ï¼Ÿ</h2><h2 id="builtin-popcount-ä¸é€‚å®œè®¡ç®—-long-long-ç±»å‹çš„ç­”æ¡ˆï¼ˆä¸çŸ¥é“ä¸ºå•¥ï¼‰"><a href="#builtin-popcount-ä¸é€‚å®œè®¡ç®—-long-long-ç±»å‹çš„ç­”æ¡ˆï¼ˆä¸çŸ¥é“ä¸ºå•¥ï¼‰" class="headerlink" title="__builtin_popcount() ä¸é€‚å®œè®¡ç®— long long ç±»å‹çš„ç­”æ¡ˆï¼ˆä¸çŸ¥é“ä¸ºå•¥ï¼‰"></a>__builtin_popcount() ä¸é€‚å®œè®¡ç®— long long ç±»å‹çš„ç­”æ¡ˆï¼ˆä¸çŸ¥é“ä¸ºå•¥ï¼‰</h2><h2 id="double-é¢˜ç”¨-int-è®¡ç®—æ–œç‡-åæ ‡äº†å—ï¼Ÿ"><a href="#double-é¢˜ç”¨-int-è®¡ç®—æ–œç‡-åæ ‡äº†å—ï¼Ÿ" class="headerlink" title="double é¢˜ç”¨ int è®¡ç®—æ–œç‡/åæ ‡äº†å—ï¼Ÿ"></a>double é¢˜ç”¨ int è®¡ç®—æ–œç‡/åæ ‡äº†å—ï¼Ÿ</h2><h2 id="è¾“å‡º-0-çš„è¾“å‡º-1-äº†å—ï¼Ÿè¾“å‡º-1-çš„è¾“å‡º-0-äº†å—ï¼Ÿ"><a href="#è¾“å‡º-0-çš„è¾“å‡º-1-äº†å—ï¼Ÿè¾“å‡º-1-çš„è¾“å‡º-0-äº†å—ï¼Ÿ" class="headerlink" title="è¾“å‡º 0 çš„è¾“å‡º -1 äº†å—ï¼Ÿè¾“å‡º -1 çš„è¾“å‡º 0 äº†å—ï¼Ÿ"></a>è¾“å‡º 0 çš„è¾“å‡º -1 äº†å—ï¼Ÿè¾“å‡º -1 çš„è¾“å‡º 0 äº†å—ï¼Ÿ</h2><p>â€”â€”æ¨¡æ‹Ÿèµ› 100 -&gt; 60</p><h2 id="å˜é‡é‡åäº†å—ï¼Ÿå¤–é¢-i-é‡Œé¢ä¹Ÿæ˜¯-i"><a href="#å˜é‡é‡åäº†å—ï¼Ÿå¤–é¢-i-é‡Œé¢ä¹Ÿæ˜¯-i" class="headerlink" title="å˜é‡é‡åäº†å—ï¼Ÿå¤–é¢ i é‡Œé¢ä¹Ÿæ˜¯ i"></a>å˜é‡é‡åäº†å—ï¼Ÿå¤–é¢ i é‡Œé¢ä¹Ÿæ˜¯ i</h2><h2 id="SGå‡½æ•°ä½¿ç”¨çš„å‰ææ¡ä»¶ï¼šå¯¹äºä»»æ„å±€é¢ï¼Œä¸¤ä¸ªç©å®¶çš„å†³ç­–é›†åˆç›¸åŒã€‚"><a href="#SGå‡½æ•°ä½¿ç”¨çš„å‰ææ¡ä»¶ï¼šå¯¹äºä»»æ„å±€é¢ï¼Œä¸¤ä¸ªç©å®¶çš„å†³ç­–é›†åˆç›¸åŒã€‚" class="headerlink" title="SGå‡½æ•°ä½¿ç”¨çš„å‰ææ¡ä»¶ï¼šå¯¹äºä»»æ„å±€é¢ï¼Œä¸¤ä¸ªç©å®¶çš„å†³ç­–é›†åˆç›¸åŒã€‚"></a>SGå‡½æ•°ä½¿ç”¨çš„å‰ææ¡ä»¶ï¼šå¯¹äºä»»æ„å±€é¢ï¼Œä¸¤ä¸ªç©å®¶çš„å†³ç­–é›†åˆç›¸åŒã€‚</h2><h2 id="é€’å½’å‡½æ•°é‡Œçš„å˜é‡ï¼ˆæ¯”å¦‚æ•°ç»„çš„é¡¹é¦–ï¼‰åˆ«å¼€åœ¨å…¨å±€"><a href="#é€’å½’å‡½æ•°é‡Œçš„å˜é‡ï¼ˆæ¯”å¦‚æ•°ç»„çš„é¡¹é¦–ï¼‰åˆ«å¼€åœ¨å…¨å±€" class="headerlink" title="é€’å½’å‡½æ•°é‡Œçš„å˜é‡ï¼ˆæ¯”å¦‚æ•°ç»„çš„é¡¹é¦–ï¼‰åˆ«å¼€åœ¨å…¨å±€"></a>é€’å½’å‡½æ•°é‡Œçš„å˜é‡ï¼ˆæ¯”å¦‚æ•°ç»„çš„é¡¹é¦–ï¼‰åˆ«å¼€åœ¨å…¨å±€</h2><p>â€”â€”bzoj3636 è°ƒåŠå¤©</p><h2 id="æ³¨æ„-nã€m-ç­‰ä¸»è¦å˜é‡çš„æœ€å¤§èŒƒå›´æ˜¯å¦å‡ºç°åœ¨åŒä¸€æ¡£åˆ†é‡Œ"><a href="#æ³¨æ„-nã€m-ç­‰ä¸»è¦å˜é‡çš„æœ€å¤§èŒƒå›´æ˜¯å¦å‡ºç°åœ¨åŒä¸€æ¡£åˆ†é‡Œ" class="headerlink" title="æ³¨æ„ nã€m ç­‰ä¸»è¦å˜é‡çš„æœ€å¤§èŒƒå›´æ˜¯å¦å‡ºç°åœ¨åŒä¸€æ¡£åˆ†é‡Œ"></a>æ³¨æ„ nã€m ç­‰ä¸»è¦å˜é‡çš„æœ€å¤§èŒƒå›´æ˜¯å¦å‡ºç°åœ¨åŒä¸€æ¡£åˆ†é‡Œ</h2><p>â€”â€”æ¨¡æ‹Ÿèµ›çš„æƒ¨ç—›é­é‡ æŒ‚ 80pts</p><h2 id="ä¸è¦å†ä¸æ’åºæ±‚å‰ç¼€å’Œäº†ï¼ï¼ï¼ğŸ’¢ğŸ’¢ğŸ’¢"><a href="#ä¸è¦å†ä¸æ’åºæ±‚å‰ç¼€å’Œäº†ï¼ï¼ï¼ğŸ’¢ğŸ’¢ğŸ’¢" class="headerlink" title="ä¸è¦å†ä¸æ’åºæ±‚å‰ç¼€å’Œäº†ï¼ï¼ï¼ğŸ’¢ğŸ’¢ğŸ’¢"></a>ä¸è¦å†ä¸æ’åºæ±‚å‰ç¼€å’Œäº†ï¼ï¼ï¼ğŸ’¢ğŸ’¢ğŸ’¢</h2><p>â€”â€”æ¨¡æ‹Ÿèµ› 100 -&gt; 0</p><h2 id="çº¿æ®µæ ‘è¦è®°å¾—-pushdown-å’Œ-updateã€‚ã€‚ã€‚"><a href="#çº¿æ®µæ ‘è¦è®°å¾—-pushdown-å’Œ-updateã€‚ã€‚ã€‚" class="headerlink" title="çº¿æ®µæ ‘è¦è®°å¾— pushdown å’Œ updateã€‚ã€‚ã€‚"></a>çº¿æ®µæ ‘è¦è®°å¾— pushdown å’Œ updateã€‚ã€‚ã€‚</h2><h2 id="Tarjan-è¾¹åŒè¦è®°å½•å…¥è¾¹"><a href="#Tarjan-è¾¹åŒè¦è®°å½•å…¥è¾¹" class="headerlink" title="Tarjan è¾¹åŒè¦è®°å½•å…¥è¾¹"></a>Tarjan è¾¹åŒè¦è®°å½•å…¥è¾¹</h2><h2 id="æ•°ç»„-5e5-å¼€æˆ-1e5"><a href="#æ•°ç»„-5e5-å¼€æˆ-1e5" class="headerlink" title="æ•°ç»„ 5e5 å¼€æˆ 1e5"></a>æ•°ç»„ 5e5 å¼€æˆ 1e5</h2><p>â€”â€”æ¨¡æ‹Ÿèµ› 100 -&gt; 60</p><h2 id="çº¿æ®µæ ‘-if-lx-gt-rx-return"><a href="#çº¿æ®µæ ‘-if-lx-gt-rx-return" class="headerlink" title="çº¿æ®µæ ‘ if (lx &gt; rx) return;"></a>çº¿æ®µæ ‘ <code>if (lx &gt; rx) return;</code></h2><p>â€”â€”æ¨¡æ‹Ÿèµ› 100 -&gt; 30</p><h2 id="é“¾å¼å‰å‘æ˜Ÿ-i-nxt-i-è€æ˜¯å†™é”™ã€‚"><a href="#é“¾å¼å‰å‘æ˜Ÿ-i-nxt-i-è€æ˜¯å†™é”™ã€‚" class="headerlink" title="é“¾å¼å‰å‘æ˜Ÿ i = nxt[i] è€æ˜¯å†™é”™ã€‚"></a>é“¾å¼å‰å‘æ˜Ÿ <code>i = nxt[i]</code> è€æ˜¯å†™é”™ã€‚</h2><p>â€”â€”è™«é€¢ T æˆ sb</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€ç½®é¡¶ã€‘Ideas &amp; Tricks</title>
      <link href="2099/11/30/%E3%80%90%E7%BD%AE%E9%A1%B6%E3%80%91Ideas%20&amp;%20Tricks/"/>
      <url>2099/11/30/%E3%80%90%E7%BD%AE%E9%A1%B6%E3%80%91Ideas%20&amp;%20Tricks/</url>
      
        <content type="html"><![CDATA[<h2 id="æ‚"><a href="#æ‚" class="headerlink" title="æ‚"></a>æ‚</h2><hr><ul><li><p>ä¸­ä½æ•°ç›¸å…³å¯è€ƒè™‘äºŒåˆ†ï¼Œå°†å°äºäºŒåˆ†å€¼çš„æ ‡ä¸º $-1$ï¼Œå¤§äºäºŒåˆ†å€¼çš„æ ‡ä¸º $1$</p></li><li><p>çœ‹è§ä¹˜ç§¯è€ƒè™‘å– $log$ï¼Œè¿™æ ·å¼€æ–¹å°±å˜æˆé™¤æ³•ï¼Œä¹˜å°±å˜æˆåŠ æ³•äº†ï¼Œæœ‰å¾ˆå¤šä¼˜ç§€çš„æ€§è´¨</p></li><li><p>ç½‘æ ¼å›¾å¥—è·¯ä¸€è§ˆï¼š$C = V - E + F$; åˆ†æ²»æœ€çŸ­è·¯ï¼›äºŒåˆ†å›¾æŸ“è‰²ï¼›ç¬›å¡å°”æ ‘ï¼›æ–¯å¦çº³æ ‘ï¼ˆå¾…è¡¥ï¼‰</p></li><li><p>å¾—å¤±è½¬æ¢é¢˜å€’é¡ºåºã€‚ï¼ˆ$UOJ418$ ç­‰è®¸è®¸å¤šå¤šï¼‰</p></li><li><p>æŸç±»æ ‘ä¸Šè´ªå¿ƒå¸¸è§é¢˜ï¼šé€‰äº†çˆ¶äº²åæ‰èƒ½é€‰å„¿å­ï¼Œè¦æ±‚æŸäº›ä¸œè¥¿æœ€ä¼˜åŒ–ã€‚æŠ€å·§ï¼šä¼˜çš„ç‚¹ä¸€å®šä¼šåœ¨çˆ¶äº²è¢«é€‰åç«‹åˆ»è¢«é€‰ã€‚å †ç»´æŠ¤ä¼˜å…ˆçº§ï¼Œæ¯æ¬¡å–å‡ºé˜Ÿé¦–å’Œçˆ¶äº²æ‰€åœ¨å—åˆå¹¶ï¼ˆå¦‚ $UOJ418$ æ˜¯æ”¾åˆ°è¯¥å—çš„æ“ä½œåºåˆ—æœ«å°¾ï¼‰</p></li><li><p><strong>æ‰¹é‡</strong>ç»´æŠ¤åˆ é™¤æˆ–åŠ å…¥ä¿¡æ¯çš„å¯ä»¥å°è¯•åˆ†æ²»ï¼Œçº¿æ®µæ ‘ä¹‹ç±»çš„ã€‚</p></li><li><p>å– K ä¸ªæœ€å¤§å¯¹ï¼Œè€ƒè™‘ã€Œè¶…çº§é’¢ç´ã€åšæ³•ã€‚æœ¬è´¨æ˜¯è´ªå¿ƒå’Œå‹ç¼©ä¿¡æ¯ã€‚æ™®é€šå½¢å¼æ˜¯ç»´æŠ¤æŒ‡é’ˆï¼Œè¢«å–äº†å°±åç§»ï¼Œä¸€ä¸ªé“ç†ã€‚</p></li><li><p>å°äºæŸä¸ª $limit$ çš„æ“ä½œéƒ½è¢«æ‰§è¡Œï¼Œå°±å¯ä»¥ä»å°å¾€å¤§æ‰§è¡Œæ“ä½œã€‚</p></li><li><p>å¤„ç†åŒºé—´çš„å¥—è·¯ï¼šå›ºå®šä¸€ç»´å…ˆç®—ï¼Œå†æ±‚å’Œã€‚</p></li><li><p>åŒºé—´æœ¬è´¨ä¸åŒè®¡æ•°ï¼šâ€œç‰¹å¾ç‚¹â€æ€æƒ³ï¼Œæ•°æ®ç»“æ„ç»´æŠ¤</p></li></ul><h2 id="dp"><a href="#dp" class="headerlink" title="dp"></a>dp</h2><hr><ul><li><p>$dp$ å¥— $dp$ å¯ä»¥çœ‹ä½œåœ¨ä¸€ä¸ªè‡ªåŠ¨æœºä¸Šæš´è·‘ã€‚</p></li><li><p>è¦åœ¨ç¬¬ä¸€é¡¹æœ€ä¼˜çš„æƒ…å†µä¸‹è®©ç¬¬äºŒé¡¹æœ€ä¼˜ï¼Œæ¯”å¦‚æ€»ä¸ªæ•°å°½é‡å°‘çš„æƒ…å†µä¸‹æ€»å’Œå°½é‡å°ï¼Œå¯ä»¥æŠŠæ€»å’ŒåŠ ä¸Š $inf$. ($LOJ2977$)</p></li><li><p>ç”¨æœŸæœ›åšè®¡æ•°é¢˜ï¼ˆæ¯”è¾ƒå…¸å‹çš„æ˜¯ $ZJOI2019-çº¿æ®µæ ‘$ï¼‰</p></li><li><p>äºŒè¿›åˆ¶å€¼åŸŸåˆ†å—ï¼Œä¾‹å¦‚é«˜å…«ä½å’Œä½å…«ä½åˆ†åˆ«åœ¨ä¿®æ”¹å’ŒæŸ¥è¯¢æ—¶æšä¸¾ã€‚ï¼ˆ$uoj549$ï¼‰</p></li><li><p>å½¢å¦‚ $dp[i] = \sum\limits_{j = 1}^{c_i} dp[i - j * d]$ï¼Œå¯ä»¥æ¯ $c_i$ ä¸ªè®¾ç½®å…³é”®ç‚¹ï¼Œ$O(n)$ é¢„å¤„ç†æ¯ä¸ªå—å‰åç¼€å’Œï¼Œ$O(1)$ æŸ¥è¯¢ã€‚</p></li><li><p>dp æŸ¿å­å†™å‡ºæ¥åä¿¡ä»° BMã€‚</p></li></ul><h2 id="æ•°å­¦"><a href="#æ•°å­¦" class="headerlink" title="æ•°å­¦"></a>æ•°å­¦</h2><hr><ul><li><p><a href="https://www.cnblogs.com/gryzy/p/6015485.html" target="_blank" rel="noopener">å¿«é€Ÿé˜¶ä¹˜ç®—æ³•</a></p></li><li><p>ç”Ÿæˆå‡½æ•°å¯è€ƒè™‘å®é™…æ„ä¹‰</p></li><li><p>é¢å¯¹å¤šé¡¹å¼æŸæ‰‹æ— ç­–ï¼Œä¸å¦‚æŠŠå®ƒå˜æˆå°é—­å½¢å¼æäº‹æƒ…ï¼Œå¤šé¡¹å¼çš„åŠ å‡ä¹˜é™¤å’Œæ•°çš„åŠ å‡ä¹˜é™¤ç±»ä¼¼çš„ï¼Œè¿˜å¯ä»¥æ±‚å¯¼ã€$ln$ã€$exp$ï¼Œå¤šå¥½å•Šï¼</p></li><li><p>æŠŠ $\prod_{i = l}^{r}$ å˜æˆä¸€ä¸ª $r - l + 1$ æ¬¡çš„å¤šé¡¹å¼ï¼Œå°±å¯ä»¥ $\sum$ å•¦ï¼$\sum$ å°±èƒ½æäº‹æƒ…å•¦ï¼</p></li><li><p>å®¹æ–¥ç³»æ•°å¯ $dp$ï¼å¯å¤§åŠ›ä¼˜åŒ–æŒ‡æ•°çº§å¤æ‚åº¦åˆ°å¤šé¡¹å¼å¤æ‚åº¦ã€‚</p></li><li><p>æœŸæœ›å¯ç”¨æ•´æ•°æ¦‚ç‡å…¬å¼æ‹†åˆ†ï¼ŒåŒ–è®¡æ•°é—®é¢˜ä¸ºåˆ¤å®šé—®é¢˜ï¼Œæ›´å…·ä½“çš„è¯´ï¼ŒåŒ–â€œæ°å¥½â€ä¸ºâ€œè‡³å°‘â€ï¼Œæ˜“åŒ–äº†é—®é¢˜ã€‚</p></li><li><p>æœ‰ç»„åˆæ•°å½¢å¼çš„æ‹†äº†ï¼Œå…ƒç´ è¿‡å¤§æ—¶å¯è€ƒè™‘ä¸‹é™å¹‚/ä¸Šå‡å¹‚å½¢å¼ã€‚</p></li><li><p>çœ‹åˆ°äºŒç»´ $FFT$ åˆ«æ€•ï¼Œæƒ³æƒ³å…ˆè®¡ä¸€ç»´è´¡çŒ®ã€å†è®¡å¦ä¸€ç»´è´¡çŒ®ã€‚ï¼ˆ$UOJ574$-å¤šçº¿ç¨‹è®¡ç®—ï¼‰</p></li><li><p>å¤šé¡¹å¼ä¸ä¸€å®šè¦ FFT/NTTï¼Œå¯ä»¥ç‚¹å€¼å¯¹åº”ä½ç›¸ä¹˜æœ€åæ’å€¼æ’å›æ¥ã€‚ï¼ˆç§˜å¯†è¢­å‡»ï¼‰</p></li><li><p>å¸¦åˆ é™¤çš„çº¿æ€§åŸºï¼ˆæ¯”å¦‚åŠ¨æ€æ±‚ 01 çŸ©é˜µçš„ç§©ï¼‰ï¼š<a href="https://blog.csdn.net/a_forever_dream/article/details/83654397" target="_blank" rel="noopener">å¤§ä½¬æ¯”è¾ƒè¯¦ç»†çš„è§£è¯´</a> è€ƒè™‘åˆ é™¤å‘é‡ $x$ åæˆ‘ä»¬è¦å°½é‡æ‰¾ä¸€ä¸ªæ¥æ›¿ä»£ $x$ã€‚å¯¹çº¿æ€§åŸºé‡Œæ¯ä¸ªå‘é‡è®°å½•å®ƒæ’å…¥æ—¶å¼‚æˆ–äº†å“ªäº›å‘é‡ã€‚æ‰¾åˆ°ã€Œå—æœ¬æ¬¡åˆ é™¤å½±å“ã€çš„åŸºå¤–å‘é‡ $y$ï¼Œå¦‚æœä¸å­˜åœ¨åŸºå¤–çš„å°±æ‰¾åŸºå†…æœ€ä½çš„ï¼ˆè¿™æ ·åœ¨åˆ é™¤æ—¶å°±ä¸ä¼šå½±å“æ›´ä½ä½çš„å‘é‡ï¼‰ï¼ŒæŠŠ $y$ å…¶å®ƒå—å½±å“çš„å‘é‡å¼‚æˆ–ä¸Š $y$ï¼ˆ$y$ è‡ªå·±å˜æˆ $0$ï¼Œè¿™æ ·å°±èƒ½æ¶ˆé™¤ $x$ åœ¨çº¿æ€§åŸºé‡Œçš„å½±å“ï¼Œç›¸å½“äºç”¨ $y$ æ›¿ä»£äº† $x$ï¼‰ï¼›å¦‚æœæ‰¾çš„æ˜¯åŸºå†…çš„ï¼Œç§©æ•° $-1$ï¼ˆå›´ç»•ç€æˆ‘ä»¬çš„åœ†ç¯ï¼‰</p></li></ul><h2 id="å›¾è®º"><a href="#å›¾è®º" class="headerlink" title="å›¾è®º"></a>å›¾è®º</h2><hr><ul><li><p>æ ‘ä¸Šè·¯å¾„é—®é¢˜è€ƒè™‘è¾¹åˆ†æ²»æˆ–è€…ç‚¹åˆ†æ²» + å †</p></li><li><p>æ„é€ ä¸€ä¸ªæ’åˆ—ä½¿å¾—æƒå€¼æœ€å¤§â€”â€”ç”¨è´¹ç”¨æµæ±‚è§£ã€‚</p></li><li><p>ç½‘ç»œæµä¸­ç”¨è¿<strong>åå‘</strong> $\infty$ è¾¹æ¥å®ç°é™åˆ¶ã€‚</p></li></ul><h2 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h2><hr><ul><li><p>æ ‘çŠ¶æ•°ç»„åŒºé—´ä¿®æ”¹åŒºé—´æŸ¥è¯¢ï¼Ÿ</p><p>  å·®åˆ†, $d_i = a_i - a_{i - 1}, a_i = \sum\limits_{j = 1}^i d_i$</p><p>  $$\sum\limits_{i = 1}^x a_i = \sum\limits_{i = 1}^x \sum\limits_{j = 1}^i d_i = \sum\limits_{i = 1}^x d_i * (x - i + 1) = (x + 1) * \sum\limits_{i = 1}^x d_i - \sum\limits_{i = 1}^x d_i * i$$</p></li><li><p>åŒºé—´é—®é¢˜è½¬äºŒç»´æ•°ç‚¹ã€‚</p></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€ç½®é¡¶ã€‘å˜´å·´</title>
      <link href="2099/11/30/%E3%80%90%E7%BD%AE%E9%A1%B6%E3%80%91%E5%98%B4%E5%B7%B4/"/>
      <url>2099/11/30/%E3%80%90%E7%BD%AE%E9%A1%B6%E3%80%91%E5%98%B4%E5%B7%B4/</url>
      
        <content type="html"><![CDATA[<p>è¦é”»ç‚¼æ€ç»´å°±ä¸èƒ½æ¯é“éƒ½å†™ã€‚ï¼ˆç„¶è€Œè¿™å¹¶ä¸æ„å‘³ä½ å†™å°±è‰è‰å†™ï¼xml çš„èµ›åœºè°ƒè¯•æ°´å¹³ä¹‹å·®æœ‰ç›®å…±ç¹ qaqâ€¦ï¼‰å›  æ­¤ å¼€ äº† ã€Œã—…ã€å‘ã€‚</p><p>å˜´å·´é¢˜ä¸ä¼šæ”¾åœ¨ã€Œå­¦ä¹ è®¡åˆ’ã€é‡Œã€‚</p><p>å› ä¸ºæ˜¯å˜´å·´é¢˜æ‰€ä»¥ä½é…ï¼Œä¸€å¾‹ detailsã€‚</p><p>åŠ æ˜Ÿå·çš„æ˜¯æ‰“ç®—æœ‰æ—¶é—´å†™å†™çš„ã€‚</p><h3 id="LOJ6669"><a href="#LOJ6669" class="headerlink" title="$LOJ6669$"></a><a href="https://loj.ac/p/6669" target="_blank" rel="noopener">$LOJ6669$</a></h3><details>è¯¢é—® n æ¬¡å¾—å‡ºæ¯ä¸ªç‚¹æ·±åº¦ï¼ŒåŒæ—¶ä¹Ÿå¾—å‡ºäº†é‡é“¾ã€‚æŒ‰æ·±åº¦ bfsï¼Œå¯¹äºå½“å‰ç‚¹ xï¼Œä»ä»¥æ ¹ä¸ºé“¾é¡¶çš„é‡é“¾å¼€å§‹ï¼Œè¯¢é—® x å’Œè¯¥é‡é“¾åº•çš„è·ç¦»ï¼Œå¾—å‡º LCA çš„æ·±åº¦ï¼Œè‹¥åˆšå¥½ä¸º dep_x + 1 åˆ™çˆ¶äº²æ‰¾åˆ°ï¼Œå¦åˆ™å› ä¸ºæ˜¯äºŒå‰æ ‘ï¼Œè·³åˆ°è¯¥é‡é“¾é¡¶ç‚¹å”¯ä¸€çš„è½»å„¿å­å¼€å§‹æ–°çš„é‡é“¾è¯¢é—®ã€‚O(nlogn)</details><h3 id="CF741D"><a href="#CF741D" class="headerlink" title="$CF741D$"></a><a href="https://www.luogu.com.cn/problem/CF741D" target="_blank" rel="noopener">$CF741D$</a></h3><details>ã€Œé‡æ’ã€è¿™ä¸ªæ¡ä»¶éå¸¸å¼ºï¼šæ‰€æœ‰å­—ç¬¦åªèƒ½æœ‰æœ€å¤šä¸€ç§å‡ºç°å¥‡æ•°æ¬¡ã€‚å¥‡å¶æ€§è€ƒè™‘å¼‚æˆ–ã€‚å¯¹äºä¸€ç§ 01 è·¯å¾„ç»´æŠ¤æœ€é•¿çš„é‚£æ¡ã€‚å¯å‘å¼åˆå¹¶æ¯ä¸ªå­æ ‘çš„è·¯å¾„ã€‚O(nlogn)</details><h3 id="BZOJ4771-ä¸ƒå½©æ ‘"><a href="#BZOJ4771-ä¸ƒå½©æ ‘" class="headerlink" title="$BZOJ4771-$ä¸ƒå½©æ ‘"></a>$BZOJ4771-$ä¸ƒå½©æ ‘</h3><details>å¤šæ¬¡è¯¢é—®å­æ ‘ x é‡Œæ·±åº¦ä¸º [dep_x, dep_x + d] æœ‰å¤šå°‘ç§ä¸åŒçš„é¢œè‰²ã€‚æ— è„‘çº¿æ®µæ ‘åˆå¹¶å¤æ‚åº¦è‚¯å®šé”™äº†å˜›ã€‚<p>ä¸è€ƒè™‘æ·±åº¦é™åˆ¶ï¼Œåˆå§‹æ—¶æŸé¢œè‰² c çš„ä¸¤ä¸ªç‚¹ aã€b å„è‡ªè´¡çŒ®æ˜¯ 1ï¼Œåˆ°äº† lca(a, b) å°±è¦é™¤å» 1 ä¸ªè´¡çŒ®ã€‚æœ€åç­”æ¡ˆæ˜¯å­æ ‘å’Œã€‚</p><p>è€ƒè™‘æ·±åº¦é™åˆ¶ï¼šé¢„å¤„ç†è·ç¦»æ¯ä¸ª x &lt;= d çš„ç­”æ¡ˆã€‚[dep_x, dep_x + d] åœ¨ dfs åºä¸Šæ˜¯è¿ç»­çš„ã€‚ å‡è®¾æˆ‘ä»¬å·²ç»æœ‰ &lt;= d - 1 çš„ç­”æ¡ˆï¼Œé‚£å°±æŠŠæ·±åº¦ä¸º d çš„ç­”æ¡ˆåŠ è¿›æ¥ï¼ŒæŒ‰ dfs åºæ’åœ¨ä¸»å¸­æ ‘é‡Œå°±å¥½ã€‚ï¼ˆå¥½ã—…</p></details><h3 id="AGC051D"><a href="#AGC051D" class="headerlink" title="$AGC051D$"></a><a href="https://atcoder.jp/contests/agc051/tasks/agc051_d" target="_blank" rel="noopener">$AGC051D$</a></h3><details>å·§å¦™å¤„ç†ã€‚è·¯å¾„çš„åˆ†ç±»æ ‡å‡†æ˜¯ä»€ä¹ˆï¼Ÿæˆ‘æ¨¡ç³Šæ„Ÿè§‰åˆ°ä¸åŒçš„ç±»åˆ«ä¹‹é—´åº”è¯¥è¦æœ‰å…³è”ã€‚æ€ä¹ˆç”¨åˆé€‚çš„åˆ†ç±»å»æŠŠ abcd å…³è”èµ·æ¥å‘¢ï¼Ÿ<p>å®˜æ–¹é¢˜è§£ï¼šåˆ†ä¸‰ç±»ã€‚</p><ol><li>è¿‡ $T$ å‹ã€‚$S \rightarrow T \rightarrow U$, $U \rightarrow T \rightarrow S$</li><li>è¿‡ $V$ å‹ã€‚$S \rightarrow V \rightarrow U$, $U \rightarrow V \rightarrow S$</li><li>å›å‹ã€‚$S \rightarrow T \rightarrow S$, $S \rightarrow V \rightarrow S$, $U \rightarrow T \rightarrow U$, $U \rightarrow V \rightarrow U$</li></ol><p>æšä¸¾è¿‡ $T$ å‹å’Œè¿‡ $V$ å‹çš„æ•°é‡ï¼Œåˆ—å‡ºä¸€ä¸ªå¥½å¤šç»„åˆæ•°çš„æŸ¿å­ï¼Œç„¶åå˜æˆé˜¶ä¹˜å† FFTã€‚ã€‚å¤§æ¦‚å°±å®Œäº†ï¼Œä¸»è¦æ˜¯åˆ†ç±»æ¯”è¾ƒç¥ã€‚</p></details>]]></content>
      
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>21Feb å­¦ä¹ è®¡åˆ’</title>
      <link href="2021/02/28/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%9121Feb%20%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/"/>
      <url>2021/02/28/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%9121Feb%20%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/</url>
      
        <content type="html"><![CDATA[<h2 id="mathcal-2-1"><a href="#mathcal-2-1" class="headerlink" title="$\mathcal{2.1}$"></a>$\mathcal{2.1}$</h2><hr><h3 id="ICPC-WF-2019-äº¤é€šå µå¡"><a href="#ICPC-WF-2019-äº¤é€šå µå¡" class="headerlink" title="$ICPC\ WF\ 2019-äº¤é€šå µå¡$"></a><a href="https://loj.ac/p/6587" target="_blank" rel="noopener">$ICPC\ WF\ 2019-äº¤é€šå µå¡$</a></h3><p>ä»¤ $p_i = r_i + g_i$, $P = lcm(p_i)$ï¼Œæ˜¾ç„¶ $P\ |\ 2019!$ã€‚æ‰€ä»¥åœ¨ $[0, 2019!]$ ä¸­éšæœºå®æ•° = åœ¨ $[0, 2019!)$ ä¸­éšæœºå®æ•° = åœ¨ $[0, P)$ ä¸­éšæœºæ•´æ•°ã€‚</p><p>å°†æŸä¸ªå‡ºå‘æ—¶é—´ $t$ è¡¨ç¤ºä¸º $kX + a$ çš„å½¢å¼ï¼Œå…¶ä¸­ $X$ æ˜¯æˆ‘ä»¬é’¦å®šçš„å¸¸æ•°ï¼Œ$a \in [0, X)$ã€‚ç°åœ¨æˆ‘ä»¬è¦è§£åŒä½™æ–¹ç¨‹ç»„ $kX + a + x_i \geq r_i\ mod\ p_i$ï¼Œå¯¹äºä¸åŒçš„ $a$ åˆ†åˆ«å¤„ç†ï¼ˆè¿™é‡Œæ¦‚ç‡æ˜¾ç„¶æ˜¯å¯åŠ çš„ï¼‰ï¼Œå°±åªè¦å…³å¿ƒ $k$ äº†ã€‚</p><p>è®¾ $S$ ä¸ºæ»¡è¶³æ¡ä»¶çš„ $k$ çš„ $kX + a$ æ„æˆçš„é›†åˆï¼Œé‚£ä¹ˆ $kX + a \in S\ mod\ p_i$ å˜å½¢ä¸º $k \in S\ mod\ \frac{p_i}{gcd(p_i, X)}$ã€‚æ€ä¹ˆåˆå¹¶è§£é›†å‘¢ï¼Ÿ</p><p>å¯¹äºä¸¤ä¸ªåŒä½™æ–¹ç¨‹ï¼Œè®¾è§£é›†åˆ†åˆ«ä¸º $S_1$ å’Œ $S_2$, è‹¥å®ƒä»¬æ¨¡æ•°äº’è´¨ï¼Œåˆ™è§£é›†ä¸º $S_1 \times S_2$ã€‚</p><p>æ‰€ä»¥å– $X = lcm(1, \cdots, 10) = 2520$ï¼Œä½ ä¼šå‘ç°ç”±äº $p_i \in [1, 100]$ï¼Œæ‰€æœ‰ $\frac{p_i}{gcd(p_i, X)}$ éƒ½åªæœ‰ä¸€ç§å› æ•°ï¼æ¯ç§è´¨æ•°ä½œä¸ºæ¨¡æ•°çš„è§£é›†å¤§å°ä¹˜èµ·æ¥å°±è¡Œã€‚</p><p>æ•°æ®èŒƒå›´å¾ˆå®½ï¼Œå¤§åŠ›ä¸‰é‡å¾ªç¯æšä¸¾ï¼Œå¤æ‚åº¦ $O(100nX)$</p><p><a href="https://loj.ac/s/1052240" target="_blank" rel="noopener">$Code$</a></p><h3 id="Vim"><a href="#Vim" class="headerlink" title="$Vim$"></a><a href="https://loj.ac/p/2687" target="_blank" rel="noopener">$Vim$</a></h3><p><a href="https://www.cnblogs.com/Itst/p/10339605.html" target="_blank" rel="noopener">å¤§ä½¬</a></p><p>ä¸»è¦è¿˜æ˜¯çœ‹å¤§ä½¬çš„å§ï¼æˆ‘è¯´ç‚¹è‡ªå·±çš„ç†è§£ã€‚dp å¦‚ä½•åˆ’åˆ†é˜¶æ®µï¼Ÿæˆ‘ä»¬è¿˜æ˜¯ä»å·¦å¾€å³ï¼Œè§„å®šï¼šæ¯ä¸ªä½ç½® $i$ çš„è´¡çŒ®æ˜¯ä»å®ƒå‡ºå‘ç›´åˆ°åˆ°è¾¾ä¸‹ä¸€ä¸ªå³è¾¹çš„ä½ç½®çš„æ“ä½œæ•°ï¼ˆå³ä» $i$ å‡ºå‘ï¼Œè·¨è¶Š $[i, i + 1]$ çš„ï¼‰ã€‚è¿™ä¸ªå¯¼è‡´äº†çº¿å¤´ dp çš„ç‰¹ç‚¹ï¼šâ€œè·¯å¾„â€åœ¨ dp è¿‡ç¨‹ä¸­ä¸æ˜¯è¿ç»­çš„ï¼Œè€Œæ˜¯è®¸å¤šä¸ªçº¿å¤´ä¸æ–­å»¶é•¿æ‹¼èµ·æ¥çš„ã€‚</p><p><a href="https://loj.ac/s/1053317" target="_blank" rel="noopener">$Code$</a></p><h3 id="ç²¾å‡†é¢„æµ‹"><a href="#ç²¾å‡†é¢„æµ‹" class="headerlink" title="ç²¾å‡†é¢„æµ‹"></a><a href="https://loj.ac/p/3101" target="_blank" rel="noopener">ç²¾å‡†é¢„æµ‹</a></h3><p>æ­£å¸¸åš 2-satï¼Œ$0$ ä¸ºæ­»ï¼Œ$1$ ä¸ºç”Ÿï¼Œæˆ‘ä»¬è¦è®¡ç®—ä» $(0, x, 1)$ åˆ° $(T + 1, y, 1)$ çš„ä¸ªæ•°ï¼Œä¹Ÿå°±æ˜¯å‡å»åˆ° $(T + 1, y, 0)$ çš„ä¸ªæ•°ï¼Œç”±äºæ˜¯ DAGï¼Œæ‹“æ‰‘ + bitset å³å¯ã€‚æ³¨æ„è¦åˆ¤è‡ªå·±æ˜¯å¦åˆæ³•ã€‚</p><h2 id="mathcal-2-2"><a href="#mathcal-2-2" class="headerlink" title="$\mathcal{2.2}$"></a>$\mathcal{2.2}$</h2><hr><h3 id="NOI2017-æ³³æ± "><a href="#NOI2017-æ³³æ± " class="headerlink" title="$NOI2017-æ³³æ± $"></a>$NOI2017-æ³³æ± $</h3><p>å†™åœ¨ã€Œçº¿æ€§é€’æ¨å­¦ä¹ ç¬”è®°ã€é‡Œäº†ã€‚</p><h2 id="mathcal-2-3"><a href="#mathcal-2-3" class="headerlink" title="$\mathcal{2.3}$"></a>$\mathcal{2.3}$</h2><hr><h3 id="ä¹çœè”è€ƒ2018"><a href="#ä¹çœè”è€ƒ2018" class="headerlink" title="ä¹çœè”è€ƒ2018"></a>ä¹çœè”è€ƒ2018</h3><p>è¿™ä¸¤å¤©å†™äº† $T1$ ~ $T5$ï¼Œé¢˜è§£åœ¨ã€Œä¹çœè”è€ƒ2018 ä¹±å†™ã€ã€‚</p><h3 id="å›´ç»•ç€æˆ‘ä»¬çš„åœ†ç¯"><a href="#å›´ç»•ç€æˆ‘ä»¬çš„åœ†ç¯" class="headerlink" title="$å›´ç»•ç€æˆ‘ä»¬çš„åœ†ç¯$"></a><a href="https://uoj.ac/problem/453" target="_blank" rel="noopener">$å›´ç»•ç€æˆ‘ä»¬çš„åœ†ç¯$</a></h3><p>å•å†™äº†ã€‚</p><h2 id="mathcal-2-4"><a href="#mathcal-2-4" class="headerlink" title="$\mathcal{2.4}$"></a>$\mathcal{2.4}$</h2><hr><h3 id="è´­ç¥¨"><a href="#è´­ç¥¨" class="headerlink" title="$ -è´­ç¥¨$"></a><a href="https://uoj.ac/problem/7" target="_blank" rel="noopener">$ -è´­ç¥¨$</a></h3><p>$f_i = \min{f_j + (d_i - d_j)p_i + q_i}$, $d_i$ æ˜¯ $i$ åˆ°æ ¹çš„è·ç¦»ã€‚</p><p>è¿™å¾ˆæ–œç‡ä¼˜åŒ–ã€‚äºæ˜¯æ¨ä¸€æ³¢å¾—åˆ° $d_j &gt; d_k$ ä¸” $\frac{f_j - f_k}{d_j - d_k} &gt; p_i$ æ—¶ $j$ ä¸€å®šä¸è¢«å–åˆ°ã€‚</p><p>ç„¶è€Œå®ƒçœŸçš„èƒ½ç›´æ¥ä¸Šæ–œç‡ä¼˜åŒ–å—= = ä¸è¡Œï¼<strong>å‡¸å£³çš„å¤æ‚åº¦æ˜¯å‡æ‘Šçš„</strong>ï¼Œä½ å¸¦ä¸ªåˆ é™¤å®ƒå°±ä¼ªäº†ã€‚</p><p>ä¸€ç­¹è«å±•ã€‚</p><p>è€ƒè™‘ä¸€æ¡é“¾çš„æƒ…å†µï¼Œå¯ä»¥ cdq åˆ†æ²»ã€‚è¿™å¯å‘æˆ‘ä»¬ç‚¹åˆ†æ²»â€”â€”æŠŠä¸€ä¸ªç‚¹åˆ°æ ¹çš„è·¯å¾„åˆ’åˆ†ä¸ºè®¸å¤šæ®µåˆ†æ²»é‡å¿ƒåˆ°åˆ†æ²»å­æ ‘æ ¹çš„è·¯å¾„ï¼Œç»´æŠ¤æ¯ä¸ªåˆ†æ²»é‡å¿ƒåˆ°åˆ†æ²»å­æ ‘æ ¹çš„è·¯å¾„å‡¸å£³ï¼Œä»¥æ›´æ–°åˆ†æ²»å­æ ‘çš„ç­”æ¡ˆã€‚å¤æ‚åº¦ $O(nlog^2n)$ï¼Œç‚¹åˆ†æ²»ä¸€åª logï¼Œå‡¸å£³ä¸ŠäºŒåˆ†ä¸€åª logã€‚</p><p><a href="https://uoj.ac/submission/453320" target="_blank" rel="noopener">$Code$</a></p><h3 id="Ynoi2012-äººç”Ÿå·…å³°"><a href="#Ynoi2012-äººç”Ÿå·…å³°" class="headerlink" title="$Ynoi2012-äººç”Ÿå·…å³°$"></a><a href="https://www.luogu.com.cn/problem/P5527" target="_blank" rel="noopener">$Ynoi2012-äººç”Ÿå·…å³°$</a></h3><p>å°æ¸…æ–°ã€‚å–æ¨¡è¯¶ï¼æ ¹æ®æŠ½å±‰åŸç†ï¼Œ$2^{r - l + 1} &gt; maxV(r - l + 1)$ï¼Œå³ $r - l + 1 &gt; 13$ æ—¶å¿…ç„¶æœ‰è§£ï¼›å‰©ä¸‹æ‹¿ä¸ª bitset dp ä¸€ä¸‹å°±å¥½äº†ã€‚ä¿®æ”¹æ“ä½œå°±é¢„å¤„ç†ç«‹æ–¹ï¼Œæ ‘çŠ¶æ•°ç»„è®°æ“ä½œæ¬¡æ•°ï¼ŒæŸ¥è¯¢æ—¶å€å¢ã€‚</p><h3 id="çŸ³å®¶åº„çš„å·¥äººé˜¶çº§é˜Ÿä¼æ¯”è¾ƒåšå¼º"><a href="#çŸ³å®¶åº„çš„å·¥äººé˜¶çº§é˜Ÿä¼æ¯”è¾ƒåšå¼º" class="headerlink" title="çŸ³å®¶åº„çš„å·¥äººé˜¶çº§é˜Ÿä¼æ¯”è¾ƒåšå¼º"></a><a href="https://uoj.ac/problem/272" target="_blank" rel="noopener">çŸ³å®¶åº„çš„å·¥äººé˜¶çº§é˜Ÿä¼æ¯”è¾ƒåšå¼º</a></h3><p>å†™åœ¨ã€Œé›†åˆå¹‚çº§æ•°ã€ã€‚</p><h2 id="mathcal-2-5"><a href="#mathcal-2-5" class="headerlink" title="$\mathcal{2.5}$"></a>$\mathcal{2.5}$</h2><hr><h3 id="å–‚é¸½å­"><a href="#å–‚é¸½å­" class="headerlink" title="å–‚é¸½å­"></a><a href="https://uoj.ac/problem/449" target="_blank" rel="noopener">å–‚é¸½å­</a></h3><p>æ¯åªé¸½å­éƒ½ç­‰ä»·ï¼Œä¿¡æ¯åªå’Œé›†åˆå¤§å°æœ‰å…³ã€‚</p><p>$$ans = \sum\limits_{i = 1}^n (-1)^{i + 1} \binom{n}{i} \frac{n}{i} f_i$$</p><p>$f_i$ è¡¨ç¤ºå–‚äº† $i$ åªé¸½å­ï¼Œå…¶ä¸­æ°å¥½æœ‰ä¸€åªåƒäº† $K$ ç²’ç‰ç±³çš„æœŸæœ›æ­¥æ•°ã€‚ä¹˜ $\frac{n}{i}$ æ˜¯ä¸ºäº†æŠŠé›†åˆä»å…¨é›†ç¼©åˆ°é‚£ $i$ åªçš„é›†åˆã€‚</p><p>$$f_i = \sum\limits_{j = 0}^{(i - 1)(K - 1)} (j + K) \frac{i \binom{j + K - 1}{j} g_{i - 1, j}}{i^{j + K}}$$</p><p>æšä¸¾åˆ†ç»™å…¶ä»–æ²¡å–‚é¥±çš„é¸½å­çš„ç‰ç±³æ•°ã€‚$g_{i, j}$ è¡¨ç¤ºæŠŠ $j$ ç²’ç‰ç±³åˆ†ç»™ $i$ åªé¸½å­ï¼Œæ¯åªåƒçš„ç‰ç±³æ•°å°äº $K$ çš„æ–¹æ¡ˆæ•°ã€‚é’¦å®šæœ€åä¸€ç²’ç‰ç±³ä¸€å®šå–‚ç»™é‚£åªé¥±çš„é¸½å­ã€‚</p><p>$$g_{i, j} = (\sum\limits_{t = 0}^{K - 1} \frac{x^t}{t!})^{i} [x^j]$$</p><p>å¯ä»¥ NTTï¼Œä¹Ÿå¯ä»¥ dp + ç»„åˆæ•°ç®—ä¸€ä¸‹ï¼Œæ¯æ¬¡åŠ å…¥ä¸€ç²’ç‰ç±³ï¼Œæ–¹æ¡ˆæ•°æ˜¯æ€»æ•°å‡å»ä¼šå–‚é¥±ä¸€åªé¸½å­çš„æ–¹æ¡ˆæ•°ã€‚$O(n^2K)$ã€‚<del>å¯æ˜¯ NTT è¦ $O(n^2KlognK)$</del></p><p><a href="https://uoj.ac/submission/453568" target="_blank" rel="noopener">$Code$</a></p><p><a href="https://www.luogu.com.cn/paste/yyell4b7" target="_blank" rel="noopener">å¦ä¸€ç§ $O(n^2K)$ ç¥ä»™æ–¹æ³•</a></p><h2 id="mathcal-2-6"><a href="#mathcal-2-6" class="headerlink" title="$\mathcal{2.6}$"></a>$\mathcal{2.6}$</h2><hr><h3 id="å¤è¯»æœº"><a href="#å¤è¯»æœº" class="headerlink" title="å¤è¯»æœº"></a><a href="https://uoj.ac/problem/450" target="_blank" rel="noopener">å¤è¯»æœº</a></h3><p>ä¸éš¾çœ‹å‡ºæ±‚çš„å°±æ˜¯ $n!(\sum\limits_{i = 0}^{\lfloor \frac{n}{d} \rfloor} \frac{x^{id}}{(id)!})^K [x^n]$ã€‚$d$ å¥½å°ï¼Œæœ‰è¯¡ï¼</p><p>$d = 1$, $ans = K^n$</p><p>$d = 2$, å¯ä»¥ç›´æ¥ç”¨ $\frac{e^x + e^{-x}}{2}$</p><p>$$ans = n!(\frac{e^x + e^{-x}}{2})^K[x^n]$$</p><p>$$= \frac{n!}{2^K} \sum\limits_{i = 0}^K \binom{K}{i} e^{(2i - K)x} [x^n]$$</p><p>$$= \frac{\sum\limits_{i = 0}^K \binom{K}{i} (2i - K)^n}{2^K}$$</p><p>$d = 3$, å•ä½æ ¹åæ¼”.</p><p>$$ans = n!(\sum\limits_{i = 0}^n [3 \mid i] \frac{x^i}{i!})^K [x^n]$$</p><p>$$= n!( \sum\limits_{i = 0}^n \frac{1}{3} \sum\limits_{j = 0}^2 \omega_3^{ij} \frac{x^i}{i!} )^K [x^n]$$</p><p>$$= \frac{n!}{3^K}( \sum\limits_{j = 0}^2 e^{\omega_3^jx} )^K [x^n]$$</p><p>äºŒé¡¹å¼å±•å¼€</p><p>$$= \frac{n!}{3^K} \sum\limits_{i = 0}^K \binom{K}{i} \sum\limits_{j = 0}^{K - i} \binom{K - i}{j} e^{(i + j\omega_3^1 + (K - i - j)\omega_3^2)x} [x^n]$$</p><p>$$= \frac{1}{3^K}\sum\limits_{i = 0}^K \binom{K}{i} \sum\limits_{j = 0}^{K - i} \binom{K - i}{j} (i + j\omega_3^1 + (K - i - j)\omega_3^2)^n$$</p><p>ç›´æ¥ $K^2$ã€‚</p><p><a href="https://uoj.ac/submission/453603" target="_blank" rel="noopener">$Code$</a></p><h3 id="LJJ-å­¦äºŒé¡¹å¼å®šç†"><a href="#LJJ-å­¦äºŒé¡¹å¼å®šç†" class="headerlink" title="LJJ å­¦äºŒé¡¹å¼å®šç†"></a><a href="http://loj.ac/p/6485" target="_blank" rel="noopener">LJJ å­¦äºŒé¡¹å¼å®šç†</a></h3><p>æ»¡æ»¡çš„å¥—è·¯å•Š= = å¥½åƒè¿ç”Ÿæˆå‡½æ•°éƒ½æ²¡ç”¨åˆ°</p><p>$$\sum\limits_{i = 0}^n \binom{n}{i} s^i a_{i\ mod\ 4} = \sum\limits_{t = 0}^3 a_t \sum\limits_{i = 0}^{n} [4 \mid i - t] \binom{n}{i} s^i$$</p><p>$$= \sum\limits_{t = 0}^3 a_t \sum\limits_{i = 0}^n \frac{1}{4} \sum\limits_{j = 0}^3 \omega_4^{(i - t)j} \binom{n}{i} s^i = \frac{1}{4} \sum\limits_{t = 0}^3 a_t \sum\limits_{j = 0}^3 \sum\limits_{i = 0}^n \omega_4^{ij}s^i\binom{n}{i}$$</p><p>$$= \frac{1}{4} \sum\limits_{t = 0}^3 a_t \sum\limits_{j = 0}^3 \frac{(\omega_4^js + 1)^n}{\omega_4^{tj}}$$</p><p><a href="https://loj.ac/s/1059309" target="_blank" rel="noopener">$Code$</a></p><p>WC å‡ºæˆç»©äº†ï¼Œäººéƒ½ä¸æƒ³åŠ¨ã€‚ã€‚ã€‚æ²¡æœ‰é“¶è¯¶ã€‚ã€‚è¢«è‡ªå·±èœå‚»äº†ï¼ŒT1 åšè¿‡ç±»ä¼¼çš„ /kk ç„¶è€Œå½“æ—¶è„‘å­é‡Œä¸€é—ªè€Œè¿‡ã€‚è¿˜æ˜¯çŸ¥è¯†ä½“ç³»å¤ªçƒ‚äº†ã€‚è¦åš CF æ‚é¢˜ï¼Œç»¼åˆé¢˜ä¸æƒ³æ”¾ä¹Ÿå¯ä»¥åšï¼Œä½†æ˜¯è¦é”»ç‚¼æ€ç»´æ¨¡å¼ï¼Œä¸ç„¶æ°¸è¿œæ˜¯ä¸ªæš´åŠ›é€‰æ‰‹ /kel</p><h3 id="XJOI1656"><a href="#XJOI1656" class="headerlink" title="$XJOI1656$"></a>$XJOI1656$</h3><h4 id="T1"><a href="#T1" class="headerlink" title="$T1$"></a>$T1$</h4><p>ç‚¹å‡è¾¹ã€è¾¹çš„ä¿¡æ¯æ”¾çˆ¶äº²ä¸Šâ€”â€”è¿˜å·®ä¸€ä¸ªå¥—è·¯ï¼šç‚¹åˆ†æ ‘ã€‚åšå®Œäº†ã€‚</p><h4 id="T2"><a href="#T2" class="headerlink" title="$T2$"></a>$T2$</h4><p>å¡åœ¨é¢„å¤„ç†â€œä¸€ä¸ªäººä¸ç¢°åˆ°ä¸€æ¡çº¿çš„èµ°â€ä¸Šäº†ã€‚è¿™å°±æ˜¯ä¸ªå¡ç‰¹å…°æ•°ï¼Œä½ æŠŠæœå·¦èµ°å’Œæœå³èµ°åˆ†åˆ«çœ‹æˆæœå³èµ°å’Œæœä¸Šèµ°å°±æ˜¯ä¸ªèµ°ç½‘æ ¼é—®é¢˜äº†ï¼Œç„¶åå…³äºçº¿å¯¹ç§°ä»€ä¹ˆçš„åšä¸€åšã€‚æ¦‚ç‡å°±æ˜¯æ¥ç³Šå¼„ä½ çš„ã€‚$O(nm^2)$ è¶³çŸ£ã€‚</p><h4 id="T3"><a href="#T3" class="headerlink" title="$T3$"></a>$T3$</h4><p>å¹³é¢å›¾æœ€çŸ­è·¯è½¬å¯¹å¶å›¾æœ€å°å‰²ï¼Œè¿™æ ·é™åˆ¶å°±å¯ä»¥ç”¨ç½‘ç»œæµçš„æ–¹å¼è§£å†³ï¼ˆé™åˆ¶æŸæ¡è¾¹å¿…é¡»ä¸é€‰å°±æ˜¯é™åˆ¶å¯¹å¶å›¾çš„æŸä¸¤ä¸ªç‚¹å¿…é¡»åœ¨åŒä¸ªé›†åˆé‡Œï¼Œåå‘ $\infty$ è¾¹ï¼‰</p><h3 id="CF878D"><a href="#CF878D" class="headerlink" title="$CF878D$"></a><a href="https://www.luogu.com.cn/problem/CF878D" target="_blank" rel="noopener">$CF878D$</a></h3><p>ç¥é¢˜ã€‚å¦‚æœæ˜¯ $01$ å°±ç›´æ¥ bitset å–å¹¶/å–äº¤äº†ã€‚ä»¤ $f_{i, s}$ è¡¨ç¤º $s$ é›†åˆé‡Œçš„ç”Ÿç‰©æ˜¯å¦å­˜åœ¨ä¸€ä¸ªå±æ€§ $\geq$ $i$ å·ç”Ÿç‰©çš„å¯¹åº”å±æ€§ã€‚ä»¥å– $\max$ æ“ä½œä¸ºä¾‹ï¼Œ$c \geq \max(a, b)$ å½“ä¸”ä»…å½“ $c \geq a$ ä¸” $c \geq b$ï¼Œæ‰€ä»¥æ˜¯å–äº¤ï¼›åŒç†ï¼Œå– $\min$ å°±æ˜¯å–å¹¶ã€‚bitset åŠ é€Ÿå³å¯ã€‚</p><p>å¦ä¸€ç§æ–¹æ³•æ˜¯ç”¨äºŒåˆ†çš„æ€æƒ³, $\geq lim$ çš„ä¸º $1$ï¼Œ$&lt; lim$ çš„ä¸º $0$ï¼Œé‚£ä¹ˆ $\max$ ä¸ºå–å¹¶ï¼Œ$\min$ ä¸ºå–äº¤ã€‚</p><p>å­¦ä¹ ã€ŒäºŒæ¬¡ç¦»çº¿è«é˜Ÿã€ã€‚</p><p>è®¢æ­£ä»Šå¤© T1ã€T2ã€T3ã€‚</p><h2 id="æ„Ÿè§‰è‡ªå·±æ‚é¢˜çœŸåšå¤ªå°‘äº†ï¼Œæ•°å­¦çœŸå­¦å¤ªå°‘äº†ï¼Œå…¶ä»–çš„åŸºç¡€å·®ä¸å¤šéƒ½æŒæ¡äº†ã€‚ä»¥åå°±å¾€è¿™ä¸¤ä¸ªæ–¹å‘åŠªåŠ›å§ï¼"><a href="#æ„Ÿè§‰è‡ªå·±æ‚é¢˜çœŸåšå¤ªå°‘äº†ï¼Œæ•°å­¦çœŸå­¦å¤ªå°‘äº†ï¼Œå…¶ä»–çš„åŸºç¡€å·®ä¸å¤šéƒ½æŒæ¡äº†ã€‚ä»¥åå°±å¾€è¿™ä¸¤ä¸ªæ–¹å‘åŠªåŠ›å§ï¼" class="headerlink" title="æ„Ÿè§‰è‡ªå·±æ‚é¢˜çœŸåšå¤ªå°‘äº†ï¼Œæ•°å­¦çœŸå­¦å¤ªå°‘äº†ï¼Œå…¶ä»–çš„åŸºç¡€å·®ä¸å¤šéƒ½æŒæ¡äº†ã€‚ä»¥åå°±å¾€è¿™ä¸¤ä¸ªæ–¹å‘åŠªåŠ›å§ï¼"></a>æ„Ÿè§‰è‡ªå·±æ‚é¢˜çœŸåšå¤ªå°‘äº†ï¼Œæ•°å­¦çœŸå­¦å¤ªå°‘äº†ï¼Œå…¶ä»–çš„åŸºç¡€å·®ä¸å¤šéƒ½æŒæ¡äº†ã€‚ä»¥åå°±å¾€è¿™ä¸¤ä¸ªæ–¹å‘åŠªåŠ›å§ï¼</h2><h2 id="mathcal-2-7"><a href="#mathcal-2-7" class="headerlink" title="$\mathcal{2.7}$"></a>$\mathcal{2.7}$</h2><hr><h3 id="ZJOI2018-å†å²"><a href="#ZJOI2018-å†å²" class="headerlink" title="$ZJOI2018-$å†å²"></a><a href="https://uoj.ac/problem/374" target="_blank" rel="noopener">$ZJOI2018-$å†å²</a></h3><p>å•å†™äº†ã€‚éå¸¸nbçš„é¢˜ã€‚</p><h3 id="WC2020-çŒœæ•°æ¸¸æˆ"><a href="#WC2020-çŒœæ•°æ¸¸æˆ" class="headerlink" title="[WC2020]-çŒœæ•°æ¸¸æˆ"></a>[WC2020]-çŒœæ•°æ¸¸æˆ</h3><p>éƒ½ 1202 å¹´äº†ä¸ä¼šæœ‰äºº 0202 å¹´çš„ WC è¿˜æ²¡è¡¥å§ä¸ä¼šå§ä¸ä¼šå§ï¼ˆx</p><p>å’•å’•</p><h3 id="WC2021-æ–æ³¢é‚£å¥‘"><a href="#WC2021-æ–æ³¢é‚£å¥‘" class="headerlink" title="[WC2021]-æ–æ³¢é‚£å¥‘"></a>[WC2021]-æ–æ³¢é‚£å¥‘</h3><p>éƒ½ 1202 å¹´äº†ä¸ä¼šæœ‰äººè¿˜å­¦ä¸ä¼šæ•°å­¦å§ä¸ä¼šå§ä¸ä¼šå§ï¼ˆx</p><p>å’•å’•</p><p>å­¦äº†ã€Œçº¿æ®µæ ‘åˆ†æ²»ã€ã€‚ä¸€ä¸ªä¸çŸ¥é“ä¸ºä»€ä¹ˆä¼šæœ‰ä¸“å±ç§°è°“çš„ä¸œè¥¿ã€‚</p><h2 id="mathcal-2-8"><a href="#mathcal-2-8" class="headerlink" title="$\mathcal{2.8}$"></a>$\mathcal{2.8}$</h2><hr><p>8 å·å•¦ å¯’å‡ï¼å¯’å‡ï¼å¯’å‡ï¼å°æç´ è¿åŠ¨ åŸŸå æ¨¡æ‹Ÿèµ› å¹´è´§ é¸¡é¸­é±¼é¹…è‚‰ç™½åˆ‡è‚‰ç‚¸æ˜¥å·å‡‰æ‹Œæµ·èœ‡çš® æ˜¥æ™š å®ƒä»¬æ¥äº†ï¼ï¼ï¼</p><p>å†™äº†ã€Œçº¿æ®µæ ‘åˆ†è£‚ã€ã€‚</p><h3 id="WD-ä¸åœ°å›¾"><a href="#WD-ä¸åœ°å›¾" class="headerlink" title="WD ä¸åœ°å›¾"></a><a href="https://www.luogu.com.cn/problem/P5163" target="_blank" rel="noopener">WD ä¸åœ°å›¾</a></h3><p>å˜´ä¸æ¸…æ¥šäº† /kk</p><p>åˆ’é‡ç‚¹ï¼Œ<strong>SCC</strong>ï¼Œä¸æ˜¯æ— å‘å›¾çš„è¿é€šåˆ†é‡ã€‚</p><p>è€ƒè™‘æ—¶å…‰å€’æµï¼Œåè½¬æ—¶é—´è½´ã€‚</p><p>æˆ‘ä»¬å…³æ³¨çš„å…¶å®æ˜¯ç‚¹ã€‚æ˜¯æ¯æ¡è¾¹çš„<strong>ä¸¤ä¸ªç«¯ç‚¹</strong>ä»€ä¹ˆæ—¶å€™å¼€å§‹å¤„äºåŒä¸€ä¸ª SCC ä¸­ã€‚å¦‚æœæ±‚å‡ºäº†è¿™ä¸ªæ—¶é—´ï¼Œå°±åªè¦ä»æ™šåˆ°æ—©åšä¸€éæƒå€¼çº¿æ®µæ ‘åˆå¹¶ã€‚ç°åœ¨è¦æ±‚è¿™ä¸ªæ—¶é—´ã€‚</p><p>æ€ä¹ˆå¿«é€ŸæŸ¥è¯¢ä¸¤ç‚¹æ˜¯å¦åœ¨åŒä¸ª SCC é‡Œï¼Ÿå¹¶æŸ¥é›†ï¼Œè¿˜è¦æ”¯æŒæ’¤é”€ã€‚</p><p>è€ƒè™‘æ•´ä½“äºŒåˆ†ã€‚è¦æ‰¾æ¯å¯¹ç‚¹å‡ºç°åœ¨åŒä¸ª SCC ä¸­çš„æœ€æ™šæ—¶é—´ï¼Œå°±åŠ  $[mid + 1, r]$ çš„è¾¹â€”â€”å‡†ç¡®æ¥è¯´ï¼Œæ˜¯åœ¨åœ¨å·²æœ‰çš„ SCC åŸºç¡€ä¸Šâ€”â€”å¦‚æœè¦åŠ å…¥ä¸€æ¡è¾¹ $(x, y)$ï¼Œé‚£å®é™…åŠ å…¥çš„æ˜¯ $(getfa(x), getfa(y))$ï¼Œå¹¶ä¸” tarjan ä¹Ÿåªè·‘è¿™ä¸€è½®åŠ å…¥çš„ SCC é—´è¾¹ã€‚è·‘å®Œ tarjanï¼ŒæŠŠå·²ç»åœ¨ä¸€ä¸ª SCC çš„ç‚¹å¯¹å¾€å³ä¸¢ï¼Œè¿˜æ²¡åœ¨ä¸€ä¸ª SCC çš„ç‚¹å¯¹å¾€å·¦ä¸¢ã€‚åˆ†ç±»å®Œ $[l, r]$ çš„è¾¹åï¼Œå…ˆå¾€ $[l, mid]$ é€’å½’ï¼ˆæ’¤æ‰è¾¹ï¼Œä¸æ’¤å¹¶æŸ¥é›†ï¼‰ä»¥åˆ©ç”¨ä¸Šä¸€å±‚ä¸­å·²åŠ çš„ $[mid + 1, r]$ çš„è¾¹ï¼Œç„¶åå†æ’¤é”€å¹¶æŸ¥é›†å¹¶é€’å½’ $[mid + 1, r]$ã€‚è¿™æ ·æ¯æ¡è¾¹è¢«æ“ä½œ $logn$ æ¬¡ã€‚</p><p><del>æˆ‘æ„Ÿè§‰å…ˆå³å†å·¦å¥½åƒå¤æ‚åº¦ä¹Ÿæ˜¯å¯¹çš„ï¼Œä½†æ˜¯è¦é‡æ–°åŠ ä¸€éï¼Œéº»çƒ¦</del></p><p>tarjan $O(m)$ï¼Œå¯æ’¤é”€å¹¶æŸ¥é›† $O(logn)$ï¼Œæ•´ä½“äºŒåˆ†å°±æ˜¯ $O(m log^2n)$ çš„ã€‚çº¿æ®µæ ‘åˆå¹¶ä¸€åª log éå¸¸æ„‰å¿«ã€‚</p><p>ä»£ç å¤ªtméš¾å†™äº†ã€‚ã€‚ã€‚é‡æ„ $* n$ï¼Œå°è£…å¤§æ³•å¥½å•Šã€‚</p><details>    <summary>ä»¤äººçª’æ¯çš„code</summary>    <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mkp make_pair</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">10</span>, inf = <span class="number">1e9</span> + <span class="number">1e3</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, Q;</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Ques</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> op, x, y;</span><br><span class="line">&#125; q[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> x, y, t;  <span class="comment">// å‡ºç°æ—¶é—´</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (Edge a, Edge b) &#123; <span class="keyword">return</span> a.t &lt; b.t; &#125;</span><br><span class="line">&#125; e[N];</span><br><span class="line"><span class="built_in">map</span>&lt;pii, <span class="keyword">int</span>&gt; id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> INIT &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; Q;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;e[i].x, &amp;e[i].y);</span><br><span class="line">            e[i].t = Q;</span><br><span class="line">            id[mkp(e[i].x, e[i].y)] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i, <span class="number">1</span>, Q) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>, &amp;q[i].op, &amp;q[i].x, &amp;q[i].y);</span><br><span class="line">            <span class="keyword">if</span> (q[i].op == <span class="number">1</span>) e[id[mkp(q[i].x, q[i].y)]].t = i - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (q[i].op == <span class="number">2</span>) a[q[i].x] += q[i].y;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Sol1 &#123;</span><br><span class="line">    <span class="keyword">int</span> p[N], cnt, now;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">atom</span> &#123;</span> <span class="keyword">int</span> x, y, t; &#125;;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">DSU</span> &#123;</span></span><br><span class="line">        <span class="keyword">int</span> fa[N], sz[N];</span><br><span class="line">        <span class="built_in">vector</span>&lt;atom&gt; stk;</span><br><span class="line">        DSU() &#123;</span><br><span class="line">            rep(i, <span class="number">0</span>, N - <span class="number">1</span>) fa[i] = i, sz[i] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> fa[x] == x ? x : getfa(fa[x]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">            x = getfa(x), y = getfa(y);</span><br><span class="line">            <span class="keyword">if</span> (x == y) <span class="keyword">return</span>;</span><br><span class="line">            <span class="keyword">if</span> (sz[x] &gt; sz[y]) swap(x, y);</span><br><span class="line">            stk.pb((atom)&#123;x, y, now&#125;);</span><br><span class="line">            fa[x] = y, sz[y] += sz[x];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">undo</span><span class="params">(<span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (stk.size() &amp;&amp; stk.back().t == t) &#123;</span><br><span class="line">                atom o = stk.back(); stk.pop_back();</span><br><span class="line">                fa[o.x] = o.x, sz[o.y] -= sz[o.x];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; dsu;  <span class="comment">// æ­¤å¤„å¹¶æŸ¥é›†ç»´æŠ¤ SCC</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[N];</span><br><span class="line">    <span class="keyword">int</span> dfn[N], low[N], ins[N], st[N], top, Dfn;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        dfn[x] = low[x] = ++Dfn;</span><br><span class="line">        st[++top] = x, ins[x] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[x].size(); i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = g[x][i];</span><br><span class="line">            <span class="keyword">if</span> (!dfn[y]) &#123;</span><br><span class="line">                tarjan(y);</span><br><span class="line">                low[x] = min(low[x], low[y]);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ins[y]) &#123;</span><br><span class="line">                low[x] = min(low[x], dfn[y]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (low[x] == dfn[x]) &#123;</span><br><span class="line">            <span class="keyword">while</span> (st[top] != x) &#123;</span><br><span class="line">                ins[st[top]] = <span class="number">0</span>, dsu.merge(st[top], x), --top;</span><br><span class="line">            &#125; <span class="keyword">if</span> (st[top] == x) ins[x] = <span class="number">0</span>, --top;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Edge e1[N], e2[N];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (L &gt; R) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">            rep(i, L, R) e[i].t = l;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> ori = ++now, lst = cnt;</span><br><span class="line">        rep(i, L, R) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = dsu.getfa(e[i].x), y = dsu.getfa(e[i].y);</span><br><span class="line">            <span class="keyword">if</span> (x != y &amp;&amp; e[i].t &gt; mid) &#123;</span><br><span class="line">                g[x].pb(y);</span><br><span class="line">                p[++cnt] = x, p[++cnt] = y;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Dfn = <span class="number">0</span>;</span><br><span class="line">        rep(i, lst + <span class="number">1</span>, cnt)</span><br><span class="line">            <span class="keyword">if</span> (!dfn[p[i]]) tarjan(p[i]);</span><br><span class="line">        <span class="keyword">int</span> t1 = <span class="number">0</span>, t2 = <span class="number">0</span>;</span><br><span class="line">        rep(i, L, R) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dsu.getfa(e[i].x) == dsu.getfa(e[i].y) &amp;&amp; e[i].t &gt; mid) e2[++t2] = e[i];</span><br><span class="line">            <span class="keyword">else</span> e1[++t1] = e[i];</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i, <span class="number">1</span>, t1) e[L + i - <span class="number">1</span>] = e1[i];</span><br><span class="line">        rep(i, <span class="number">1</span>, t2) e[L + t1 + i - <span class="number">1</span>] = e2[i];</span><br><span class="line">        rep(i, lst + <span class="number">1</span>, cnt)</span><br><span class="line">            g[p[i]].clear(), dfn[p[i]] = low[p[i]] = <span class="number">0</span>, p[i] = <span class="number">0</span>;</span><br><span class="line">        cnt = lst;</span><br><span class="line">        solve(l, mid, L, L + t1 - <span class="number">1</span>);</span><br><span class="line">        dsu.undo(ori);</span><br><span class="line">        solve(mid + <span class="number">1</span>, r, L + t1, R);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> Sol2 &#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">SGT</span> &#123;</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">define</span> D N * 22</span></span><br><span class="line">        <span class="keyword">int</span> idx, ls[D], rs[D], sz[D];</span><br><span class="line">        ll sum[D];</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!x) x = ++idx;</span><br><span class="line">            sum[x] += v * p, sz[x] += v;</span><br><span class="line">            <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</span><br><span class="line">            p &lt;= mid ? modify(ls[x], l, mid, p, v) : modify(rs[x], mid + <span class="number">1</span>, r, p, v);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!x || !k) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (l == r) <span class="keyword">return</span> min(k, sz[x]) * l;</span><br><span class="line">            <span class="comment">// if (sz[x] &lt;= k) return sum[x];  // è¿™é‡Œä¸ºä»€ä¹ˆä¸å¯¹å•Š /kk æ‘¸ä¸ç€å¤´å‘</span></span><br><span class="line">            <span class="keyword">if</span> (sz[rs[x]] &lt;= k) <span class="keyword">return</span> sum[rs[x]] + query(ls[x], l, mid, k - sz[rs[x]]);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">return</span> query(rs[x], mid + <span class="number">1</span>, r, k);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!x || !y) &#123; x += y; <span class="keyword">return</span>; &#125;</span><br><span class="line">            <span class="keyword">if</span> (!x) x = ++idx;</span><br><span class="line">            sum[x] += sum[y], sz[x] += sz[y];</span><br><span class="line">            merge(ls[x], ls[y]), merge(rs[x], rs[y]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; seg;</span><br><span class="line">    <span class="keyword">int</span> rt[D];</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">DSU</span> &#123;</span></span><br><span class="line">        <span class="keyword">int</span> fa[N];</span><br><span class="line">        DSU() &#123;</span><br><span class="line">            rep(i, <span class="number">0</span>, N - <span class="number">1</span>) fa[i] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> fa[x] == x ? x : fa[x] = getfa(fa[x]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">            x = getfa(x), y = getfa(y);</span><br><span class="line">            <span class="keyword">if</span> (x == y) <span class="keyword">return</span>;</span><br><span class="line">            fa[y] = x, seg.merge(rt[x], rt[y]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; dsu;</span><br><span class="line">    ll ans[N];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(rt, <span class="number">0</span>, <span class="keyword">sizeof</span>(rt));</span><br><span class="line">        rep(i, <span class="number">1</span>, n) seg.modify(rt[i], <span class="number">0</span>, inf, a[i], <span class="number">1</span>);</span><br><span class="line">        sort(e + <span class="number">1</span>, e + m + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> pos = m + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = Q; i; --i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (q[i].op == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">while</span> (pos &gt; <span class="number">1</span> &amp;&amp; e[pos - <span class="number">1</span>].t &gt;= i) &#123;</span><br><span class="line">                --pos, dsu.merge(e[pos].x, e[pos].y);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> x = dsu.getfa(q[i].x);</span><br><span class="line">            <span class="keyword">if</span> (q[i].op == <span class="number">2</span>) &#123;</span><br><span class="line">                seg.modify(rt[x], <span class="number">0</span>, inf, a[q[i].x], <span class="number">-1</span>);</span><br><span class="line">                a[q[i].x] -= q[i].y;</span><br><span class="line">                seg.modify(rt[x], <span class="number">0</span>, inf, a[q[i].x], <span class="number">1</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                ans[i] = seg.query(rt[x], <span class="number">0</span>, inf, q[i].y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i, <span class="number">1</span>, Q) <span class="keyword">if</span> (q[i].op == <span class="number">3</span>) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    INIT::solve();</span><br><span class="line">    Sol1::solve(<span class="number">0</span>, Q, <span class="number">1</span>, m);</span><br><span class="line">    Sol2::solve();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h1 id="å¯’å‡"><a href="#å¯’å‡" class="headerlink" title="å¯’å‡~"></a>å¯’å‡~</h1><h2 id="å…»ç”Ÿå®å½•"><a href="#å…»ç”Ÿå®å½•" class="headerlink" title="å…»ç”Ÿå®å½•"></a><em>å…»ç”Ÿå®å½•</em></h2><p>è®¡åˆ’ï¼</p><h3 id="ğŸƒâ€â™€ï¸ğŸŠâ€â™€ï¸"><a href="#ğŸƒâ€â™€ï¸ğŸŠâ€â™€ï¸" class="headerlink" title="ğŸƒâ€â™€ï¸ğŸŠâ€â™€ï¸"></a>ğŸƒâ€â™€ï¸ğŸŠâ€â™€ï¸</h3><table border="1">  <tr>    <th>Date</th>    <td>2.9</td>    <td>2.10</td>    <td>2.11</td>    <td>2.12</td>    <td>2.13</td>     <td>2.14</td>    <td>2.15</td>    <td>2.16</td>    <td>2.17</td>    </tr><tr>    <th></th>    <td></td>    <td>1.5km</td>    <td>30min</td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>    <td></td>  </tr></table><h3 id="é˜…è¯»"><a href="#é˜…è¯»" class="headerlink" title="é˜…è¯»"></a>é˜…è¯»</h3><table border="1">  <tr>    <td>ã€Šç›ä¸½ã€‹</td>    <td>ã€Šå¾®æš—çš„ç«ã€‹</td>    </tr><tr>    <td></td>    <td></td>  </tr></table><p>&radic;</p><h3 id="å°æç´"><a href="#å°æç´" class="headerlink" title="å°æç´"></a>å°æç´</h3><h3 id="åŸŸå"><a href="#åŸŸå" class="headerlink" title="åŸŸå"></a>åŸŸå</h3><p>:(</p><h3 id="whk"><a href="#whk" class="headerlink" title="whk"></a>whk</h3><p>ä½œä¸šå¹²å®Œäº†</p><h3 id="å…·ä½“æ•°å­¦"><a href="#å…·ä½“æ•°å­¦" class="headerlink" title="å…·ä½“æ•°å­¦"></a>å…·ä½“æ•°å­¦</h3><h2 id="è®­ç»ƒå®å½•"><a href="#è®­ç»ƒå®å½•" class="headerlink" title="è®­ç»ƒå®å½•"></a><em>è®­ç»ƒå®å½•</em></h2><p>æ‰“ vp åšæ‚é¢˜ / åšé›†è®­é˜Ÿä½œä¸šé¢˜ã€æ¸…åé›†è®­é¢˜ã€‚</p><p>å­¦ä¹  BSGSã€‚</p><p>å­¦ä¹ æè¶…çº¿æ®µæ ‘ã€‚</p><p>å­¦ä¹ å¤šå…ƒæ‹‰åã€‚</p><p>å†™ Ynoiã€‚</p><p>åš LCTã€‚</p><p>gym102759G</p><h2 id="mathcal-2-9"><a href="#mathcal-2-9" class="headerlink" title="$\mathcal{2.9}$"></a>$\mathcal{2.9}$</h2><hr><h2 id="mathcal-2-10"><a href="#mathcal-2-10" class="headerlink" title="$\mathcal{2.10}$"></a>$\mathcal{2.10}$</h2><hr><h3 id="T2-Gym102759H"><a href="#T2-Gym102759H" class="headerlink" title="T2. Gym102759H"></a>T2. Gym102759H</h3><p>é€†å‘æ€ç»´ï¼Œè€ƒè™‘ä¸€ä¸ª k å˜æˆ [0, k - 1]ï¼Œk - 1 å†å˜æˆ [0, k - 2]â€¦ è€Œä¸€ä¸ª 0 å¯ä»¥å˜æˆä»»æ„æ•´æ•°ã€‚</p><p>T3: s[1, i] -&gt; s[1, p(i)]</p><ol><li>p(i) &lt;= i / 2 (logn æ¬¡)</li><li>p(i) è¾ƒå¤§<br> å½¢æˆ i - p(i) çš„å‘¨æœŸ</li></ol>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>AGC027Eã€ARC110E ç­‰ä¸€ç±»åˆ é™¤è®¡æ•°é—®é¢˜</title>
      <link href="2021/02/08/AGC027E%E3%80%81ARC110E%20%E7%AD%89%E4%B8%80%E7%B1%BB%E5%88%A0%E9%99%A4%E8%AE%A1%E6%95%B0%E9%97%AE%E9%A2%98/"/>
      <url>2021/02/08/AGC027E%E3%80%81ARC110E%20%E7%AD%89%E4%B8%80%E7%B1%BB%E5%88%A0%E9%99%A4%E8%AE%A1%E6%95%B0%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>Atcoder å¥½å–œæ¬¢å‡ºè¯¸å¦‚æ­¤ç±»çš„é¢˜ï¼šä½ æœ‰ä¸€ä¸ªç”± â€˜$a$â€™ ~ â€˜$?$â€™ æ„æˆçš„å­—ç¬¦ä¸²ï¼Œæ¯æ¬¡å¯ä»¥æŒ‰æŸç§è§„åˆ™åˆ å»ä¸€äº›å†åŠ ä¸Šä¸€äº›ï¼Œé—®æœ€ç»ˆèƒ½å½¢æˆå¤šå°‘ç§æœ¬è´¨ä¸åŒçš„å­—ç¬¦ä¸²ã€‚</p><p>ååæ˜¯æˆ‘çš„å…‹æ˜Ÿã€‚å®Œå…¨æ²¡å¾—æ€è·¯å•Šæ‘”ã€‚ä»…æœ‰çš„ä¸¤é“ å¥—è·¯å€’æ˜¯ç›¸åŒçš„ qwq</p><h3 id="AGC027E"><a href="#AGC027E" class="headerlink" title="$AGC027E$"></a>$AGC027E$</h3><p>è§„åˆ™ï¼šåªæœ‰ $ab$ï¼Œæ¯æ¬¡åˆ  â€˜$aa$â€™ ä¸º â€˜$b$â€™ æˆ–åˆ  â€˜$bb$â€™ ä¸º â€˜$a$â€™ã€‚</p><p>å¦‚æœæˆ‘ä»¬å°† $a$ çœ‹ä½œ $1$ï¼Œå°† $b$ çœ‹ä½œ $2$ï¼Œåœ¨æ¨¡ $3$ æ„ä¹‰ä¸‹å­—ç¬¦ä¸²ä¸å˜ã€‚ä»¤ $p(s)$ è¡¨ç¤º $s$ å­—ç¬¦ä¹‹å’Œæ¨¡ $3$ã€‚</p><p>ä¸€ä¸ªå­—ç¬¦ä¸² $s$ èƒ½è§„çº¦åˆ°å­—ç¬¦ $a$ï¼Œå½“ä¸”ä»…å½“ $p(s) = p(a)$ ä¸” $s$ ä¸­å­˜åœ¨ä¸¤ä¸ªç›¸é‚»çš„ç›¸åŒå­—ç¬¦ã€‚ï¼ˆå½’çº³è¯æ˜ï¼š$|s| = 1$ æˆ– $2$ æ—¶æ˜¾ç„¶æˆç«‹ï¼Œå¦åˆ™ä½ å¯ä»¥ä¸æ–­æ“ä½œç¬¬ä¸€å¯¹ç›¸é‚»çš„ç›¸åŒå­—ç¬¦ã€‚ï¼‰</p><p>$t$ èƒ½å¦è¢« $s$ åˆ°è¾¾ï¼Ÿå®¹æ˜“è´ªå¿ƒçš„æƒ³åˆ°ã€ŒæŠŠ $s$ åˆ†æ®µåè®© $t$ çš„æ¯ä¸ªå­—ç¬¦ä¸å¯¹åº”æ®µåŒ¹é…ã€ï¼Œä¸”è®©åˆ†çš„æ®µå°½é‡é å‰ã€‚äºæ˜¯å°±å¯ä»¥å€’ç€ dpï¼š$f_i$ è¡¨ç¤ºä»¥ $[i, |s|]$ ä¸ºåç¼€æœ‰å¤šå°‘ç§åˆ†æ®µæ–¹æ¡ˆæ•°ã€‚</p><p>æ³¨æ„ï¼šæœ€åå¯èƒ½å‰©ä¸‹ä¸€æ®µ $abababab$ è¿™æ ·æ— æ³•è§„çº¦çš„æ®µï¼Œä½†æ˜¯å®ƒæ€»èƒ½è¢«å‰é¢éƒ¨åˆ†é€šè¿‡è°ƒæ•´è§„çº¦é¡ºåºç»™åŒ–ä¸ºæœ€ç»ˆä¸²ä¸­çš„ç©ºä¸²ã€‚</p><details>    <summary>code</summary>    <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>, N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> nxt[N][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line">ll f[N];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">add</span><span class="params">(ll x, ll y)</span> </span>&#123; <span class="keyword">return</span> (x + y) % mod; &#125;</span><br><span class="line"><span class="function">ll <span class="title">sub</span><span class="params">(ll x, ll y)</span> </span>&#123; <span class="keyword">return</span> (x - y + mod) % mod; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">    n = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> ff = <span class="number">1</span>, sum = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) <span class="keyword">if</span> (s[i] == s[i + <span class="number">1</span>]) &#123; ff = <span class="number">0</span>; <span class="keyword">break</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span> (ff) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"1"</span>), <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    f[n + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    nxt[n + <span class="number">1</span>][<span class="number">0</span>] = nxt[n + <span class="number">1</span>][<span class="number">1</span>] = nxt[n + <span class="number">2</span>][<span class="number">0</span>] = nxt[n + <span class="number">2</span>][<span class="number">1</span>] = n + <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i; --i) &#123;</span><br><span class="line">        (sum += s[i] == <span class="string">'a'</span> ? <span class="number">1</span> : <span class="number">2</span>) %= <span class="number">3</span>;</span><br><span class="line">        nxt[i][<span class="number">0</span>] = s[i] == <span class="string">'a'</span> ? i + <span class="number">1</span> : (s[i + <span class="number">1</span>] == <span class="string">'b'</span> ? i + <span class="number">2</span> : nxt[i + <span class="number">2</span>][<span class="number">0</span>]);  <span class="comment">// è¿™ä¸€æ®µ p = 1</span></span><br><span class="line">        nxt[i][<span class="number">1</span>] = s[i] == <span class="string">'b'</span> ? i + <span class="number">1</span> : (s[i + <span class="number">1</span>] == <span class="string">'a'</span> ? i + <span class="number">2</span> : nxt[i + <span class="number">2</span>][<span class="number">1</span>]);  <span class="comment">// p = 2</span></span><br><span class="line">        f[i] = add(f[nxt[i][<span class="number">0</span>]], f[nxt[i][<span class="number">1</span>]] + (sum == <span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, sub(f[<span class="number">1</span>], sum == <span class="number">0</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h3 id="ARC110E"><a href="#ARC110E" class="headerlink" title="$ARC110E$"></a>$ARC110E$</h3><p>è§„åˆ™ï¼šåªæœ‰ $ABC$ï¼Œæ¯æ¬¡æŠŠä¸¤ä¸ªç›¸é‚»çš„ä¸åŒå­—ç¬¦æ›¿æ¢ä¸ºå’Œå®ƒä¿©éƒ½ä¸åŒçš„é‚£ä¸ªå­—ç¬¦ã€‚</p><p><em>è§£é¢˜è¿‡ç¨‹ä¸ä¸Šé¢é‚£é“å®Œå…¨ç›¸åŒã€‚</em></p><p>å¦‚æœæˆ‘ä»¬å°† $A$ çœ‹ä½œ $1$ï¼Œ$B$ çœ‹ä½œ $2$ï¼Œ$C$ çœ‹ä½œ $3$ï¼Œåœ¨å¼‚æˆ–æ„ä¹‰ä¸‹å­—ç¬¦ä¸²ä¸å˜ã€‚ä»¤ $p(s)$ è¡¨ç¤º $s$ å¼‚æˆ–å’Œã€‚</p><p>ä¸€ä¸ªå­—ç¬¦ä¸² $s$ èƒ½è§„çº¦åˆ°å­—ç¬¦ $a$ï¼Œå½“ä¸”ä»…å½“ $p(s) = p(a)$ ä¸” $s$ ä¸­å­˜åœ¨ä¸¤ä¸ªç›¸é‚»çš„ä¸åŒå­—ç¬¦ã€‚</p><details>    <summary>code</summary>    <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">10</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> a[N], lst[<span class="number">4</span>], pre[N];</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line">ll f[N];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">add</span><span class="params">(ll x, ll y)</span> </span>&#123; <span class="keyword">return</span> (x + y) % mod; &#125;</span><br><span class="line"><span class="function">ll <span class="title">sub</span><span class="params">(ll x, ll y)</span> </span>&#123; <span class="keyword">return</span> (x - y + mod) % mod; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">bool</span> ff = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) <span class="keyword">if</span> (s[i] != s[i + <span class="number">1</span>]) &#123; ff = <span class="number">0</span>; <span class="keyword">break</span>; &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) a[i] = s[i] - <span class="string">'A'</span> + <span class="number">1</span>, pre[i] = (pre[i - <span class="number">1</span>] ^ a[i]);</span><br><span class="line">    <span class="keyword">if</span> (ff) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"1"</span>), <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; --i) &#123;</span><br><span class="line">        f[i] = (pre[n] ^ pre[i]) == <span class="number">0</span>;</span><br><span class="line">        rep(j, <span class="number">1</span>, <span class="number">3</span>) &#123;</span><br><span class="line">            f[i] = add(f[i], f[lst[j ^ pre[i]]]);</span><br><span class="line">        &#125;</span><br><span class="line">        lst[pre[i]] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, <span class="number">3</span>) ans = add(ans, f[lst[i]]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å˜ä¸­æ‰¾ä¸å˜ã€‚<del>ï¼ˆè‹ ç™½ æ—  åŠ›ï¼‰</del></p><p>æ‰¾æ€§è´¨é¢˜æœ‰ä»€ä¹ˆæ€»ç»“å•Šã€æš´èºã€‘</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘çº¿æ®µæ ‘åˆ†è£‚ã€åˆ†æ²»ã€äºŒè¿›åˆ¶åˆ†ç»„</title>
      <link href="2021/02/08/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E7%BA%BF%E6%AE%B5%E6%A0%91%E5%88%86%E8%A3%82%E3%80%81%E5%88%86%E6%B2%BB%E3%80%81%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%88%86%E7%BB%84/"/>
      <url>2021/02/08/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E7%BA%BF%E6%AE%B5%E6%A0%91%E5%88%86%E8%A3%82%E3%80%81%E5%88%86%E6%B2%BB%E3%80%81%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%88%86%E7%BB%84/</url>
      
        <content type="html"><![CDATA[<h2 id="çº¿æ®µæ ‘åˆ†è£‚"><a href="#çº¿æ®µæ ‘åˆ†è£‚" class="headerlink" title="çº¿æ®µæ ‘åˆ†è£‚"></a>çº¿æ®µæ ‘åˆ†è£‚</h2><p><img src="/images/%E8%A3%82%E5%BC%80.jpg" alt="æˆ‘è£‚å¼€"></p><p><img src="/images/%E5%90%88%E4%B8%8A.png" alt="æˆ‘åˆä¸Š"></p><p>ä»¥æŸä¸ªé”®å€¼ä¸ºä¸­ç‚¹ï¼ˆä¸€èˆ¬æ˜¯æŠŠå‰ $k$ ä¸ªå…ƒç´ åˆ†ç¦»å‡ºæ¥ï¼Œè€Œä¸æ˜¯æŠŠå‰ $k$ ä¸ªä¸‹æ ‡ï¼‰å°†çº¿æ®µæ ‘åˆ†è£‚ä¸ºä¸¤éƒ¨åˆ†ã€‚å°±æŠŠä¸¤æ£µçº¿æ®µæ ‘é‡åˆçš„ $log$ ä¸ªèŠ‚ç‚¹æ–°å»ºå‡ºæ¥ï¼Œæ‰€ä»¥å•æ¬¡ä¸¥æ ¼ $O(logn)$ï¼Œå®ç°éå¸¸ç›´ç™½ï¼</p><p>åº”ç”¨æ¡ä»¶æ¯”è¾ƒè‹›åˆ»ï¼Œè¦æœ‰åºï¼Œæ‰èƒ½å…³äºé”®å€¼è£‚å¼€ã€‚é¢˜ä¸å¤ªæœ‰ï¼Œæ¯”è¾ƒç»å…¸çš„è¿™é“<a href="https://www.luogu.com.cn/problem/P2824" target="_blank" rel="noopener">æ’åº</a>ï¼Œå®¹æ˜“å‘ç°æ¯æ¬¡æ’åºçš„æ˜¯è¿ç»­åŒºé—´ï¼Œå¯¹äºæ¯ä¸ªåŒºé—´å»ºæƒå€¼çº¿æ®µæ ‘ï¼Œæ–°å»ºåŒºé—´æ—¶æŠŠæ³¢åŠåˆ°çš„åŸæœ‰åŒºé—´åˆ†è£‚å‡ºé‡åˆéƒ¨åˆ†çš„çº¿æ®µæ ‘å³å¯ã€‚ä»¥åè§åˆ°åº”ç”¨å†å›æ¥å†™ã€‚</p><details>    <summary>template</summary>    <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// luogu_5494</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((l + r) &gt;&gt; 1)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>, M = N * <span class="number">60</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, a[N], idx, id;</span><br><span class="line"><span class="keyword">int</span> rt[N], ls[M], rs[M];</span><br><span class="line">ll sz[M];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    sz[x] = sz[ls[x]] + sz[rs[x]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x)</span><br><span class="line">        x = ++idx;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;sz[x]);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    build(ls[x], l, mid), build(rs[x], mid + <span class="number">1</span>, r);</span><br><span class="line">    upd(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> p, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x)</span><br><span class="line">        x = ++idx;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        sz[x] += v;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    p &lt;= mid ? insert(ls[x], l, mid, p, v) : insert(rs[x], mid + <span class="number">1</span>, r, p, v);</span><br><span class="line">    upd(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> lx, <span class="keyword">int</span> rx)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (lx &lt;= l &amp;&amp; r &lt;= rx) &#123;</span><br><span class="line">        <span class="keyword">return</span> sz[x];</span><br><span class="line">    &#125;</span><br><span class="line">    ll ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (lx &lt;= mid) ret = query(ls[x], l, mid, lx, rx);</span><br><span class="line">    <span class="keyword">if</span> (rx &gt; mid) ret += query(rs[x], mid + <span class="number">1</span>, r, lx, rx);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x || !y) &#123; x |= y; <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        sz[x] += sz[y]; <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    merge(ls[x], ls[y], l, mid);</span><br><span class="line">    merge(rs[x], rs[y], mid + <span class="number">1</span>, r);</span><br><span class="line">    upd(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">split</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> lx, <span class="keyword">int</span> rx)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!y)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (lx &lt;= l &amp;&amp; r &lt;= rx) &#123;</span><br><span class="line">        x = y, y = <span class="number">0</span>; <span class="keyword">return</span>;  <span class="comment">// æŠŠ y åˆå¹¶åˆ°ç©ºå­æ ‘ x ä¸Šå»ï¼Œæ”¾å¿ƒç›´æ¥ =</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!x)</span><br><span class="line">        x = ++idx;</span><br><span class="line">    <span class="keyword">if</span> (lx &lt;= mid) split(ls[x], ls[y], l, mid, lx, rx);</span><br><span class="line">    <span class="keyword">if</span> (rx &gt; mid) split(rs[x], rs[y], mid + <span class="number">1</span>, r, lx, rx);</span><br><span class="line">    upd(y);  <span class="comment">// !!!</span></span><br><span class="line">    upd(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (k &lt;= <span class="number">0</span> || sz[x] &lt; k) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span> l;</span><br><span class="line">    <span class="keyword">if</span> (k &lt;= sz[ls[x]]) <span class="keyword">return</span> ask(ls[x], l, mid, k);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> ask(rs[x], mid + <span class="number">1</span>, r, k - sz[ls[x]]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    ++id;</span><br><span class="line">    build(rt[id], <span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="keyword">int</span> op, x, y, z; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;op, &amp;x);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span> || op == <span class="number">4</span>) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;y);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;y, &amp;z);</span><br><span class="line">        <span class="keyword">if</span> (!op) &#123;</span><br><span class="line">            ++id;</span><br><span class="line">            split(rt[id], rt[x], <span class="number">1</span>, n, y, z);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">            merge(rt[x], rt[y], <span class="number">1</span>, n);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">2</span>) &#123;</span><br><span class="line">            insert(rt[x], <span class="number">1</span>, n, z, y);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, query(rt[x], <span class="number">1</span>, n, y, z));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ask(rt[x], <span class="number">1</span>, n, y));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h2 id="çº¿æ®µæ ‘åˆ†æ²»"><a href="#çº¿æ®µæ ‘åˆ†æ²»" class="headerlink" title="çº¿æ®µæ ‘åˆ†æ²»"></a>çº¿æ®µæ ‘åˆ†æ²»</h2><p>æŠŠæ“ä½œå¤åˆ¶ $logn$ ä»½æŒ‚åœ¨çº¿æ®µæ ‘ä¸Š $logn$ ä¸ªèŠ‚ç‚¹ä¸‹ï¼Œæœ€åç»Ÿä¸€åšä¸€éã€‚æ—¶é—´çº¿æ®µæ ‘å°±æ˜¯è¿™ä¸ªã€‚</p><h2 id="äºŒè¿›åˆ¶åˆ†ç»„"><a href="#äºŒè¿›åˆ¶åˆ†ç»„" class="headerlink" title="äºŒè¿›åˆ¶åˆ†ç»„"></a>äºŒè¿›åˆ¶åˆ†ç»„</h2><p><a href="https://imilyx.github.io/2021/01/31/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%9121Jan%20%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/#%E7%8E%84%E5%AD%A6" target="_blank" rel="noopener">ç„å­¦</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘BSGS &amp; exBSGS</title>
      <link href="2021/02/08/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91BSGS%20&amp;%20exBSGS/"/>
      <url>2021/02/08/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91BSGS%20&amp;%20exBSGS/</url>
      
        <content type="html"><![CDATA[<h2 id="BSGS"><a href="#BSGS" class="headerlink" title="BSGS"></a>BSGS</h2><p>$O(\sqrt{p})$ æ±‚è§£å…³äº $x$ çš„é«˜æ¬¡åŒä½™æ–¹ç¨‹ $a^x \equiv n \pmod{p}$ï¼Œå…¶ä¸­ $p$ ä¸ºè´¨æ•°ã€‚</p><p>ç”± $a^{\phi(p)} \equiv 1 \pmod{p}$ å¾— $x \in [0, p - 1)$ã€‚è®¾ $x = i * k - j$, åˆ™ $(a^k)^i \equiv b * a^j \pmod{p}$ï¼Œå– $k = \sqrt{p}$ï¼Œå¯¹äº $j \in [0, k)$ æŠŠ $b * a^j \pmod{p}$ å­˜å…¥ hash è¡¨ï¼Œæšä¸¾ $i \in [0, k)$ï¼ŒæŸ¥æ‰¾ hash è¡¨ä¸­æ˜¯å¦æœ‰å½“å‰çš„ $(a^k)^i \pmod{p}$ã€‚</p><h2 id="exBSGS"><a href="#exBSGS" class="headerlink" title="exBSGS"></a>exBSGS</h2><p>$p$ éè´¨çš„ç‰ˆæœ¬ï¼Œ$(a, p) &gt; 1$ã€‚è€ƒè™‘è½¬åŒ–ä¸º $(a, p) = 1$ã€‚</p><p>å±•å¼€ä¸º $a \cdot a^{x - 1} + p * y = b$ï¼Œå¿…é¡»è¦ $(a, p) \mid b$ï¼Œ$a^{x - 1}$ å’Œ $y$ æ‰æœ‰æ•´æ•°è§£ã€‚</p><p>ä»¤ä¸ŠæŸ¿å˜ä¸ºï¼š$a^{x - 1} \cdot \frac{a}{(a, p)} \equiv \frac{b}{(a, p)} \pmod{\frac{p}{(a, p)}}$ã€‚</p><p>æ­¤æ—¶å¦‚æœ $(a^{x - 1}, \frac{p}{(a, p)}) = 1$ï¼Œå°±ç›´æ¥ç”¨ BSGS è§£ $a^{x - 1} \equiv \frac{\frac{b}{(a, p)}}{\frac{a}{(a, p)}} \pmod{\frac{p}{(a, p)}}$ï¼ˆæ³¨æ„è¿™é‡Œçš„æ¨¡æ•°å¯èƒ½éè´¨ï¼Œä¸èƒ½ç”¨è´¹é©¬å°å®šç†æ±‚é€†å…ƒï¼Œåªèƒ½ exgcd å•¦ï¼‰ï¼›å¦åˆ™é€’å½’åˆ†è§£ç›´åˆ° $(aâ€™, pâ€™) = 1$ã€‚</p><p>åœ¨é€’å½’è¿‡ç¨‹ä¸­è‹¥å‡ºç° $(aâ€™, pâ€™) âˆ¤ \frac{\frac{b}{(a, p)}}{\frac{a}{(a, p)}}$ï¼Œç›´æ¥æ— è§£ã€‚<strong>æ³¨æ„ï¼šæœ‰ç‰¹ä¾‹ï¼šè‹¥ $\frac{\frac{b}{(a, p)}}{\frac{a}{(a, p)}} \equiv 1 \pmod{\frac{p}{(a, p)}}$ï¼Œè¡¨ç¤º $a^{x - k} \equiv 1 \pmod{p}$ï¼ˆé€’å½’äº† $k$ å±‚ï¼‰ï¼Œå³ $a^{x - k} * a^k \equiv 1 * b \pmod{p}$ï¼Œ$k$ ä¸ºè§£ã€‚</strong></p><details>    <summary>template</summary>    <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// luogu_4195</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="built_in">map</span>&lt;ll, ll&gt; mp;</span><br><span class="line">ll n, m, p, ans;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !b ? a : gcd(b, a % b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a, ll b, ll mod)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>, a = a * a % mod) <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ret = ret * a % mod;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">exgcd</span><span class="params">(ll a, ll b, ll &amp;x, ll &amp;y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b) &#123; x = <span class="number">1</span>, y = <span class="number">0</span>; <span class="keyword">return</span> a; &#125;</span><br><span class="line">    ll d = exgcd(b, a % b, y, x); y -= a / b * x; <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">BSGS</span><span class="params">(ll a, ll b, ll p, ll t)</span> </span>&#123;</span><br><span class="line">    mp.clear();</span><br><span class="line">    ll k = (ll)<span class="built_in">sqrt</span>((<span class="keyword">double</span>)p), x, y;</span><br><span class="line">    exgcd(t, p, x, y), b = (b * x % p + p) % p;</span><br><span class="line">    ll tmp = b, S = qpow(a, k, p);</span><br><span class="line">    rep(i, <span class="number">0</span>, k) &#123;</span><br><span class="line">        mp[tmp] = i;</span><br><span class="line">        tmp = tmp * a % p;</span><br><span class="line">    &#125;</span><br><span class="line">    tmp = S;</span><br><span class="line">    rep(i, <span class="number">1</span>, k) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mp[tmp]) <span class="keyword">return</span> i * k - mp[tmp];</span><br><span class="line">        tmp = tmp * S % p;</span><br><span class="line">    &#125; <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">exBSGS</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll k = <span class="number">0</span>, d = <span class="number">1</span>, t = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (m == <span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ((d = gcd(n, p)) &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (m % d) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        ++k, m /= d, p /= d, t = t * (n / d) % p;</span><br><span class="line">        <span class="keyword">if</span> (t == m) <span class="keyword">return</span> k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (d = BSGS(n, m, p, t)) == <span class="number">-1</span> ? <span class="number">-1</span> : d + k;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; p &gt;&gt; m &amp;&amp; (n || m || p)) &#123;</span><br><span class="line">        n %= p, m %= p, ans = exBSGS();</span><br><span class="line">        <span class="keyword">if</span> (ans &lt; <span class="number">0</span>) <span class="built_in">puts</span>(<span class="string">"No Solution"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details>]]></content>
      
      
      
        <tags>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
            <tag> BSGS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[ZJOI2018]-å†å²</title>
      <link href="2021/02/07/%5BZJOI2018%5D-%E5%8E%86%E5%8F%B2/"/>
      <url>2021/02/07/%5BZJOI2018%5D-%E5%8E%86%E5%8F%B2/</url>
      
        <content type="html"><![CDATA[<p><a href="https://uoj.ac/problem/374" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><h3 id="mathscr-Part-1"><a href="#mathscr-Part-1" class="headerlink" title="$\mathscr{Part.1}$"></a>$\mathscr{Part.1}$</h3><p>ä¸éš¾å‘ç°å°±æ˜¯æœ€å¤§åŒ– access æ›´æ”¹çš„è¾¹æ•°ã€‚è€ƒè™‘ä¸å¸¦ä¿®æ€ä¹ˆåšã€‚å˜æ¢ä¸€ä¸‹é—®é¢˜å°±æ˜¯æœ€å¤§åŒ–æ¯ä¸ªç‚¹è¢«æ›´æ”¹çš„æ¬¡æ•°å’Œâ€”â€”æ¯ä¸ªç‚¹éƒ½å¯ä»¥ç‹¬ç«‹è®¡ç®—ï¼Œä¸€ä¸ªç‚¹è´¡çŒ®ä¸€æ¬¡å½“ä¸”ä»…å½“ç›¸é‚»ä¸¤æ¬¡ access å‘æºäºå…¶ä¸åŒçš„å­æ ‘ï¼Œå¹¶ä¸”æ¯ä¸ªç‚¹éƒ½å¯ä»¥å–åˆ°å…¶ä¸Šé™ï¼ˆåªè¦åˆç†å®‰æ’è¯¥ç‚¹æ¯ä¸ªå­æ ‘çš„ access é¡ºåºå°±å¯ä»¥äº†ï¼Œå¤§æ¦‚å¯å½’çº³è¯æ˜ï¼‰</p><p>ç‚¹ $x$ çš„ä¸Šé™æ˜¯å•¥å‘¢ï¼Ÿè®¾ $s_x = \sum\limits_{i \in subtree(x)} a_i$, $mx_x = \max\limits_{y \in son(x)}(s_y)$, é‚£ä¹ˆå°±æ˜¯ $\min( s_x - 1, 2 * (s_x - mx_x) )$ï¼ˆè®¨è®ºä¸€ä¸‹å‘ç°æ˜¯å¦å­˜åœ¨ã€Œä¸€ä¸ª $a_i$ è¿‡å¤§ã€å…¶ä»–å­æ ‘å®‰æ’ä¸å®Œã€çš„æƒ…å†µéƒ½ç¬¦åˆè¯¥æŸ¿ï¼‰</p><p>è€ƒè™‘ä¿®æ”¹ï¼Œé‚£ä¹ˆå°±è¦åº”ç”¨é“¾å‰–åˆ†å•Šåˆ†æ²»å•Šæ ‘ä¸Šç§‘æŠ€æ¥ç»´æŠ¤ä¿®æ”¹ç‚¹åˆ°æ ¹çš„è·¯å¾„äº†ã€‚æ¥ä¸‹æ¥çš„æ“ä½œç¥ä»™æäº† qaqï¼ˆç»†èŠ‚å¥½å¤šå•Šæ‘”</p><h3 id="mathscr-Part-2"><a href="#mathscr-Part-2" class="headerlink" title="$\mathscr{Part.2}$"></a>$\mathscr{Part.2}$</h3><p>æˆ‘ä»¬è®°å½•æ¯ä¸ªç‚¹ $x$ å½“å‰çš„è´¡çŒ®ç±»å‹ï¼šæ˜¯ â‘ ã€Œ$s_x - 1$ã€ï¼Œè¿˜æ˜¯ â‘¡ã€Œ$2 * (s_x - mx_x)$ ä¸” $mx_x$ æ¥è‡ª $x$ æŸä¸ªå­æ ‘ã€ï¼Œè¿˜æ˜¯ â‘¢ã€Œ$2 * (s_x - mx_x)$ ä¸” $mx_x$ æ¥è‡ª $x$ è‡ªå·±ã€ã€‚</p><p>æ³¨æ„åˆ°ä¸€æ¬¡ä¿®æ”¹åªä¼šåŠ ï¼ŒåŠ äº†å¯èƒ½æ”¹å˜æŸäº›ç‚¹çš„è´¡çŒ®ç±»å‹ã€‚ï¼ˆæ”¹å®Œåçš„ï¼‰â‘  å‹ç‚¹å¢åŠ  $w$ï¼Œâ‘¡â‘¢ å‹ç‚¹ä¸å˜ã€‚æˆ‘ä»¬è¦æ˜¯èƒ½å¿«é€Ÿä¿®æ”¹è¿™äº›è´¡çŒ®ç±»å‹ï¼Œå°±èƒ½é¡ºä¾¿æ›´æ–°ç­”æ¡ˆã€‚</p><p>æˆ‘ä»¬è®© â‘¡ å‹ç‚¹ $x$ å‘ $mx_x$ å¯¹åº”çš„å„¿å­è¿ä¸€æ¡è¾¹ã€‚é€šè¿‡ç§»é¡¹ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªæ›´ä¼˜çš„æ€§è´¨ï¼šè¿™æ ·çš„å„¿å­æœ€å¤šåªæœ‰ä¸€ä¸ªï¼è¿™å°±å’Œé‡é“¾å‰–åˆ†å¥‘åˆäº†ã€‚Orz</p><p>æˆ‘ä»¬æŠŠ $x$ å‘ $mx_x$ è¿çš„è¾¹çœ‹ä½œå®è¾¹ï¼Œå‘å…¶ä»–å„¿å­è¿çš„è¾¹çœ‹ä½œè™šè¾¹ï¼Œå½¢æˆçš„å®é“¾åªæœ‰é“¾åº•æ˜¯ â‘  æˆ–è€… â‘¢ï¼Œå…¶ä½™éƒ½æ˜¯ â‘¡ã€‚</p><p>ç„¶åå°±æ˜¯ä¸€ä¸ªç±» splay access çš„æ“ä½œï¼Œè¿å®è¾¹æˆ–è€…æ–­å®è¾¹ã€‚</p><p>å…³äºå¤æ‚åº¦ï¼Œ$x$ åˆ°æ ¹è·¯å¾„ä¸Šåˆè½»åˆè™šçš„è¾¹æ•°ä¸è¶…è¿‡ $log \sum a$ï¼Œå› ä¸ºæ˜¾ç„¶ä¸€æ¬¡è‡³å°‘ç¿»ä¸€å€ã€‚å•æ¬¡ access æœ€å¤šæ”¹ $log \sum a$ æ¡è™šè¾¹ä¸ºå®è¾¹ã€‚$O(nlog\sum a)$ã€‚</p><p>ç”¨æ ‘å‰– + çº¿æ®µæ ‘ç»´æŠ¤è™šè¾¹ä½ç½®æ¯æ¬¡æš´æ”¹å°±æ˜¯å¯¹çš„ï¼Œä½†æ˜¯æ‰¾è™šè¾¹è¿™ç§äº‹æ€ä¹ˆèƒ½å¿˜äº† LCT æœ¬äººå‘¢ï¼æ¯•ç«Ÿè¿™ç©æ„åªæ˜¯æœ‰æ¡ä»¶çš„è¿å®è¾¹ï¼Œé­”æ”¹ä¸€å‘å°±å¥½äº†ã€‚</p><p>ã€Œåˆ¤æ–­å®è¾¹çš„æ–­ä¸è¿ã€è¦ç”¨åˆ° $s_x$ã€‚è®¾ä¿®æ”¹ç‚¹ä¸º $x$ã€‚è€ƒè™‘ç”¨ lct ç»´æŠ¤ã€Œ $x$ åˆ°æ ¹è·¯å¾„ä¸Šçš„ã€$s$ã€‚åªæ”¹æ·±åº¦æ¯” $x$ å°çš„æ‰€ä»¥æ˜¯ä¸ªåŒºé—´åŠ  + å•ç‚¹æŸ¥è¯¢ã€‚ä¸ºäº†å®ç°æ–¹ä¾¿ï¼Œæˆ‘ä»¬åˆ©ç”¨<strong>å·®åˆ†æ€æƒ³</strong>ï¼Œè®¾ $val_x = s_x - s_{ch[x, 1]}$ï¼Œå°±å¯ä»¥å•ç‚¹ä¿®æ”¹ï¼Œå¹¶ä¸”æŸ¥è¯¢åªè¦æŠŠç‚¹è½¬åˆ° splay çš„æ ¹ç„¶åè¯¢é—®å³å­æ ‘çš„ $val$ å’Œï¼Œå°±ä¸ç”¨ä»€ä¹ˆ LCT å¥—çº¿æ®µæ ‘äº†ï¼ä¼Ÿ å¤§ èƒœ åˆ©</p><p>è¯´äº†è¿™ä¹ˆå¤šï¼Œä»£ç è¿˜æ˜¯æŒºå¥½å†™çš„ã€‚</p><details>    <summary>code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line">ll ans, a[N], s[N], lst[N], val[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ch[N][<span class="number">2</span>], fa[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dir</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> ch[fa[x]][<span class="number">1</span>] == x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">nrt</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fa[x] &amp;&amp; ch[fa[x]][dir(x)] == x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">up</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    s[x] = s[ch[x][<span class="number">0</span>]] + s[ch[x][<span class="number">1</span>]] + val[x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    ll sz = s[x] - s[ch[x][<span class="number">0</span>]];  <span class="comment">// x çš„çœŸå® s</span></span><br><span class="line">    ans -= lst[x];</span><br><span class="line">    lst[x] = min(sz - <span class="number">1</span>, <span class="number">2</span> * (sz - max(a[x], s[ch[x][<span class="number">1</span>]])));</span><br><span class="line">    ans += lst[x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rot</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y = fa[x], z = fa[y], k = dir(x), w = ch[x][k ^ <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (nrt(y)) ch[z][dir(y)] = x;</span><br><span class="line">    ch[y][k] = w, ch[x][k ^ <span class="number">1</span>] = y;</span><br><span class="line">    <span class="keyword">if</span> (w) fa[w] = y;</span><br><span class="line">    fa[y] = x, fa[x] = z;</span><br><span class="line">    up(y), up(x);  <span class="comment">// è¿™é‡Œä¸èƒ½ updï¼Œå› ä¸º x è¿˜æ²¡æ—‹åˆ°æ ¹ï¼Œch[x][1] ä¸æ˜¯ x æ‰€åœ¨ splay ä¸Š x çš„çœŸå®åç»§ï¼›æ—‹åˆ°æ ¹ä»¥å ch[x][1] æ‰æ˜¯ã€‚</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (nrt(x)) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = fa[x], z = fa[y];</span><br><span class="line">        <span class="keyword">if</span> (nrt(y)) rot((dir(x) ^ dir(y)) ? x : y);</span><br><span class="line">        rot(x);</span><br><span class="line">    &#125;</span><br><span class="line">    upd(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">access</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">0</span>; x; y = x, x = fa[x]) &#123;</span><br><span class="line">        splay(x);</span><br><span class="line">        s[x] += w;</span><br><span class="line">        <span class="comment">// åº•</span></span><br><span class="line">        <span class="keyword">if</span> (!y) a[x] += w;</span><br><span class="line">        val[x] += w;</span><br><span class="line">        </span><br><span class="line">        ll sz = s[x] - s[ch[x][<span class="number">0</span>]];</span><br><span class="line">        <span class="keyword">if</span> (s[ch[x][<span class="number">1</span>]] * <span class="number">2</span> &lt;= sz + <span class="number">1</span>) &#123;</span><br><span class="line">            val[x] += s[ch[x][<span class="number">1</span>]], ch[x][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (s[y] * <span class="number">2</span> &gt; sz + <span class="number">1</span>) &#123;</span><br><span class="line">            val[x] -= s[y], ch[x][<span class="number">1</span>] = y;</span><br><span class="line">        &#125;</span><br><span class="line">        upd(x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fat)</span> </span>&#123;</span><br><span class="line">    fa[x] = fat;</span><br><span class="line">    ll mx = s[x] = a[x];</span><br><span class="line">    <span class="keyword">int</span> id = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[x].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = g[x][i];</span><br><span class="line">        <span class="keyword">if</span> (y == fat) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(y, x);</span><br><span class="line">        s[x] += s[y];</span><br><span class="line">        <span class="keyword">if</span> (s[y] &gt; mx)</span><br><span class="line">            mx = s[y], id = y;</span><br><span class="line">    &#125;</span><br><span class="line">    lst[x] = min(s[x] - <span class="number">1</span>, <span class="number">2</span> * (s[x] - mx));</span><br><span class="line">    ans += lst[x];</span><br><span class="line">    <span class="keyword">if</span> (id &amp;&amp; mx * <span class="number">2</span> &gt; s[x] + <span class="number">1</span>)</span><br><span class="line">        ch[x][<span class="number">1</span>] = id;</span><br><span class="line">    val[x] = s[x] - s[ch[x][<span class="number">1</span>]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        g[x].pb(y), g[y].pb(x);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, w; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;w);</span><br><span class="line">        access(x, w);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details>]]></content>
      
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
            <tag> LCT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘äºŒæ¬¡ç¦»çº¿è«é˜Ÿ</title>
      <link href="2021/02/06/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E4%BA%8C%E6%AC%A1%E7%A6%BB%E7%BA%BF%E8%8E%AB%E9%98%9F/"/>
      <url>2021/02/06/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E4%BA%8C%E6%AC%A1%E7%A6%BB%E7%BA%BF%E8%8E%AB%E9%98%9F/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘è§„åˆ’çš„æ˜¯å¤šåšé”»ç‚¼æ€ç»´æ¨¡å¼çš„ CFã€AT é¢˜ï¼Œä½†æ˜¯è¿™ç©æ„æ—¢ç„¶ xtr å­¦é•¿ä»‹ç»äº†é‚£ä¸ºä½•ä¸å­¦å‘¢ï¼Ÿ</p><p>æ™®é€šè«é˜ŸåŠ å…¥/åˆ é™¤ä¸€ä¸ªä½ç½®çš„è´¡çŒ®æ˜¯ $T(n)$ï¼Œå¤æ‚åº¦ $O(n\sqrt{n}T(n))$ï¼Œ$T(n)$ å¾ˆå¤§çš„æ—¶å€™å°± GG äº†ã€‚ã€‚</p><p><del>äºæ˜¯ï¼Œç¥è¯´ï¼šè¦æœ‰äºŒæ¬¡ç¦»çº¿è«é˜Ÿã€‚</del></p><p>ä»¥<a href="https://www.luogu.com.cn/problem/P4887" target="_blank" rel="noopener">æ¨¡æ¿é¢˜</a>ä¸ºä¾‹ï¼Œè®¾ $f(i, [l, r])$ è¡¨ç¤º $i$ å¯¹ $[l, r]$ æ‰€äº§ç”Ÿçš„è´¡çŒ®ã€‚ä¸€æ¬¡ç§»åŠ¨åªä¼šåŠ å…¥ $l - 1$ æˆ– $r + 1$ï¼Œä»¥ $r + 1$ ä¸ºä¾‹ï¼Œ$f(r + 1, [l, r]) = f(r + 1, [1, r]) - f(r + 1, [1, l - 1])$ï¼Œå‰é¢é‚£é¡¹å¯ä»¥é¢„å¤„ç†ï¼ˆæ ¹æ® $a\ xor\ b = c \Leftrightarrow a\ xor\ c = b$ï¼Œæˆ‘ä»¬å¯ä»¥å°†æœ‰ $K$ ä¸ª $1$ çš„ $c$ çš„ $a\ xor\ c$ å­˜åœ¨æ¡¶é‡Œï¼Œåˆ° $b$ å°±ç›´æ¥æŸ¥ï¼‰ï¼Œåé¢è¿™ä¸ªå°±è¦<strong>ç¬¬äºŒæ¬¡ç¦»çº¿ä¸‹æ¥æœ€åç»Ÿä¸€åš</strong>ã€‚æ‰€ä»¥äºŒæ¬¡ç¦»çº¿è«é˜Ÿè¿™ç©æ„å®é™…ä¸Šå‡å°äº†ã€Œå¤„ç†ç­”æ¡ˆçš„å˜åŒ–é‡ã€çš„å¤æ‚åº¦ã€‚å¤æ‚åº¦å˜ä¸º $O(nT(n) + n\sqrt{n})$ã€‚</p><p>è®²ä¸€ä¸‹ç¬¬äºŒæ¬¡ç¦»çº¿ã€‚ä½ å¯ä»¥æŠŠ $f(x, [1, l - 1])$ æ”¾åœ¨ä¸‹æ ‡ä¸º $l - 1$ çš„ vector é‡Œç„¶åä»å‰å¾€ååšï¼Œä½†è¿™æ ·ç©ºé—´æ˜¯ $O(m\sqrt{n})$ çš„ã€‚ä¸å¦‚ç»´æŠ¤ $(L, R, q[i].l - 1, i, 1/-1)$ è¡¨ç¤ºå½“å‰ç»Ÿè®¡ $x \in [L, R]$ å¯¹ $[1, q[i].l - 1]$ äº§ç”Ÿçš„è´¡çŒ®ã€æ¥è‡ªç¬¬ $i$ ä¸ªè¯¢é—®æ—¶äº§ç”Ÿçš„ç­”æ¡ˆå˜åŒ–é‡ã€åŠ è¿˜æ˜¯å‡ï¼Œç©ºé—´å°±æ˜¯ $2m$ äº†ã€‚</p><p>ç®—å‡ºçš„ç­”æ¡ˆå˜åŒ–é‡å®é™…ä¸Šå¯¹åç»­æ“ä½œæœ‰å½±å“ï¼Œæ‰€ä»¥è¦åšå‰ç¼€å’Œã€‚</p><details>    <summary>code</summary><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// luogu_4887</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> cnt(x) __builtin_popcount(x)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, V = <span class="number">16390</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, K, unit;</span><br><span class="line"><span class="keyword">int</span> a[N], bin[V];</span><br><span class="line">ll ans[N], pre[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Ques</span> &#123;</span> <span class="keyword">int</span> l, r, id; ll ans; &#125; q[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">atom</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, id, op;</span><br><span class="line">    atom(<span class="keyword">int</span> L, <span class="keyword">int</span> R, <span class="keyword">int</span> Id, <span class="keyword">int</span> Op) &#123; l = L, r = R, id = Id, op = Op; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; buc;</span><br><span class="line"><span class="built_in">vector</span>&lt;atom&gt; vec[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(Ques a, Ques b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.l / unit == b.l / unit ? a.r &lt; b.r : a.l &lt; b.l;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; K;</span><br><span class="line">    <span class="keyword">if</span> (K &gt; <span class="number">14</span>) &#123;</span><br><span class="line">        rep(i, <span class="number">1</span>, m) <span class="built_in">puts</span>(<span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    unit = n / <span class="built_in">sqrt</span>(m);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;q[i].l, &amp;q[i].r);</span><br><span class="line">        q[i].id = i;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(q + <span class="number">1</span>, q + m + <span class="number">1</span>, cmp);</span><br><span class="line">    rep(i, <span class="number">0</span>, <span class="number">16383</span>)</span><br><span class="line">        <span class="keyword">if</span> (cnt(i) == K) buc.pb(i);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        pre[i] = bin[a[i]] + pre[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; buc.size(); j++) ++bin[a[i] ^ buc[j]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> L = <span class="number">1</span>, R = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="keyword">int</span> l = q[i].l, r = q[i].r;</span><br><span class="line">        ll &amp;x = q[i].ans;</span><br><span class="line">        <span class="keyword">if</span> (L &gt; l)</span><br><span class="line">            vec[R].pb(atom(l, L - <span class="number">1</span>, i, <span class="number">1</span>)), x -= pre[L - <span class="number">1</span>] - pre[l - <span class="number">1</span>], L = l;</span><br><span class="line">        <span class="comment">// while (L &gt; l)</span></span><br><span class="line">        <span class="comment">//     --L, x -= pre[L];</span></span><br><span class="line">        <span class="keyword">if</span> (R &lt; r)</span><br><span class="line">            vec[L - <span class="number">1</span>].pb(atom(R + <span class="number">1</span>, r, i, <span class="number">-1</span>)), x += pre[r] - pre[R], R = r;</span><br><span class="line">        <span class="comment">// while (R &lt; r)</span></span><br><span class="line">        <span class="comment">//     ++R, x += pre[R];</span></span><br><span class="line">        <span class="keyword">if</span> (L &lt; l)</span><br><span class="line">            vec[R].pb(atom(L, l - <span class="number">1</span>, i, <span class="number">-1</span>)), x += pre[l - <span class="number">1</span>] - pre[L - <span class="number">1</span>], L = l;</span><br><span class="line">        <span class="comment">// while (L &lt; l)</span></span><br><span class="line">        <span class="comment">//     x += pre[L], ++L;</span></span><br><span class="line">        <span class="keyword">if</span> (R &gt; r)</span><br><span class="line">            vec[L - <span class="number">1</span>].pb(atom(r + <span class="number">1</span>, R, i, <span class="number">1</span>)), x -= pre[R] - pre[r], R = r;</span><br><span class="line">        <span class="comment">// while (R &gt; r)</span></span><br><span class="line">        <span class="comment">//     x -= pre[R], --R;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(bin, <span class="number">0</span>, <span class="keyword">sizeof</span>(bin));</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; buc.size(); j++) ++bin[a[i] ^ buc[j]];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; vec[i].size(); j++) &#123;</span><br><span class="line">            atom t = vec[i][j];</span><br><span class="line">            rep(k, t.l, t.r) &#123;</span><br><span class="line">                <span class="keyword">if</span> (k &lt;= i &amp;&amp; !K) q[t.id].ans += t.op * (bin[a[k]] - <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">else</span> q[t.id].ans += t.op * bin[a[k]];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) q[i].ans += q[i - <span class="number">1</span>].ans;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) ans[q[i].id] = q[i].ans;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details>]]></content>
      
      
      
        <tags>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿¡å¥¥å­¦ä¹ å»ºè®®ï¼ˆæ¥è‡ª xtr å­¦é•¿ï¼‰</title>
      <link href="2021/02/06/%E4%BF%A1%E5%A5%A5%E5%AD%A6%E4%B9%A0%E5%BB%BA%E8%AE%AE%EF%BC%88%E6%9D%A5%E8%87%AA%20xtr%20%E5%AD%A6%E9%95%BF%EF%BC%89/"/>
      <url>2021/02/06/%E4%BF%A1%E5%A5%A5%E5%AD%A6%E4%B9%A0%E5%BB%BA%E8%AE%AE%EF%BC%88%E6%9D%A5%E8%87%AA%20xtr%20%E5%AD%A6%E9%95%BF%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>xtr å­¦é•¿çš„ç»å†å¥½æˆ³æˆ‘å•Šã€‚ã€‚ä»–çš„ HE å¤§æ¦‚æ˜¯æ¯ä¸ª oier æ†§æ†¬çš„å§ã€‚å¯çˆ±å‹¤å¥‹çš„å·æ€ªä»¬éƒ½è¦æœ‰ HE å•Šã€‚xml ä½ ä¹Ÿå»è¿½ä½ çš„æ¢¦å§ï¼Œè™½ç„¶æ¢¦æ˜¯ä»€ä¹ˆè¿˜ä¸æ˜æœ—ã€‚ä¹Ÿè®¸å°±åƒ xtr å­¦é•¿è¯´çš„é‚£æ ·ï¼Œä¸ºäº†æœ‰ç«™åœ¨å°ä¸Šæ— æ¯”è£è€€çš„ç¬é—´ï¼Œæˆ–æ˜¯é©°éª‹åœ¨èµ›åœºä¸Šçš„é‚£ç§å¿«æ„Ÿã€‚</p><p>è¦å¯¹è‡ªå·±çš„å¤„å¢ƒå’ŒçŸ¥è¯†æŒæ¡æƒ…å†µæœ‰å……åˆ†çš„äº†è§£ï¼Œç„¶åä¸é¡¾ä¸€åˆ‡çš„åŠªåŠ›ï¼Œ<strong>åšåˆ°å®Œå…¨å®ç°è‡ªå·±çš„æƒ³æ³•</strong>ã€‚</p><h2 id="åšé¢˜"><a href="#åšé¢˜" class="headerlink" title="åšé¢˜"></a>åšé¢˜</h2><p>å››ç§ç±»å‹</p><ol><li>luogu æ¨¡æ¿</li><li>UOJã€LOJ ä¸Šæ¸…åé›†è®­/é›†è®­é˜Ÿä½œä¸šç­‰é«˜æ°´å¹³ç»¼åˆé¢˜</li><li>CFã€AT ä¸Š æ›´æ³¨é‡æ€ç»´æ¨¡å¼çš„é¢˜</li><li>å†å¹´çœŸé¢˜</li></ol><p>é€‰æ‹©é€‚åº”è‡ªèº«çš„ã€‚</p><p>å¯ä»¥ä¸“é¢˜ï¼Œä½†<strong>å¿…é¡»é€‚æ—¶æ‚é¢˜ä»¥ç¡®ä¿æ¯”èµ›èƒ½åŠ›</strong></p><h2 id="å­¦ä¸œè¥¿"><a href="#å­¦ä¸œè¥¿" class="headerlink" title="å­¦ä¸œè¥¿"></a>å­¦ä¸œè¥¿</h2><ol><li>æ„Ÿå…´è¶£çš„é¢†åŸŸæ·±å…¥ï¼Œä»¥æœ‰æ‰€æ“…é•¿</li><li>ä¸æ„Ÿå…´è¶£çš„æŒæ¡åŸºç¡€ï¼Œä»¥çŸ¥è¯†ä½“ç³»å®Œå¤‡</li><li>å†·é—¨ç®—æ³•æµ…å°è¾„æ­¢</li></ol><h2 id="æ¯”èµ›"><a href="#æ¯”èµ›" class="headerlink" title="æ¯”èµ›"></a>æ¯”èµ›</h2><ol><li>å°½å¿«æƒ³å‡º</li><li>é«˜æ•ˆè°ƒè¯•</li><li>ç»¼åˆåˆ¤æ–­ã€ç­–ç•¥èƒ½åŠ›</li><li>é€‚æ—¶æ”¾å¼ƒ</li><li>å¿ƒæ€</li></ol><h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>ç„å‡†æ°´å¹³ç•¥é«˜çš„èº«è¾¹äººã€‚</p><h2 id="è®¡åˆ’"><a href="#è®¡åˆ’" class="headerlink" title="è®¡åˆ’"></a>è®¡åˆ’</h2><p>åˆ†é•¿æœŸçŸ­æœŸï¼Œé€‚æ—¶è°ƒæ•´ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å…¶ä»– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘åæ¼”æ‚çƒ©</title>
      <link href="2021/02/05/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E5%8F%8D%E6%BC%94%E6%9D%82%E7%83%A9/"/>
      <url>2021/02/05/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E5%8F%8D%E6%BC%94%E6%9D%82%E7%83%A9/</url>
      
        <content type="html"><![CDATA[<p>è‹¥æœ‰ $g_n = \sum\limits_{i = 1}^n a_{n, i} f_i$, å¹¶ä¸” $f_n = \sum\limits_{i = 1}^n b_{n, i} g_i$ï¼Œåˆ™ç§° $f$ å’Œ $g$ å¯ä»¥åæ¼”ã€‚è¯æ˜å¸¦å°±å®Œäº‹äº†ã€‚</p><p>ç»å…¸å¥—è·¯æ˜¯ dp å®¹æ–¥ç³»æ•°ã€‚</p><h2 id="äºŒé¡¹å¼åæ¼”"><a href="#äºŒé¡¹å¼åæ¼”" class="headerlink" title="äºŒé¡¹å¼åæ¼”"></a>äºŒé¡¹å¼åæ¼”</h2><p>å¹¿ä¹‰å®¹æ–¥ã€‚</p><p>ã€Œæ°å¥½ã€ä¸ã€Œè‡³å¤šã€ï¼š</p><p>$$f_n = \sum\limits_{i = 0}^n \binom{n}{i} g_i \Longleftrightarrow g_n = \sum\limits_{i = 0}^n (-1)^{n - i} \binom{n}{i} f_i$$</p><p>ã€Œæ°å¥½ã€ä¸ã€Œè‡³å°‘ã€ï¼š</p><p>$$f_k = \sum\limits_{i = k}^n \binom{i}{k} g_i \Longleftrightarrow g_k = \sum\limits_{i = k}^n (-1)^{i - k} \binom{i}{k} f_i$$</p><h2 id="min-max-å®¹æ–¥"><a href="#min-max-å®¹æ–¥" class="headerlink" title="$\min-\max$ å®¹æ–¥"></a>$\min-\max$ å®¹æ–¥</h2><p>$$max(S) = \sum\limits_{T \subseteq S} (-1)^{|T| + 1} min(T) \Longleftrightarrow min(S) = \sum\limits_{T \subseteq S} (-1)^{|T| + 1} max(T)$$</p><p>è¯æ˜å¤§æ¦‚è€ƒè™‘è®¾ $\max(S) = x$ï¼Œåªæœ‰ $T = {x}$ æ—¶çš„ $\min(T)$ ä¸º $x$ï¼Œå…¶ä½™æ—¶å€™å¿…ç„¶å­˜åœ¨ä¸€ä¸ª $y$ ä½¿å¾— $\min(T \cup {y}) = \min(T)$ï¼Œå°±æŠµæ¶ˆäº†</p><p>è¿™ç©æ„è¿˜èƒ½åº”ç”¨åˆ°æœŸæœ›ä¸Šå»ï¼šå¥—ä¸ª $E()$ å°±å¥½ã€‚</p><p>ä¸€èˆ¬æ¥è¯´ä¸ç”¨çœŸçš„æšä¸¾é›†åˆï¼Œä¿¡æ¯åªå’Œé›†åˆå¤§å°æœ‰å…³ã€‚</p><p>æ¨å¹¿ï¼šé€šè¿‡æ±‚ $\min$ æ¥æ±‚ $kth\ \max$</p><p>$$kth\ \max(S) = \sum\limits_{T \subseteq S} (-1)^{|T| - k} \binom{|T| - 1}{k - 1} \min(T)$$</p><p>ä¹ é¢˜ï¼š<a href="https://www.luogu.com.cn/problem/P4707" target="_blank" rel="noopener">é‡è¿”ç°ä¸–</a> <a href="http://imilyx.github.io/2020/12/05/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%91NOIP2020%20%E5%89%8D%E7%9A%84%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%E6%95%B4%E7%90%86/#%E9%87%8D%E8%BF%94%E7%8E%B0%E4%B8%96" target="_blank" rel="noopener">sol</a></p><p><a href="https://uoj.ac/problem/449" target="_blank" rel="noopener">å–‚é¸½å­</a> <a href="http://imilyx.github.io/2021/02/28/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%9121Feb%20%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/#%E5%96%82%E9%B8%BD%E5%AD%90" target="_blank" rel="noopener">sol</a></p><h2 id="å­é›†åæ¼”"><a href="#å­é›†åæ¼”" class="headerlink" title="å­é›†åæ¼”"></a>å­é›†åæ¼”</h2><p>å°±æ˜¯ FMT å’Œ FMIã€‚</p><p>$$f_S = \sum\limits_{T \subseteq S} g_T \Longleftrightarrow g_S = \sum\limits_{T \subseteq S} (-1)^{|S| - |T|} f_T$$</p><h2 id="è«æ¯”ä¹Œæ–¯åæ¼”"><a href="#è«æ¯”ä¹Œæ–¯åæ¼”" class="headerlink" title="è«æ¯”ä¹Œæ–¯åæ¼”"></a>è«æ¯”ä¹Œæ–¯åæ¼”</h2><p>æœ¬è´¨æ˜¯è´¨å› å­é›†åˆçš„ FMT å’Œ FMIã€‚</p><p>$$f(n) = \sum\limits_{d | n} g(d) \Longleftrightarrow g(n) = \sum\limits_{d | n} \mu(d) f(\frac{n}{d})$$</p><p>$$f(n) = \sum\limits_{n | d} g(d) \Longleftrightarrow g(n) = \sum\limits_{n | d} \mu(n) f(\frac{d}{n})$$</p><p>æœ€å¸¸ç”¨çš„ï¼š</p><p>$$\sum\limits_{d \mid n} \mu(d) = [n == 1]$$</p><h2 id="æ–¯ç‰¹æ—åæ¼”"><a href="#æ–¯ç‰¹æ—åæ¼”" class="headerlink" title="æ–¯ç‰¹æ—åæ¼”"></a>æ–¯ç‰¹æ—åæ¼”</h2><p>$$f_n = \sum\limits_{i = 1}^n {n \brace i} g_i \Longleftrightarrow g_n = \sum\limits_{i = 1}^n (-1)^{n - i} {n \brack i} f_i$$</p><h2 id="å•ä½æ ¹åæ¼”"><a href="#å•ä½æ ¹åæ¼”" class="headerlink" title="å•ä½æ ¹åæ¼”"></a>å•ä½æ ¹åæ¼”</h2><p>$$[k \mid n] = \frac{1}{k} \sum\limits_{i = 0}^{k - 1} \omega_k^{ni}$$</p><p>è¯æ˜ï¼šè‹¥ $k \mid n$ï¼Œé‚£ä¹ˆï¼š</p><p>$$\frac{1}{k} \sum\limits_{i = 0}^{k - 1} \omega_k^{ni} = \frac{1}{k} \sum\limits_{i = 0}^{k - 1} (\omega_k^n)^i = \frac{1}{k} \sum\limits_{i = 0}^{k - 1} \omega_k^0 = 1$$</p><p>è‹¥ $k \nmid n$ï¼Œé‚£ä¹ˆæ ¹æ®ç­‰æ¯”æ•°åˆ—æ±‚å’Œæœ‰ï¼š</p><p>$$\frac{1}{k} \sum\limits_{i = 0}^{k - 1} \omega_k^{ni} = \frac{1}{k} \frac{\omega_k^{nk} - \omega_k^0}{\omega_k^n - 1} = 0$$</p><p>åº”ç”¨äº $O(k)$ æå–å¤šé¡¹å¼æ‰€æœ‰ä¸‹æ ‡ä¸º $k$ å€æ•°çš„é¡¹æˆ–ç³»æ•°ï¼ˆè®¾ç¬¬ $i$ é¡¹ç³»æ•°ä¸º $a_i$ï¼Œä¸‹é¢æ˜¯æç³»æ•°ï¼‰ï¼š</p><p>$$\sum\limits_{i = 0}^{n / k} [x^{ik}] f(x)$$</p><p>$$= \sum\limits_{i = 0}^n [k \mid i] [x^i] f(x)$$</p><p>$$= \sum\limits_{i = 0}^n \frac{1}{k} \sum\limits_{j = 0}^{k - 1} \omega_k^{ij} [x^i] f(x)$$</p><p>$$= \frac{1}{k} \sum\limits_{j = 0}^{k - 1} \sum\limits_{i = 0}^n a_i (\omega_k^j)^i$$</p><p>$$= \frac{1}{k} \sum\limits_{j = 0}^{k - 1} f(\omega_{k}^j)$$</p><p>ç°æ¨ä¹Ÿéå¸¸æ–¹ä¾¿ï¼ã€Œæå–é¡¹ã€ä¸€ä¸ªé“ç†ï¼Œå°±ç°æ¨ä¸€ä¸‹å§ï¼Œæ€»æ˜¯èƒ½æŠŠå•ä½æ ¹ææˆå‡½æ•°è‡ªå˜é‡çš„ã€‚</p><p>ä¹ é¢˜ï¼š<a href="https://uoj.ac/problem/450" target="_blank" rel="noopener">å¤è¯»æœº</a> <a href="http://imilyx.github.io/2021/02/28/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%9121Feb%20%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/#%E5%A4%8D%E8%AF%BB%E6%9C%BA" target="_blank" rel="noopener">sol</a></p><p><a href="http://loj.ac/p/6485" target="_blank" rel="noopener">LJJ å­¦äºŒé¡¹å¼å®šç†</a> <a href="http://imilyx.github.io/2021/02/28/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%9121Feb%20%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/#LJJ-%E5%AD%A6%E4%BA%8C%E9%A1%B9%E5%BC%8F%E5%AE%9A%E7%90%86" target="_blank" rel="noopener">sol</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WC2021 æ¸¸è®°</title>
      <link href="2021/02/05/WC2021%20%E6%B8%B8%E8%AE%B0/"/>
      <url>2021/02/05/WC2021%20%E6%B8%B8%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="æ‚"><a href="#æ‚" class="headerlink" title="æ‚"></a>æ‚</h2><p>çº¿ä¸ŠçœŸÂ·æ¸¸è®°</p><p>T1 ä¸ºä»€ä¹ˆå°±æ²¡æ‰¾å‡ºæ¥æ€§è´¨å‘¢ï¼ŸCF åšå¤ªå°‘äº†ï¼Œæ€ç»´æ¨¡å¼å¤ª lowï¼T2 ä¸ºä»€ä¹ˆæ¨¡æ‹Ÿèµ›å‡ºç°ç±»ä¼¼çš„è¿˜æ˜¯ä¸ä¼šå‘¢ï¼Ÿæ²¡å¼„æ‡‚ï¼T3ï¼ŒT3 ä½ æ¨ä¸€åŠä¸ºä»€ä¹ˆä¸ä¼šäº†ï¼Ÿè¿™æ˜¯çœŸä¸ä¼šã€‚ã€‚ã€‚</p><hr><p>åˆ å‡º æˆ ç»© äº†ï¼Œ28 + 60 + 20 = 108 é“œï¼ŒT1 æŒ‚äº† 4 åˆ†ï¼Œç„¶è€Œå°±ç®—æ²¡æŒ‚åˆ†ä¹Ÿæ˜¯å·® 6 åˆ†é“¶ç‰Œï¼ˆå†™äº†é‚£å¥½éº»çƒ¦çš„ 10 åˆ†å°±é“¶äº† /kel</p><p><del>dsy: èµ›åç®—åˆ†ï¼Œåº¸äººè‡ªæ‰°</del></p><p>å·®è·æ²¡æœ‰å¾ˆå¤§ï¼Œä¹Ÿæ²¡æœ‰ç¼©å°å‘¢ï¼Œxml ä½ è¦ç»§ç»­åŠªåŠ›ï¼</p><hr><h2 id="æ”¹é¢˜"><a href="#æ”¹é¢˜" class="headerlink" title="æ”¹é¢˜"></a>æ”¹é¢˜</h2><p><a href="https://loj.ac/p?keyword=wc2021" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><h3 id="æ‹¬å·è·¯å¾„"><a href="#æ‹¬å·è·¯å¾„" class="headerlink" title="æ‹¬å·è·¯å¾„"></a>æ‹¬å·è·¯å¾„</h3><p>æ‰¾æ€§è´¨çš„èƒ½åŠ›è¿˜æ˜¯å¤ªèœäº†ã€‚ã€‚ã€‚<del>æˆ‘å†ä¸åˆ· CF å’Œ AT æˆ‘åå­—å€’è¿‡æ¥å†™ï¼</del> æ³¨æ„åˆ°è¿™æ ·çš„è·¯å¾„æ˜¯åŒå‘çš„ï¼Œè€Œä¸”è‹¥ (x, y) æ˜¯åˆæ³•å¯¹ï¼Œé‚£ä¹ˆä»»æ„ç‚¹ w åŒæ—¶ä¸ xã€y æœ‰æˆ–æ— è·¯å¾„ã€‚</p><p><strong>å³æœ‰åˆæ³•è·¯å¾„çš„å¯¹å½¢æˆçš„å›¢ä¸­ï¼Œä¸¤ä¸¤äº’è¾¾ï¼</strong></p><p>ç±»ä¼¼ã€ŒJoitter äº¤å‹ã€ï¼Œç¼©å°±å®Œäº‹äº†ã€‚å¹¶æŸ¥é›†ç»´æŠ¤è¿é€šæ€§ã€‚è®°å½•æ¯ä¸ªç‚¹çš„å‡ºå…¥æ‹¬å·ï¼Œ<del>é‡åˆ°åŒç§ç±»çš„å°±ä»äº†</del>ã€‚åˆå¹¶ç‚¹å¯¹é‡‡ç”¨å¯å‘å¼åˆå¹¶ã€‚äººæ‡’ç”¨äº† mapï¼Œä¸¤åª logã€‚</p><p><a href="https://loj.ac/s/1061222" target="_blank" rel="noopener">$Code$</a></p><h3 id="è¡¨è¾¾å¼æ±‚å€¼"><a href="#è¡¨è¾¾å¼æ±‚å€¼" class="headerlink" title="è¡¨è¾¾å¼æ±‚å€¼"></a>è¡¨è¾¾å¼æ±‚å€¼</h3><p>magic breeding? Ah~ åŠ å¼ºç‰ˆã€‚æ¯ä½æ˜¾ç„¶æ˜¯ç‹¬ç«‹çš„ã€‚è€ƒè™‘äºŒåˆ†çš„æ€æƒ³ï¼Œ$\geq lim$ çš„ä¸º $1$ï¼Œ$&lt; lim$ çš„ä¸º $0$ï¼Œé‚£ä¹ˆ $\max$ ä¸ºå–å¹¶ï¼Œ$\min$ ä¸ºå–äº¤ã€‚</p><p>æ‹¬å·å¾ˆæ¶å¿ƒï¼Œè¦å»ºè¡¨è¾¾å¼æ ‘ã€‚æˆ‘ä»¬é€‰æ‹©ä»åå¾€å‰å»ºã€‚å¶å­å¤„æ˜¯æ“ä½œ idï¼Œéå¶å­å¤„æ˜¯ $($ã€$)$ã€$&lt;$ã€$&gt;$ã€$?$</p><p>æœ¬é¢˜è¦ç»Ÿè®¡æ¯ä¸ªé›†åˆ $\geq$ æŸç§å–å€¼çš„æ–¹æ¡ˆæ•°æ‰èƒ½ç®—å‡ºè¯¥å–å€¼åœ¨ç­”æ¡ˆä¸­è´¡çŒ®çš„æ¬¡æ•°ã€‚</p><p>é›†åˆåªæœ‰ $2^m$ ç§ï¼Œå–å€¼å´æœ‰ $nm$ ç§ã€‚è€ƒè™‘ dp é¢„å¤„ç†, æšä¸¾é›†åˆè¡¨ç¤ºè¿™ä¸ªé›†åˆé‡Œçš„æ•°éƒ½ $\geq$ é‚£ä¸ªå€¼ï¼Œ$dp[x, 0/1]$ è¡¨ç¤ºåœ¨è¡¨è¾¾å¼æ ‘ä¸Š $x$ èŠ‚ç‚¹çš„å­æ ‘æœ‰å¤šå°‘ç§æ–¹æ¡ˆä½¿å¾—è¿ç®—ç»“æœä¸º $0$/$1$ã€‚</p><p>è¡¨è¾¾å¼æ ‘æ˜¯ä¸ªäºŒå‰æ ‘ã€‚åˆå¹¶ç­”æ¡ˆï¼Œè®°ä¿©å„¿å­ dp å€¼åˆ†åˆ«ä¸º $(x0, x1)$, $(y0, y1)$ï¼Œç»“æœè®°ä¸º $(z0, z1)$</p><ul><li>å¯¹äº $&gt;$: $z0 = x0 * y0$, $z1 = x0 * y1 + x1 * y0 + x1 * y1$</li><li>å¯¹äº $&lt;$: $z0 = x0 * y0 + x0 * y1 + x1 * y0$, $z1 = x1 * y1$</li><li>å¯¹äº $?$: ä¸Šé¢ä¸¤ç§åŠ èµ·æ¥ã€‚</li></ul><p>$O(2^m|E| + nm^2)$.</p><p><a href="https://loj.ac/s/1061278" target="_blank" rel="noopener">$Code$</a></p><h3 id="æ–æ³¢é‚£å¥‘"><a href="#æ–æ³¢é‚£å¥‘" class="headerlink" title="æ–æ³¢é‚£å¥‘"></a>æ–æ³¢é‚£å¥‘</h3><p>è¿™é“å’Œã€ŒWC2020-çŒœæ•°æ¸¸æˆã€éƒ½å…ˆå’•å’•</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>åäºŒçœè”è€ƒ2019 ä¹±å†™</title>
      <link href="2021/02/04/%E5%8D%81%E4%BA%8C%E7%9C%81%E8%81%94%E8%80%832019%20%E4%B9%B1%E5%86%99/"/>
      <url>2021/02/04/%E5%8D%81%E4%BA%8C%E7%9C%81%E8%81%94%E8%80%832019%20%E4%B9%B1%E5%86%99/</url>
      
        <content type="html"><![CDATA[<p><a href="https://loj.ac/p?keyword=%E5%8D%81%E4%BA%8C%E7%9C%81%E8%81%94%E8%80%83" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><h2 id="å¼‚æˆ–ç²½å­"><a href="#å¼‚æˆ–ç²½å­" class="headerlink" title="å¼‚æˆ–ç²½å­"></a>å¼‚æˆ–ç²½å­</h2><p>å¯æŒä¹…åŒ– Trie æ ‘ + ã€Œè¶…çº§é’¢ç´ã€åšæ³•ã€‚</p><p>åŠ å¼ºç‰ˆï¼š$k \leq \frac{n(n - 1)}{2}$ã€‚<a href="https://imilyx.github.io/2021/01/31/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%9121Jan%20%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/#T3-1" target="_blank" rel="noopener">é¢˜è§£</a></p><h2 id="å­—ç¬¦ä¸²é—®é¢˜"><a href="#å­—ç¬¦ä¸²é—®é¢˜" class="headerlink" title="å­—ç¬¦ä¸²é—®é¢˜"></a>å­—ç¬¦ä¸²é—®é¢˜</h2><p>å¾ˆè‡ªç„¶<del>å¥—è·¯</del>çš„é¢˜ï¼Œå®¹æ˜“æƒ³åˆ°å»ºè¾¹ç”¨å›¾åšï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª $A$ å‘å®ƒæ”¯é…çš„ $B$ è¿è¾¹ï¼Œè¿™ä¸ª $B$ å†å‘ä»¥å®ƒä¸ºå‰ç¼€çš„ $A$ è¿è¾¹ï¼Œæš´åŠ›è¿ $O(n^2)$ï¼Œè€ƒè™‘ä¼˜åŒ–ã€‚</p><p>è€å¥—è·¯ï¼Œè€ƒè™‘å›¾/æ ‘ä¼˜åŒ–å»ºè¾¹ï¼Œè¿™é‡Œå¯¹åä¸²å»º $SAM$ï¼ŒæŠŠ $A$ ä¸²å’Œ $B$ ä¸²æŒ‚åœ¨å¯¹åº”çš„åç¼€æ ‘èŠ‚ç‚¹ä¸‹ï¼ŒåŒä¸ªèŠ‚ç‚¹æŒ‚ç€çš„ä¸²ç›¸é‚»è¿è¾¹å°±é¿å…äº†ä¸€ä¸ª $A$ å‘ä¸€å † $A$ è¿çš„æƒ…å†µã€‚</p><p><a href="https://loj.ac/s/1017579" target="_blank" rel="noopener">$Code$</a></p><h2 id="éª—åˆ†è¿‡æ ·ä¾‹"><a href="#éª—åˆ†è¿‡æ ·ä¾‹" class="headerlink" title="éª—åˆ†è¿‡æ ·ä¾‹"></a>éª—åˆ†è¿‡æ ·ä¾‹</h2><p>å’•å’•</p><h2 id="çš®é…"><a href="#çš®é…" class="headerlink" title="çš®é…"></a>çš®é…</h2><p>è¿™é¢˜ä¸è®²å””å¾—ï¼Œå®ƒç”¨ç¹å¤šçš„å˜é‡æ¥æä½ å¿ƒæ€ï¼<del>å¤§æ„äº†å•Šæ²¡æœ‰é—ª</del></p><p>æ’‡å¼€è¿™ç‚¹ï¼Œé¢˜å¹¶ä¸éš¾ï¼ˆä½†æœ‰ç‚¹è€ƒé€»è¾‘</p><p>é¦–å…ˆå‘ç°æ´¾ç³»å’Œé˜µè¥æ˜¯äº¤é”™çš„ï¼Œä¸ç®¡åŸå¸‚é€‰ä»€ä¹ˆé˜µè¥ï¼Œé‡Œé¢çš„å­¦æ ¡éƒ½å¯ä»¥ä»»æ„é€‰æ´¾ç³»ï¼ŒåŸå¸‚çš„å†³å®šå’Œå­¦æ ¡çš„å†³å®šå…±åŒå†³å®šäº†å¯¼å¸ˆã€‚<strong>ä¹Ÿå°±æ˜¯è¯´åŸå¸‚å’Œå­¦æ ¡ç‹¬ç«‹ã€‚</strong></p><p>å…ˆè€ƒè™‘ $k = 0$ çš„æƒ…å†µï¼Œåˆ†åˆ« $dp$ ç®—å‡º $f[i, j]$ è¡¨ç¤ºå‰ $i$ ä¸ªåŸå¸‚ï¼Œ$j$ ä¸ªäººåœ¨è“é˜µè¥çš„æ–¹æ¡ˆæ•°ï¼›<br>$g[i, j]$ è¡¨ç¤ºå‰ $i$ ä¸ªåŸå¸‚ï¼Œ$j$ ä¸ªäººåœ¨é¸­æ´¾ç³»çš„æ–¹æ¡ˆæ•°ã€‚åˆæ³•çš„ç›¸ä¹˜ã€‚</p><p>æŒ‰ç…§é€‰è¯¾çš„å¥—è·¯ï¼Œ$k = 0$ çš„æƒ…å†µï¼Œæ²¡æœ‰é™åˆ¶çš„åŸå¸‚å’Œå­¦æ ¡åŒä¸Šåšï¼›<br>$k \neq 0$ï¼Œæœ‰é™åˆ¶çš„åŸå¸‚éœ€è¦é€‰åŒä¸ªé˜µè¥ï¼ŒåŒåŸå¸‚çš„å­¦æ ¡å°±å¿…é¡»æ†ç»‘è€ƒè™‘äº†ï¼š$f[i, j, k]$ è¡¨ç¤ºå‰ $i$ ä¸ªåŸå¸‚è“é˜µè¥äººæ•°ä¸º $j$ï¼Œé¸­æ´¾ç³»äººæ•°ä¸º $k$ çš„æ–¹æ¡ˆæ•°ã€‚</p><p>ç„¶åæ»šæ‰ä¸€ç»´å°±èƒ½ AC è¾£!</p><p><a href="https://loj.ac/s/1017744" target="_blank" rel="noopener">$Code$</a></p><h2 id="æ˜¥èŠ‚åäºŒå“"><a href="#æ˜¥èŠ‚åäºŒå“" class="headerlink" title="æ˜¥èŠ‚åäºŒå“"></a>æ˜¥èŠ‚åäºŒå“</h2><p>æ’•çƒ¤æ€ä¹ˆåˆå¹¶é“¾ï¼Œå¿…ç„¶æ˜¯è´ªå¿ƒçš„å¤§é…å¤§ã€å°é…å°ã€‚æ‹¿å †ç»´æŠ¤ä¸€ä¸‹ï¼ŒåŠ ä¸ªå¯å‘å¼åˆå¹¶å°± AC äº†ã€‚</p><p><a href="https://loj.ac/s/1017408" target="_blank" rel="noopener">$Code$</a></p><h2 id="å¸Œæœ›"><a href="#å¸Œæœ›" class="headerlink" title="å¸Œæœ›"></a>å¸Œæœ›</h2><p>åˆ«è¢«é«˜å¤§ä¸Šçš„é¢˜ç›®å”¬ä½äº†ï¼æ€è·¯å°±æ˜¯ç®—ä¸€ä¸ªæ•‘æ´é˜Ÿçš„ç­”æ¡ˆï¼Œç„¶å $k$ æ¬¡æ–¹ã€‚ç‚¹ $x$ å­æ ‘é‡Œå’Œå­æ ‘å¤–çš„è¦åˆ†å¼€ç®—ã€‚è€ƒè™‘ç›´æ¥ç®—ä¼šç®—é‡â€”â€”ä¸€ä¸ªè¿é€šå—ä¼šè¢«ç®—å¤šæ¬¡ï¼Œåº”ç”¨ç»å…¸â€œç‚¹å‡è¾¹â€æ€æƒ³â€”â€”è¿é€šå—ä¸­ç‚¹æ•° = è¾¹æ•° $+ 1$ï¼Œå°±ç”¨ç‚¹çš„ç­”æ¡ˆå‡å»è¾¹çš„ç­”æ¡ˆã€‚</p><p>$f[x, i]$ è¡¨ç¤ºå­æ ‘é‡Œæ·±åº¦ä¸è¶…è¿‡ $i$ çš„è¿é€šå—æ–¹æ¡ˆæ•°ï¼Œ$g[x, i]$ è¡¨ç¤ºä¸åŒ…æ‹¬å­æ ‘é‡Œï¼ˆä½†åŒ…æ‹¬ $x$ï¼‰çš„æ·±åº¦ä¸è¶…è¿‡ $i$ çš„è¿é€šå—æ–¹æ¡ˆæ•°ï¼Œä¸¤ä¸ªä¸€ä¹˜å²‚ä¸ç¾å“‰ï¼Ÿ</p><p>è½¬ç§»æ–¹ç¨‹è¶…å¥½å†™ï¼š</p><ul><li>$f[x, i] = (\prod f[y, i - 1]) + 1$</li><li>$g[x, i] = (g[fa[x], i - 1] \prod f[son[fa[x]], i - 2]) + 1$</li></ul><p>$n$ $1e6$, $dp$ åˆä¸æ·±åº¦æœ‰å…³ï¼Œäºæ˜¯æƒ³åˆ°é•¿å‰–ä¼˜åŒ–ã€‚æœ¬é¢˜çš„æ€è·¯åˆ°æ­¤ä¸ºæ­¢ï¼Œæ¥ä¸‹æ¥ éƒ½ æ˜¯ ç»† èŠ‚</p><p>$f$ å¯ä»¥ç›´æ¥ç®—ï¼Œä½†æ˜¯ $g$ é‡Œé¢é‚£ä¸ª $\prod$ ä¸å¥½æã€‚</p><p>ç”¨å›é€€æ ˆå¯ä»¥ç»´æŠ¤ï¼Œåš $f$ çš„æ—¶å€™ä»é•¿åˆ°çŸ­éå†å­æ ‘ï¼Œåš $g$ çš„æ—¶å€™ä»çŸ­åˆ°é•¿éå†å­æ ‘ã€‚</p><p><a href="https://loj.ac/s/1009842" target="_blank" rel="noopener">$Code$</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>[é›†è®­é˜Ÿä½œä¸š2018]-å›´ç»•ç€æˆ‘ä»¬çš„åœ†ç¯</title>
      <link href="2021/02/03/%5B%E9%9B%86%E8%AE%AD%E9%98%9F%E4%BD%9C%E4%B8%9A2018%5D-%E5%9B%B4%E7%BB%95%E7%9D%80%E6%88%91%E4%BB%AC%E7%9A%84%E5%9C%86%E7%8E%AF/"/>
      <url>2021/02/03/%5B%E9%9B%86%E8%AE%AD%E9%98%9F%E4%BD%9C%E4%B8%9A2018%5D-%E5%9B%B4%E7%BB%95%E7%9D%80%E6%88%91%E4%BB%AC%E7%9A%84%E5%9C%86%E7%8E%AF/</url>
      
        <content type="html"><![CDATA[<p><a href="https://loj.ac/p/6040" target="_blank" rel="noopener">$LOJ6040$</a> åŠ å¼ºç‰ˆã€‚é«˜å¦™çš„çº¿ä»£é¢˜ï¼Œè™½ç„¶åªç”¨åˆ°äº†ç§©å’Œçº¿æ€§ç©ºé—´çš„æ¦‚å¿µï¼ˆå®Œå…¨ä¸åƒä»Šå¤©å›½å®¶é˜Ÿçˆ·è®²è¯¾é‚£æ ·è®©äººæ‘¸ä¸ç€å¤´å‘å“¼ï¼ï¼‰</p><p>ï¼ˆæ¥ä¸‹æ¥éƒ½ç”¨æœ¬é¢˜ä¸­çš„ $p$ã€$q$ã€$s$ï¼Œè¿™æ ·æ¯”è¾ƒä¸¥è°¨ï¼‰</p><p>å›é¡¾çŸ©é˜µä¹˜æ³•ï¼š$A(x, y) * B(y, z) \rightarrow C(x, z)$ï¼ˆç»•æ™•äº†å°±çœ‹çœ‹è¿™ä¸ªğŸ‘ˆï¼‰</p><p>è€ƒè™‘æ— ä¿®æ”¹æ€ä¹ˆåšï¼Œæ¯«æ— å¤´ç»ªï¼ˆ</p><p>è§‚å¯Ÿ $A$ å’Œ $C$ çš„å…³ç³»ï¼š$C$ çš„åˆ—å‘é‡ä¸€å®šåœ¨ $A$ åˆ—å‘é‡ç»„æˆçš„çº¿æ€§ç©ºé—´é‡Œã€‚</p><p>è®¾ $A$ çš„ï¼ˆåˆ—ï¼‰ç§©ä¸º $x$ï¼Œ$C$ çš„ï¼ˆåˆ—ï¼‰ç§©ä¸º $r$ã€‚å¯¹äº $B$ çš„æ¯ä¸€åˆ—éƒ½å¯ä»¥åˆ—å‡ºä¸€ä¸ªæœ‰ $x$ ä¸ªçº¿æ€§æ— å…³çš„æ–¹ç¨‹çš„æ–¹ç¨‹ç»„ï¼Œé‚£ä¹ˆè‡ªç”±å…ƒæœ‰ $q - x$ ä¸ªï¼Œä¸€åˆ—çš„æ–¹æ¡ˆæ•°æ˜¯ $2^{q - x}$ã€‚å› æ­¤<strong>åœ¨ $A$ å’Œ $C$ çš„ç§©ç¡®å®šæ—¶</strong>ï¼Œ$B$ æ–¹æ¡ˆæ•°å°±æ˜¯ $(2^{q - x})^s$ã€‚</p><p>ç°åœ¨æˆ‘ä»¬è¦ç»Ÿè®¡â€œç§©ä¸º $x$ ä¸”åˆ—å‘é‡çš„çº¿æ€§ç©ºé—´åŒ…å« $C$ çš„ $A$ æ–¹æ¡ˆæ•°â€ã€‚è¿™ä¸å¥½ç®—ã€‚</p><p>dp, $f_{i, j}$ è¡¨ç¤º $i * q$ çš„çŸ©é˜µï¼Œç§©ä¸º $j$ çš„æ–¹æ¡ˆæ•°ï¼Œè½¬ç§»ç±»ä¼¼çº¿æ€§åŸº dpã€‚ç»Ÿè®¡â€œç§©ä¸º $x$ ä¸”åˆ—å‘é‡çš„çº¿æ€§ç©ºé—´åŒ…å«ç§©ä¸º $r$ çš„ $C$ çš„ $A$ æ–¹æ¡ˆæ•°â€ï¼Œæœ€åç­”æ¡ˆé™¤ä»¥ $g_{p, r}$ã€‚é‚£ä¹ˆ $A$ çš„æ–¹æ¡ˆæ•°å°±æ˜¯ $f_{q, x}$ï¼Œ$C$ çš„æ–¹æ¡ˆæ•°å°±æ˜¯ $g_{x, r}$ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p><p>å› ä¸º<strong>è¡Œç§© = åˆ—ç§©</strong>ï¼Œ$C$ ä¸­å¯¹åº” $A$ çš„é‚£ $x$ è¡Œç¡®å®šåå‰©ä¸‹çš„è¡Œå°±åƒ $A$ ä¸­å‰©ä¸‹çš„è¡Œé‚£æ ·èƒ½è¢«é‚£ $x$ è¡Œè¡¨å‡ºçš„ã€‚</p><p>ç­”æ¡ˆå°±æ˜¯ $\sum\limits_{x = r}^q f_{q, x} g_{x, r} (2^{q - x})^s$</p><p><a href="https://loj.ac/s/1056871" target="_blank" rel="noopener">$LOJ6040\ Code$</a></p><p>æœ¬é¢˜è¦æˆ‘ä»¬åŠ¨æ€æ±‚çŸ©é˜µçš„ç§©ã€‚</p><p>å¤§æ¦‚å°±æ˜¯ä¸ªçº¿æ€§åŸºçŠ¶ç‰©çš„æ’å…¥å’Œåˆ é™¤ã€‚åˆ é™¤æ€ä¹ˆæï¼Ÿ<a href="https://blog.csdn.net/a_forever_dream/article/details/83654397" target="_blank" rel="noopener">å¤§ä½¬æ¯”è¾ƒè¯¦ç»†çš„è§£è¯´</a> è€ƒè™‘åˆ é™¤å‘é‡ $x$ åæˆ‘ä»¬è¦å°½é‡æ‰¾ä¸€ä¸ªæ¥æ›¿ä»£ $x$ã€‚å¯¹çº¿æ€§åŸºé‡Œæ¯ä¸ªå‘é‡è®°å½•å®ƒæ’å…¥æ—¶å¼‚æˆ–äº†å“ªäº›å‘é‡ã€‚æ‰¾åˆ°ã€Œå—æœ¬æ¬¡åˆ é™¤å½±å“ã€çš„åŸºå¤–å‘é‡ $y$ï¼Œå¦‚æœä¸å­˜åœ¨åŸºå¤–çš„å°±æ‰¾åŸºå†…æœ€ä½çš„ï¼ˆè¿™æ ·åœ¨åˆ é™¤æ—¶å°±ä¸ä¼šå½±å“æ›´ä½ä½çš„å‘é‡ï¼‰ï¼ŒæŠŠ $y$ å…¶å®ƒå—å½±å“çš„å‘é‡å¼‚æˆ–ä¸Š $y$ï¼ˆ$y$ è‡ªå·±å˜æˆ $0$ï¼Œè¿™æ ·å°±èƒ½æ¶ˆé™¤ $x$ åœ¨çº¿æ€§åŸºé‡Œçš„å½±å“ï¼Œç›¸å½“äºç”¨ $y$ æ›¿ä»£äº† $x$ï¼‰ï¼›å¦‚æœæ‰¾çš„æ˜¯åŸºå†…çš„ï¼Œç§©æ•° $-1$ã€‚</p><p>ç”¨ bitsetï¼Œ$O(\frac{n^3}{\omega})$</p><p><a href="https://uoj.ac/submission/453202" target="_blank" rel="noopener">$Code$</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿æ€§ä»£æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘å¸¦æƒäºŒåˆ†</title>
      <link href="2021/02/03/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E5%B8%A6%E6%9D%83%E4%BA%8C%E5%88%86/"/>
      <url>2021/02/03/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E5%B8%A6%E6%9D%83%E4%BA%8C%E5%88%86/</url>
      
        <content type="html"><![CDATA[<p>è¿™ç©æ„å„¿å…¶å®æ—©å‡ ä¸ªæœˆå°±å­¦äº†ï¼Œç°åœ¨æ¥è¡¥ç¬”è®°ã€‚</p><p>å¸¦æƒäºŒåˆ†åˆç§° wqs äºŒåˆ†ï¼Œè§£å†³çš„æ˜¯è¿™æ ·ä¸€ç±»é—®é¢˜ï¼šæœ‰ $n$ ä¸ªç‰©å“ï¼Œéœ€è¦åœ¨å¼ºåˆ¶é€‰ $K$ ä¸ªç‰©å“çš„å‰æä¸‹æœ€å¤§/æœ€å°åŒ–ä»£ä»·ï¼›è®¾å¼ºåˆ¶é€‰ $K$ ä¸ªçš„ä»£ä»·æœ€å€¼ä¸º $val(K)$ï¼Œ$val(K)$ æ— æ³•ç›´æ¥æ±‚å¾—ï¼Œä½†æ˜¯ $val$ å‡½æ•°çš„æœ€å€¼ä»¥åŠå–åˆ°æœ€å€¼çš„ä½ç½®å¯ä»¥æ±‚ï¼Œå¹¶ä¸” <strong>$val$ æ˜¯ä¸€ä¸ªå‡¸å‡½æ•°</strong>ã€‚</p><p>ç°åœ¨è®¨è®ºæ±‚ä¸Šå‡¸å‡½æ•°æœ€å¤§å€¼ï¼ˆä¸‹å‡¸å‡½æ•°æœ€å°å€¼ä¸€ä¸ªé“ç†ï¼‰ã€‚ä»¤ $f(x) = val(x) + kx$ï¼Œ$k$ çš„å®é™…æ„ä¹‰æ˜¯ã€Œå¤šé€‰ä¸€ä¸ªç‰©å“å°±è¦ä»˜å‡ºçš„ä»£ä»·ã€ï¼Œåœ¨åæ ‡ç³»ä¸Šå°±æ˜¯å°† $val$ çš„å¯¼å‡½æ•°å‘ä¸Šå¹³ç§»äº† $k$ã€‚å¯¼å‡½æ•°ä¸ $x$ è½´çš„äº¤ç‚¹å¯¹åº”çš„å°±æ˜¯ $val$ çš„æœ€é«˜ç‚¹ï¼Œä¸”ä¸Šå‡¸å‡½æ•°çš„å¯¼å‡½æ•°é€’å‡ï¼Œå› æ­¤ <strong>$k$ å˜å¤§ï¼Œæœ€å€¼ç‚¹å³ç§»</strong>ï¼Œå¯äºŒåˆ†ã€‚æœ€åè®© $val(K) = f(K) - kx$ã€‚</p><p>æ±‚ä¸‹å‡¸å‡½æ•°æœ€å°å€¼ï¼Œ**$k$ å˜å¤§ï¼Œæœ€å€¼ç‚¹å·¦ç§»**</p><p><strong>è°ƒè¾¹ç•Œæ˜¯çœŸçš„æ¶å¿ƒ</strong>ï¼Œè‡ªé—­äº†</p><p>ä¹ é¢˜ï¼š<a href="https://loj.ac/p/2478" target="_blank" rel="noopener">æ—å…‹å¡ç‰¹æ ‘</a> <a href="https://imilyx.github.io/2021/02/02/%E4%B9%9D%E7%9C%81%E8%81%94%E8%80%832018%20%E4%B9%B1%E5%86%99/#%E6%9E%97%E5%85%8B%E5%8D%A1%E7%89%B9%E6%A0%91" target="_blank" rel="noopener">é¢˜è§£</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å¸¦æƒäºŒåˆ† </tag>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åšå®¢æŠ˜è…¾å°è®°</title>
      <link href="2021/02/02/%E5%8D%9A%E5%AE%A2%E6%8A%98%E8%85%BE%E5%B0%8F%E8%AE%B0/"/>
      <url>2021/02/02/%E5%8D%9A%E5%AE%A2%E6%8A%98%E8%85%BE%E5%B0%8F%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸¤å¤©å¼ ç½—ç€ç»™åšå®¢æ¢äº† cactus_light çš„ themeï¼Œéšä¹‹è€Œæ¥çš„æ˜¯ä¸€å¤§å †é—®é¢˜ã€‚ã€‚ã€‚ä¸€ä¸ªä¸ªæ”»å…‹è¿˜è›®æœ‰æ„æ€çš„ï¼å†™ç¯‡è®°å½•ä¸€ä¸‹ã€‚</p><p>\Hexo ä¸‹çš„ _config é‡Œæ”¹ themeï¼Œnav é‚£é‡Œå¯ä»¥æ·»åŠ å†…å®¹ï¼Œæ¯”å¦‚æˆ‘å°±åŠ äº†ã€Œæœç´¢ã€ã€ã€Œå‹é“¾ã€ã€ã€Œå…³äºã€ç­‰åŠŸèƒ½ã€‚</p><p>æ–°å»ºåä¸º tmp çš„é¡µé¢å°±åœ¨ç»ˆç«¯è¾“å…¥ hexo new page tmpã€‚\Hexo\source é‡Œä¼šå‡ºç°æ–°æ–‡ä»¶å¤¹ï¼Œå¦‚æœæƒ³è®©æ·»åŠ çš„å†…å®¹åœ¨ç½‘é¡µä¸Šå¯è§†ï¼Œåœ¨æ–°æ–‡ä»¶å¤¹é‡Œçš„ index çš„ front-matter å¤„å†™ type: â€œtmpâ€</p><p>ã€Œæœç´¢ã€é‚£é‡Œç©ºæ— ä¸€ç‰©ï¼ä¸‹æ’ä»¶å•¦ã€‚</p><p>å¤´åƒå°±æŠŠ image é‚£é‡Œçš„ logo.png åˆ äº†æ”¾æ–°çš„-_-|| ç®€å•æ„‰å¿«</p><p>å¢æ·»äº†éšè—æ–‡ç« çš„åŠŸèƒ½ï¼ä¸‹äº†æ’ä»¶ï¼Œä»¥åæƒ³éšè—å°±åªè¦åœ¨ front-matter å¤„å†™ hidden: true å°±å¥½äº†ï¼Œæ–¹ä¾¿è¯¶</p><p>latex éš¾æï¼Œæ–°ä¸»é¢˜ä¸æ”¯æŒ-_-|| å…œå…œè½¬è½¬å…ˆä¸‹äº† hexo-mathï¼Œä½†æ˜¯ç”¨ä¸äº†ã€‚ã€‚äºæ˜¯å‚è€ƒäº†<a href="https:\blog.csdn.net\u014630987\article\details\78670258" target="_blank" rel="noopener">è¿™ç¯‡</a>ã€‚çœŸçš„æ„Ÿè°¢å®ƒï¼Œlatex æ¸²æŸ“æˆåŠŸçš„é‚£ä¸€åˆ»æ„Ÿå¤©åŠ¨åœ°ã€‚</p><p>æ–°ä¸»é¢˜ä»£ç å—é«˜äº®é¢œè‰²å¥½æ¶å¿ƒå•Šï¼<strong>å¹¸å¥½æœ‰ cactus å¼€å‘è€…å†™çš„ README</strong>ï¼Œè¦è®°å¾—çœ‹ README ä¸ç„¶äº‹å€åŠŸåŠã€‚</p><p>è°ƒæ•´ä»£ç è¯¦æƒ…ï¼Œåœ¨ \cactus\source\css ä¸‹çš„ style.styl é‡Œæ”¹ï¼Œæ¯”å¦‚æˆ‘å°±æ”¹äº† border-radius ä¸º 10pxï¼Œè¾¹è§’åœ†æ¶¦äº†è®¸å¤šã€è€¶</p>]]></content>
      
      
      
        <tags>
            
            <tag> å…¶ä»– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¹çœè”è€ƒ2018 ä¹±å†™</title>
      <link href="2021/02/02/%E4%B9%9D%E7%9C%81%E8%81%94%E8%80%832018%20%E4%B9%B1%E5%86%99/"/>
      <url>2021/02/02/%E4%B9%9D%E7%9C%81%E8%81%94%E8%80%832018%20%E4%B9%B1%E5%86%99/</url>
      
        <content type="html"><![CDATA[<p><a href="https://loj.ac/p?keyword=%E4%B9%9D%E7%9C%81%E8%81%94%E8%80%83" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>æŒ‰é¢˜è§£ç¯‡å¹…çœ‹å°±çŸ¥é“ã€Œç§˜å¯†è¢­å‡»ã€æ˜¯ã€Œåˆ‡æ ‘æ¸¸æˆã€é‚£æ ·çš„ç¥å¥—è·¯é¢˜äº†å§ã€‚ï¼ˆä¸è¿‡ã€Œåˆ‡æ ‘æ¸¸æˆã€æ¯’ç˜¤å¤šäº†-_-||</p><h2 id="ä¸€åŒæœ¨æ£‹"><a href="#ä¸€åŒæœ¨æ£‹" class="headerlink" title="$ä¸€åŒæœ¨æ£‹$"></a>$ä¸€åŒæœ¨æ£‹$</h2><hr><p>æœ‰ã€Œ$pos_i \leq pos_{i - 1}$ã€çš„é™åˆ¶ï¼Œç›´æ¥çŠ¶å‹è½®å»“çŠ¶æ€æ•°å°±æ˜¯ $\binom{n + m - 1}{m - 1}$ï¼Œä¸åˆ° $10^5$ã€‚æœç´¢è§£å†³ min-max åšå¼ˆã€‚</p><p><a href="https://loj.ac/s/1054666" target="_blank" rel="noopener">$Code$</a></p><h2 id="IIIDX"><a href="#IIIDX" class="headerlink" title="$IIIDX$"></a>$IIIDX$</h2><hr><p>æˆ‘å¤ªèœäº†ï¼ç›´æ¥è´ªå¿ƒåœ¨ $d$ æœ‰é‡å¤çš„æ—¶å€™æ˜¯é”™çš„ï¼Œæ¯”å¦‚ $n = 4$, $k = 2.0$, $1$ $1$ $1$ $2$ å’Œ $1$ $1$ $2$ $1$ã€‚</p><p>æ­£è§£æŒºçµæ´»çš„ã€‚å»ºæ ‘ï¼ŒæŠŠ $d$ ä»å¤§åˆ°å°æ’åºã€‚å¯¹æ¯ä¸ªæƒå€¼ç»´æŠ¤ä¸€ä¸ª $c_i$ è¡¨ç¤º<strong>åˆ«çš„èŠ‚ç‚¹è‡³å¤šèƒ½åœ¨ $i$ å·¦è¾¹æ‹¿èµ°å‡ ä¸ª</strong>ã€‚æˆ‘ä»¬çŸ¥é“æŠŠ $i$ å¡«åˆ° $x$ ç‚¹å°±è¦åœ¨ $i$ å·¦è¾¹é¢„ç•™å‡º $size[x]$ ä¸ªç©ºä½æ”¾åˆ° $x$ çš„å­æ ‘é‡Œï¼Œä½†æ˜¯ä¸èƒ½ç¡®å®šæ˜¯å“ªäº›ä¸ªç©ºä½å› ä¸ºä¼šå½±å“åé¢çš„åˆ¤å®šã€‚è¿™æ—¶è¦æŠŠ $[i, n]$ çš„ $c$ å‡å» $size[x]$ã€‚</p><p><strong>$c$ å®é™…ä¸Šæ˜¯ç”¨æ¥é™åˆ¶åŒå±‚çš„</strong>ï¼Œæ‰€ä»¥å¾€ä¸‹èµ°åˆ°å„¿å­æ—¶ï¼Œè¦æŠŠçˆ¶äº²ç»™å®ƒé¢„ç•™çš„ä½ç½®é‡Šæ”¾æ‰ã€‚</p><p><a href="https://loj.ac/s/1055202" target="_blank" rel="noopener">$Code$</a></p><h2 id="ç§˜å¯†è¢­å‡»"><a href="#ç§˜å¯†è¢­å‡»" class="headerlink" title="$ç§˜å¯†è¢­å‡»$"></a>$ç§˜å¯†è¢­å‡»$</h2><hr><p>æ±‚æ ‘çš„æ¯ä¸ªè¿é€šå—ç¬¬ $K$ å¤§æƒå€¼ä¹‹å’Œã€‚ç±»ä¼¼æ•´æ•°æ¦‚ç‡å…¬å¼ä¸€æ ·çš„æ‹†åˆ†æƒå€¼ï¼š</p><p>$$Ans = \sum\limits_{S} Kth \in S = \sum\limits_{i = 1}^W i \sum\limits_S [Kth \in S == i]$$</p><p>$$= \sum\limits_{i = 1}^W \sum\limits_{S} [Kth \in S \geq i] = \sum\limits_{i = 1}^W \sum\limits_S [cnt(S, i) \geq K]$$</p><p>å…¶ä¸­ $cnt(S, i)$ è¡¨ç¤ºè¿é€šå— $S$ ä¸­æƒå€¼ $\geq i$ çš„ç‚¹æ•°ã€‚</p><p>é—®é¢˜è½¬åŒ–ä¸ºï¼šæšä¸¾æƒå€¼ $v$ï¼Œç»Ÿè®¡ $\geq v$ çš„æƒå€¼å‡ºç°æ¬¡æ•° $\geq K$ çš„è¿é€šå—ä¸ªæ•°ã€‚ </p><p>è¿™ä¼¼ä¹å¯ä»¥ dpï¼Ÿï¼$f_{i, j, k}$ è¡¨ç¤ºä»¥ $i$ ä¸ºæœ€æµ…ç‚¹ï¼Œæƒå€¼ $\geq j$ çš„å‡ºç°æ¬¡æ•°ä¸º $k$ çš„è¿é€šå—æ•°ã€‚æœ‰ï¼š$f_{i, j, k} = \prod\limits_{v \in Son(i)} f_{v, j, kâ€™}(\sum kâ€™ = k - (val_i \geq j))$ã€‚ç­”æ¡ˆå°±æ˜¯ $\sum\limits_{k = K}^n \sum\limits_{i = 1}^n \sum\limits_{j = 1}^W f_{i, j, k}$ã€‚ä»¤ $g_{i, j, k} = \sum\limits_{x \in subtree(i)} f_{x, j, k}$ï¼Œæˆ‘ä»¬æ±‚çš„å®é™…ä¸Šæ˜¯ $\sum\limits_{k = K}^n \sum\limits_{i = 1}^W g_{1, i, k}$</p><p>ï¼ˆæ®è¯´ $O(n^2K)$ èƒ½è¿‡ï¼Œä½†æ¥éƒ½æ¥äº†æ˜¯å§ï¼‰</p><p>ä¸Šé¢é‚£ä¸ªèƒŒåŒ…é•¿å¾—ä¸€è„¸ç”Ÿæˆå‡½æ•°ï¼Œé‚£å°±å¦‚å®ƒæ‰€æ„¿ï¼šä»¤ $F_{i, j} = \sum\limits_{k = 0}^n f_{i, j, k} * z^k$ï¼Œ$G_{i, j} = \sum\limits_{x \in subtree(i)} F_{x, j}$ã€‚æœ‰ $F_{i, j} = (val_i \geq j\ ?\ z\ :\ 1) * \prod (F_{son_i, j} + 1)$, $G_{i, j} = F_{i, j} + \sum G_{son_i, j}$</p><p>å¸¦ $n + 1$ ä¸ªç‚¹å€¼ $z$ è¿›å»ï¼Œè®© $F$ å’Œ $G$ æ˜¯ç‚¹å€¼çŠ¶æ€ï¼Œè½¬ç§»å°±æ˜¯<strong>å¯¹åº”ä½ç›¸ä¹˜</strong>ï¼Œæœ€åå†æ‹‰æ ¼æœ—æ—¥æ’å€¼<a href="https://blog.csdn.net/CRZbulabula/article/details/61210514" target="_blank" rel="noopener"><strong>è¿˜åŸç³»æ•°</strong></a>å¾—åˆ° $g$ã€‚</p><p>å¯¹åº”ä½ç›¸ä¹˜ï¼Ÿé‚£å°±ç”¨æ•´ä½“ dp çš„æ€æƒ³åœ¨æ¯ä¸ªç‚¹ä¸Šç»´æŠ¤ä¸€æ£µçº¿æ®µæ ‘ï¼Œçº¿æ®µæ ‘æ¯ä¸ªèŠ‚ç‚¹ä¸Šæœ‰ä¸ªå½¢å¼å¹‚çº§æ•°ã€‚è€ƒè™‘æˆ‘ä»¬è¦å¹²ä»€ä¹ˆï¼ŒåŒºé—´ä¹˜ $z$ï¼Œå…¨å±€ $+1$ï¼Œå¯¹åº”ä½ç½®ç›¸ä¹˜ï¼Œç»´æŠ¤å…¨å±€ç­”æ¡ˆã€‚</p><ul><li>åˆå§‹åŒ–ï¼Œ$(F, G) = (1, 0)$</li><li>å¦‚æœ $val_i \geq j$ é‚£ä¹ˆ $(F, G) \rightarrow (F * z, G)$</li><li>åˆå¹¶ï¼Œ$(F, G) \rightarrow (F(1 + F_v), G + G_v)$</li><li>$(F, G) \rightarrow (F, G + F)$</li></ul><p>éå¸¸ç¹çï¼Œæˆ‘ä»¬ç”¨çŸ©é˜µæ¥è½¬ç§»ã€‚ä½†æ˜¯çŸ©é˜µå¸¸æ•°å¤§<del>è·‘ä¸è¿‡æš´åŠ›</del>ï¼Œè€ƒè™‘å‡½æ•°å¤åˆç»´æŠ¤ tagï¼ˆè¿™ä¸€æ­¥è¿‡äºç¥å¥‡ï¼‰ï¼šè§‚å¯Ÿåˆ° $F$ åªä¼šå˜æˆ $aF + b$, $G$ åªä¼šå˜æˆ $G + cF + d$ï¼Œäºæ˜¯æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤ä¸€ä¸ªå››å…ƒç»„ $(a, b, c, d)$ è¡¨ç¤º $(aF + b, cF + d + G)$ã€‚åˆå¹¶ tag å°±æ˜¯ $(a, b, c, d)$ å’Œ $(A, B, C, D)$ ç›¸ä¹˜ï¼Œå¾—åˆ° $(Aa, Ab + B, Ca + c, Cb + D + d)$ã€‚å•ä½å…ƒæ˜¯ $(1, 0, 0, 0)$ã€‚</p><p>hintï¼šè¦å†™åƒåœ¾å›æ”¶å’Œ unsigned intã€‚</p><p>å¤æ‚åº¦ $O(n^2logW)$ã€‚</p><p>æ„Ÿæƒ³ï¼šæ•´ä½“ dp å¥½ç¥å•Šï¼æ•´ä½“ dp å¥—ç”Ÿæˆå‡½æ•°å¥½ç¥å•Šï¼</p><p><a href="https://loj.ac/s/1055616" target="_blank" rel="noopener">$Code$</a></p><h2 id="åŠˆé…"><a href="#åŠˆé…" class="headerlink" title="$åŠˆé…$"></a>$åŠˆé…$</h2><hr><p>å›å¿†èµ·è¢«ã€Œçš®é…ã€æ”¯é…çš„ææƒ§ /jk è¿˜å¥½è¿™é“æ¯”è¾ƒé˜³é—´ï¼Œä¸€é“å¤æ‚åº¦åˆ†æé¢˜</p><p>ç¬¬ä¸€é—®å†™ä¸€ä¸ªâ€œæ‰©å±•â€çš„äºŒåˆ†å›¾æœ€å¤§åŒ¹é…å°±å¥½äº†ï¼Œå…·ä½“æ¥è¯´æ¯ä¸ªåæœŸè¢«æ›´æ”¹åŒ¹é…å¯¼å¸ˆçš„äººæ–°åŒ¹é…çš„å¯¼å¸ˆå¿…é¡»æ˜¯åŒä¸€å¿—æ„¿çš„ï¼Œ$O(n^3C)$</p><p>ç¬¬äºŒé—®æœ‰æ˜¾ç„¶çš„äºŒåˆ†æ€§ï¼Œä½ å¯ä»¥äºŒåˆ† + ä»å‰å¾€ååŠ äººï¼Œä½†æ˜¯è¿™æ ·æ˜¯ $O(n^3Clogn)$ã€‚æˆ‘ä»¬å¯ä»¥ä¿ç•™å‰ç¼€ä¸å˜çš„åŒ¹é…çŠ¶æ€ï¼Œå°±æ˜¯ $O(n^2Clogn)$ çš„æ ·å­ã€‚</p><p>ä½†æ˜¯æœ‰å®Œå…¨æ›´ç®€å•çš„åšæ³•ï¼šåœ¨åšç¬¬ä¸€é—®è¦æ›¿æ¢äººçš„æ—¶å€™å°½é‡æ›¿æ¢é åçš„ï¼Œé¡ºä¾¿è®°å½•ä¸‹æ¥å°±å¯ä»¥äº†ã€‚</p><p><a href="https://loj.ac/s/1056622" target="_blank" rel="noopener">$Code$</a></p><h2 id="æ—å…‹å¡ç‰¹æ ‘"><a href="#æ—å…‹å¡ç‰¹æ ‘" class="headerlink" title="$æ—å…‹å¡ç‰¹æ ‘$"></a>$æ—å…‹å¡ç‰¹æ ‘$</h2><hr><p>é¢˜æ„ï¼šè®©ä½ é€‰ $K + 1$ æ¡è·¯å¾„ä½¿å¾—æƒå€¼å’Œæœ€å¤§ã€‚</p><p>å¸¦æƒäºŒåˆ†ï¼Œ$f[i, 0/1/2]$ è¡¨ç¤ºç‚¹ $i$ çš„åº¦æ•°ä¸º $j$ æ—¶ $i$ å­æ ‘ä¸­çš„æœ€ä¼˜è§£ï¼ˆè¦è®°å½•è·¯å¾„æ•°ï¼Œå†™ä¸ª struct å°±å¥½äº†ï¼‰ï¼Œåˆ†ç±»è®¨è®ºã€‚</p><p><a href="https://loj.ac/s/907209" target="_blank" rel="noopener">$Code$</a></p><h2 id="åˆ¶èƒ¡çªœ"><a href="#åˆ¶èƒ¡çªœ" class="headerlink" title="$åˆ¶èƒ¡çªœ$"></a>$åˆ¶èƒ¡çªœ$</h2><hr><p>å¤§åˆ†ç±»è®¨è®ºé¢˜å—ã€‚ã€‚ã€‚æœ‰å¿ƒæƒ…å†å†™å§ /cy è¢«ã€Œç§˜å¯†è¢­å‡»ã€æè‡ªé—­äº†</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>21Jan å­¦ä¹ è®¡åˆ’</title>
      <link href="2021/01/31/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%9121Jan%20%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/"/>
      <url>2021/01/31/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%9121Jan%20%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/</url>
      
        <content type="html"><![CDATA[<p>æ–°å¹´æ–°å‘~</p><h2 id="mathcal-1-2"><a href="#mathcal-1-2" class="headerlink" title="$\mathcal{1.2}$"></a>$\mathcal{1.2}$</h2><hr><p>Todo: vp UOJï¼Œè®¢æ­£ä»Šå¤©æ¨¡æ‹Ÿèµ›, è®¢æ­£èƒ¡ç­– 4ï¼Œvp AGC012/043ï¼Œå­¦ä¹ æ–¯ç‰¹æ—æ•°ï¼Œå·©å›º SAM å’Œç”Ÿæˆå‡½æ•°ï¼Œuojäº¤äº’é¢˜ï¼Œæ¸…åé›†è®­14ã€16ã€17ï¼Œé›†è®­é˜Ÿä½œä¸šï¼ŒEIä¸åŠ¨æ€å›¾<br>loj560, 3104</p><p>SAM<br>PAM<br>æœ€é•¿åé“¾<br>FWT exp ln</p><p>agc023e<br>agc023d<br>agc020f<br>agc032e<br>agc035e<br>agc029f</p><p>è®¢æ­£æ˜¨å¤© T1<br>ULR T2&amp;3<br>æŒ‡æ•°å…¬å¼ <a href="https://loj.ac/p/6737" target="_blank" rel="noopener">https://loj.ac/p/6737</a><br>checkers <a href="https://www.luogu.com.cn/problem/AT3951" target="_blank" rel="noopener">https://www.luogu.com.cn/problem/AT3951</a></p><p>è”åˆçœé€‰2020<br>ä¹çœè”è€ƒ<br>å…«çœè”è€ƒ<br>å…­çœè”è€ƒ<br>ZJOI</p><h3 id="XJOI1640"><a href="#XJOI1640" class="headerlink" title="$XJOI1640$"></a>$XJOI1640$</h3><h4 id="T1"><a href="#T1" class="headerlink" title="$T1$"></a>$T1$</h4><p>sb é¢˜ï¼Ÿè¯»å…¥æ ¼å¼é”™äº†æˆ‘å</p><h4 id="T2"><a href="#T2" class="headerlink" title="$T2$"></a>$T2$</h4><p>æ²¡å¬æ‡‚</p><h4 id="T3"><a href="#T3" class="headerlink" title="$T3$"></a>$T3$</h4><p>å¯ä»¥è¯æ˜ $A = g^a$, $B = g^b$, å°±è§£ä¸€ä¸ªä¸å®šæ–¹ç¨‹ã€‚</p><h3 id="XJOI1641"><a href="#XJOI1641" class="headerlink" title="$XJOI1641$"></a>$XJOI1641$</h3><h4 id="T1-1"><a href="#T1-1" class="headerlink" title="$T1$"></a>$T1$</h4><p>é«˜æ–¯æ¶ˆå…ƒæˆä¸Šä¸‰è§’å½¢å¼ï¼Œ$min$ å°±æ˜¯æ‰€æœ‰æœ‰ä¸»å…ƒçš„åˆ—ç­”æ¡ˆåŠ èµ·æ¥ï¼Œ$max$ å°±æ˜¯é™¤äº†æœ€é«˜ä½å¤–å…¶ä½™ä½è‡³å°‘æœ‰ä¸€ä¸ª $0$.</p><h4 id="T2-1"><a href="#T2-1" class="headerlink" title="$T2$"></a>$T2$</h4><p>hhz è¯´æ‰“ä¸ªè¡¨å‘ç°æ˜¯çº¿æ€§é€’æ¨ï¼Œè·‘ $BM$ å°±è¡Œäº†ï¼Œä»–ä¸ä¼šè¯ã€‚</p><p>ä»–æä¾›äº†å¦ä¸€ä¸ªæ€è·¯â€”â€”ç”Ÿæˆå‡½æ•°ï¼Œå®¹æ–¥â€œç›¸åŒâ€è¿™ä»¶äº‹ï¼Œåˆ†æˆè‹¥å¹²ä¸ªé›†åˆï¼Œå¼ºåˆ¶é›†åˆé‡Œçš„ç‰©å“ç›¸åŒï¼Œå®¹æ–¥ç³»æ•° $(-1)^{é›†åˆä¸ªæ•° + 1}$, ç„¶åè¿™ä¸ªç”¨ç”Ÿæˆå‡½æ•°ã€‚</p><h4 id="T3-1"><a href="#T3-1" class="headerlink" title="$T3$"></a>$T3$</h4><p>å¼‚æˆ–ç²½å­ï¼$K = n(n - 1) / 2$ï¼Œé‚£æ²¡äº‹äº†ã€‚è€ƒè™‘å½“å‰åœ¨ç®— $x$ å’Œ $y$ ä¸ºæ ¹çš„ $Trie$ æ ‘å­æ ‘å¼‚æˆ–è´¡çŒ®ï¼Œå¦‚æœ $x0$ã€$y1$ å’Œ $x1$ã€$y0$ è´¡çŒ®å·²ç»åˆ° $K$ äº†å°±é€’å½’åšè¿™ä¿©ï¼Œå¦åˆ™é€’å½’åš $x0$ã€$y0$ å’Œ $x1$ã€$y1$ï¼Œæ¯ä¸ª $Trie$ æ ‘èŠ‚ç‚¹éƒ½è¦ç»´æŠ¤å­æ ‘æ¯ä½ä¿¡æ¯ã€‚çœ‹ä¼¼ä¸¤åª $log$ï¼Œå…¶å®å®ç°çš„ç²¾ç»†ä¸€ç‚¹å°±æ˜¯ä¸€åª $log$ï¼Œæ¯”å¦‚åªè®°å½•å„¿å­æœ‰çš„ä½çš„ä¿¡æ¯ï¼ˆå³æ·±åº¦ $d$ çš„ç‚¹åªè®°å½• $d$ åŠä»¥åä½çš„ä¿¡æ¯ï¼‰ï¼Œç„¶åç©ºé—´ç”¨é•¿é“¾å‰–åˆ†ä¼˜åŒ–ã€‚</p><p>ä¸ºä»€ä¹ˆè¿™æ ·å¤æ‚åº¦å°±æ˜¯å¯¹çš„ï¼Ÿè€ƒè™‘å•å„¿å­çš„ç‚¹ï¼Œåˆ¤æ–­æ˜¯ $O(1)$ çš„ï¼Œç©ºé—´å°±ç»§æ‰¿äº†ï¼›è€ƒè™‘åŒå„¿å­çš„ç‚¹ï¼Œåˆ¤æ–­ $O(logV)$ï¼Œç„¶è€Œ $Trie$ æ ‘æœ‰ä¸ªé‡è¦æ€§è´¨ï¼š<strong>åŒå„¿å­ç‚¹åªæœ‰ $O(n)$ ä¸ª</strong>ï¼Œæ‰€ä»¥æ˜¯ $O(nlogV)$ çš„ã€‚</p><h3 id="å…»çŒ«"><a href="#å…»çŒ«" class="headerlink" title="$å…»çŒ«$"></a><a href="https://loj.ac/p/6079" target="_blank" rel="noopener">$å…»çŒ«$</a></h3><p>å•ç‹¬å†™åšå®¢äº†ã€‚</p><h3 id="THUPC2021"><a href="#THUPC2021" class="headerlink" title="$THUPC2021$"></a><a href="https://loj.ac/p?keyword=thupc%202021" target="_blank" rel="noopener">$THUPC2021$</a></h3><h4 id="åˆ‡åˆ‡ç³•"><a href="#åˆ‡åˆ‡ç³•" class="headerlink" title="åˆ‡åˆ‡ç³•"></a>åˆ‡åˆ‡ç³•</h4><p>æœ‰æ„æ€çš„é¢˜ã€‚å‘ç°ç®— $Kiana$ æ²¡æ³•åšï¼Œåªèƒ½ç®— $Tinytree$ åœ¨åŒæ–¹æœ€ä¼˜ç­–ç•¥ä¸‹çš„æœ€å¤§åˆ‡ç³•æ€»å’Œã€‚$dp_{i, j}$ è¡¨ç¤ºåˆ‡äº† $i$ å—ç³•ï¼Œä½¿ç”¨äº† $j$ æ¬¡ä¼˜å…ˆé€‰æ‹©æƒï¼Œæœ‰ $dp_{i, 0} = 0$, $dp_{i, i} = \frac{\sum\limits_{j = 1}^i a_j}{2}$ã€‚è½¬ç§»æ–¹ç¨‹: $dp_{i, j} = \max{ dp_{i - 1, j} + x, dp_{i - 1, j - 1} + y }$ï¼Œå…¶ä¸­ $x + y = a_i$, $x &lt; y$. è¿™æ˜¯ä¸¤ä¸ªä¸€æ¬¡å‡½æ•°ï¼Œè¦æœ€å°å¿…ç„¶ä½¿å¾—ä¸¤è€…ç›¸ç­‰ï¼Œäºæ˜¯è§£æ–¹ç¨‹è§£å‡º $x$ å³å¯ã€‚</p><h4 id="æ£‹ç›˜"><a href="#æ£‹ç›˜" class="headerlink" title="æ£‹ç›˜"></a>æ£‹ç›˜</h4><p>èµ›åœº WA æˆ dog çš„ç—›è‹¦ä½ æ‡‚å—ã€‚åæ¥æœºæˆ¿é‡Œæœ‰äººæ„é€ å‡ºèƒ½å¡çš„æ•°æ®äº†ï¼Œä½†æ˜¯æˆ‘ naive ä»¥ä¸ºæˆ‘è¿™åšæ³•ä»æ ¹æœ¬ä¸Šå°±é”™äº†ï¼Œå®é™…ä¸Šåªè¦è€ƒè™‘ä¸€ç§æƒ…å†µï¼š$n$ ä¸ºå¥‡æ•°ï¼Œç›¸é‚»ä¸¤åˆ—æ’‘æ»¡ï¼Œä¸”è¿™ä¸¤åˆ—è·ç¦»ä¸ºå¶æ•°ã€‚è¿™å°±éœ€è¦ä¹±æäº†â€”â€”ä¹‹é—´çš„åˆ—ä»ä¸Šå¾€ä¸‹å¡«ï¼Œå¡«ä¸åŠ¨äº†å†ä»ä¸‹å¾€ä¸Šå¡«ã€‚</p><h4 id="çº¿æ®µæ ‘"><a href="#çº¿æ®µæ ‘" class="headerlink" title="çº¿æ®µæ ‘"></a>çº¿æ®µæ ‘</h4><p>å‘ç°ç­”æ¡ˆåªå’Œé•¿åº¦æœ‰å…³ï¼Œè€Œé•¿åº¦åªæœ‰ $O(logn)$ ç§ã€‚ç®—ä¸€ä¸ªé•¿åº¦çš„ç­”æ¡ˆéœ€è¦ç»Ÿè®¡å·¦åŒºé—´è´¡çŒ®ã€å³åŒºé—´è´¡çŒ®å’Œæ‰€æœ‰è·¨ä¸­ç‚¹åŒºé—´çš„è´¡çŒ®ï¼Œè¦ç»´æŠ¤å‰åç¼€è´¡çŒ®å’Œã€‚</p><h4 id="å¯†é›†å­å›¾"><a href="#å¯†é›†å­å›¾" class="headerlink" title="å¯†é›†å­å›¾"></a>å¯†é›†å­å›¾</h4><p>$1$ åˆ°è¾¾æ¯ä¸ªç‚¹çš„æœ€çŸ­è·¯é•¿åº¦ä¸è¶…è¿‡ $11$ï¼Œæƒ³åˆ°åœ¨æœ€çŸ­è·¯æ ‘ä¸Šåˆ†å±‚çŠ¶å‹ $dp$ï¼ˆä»æµ…åˆ°æ·±å’Œä»æ·±åˆ°æµ…æ˜¾ç„¶éƒ½å¯ä»¥ï¼‰ã€‚å·²æœ‰ç‚¹é›†ä¸­åªæœ‰ä¸Šä¸€æ·±åº¦çš„ç‚¹èƒ½å‘å½“å‰ç‚¹é›†è¿è¾¹ï¼Œä¸”å½“å‰ç‚¹é›†ä¸­æ¯ä¸ªç‚¹éƒ½å’Œè‡³å°‘ä¸€ä¸ªä¸Šä¸€æ·±åº¦çš„ç‚¹è¿è¾¹ã€‚$dp_{d, s1, s2}$ è¡¨ç¤ºæ·±åº¦ä¸º $d$ çš„é›†åˆä¸º $s2$ï¼Œæ·±åº¦ $\leq d$ çš„é›†åˆä¸º $s1$ï¼Œè½¬ç§»æšä¸¾ä¸¤æ¬¡å­é›†ï¼Œå¤æ‚åº¦ $O(n4^n)$ï¼Œå¡æˆ‘å¸¸ä¸è®²æ­¦å¾·ã€‚</p><h3 id="Fygon-2-0"><a href="#Fygon-2-0" class="headerlink" title="$Fygon\ 2.0$"></a><a href="https://codeforces.com/gym/101612/" target="_blank" rel="noopener">$Fygon\ 2.0$</a></h3><p>æŠŠè¿™ä¸ª for å¾ªç¯çœ‹ä½œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">i in range(1, n)</span><br><span class="line">    if (j &lt;= i &amp;&amp; i &lt;= k)</span><br></pre></td></tr></table></figure><p>æ ¹æ®ä¸ç­‰å…³ç³»å»ºå›¾ï¼Œæ˜¯æœ‰å‘å›¾ï¼Œå…ˆç¼©ç‚¹â€”â€”æ˜¾ç„¶æœ‰ç¯çš„è¯ï¼ˆæ¯”å¦‚ $1$ -&gt; $i$ -&gt; $j$ -&gt; $1$ï¼‰ç¼©ç‚¹åä¸€ä¸ª $SCC$ é‡Œçš„å˜é‡å–å€¼ç›¸åŒã€‚<br>ç¼©å®Œæ˜¯ä¸ª $DAG$ï¼Œ$DAG$ ç‚¹æ•°å°±æ˜¯ $n$ çš„æ¬¡æ•°ã€‚</p><p>é‚£ä¹ˆç³»æ•°æ˜¯å•¥ï¼Ÿè€ƒè™‘å…¶æ„ä¹‰ï¼Œç³»æ•°å°±æ˜¯å®é™… $lag$++ çš„æ¬¡æ•°å  $n^{DAG ç‚¹æ•°}$ çš„å‡ åˆ†ä¹‹å‡ ã€‚<br>ä¸è€ƒè™‘å­˜åœ¨ $SCC$ å–å€¼ç›¸åŒçš„æƒ…å†µï¼Œå› ä¸ºæ¬¡æ•°ä¼šå‡å°ï¼Œè€Œæˆ‘ä»¬å‡å®š $n$ è¶‹è¿‘äº $\infty$<br>ç­”æ¡ˆå°±æ˜¯ $\frac{DAG çš„æ‹“æ‰‘åºä¸ªæ•°}{DAG ç‚¹æ•°!}$ï¼ŒçŠ¶å‹å°±å¥½äº†ã€‚</p><h3 id="æ–‡å­¦"><a href="#æ–‡å­¦" class="headerlink" title="$æ–‡å­¦$"></a><a href="https://uoj.ac/problem/47" target="_blank" rel="noopener">$æ–‡å­¦$</a></h3><p>é¢˜æ„ï¼šç»™ä½ å¾ˆå¤šåŠå¹³é¢ï¼Œè®©ä½ é€‰ä¸€äº›åŒ…å«æ‰€æœ‰ç‚¹ã€‚</p><p>ç‰¹åˆ¤æ‰åªé€‰ä¸€ä¸ªåŠå¹³é¢çš„æƒ…å†µï¼Œå‰©ä¸‹çš„éƒ½æœ‰è‡³å°‘ä¸¤ä¸ªåŠå¹³é¢ä¸”åŠå¹³é¢çš„è¡¥çš„äº¤ä¸ºå‡¸åŒ…ï¼ˆæ˜¾ç„¶åŠå¹³é¢æ˜¯å‘å¤–çš„å•Šï¼‰ï¼Œäºæ˜¯æšä¸¾ä¸¤ä¸ªåŠå¹³é¢ï¼Œä»¥å®ƒä»¬çš„äº¤ç‚¹ä¸ºåŸºå‡†ç‚¹å¯¹æ‰€æœ‰ä¹¦æœ¬æè§’æ’åºï¼ˆå› ä¸ºå½“æšä¸¾çš„ä¸¤ä¸ªåŠå¹³é¢åœ¨ç­”æ¡ˆé›†åˆä¸­ä¸ºç›¸é‚»çš„ï¼Œå®ƒä»¬çš„äº¤å°±æ˜¯å‡¸åŒ…ä¸Šçš„ä¸€ä¸ªç«¯ç‚¹ï¼Œé‚£ä¹ˆå…¶ä»–ä¹¦æœ¬å…³äºå®ƒæè§’æ’åºååœ¨æœ€ç»ˆçš„ç­”æ¡ˆåŠå¹³é¢é›†åˆä¸­ä¸€ä¸ªåŠå¹³é¢è¦†ç›–ä¸€æ®µè¿ç»­åŒºé—´çš„ä¹¦æœ¬ï¼‰ï¼Œäºæ˜¯å…ˆé¢„å¤„ç†æ¯ä¸ªåŒºé—´è¢«ä¸€ä¸ªåŠå¹³é¢è¦†ç›–çš„æœ€å°ä»£ä»·ï¼Œå†æ‹¼èµ·æ¥å°±å®Œäº‹äº†ã€‚</p><h3 id="Buffalo-Barricades"><a href="#Buffalo-Barricades" class="headerlink" title="$Buffalo\ Barricades$"></a><a href="https://ioihw20.duck-ac.cn/problem/290" target="_blank" rel="noopener">$Buffalo\ Barricades$</a></h3><p><strong>ä»”ç»†è¯»é¢˜ã€‚</strong> è§‚å¯Ÿå‘ç°è‹¥ $x_i &gt; x_j$, $y_i &gt; y_j$, $t_i &lt; t_j$ åˆ™ $i$ çš„ç‰›ç¾¤åŒ…å« $j$ çš„ç‰›ç¾¤ã€‚å¦‚æœä¸çœ‹æ“ä½œç¼–å·ï¼Œæˆ‘ä»¬ç®—å‡ºæ¯ä¸ªæ …æ ç›´æ¥ç»Ÿé¢†çš„ç‰›æ•°ï¼Œæ ¹æ®åŒ…å«å…³ç³»å»ºæ ‘ï¼ˆå¦‚æœæœ‰å¤šä¸ªåŒ…å« $j$ çš„å°±é€‰æ—¶é—´æœ€å°çš„ $i$ï¼Œæ˜¾ç„¶æ˜¯ä¸ªæ£®æ—ï¼‰ï¼Œé‚£ä¹ˆå­èŠ‚ç‚¹ç­”æ¡ˆåŠ ç»™çˆ¶äº²èŠ‚ç‚¹å°±å¥½äº†ã€‚</p><p>è€ƒè™‘æ“ä½œç¼–å·ï¼Œæˆ‘ä»¬åªè¦ä¿è¯å­æ ‘ä¸­æ‰€æœ‰æ“ä½œç¼–å·å¤§äºæ ¹çš„ç‚¹çš„ç­”æ¡ˆéƒ½å·²è¢«ç®—å¥½â€”â€”è¿™è¿˜ä¸æ˜æ˜¾å˜›ï¼Œæ—¶é—´å€’æµ + å¹¶æŸ¥é›†å°±å¯ä»¥å•¦ã€‚</p><p>ä¸€åª $log$ï¼Œæ„Ÿè§‰å¥½å°æ¸…æ–°å•Š~~ æ ‘å¥—æ ‘ä»€ä¹ˆçš„å¤§æ¦‚å¯ä»¥è½»æ˜“åšåˆ°ä¸¤åª $log$ å§ã€‚</p><h2 id="mathcal-1-5"><a href="#mathcal-1-5" class="headerlink" title="$\mathcal{1.5}$"></a>$\mathcal{1.5}$</h2><hr><h3 id="Epic-Win"><a href="#Epic-Win" class="headerlink" title="$Epic\ Win!$"></a><a href="https://codeforces.com/gym/100553/problem/E" target="_blank" rel="noopener">$Epic\ Win!$</a></h3><p>é€ è‡ªåŠ¨æœºé¢˜ã€‚å¯ä»¥é‡‡å–è¿™æ ·çš„ç­–ç•¥ï¼šå…ˆå»ºä¸€ä¸ªå¯¹æ‰‹è‡ªåŠ¨æœºçš„å‰¯æœ¬ï¼Œå…¶ä¸­æ¯ä¸ªèŠ‚ç‚¹çŠ¶æ€æ˜¯å…‹åˆ¶åŸèŠ‚ç‚¹çš„ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œåŠæ‰“è‡ªåŠ¨æœºâ€ï¼ŒåŠæ‰“è‡ªåŠ¨æœºæ¯ä¸ªèŠ‚ç‚¹åªæœ‰ä¸€æ¡å‡ºè¾¹ï¼Œå‰©ä¸‹ä¸¤æ¡å‡ºè¾¹æ˜¯åšè°ƒæ•´ç”¨ã€‚</p><p>ä¸ºäº†ä½¿å¾—å¯¹æ‰‹ä»ä»»æ„èŠ‚ç‚¹å¼€å§‹æˆ‘éƒ½èƒ½èµ¢ï¼Œæˆ‘ä»¬è¦è®©è‡ªåŠ¨æœºé€‚ç”¨äºå¯¹æ‰‹æ¯ä¸ªèŠ‚ç‚¹ï¼Œä¸å¦‚æŠŠæˆ‘ä»¬çš„è‡ªåŠ¨æœºåˆ†å±‚ï¼Œä¸€å±‚å¯¹ä»˜å¯¹æ‰‹ä¸€ä¸ªç‚¹ã€‚ä»å¯¹æ‰‹è‡ªåŠ¨æœºæ¯ä¸ªèŠ‚ç‚¹å‡ºå‘ä¸€ç›´è·‘è·‘è·‘ï¼Œå¦‚æœè·‘è¿‡çš„è·¯ç¨‹è¶…å‡ºäº†æˆ‘ä»¬è‡ªåŠ¨æœºå½“å‰ç‚¹æ•°å°±è®¤ä¸ºå­˜åœ¨èƒœåˆ©çš„ç¯ï¼Œå¦åˆ™è·‘åˆ°ä¸å­˜åœ¨ä¸‹ä¸ªå…‹åˆ¶å¯¹æ‰‹çš„çŠ¶æ€è¾¹æ—¶æ–°åŠ ä¸€å±‚è‡ªåŠ¨æœºï¼Œè¿™æ ·ç‚¹æ•° $n^2$ï¼Œå¤æ‚åº¦ $n^3$ã€‚</p><h3 id="Indiana-Jones-and-the-Uniform-Cave"><a href="#Indiana-Jones-and-the-Uniform-Cave" class="headerlink" title="$Indiana\ Jones\ and\ the\ Uniform\ Cave$"></a><a href="https://www.luogu.com.cn/problem/P7123" target="_blank" rel="noopener">$Indiana\ Jones\ and\ the\ Uniform\ Cave$</a></h3><p>æ˜¯ä¸€ä¸ªå¤§ $SCC$ï¼Œæƒ³åˆ°ç”¨ $tarjan$ ç›¸å…³æ¨¡æ‹Ÿ $dfs$ã€‚</p><p>å¾ˆæœ‰æ„æ€ï¼Œç”¨ä»…æœ‰çš„ä¿¡æ¯æ¥è¡¨ç¤º dfnã€low å’Œ insã€‚çŸ³å¤´ centerã€leftã€right åˆ†åˆ«å¯¹åº”æœªè®¿é—®ã€å·²å¼¹å‡ºæ ˆå’Œåœ¨æ ˆä¸­ã€‚</p><p>å¦‚æœè®¿é—®åˆ°ç‚¹åœ¨æ ˆä¸­ï¼Œå°±é¡ºç€çŸ³å¤´æ‘†æ”¾çš„ä½ç½®ä¸€è·¯èµ°ä¸‹å»ï¼Œå¹¶æŠŠæ²¿é€”çš„ä½ç½®çŸ³å¤´æ”¾åœ¨ leftï¼Œç¢°åˆ°çš„ç¬¬ä¸€ä¸ª left çš„ç‚¹è¯´æ˜èµ°å›å»äº†ï¼›å¦‚æœè®¿é—®åˆ°ç‚¹ä¸åœ¨æ ˆä¸­ï¼Œå°±ä¸€ç›´èµ°åˆ°è®¿é—®åˆ°æ ˆä¸­ç‚¹ä¸ºæ­¢ã€‚å¾ˆå¥½çš„æ˜¯è®°å½•è·¯å¾„é•¿åº¦å°±å¯ä»¥ç®—å‡º lowï¼Œå›åˆ°çˆ¶äº²ã€‚</p><p>ï¼ˆè¿˜æ˜¯æ²¡æƒ³å¤ªæ˜ç™½ï¼Œä»£ç å’•å’•</p><h3 id="é¡»è‡¾å¹»å¢ƒ"><a href="#é¡»è‡¾å¹»å¢ƒ" class="headerlink" title="é¡»è‡¾å¹»å¢ƒ"></a><a href="https://www.luogu.com.cn/problem/P5385" target="_blank" rel="noopener">é¡»è‡¾å¹»å¢ƒ</a></h3><p>$LCT$ ç»´æŠ¤å•¥å‘¢ã€‚è€ƒè™‘ $u$ å’Œ $v$ è”é€šï¼Œå½“ä¸”ä»…å½“æœ‰ä¸€æ¡è·¯å¾„å…¨éƒ¨ $\geq l$ï¼ˆåºŸè¯</p><p>é‚£ä¹ˆ $LCT$ ç»´æŠ¤æ¯æ¬¡ $r$ å³ç§»åå½¢æˆçš„æœ€å¤§ç”Ÿæˆæ ‘ï¼ˆè¦å½¢æˆç¯çš„æ—¶å€™è¸¢æ‰æœ€å°çš„è¾¹ã€‚ä¼—æ‰€å‘¨çŸ¥ LCT åªèƒ½ç»´æŠ¤ç‚¹ï¼Œæ‰€ä»¥åŒ–è¾¹ä¸ºç‚¹ï¼Œæ³¨æ„éè¾¹ç‚¹çš„ç‚¹æƒè¦èµ‹ä¸º $\infty$ï¼‰ï¼Œ$è¿é€šå—æ•° = ç‚¹æ•° - è¾¹æ•° = n - [l, r] ä¸­åœ¨æœ€å¤§ç”Ÿæˆæ ‘ä¸Šçš„è¾¹æ•°$.</p><p>ä¸€æ¡è¾¹åªä¼šåŠ å…¥ä¸€æ¬¡ï¼Œåˆ é™¤è‡³å¤šä¸€æ¬¡ã€‚ç›¸å½“äºè¦æŸ¥è¯¢ $i \in [l, r]$ ä¸”åˆ é™¤æ—¶é—´ $del_i &gt; r$ çš„è¾¹æ•°ï¼ŒäºŒç»´æ•°ç‚¹å³å¯ã€‚ï¼ˆä¸»å¸­æ ‘éƒ½ä¸ä¼šå†™äº† /kel</p><h3 id="XJOI1643"><a href="#XJOI1643" class="headerlink" title="$XJOI1643$"></a>$XJOI1643$</h3><p>å‡ºäºå„ç§å¥¥å¦™é‡é‡çš„åŸå› æŠ±çµè¾½ã€‚</p><h4 id="T1-2"><a href="#T1-2" class="headerlink" title="$T1$"></a>$T1$</h4><p>çŠ¶å‹æ¨¡æ‹Ÿæ‹“æ‰‘ï¼Œä¸€å¼€å§‹é€‰ $0$ åº¦ç‚¹çš„è¿‡ç¨‹é”™äº†ï¼Œåˆ°æ‰‹çš„ $10$ åˆ†é£äº†</p><p><strong>ç»™å‡ºçš„åºåˆ—æ˜¯æ— åºçš„ã€‚</strong> å˜å½¢ä¸€ä¸‹ï¼ŒæŠŠä¾èµ– $x$ çš„ $y$ éƒ½æŒ‚åœ¨ $x$ ä¸‹ï¼Œå› ä¸ºåªæœ‰å $n - m$ ä¸ªç‚¹ä¾èµ–å‰ $m$ ä¸ªç‚¹çš„ä»½ï¼Œè¿™æ˜¯ä¸ªèŠèŠ±æ£®æ—ã€‚æ¯ä¸ª $x$ ç®—ä¸Šå®ƒçš„å­æ ‘æœ‰ä¸€ä¸ªæƒå€¼åŒºé—´ã€‚æˆ‘ä»¬æŠŠ $x$ ä»¬æŒ‰ç…§æƒå€¼åŒºé—´å³ç«¯ç‚¹æ’åºï¼Œç„¶åèµ°æ¥èµ°å»æ”¶è´¡çŒ®ã€‚</p><p>ä¸ä¼šèµ°â€œåŒ…å«å‹â€çš„åŒºé—´ï¼Œå®ƒä¸ä¼˜ï¼›å¹¶ä¸”ä¸€å®šæ˜¯ä»èµ·ç‚¹å¼€å§‹å¾€å·¦ï¼ˆæˆ–å³ï¼Œåº”è¯¥éƒ½å¯ä»¥ï¼‰èµ°åˆ°åº•ç„¶åä¸€è·¯èµ°å›æ¥ï¼Œæœ€åç»“æŸåœ¨æœ€å·¦æˆ–æœ€å³è¾¹çš„è¾¹ç•Œä¸Šã€‚å¾€å·¦ç»è¿‡çš„æ˜¯åŒºé—´å¹¶ï¼Œå‰ç¼€ $min$/$max$ å¯ä»¥é¢„å¤„ç†ï¼Œæ³¨æ„èµ°å›æ¥æ˜¯ä¸¤å€åŒºé—´å¹¶é•¿ã€‚</p><h4 id="T2-2"><a href="#T2-2" class="headerlink" title="$T2$"></a>$T2$</h4><p>hhzï¼šç½‘ç»œæµæœ¬è´¨æ˜¯ç‰¹æ®Šçš„çº¿æ€§è§„åˆ’ã€‚å»ºè®®å­¦ä¹ å•çº¯å½¢æ³•ï¼Œåˆ©äºéª—åˆ†ã€‚</p><p>è€ƒè™‘åŠ å®Œè¾¹çš„æœ€çŸ­è·¯å›¾ï¼Œ$d_u + 1 \leq d_v$ã€‚è¿™é¢˜æ€ä¹ˆç½‘ç»œæµï¼Ÿè¾¹æƒåªæœ‰ $O(n)$ ç§ï¼Œå»º $n$ è¡Œ $n$ åˆ—ç‚¹è¡¨ç¤º $n$ ç§ç‚¹çš„ $n$ ç§æƒå€¼ï¼Œå‰²æ‰è¾¹å°±è¡¨ç¤ºé€‰äº†è¿™ç§æƒå€¼ï¼Œç›¸é‚»è¿è¾¹å®¹é‡ä¸ºé¢˜ç›®ä¸­é‚£ä¸ªä¸‹å–æ•´æŸ¿å­ã€‚é¢˜ç›®ä¸­çš„ $m$ æ¡è¾¹æ˜¯æ¥ç»™é™åˆ¶çš„ï¼Œè€ƒè™‘è¿™é™åˆ¶æ˜¯ä»€ä¹ˆï¼Œè¿™ä¸¤ä¸ªç‚¹çš„æœ€çŸ­è·ç¦»å·®ä¸èƒ½ $&gt; 1$ï¼Œäºæ˜¯é€šè¿‡è¿åå‘ $\infty$ è¾¹æ¥å®ç°ã€‚</p><h4 id="T3-2"><a href="#T3-2" class="headerlink" title="$T3$"></a>$T3$</h4><p>æ²¡è¾“ no solution åˆ°æ‰‹çš„ $5$ åˆ†é£äº† å‡¸^-^å‡¸</p><p>æš´åŠ›å°±æšä¸¾ $A$ å’Œ $B$ çš„æœ€å¤§å€¼ï¼Œå¦‚æœâ€œå­˜åœ¨è¿é€šå—å¤§å° $\geq k$â€ åˆ™è¯¥æœ€å¤§å€¼å¯¹åˆæ³•ã€‚</p><p>æ­£è§£è€ƒè™‘æšä¸¾ $A$ çš„æœ€å¤§å€¼ï¼Œå‘ç°éšç€å®ƒå¢åŠ ï¼Œæœ€å°çš„ä½¿å¾—â€œå­˜åœ¨è¿é€šå—å¤§å° $\geq k$â€ çš„ $B$ æœ€å¤§å€¼ å˜å°ã€‚</p><p>äºæ˜¯å¯ä»¥åŠ¨æ€åŠ è¾¹åˆ è¾¹ï¼Œå› ä¸ºè€ƒè™‘ä¸¤æ¡è¾¹ $e_1$ å…ˆäº $e_2$ è¢«åˆ ï¼Œå½“ä¸”ä»…å½“ $\max{ b_{u_1}, b_{v_1} } \geq \max{ b_{u_2}, b_{v_2} }$ï¼Œæ‰€ä»¥è¾¹æŒ‰è¿™ä¸ª $max$ æ’åºï¼Œ$LCT$ ç»´æŠ¤ $MST$ å³å¯ï¼ï¼ï¼å½“ç„¶ä¹Ÿå¯ä»¥æŠŠç‚¹æ’åºï¼Œä½†æ˜¯ä¸èƒ½ä¸€ç»´æšä¸¾ç‚¹ã€ä¸€ç»´æšä¸¾è¾¹ï¼Œè¿™æ ·å¤§æ¦‚ä¼šæœ‰é‡æœ‰æ¼ã€‚</p><p>èƒ¡å®Œäº†ï¼ŒçœŸå¥½ã€èººå¹³ã€‘å†™äº†ä¸€æ™šä¸Š + æ—©ä¸Šä¸¤å°æ—¶ï¼ŒçœŸæœ‰æˆ‘çš„ï¼</p><h3 id="ULR-1"><a href="#ULR-1" class="headerlink" title="$ULR$#$1$"></a>$ULR$#$1$</h3><p>å•ç‹¬å†™åšå®¢äº†ã€‚</p><h2 id="mathcal-1-6"><a href="#mathcal-1-6" class="headerlink" title="$\mathcal{1.6}$"></a>$\mathcal{1.6}$</h2><hr><h3 id="XJOI1644"><a href="#XJOI1644" class="headerlink" title="$XJOI1644$"></a>$XJOI1644$</h3><p>æŒ‚åˆ†++ï¼Œä¸€ä¸ªå¿«é€Ÿå¹‚å†™æŒ‚ä¸¤å¤„çœŸæœ‰æˆ‘çš„ï¼Œmd</p><h4 id="T1-3"><a href="#T1-3" class="headerlink" title="$T1$"></a>$T1$</h4><p>å¯ä»¥åˆ†æ²»ç®—æŸ¿å­ï¼Œä¹Ÿå¯ä»¥çŸ©ä¹˜åŠ é€Ÿ $dp$ã€‚æ‰€ä»¥ä½ ä¸ºä»€ä¹ˆåªæƒ³åˆ°äº† exCRT åˆå¹¶æ¨¡æ•°ï¼Ÿ</p><h4 id="T2-3"><a href="#T2-3" class="headerlink" title="$T2$"></a>$T2$</h4><p>è€ƒè™‘ä¸€ä¸ªä¸€ä¸ªåŠ ç‰©å“ã€‚$(a_x, a_y)$ å’Œ $(b_x, b_y)$ åˆå¹¶å¾—åˆ° $(X, Y)$ $(0, Z)$ï¼Œå…¶ä¸­ $X = gcd(a_x, a_y)$ã€‚ä¸ºä»€ä¹ˆæ˜¯è¿™æ ·ï¼Ÿ$X$ æ˜¯ $a$ å’Œ $b$ åˆå¹¶å¾—åˆ°çš„ç¬¬ä¸€ç»´çš„æœ€å°â€œå•ä½â€ï¼Œ$Y$ã€$Z$ ç›¸å½“äºç¬¬äºŒä½çš„æœ€å°â€œå•ä½â€ã€‚</p><h4 id="T3-3"><a href="#T3-3" class="headerlink" title="$T3$"></a>$T3$</h4><p>å¯¹äº $n \leq 5$ ç‰¹åˆ¤ã€‚å…¶ä½™ $n$ ä¸ºå¥‡æ•°æ—¶ä¸€å®šä¸è¡Œï¼Œ$n$ ä¸ºå¶æ•°æ—¶ï¼Œåªæœ‰ $n / 2$ æ˜¯è´¨æ•°ä¸” $n / 2 - 1$ æ— å¹³æ–¹å› å­æ—¶å¯ä»¥ã€‚è¯æ˜æ®è¯´å†å²ä¸Šéƒ½æ‰¾ä¸åˆ°ï¼Œäºæ˜¯å’•å’•ã€‚</p><h3 id="AT4144-Donation"><a href="#AT4144-Donation" class="headerlink" title="$AT4144-Donation$"></a><a href="https://www.luogu.com.cn/problem/AT4144" target="_blank" rel="noopener">$AT4144-Donation$</a></h3><p>åšè¿‡å¥½å¤šéçš„å¥—è·¯äº†ï¼Œè„‘è¢‹è¿˜æ˜¯ä¸æ¸…é†’ã€‚è€ƒè™‘åœ¨ $i$ ç‚¹ç»“æŸåçš„é’±ä¸º $x$ï¼Œé‚£ä¹ˆ $x + b_i \geq a_i$, $x \geq a_i - b_i$ã€‚</p><p>è€ƒè™‘æèµ å®Œ $i$ å†æèµ  $j$ çš„æœ€å°é’±æ•° $y$ï¼Œè®¾æèµ å®Œ $j$ åä¸º $x$ï¼Œé‚£ä¹ˆ $y = \max{x + b_j, a_i - b_i}$. æ˜¾ç„¶æŒ‰ $a_i - b_i$ ä»å¤§åˆ°å°æèµ æœ€ä¼˜ã€‚æˆ‘ä»¬ä¸€ä¸ªç‚¹åªæèµ ä¸€æ¬¡ï¼Œåœ¨æœ€åä¸€æ¬¡ç»è¿‡å®ƒæ—¶æèµ ã€‚å¹¶æŸ¥é›†ç»´æŠ¤å­æ ‘ï¼Œ$dp$ã€‚</p><h3 id="Bears-and-Juice"><a href="#Bears-and-Juice" class="headerlink" title="$Bears\ and\ Juice$"></a><a href="https://www.luogu.com.cn/problem/CF643F" target="_blank" rel="noopener">$Bears\ and\ Juice$</a></h3><p><a href="https://www.luogu.com.cn/blog/CYJian/solution-cf643f" target="_blank" rel="noopener">å¤§ä½¬çš„é è°±é¢˜è§£</a></p><p>æƒ³äº†å¥½ä¹…æ‰æ˜ç™½ã€‚xmlï¼Œèœï¼</p><p>æ­£å¦‚å¤§ä½¬æ‰€è¯´çš„ï¼Œæˆ‘ä»¬å…ˆåˆ¶å®šä¸€ä¸ªç­–ç•¥ï¼Œå®‰æ’å¥½å“ªäº›ç†Šå“ªå¤©å–å“ªäº›é…’ï¼Œä½¿å¾—èƒ½å¤Ÿ<strong>æ ¹æ®ç†Šçš„è¡¨ç°æ¨æ–­å‡ºå“ªä¸ªæ¡¶æœ‰é…’ã€‚</strong> å› ä¸ºè¿™æ˜¯æˆ‘ä»¬å”¯ä¸€èƒ½è·çŸ¥çš„ä¿¡æ¯ã€‚</p><p>å½¢å¼åŒ–çš„ï¼Œæˆ‘ä»¬å¯¹æ¯ä¸ªæ¡¶å„åˆ—ä¸€å¼ æ—¥ç¨‹è¡¨ï¼Œç¬¬ $i$ è¡Œç¬¬ $j$ åˆ—ä¸º $1$ è¡¨ç¤ºç¬¬ $i$ å¤©ç¬¬ $j$ å¤´ç†Šå–äº†è¿™æ¡¶æ¶²ä½“ã€‚<strong>è¿™å¼ æ—¥ç¨‹è¡¨å¯¹åº”çš„æ˜¯ï¼šå¦‚æœè¿™æ¡¶æ˜¯é…’ï¼Œç†Šçš„è¡¨ç°ã€‚</strong></p><p>æ¡¶æœ‰æ ‡å·ï¼Œä¸¤ä¸ªæ¡¶çš„æ—¥ç¨‹è¡¨ä¸èƒ½ç›¸åŒä¸ç„¶å°±æ— æ³•ä¸ç†Šçš„è¡¨ç°ä¸€ä¸€å¯¹åº”ï¼Œé—®é¢˜è½¬åŒ–ä¸º<strong>æœ¬è´¨ä¸åŒæ—¥ç¨‹è¡¨è®¡æ•°</strong>ã€‚æ˜¾ç„¶ $R_d = \sum\limits_{i = 0}^{\min(n - 1, p)} \binom{n}{i} D^i$ï¼Œå³æšä¸¾ç¡ç€çš„ç†Šä¸ªæ•°ï¼Œä»¥åŠåœ¨å“ªå¤©ç¡ç€çš„ã€‚</p><p>æœ€åä¸€æ­¥æ˜¯å¤„ç†è¿™ä¸ªæŸ¿å­ã€‚$5s$, $O(pq)$ æ˜¯å¯ä»¥è¿‡çš„ï¼ã€éœ‡æƒŠã€‘æˆ‘ä»¬åªéœ€è¦é¢„å¤„ç†ç»„åˆæ•°ï¼Œ$p^2$ çº¦å»åˆ†å­å’Œåˆ†æ¯çš„å…¬å› æ•°ï¼Œæ˜¾ç„¶åˆ†å­ä¸€å®šä¼šè¢«æ¶ˆæˆ 1ã€‚</p><h2 id="mathcal-1-7"><a href="#mathcal-1-7" class="headerlink" title="$\mathcal{1.7}$"></a>$\mathcal{1.7}$</h2><hr><h3 id="XJOI1646"><a href="#XJOI1646" class="headerlink" title="[$XJOI1646$]"></a>[$XJOI1646$]</h3><p>ä»Šå¤©çš„é¢˜çƒ‚æäº†ï¼Œ$T1$ è£¸è´¹ç”¨æµï¼Œè¦ $dij$ï¼Œ$n^2$ ç‰ˆæœ¬å› ä¸º $m$ æ˜¯ $n^2$ çº§åˆ«è€Œ $dij$ å¤æ‚åº¦æ˜¯ $mlogn$ï¼›$T2$ $SAM$/$SA$ + çº¿æ®µæ ‘å‡ ä¹æ˜¯è£¸é¢˜ï¼›$T3$ dancing links è£¸é¢˜ï¼Œæˆ‘ä¸ä¼šæ‰€ä»¥æŠ±çµäº†ã€‚æ˜¯å†¬ä»¤è¥æ¨¡æ‹Ÿèµ›æ²¡é”™å§ï¼Œxy ä½ é†’é†’ï¼</p><p>æœ€å¯æ°”çš„æ˜¯æˆ‘å§ï¼Œ$T2$ æ²¡åˆ¤</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (i + lcp &gt; n) continue;</span><br></pre></td></tr></table></figure><p>$RE$ ä¸¢ $70$ï¼Œqswl</p><h1 id="xml-ä½ å†™é¢˜å¿…é¡»è€ƒè™‘è¾¹ç•Œ"><a href="#xml-ä½ å†™é¢˜å¿…é¡»è€ƒè™‘è¾¹ç•Œ" class="headerlink" title="xml ä½ å†™é¢˜å¿…é¡»è€ƒè™‘è¾¹ç•Œ"></a>xml ä½ å†™é¢˜å¿…é¡»è€ƒè™‘è¾¹ç•Œ</h1><p>hhz è¯´ $DLX$ ç°åœ¨ä¸å¤§ä¼šè€ƒï¼Œæ‰€ä»¥ä¸è®¢æ­£ã€‚</p><h3 id="è™«é€¢"><a href="#è™«é€¢" class="headerlink" title="è™«é€¢"></a><a href="https://uoj.ac/problem/45" target="_blank" rel="noopener">è™«é€¢</a></h3><p>æ¯«æ— å¤´ç»ªï¼Œåªèƒ½è†œé¢˜è§£ã€‚æš´åŠ›åšæ˜¾ç„¶è¡¥æ˜Ÿï¼Œæœ¬è´¨æ˜¯æ¯”è¾ƒçš„å¯¹æ•°å¤ªå¤šäº†ï¼Œè€ƒè™‘éšæœºåŒ–å‡å°‘æ¯”è¾ƒã€‚ç¡®å®šæ€è€ƒæ–¹å‘ï¼šæœ€å¤§åŒ–åŒæºè™«å­çš„æ¯”è¾ƒæ¦‚ç‡ä¸”å°½é‡è®©ä¸åŒæºè™«å­çš„æ¯”è¾ƒæ¦‚ç‡å°ã€‚æ³¨æ„è¿™é‡Œçš„â€œæ¯”è¾ƒæ¦‚ç‡â€æŒ‡çš„æ˜¯<strong>æœ‰æœºä¼šè¿›è¡Œæ¯”è¾ƒçš„æ¦‚ç‡</strong>ã€‚</p><p>éšæœºä¸ºæ¯ä¸ªåŸºå› åˆ†é…æƒå€¼ï¼Œå®šä¹‰ä¸€ä¸ªè™«å­çš„å…³é”®å€¼æ˜¯å®ƒçš„åŸºå› æœ€å°å€¼ï¼Œé‚£ä¹ˆä¸€å¯¹è™«å­<strong>æœ‰æœºä¼š</strong>è¿›è¡Œæ¯”è¾ƒå½“ä¸”ä»…å½“å®ƒä»¬å…³é”®å€¼ç›¸åŒï¼Œå³ä¸€å¯¹åŒæºè™«å­æ¯”è¾ƒæ¦‚ç‡æ˜¯ $1/3$ï¼ˆå‡è®¾å®ƒä»¬çš„åŸºå› é›†åˆåˆ†åˆ«ä¸º ${X, Y}$, ${X, Z}$ï¼Œè®¾æœ€å°å€¼åœ¨ $X$ å¤„çš„æ¦‚ç‡ä¸º $P$ï¼Œåˆ™æ˜¾ç„¶æœ€å°å€¼åœ¨ $Y$ã€$Z$ å¤„çš„æ¦‚ç‡ä¹Ÿæ˜¯ $P$ï¼Œ$P = 1/3$ï¼‰ï¼Œä¸€å¯¹ä¸åŒæºè™«å­æ¯”è¾ƒæ¦‚ç‡æ˜¯ $1/L$ï¼ˆé¢˜ç›®è¾“å…¥æ ¼å¼é‚£é‡Œè¯´çš„æ˜¯â€œé›†åˆâ€ï¼Œæˆ‘å°±ç†è§£ä¸ºä¸€åªè™«å­çš„åŸºå› ç»„é‡ŒåŸºå› ä¸é‡å•¦ï¼Œç»™å‡ºçš„åŸºå› æœ€åŠ£å°±åªæœ‰ $L$ ç§å•¦ï¼‰ã€‚</p><p>åŒæºè™«å­æ¯”è¾ƒæ¦‚ç‡å¤Ÿå¤§äº†ï¼Œä¸åŒæºè™«å­çš„æ¯”è¾ƒæ¦‚ç‡å´å¤ªå¤§äº†ã€‚è€ƒè™‘ä¸ºæ¯ä¸ªåŸºå› åˆ†é…ä¸¤ä¸ªæƒå€¼ï¼ˆå…¶å®å°±æ˜¯åŒæ¨¡ $hash$ å•¦ï¼‰ï¼Œä¸¤ä¸ªæ¦‚ç‡åˆ†åˆ«å˜ä¸º $1/9$ å’Œ $1/n$ï¼Œåšä¸€æ¬¡æœŸæœ›æˆåŠŸåŒ¹é… $n/9$ å¯¹ï¼ŒæœŸæœ›åš $9$ æ¬¡ï¼Œå¯ä»¥æ¥å—ã€‚</p><p><a href="https://uoj.ac/submission/446541" target="_blank" rel="noopener">$Code$</a></p><h3 id="é‡å­ç ´ç¢"><a href="#é‡å­ç ´ç¢" class="headerlink" title="é‡å­ç ´ç¢"></a><a href="https://uoj.ac/problem/328" target="_blank" rel="noopener">é‡å­ç ´ç¢</a></h3><p>åˆ«äººè¯´ä¸€çœ¼ $FWT$ï¼Œæˆ‘è¿ $FWT$ åŸç†éƒ½å¿˜æ‰äº†ï¼Œèµ¶å¿«å»å¤ä¹ ã€‚</p><p>åªèƒ½ç”¨å‰ä¸¤ä¸ªæ“ä½œï¼Œç¬¬ä¸€ä¸ªè¿”å›ä»»æ„ä¸€ä¸ªå€¼ä¸ä¸º $0$ çš„ä¸‹æ ‡ä¸”è¿”å›åå°±é‡ç½®åºåˆ—ï¼Œç¬¬äºŒä¸ªé‚£ä¸ª $+ 2^i$ çš„å½¢å¼å¾ˆåƒ $FWT$ã€‚<strong>é¢˜ç›®ä¿è¯ $X \oplus Y$ ä¸å˜ã€‚</strong></p><p>è€ƒè™‘æ„é€  $A$ çŸ©é˜µä½¿å¾—å®ƒå°±æ˜¯ $FWT$ï¼ˆå…è®¸ä¹˜ä¸Šç³»æ•°ï¼‰ï¼Œæ™®é€šçš„ $FWT$ çŸ©é˜µæ˜¯è¿™æ ·çš„ï¼š</p><p>$$<br>\begin{bmatrix} 1 &amp; 1 \ 1 &amp; -1 \end{bmatrix}<br>\quad<br>$$</p><p>ä½†å®ƒä¸æ»¡è¶³ $AA^T = I$ï¼ˆæ‰‹ç©å³å¯éªŒè¯ï¼‰ã€‚äº‹å®ä¸Šè®©çŸ©é˜µæ¯ä¸ªå…ƒç´ ä¹˜ä¸Š $\frac{1}{\sqrt{2}}$ è¿™ä¸ªç³»æ•°å³å¯ã€‚</p><p>ç°åœ¨æˆ‘ä»¬èƒ½ç”¨æ“ä½œäºŒåš $FWT$ äº†ï¼è€ƒè™‘å®ƒå®ç°äº†ä»€ä¹ˆï¼Œä»¥å»ºç«‹ä¸æ“ä½œä¸€çš„è”ç³»ï¼š$aâ€™_T = ( (-1)^{|T \cap X|} + (-1)^{|T \cap Y|} )a_X$ï¼ˆ$a_X = a_Y$ï¼‰ï¼Œè€Œè¿™ä¸ªç©æ„åªæœ‰åœ¨ $|T \cap X|$ å’Œ $|T \cap Y|$ å¥‡å¶æ€§ç›¸åŒçš„æƒ…å†µä¸‹æ‰ä¸ä¸º $0$ã€‚ç”± $FWT$ çš„æ¨å¯¼è¿‡ç¨‹å¯çŸ¥ï¼Œ$T \cap (X \oplus Y)$ ä¸ºå¶æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ query() è¿”å›çš„ä»»ä½•å€¼ä¸ $X \oplus Y$ çš„ $And$ ä¸ºå¶æ•°ã€‚ç”±äºéšæœºï¼ŒæœŸæœ› $O(n)$ æ¬¡å‡ºè§£ï¼ˆ<a href="https://wuhongxun.blog.uoj.ac/blog/3112" target="_blank" rel="noopener">å®˜æ–¹é¢˜è§£</a>æœ‰è¯¦ç»†è¯´æ˜ï¼Œæˆ‘ä¸æ˜¯å¾ˆæ‡‚QAQï¼Œåªæ˜¯è§‰å¾—è¿™ç©æ„æ¦‚ç‡æŒºæ­£ç¡®ï¼‰</p><p><a href="https://uoj.ac/submission/446587" target="_blank" rel="noopener">$Code$</a></p><h3 id="AGC026F-Manju-Game"><a href="#AGC026F-Manju-Game" class="headerlink" title="[AGC026F-Manju\ Game]"></a>[AGC026F-Manju\ Game]</h3><p><a href="https://www.cnblogs.com/zhouzhendong/archive/2004/01/13/AGC026F.html" target="_blank" rel="noopener">å‘¨æŒ‡å¯¼åšå®¢</a></p><p>å¥½å¦™çš„åšå¼ˆå•Šã€‚$n$ ä¸ºå¶æ•°ï¼Œ$A$ éšä¾¿é€‰ä¸ªä¸æ˜¯ç«¯ç‚¹çš„ç‚¹éƒ½ä¼šä¸¢æ‰å…ˆæ‰‹çš„ä¼˜åšæƒåˆ©ï¼Œåªèƒ½ä»æŸä¸ªç«¯ç‚¹å–ã€‚</p><p>$n$ ä¸ºå¥‡æ•°ï¼Œ$A$ æ˜¾ç„¶ä¹Ÿä¸ä¼šé€‰å¥‡æ•°ä½ï¼Œå…ˆè®¡å…¥ä»ç«¯ç‚¹å¼€å§‹å–å®Œçš„ç­–ç•¥ï¼Œå‰©ä¸‹é‚£ä¸€å®šæ˜¯ $A$ é€‰äº†è‹¥å¹²æ¬¡å¶æ•°ä½åå‰©ä¸‹ä¸€ä¸ªé•¿åº¦ä¸ºå¥‡æ•°çš„åŒºé—´ï¼Œ$A$ ä»ç«¯ç‚¹å¼€å§‹å–å®Œã€‚</p><p>è€ƒè™‘å»ºå‡ºç­–ç•¥çš„äºŒå‰æ ‘ï¼Œé‚£äº›å¶å­ä»£è¡¨ç€æœ€åå‰©ä¸‹çš„é•¿åº¦ä¸ºå¥‡æ•°çš„åŒºé—´ã€‚$A$ çš„è·ç›Šå¯ä»¥åˆ†ä¸º $[1, l - 1]$ å¶æ•°ä½ï¼Œ$[l, r]$ å¥‡æ•°ä½ï¼Œ$[l + 1, n]$ å¶æ•°ä½ã€‚ä»å¦ä¸€ç§è§’åº¦çœ‹ï¼ŒäºŒç›¸å½“äºåŒºé—´å–åã€‚ä¸€ã€ä¸‰éƒ½æ˜¯ç¡®å®šçš„ï¼ŒäºŒæ€ä¹ˆç®—å‘¢ï¼ŸB ä¼šå°½é‡å¯¼å‘åŠ£çš„å¥‡æ•°é•¿åº¦åŒºé—´ï¼Œé‚£æˆ‘ä»¬è¦æœ€å¤§åŒ–æœ€åŠ£çš„å¥‡æ•°é•¿åº¦åŒºé—´é‡Œ $A - B$ çš„è´¡çŒ®ï¼ŒäºŒåˆ†å°±å¯ä»¥äº†ã€‚</p><h3 id="Harry-the-Potter"><a href="#Harry-the-Potter" class="headerlink" title="$Harry\ the\ Potter$"></a><a href="https://www.luogu.com.cn/problem/CF1286F" target="_blank" rel="noopener">$Harry\ the\ Potter$</a></h3><p>ç ´ç‰¹ï¼ã€‚å¥½æ¥è®²è¿™é¢˜ï¼Œè€ƒè™‘è¿è¾¹ï¼Œå½¢æˆæ ‘ï¼Œè¿™æ ‘è‹¥æ˜¯æˆåŠŸåˆ ä¸ºå…¨ $0$ é‚£ä¹ˆç›¸å½“äºçœäº†ä¸€æ¬¡æ“ä½œï¼Œå¦åˆ™å•ç‚¹æ“ä½œä¸ä¼šæ›´åŠ£ã€‚è€ƒè™‘å“ªäº›ç‚¹èƒ½ç»„æˆæ£®æ—ï¼Œå…ˆé¢„å¤„ç†ä¸€æ£µæ ‘èƒ½å¦æˆåŠŸåˆ å®Œã€‚</p><p>å…ˆä¸è€ƒè™‘ $\pm 1$ï¼Œæˆ‘ä»¬ä»å¶å­åˆ åˆ°æ ¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¯¹æ ¹æœ€ç»ˆå€¼çš„è´¡çŒ®çš„ç¬¦å·ä¸ºæ·±åº¦å¥‡å¶æ€§ã€‚è€ƒè™‘ $\pm 1$ï¼Œè®¾å¥‡æ•°å±‚ä¸º $A$ï¼Œå¶æ•°å±‚ä¸º $B$ï¼Œæˆ‘ä»¬å‘ç°åªè¦ $|sum(A) - sum(B)| &lt; |S|$ ä¸” $|S - 1|$ ä¸ $sum(S)$ å¥‡å¶æ€§ç›¸åŒåˆ™èƒ½åˆ å®Œã€‚</p><p>$O(3^n)$ æšä¸¾å­é›†ä¸å¤ªä¹è§‚ï¼Œè€ƒè™‘æŠ˜åŠæœç´¢ï¼Œå½¢æˆçš„ä¸¤ä¸ªæƒå€¼é›†åˆåˆ†åˆ«æ’åºï¼ŒåŒ¹é…ï¼Œå¤æ‚åº¦æ˜¯ $\sum\limits_{i = 0}^{|S|} \binom{|S|}{i} 2^{\frac{|S|}{2}}$ï¼ŒäºŒé¡¹å¼å®šç†ä¸€ç®—æ˜¯ $O((1 + \sqrt{2})^n)$ã€‚åé¢è·‘ä¸ªå­é›†å·ç§¯è‡ªå·±å·è‡ªå·± $n$ æ¬¡ï¼Œæˆ–è€…ç›´æ¥ $O(3^n)$ ä¹Ÿæ²¡æ…¢åˆ°å“ªå»ï¼ˆä»€</p><h2 id="mathcal-1-8"><a href="#mathcal-1-8" class="headerlink" title="$\mathcal{1.8}$"></a>$\mathcal{1.8}$</h2><hr><h3 id="XJOI1645"><a href="#XJOI1645" class="headerlink" title="$XJOI1645$"></a>$XJOI1645$</h3><p>ä»Šå¤©æ˜¯å­¦ä¹ æ–°çŸ¥è¯†åœºã€‚</p><h4 id="T1-4"><a href="#T1-4" class="headerlink" title="$T1$"></a>$T1$</h4><p>å­¦ä¹  $PAM$ ingã€‚é‡è¦æ€§è´¨ï¼š<strong>ä¸€ä¸ªä¸²çš„æœ¬è´¨ä¸åŒå›æ–‡å­ä¸²ä¸ªæ•°æ˜¯ $O(n)$ çº§åˆ«çš„</strong>ï¼ˆå…¶å®è¿™ç‚¹ä¹Ÿå¯ä»¥ä» $manacher$ çœ‹å‡ºæ¥ï¼‰ã€‚</p><p>äºŒåˆ†ç­”æ¡ˆã€‚ä¸èƒ½åŒæ—¶å‡ºç°ä¸€ä¸ªä¸²å’Œå®ƒçš„å­ä¸²ï¼Œè¿™å¯¹åº”åœ¨ $PAM$ ä¸Šå°±æ˜¯å»ºå‡ºç”± $(x, ch[x, -])$ å’Œ $(x, fail[x])$ ç»„æˆçš„ $DAG$ ååœ¨ $DAG$ ä¸Šæ±‚æœ€é•¿åé“¾ã€‚ä»€ä¹ˆä½ ä¸çŸ¥é“ä»€ä¹ˆæ˜¯æœ€é•¿åé“¾ï¼Ÿ<a href>æŒ‡è·¯caiji blog</a>ã€‚</p><h4 id="T2-4"><a href="#T2-4" class="headerlink" title="$T2$"></a>$T2$</h4><p>LCT æ²¡æ³•è®©ä¸€å¯¹ç‚¹çš„å­æ ‘ä¿¡æ¯éƒ½æ­£ç¡®ï¼åªèƒ½ $siz[y] - lit[y] - 1$ äº†ã€‚</p><h4 id="T3-4"><a href="#T3-4" class="headerlink" title="$T3$"></a>$T3$</h4><p>hhz æ‰”ä¸ªæŸ¿å­å°±è·‘äº† â€œè¿™æ˜¯ $Pollard-Rho$ æ¿é¢˜â€ï¼š</p><p>$$\sum\limits_{d | n} \sum\limits_{g | d} \mu(g) \phi(d)^K \sum\limits_{i = 1}^{\lfloor \frac{n}{gd} \rfloor} ig$$</p><p>å¯¹æ¯ä¸ª $K$ è·‘ä¸€é $P-R$ã€‚ä½†æˆ‘ä¸ä¼šè€Œä¸”å¹¶ä¸å¤ªæƒ³è®¢ï¼Œæ‰€ä»¥å’•å’•ã€‚ã€‚</p><h3 id="Raining-Season"><a href="#Raining-Season" class="headerlink" title="$Raining\ Season$"></a><a href="https://codeforces.com/contest/1019/problem/E" target="_blank" rel="noopener">$Raining\ Season$</a></h3><p>å®¹æ˜“å‘ç°æˆ‘ä»¬è¦æ±‚çš„æ˜¯<strong>æœä¸‹</strong>çš„åŠå¹³é¢äº¤ã€‚æ™®é€šçš„åŠå¹³é¢äº¤å¯¹æœ¬é¢˜æ²¡æœ‰å¯å‘æ€§ã€‚å®é™…ä¸Šå®ƒå¯ä»¥ç”¨å’Œæ±‚<strong>ä¸Š</strong>å‡¸å£³å‡ ä¹ä¸€æ ·çš„æ–¹æ³•è§£å†³ï¼Œåªéœ€è¦æŠŠ $ax + b$ çœ‹ä½œ $(a, b)$ã€‚ä¸ºä»€ä¹ˆï¼Ÿå‡è®¾åŠå¹³é¢äº¤æœ‰ $a$ å’Œ $b$ï¼Œå¼¹ $b$ å‡ºæ ˆçš„æ¡ä»¶æ˜¯ $a$ å’Œ $b$ çš„äº¤ç‚¹åœ¨ $c$ ä¸‹é¢ï¼›å‡¸åŒ…å¼¹ $b$ å‡ºæ ˆçš„æ¡ä»¶æ˜¯ $(b - a) \times (c - a) &gt; 0$ï¼›æŠŠä¸¤ä¸ªæŸ¿å­å±•å¼€å‘ç°æ˜¯ä¸€æ ·çš„ã€‚<a href="https://trinkle.blog.uoj.ac/blog/235" target="_blank" rel="noopener">å¤§ä½¬åšå®¢å†™å¾—æŒºè¯¦ç»†ã€‚</a></p><p>æ‰€ä»¥è¾¹åˆ† + é—µå¯å¤«æ–¯åŸºåˆå¹¶å‡¸åŒ…å³å¯ã€‚<strong>æ³¨æ„ï¼šè¾¹åˆ†ä¸¤å€ç©ºé—´ã€‚</strong></p><p><a href="https://codeforces.com/contest/1019/submission/103716170" target="_blank" rel="noopener">$Code$</a></p><h2 id="mathcal-1-9"><a href="#mathcal-1-9" class="headerlink" title="$\mathcal{1.9}$"></a>$\mathcal{1.9}$</h2><hr><h3 id="LOJ6275-æ£‹ç›˜"><a href="#LOJ6275-æ£‹ç›˜" class="headerlink" title="$LOJ6275-æ£‹ç›˜$"></a><a href="https://loj.ac/p/6275" target="_blank" rel="noopener">$LOJ6275-æ£‹ç›˜$</a></h3><p>dpï¼Œ$f_{i, s, j}$ è¡¨ç¤ºåšå®Œ $i$ åˆ—ï¼Œæœ«åˆ—çŠ¶æ€ä¸º $s$ï¼Œè¿é€šå— $j$ ä¸ªçš„æ–¹æ¡ˆæ•°ã€‚å»ºç«‹ $f$ çš„ OGFï¼š$F_{i, s} = \sum\limits_{j = 0}^{nm} f_{i, s, j} x^j$ï¼Œåˆ™æœ‰ $F_{i, s} = \sum F_{i - 1, sâ€™}$ï¼Œç¬¬äºŒç»´çœ‹ä½œçŸ©ä¹˜ $F_i = F_{i - 1} * A$ï¼Œæˆ‘ä»¬è¦æ±‚çš„å³æ˜¯ $ans = \sum_s [x^k] A^m$ã€‚</p><p>å¤šé¡¹å¼ä¹˜æ³•æ˜¾ç„¶ä¸ç°å®ï¼Œå¸¦å•ä½æ ¹è¿›å»æ±‚å‡ºå¤šé¡¹å¼ç‚¹å€¼å† $IDFT$ å›æ¥å°±å¥½ã€‚</p><ul><li>å‘ç‚¹ï¼šå­˜åœ¨åˆå¹¶è¿é€šå—çš„æƒ…å†µã€‚è¦æŠŠ â€˜101â€™ æ‹†æˆæ²¡æœ‰ä¸ä¼šåˆå¹¶å’Œå¯èƒ½åˆå¹¶ä¸¤ä¸ªçŠ¶æ€ã€‚ä¾‹å¦‚ï¼š<pre><code>ä¸åˆå¹¶ï¼š       å¯èƒ½åˆå¹¶ï¼š11           1100           1001           11</code></pre></li></ul><p><a href="https://loj.ac/s/1029957" target="_blank" rel="noopener">$Code$</a></p><h2 id="çªç„¶çš„å®‰æ’ï¼Œè¦å›å½’æ–‡åŒ–è¯¾ä¸‰å‘¨äº†ï¼Œå¸Œæœ›æ°´å¹³ä¸é™åå‡ï¼ˆä½ è´ªå¿ƒäº†ï¼‰"><a href="#çªç„¶çš„å®‰æ’ï¼Œè¦å›å½’æ–‡åŒ–è¯¾ä¸‰å‘¨äº†ï¼Œå¸Œæœ›æ°´å¹³ä¸é™åå‡ï¼ˆä½ è´ªå¿ƒäº†ï¼‰" class="headerlink" title="çªç„¶çš„å®‰æ’ï¼Œè¦å›å½’æ–‡åŒ–è¯¾ä¸‰å‘¨äº†ï¼Œå¸Œæœ›æ°´å¹³ä¸é™åå‡ï¼ˆä½ è´ªå¿ƒäº†ï¼‰"></a>çªç„¶çš„å®‰æ’ï¼Œè¦å›å½’æ–‡åŒ–è¯¾ä¸‰å‘¨äº†ï¼Œå¸Œæœ›æ°´å¹³ä¸é™åå‡ï¼ˆä½ è´ªå¿ƒäº†ï¼‰</h2><h1 id="æ˜¥å®µè‹¦çŸ­ï¼Œå°‘å¥³å‰è¿›å§ï¼"><a href="#æ˜¥å®µè‹¦çŸ­ï¼Œå°‘å¥³å‰è¿›å§ï¼" class="headerlink" title="æ˜¥å®µè‹¦çŸ­ï¼Œå°‘å¥³å‰è¿›å§ï¼"></a><em>æ˜¥å®µè‹¦çŸ­ï¼Œå°‘å¥³å‰è¿›å§ï¼</em></h1><p>å­¦ä¹ äºŒè¿›åˆ¶åˆ†ç»„æ€æƒ³ï¼šåœ¨çº¿ï¼Œç»´æŠ¤ $logn$ ä¸ªå—ï¼Œå¤§å°åˆ†åˆ«ä¸º $2^k$, $2^{k - 1}$, $\cdots$, åŠ¨æ€å¾€æœ«å°¾æ’å…¥æ–°å…ƒç´ ï¼Œå½“ç¬¬ $i$ å—çš„ $size$ = ç¬¬ $i - 1$ å—çš„ $size$ æ—¶å°±åˆå¹¶ $i$ å’Œ $i - 1$ï¼ŒæŸ¥è¯¢å°±åœ¨ $logn$ ä¸ªå—ä¸ŠäºŒåˆ†ï¼Œå¤æ‚åº¦ $O(n * T(n) * logn)$ï¼Œå…¶ä¸­ $T(n)$ æ—¶åˆå¹¶ä¸€æ¬¡çš„å¤æ‚åº¦ã€‚è¯æ˜å¯ä»¥å‡æ‘Šåˆ†æï¼ˆç±»ä¼¼äºŒè¿›åˆ¶åŠ æ³•ï¼‰ï¼Œâ€œåˆ°ä¸‹ä¸€æ¬¡æ“ä½œçš„æ—¶é—´å’Œå—å¤§å°ç›¸ç­‰â€ï¼Œè®¾ $n \cdot T(n)$ ä¸ºå¤„ç†å¤§å°ä¸º n çš„å—çš„æ—¶é—´ï¼Œ$O(\sum\limits_{i = 1}^{logn} \frac{n}{2^i} \cdot 2^i \cdot T(2^i) ) = O(n \cdot T(n) \cdot logn)$</p><h3 id="ç„å­¦"><a href="#ç„å­¦" class="headerlink" title="ç„å­¦"></a><a href="https://uoj.ac/problem/46" target="_blank" rel="noopener">ç„å­¦</a></h3><p>é¦–å…ˆè¿™æ“ä½œæ”¯æŒå¤åˆã€‚çœ‹åˆ°æŸ¥è¯¢æ“ä½œæƒ³åˆ°äºŒè¿›åˆ¶æ‹†åˆ†ä»€ä¹ˆçš„â€¦ æ²¡é”™ï¼ŒäºŒè¿›åˆ¶åˆ†ç»„ï¼Œä»¥æ“ä½œä¸ºä¸‹æ ‡ï¼Œæ¯ä¸ªå—ç»´æŠ¤åºåˆ—â€”â€”æ˜¾ç„¶æœ‰å¾ˆå¤šç›¸é‚»ä½ç½®çš„æ“ä½œç›¸åŒï¼ˆå› ä¸º $q$ ä¸ªæ“ä½œåªä¼šé€ æˆ $O(q)$ ç§ä¸åŒæ“ä½œï¼‰ï¼ŒæŠŠæ¯å—ç¼©æˆä¸€ä¸ªç‚¹å°±å¥½ï¼Œæ€»ç‚¹æ•°ä¸€åª $log$ï¼ˆä¸è¿‡æ˜¯ $nlogn$ è¿˜æ˜¯ $qlogq$ å•Šï¼Ÿï¼‰ï¼Œåˆå¹¶å¤æ‚åº¦æ˜¯ $O(å—å¤§å°)$ï¼Œå½’å¹¶å³å¯ã€‚</p><p><a href="https://uoj.ac/submission/447523" target="_blank" rel="noopener">$Code$</a></p><h2 id="mathcal-1-16"><a href="#mathcal-1-16" class="headerlink" title="$\mathcal{1.16}$"></a>$\mathcal{1.16}$</h2><hr><p>ç»å†äº†ä¸€å‘¨çš„whkæ‘§æ®‹ï¼Œç°åœ¨æ¥æŠ¥ä¸ªå¹³å®‰ [æŠ±æ‹³]</p><h3 id="XJOI1651"><a href="#XJOI1651" class="headerlink" title="$XJOI1651$"></a>$XJOI1651$</h3><h4 id="T1-5"><a href="#T1-5" class="headerlink" title="$T1$"></a>$T1$</h4><p>å°±æ˜¯ $0 \leq pre_i \leq pre_n$ å•¦ã€‚ç”»æŠ˜çº¿å›¾å‘ç° $C$ éƒ½é€‰ï¼Œ$T$ é€‰ä¸é€‰è¦è€ƒè™‘ä¼šä¸ä¼šè®©å‰é¢çš„ $\max{pre_i}$ è¶…è¿‡ $pre_n$ï¼Œ$O(Qn)$</p><p>ç…§ç€æŠ˜çº¿å›¾èƒ¡ç»“è®ºï¼š$ans = -(pre_{mn} + suf_{mn})$ï¼Œå…¶ä¸­ $pre_{mn}$ å’Œ $suf_{mn}$ ä¸é‡å ï¼Œé¦–å…ˆ $ans$ å¿…ç„¶ä¸ä¼šå°äºè¿™ä¸ªä¸œè¥¿ï¼Œå…¶æ¬¡ä¸ä¼šæ›´å¤§ï¼Œå¦‚æœæ›´å¤§æ„å‘³ç€ä¸­é—´åœ°å¸¦æœ‰å‰åç¼€ä¸ºè´Ÿæ•°ï¼ŒçŸ›ç›¾ã€‚</p><h4 id="T2-5"><a href="#T2-5" class="headerlink" title="$T2$"></a>$T2$</h4><p>hhz è¯´çœ‹æˆä¸€ä¸ªçŠ¶æ€çš„ dfs æ ‘ï¼Œæ¯æ¬¡åŒˆç‰™åˆ©æ‰¾ä¸€æ¡å¢å¹¿ç¯ï¼ˆæ˜¾ç„¶è¦ç¯ï¼Œæ‰èƒ½ä»ä¸€ä¸ªå®Œç¾åŒ¹é…å˜æˆå¦ä¸€ä¸ªå®Œç¾åŒ¹é…ï¼‰ï¼Œå¤æ‚åº¦ $O(Knm)$ï¼Œå› ä¸º dfs æ ‘ç‚¹æ•°ä¸º $O(Kn)$ï¼Œå•æ¬¡åŒˆç‰™åˆ©ä¸º $O(m)$</p><p>æŠŠ dfs æ ‘æ€ä¹ˆç¼©æˆäºŒå‰æ ‘ï¼Œå°±å˜æˆ $O(Km)$ äº†ï¼Ÿæ¯æ¬¡åŒˆç‰™åˆ©ä¸å±€é™äºæ‰¾å®šç‚¹çš„å¢å¹¿ç¯è€Œæ˜¯æ‰¾å…¨å±€çš„å¢å¹¿ç¯ï¼Ÿä¸å¤ªæ‡‚ã€‚</p><h4 id="T3-5"><a href="#T3-5" class="headerlink" title="$T3$"></a>$T3$</h4><p><a href="https://www.luogu.com.cn/problem/P6499" target="_blank" rel="noopener">åŸé¢˜</a> å°±æ˜¯é—®ä½ èƒ½å¦ç”¨ $K$ ä¸ªç‚¹å µä½æ ¹åˆ°æ‰€æœ‰å¶å­çš„è·¯å¾„ã€‚é¦–å…ˆè£å‰ªæ ‘ï¼Œå‰ªæ‰æ·±åº¦ $&gt; K$ çš„å’Œæ·±åº¦ä¸è¶³ $K$ çš„å­æ ‘ï¼ˆè®¾æ ¹æ·±åº¦ä¸º $0$ï¼‰ã€‚è€ƒè™‘æœ€åæƒ…å†µï¼Œæ ¹ä¸‹æŒ‚ç€ $K$ æ¡é•¿åº¦ä¸º $K$ çš„é“¾ï¼Œæ¯æ¬¡å µä¸€ä¸ªæ·±åº¦ä¸º $i$ çš„ç‚¹ï¼Œ$K$ æ¬¡åˆšå¥½å µå®Œï¼›å…¶ä½™æƒ…å†µä¹Ÿå°±æ˜¯æœ‰å¤šå‰çš„ç‚¹ï¼Œä¸€æ¬¡å µå¯èƒ½ä¼šå µæ‰å¤šä¸ªå¶å­ï¼Œæ‰€ä»¥ä¸Šé¢é‚£ç§æ˜¯æœ€åæƒ…å†µã€‚</p><p>S åªæœ‰åœ¨ $n &gt; K * K + 1$ æ—¶æ‰è·èƒœï¼Œæ‰€ä»¥ $K &gt; 19$ æ—¶ç›´æ¥ DAã€‚ä¸€ä¸ªæ·±åº¦é€‰ä¸€ä¸ªç‚¹ï¼ŒçŠ¶å‹ï¼Œ$f[i, s]$ è¡¨ç¤ºé€‰äº†æ·±åº¦é›†åˆä¸º $s$ çš„ç‚¹ï¼Œè¦†ç›–äº† $1$ ~ $i$ çš„å¶å­ã€‚</p><h3 id="èˆŒå°–ä¸Šçš„æ–¹ä¼¯ä¼¯"><a href="#èˆŒå°–ä¸Šçš„æ–¹ä¼¯ä¼¯" class="headerlink" title="èˆŒå°–ä¸Šçš„æ–¹ä¼¯ä¼¯"></a><a href="https://www.luogu.com.cn/problem/P3289" target="_blank" rel="noopener">èˆŒå°–ä¸Šçš„æ–¹ä¼¯ä¼¯</a></h3><h3 id="æ°´æ± "><a href="#æ°´æ± " class="headerlink" title="æ°´æ± "></a><a href="https://www.luogu.com.cn/problem/P6794" target="_blank" rel="noopener">æ°´æ± </a></h3><h3 id="NOI2017-æ³³æ± "><a href="#NOI2017-æ³³æ± " class="headerlink" title="$NOI2017-æ³³æ± $"></a><a href="https://www.luogu.com.cn/problem/P3824" target="_blank" rel="noopener">$NOI2017-æ³³æ± $</a></h3><p>å†™åœ¨ã€ŒBMã€å­¦ä¹ ç¬”è®°é‡Œäº†ã€‚</p><h3 id="æ›¼å“ˆé¡¿è·ç¦»æœ€å°ç”Ÿæˆæ ‘"><a href="#æ›¼å“ˆé¡¿è·ç¦»æœ€å°ç”Ÿæˆæ ‘" class="headerlink" title="æ›¼å“ˆé¡¿è·ç¦»æœ€å°ç”Ÿæˆæ ‘"></a><a href="https://darkbzoj.tk/problem/2177" target="_blank" rel="noopener">æ›¼å“ˆé¡¿è·ç¦»æœ€å°ç”Ÿæˆæ ‘</a></h3><p>è¿è¾¹ $O(n^2)$ï¼Œç„¶è€Œå’Œ $A$ è¿è¾¹ï¼Œåªè¦æŠŠä»¥ $A$ ä¸ºåæ ‡åŸç‚¹çš„åæ ‡ç³»æ¯ $45$ åº¦åˆ’ä¸ºä¸€å—ï¼Œæ¯å—é€‰ç¦» $A$ æœ€è¿‘çš„ç‚¹è¿è¾¹ï¼Œè¾¹æ•° $O(n)$</p><p>è¯æ˜çš„è¯ï¼Œè€ƒè™‘æ¯å—çš„ $y$ å’Œ $x$ ç›¸å¯¹å¤§å°éƒ½æ˜¯ç¡®å®šçš„ï¼ŒæŠŠç»å¯¹å€¼æ‹†å¼€å¤§åŠ›åˆ†è®¨å°±å¥½ã€‚ä»¥ $45$ ~ $90$ åº¦è¿™ä¸ªåŒºé—´ä¸ºä¾‹ï¼Œè®¾è¯¥åŒºåŸŸå†…æœ‰ä¸¤ä¸ªç‚¹ $B(x_1, y_1)$ã€$C(x_2, y_2)$ï¼Œè®¾ $AB \leq AC$ï¼Œæˆ‘ä»¬è¦è¯æ— è®ºå¦‚ä½• $AC \geq BC$</p><p>$AB = x_1 + y_1, AC = x_2 + y_2$</p><ol><li><p>$x_1 &gt; x_2$, $y_1 &gt; y_2$</p><p> ä¸æ»¡è¶³ $AB \leq AC$.</p></li><li><p>$x_1 \leq x_2$, $y_1 &gt; y_2$</p><p> $BC = x_2 - x_1 + y_1 - y_2$</p><p> $AC - BC = x_1 - y_1 + 2 * y_2$</p><p> å‡è®¾ $AC &lt; BC$, $y_1 &gt; x_1 + 2 * y_2$</p><p> ç”±äº $y_1 &gt; y_2 &gt; x_2 &gt; x_1$,</p><p> $AB = x_1 + y_1 &gt; 2 * x_1 + 2 * y_2$, $AC = x_2 + y_2 &lt; 2 * y_2 &lt; AB$ï¼ŒçŸ›ç›¾</p></li><li><p>$x_1 &gt; x_2$, $y_1 \leq y_2$</p><p> ä¸ $2$ åŒç†.</p></li><li><p>$x_1 \leq x_2$, $y_1 \leq y_2$</p><p> $AB + BC = AC$, $AC &gt; AB$</p></li></ol><p>ç»¼ä¸Šæ‰€è¿°ï¼Œ$AC \geq BC$ï¼Œæ ¹æ® $Kruskal$ çš„åŸç†ï¼Œ$AC$ æ°¸è¿œä¸ä¼šè¢«è¿ä¸Šã€‚</p><p>å®é™…è€ƒè™‘å››ä¸ªåŒºåŸŸå°±è¡Œäº†ï¼Œå› ä¸ºè¾¹æ˜¯åŒå‘çš„ã€‚æ–¹ä¾¿çš„å®ç°æ–¹æ³•æ˜¯æŠŠ $-90$ ~ $45$ çš„ç‚¹éƒ½ç¿»åˆ° $45$ ~ $90$ é‡Œæ¥ã€‚<br>$(xâ€™, yâ€™)$ åœ¨ä»¥ $A(x, y)$ ä¸ºåŸç‚¹çš„ $45$ ~ $90$ åŒºåŸŸé‡Œï¼Œå½“ä¸”ä»…å½“ $y - x \leq yâ€™ - xâ€™$ï¼ŒæŸ¥è¯¢ $yâ€™ - xâ€™ \geq y - x$ ä¸­ $xâ€™ + yâ€™$ æœ€å°çš„ç‚¹å°±å¥½äº†ã€‚æŠŠæ‰€æœ‰ç‚¹æŒ‰ $y - x$ ç¦»æ•£ï¼ŒæŒ‰ $x$ æ’åºï¼Œæ ‘çŠ¶æ•°ç»„ç»´æŠ¤ã€‚</p><p>å‡ºç°äº†çµå¼‚äº‹ä»¶â€”â€”æŠŠç»“æ„ä½“ç›´æ¥æŒ‰ç…§ $y - x$ æ’åºä¼šé”™ï¼Œè€ŒæŠŠ $y - x$ æ‹åˆ°ä¸´æ—¶æ•°ç»„é‡Œå†ç¦»æ•£åŒ–å°±å¯¹äº†ï¼Œäººéƒ½è°ƒå‚»äº†ï¼Œè¿™æ˜¯ä¸ºå•¥å•Šï¼Ÿ</p><p><a href="https://darkbzoj.tk/submission/105321" target="_blank" rel="noopener">$Code$</a></p><p>å­¦ä¹ å¹¿ä¹‰ SAMã€‚</p><h3 id="è¯¸ç¥çœ·é¡¾çš„å¹»æƒ³ä¹¡"><a href="#è¯¸ç¥çœ·é¡¾çš„å¹»æƒ³ä¹¡" class="headerlink" title="è¯¸ç¥çœ·é¡¾çš„å¹»æƒ³ä¹¡"></a><a href="https://www.luogu.com.cn/problem/P3346" target="_blank" rel="noopener">è¯¸ç¥çœ·é¡¾çš„å¹»æƒ³ä¹¡</a></h3><p>æ¨¡æ¿é¢˜ï¼Œä»æ¯ä¸ªå¶å­å‡ºå‘å»º Trie æ ‘ï¼Œåœ¨ Trie æ ‘ä¸Šè·‘ SAMï¼Œæ’å…¥æ–°ç‚¹æ—¶çœ‹ä¸€ä¸‹ä¹‹å‰æœ‰æ²¡æœ‰ã€‚</p><h3 id="CF666E-Forensic-Examination"><a href="#CF666E-Forensic-Examination" class="headerlink" title="$CF666E-Forensic\ Examination$"></a><a href="https://www.luogu.com.cn/problem/CF666E" target="_blank" rel="noopener">$CF666E-Forensic\ Examination$</a></h3><p>å»ºå¹¿ä¹‰ SAMï¼Œé¢„å¤„ç†æ–‡æœ¬ä¸²æ¯ä¸ªå­—ç¬¦åœ¨å¹¿ä¹‰ SAM ä¸­æ‰€å¯¹çš„ä½ç½®ï¼ŒæŸ¥è¯¢æ–‡æœ¬ä¸² [pl, pr] æ—¶å°±ä» pr æ‰€å¯¹çš„ä½ç½®ä¸€åªå‘ä¸Šè·³è·³è·³ï¼Œè·³åˆ°æœ€åä¸€ä¸ªé•¿åº¦ä¸å°äº pr - pl + 1 çš„ä½ç½®ã€‚å¹¿ä¹‰ SAM ä¸Šçº¿æ®µæ ‘åˆå¹¶â€œæ¥è‡ªå“ªä¸ªä¸²â€ã€‚</p><p>éœ€è¦æ³¨æ„ï¼Œå› ä¸ºæ˜¯ä¿ç•™æ¯ä¸ªèŠ‚ç‚¹çš„çº¿æ®µæ ‘ä¿¡æ¯ï¼Œçº¿æ®µæ ‘åˆå¹¶è¦æŠŠåˆå¹¶åçš„ä¿¡æ¯æ”¾åˆ°<strong>æ–°å»ºèŠ‚ç‚¹</strong>ä¸Šã€‚</p><hr><p>ä¸€æœˆåˆ°å°¾å·´äº†ï¼Œè€ƒå®ŒæœŸæœ«è€ƒäº†ï¼</p><p>æ¥å­¦ç«èµ›å›¾ã€‚</p><h3 id="ä¸–ç•Œæ˜¯ä¸ªåŠ¨ç‰©å›­"><a href="#ä¸–ç•Œæ˜¯ä¸ªåŠ¨ç‰©å›­" class="headerlink" title="ä¸–ç•Œæ˜¯ä¸ªåŠ¨ç‰©å›­"></a><a href="https://uoj.ac/problem/451" target="_blank" rel="noopener">ä¸–ç•Œæ˜¯ä¸ªåŠ¨ç‰©å›­</a></h3><p>å†™åœ¨ã€Œã€å­¦ä¹ ç¬”è®°ã€‘ç«èµ›å›¾ã€é‡Œäº†ã€‚</p><h3 id="XJOI1661"><a href="#XJOI1661" class="headerlink" title="$XJOI1661$"></a>$XJOI1661$</h3><h4 id="T1-6"><a href="#T1-6" class="headerlink" title="$T1$"></a>$T1$</h4><p>ç»„åˆæ„ä¹‰é¢˜ï¼Œæˆ‘è¯•è¿‡ä½†æ²¡æƒ³å‡ºæ¥ã€‚ã€‚ã€‚</p><p>è§†ä½œ æœ‰ $2$ è¡Œ $m$ åˆ—çš„æ ¼å­ï¼Œé€‰ $i$ åˆ—å¹¶ä¸”åœ¨è¿™ $2i$ ä¸ªæ ¼å­å’Œå¦å¤–æ•£çš„ $n - m$ ä¸ªæ ¼å­ä¸­é€‰å‡º $k$ ä¸ªçš„æ–¹æ¡ˆæ•°ã€‚ç”Ÿæˆå‡½æ•°ä¸º $(x + 1)^{n - m} (x^2 + 2x + 1 + 1)^m$ï¼Œå…¶ä¸­ $x^2$ è¡¨ç¤ºé€‰äº†è¿™åˆ—å¹¶é€‰äº†ä¸¤ä¸ªæ ¼å­ï¼Œ$2x$ è¡¨ç¤ºé€‰äº†è¿™åˆ—å¹¶é€‰äº†ä¸€ä¸ªæ ¼å­ï¼Œ$1 + 1$ åˆ†åˆ«è¡¨ç¤ºé€‰äº†è¿™åˆ—ä½†æ²¡é€‰æ ¼å­ å’Œ æ²¡é€‰è¿™åˆ—ã€‚æ±‚å‡ºå®ƒçš„ç¬¬ $[x^k]$ é¡¹ã€‚</p><h4 id="T2-6"><a href="#T2-6" class="headerlink" title="$T2$"></a>$T2$</h4><p>ljé¢˜é¢ï¼Œéƒ½æ˜¯æ­£æ•´æ•°ï¼é¦–å…ˆæŠŠ $n$ å¯¹ $k$ å–æ¨¡â€”â€” $n + k$ çš„ç­”æ¡ˆå°±æ˜¯ $n$ çš„ç­–ç•¥æ¯æ­¥ $+ 1$ã€‚è®¾ç¡¬å¸æ­£åé¢åˆ†åˆ«ä¸º $x$ å’Œ $y$ã€‚</p><p>è®¾ $x$ å‡ºç° $l$ æ¬¡ï¼Œåˆ™ $y$ å‡ºç° $k - l$ æ¬¡ï¼Œ$lx + (k - l)y = n$, $lx \equiv n \pmod{k - l}$ï¼Œå³è¦æ±‚ $n \equiv l(x - y) \pmod{k}$ã€‚</p><p>æˆ‘ä»¬å‘ç°è¿™å’Œ $x$, $y$ çš„å…·ä½“å¤§å°æ²¡ä»€ä¹ˆå…³ç³»ï¼Œå› æ­¤ã€Œ$x$ å’Œ $y$ çš„æœ€ä¼˜å–å€¼æ²¡æœ‰åŠæ³•æ±‚ã€å°±ä¸æ˜¯ä¸ªé—®é¢˜äº†ï¼ä»”ç»†ä¸€æƒ³ï¼Œ$x$ æˆ‘ä»¬æ˜¯åªæœ‰ä¸€ç§é€‰æ‹©ï¼Œ$y$ å–å€¼å´å¯ä»¥ä¾æ®ç¬¬å‡ æ¬¡æ‰”åˆ°åé¢è€Œå®šï¼Œç­”æ¡ˆ = æ¯ç§ã€Œç¬¬ä¸€æ¬¡æ‰”åˆ°åé¢çš„æ—¶é—´ã€çš„æ¦‚ç‡ä¹‹å’Œã€‚æšä¸¾ $x - y$ å’Œ $l$ å³å¯ã€‚</p><p>è¿™é¢˜å¥½å¦™å•Šqwqï¼Œæœ‰ç‚¹åƒã€ŒBear and Juiceã€ï¼Œä¿¡æ¯é¢˜ã€‚</p><h4 id="T3-6"><a href="#T3-6" class="headerlink" title="$T3$"></a>$T3$</h4><p>åŸé¢˜ LOJ6072ã€‚</p><p>æŠŠç‚¹åˆ†ä¸ºä¸‰ç§ï¼šã€Œé€‰ã€ã€Œä¸é€‰ã€ã€Œ$-1$ã€ï¼Œåˆ†åˆ«ç”¨ $a$ã€$b$ã€$c$ è¡¨ç¤ºã€‚$c$ å›ºå®šï¼Œ$a$ ä¸ªæ•°åœ¨ $[0, n - c]$ é—´ã€‚</p><p>è¿è¾¹æƒ…å†µï¼š$a$ - $a$, $a$ - $b$, $a$ - $c$, $b$ - $c$ã€‚</p><p>ç”Ÿæˆæ ‘è®¡æ•°å®¹æ˜“æƒ³åˆ°çŸ©é˜µæ ‘ï¼Œè€Œä¸”å®é™…å–äº†å“ªäº› $a$ ä¸­çš„ç‚¹ä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯å–äº†<strong>å‡ ä¸ª</strong> $a$ ä¸­çš„ç‚¹ã€‚meet in the middle é¢„å¤„ç†å‡ºå¤§å°ä¸º $k$ çš„è¿é€šå—ä¸ªæ•°ã€‚</p><p>$b$ åªè¦å…¨å’Œ $c$ è¿ï¼Œ$a$ å´è¦æ±‚ç›¸é‚»ç‚¹è‡³å°‘ä¸€ä¸ªä¸ä¸º $-1$ï¼Œæ‰€ä»¥ç›´æ¥åšçŸ©é˜µæ ‘æ±‚å‡ºçš„æ˜¯ã€Œè‡³å¤šã€$x$ ä¸ª $a$ çš„ç”Ÿæˆæ ‘ä¸ªæ•°ã€‚è¿™ä¸ªå˜›äºŒé¡¹å¼åæ¼”å°±ææ‰äº†ã€‚$O(n^4+n2^{n/2})$ </p><hr><p>æäº†åšå®¢ï¼Œæƒ³æ¢ theme çš„è¯æ”¹ Hexo ç›®å½•ä¸‹ _config.yml é‡Œç¬¬ 24 è¡Œä¸º : archievesï¼Œä»¥åŠç¬¬ 66 è¡Œã€‚</p><p>README è¦çœ‹å•Šï¼Œä¸ç„¶äº‹å€åŠŸåŠï¼ˆå’</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘ç«èµ›å›¾</title>
      <link href="2021/01/30/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E7%AB%9E%E8%B5%9B%E5%9B%BE/"/>
      <url>2021/01/30/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E7%AB%9E%E8%B5%9B%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<p>ç«èµ›å›¾(tournament)ï¼šæœ‰ $\binom{n}{2}$ æ¡è¾¹çš„æœ‰å‘å›¾</p><a id="more"></a><p>æ€§è´¨ï¼š</p><ol><li>ç«èµ›å›¾å¼ºè¿é€šç¼©ç‚¹åçš„ DAG æ˜¯ä¸€æ¡é“¾</li><li>ç«èµ›å›¾çš„å¼ºè¿é€šå—å­˜åœ¨ä¸€æ¡å“ˆå¯†é¡¿å›è·¯</li><li>ç«èµ›å›¾å­˜åœ¨ä¸€æ¡å“ˆå¯†é¡¿è·¯å¾„</li><li>ç«èµ›å›¾ $size &gt; 1$ çš„å¼ºè¿é€šå—ä¸­ï¼Œå¤§å°ä¸º $[3, size]$ çš„ç®€å•ç¯å‡å­˜åœ¨</li><li>å…°é“å®šç†ï¼ˆç«èµ›å›¾åˆ¤å®šå®šç†ï¼‰ï¼šå®šä¹‰ä¸€ä¸ªç«èµ›å›¾çš„æ¯”åˆ†åºåˆ—æ˜¯æŠŠç«èµ›å›¾æ¯ä¸ªç‚¹çš„å‡ºåº¦ä»å°åˆ°å¤§æ’åˆ—å¾—åˆ°çš„åºåˆ—ã€‚ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„åºåˆ— $s_1 \leq s_2 \leq s_3 \leq â€¦ \leq s_n$ æ˜¯åˆæ³•æ¯”åˆ†åºåˆ—å½“ä¸”ä»…å½“ $\forall i \in [1, n], \sum\limits_{j = 1}^i s_j \geq \binom{i}{2}$ï¼Œä¸”åœ¨ $i = n$ æ—¶å–ç­‰å·ï¼Œ<a href="https://blog.csdn.net/a_crazy_czy/article/details/73611366" target="_blank" rel="noopener">è¯æ˜</a></li></ol><h3 id="ä¸–ç•Œæ˜¯ä¸ªåŠ¨ç‰©å›­"><a href="#ä¸–ç•Œæ˜¯ä¸ªåŠ¨ç‰©å›­" class="headerlink" title="ä¸–ç•Œæ˜¯ä¸ªåŠ¨ç‰©å›­"></a><a href="https://uoj.ac/problem/451" target="_blank" rel="noopener">ä¸–ç•Œæ˜¯ä¸ªåŠ¨ç‰©å›­</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å®˜æ–¹é¢˜è§£:</span><br><span class="line"></span><br><span class="line">ç”±äºè¿™æ˜¯ç«èµ›å›¾ï¼Œä¸éš¾è¯æ˜è”ç›Ÿå³å¼ºè¿é€šåˆ†é‡ï¼Œå¹¶ä¸”ç¼©å®Œå¼ºè¿é€šåˆ†é‡ä¹‹åå¿…ç„¶æ˜¯ä¸€æ¡é“¾ï¼Œå‰å¾€åè¿æœ‰å‘è¾¹ã€‚è€ƒè™‘åŠ å…¥ç‚¹xä¹‹åä¼šå‘ç”Ÿå•¥ï¼Œå¤§æ¦‚å°±æ˜¯æ‰¾åˆ°è¿™æ¡é“¾ä¸Šç¬¬ä¸€ä¸ªæœ‰ä»xå‡ºå‘çš„è¾¹çš„ç‚¹å’Œæœ€åä¸€ä¸ªå‘xè¿è¾¹çš„ç‚¹ï¼ŒæŠŠé“¾ä¸Šè¿™ä¸€æ®µåˆ æ‰ï¼ŒæŠŠxæ’è¿›å»ä»£æ›¿è¿™ä¸€æ®µã€‚æˆ‘ä»¬åªè¦ç»´æŠ¤ä¸€ä¸ªåŠ¨æ€æ ‡å·ï¼Œç„¶åæŠŠxæ”¾åœ¨è¿™ä¸€æ®µå‰ä¸€ä¸ªå…ƒç´ é‡Œé¢é‚£ä¸€æ®µçš„åé¢å°±å¥½äº†ï¼ˆè®°ä¸€ä¸‹æ¯ä¸€æ®µçš„ç»“å°¾ï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœä½ è¿™ä¸ªç”¨æ›¿ç½ªç¾Šæˆ–è€…treapæä¸€ä¸ªdoubleå‡ºæ¥ï¼ŒåŒºé—´min maxå°±åªè¦çº¿æ®µæ ‘ç»´æŠ¤å°±å¥½äº†ã€‚å¦‚æœä½ åƒæˆ‘ä¸€æ ·è ¢æ‹¿äº†ä¸ªsplayå¼ºè¡Œcmpï¼Œé‚£ä¹ˆå¼ºè¡Œrmqå¤æ‚åº¦ä¹Ÿæ˜¯å¯¹çš„ï¼ˆä¸¤ä¸ªlogåœ¨nä¸Šï¼‰ï¼Œç„¶åä½ å°±MLEäº†ï¼ˆ</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªâ€œå‰å¾€åè¿â€ä¸å¤ªå‡†ç¡®ï¼Œç¼©å®Œæ˜¯ä¸€æ¡é“¾ï¼Œæˆ‘ä»¬è¦æ‰¾åŒºé—´ç¼–å·æœ€å°çš„æœ‰æ¥è‡ª $x$ çš„è¾¹çš„ scc $L$ï¼Œå’Œç¼–å·æœ€å¤§çš„æœ‰å» $x$ çš„è¾¹çš„ scc $R$ï¼Œ$[L, R]$ è¿™ä¸€æ®µæ‰€æœ‰ scc è¢«ç¼©ä¸ºä¸€ä¸ª sccã€‚æ›¿ç½ªç¾Šæˆ–è€… treap åŠ¨æ€ç»´æŠ¤ç¼–å·ï¼ˆå…¶å®ä¸ç”¨çœŸçš„åˆ é™¤ï¼Œæä¸€ä¸ªå¹¶æŸ¥é›†ï¼Œå°† fa æŒ‡å‘ $x$ï¼ŒæŠŠ $x$ æ’åˆ° $L$ çš„ä½ç½®å°±å¥½äº†ï¼‰ï¼Œçº¿æ®µæ ‘æŸ¥è¯¢åŒºé—´ minã€maxã€‚ç”¨ double æ˜¯ä¸ºäº†æ–¹ä¾¿åˆ›é€ é”®å€¼ã€‚</p><p><a href="https://uoj.ac/submission/452323" target="_blank" rel="noopener">$Code$</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ç«èµ›å›¾ </tag>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>UOJ Long Round 1</title>
      <link href="2021/01/05/UOJ%20Long%20Round%201/"/>
      <url>2021/01/05/UOJ%20Long%20Round%201/</url>
      
        <content type="html"><![CDATA[<p>å¥½éš¾å•Šã€‚ã€‚</p><h2 id="T1-å¤šçº¿ç¨‹è®¡ç®—"><a href="#T1-å¤šçº¿ç¨‹è®¡ç®—" class="headerlink" title="$T1. å¤šçº¿ç¨‹è®¡ç®—$"></a>$T1. å¤šçº¿ç¨‹è®¡ç®—$</h2><hr><p>é¦–å…ˆè¦çŸ¥é“ä¸€ä¸ªäº‹æƒ…ï¼š$n$ ä¸ª $[0, 1)$ æ•°ä¸­ç¬¬ $k$ å¤§æ•°æœŸæœ›ä¸º $\frac{k}{n + 1}$ã€‚æ ¹æ®æ¦‚ç‡çš„åŸºæœ¬çŸ¥è¯†ï¼Œæˆ‘ä»¬ä¸è€ƒè™‘å­˜åœ¨ç¯åŒæ—¶äº®èµ·çš„æƒ…å†µï¼Œé‚£ä¹ˆ $n * m$ ä¸ªç¯ä¾æ¬¡äº®èµ·ï¼Œæœ‰ $k$ ä¸ªç¯äº®çš„æœŸæœ›æ—¶é•¿ä¸º $\frac{1}{nm + 1}$ï¼Œæ‰€ä»¥ç°åœ¨æˆ‘ä»¬è¦ç®— $k$ ä¸ªç¯äº®ä¸”èŠ‚èƒ½çš„çŠ¶æ€ä¸ªæ•°ï¼Œæœ€åä¹˜ä¸Š $\frac{k!(nm - k)!}{(nm + 1)(nm)!}$.</p><p>æ¯ä¸ª $(x, y)$ ç‹¬ç«‹ï¼Œåˆ†åˆ«ç®—è´¡çŒ®å³å¯ã€‚ç°åœ¨è€ƒè™‘ $(x, y)$ ç»™ $k$ çš„è´¡çŒ®ï¼Œå®¹æ–¥è®¡ç®—ï¼šæšä¸¾å…¨äº®çš„è¡Œåˆ—ä¸º $i$ã€$j$ï¼Œè´¡çŒ®ä¸º $\binom{n}{i} \binom{m}{j} \binom{i}{x} \binom{j}{y} (-1)^{i - x} (-1)^{j - y} \binom{nm - im - jn + ij}{k - im - jn + ij}$ã€‚</p><p>æœ€åé‚£ä¸ªç»„åˆæ•°ä¸å…³é”®ï¼Œç»™å®ƒæ‹†èµ°ã€‚å‰©ä¸‹çš„çœ‹ä¼¼æ˜¯ä¸ªäºŒç»´ $FFT$ï¼Œå®é™…ä¸Šå®Œå…¨æ›´ç®€å•â€”â€”æŠŠ $\binom{n}{i} \binom{i}{x} (-1)^{i - x}$ è®¡åˆ°æŸä¸ªæ•°ç»„ $h_{i, y}$ é‡Œï¼ˆæšä¸¾ $y$ å¯¹ç¬¬ä¸€ç»´åšå·ç§¯ï¼‰ï¼Œå†æšä¸¾ç¬¬ä¸€ç»´å¯¹ç¬¬äºŒç»´åšå·ç§¯ï¼Œç´¯è®¡åˆ° $[im + jn - ij]$ é‡Œå³å¯ã€‚åš $n$ éé•¿åº¦ä¸º $m$ çš„å·ç§¯å’Œ $m$ éé•¿åº¦ä¸º $n$ çš„å·ç§¯ï¼Œ$O(nmlognm)$.</p><p><a href="https://uoj.ac/submission/446428" target="_blank" rel="noopener">$Code$</a></p><h2 id="T2-å…‰ä¼å…ƒä»¶"><a href="#T2-å…‰ä¼å…ƒä»¶" class="headerlink" title="$T2. å…‰ä¼å…ƒä»¶$"></a>$T2. å…‰ä¼å…ƒä»¶$</h2><hr><h2 id="T3-æœåŠ¡å™¨è°ƒåº¦"><a href="#T3-æœåŠ¡å™¨è°ƒåº¦" class="headerlink" title="$T3. æœåŠ¡å™¨è°ƒåº¦$"></a>$T3. æœåŠ¡å™¨è°ƒåº¦$</h2><hr><h2 id="T4-æ‰“å‡»å¤è¯»"><a href="#T4-æ‰“å‡»å¤è¯»" class="headerlink" title="$T4. æ‰“å‡»å¤è¯»$"></a>$T4. æ‰“å‡»å¤è¯»$</h2><hr><h2 id="T5-æ ¡éªŒç "><a href="#T5-æ ¡éªŒç " class="headerlink" title="$T5. æ ¡éªŒç $"></a>$T5. æ ¡éªŒç $</h2><hr><h2 id="T6-å«æ˜ŸåŸºç«™å»ºè®¾"><a href="#T6-å«æ˜ŸåŸºç«™å»ºè®¾" class="headerlink" title="$T6. å«æ˜ŸåŸºç«™å»ºè®¾$"></a>$T6. å«æ˜ŸåŸºç«™å»ºè®¾$</h2><hr>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[LOJ6079]-å…»çŒ«ï¼ˆçº¿æ€§è§„åˆ’è½¬è´¹ç”¨æµï¼‰</title>
      <link href="2021/01/04/%5BLOJ6079%5D-%E5%85%BB%E7%8C%AB%EF%BC%88%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92%E8%BD%AC%E8%B4%B9%E7%94%A8%E6%B5%81%EF%BC%89/"/>
      <url>2021/01/04/%5BLOJ6079%5D-%E5%85%BB%E7%8C%AB%EF%BC%88%E7%BA%BF%E6%80%A7%E8%A7%84%E5%88%92%E8%BD%AC%E8%B4%B9%E7%94%A8%E6%B5%81%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>å…ˆåšäº† <a href="https://www.luogu.com.cn/problem/P3980" target="_blank" rel="noopener">$å¿—æ„¿è€…æ‹›å‹Ÿ$</a>ï¼Œä¸€æ ·çš„å¥—è·¯â€”â€”çº¿æ€§è§„åˆ’è½¬è´¹ç”¨æµã€‚</p><p>å…ˆé’¦å®šæ‰€æœ‰æ—¶é—´åƒä¸œè¥¿ï¼Œç„¶åé€‰ä¸€äº›æ—¶åˆ»å˜æˆç¡è§‰ã€‚$x_i = 0/1$ è¡¨ç¤º $i$ æ—¶åˆ»æ˜¯å¦ç¡è§‰ï¼Œæ˜¯çš„è¯ä»£ä»·ä¸º $s_i - e_i$ã€‚</p><p>å¯ä»¥åˆ—å‡ºä¸ç­‰å¼ç»„ï¼š</p><p>$$x_1 + \cdots + x_{k} \geq ms$$</p><p>$$x_1 + \cdots + x_{k} \leq k - me$$</p><p>$$\cdots$$</p><p>$$x_{n - k + 1} + \cdots + x_n \leq k - me$$</p><p>å˜æˆæ ‡å‡†å‹ï¼ˆå°±æ˜¯ä¸ç­‰å·å˜ç­‰å·ï¼‰ï¼š</p><p>$$x_1 + \cdots + x_{k} = ms + y_1$$</p><p>$$x_1 + \cdots + x_{k} = k - me - z_1$$</p><p>$$\cdots$$</p><p>$$x_{n - k + 1} + \cdots + x_n = k - me - z_{n - k + 1}$$</p><p>çº¿æ€§è§„åˆ’è½¬è´¹ç”¨æµè¦æ±‚æ¯ä¸ªå˜é‡æ°å¥½å‡ºç°ä¸€æ¬¡ä¸ºæ­£ã€ä¸€æ¬¡ä¸ºè´Ÿï¼Œäºæ˜¯æ·»åŠ ä¸€ä¸ªç­‰å¼ $0 = 0$ å¹¶ä¸¤ä¸¤åšå·®ï¼š</p><p>$$x_1 + \cdots + x_{k} = ms + y_1$$</p><p>$$y_1 + z_1 = k - ms - me$$</p><p>$$x_{k + 1} + (k - ms - me) = x_1 + z_1 + y_2$$</p><p>$$\cdots$$</p><p>$$k - me = x_{n - k + 1} + \cdots + x_n + z_{n - k + 1}$$</p><p>è¿™ä¸€ç±»çº¿æ€§è§„åˆ’è½¬è´¹ç”¨æµçš„å»ºæ¨¡æ–¹æ³•ï¼Œæ˜¯æŠŠç­‰å¼çœ‹ä½œç‚¹ï¼Œç­‰å¼å¹³è¡¡å¯¹åº”ç½‘ç»œæµä¸­çš„æµé‡å¹³è¡¡ã€‚</p><p>é‚£ä¹ˆæ¯ä¸ªå˜é‡çœ‹ä½œæµï¼Œä¸ºæ­£åˆ™æ˜¯å…¥ï¼Œä¸ºè´Ÿåˆ™æ˜¯å‡ºã€‚ä»å‡ºçš„ç­‰å¼å‘å…¥çš„ç­‰å¼è¿ $(cap, val)$ çš„è¾¹ã€‚ä¾‹å¦‚æœ¬é¢˜ä¸­ $x_i$ è¿è¾¹ä¸º $(1, s_i - e_i)$ï¼Œè€Œ $y_i$, $z_i$ ç­‰è¾…åŠ©å˜é‡è¿è¾¹ä¸º $(\infty, 0)$ã€‚</p><p>å¯¹äºå¸¸æ•°ï¼ˆè®¾ä¸º $c$ï¼‰ä¹Ÿè¦å¤„ç†ï¼Œä¸ºæ­£åˆ™è§†ä¸ºæºç‚¹å‘å‡ºç»™ä½ çš„ï¼Œä¸ºè´Ÿåˆ™è§†ä¸ºä½ å‘å‡ºç»™æ±‡ç‚¹çš„ï¼š$(|c|, 0)$ã€‚</p><p>æ­£ç¡®æ€§æ€ä¹ˆç†è§£å‘¢qwqï¼Ÿæœ€å¤§æµè·‘å®Œäº†ï¼Œæ¯ä¸ªç‚¹çš„ç­‰å¼éƒ½è¢«æ»¡è¶³</p><p>å›åˆ°æœ¬é¢˜ï¼Œç”±äºç¬¬ä¸€ä¸ªç­‰å¼çš„å¸¸æ•° $ms$ åœ¨ç­‰å¼å³è¾¹ï¼Œæˆ‘ä»¬æŠŠå³è¾¹çœ‹ä½œå…¥ï¼Œè·‘æœ€å¤§è´¹ç”¨æµå°±å®Œäº‹äº†ã€‚</p><p><a href="https://loj.ac/s/1026388" target="_blank" rel="noopener">$Code$</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿æ€§è§„åˆ’ </tag>
            
            <tag> è´¹ç”¨æµ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘æ–¯ç‰¹æ—æ•°</title>
      <link href="2020/12/29/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%96%AF%E7%89%B9%E6%9E%97%E6%95%B0/"/>
      <url>2020/12/29/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%96%AF%E7%89%B9%E6%9E%97%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸œè¥¿çœ‹è¿‡ä¸€éå°±å¿˜è¿˜æ˜¯è¦æ‰‹æ•²ä¸€é $L_AT_EX$ æ‰å¯ä»¥å•Š</p><p>ç¬¬ä¸€ç±»æ–¯ç‰¹æ—æ•°ï¼š$n$ å…ƒç½®æ¢åˆ†ä¸º $k$ ä¸ªè½®æ¢çš„æ–¹æ¡ˆæ•°ã€‚æœ‰ï¼š$\sum\limits_{k = 0}^n {n \brack k} = n!$</p><p>ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°ï¼š$n$ ä¸ªå…ƒç´ åˆ’åˆ†ä¸º $k$ ä¸ªéç©ºé›†åˆçš„æ–¹æ¡ˆæ•°ã€‚æœ‰ï¼š$\sum\limits_{k = 0}^n {n \brace k} = B_n$ï¼Œå…¶ä¸­ $B_n$ ä¸ºè´å°”æ•°ï¼Œè¡¨ç¤º $n$ çš„åˆ’åˆ†æ–¹æ¡ˆæ•°ã€‚</p><p>é€’æ¨ï¼š</p><p>$${n \brack k} = {n - 1 \brack k - 1} + (n - 1) {n - 1 \brack k}$$</p><p>$${n \brace k} = S_2(n - 1, k - 1) + k {n = 1 \brace k}$$</p><p>å¹‚ä¹‹é—´è½¬æ¢ï¼š</p><p>$$x^{\underline{n}} = \sum\limits_{k = 0}^n (-1)^{n - k} {n \brack k} x^k \Longleftrightarrow x^n = \sum\limits_{k = 0}^n {n \brace k} x^{\underline{k}}$$</p><p>$$x^{\overline{n}} = \sum\limits_{k = 0}^n  {n \brack k} x^k \Longleftrightarrow x^n = \sum\limits_{k = 0}^n (-1)^{n - k} {n \brace k} x^{\overline{k}}$$</p><p>è®¾ $L(n, k) = \sum_j {n \brack j} {j \brace k} = \binom{n - 1}{k - 1} \frac{n!}{k!}$ï¼Œåˆ™æœ‰</p><p>$$x^{\overline{n}} = \sum\limits_{k = 0}^n L(n, k)x^{\underline{k}} \Longleftrightarrow x^{\underline{n}} = \sum\limits_{k = 0}^n (-1)^{n - k} L(n, k) x^{\overline{k}}$$</p><p>ï¼ˆè¿™æ˜¯ç”±å‰ä¸¤æ¡æ¨å‡ºçš„ï¼Œç›®å‰ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘æœ€é•¿åé“¾å’Œå®ƒå…¨å®¶ï¼ˆè¯¦ç»†æ­ç§˜ï¼‰</title>
      <link href="2020/12/27/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9C%80%E9%95%BF%E5%8F%8D%E9%93%BE%E5%92%8C%E5%AE%83%E5%85%A8%E5%AE%B6%EF%BC%88%E8%AF%A6%E7%BB%86%E6%8F%AD%E7%A7%98%EF%BC%89/"/>
      <url>2020/12/27/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9C%80%E9%95%BF%E5%8F%8D%E9%93%BE%E5%92%8C%E5%AE%83%E5%85%A8%E5%AE%B6%EF%BC%88%E8%AF%A6%E7%BB%86%E6%8F%AD%E7%A7%98%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åŒå¿—ï¼Œæ‰«ç›²äº†ï¼</span><br></pre></td></tr></table></figure><ul><li><p>é“¾ï¼šååºå…³ç³»ä¸­ï¼Œé“¾æ˜¯å½¢å¦‚ $a \leq b$ çš„è®¸å¤šå…³ç³»ï¼›$DAG$ ä¸Šï¼Œé“¾æ˜¯ä¸€ä¸ªç‚¹é›†ï¼Œå…¶ä¸­ä»»æ„ä¸¤ä¸ªç‚¹ $x$, $y$ éƒ½èƒ½ä» $x$ åˆ° $y$ æˆ–ä» $y$ åˆ° $x$ã€‚</p></li><li><p>åé“¾ï¼šåé“¾ä¹Ÿæ˜¯ç‚¹é›†ï¼Œä¸è¿‡å…¶ä¸­ä»»æ„ä¸¤ä¸ªç‚¹éƒ½ä¸èƒ½èµ°åˆ°å½¼æ­¤ã€‚</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æœ€é•¿åé“¾ = æœ€å°é“¾è¦†ç›–ï¼ˆDilworth å®šç†ï¼šæœ€é•¿åé“¾ = æœ€å°é“¾ç²¾ç¡®ï¼ˆå³ä¸å¯é‡ï¼‰è¦†ç›–ï¼Œé€šè¿‡ä¼ é€’é—­åŒ…å¯ä»¥è½¬ä¸ºæœ€å°é“¾å¯é‡è¦†ç›–ï¼Œç„¶è€Œå®ç°æ—¶éƒ½ç”¨ç½‘ç»œæµï¼‰</span><br><span class="line">æœ€é•¿é“¾ = æœ€å°åé“¾è¦†ç›–</span><br></pre></td></tr></table></figure><ul><li><p>æœ€å¤§åŒ¹é…ï¼š$DAG$ çš„æœ€å¤§åŒ¹é…æ¦‚å¿µåŒäºŒåˆ†å›¾çš„ã€‚</p></li><li><p>æœ€å°é“¾è¦†ç›–ï¼šä¹Ÿå«æœ€å°è·¯å¾„è¦†ç›–ï¼Œä½œç”¨å¦‚å…¶åï¼Œåˆ†ä¸ºå¯é‡å’Œä¸å¯é‡ã€‚</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æœ€å°é“¾è¦†ç›– = é¡¶ç‚¹æ•° - æœ€å¤§åŒ¹é…ï¼ˆåˆšå¼€å§‹æ²¡æœ‰åŒ¹é…ï¼Œæ˜¾ç„¶æˆç«‹ï¼›æ¥ä¸‹æ¥æ¯åŒ¹é…ä¸€å¯¹ç‚¹ï¼ŒåŒ¹é…æ•° +1ï¼Œè·¯å¾„æ•° -1ã€‚åŒ¹é…æ•° = æ¯æ¡è·¯å¾„ç‚¹æ•°è¾¹æ•°å’Œã€‚ï¼‰</span><br></pre></td></tr></table></figure><ul><li><p>æœ€å°ä¸å¯é‡é“¾è¦†ç›–ï¼šæ‹†ç‚¹ï¼Œç”¨åŒˆç‰™åˆ©ç®—æ³•æˆ–è€…ç½‘ç»œæµæ±‚è§£ï¼Œè¿ $(x_{out}, y_{in})$</p></li><li><p>æœ€å°å¯é‡é“¾è¦†ç›–ï¼šå…ˆä¼ é€’é—­åŒ…ï¼Œå†åœ¨å½¢æˆçš„ååºé›†ä¸Šåšæœ€å°ä¸å¯é‡é“¾è¦†ç›–ï¼Œè·³è¿‡çš„ç‚¹è¢«å½“ä½œé‡å¤ç»è¿‡ï¼Œç„¶è€Œå®ç°æ—¶ä¸€èˆ¬ç”¨ç½‘ç»œæµå»º $(xâ€™, x, \infty)$ è¿™æ ·çš„åè¾¹è¡¨ç¤ºæŸäº›ç‚¹è¢«å½“ä½œä¸­é—´ç‚¹åšäº†ä¼ é€’é—­åŒ…ã€‚</p></li><li><p>æœ€å¤§ç‹¬ç«‹é›†ï¼šé€‰å‡ºæœ€å¤šçš„ç‚¹ï¼Œå…¶ä¸­ä¸¤ä¸¤æ— è¾¹ç›¸è¿ã€‚</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">äºŒåˆ†å›¾ æœ€å¤§å›¢ = è¡¥å›¾æœ€å¤§ç‹¬ç«‹é›†</span><br></pre></td></tr></table></figure><ul><li><p>æœ€å°ç‚¹è¦†ç›–ï¼šé€‰æ‹©æœ€å°‘çš„ç‚¹è¦†ç›–æ‰€æœ‰è¾¹ã€‚</p></li><li><p>æœ€å°è¾¹è¦†ç›–ï¼šé€‰æ‹©æœ€å°‘çš„è¾¹è¦†ç›–æ‰€æœ‰ç‚¹ã€‚</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">äºŒåˆ†å›¾ æœ€å¤§åŒ¹é… = æœ€å°ç‚¹è¦†ç›–</span><br><span class="line">    æ¯æ¡è¾¹ä¸€å®šè¿ç€ä¸€ä¸ªåŒ¹é…ç‚¹ï¼Œå¦åˆ™è¿ä¸¤ä¸ªæœªåŒ¹é…ç‚¹åŒ¹é…æ•°åº”è¯¥ +1ã€‚</span><br><span class="line">äºŒåˆ†å›¾ æœ€å¤§ç‹¬ç«‹é›† = é¡¶ç‚¹æ•° - æœ€å°ç‚¹è¦†ç›–</span><br><span class="line">    æŠŠæœ€å°ç‚¹è¦†ç›–å‰”é™¤ï¼Œå‰©ä¸‹çš„ç‚¹å°±æ²¡æœ‰è¾¹ç›¸è¿äº†ã€‚</span><br><span class="line">äºŒåˆ†å›¾ æœ€å°è¾¹è¦†ç›– = é¡¶ç‚¹æ•° - æœ€å¤§åŒ¹é…</span><br><span class="line">    æ˜¾ç„¶ã€‚åŒæ—¶ä¹Ÿå‘Šè¯‰æˆ‘ä»¬æœ€å°è¾¹è¦†ç›–å°±æ˜¯åœ¨æœ€å¤§åŒ¹é…çš„åŸºç¡€ä¸ŠåŠ è¾¹ï¼Œå˜æˆå®Œç¾åŒ¹é…ã€‚</span><br><span class="line">äºŒåˆ†å›¾ æœ€å°å‰² = æœ€å°ç‚¹æƒè¦†ç›–é›† = ç‚¹æƒå’Œ - æœ€å¤§ç‚¹æƒç‹¬ç«‹é›†</span><br></pre></td></tr></table></figure><p>æ„Ÿè§‰ç±»ä¼¼é¢˜ç›®ï¼ˆä¸ sb çš„é‚£ç§ï¼‰éƒ½æ˜¯ç”¨ğŸ‘†ä¸Šé¢è¿™å¥—ç†è®ºææ¥æå»ï¼Œæ¯”å¦‚ <a href="https://www.luogu.com.cn/problem/P4298" target="_blank" rel="noopener">$CTSC2008-ç¥­ç¥€$</a>ï¼šéš¾ç‚¹åœ¨æ„é€ æ–¹æ¡ˆã€‚</p><p>ç¬¬äºŒé—®å¥½æƒ³ï¼Œæ¯ä¸ªç‚¹åˆ é™¤ååšä¸€éæœ€é•¿åé“¾çœ‹æ˜¯å¦åªå‡å°äº† $1$ã€‚</p><p>ç¬¬ä¸€é—®ï¼Œå…ˆè¯´ç»“è®ºï¼šé€‰å‡ºæ–°å›¾æ‰€æœ‰ $x_{out}$ å’Œ $x_{in}$ éƒ½åœ¨æœ€å¤§ç‹¬ç«‹é›†é‡Œçš„ç‚¹ï¼Œå°±æ˜¯åŸå›¾æœ€é•¿åé“¾ã€‚</p><p>è¯æ˜ï¼š<br>æœ‰æœ€å¤§ç‹¬ç«‹é›†åˆ $I$ = é¡¶ç‚¹æ•° $2n$ - æœ€å¤§åŒ¹é… $m$ï¼Œè®¾æœ€é•¿åé“¾é›†åˆä¸º $A$ï¼Œ$I - A$ ä¸ºã€Œ$x_{out}$ æˆ– $x_{in}$ åœ¨æœ€å¤§ç‹¬ç«‹é›†é‡Œã€çš„ç‚¹é›†ï¼Œ$|I| - |A| \leq n$, $|A| \geq |I| - n = n - m$, è€Œ $|A| \leq n - m$ï¼Œæ‰€ä»¥ $|A| = n - m =$ åŸå›¾æœ€é•¿åé“¾ã€‚</p><p>æ‰€ä»¥åŒˆç‰™åˆ©æˆ–è€… $dinic$ æ‰¾æœ€å¤§åŒ¹é…ï¼Œå† dfs æ‰¾æœ€å°ç‚¹è¦†ç›–ï¼Œæœ€å¤§ç‹¬ç«‹é›† = æœ€å°ç‚¹è¦†ç›–è¡¥é›†ã€‚æ³¨æ„è¿™é¢˜å¯é‡ã€‚</p><p><em>å½©è›‹ï¼š$dinic$ åœ¨äºŒåˆ†å›¾ä¸Šæ˜¯ $O(n\sqrt{n})$ çš„å“¦</em></p><p>upd: $96$ åˆ†æˆ‘å¤ªç–‘æƒ‘äº†ï¼Ÿ</p>]]></content>
      
      
      
        <tags>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘LCT</title>
      <link href="2020/12/27/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91LCT/"/>
      <url>2020/12/27/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91LCT/</url>
      
        <content type="html"><![CDATA[<p>ä¹‹å‰å­¦çš„ã€‚ä»¥ å¤‡ é‡ ä¿® qwq</p><h2 id="ç®—æ³•è¯¦æƒ…"><a href="#ç®—æ³•è¯¦æƒ…" class="headerlink" title="ç®—æ³•è¯¦æƒ…"></a>ç®—æ³•è¯¦æƒ…</h2><p>æŠŠæ ‘å‰–æˆè®¸å¤šé“¾ï¼Œæ¯æ¡é“¾ç”¨ splay ç»´æŠ¤ï¼Œä¸­åºéå†æ·±åº¦é€’å¢ã€‚</p><h3 id="access"><a href="#access" class="headerlink" title="access"></a>access</h3><ul><li><p>æ‰“é€š $x$ åˆ°æ ¹çš„é€šè·¯ã€‚è¿‡ç¨‹æ˜¯å…ˆæŠŠ $x$ è½¬åˆ° $x$ æ‰€åœ¨ splay çš„æ ¹ï¼Œç„¶åè®© $x$ å¸¦ç€ $x$ çš„å·¦å­æ ‘å¹¶åˆ° $fa_x$ æ‰€åœ¨ splay ä¸­å……ä½œ $fa[x]$ å³å„¿å­</p></li><li><p>è¿™ä¸ªè¿‡ç¨‹ $x$ å’Œ $fa[x]$ éƒ½å’Œå®ƒä»¬åŸæœ¬çš„å³å„¿å­æ–­å¼€äº†ï¼Œä½†å³å„¿å­ä¾ç„¶ä¿ç•™â€œçˆ¶äº²æ˜¯è°â€çš„ä¿¡æ¯ï¼‰</p></li></ul><h3 id="makeroot"><a href="#makeroot" class="headerlink" title="makeroot"></a>makeroot</h3><ul><li>å…ˆ accessï¼Œæ­¤æ—¶ $x$ æˆäº†å’Œæ ¹åœ¨åŒä¸€ splay ä¸­æ·±åº¦æœ€å¤§ã€ä¸­åºéå†æœ€æœ«çš„ç‚¹</li><li>å† splayï¼Œæ­¤æ—¶ $x$ æˆäº†æ‰€åœ¨ splay çš„æ ¹ï¼Œä½†ä»æ˜¯æ·±åº¦æœ€å¤§ã€‚ä¸ºäº†è®© $x$ æˆä¸ºæ ¹ã€å˜å¾—æ·±åº¦æœ€å°ï¼Œæˆ‘ä»¬ç¿»è½¬ $x$ çš„å·¦å³å­æ ‘ã€‚<strong>æ³¨æ„ï¼šæ­¤æ“ä½œä¸å½±å“å…¶ä»– splay çš„æ·±åº¦é¡ºåºã€‚</strong></li></ul><h3 id="findroot"><a href="#findroot" class="headerlink" title="findroot"></a>findroot</h3><ul><li>ä¸æ–­è·³å·¦å„¿å­</li><li><em>ççˆ±ç”Ÿå‘½ï¼Œè¿œç¦» findrootã€‚ã€‚ã€‚</em> cut() é‡Œåˆ¤èƒ½å¦ cut çš„éƒ¨åˆ†è¿˜æ˜¯è¿™æ ·å§ï¼š<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (ch[y][<span class="number">0</span>] == x &amp;&amp; !ch[x][<span class="number">1</span>]) &#123;</span><br><span class="line">    cut;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="LCT-å¥½åƒæ²¡æ³•åŒæ—¶ä¿è¯ä¸¤ä¸ªèŠ‚ç‚¹çš„å­æ ‘ä¿¡æ¯éƒ½æ˜¯å¯¹çš„ã€‚ã€‚æ— å¥ˆã€‚ã€‚"><a href="#LCT-å¥½åƒæ²¡æ³•åŒæ—¶ä¿è¯ä¸¤ä¸ªèŠ‚ç‚¹çš„å­æ ‘ä¿¡æ¯éƒ½æ˜¯å¯¹çš„ã€‚ã€‚æ— å¥ˆã€‚ã€‚" class="headerlink" title="LCT å¥½åƒæ²¡æ³•åŒæ—¶ä¿è¯ä¸¤ä¸ªèŠ‚ç‚¹çš„å­æ ‘ä¿¡æ¯éƒ½æ˜¯å¯¹çš„ã€‚ã€‚æ— å¥ˆã€‚ã€‚"></a><em>LCT å¥½åƒæ²¡æ³•åŒæ—¶ä¿è¯ä¸¤ä¸ªèŠ‚ç‚¹çš„å­æ ‘ä¿¡æ¯éƒ½æ˜¯å¯¹çš„ã€‚ã€‚æ— å¥ˆã€‚ã€‚</em></h3><p>ï¼ˆæ¨¡æ‹Ÿèµ›å¤§çˆ†ç‚¸</p><h2 id="å…³äº-LCT-çš„æ—¶é—´å¤æ‚åº¦åˆ†æ"><a href="#å…³äº-LCT-çš„æ—¶é—´å¤æ‚åº¦åˆ†æ" class="headerlink" title="å…³äº LCT çš„æ—¶é—´å¤æ‚åº¦åˆ†æ"></a>å…³äº LCT çš„æ—¶é—´å¤æ‚åº¦åˆ†æ</h2><p><a href="https://www.cnblogs.com/zhouzhendong/p/JunTanFenXi.html" target="_blank" rel="noopener">æŒ‡è·¯å‘¨æŒ‡å¯¼åšå®¢ <del>å¯¹æ²¡é”™æˆ‘å°±æ˜¯è´ºäº†ä¸€é</del></a></p><h3 id="access-1"><a href="#access-1" class="headerlink" title="access"></a>access</h3><p>è€ƒè™‘è™šå®é“¾åˆ‡æ¢å¤æ‚åº¦ã€‚</p><p>å®šä¹‰é‡å„¿å­ä¸º $size_x * 2 \geq size_{fa_x}$ çš„ç‚¹ï¼Œå…¶ä½™ä¸ºè½»å„¿å­ã€‚å®šä¹‰åŠ¿èƒ½å‡½æ•° $\phi$ ä¸ºåˆé‡åˆè™šçš„èŠ‚ç‚¹æ•°ã€‚è€ƒè™‘ä¸€æ¬¡ splay æ“ä½œï¼Œå½“å‰ splay æ ¹èŠ‚ç‚¹ $x$ çš„æƒ…å†µï¼š</p><ul><li>è‹¥å®ƒæ˜¯è½»å„¿å­ï¼Œåˆ™æ¶ˆè€— $1$ æ—¶é—´ï¼Œ$\Delta \phi \leq 1$</li><li>è‹¥å®ƒæ˜¯é‡å„¿å­ï¼Œåˆ™æ¶ˆè€— $1$ æ—¶é—´ï¼Œ$\Delta \phi = 1$</li></ul><p>ä¸€æ¬¡ access $x$ çš„æ“ä½œåœ¨è¿‡ç¨‹ä¸­åªä¼šé‡åˆ° $logn$ ä¸ªè½»å„¿å­ï¼Œå› æ­¤ä¸€æ¬¡ access æ“ä½œçš„å‡æ‘Šå¤æ‚åº¦ä¸º $O(logn)$ã€‚</p><h3 id="makerootã€link-cut"><a href="#makerootã€link-cut" class="headerlink" title="makerootã€link/cut"></a>makerootã€link/cut</h3><p>è€ƒè™‘è¿‡ç¨‹ä¸­çš„è½»é‡è¾¹å˜åŒ–é‡ã€‚</p><p>ã€ŒæŠŠæ ¹ä» $x$ æ¢æˆ $y$ ã€ã€Œåˆ‡é™¤ $x$ çš„å­æ ‘ $y$ã€ã€Œè¿æ¥ä»¥ $x$ ä¸ºæ ¹å’Œä»¥ $y$ ä¸ºæ ¹çš„è¿é€šå—ã€çš„æ—¶å€™æ”¹å˜çš„è½»é‡è¾¹åªä¼šæ˜¯ $x$ åˆ° $y$ è·¯å¾„ä¸Šçš„ï¼Œè€Œå‰å $x$ åˆ° $y$ è·¯å¾„ä¸Šéƒ½åªæœ‰ $logn$ æ¡è½»è¾¹ã€‚$O(logn)$</p>]]></content>
      
      
      
        <tags>
            
            <tag> LCT </tag>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘æœ€å¤§æƒé—­åˆå­å›¾</title>
      <link href="2020/12/26/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9C%80%E5%A4%A7%E6%9D%83%E9%97%AD%E5%90%88%E5%AD%90%E5%9B%BE/"/>
      <url>2020/12/26/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%9C%80%E5%A4%A7%E6%9D%83%E9%97%AD%E5%90%88%E5%AD%90%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<h2 id="æœ€å¤§æƒé—­åˆå­å›¾"><a href="#æœ€å¤§æƒé—­åˆå­å›¾" class="headerlink" title="æœ€å¤§æƒé—­åˆå­å›¾"></a>æœ€å¤§æƒé—­åˆå­å›¾</h2><hr><p>çœ‹åˆ°ä¸€ç¯‡å¾ˆå¥½çš„åšå®¢ï¼Œç»ˆäºä¼šäº†è¿™ç©æ„å„¿ï¼qwq å’±ä¸æ¥è™šçš„å“ˆï¼Œç›´æ¥ä¸Šæ­£é¢˜</p><ul><li><p>ä»€ä¹ˆæ˜¯æœ€å¤§æƒé—­åˆå­å›¾ï¼š</p><p>  æ¯ä¸ªç‚¹æœ‰ç‚¹æƒï¼Œç‚¹æƒå’Œæœ€å¤§çš„é—­åˆå­å›¾å³ä¸ºæœ€å¤§æƒé—­åˆå­å›¾</p></li><li><p>å¦‚ä½•æ±‚è§£</p><p>  å…ˆè¯´ç»“è®ºï¼š$S$ å‘æ­£æƒç‚¹è¿ï¼Œè¾¹æƒä¸ºæƒå€¼ï¼Œ$T$ å‘è´Ÿæƒç‚¹è¿ï¼Œè¾¹æƒä¸ºæƒå€¼ç»å¯¹å€¼ã€‚<strong>æœ€å¤§æƒé—­åˆå­å›¾æƒå€¼å³ä¸ºæ­£æƒå’Œ - æœ€å¤§æµã€‚</strong></p><p>  è¯æ˜ï¼ˆåŠæ„Ÿæ€§ï¼‰ï¼š**$S -&gt; T$ çš„æµé‡å°±æ˜¯æŸå¤±ã€‚** å°½é‡é€‰æ­£æƒç‚¹ä¸ºèµ·ç‚¹ï¼Œæ‰€ä»¥ $S$ å‘æ­£æƒç‚¹è¿ã€‚ä¸€ä¸ªæ­£æƒç‚¹é€‰ä¼šå¯¼è‡´åç»­é€‰ä¸€äº›è´Ÿæƒç‚¹ï¼Œä½†æˆ‘ä»¬ä¸çŸ¥é“é€‰å½“å‰æ­£æƒç‚¹æ˜¯å¦ä¼˜ï¼Œå°±å…ˆé€‰ä¸Šï¼Œé¡¶å¤šåé¢è¢«è´Ÿæƒç‚¹æŸå¤±æ‰ä¸º $0$ï¼Œä¸ä¼šäºã€‚</p></li></ul><p>ä¹ é¢˜ï¼š</p><h3 id="Salty-Fish"><a href="#Salty-Fish" class="headerlink" title="$Salty\ Fish$"></a><a href="https://vjudge.net/problem/HDU-6634" target="_blank" rel="noopener">$Salty\ Fish$</a></h3><p>æ˜¾ç„¶çš„æœ€å¤§æƒé—­åˆå­å›¾æ¨¡å‹ã€‚æœ¬è´¨å´æ˜¯è´ªå¿ƒâ€”â€”ä¸€ä¸ªæ‘„åƒå¤´å°½å¯èƒ½çš„æ¸…ç†æ‰å­æ ‘é‡Œå‰©ä¸‹çš„è‹¹æœä¸­ï¼Œæ·±åº¦å¤§çš„ã€‚</p><p>ä¸æ·±åº¦æœ‰å…³å°±é•¿é“¾å‰–åˆ†ï¼Œå¼€ä¸€ä¸ª $map$ï¼Œ$mp[x, d]$ ç»´æŠ¤ $x$ å­æ ‘ä¸­æ·±åº¦ä¸º $d$ çš„è‹¹æœä¸ªæ•°ã€‚æ¯ä¸ªè‹¹æœåªåœ¨æ‰€åœ¨é•¿é“¾çš„æ ¹å¤„è¢«åˆå¹¶ä¸€æ¬¡ï¼Œ$O((n + m)logn)$</p><p>ç„¶è€Œè¿™é¢˜è¦ç›´æ¥ç»§æ‰¿é‡å„¿å­çš„ $map$ï¼Œä¸ç„¶å°± $MLE$ã€‚ã€‚ä»¥åå†™ä»£ç ä¹Ÿæ³¨æ„ä¸€ç‚¹ã€‚</p><p><a href="http://acm.hdu.edu.cn/viewcode.php?rid=34972168" target="_blank" rel="noopener">$Code$</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> ç½‘ç»œæµ </tag>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[THUWC2017]-å¤§è‘±çš„ç¥åŠ›</title>
      <link href="2020/12/22/%5BTHUWC2017%5D-%E5%A4%A7%E8%91%B1%E7%9A%84%E7%A5%9E%E5%8A%9B/"/>
      <url>2020/12/22/%5BTHUWC2017%5D-%E5%A4%A7%E8%91%B1%E7%9A%84%E7%A5%9E%E5%8A%9B/</url>
      
        <content type="html"><![CDATA[<p>ç©ç©æç­”ï¼qwqã€‚çœ‹åˆ°ä¸€å¥è¯ï¼šæç­”çš„æœ¬è´¨æ˜¯æ¨¡æ‹Ÿé€€ç«å’Œæ‰¾è§„å¾‹ã€‚å“¦è¿™æ ·å—ï¼é‚£æˆ‘å»å­¦æ¨¡æ‹Ÿé€€ç«ï¼ˆ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">æ¨¡æ‹Ÿé€€ç«ç®—æ³•æµç¨‹ï¼ˆè´ºï¼‰ï¼š</span><br><span class="line">éšæœºå˜åŒ–åæ ‡ï¼Œå¹…åº¦ä¸º T</span><br><span class="line">è®¡ç®—æ–°è§£ä¸å½“å‰è§£çš„å·® deltaã€‚</span><br><span class="line">ä»¥æœ€å¤§åŒ–ç­”æ¡ˆä¸ºä¾‹ï¼Œè‹¥ delta &gt; 0 åˆ™ç”¨æ–°è§£æ›¿æ¢å½“å‰è§£ï¼›å¦åˆ™ä»¥ exp(-delta / T) çš„æ¦‚ç‡ç”¨æ–°è§£æ›¿æ¢å½“å‰è§£ã€‚</span><br><span class="line">æ¸©åº¦ä¹˜ä¸Šä¸€ä¸ªå°äº 1 çš„ç³»æ•°ï¼Œå³é™æ¸©ã€‚</span><br><span class="line">éšç€æ¸©åº¦ä¸æ–­é™ä½ï¼Œå˜åŒ–å¹…åº¦ä¹Ÿä¸æ–­å‡å°ï¼Œæ¥å—ä¸€ä¸ªæ›´åŠ£è§£çš„æ¦‚ç‡ä¹Ÿè¶Šæ¥è¶Šå°ã€‚</span><br></pre></td></tr></table></figure><p>è°ƒå‚çœ‹è„¸ã€‚æœ‰äººè¯´å¯ä»¥è§‚å¯Ÿç­”æ¡ˆçš„å˜åŒ–ç‡ä»€ä¹ˆçš„ï¼Œæ€»ä¹‹æ˜¯ä¸ªå®Œå…¨ç„å­¦çš„ä¸œè¥¿ã€‚</p><p>å¥½ï¼Œä¸Šæ­£æ–‡ï¼ï¼ˆå…¶å®æ˜¯æƒ³å­˜ä»£ç ï¼Œå¥½æœ‰æˆå°±æ„Ÿçš„è¯´ qwq</p><p>æ¯ä¸ª case éƒ½æœ‰ç‰¹æ€§ï¼Œéœ€è¦è§‚å¯Ÿæ‰¾è§„å¾‹ã€‚</p><h3 id="Case-1-amp-2"><a href="#Case-1-amp-2" class="headerlink" title="Case 1 &amp; 2"></a>Case 1 &amp; 2</h3><p>æš´æœ + ï¼ˆæˆ‘çš„åƒåœ¾ï¼‰å‰ªæ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">30</span>], b[<span class="number">30</span>], mp[<span class="number">30</span>][<span class="number">30</span>], sum, to[<span class="number">30</span>], ans, pos[<span class="number">30</span>];</span><br><span class="line"><span class="keyword">int</span> used[<span class="number">30</span>], mx[<span class="number">30</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (sum + mx[x] &lt; ans) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x == n + <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (sum &gt; ans) &#123;</span><br><span class="line">            rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">                pos[i] = to[i];</span><br><span class="line">            &#125; ans = sum;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(x + <span class="number">1</span>);</span><br><span class="line">    rep(y, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="keyword">if</span> (used[y] + a[x] &lt;= b[y]) &#123;</span><br><span class="line">            sum += mp[x][y];</span><br><span class="line">            to[x] = y;</span><br><span class="line">            used[y] += a[x];</span><br><span class="line">            dfs(x + <span class="number">1</span>);</span><br><span class="line">            sum -= mp[x][y];</span><br><span class="line">            used[y] -= a[x];</span><br><span class="line">            to[x] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// freopen("drawer2.in", "r", stdin);</span></span><br><span class="line">    <span class="comment">// freopen("drawer2.out", "w", stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; b[i];</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">1</span>, m) &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; mp[i][j];</span><br><span class="line">            mx[i] = max(mx[i], mp[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i; --i) mx[i] += mx[i + <span class="number">1</span>];</span><br><span class="line">    dfs(<span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, pos[i]); <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Case-3"><a href="#Case-3" class="headerlink" title="Case 3"></a>Case 3</h3><p>æŠ½å±‰å”¯ä¸€ï¼Œè·‘èƒŒåŒ…ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">10005</span>, M = <span class="number">2e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, a[M], w[M], f[M][N], lst[M][N], ans[M];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (y ^ lst[x][y]) ans[x] = <span class="number">1</span>;</span><br><span class="line">    work(x - <span class="number">1</span>, lst[x][y]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> tmp; <span class="built_in">cin</span> &gt;&gt; tmp;</span><br><span class="line">    <span class="built_in">memset</span>(f, ~<span class="number">0x3f</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;w[i]);</span><br><span class="line">        rep(j, <span class="number">0</span>, <span class="number">10000</span>) &#123;</span><br><span class="line">            f[i][j] = f[i - <span class="number">1</span>][j], lst[i][j] = j;</span><br><span class="line">            <span class="keyword">if</span> (j &gt;= a[i]) &#123;</span><br><span class="line">                <span class="keyword">if</span> (f[i][j] &lt; f[i - <span class="number">1</span>][j - a[i]] + w[i]) &#123;</span><br><span class="line">                    f[i][j] = f[i - <span class="number">1</span>][j - a[i]] + w[i];</span><br><span class="line">                    lst[i][j] = j - a[i];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> id = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">0</span>, <span class="number">10000</span>) <span class="keyword">if</span> (f[n][i] &gt; f[n][id]) &#123;</span><br><span class="line">        id = i;</span><br><span class="line">    &#125;</span><br><span class="line">    work(n, id);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans[i]); <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Case-4-amp-5-amp-6"><a href="#Case-4-amp-5-amp-6" class="headerlink" title="Case 4 &amp; 5 &amp; 6"></a>Case 4 &amp; 5 &amp; 6</h3><p>å¤§è‘±ä½“ç§¯å”¯ä¸€ä¸”æŠ½å±‰ä½“ç§¯æ˜¯å¤§è‘±ä½“ç§¯å€æ•°â€”â€”è£¸çš„è´¹ç”¨æµã€‚</p><p>å€¼å¾—ä¸€æçš„æ˜¯æœ‰ä¸ª Case å¤§è‘±ä½“ç§¯éƒ½åœ¨ <del>19260817</del>19900000 å·¦å³ï¼Œå¯è§†ä¸ºå¾®å°çš„æ‰°åŠ¨ï¼Œä¸ä¼šå½±å“æœ€ç»ˆç­”æ¡ˆï¼Œå–æœ€å¤§å€¼ä½œä¸ºä½“ç§¯å°±å¥½ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e3</span> + <span class="number">5</span>, M = <span class="number">205</span>, E = N * M * <span class="number">2</span> + N + M, inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> S, T, n, m;</span><br><span class="line"><span class="keyword">int</span> a[N], b[M], mp[N][N], ans[N];</span><br><span class="line"><span class="keyword">int</span> fr[E], to[E], nxt[E], lnk[N * <span class="number">2</span>], val[E], cap[E], cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> dis[N * <span class="number">2</span>], pre[N * <span class="number">2</span>], inq[N * <span class="number">2</span>], rest[N * <span class="number">2</span>];</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> c, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">    fr[++cnt] = x, to[cnt] = y, nxt[cnt] = lnk[x], lnk[x] = cnt, val[cnt] = w, cap[cnt] = c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> S, <span class="keyword">int</span> T, <span class="keyword">int</span> &amp;flow, <span class="keyword">int</span> &amp;cost)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(dis));</span><br><span class="line">    <span class="built_in">memset</span>(pre, <span class="number">0</span>, <span class="keyword">sizeof</span>(pre));</span><br><span class="line">    <span class="built_in">memset</span>(rest, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(rest));</span><br><span class="line">    <span class="built_in">memset</span>(inq, <span class="number">0</span>, <span class="keyword">sizeof</span>(inq));</span><br><span class="line">    dis[S] = <span class="number">0</span>, inq[S] = <span class="number">1</span>, rest[S] = inf, pre[S] = <span class="number">0</span>;</span><br><span class="line">    q.push(S);</span><br><span class="line">    <span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front(); q.pop(); inq[x] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = to[i];</span><br><span class="line">            <span class="keyword">if</span> (cap[i] &amp;&amp; dis[y] &gt; dis[x] + val[i]) &#123;</span><br><span class="line">                dis[y] = dis[x] + val[i];</span><br><span class="line">                pre[y] = i;</span><br><span class="line">                rest[y] = min(rest[x], cap[i]);</span><br><span class="line">                <span class="keyword">if</span> (!inq[y])</span><br><span class="line">                    inq[y] = <span class="number">1</span>, q.push(y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (dis[T] &gt; <span class="number">1e9</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    flow += rest[T];</span><br><span class="line">    cost += rest[T] * dis[T];</span><br><span class="line">    <span class="keyword">int</span> u = T;</span><br><span class="line">    <span class="keyword">while</span> (u != S) &#123;</span><br><span class="line">        cap[pre[u]] -= rest[T];</span><br><span class="line">        cap[pre[u] ^ <span class="number">1</span>] += rest[T];</span><br><span class="line">        u = fr[pre[u]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Mcmf</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> flow = <span class="number">0</span>, cost = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (spfa(S, T, flow, cost));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    S = <span class="number">0</span>, T = n + m + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> v = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">        v = max(v, a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        add(S, i, <span class="number">1</span>, <span class="number">0</span>), add(i, S, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;b[i]);</span><br><span class="line">        add(i + n, T, b[i] / v, <span class="number">0</span>), add(T, i + n, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">1</span>, m) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;mp[i][j]);</span><br><span class="line">            add(i, j + n, <span class="number">1</span>, -mp[i][j]), add(j + n, i, <span class="number">0</span>, mp[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Mcmf();</span><br><span class="line">    rep(x, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = to[i];</span><br><span class="line">            <span class="keyword">if</span> (!y) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (!cap[i]) &#123;</span><br><span class="line">                ans[x] = y - n; <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans[x]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Case-7"><a href="#Case-7" class="headerlink" title="Case 7"></a>Case 7</h3><p>åªæœ‰ç¬¬ä¸€ä¸ªå¤§è‘±ä½“ç§¯ä¸åŒï¼Œæšä¸¾å®ƒæ”¾åœ¨å“ªï¼Œè·‘å¤šæ¬¡è´¹ç”¨æµã€‚è·‘äº†ä¸€åˆ†å¤šé’Ÿï¼Œåæ­£æ˜¯æç­” ~</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">505</span>, M = <span class="number">205</span>, E = N * M * <span class="number">2</span> + N + M, inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> S, T, n, m, Cost, V;</span><br><span class="line"><span class="keyword">int</span> a[N], b[M], mp[N][N], ans[N];</span><br><span class="line"><span class="keyword">int</span> fr[E], to[E], nxt[E], lnk[N * <span class="number">2</span>], val[E], cap[E], cnt = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> dis[N * <span class="number">2</span>], pre[N * <span class="number">2</span>], inq[N * <span class="number">2</span>], rest[N * <span class="number">2</span>];</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> c, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">    fr[++cnt] = x, to[cnt] = y, nxt[cnt] = lnk[x], lnk[x] = cnt, val[cnt] = w, cap[cnt] = c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> S, <span class="keyword">int</span> T, <span class="keyword">int</span> &amp;flow, <span class="keyword">int</span> &amp;cost)</span> </span>&#123;</span><br><span class="line">    rep(i, S, T) &#123;</span><br><span class="line">        dis[i] = inf;</span><br><span class="line">        pre[i] = <span class="number">0</span>;</span><br><span class="line">        inq[i] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dis[S] = <span class="number">0</span>, inq[S] = <span class="number">1</span>, rest[S] = inf, pre[S] = <span class="number">0</span>;</span><br><span class="line">    q.push(S);</span><br><span class="line">    <span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front(); q.pop(); inq[x] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = to[i];</span><br><span class="line">            <span class="keyword">if</span> (cap[i] &amp;&amp; dis[y] &gt; dis[x] + val[i]) &#123;</span><br><span class="line">                dis[y] = dis[x] + val[i];</span><br><span class="line">                pre[y] = i;</span><br><span class="line">                rest[y] = min(rest[x], cap[i]);</span><br><span class="line">                <span class="keyword">if</span> (!inq[y])</span><br><span class="line">                    inq[y] = <span class="number">1</span>, q.push(y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (dis[T] &gt; <span class="number">1e9</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    flow += rest[T];</span><br><span class="line">    cost += rest[T] * dis[T];</span><br><span class="line">    <span class="keyword">int</span> u = T;</span><br><span class="line">    <span class="keyword">while</span> (u != S) &#123;</span><br><span class="line">        cap[pre[u]] -= rest[T];</span><br><span class="line">        cap[pre[u] ^ <span class="number">1</span>] += rest[T];</span><br><span class="line">        u = fr[pre[u]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Mcmf</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> flow = <span class="number">0</span>, cost = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (spfa(S, T, flow, cost));</span><br><span class="line">    <span class="keyword">return</span> cost;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    S = <span class="number">0</span>, T = n + m + <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    V = a[<span class="number">2</span>];</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;b[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">1</span>, m) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;mp[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    b[<span class="number">48</span>] -= a[<span class="number">1</span>];</span><br><span class="line">    rep(i, <span class="number">2</span>, n) &#123;</span><br><span class="line">        add(S, i, <span class="number">1</span>, <span class="number">0</span>), add(i, S, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        add(i + n, T, b[i] / V, <span class="number">0</span>), add(T, i + n, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">2</span>, n) &#123;</span><br><span class="line">        rep(j ,<span class="number">1</span>, m) &#123;</span><br><span class="line">            add(i, j + n, <span class="number">1</span>, -mp[i][j]), add(j + n, i, <span class="number">0</span>, mp[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> cost = Mcmf() - mp[<span class="number">1</span>][<span class="number">48</span>];</span><br><span class="line">    ans[<span class="number">1</span>] = <span class="number">48</span>;</span><br><span class="line">    rep(x, <span class="number">2</span>, n) &#123;</span><br><span class="line">        ans[x] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = to[i];</span><br><span class="line">            <span class="keyword">if</span> (!y) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (!cap[i]) &#123;</span><br><span class="line">                ans[x] = y - n; <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(x, <span class="number">1</span>, n) <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans[x]);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Case-8-amp-9-amp-10"><a href="#Case-8-amp-9-amp-10" class="headerlink" title="Case 8 &amp; 9 &amp; 10"></a>Case 8 &amp; 9 &amp; 10</h3><p>æ²¡æœ‰ä»»ä½•è§„å¾‹ã€‚äºæ˜¯å°±ä¸Šæ¨¡æ‹Ÿé€€ç«ï¼ˆå­¦ä»¥è‡´ç”¨</p><p>æˆ‘æ˜¯ rand æ’åˆ—ï¼Œéšä¾¿è°ƒå‚ï¼Œæœ€ä¼˜è§£åªæœ‰ 51 ä¸‡å·¦å³ï¼Œç„¶è€Œå…¶ä»–äººéƒ½æ˜¯ 60 ä¸‡å·¦å³ï¼Œå¿ƒæ…Œæ…Œ</p><p>äº¤ä¸€å‘ç«Ÿç„¶ä¹Ÿæ˜¯ 4 + 2 + 1ï¼Œå¼€å¿ƒã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> db double</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e3</span> + <span class="number">10</span>, M = <span class="number">305</span>;</span><br><span class="line"><span class="keyword">const</span> db down = <span class="number">0.986</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> a[N], b[M], mp[N][M], to[N], idb[N], ida[N];</span><br><span class="line"><span class="keyword">int</span> used[N], tmp[N];</span><br><span class="line">ll ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    db T = <span class="number">30000</span>;</span><br><span class="line">    <span class="keyword">while</span> (T &gt; <span class="number">1e-15</span>) &#123;</span><br><span class="line">        random_shuffle(ida + <span class="number">1</span>, ida + n + <span class="number">1</span>);</span><br><span class="line">        random_shuffle(idb + <span class="number">1</span>, idb + m + <span class="number">1</span>);</span><br><span class="line">        rep(i, <span class="number">1</span>, n) tmp[i] = <span class="number">0</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, m) used[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> cur = <span class="number">1</span>;</span><br><span class="line">        ll sum = <span class="number">0</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (used[idb[cur]] + a[ida[i]] &lt;= b[idb[cur]]) &#123;</span><br><span class="line">                used[idb[cur]] += a[ida[i]];</span><br><span class="line">                tmp[ida[i]] = idb[cur];</span><br><span class="line">                sum += mp[ida[i]][idb[cur]];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                ++cur; --i;</span><br><span class="line">                <span class="keyword">if</span> (cur &gt; m) <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ll del = sum - ans;</span><br><span class="line">        <span class="keyword">if</span> (del &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            ans = sum;</span><br><span class="line">            rep(i, <span class="number">1</span>, n) to[i] = tmp[i];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">exp</span>(-del / T) * RAND_MAX &gt; rand()) &#123;</span><br><span class="line">                ans = sum;</span><br><span class="line">                rep(i, <span class="number">1</span>, n) to[i] = tmp[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        T *= down;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    rep(o, <span class="number">1</span>, <span class="number">5</span>) &#123;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) ida[i] = idb[i] = i;</span><br><span class="line">        work();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    srand(time(<span class="number">0</span>) * clock() % <span class="number">114514</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;b[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">1</span>, m) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;mp[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    solve();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld :\n"</span>, ans);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, to[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://loj.ac/s/1017355" target="_blank" rel="noopener">è¯„æµ‹è®°å½•</a></p><p>$10 * 7 + 4 + 2 + 1 = 77$ï¼Œæµ·æ˜Ÿ</p>]]></content>
      
      
      
        <tags>
            
            <tag> æäº¤ç­”æ¡ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘BM ç®—æ³• &amp; å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨</title>
      <link href="2020/12/13/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91BM%20%E7%AE%97%E6%B3%95%20&amp;%20%E5%B8%B8%E7%B3%BB%E6%95%B0%E9%BD%90%E6%AC%A1%E7%BA%BF%E6%80%A7%E9%80%92%E6%8E%A8/"/>
      <url>2020/12/13/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91BM%20%E7%AE%97%E6%B3%95%20&amp;%20%E5%B8%B8%E7%B3%BB%E6%95%B0%E9%BD%90%E6%AC%A1%E7%BA%BF%E6%80%A7%E9%80%92%E6%8E%A8/</url>
      
        <content type="html"><![CDATA[<h1 id="Berlekamp-Massey"><a href="#Berlekamp-Massey" class="headerlink" title="$Berlekamp-Massey$"></a>$Berlekamp-Massey$</h1><p><a href="https://blog.csdn.net/hzj1054689699/article/details/90047110" target="_blank" rel="noopener">å¤§ä½¬1</a>  <a href="https://www.luogu.com.cn/blog/_post/234046" target="_blank" rel="noopener">å¤§ä½¬2</a></p><p>å®ç°æ—¶ä¸‹æ ‡ç»å¸¸å¤šä¸€ä½æˆ–å°‘ä¸€ä½-_-|| æˆ‘é¢„è¨€ä¸ä¹…çš„å°†æ¥ BM ä¼šæ²¦ä¸º xml çš„è„‘å†…é»‘ç®±</p><h1 id="å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨"><a href="#å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨" class="headerlink" title="å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨"></a>å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨</h1><p>æ±‚å‡ºé€’æ¨å¼ï¼Œæ¥ä¸‹æ¥å°±è¦é€’æ¨å•¦ã€‚</p><p>æ˜¯ç…§ç€ <a href="https://www.cnblogs.com/zhouzhendong/p/Cayley-Hamilton.html" target="_blank" rel="noopener">zhouzhendong</a> å’Œ <a href="https://www.cnblogs.com/Winniechen/p/10246295.html" target="_blank" rel="noopener">Winniechen</a> çš„åšå®¢å­¦ä¹ çš„ã€‚ä¹Ÿå¯ä»¥å‚è€ƒ <a href="https://oi-wiki.org/math/linear-recurrence/" target="_blank" rel="noopener">OI-wiki</a>ï¼Œæ˜¯ä¸¤ç§è§£é‡Šï¼Œæ²¡æœ‰é‚£ä¹ˆå¤šçº¿ä»£å‰ç½®èŠå£«ã€‚</p><p>å…¶å®æˆ‘è®²ä¸æ¸…æ¥šï¼Œå»ºè®®ç‚¹ OI-wikiï¼Œå®ƒç‰¹åˆ«æ¸…æ¥šã€‚</p><h2 id="é—®é¢˜å¼•å…¥"><a href="#é—®é¢˜å¼•å…¥" class="headerlink" title="$é—®é¢˜å¼•å…¥$"></a>$é—®é¢˜å¼•å…¥$</h2><p>ç»™å®šä¸€ä¸ªæ•°åˆ—ï¼Œæ»¡è¶³:</p><ul><li>$n \leq k$ æ—¶ï¼Œ$f_n = a_n$</li><li>$n &gt; k$ æ—¶ï¼Œ$f_n = \sum\limits_{i = 1}^k f_{n - i} * a_i$</li></ul><p>ä¼—æ‰€å‘¨çŸ¥çŸ©é˜µç”Ÿæ¥å°±åšè¿™äº‹å„¿çš„ï¼Œ$O(k^3\ log\ n)$. å½“ $n$ æ¯”è¾ƒå¤§çš„æ—¶å€™å°±æ²¡å‰é€”ã€‚</p><p>äºæ˜¯å°±å‡ºç°äº†â€”â€”ç‰¹å¾å¤šé¡¹å¼ä¼˜åŒ–çŸ©é˜µå¿«é€Ÿå¹‚ã€‚æ±‚ç¬¬ $n$ é¡¹å¤æ‚åº¦ä¸º $O(k^2 log n)$</p><h2 id="å‰ç½®æ•°å­¦èŠå£«"><a href="#å‰ç½®æ•°å­¦èŠå£«" class="headerlink" title="$å‰ç½®æ•°å­¦èŠå£«$"></a>$å‰ç½®æ•°å­¦èŠå£«$</h2><ol><li><p>çŸ©é˜µçš„ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡</p><ul><li><p>è‹¥å¯¹äº $n$ é˜¶çŸ©é˜µ $A$ï¼Œæœ‰å¸¸æ•° $\lambda$ã€éé›¶åˆ—å‘é‡ $\vec{v}$ æ»¡è¶³ $\lambda \vec{v} = A \vec{v}$ï¼Œåˆ™ç§° $\lambda$ ä¸ºçŸ©é˜µ $A$ çš„<strong>ç‰¹å¾å€¼</strong>ï¼Œ$\vec{v}$ ä¸ºçŸ©é˜µ $A$ çš„<strong>ç‰¹å¾å‘é‡</strong>ã€‚</p></li><li><p>ä¸ŠæŸ¿å¯ä»¥å†™ä½œ $(\lambda I - A)\vec{v} = 0$, å·¦è¾¹æ‹¬å·é‡Œé‚£ç©æ„æ˜¯çŸ©é˜µçš„è¡Œåˆ—å¼ï¼Œè®°åš $f(\lambda)$ï¼Œå³ä¸ºçŸ©é˜µ $A$ çš„<strong>ç‰¹å¾å¤šé¡¹å¼</strong>ï¼Œåˆ™å¯¹äºæŸä¸ªçŸ©é˜µçš„ç‰¹å¾å€¼ $\lambda_0$, æœ‰ $f(\lambda_0) = 0$ã€‚</p></li><li><p>ï¼ˆæ³¨æ„ï¼šè¡Œåˆ—å¼å’ŒçŸ©é˜µä¹˜ä»¥ä¸€ä¸ªæ•° $k$ æ—¶æ˜¯ä¸åŒçš„ï¼Œè¡Œåˆ—å¼æ˜¯æŸè¡Œæˆ–æŸåˆ—ä¹˜ $k$ï¼ŒçŸ©é˜µæ˜¯æ‰€æœ‰æ•°ä¹˜ $k$ã€‚åˆ«é—®ä¸ºå•¥ï¼Œè¿™å°±æ˜¯å®šä¹‰ã€‚ï¼‰</p></li></ul></li><li><p>çŸ©é˜µç‰¹å¾å¤šé¡¹å¼å’Œä¸€ä¸ªè‘—åå®šç†</p><ul><li><p>å‡¯è±-å“ˆå¯†é¡¿å®šç†ï¼š$f(A) = 0$.</p></li><li><p>æ±‚è§£ï¼š$f(\lambda) = |\lambda I - A| = \lambda^m - \sum\limits_{i = 0}^{k - 1} a_{k - i} \lambda^i$</p></li></ul></li></ol><p>ç”±ä¸Šé¢é‚£ä¸ªæŸ¿å­å¾—åˆ° $f(A) = A^k - b_1A^{k - 1} - c_2A^{k - 2}  â€¦ - c_k = 0$, å³ $A^k = c_1A^{k - 1} + â€¦ + c_k$ï¼Œè¿™å‘Šè¯‰æˆ‘ä»¬ $A_k$ å¯ä»¥è¢« $A^0$ ~ $A^{k - 1}$ çš„çŸ©é˜µçº¿æ€§è¡¨å‡ºï¼ï¼ˆå“‡ï¼Œæœ‰çº¿ä»£å†…å‘³äº†</p><p>$A^{x + y} = A^x * A^y$,</p><p>$A^x = \sum b_i A^i$, $A^y = \sum c_i A^i$</p><p>å› ä¸ºæœ‰ $f(A) = 0$ï¼Œæ‰€ä»¥ $A^{x + y} = \sum\limits_{k = 0}^{2K - 2} (\sum\limits_{i = 0}^{K - 1} b_ic_{k - i})A^k\ mod\ f(A)$ï¼Œè¿™ä¸ªå–æ¨¡è¾¾åˆ°äº†é™æ¬¡çš„æ•ˆæœã€‚ç”¨å¿«é€Ÿå¹‚å°±æ˜¯ $O(K^2 logn)$ çš„ã€‚</p><p>zhouzhendong å¤§ä½¬åšå®¢é‡Œæœ‰<del>éäºº</del>ç¥ä»™ $O(klogklogn)$ å¤šé¡¹å¼æ“ä½œï¼Œç„¶è€Œå¸¸äººéƒ½å†™ä¸åŠ¨å§ QAQï¼Ÿï¼ˆå°±å…ˆä¸å­¦äº†</p><p>$Template$ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">luogu_5497</span></span><br><span class="line"><span class="comment">åŠ äº†å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨çš„ç‰ˆæœ¬</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>, N = <span class="number">2e4</span> + <span class="number">10</span>;</span><br><span class="line">ll n, m, de, K;</span><br><span class="line">ll a[N], b[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;ll&gt; f[N], ans, lst;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">add</span><span class="params">(ll x, ll y)</span> </span>&#123; <span class="keyword">return</span> (x + y) % mod; &#125;</span><br><span class="line"><span class="function">ll <span class="title">mul</span><span class="params">(ll x, ll y)</span> </span>&#123; <span class="keyword">return</span> x * y % mod; &#125;</span><br><span class="line"><span class="function">ll <span class="title">sub</span><span class="params">(ll x, ll y)</span> </span>&#123; <span class="keyword">return</span> (x - y + mod) % mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Add</span><span class="params">(ll &amp;x, ll y)</span> </span>&#123; x = (x + y) % mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Mul</span><span class="params">(ll &amp;x, ll y)</span> </span>&#123; x = x * y % mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Sub</span><span class="params">(ll &amp;x, ll y)</span> </span>&#123; x = (x - y + mod) % mod; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    a %= mod;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>, Mul(a, a)) <span class="keyword">if</span> (b &amp; <span class="number">1</span>) Mul(ret, a);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BM</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> fail = <span class="number">0</span>;</span><br><span class="line">    ll cur = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        cur = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; ans.size(); j++)</span><br><span class="line">            Add(cur, mul(b[i - <span class="number">1</span> - j], ans[j]));</span><br><span class="line">        <span class="keyword">if</span> (!((b[i] - cur) % mod)) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (!fail) &#123;</span><br><span class="line">            fail = i;</span><br><span class="line">            de = b[i] - cur;</span><br><span class="line">            rep(j, <span class="number">1</span>, i) ans.pb(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">vector</span>&lt;ll&gt; now = ans;</span><br><span class="line">        ll w = mul(b[i] - cur, qpow(de, mod - <span class="number">2</span>));</span><br><span class="line">        <span class="keyword">if</span> (ans.size() &lt; lst.size() + i - fail)</span><br><span class="line">            ans.resize(lst.size() + i - fail);</span><br><span class="line">        Add(ans[i - fail - <span class="number">1</span>], w);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; lst.size(); j++)</span><br><span class="line">            Sub(ans[i - fail + j], mul(w, lst[j]));</span><br><span class="line">        <span class="keyword">if</span> (now.size() &lt; lst.size() + i - fail) &#123;</span><br><span class="line">            lst = now, fail = i, de = b[i] - cur;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">doMul</span><span class="params">(ll x[], ll y[])</span> </span>&#123;</span><br><span class="line">    ll tmp[N];</span><br><span class="line">    <span class="built_in">memset</span>(tmp, <span class="number">0</span>, <span class="keyword">sizeof</span>(tmp));</span><br><span class="line">    rep(i, <span class="number">0</span>, K - <span class="number">1</span>)</span><br><span class="line">        rep(j, <span class="number">0</span>, K - <span class="number">1</span>)</span><br><span class="line">            Add(tmp[i + j], mul(x[i], y[j]));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> * K - <span class="number">2</span>; i &gt;= K; i--) &#123;  <span class="comment">// åœ¨å–æ¨¡</span></span><br><span class="line">        <span class="keyword">if</span> (!tmp[i]) <span class="keyword">continue</span>;</span><br><span class="line">        rep(j, <span class="number">1</span>, K)</span><br><span class="line">            Add(tmp[i - j], mul(a[j], tmp[i]));</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">0</span>, <span class="number">2</span> * K - <span class="number">1</span>)</span><br><span class="line">        x[i] = tmp[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ll c[N];  <span class="comment">// ç³»æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fpow</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> ll tmp[N];</span><br><span class="line">    <span class="built_in">memset</span>(tmp, <span class="number">0</span>, <span class="keyword">sizeof</span>(tmp));</span><br><span class="line">    <span class="built_in">memset</span>(c, <span class="number">0</span>, <span class="keyword">sizeof</span>(c));</span><br><span class="line">    c[<span class="number">0</span>] = tmp[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; n; n &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &amp; <span class="number">1</span>) doMul(c, tmp);</span><br><span class="line">        doMul(tmp, tmp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;b[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    BM(n);</span><br><span class="line">    K = (<span class="keyword">int</span>)ans.size();</span><br><span class="line">    rep(i, <span class="number">0</span>, K - <span class="number">1</span>) &#123;</span><br><span class="line">        ans[i] = (ans[i] % mod + mod) % mod;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld "</span>, ans[i]);</span><br><span class="line">        a[i + <span class="number">1</span>] = ans[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    rep(i, <span class="number">0</span>, K - <span class="number">1</span>) b[i] = b[i + <span class="number">1</span>];</span><br><span class="line">    rep(i, K, n) b[i] = <span class="number">0</span>;</span><br><span class="line">    fpow(m);</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">0</span>, K - <span class="number">1</span>)</span><br><span class="line">        Add(ans, mul(b[i], c[i]));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, (ans % mod + mod) % mod);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="THUSCH2017-å¦‚æœå¥‡è¿¹æœ‰é¢œè‰²"><a href="#THUSCH2017-å¦‚æœå¥‡è¿¹æœ‰é¢œè‰²" class="headerlink" title="$THUSCH2017-å¦‚æœå¥‡è¿¹æœ‰é¢œè‰²$"></a><a href="https://loj.ac/p/2981" target="_blank" rel="noopener">$THUSCH2017-å¦‚æœå¥‡è¿¹æœ‰é¢œè‰²$</a></h3><p>è¿™é¢˜æ¯”æ´›è°·ä¸Šçš„ Polya æ¨¡æ¿é¢˜å¤šäº†ä¸ªç›¸é‚» $m$ é¡¹é¢œè‰²ä¸èƒ½å…¨ä¸åŒçš„é™åˆ¶ã€‚</p><p>$|X/G| = \frac{1}{|G|} \sum_g m^{c(g)} = \frac{1}{|G|} \sum_k \phi(n / k) * f(k)$</p><p>ç°åœ¨è¦ç®— $f(gcd = k)$ çš„æŸ“è‰²æ–¹æ¡ˆæ•°ã€‚å¯ä»¥çŠ¶å‹è®¡ç®—ï¼ŒçŠ¶æ€æ•°æ˜¯ $m^{m}$ï¼Œç›´æ¥è·‘çŸ©é˜µå¿«é€Ÿå¹‚èƒ½æ‹¿åˆ° $55$ åˆ†çš„å¥½æˆç»©ï¼Œç„¶åæˆ‘å°±ä¸ä¼šäº†</p><p>é¢˜è§£å‘Šè¯‰æˆ‘è¦å»å­¦å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨ï¼Œæˆ‘å°±æ»šå»å­¦äº†ã€‚åšåšï¼Œæ–°çŸ¥è¯†ï¼ï¼ˆäºæ˜¯å°±æœ‰äº†è¿™ç¯‡æ‹¼å‡‘èµ·æ¥çš„ç¬”è®°</p><p>çŒœæµ‹é€’æ¨å¼é•¿åº¦å°äº $m^{m}$ï¼Œå€ŸåŠ©è¶…èƒ½åŠ›ï¼ˆæ‰“è¡¨ï¼‰å‘ç° $m = 7$ å°± $409$.</p><p><a href="https://loj.ac/s/1012066" target="_blank" rel="noopener">$Code$</a></p><h3 id="NOI2017-æ³³æ± "><a href="#NOI2017-æ³³æ± " class="headerlink" title="$NOI2017-æ³³æ± $"></a><a href="https://uoj.ac/problem/316" target="_blank" rel="noopener">$NOI2017-æ³³æ± $</a></h3><p><strong>æ°å¥½</strong>ç”¨å·®åˆ†å˜ä¸º<strong>å°äºç­‰äº</strong>ã€‚è®¾è®¡ dpï¼š$dp_{i, j}$ è¡¨ç¤ºæœ‰ä¸€å—å®½åº¦ä¸º $j$ çš„åŒºåŸŸï¼Œæœ€ä¸‹é¢ $i$ è¡Œéƒ½æ˜¯å®‰å…¨çš„ï¼Œä»ä¸‹å¾€ä¸Šç¬¬ $i + 1$ è¡ŒåŠä»¥ä¸Šéƒ¨åˆ†ä»»æ„ï¼Œ<strong>ä¸”è¯¥åŒºåŸŸå†…æœ€å¤§æ¸¸æ³³åœºé¢ç§¯ $\leq K$</strong> çš„æ¦‚ç‡ã€‚é‚£ä¹ˆæœ‰ï¼š</p><p>$$dp_{i, j} = dp_{i + 1, j} p^j + \sum\limits_{k = 1}^j dp_{i + 1, k - 1}dp_{i, j - k}(1 - p)p^{k - 1}$$</p><p>ç­”æ¡ˆæ˜¯ $dp_{0, n}$ã€‚</p><p>å¦‚æœä½ æ‰“äº†è¡¨ã€‚ã€‚ä½ å°±ä¼šå‘ç° $dp_0$ æœ‰é€’æ¨å¼ï¼ˆè°è¿™ä¹ˆç†Ÿç»ƒå•Š= =ï¼‰äºæ˜¯ä¸€é¡¿æ“ä½œçŒ›å¦‚è™ï¼Œå›å¤´ä¸€çœ‹äºŒç™¾äº”ã€‚</p><p><a href="https://uoj.ac/submission/452703" target="_blank" rel="noopener">$Code$</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿æ€§é€’æ¨ </tag>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[ZJOI2019]-å¼€å…³</title>
      <link href="2020/12/11/%5BZJOI2019%5D-%E5%BC%80%E5%85%B3/"/>
      <url>2020/12/11/%5BZJOI2019%5D-%E5%BC%80%E5%85%B3/</url>
      
        <content type="html"><![CDATA[<h2 id="æ–¹æ³•ä¸€-ç”Ÿæˆå‡½æ•°"><a href="#æ–¹æ³•ä¸€-ç”Ÿæˆå‡½æ•°" class="headerlink" title="$æ–¹æ³•ä¸€:ç”Ÿæˆå‡½æ•°$"></a>$æ–¹æ³•ä¸€:ç”Ÿæˆå‡½æ•°$</h2><p>â€œç¥ä»™é¢˜ï¼â€ï¼ˆå¹³åº¸çš„ xml å‘å‡ºæƒŠå¹ï¼‰</p><p>ç”Ÿæˆå‡½æ•°æ€ä¹ˆæƒ³åˆ°çš„å•Šï¼Ÿ/yiw ä½†çš„ç¡®å¾ˆç¬¦åˆï¼Œå› ä¸ºæŒ‰é”®æ˜¯æœ‰é¡ºåºçš„ï¼Œè€Œæ¯ä¸ªé”®æŒ‰å¤šå°‘æ¬¡æ¦‚ç‡ä¹Ÿä¸åŒï¼Œé€‚åˆç”¨å½¢å¼å¹‚çº§æ•°è¡¨ç¤ºã€‚</p><p>è®¾ $P = \sum p$.</p><p>åˆ†å¼€è€ƒè™‘æ¯ä¸ªé”®ã€‚è€ƒè™‘ $[x^k]F_i(x)$ è¡¨ç¤ºç¬¬ $i$ ä¸ªä½ç½®æŒ‰äº† $k$ æ¬¡çš„æ¦‚ç‡è´¡çŒ®ã€‚å½“ç„¶æ˜¯ EGF å•¦å› ä¸ºæ˜¯æœ‰é¡ºåºçš„æŒ‰ã€‚<br>$$F_i(x) = \sum\limits_{n \geq 0} [n\ mod\ 2 == s_i] \frac{ ( \frac{p_i}{P} ) ^n}{n!} x^n$$<br>$$F(x) = \prod F_i(x)$$<br>å†™æˆ OGF $$f(x) = \sum_k (k! * [x^k]F(x)) * x^k$$</p><p>$[x^k]G_i(x)$ è¡¨ç¤ºç¬¬ $i$ ä¸ªä½ç½®æŒ‰äº† $k$ æ¬¡ï¼ŒçŠ¶æ€ä¸å˜çš„æ¦‚ç‡ã€‚</p><p>ç„¶è€Œåªæœ‰ $F$ èƒ½å¹²å•¥å‘¢ï¼Ÿæˆ‘ä»¬è¦æ±‚çš„æ˜¯<strong>ç¬¬ä¸€æ¬¡</strong>åˆ°è¾¾ç›®æ ‡çŠ¶æ€ï¼Œæ‰€ä»¥éœ€è¦å®¹æ–¥ã€‚å…·ä½“æ¥è¯´ï¼Œè®¾ $g(x)$ è¡¨ç¤º $k$ æ¬¡çŠ¶æ€ä¸å˜çš„ OGFï¼Œå¯æŒ‰ä¸Šè¿°æ–¹æ³•æ±‚å‡ºï¼›è®¾ $h(x)$ ä¸ºç­”æ¡ˆ OGFï¼Œåˆ™ $f(x) = g(x) \cdot h(x)$, åˆ™ $h(x) = \frac{f(x)}{g(x)}$.</p><p>æ ¹æ®æœŸæœ›çš„å®šä¹‰ï¼Œç­”æ¡ˆå½¢å¦‚ $\sum_i if(i)$ ã€‚å•Šè¿™ä¸å°±æ˜¯ $h(1)$ çš„å¯¼æ•°å˜›ï¼$hâ€™(1)$ å°±æ˜¯æœ€ç»ˆç­”æ¡ˆã€‚</p><p>$$G_i(x) = \sum\limits_{n \geq 0} [n\ mod\ 2 == 0] \frac{( \frac{p_i}{P} )^n}{n!} x^n$$<br>$$G(x) = \prod G_i(x)$$<br>å†™æˆ OGF $$g(x) = \sum_k (k! * [x^k]G(x)) * x^k$$</p><p>å†™æˆå°é—­å½¢å¼<br>$$F_i(x) = \frac{e^{\frac{p_i}{P}x} + (-1)^{s_i} e^{-\frac{p_i}{P}x}}{2}$$<br>$$F(x) = \prod \frac{e^{\frac{p_i}{P}x} + (-1)^{s_i} e^{-\frac{p_i}{P}x}}{2}$$<br>$$G_i(x) = \frac{e^{\frac{p_i}{P}x} + e^{-\frac{p_i}{P}x}}{2}$$<br>$$G(x) = \frac{e^{\frac{p_i}{P}x} + e^{-\frac{p_i}{P}x}}{2}$$<br>å°† $F(x)$ å†™æˆ $\sum c_i e^{\frac{i}{P}x}$ çš„å½¢å¼ï¼Œåˆ™æœ‰</p><p>$$f(x) = \sum_k \left( k![x^k]F(x) \right) x^k$$</p><p>$$= \sum_k k![x^k]( \sum_i c_i ( \sum_j \frac{(\frac{i}{P}x)^j}{j!} ) )x^k$$</p><p>$$= \sum_k ( k! \sum_i c_i \frac{(\frac{i}{P})^k}{k!} ) x^k = \sum_k  (\sum_i c_i (\frac{i}{P})^k) x^k $$</p><p>$$= \sum_i c_i \sum_k (\frac{i}{P})^k x^k = \sum_i \frac{c_i}{1 - \frac{i}{P}x} $$</p><p>åŒç†æœ‰ $g(x) = \sum_i \frac{d_i}{1 - \frac{i}{P}x}$ã€‚$c_i$, $d_i$ å¯ä»¥ç®€å• $O(nP)$ èƒŒåŒ…å¾—å‡ºï¼</p><p>è¡¥å……æ±‚å¯¼åŠ å‡ä¹˜é™¤æ³•æ³•åˆ™ï¼š</p><p>$$(f(x) + g(x))â€™ = fâ€™(x) + gâ€™(x)$$</p><p>$$(f(x) - g(x))â€™ = fâ€™(x) - gâ€™(x)$$</p><p>$$(f(x) \cdot g(x))â€™ = fâ€™(x)g(x) + f(x)gâ€™(x)$$</p><p>$$(\frac{f(x)}{g(x)})â€™ = \frac{fâ€™(x)g(x) - f(x)gâ€™(x)}{g(x)^2}$$</p><p>æ‰€ä»¥è¦æ±‚ $hâ€™(x)$ï¼Œåªè¦è®¡ç®—å‡º $f(1)$, $fâ€™(1)$, $g(1)$, $gâ€™(1)$.</p><p><strong>ç„¶ååˆæ˜¯å¸¸è¯†é—®é¢˜ï¼šæ— çŸ¥å¦‚æˆ‘å°±æƒ³ç›´æ¥å¸¦ 1 è¿›å»äº†ï¼Œä½†è¿™ä¸è¡Œï¼ï¼ï¼å› ä¸º $i = P$ é¡¹çš„å­˜åœ¨ï¼Œå‡½æ•°ä¸æ”¶æ•›ï¼ï¼ï¼</strong></p><p>æ€ä¹ˆåŠï¼Ÿä¹˜ä¸Š $1 - x$</p><p>$$f(x) = c_P + \sum\limits_{i \neq P} \frac{c_i(1 - x)}{1 - \frac{i}{P}x}$$</p><p>$$f(1) = c_P$$</p><p>$$fâ€™(x) = \sum\limits_i \frac{ -c_i(1 - \frac{i}{P}x) - (c_i - c_ix)(-\frac{i}{P}) }{(1 - \frac{i}{P}x)^2} = \sum\limits_i \frac{ (\frac{i}{P} - 1)c_i }{ (\frac{i}{P}x - 1)^2 } $$</p><p>$$fâ€™(1) = \sum\limits_{i \neq P} \frac{c_i}{\frac{i}{P} - 1}$$</p><p>åŒç† $g(1) = d_P$, $gâ€™(1) = \sum\limits_{i \neq P} \frac{d_i}{\frac{i}{P} - 1}$</p><p>$$hâ€™(1) = \sum\limits_{i \neq P} \frac{c_id_P - c_Pd_i}{(i - 1)d_P^2}$$</p><p>ç¥å¥‡ï¼</p><p><a href="https://loj.ac/s/1010266" target="_blank" rel="noopener">$Code$</a></p><p>ä»ä¸­è·å¾—çš„å¯ç¤ºï¼š</p><ul><li>å¤šè€ƒè™‘å®é™…æ„ä¹‰ï¼Œä¾‹å¦‚æœ¬é¢˜ä¸­æœŸæœ› -&gt; å¯¼æ•°ã€‚</li><li>æ¨æŸ¿å­ï¼šé¢å¯¹å¤šé¡¹å¼æŸæ‰‹æ— ç­–ï¼Œä¸å¦‚æŠŠå®ƒå˜æˆå°é—­å½¢å¼æäº‹æƒ…ï¼Œå¤šé¡¹å¼çš„åŠ å‡ä¹˜é™¤å’Œæ•°çš„åŠ å‡ä¹˜é™¤ç±»ä¼¼çš„ï¼Œè¿˜å¯ä»¥æ±‚å¯¼ã€lnã€expï¼Œå¤šå¥½å•Šï¼</li><li>æ¨æŸ¿å­ï¼šæŠŠ $\prod_{i = l}^{r}$ å˜æˆä¸€ä¸ª $r - l + 1$ æ¬¡çš„å¤šé¡¹å¼ï¼Œå°±å¯ä»¥ $\sum$ å•¦ï¼$\sum$ å°±èƒ½æäº‹æƒ…å•¦ï¼</li></ul><h2 id="æ–¹æ³•äºŒï¼šå¼‚æˆ–å·ç§¯"><a href="#æ–¹æ³•äºŒï¼šå¼‚æˆ–å·ç§¯" class="headerlink" title="$æ–¹æ³•äºŒï¼šå¼‚æˆ–å·ç§¯$"></a>$æ–¹æ³•äºŒï¼šå¼‚æˆ–å·ç§¯$</h2><p>å’•å’•ï¼Ÿ<del>ï¼ˆç”Ÿæˆå‡½æ•°æç´¯äº†</del></p>]]></content>
      
      
      
        <tags>
            
            <tag> ç”Ÿæˆå‡½æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åäºŒæœˆå­¦ä¹ è®¡åˆ’</title>
      <link href="2020/12/07/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%91%E5%8D%81%E4%BA%8C%E6%9C%88%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/"/>
      <url>2020/12/07/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%91%E5%8D%81%E4%BA%8C%E6%9C%88%E5%AD%A6%E4%B9%A0%E8%AE%A1%E5%88%92/</url>
      
        <content type="html"><![CDATA[<p><del>æˆ‘å°±æ˜¯å–œæ¬¢æŒ–æ·±å‘!</del></p><p>é•¿æ–‡ç»™æˆ‘çš„æ„Ÿè§‰ç‰¹åˆ«å®‰å¿ƒå•¦å…¶å®æ˜¯ã€‚ç„¶åä¸€äº›é¢˜ç›®çš„é¢˜è§£ä¹Ÿè¦æ•´ç†æ•´ç†ï¼Œå­¦ä¹ è®¡åˆ’ä¹Ÿè¦å®‰æ’ç»™è‡ªå·±çœ‹ã€‚</p><p>$1.16$ å‰çš„å­¦ä¹ è®¡åˆ’å°±, åˆ·</p><ul><li>$CodePlus$ï¼ˆé€‰ï¼‰</li><li>$NOI$ï¼ˆ12 ~ 20ï¼‰</li><li>$JOI$ï¼ˆé€‰ï¼‰â˜‘ï¸</li><li>æ¸…åé›†è®­ï¼ˆ14 ~ ?ï¼‰</li></ul><p>å¤šå­¦æ•°å­¦çŸ¥è¯†:</p><ul><li>ç¾¤è®ºâ˜‘ï¸</li><li>ç”Ÿæˆå‡½æ•°â˜‘ï¸</li><li>å•ä½æ ¹åæ¼”</li><li>æ–¯ç‰¹æ—ç›¸å…³</li></ul><p>updï¼šå®Œæˆåº¦æ„Ÿäººã€‚</p><hr><h2 id="mathcal-12-7"><a href="#mathcal-12-7" class="headerlink" title="$\mathcal{12.7}$"></a>$\mathcal{12.7}$</h2><hr><p>å†™äº† $Polya$ æ¿é¢˜ï¼Œå¤šé¡¹å¼ $exp$ æ¿é¢˜ï¼Œç„¶åç°åœ¨å·¨æƒ³å†™ä¸æ¿çš„é¢˜ï¼ˆ</p><h3 id="æ´›è°·4980-Polya-æ¿é¢˜"><a href="#æ´›è°·4980-Polya-æ¿é¢˜" class="headerlink" title="$æ´›è°·4980-Polya æ¿é¢˜$"></a><a href="https://www.luogu.com.cn/problem/P4980" target="_blank" rel="noopener">$æ´›è°·4980-Polya æ¿é¢˜$</a></h3><p>$Polya$ å®šç†ï¼š<br>$|X/G| = \frac{1}{|G|} \sum\limits_{g \in G} |M|^{c(g)}$</p><p>å…¶ä¸­</p><ul><li>$X$ æ˜¯ä¸è€ƒè™‘æœ¬è´¨ä¸åŒçš„æŸ“è‰²æ–¹æ¡ˆé›†åˆ</li><li>$G$ æ˜¯å„ç§ç¿»è½¬å•Šæ—‹è½¬å•Šç­‰æ“ä½œæ„æˆçš„ç½®æ¢ç¾¤</li><li>$X/G$ æ˜¯æœ¬è´¨ä¸åŒçš„æŸ“è‰²æ–¹æ¡ˆé›†åˆ</li><li>$M$ æ˜¯é¢œè‰²æ•°</li><li>$c(g)$ æ˜¯ç½®æ¢ $g$ çš„ä¸ç›¸äº¤å¾ªç¯ç½®æ¢ä¸ªæ•°</li></ul><p>ç„¶åè¿™é¢˜æˆ‘ä»¬ç›´æ¥å¥—å…¬å¼å°±å¯ä»¥åšï¼<br>$ans = \frac{1}{n} \sum\limits_{g \in G} n^{c(g)}$</p><p>æšä¸¾ $c(g)$ï¼Œè®¾ $g$ æ—‹è½¬äº† $i$ï¼Œåˆ™ $c(g) = gcd(n, i)$ï¼Œå› ä¸ºæŸä¸ªç‚¹åœ¨ç½®æ¢ $g$ çš„é‡å¤ä½œç”¨ä¸‹ç»è¿‡ $lcm(n, i)$ æ¬¡æ“ä½œå›åˆ°è‡ªèº«ï¼Œæ‰€ä»¥ $c(g) = \frac{n * i}{lcm(n, i)} = gcd(n, i)$</p><p>$\phi(n / i)$ ä¸ºå…¶ç³»æ•°ï¼Œä¸ºå•¥ï¼Ÿ</p><p>$\sum\limits_{k = 1}^{n} [gcd(n, k) == i]= \sum\limits_{k = 1}^{n / i} [gcd(n, k * i) == i]$</p><p>$= \sum\limits_{k = 1}^{n / i} [gcd(n / i, k) == 1] = \phi(n / i)$</p><p>æ‰€ä»¥æœ‰ $ans = \frac{1}{n} \sum\limits_{i | n} \phi(n / i) * n^i$, $O(\sqrt{n})$</p><h3 id="æ´›è°·5574-ä»»åŠ¡åˆ†é…é—®é¢˜"><a href="#æ´›è°·5574-ä»»åŠ¡åˆ†é…é—®é¢˜" class="headerlink" title="$æ´›è°·5574-ä»»åŠ¡åˆ†é…é—®é¢˜$"></a><a href="https://www.luogu.com.cn/problem/P5574" target="_blank" rel="noopener">$æ´›è°·5574-ä»»åŠ¡åˆ†é…é—®é¢˜$</a></h3><p>ä¸ºäº†é¡ºå£æˆ‘ä»¬æ±‚é€†åºå¯¹æœ€å°‘ï¼ˆç¿»è½¬ä¸€ä¸‹ $a[i]$ å°±å¥½ï¼‰</p><p>$calc(l, r)$ ä¸º $[l, r]$ çš„é€†åºå¯¹ä¸ªæ•°ã€‚çœ‹èµ·æ¥åƒæ–œç‡ä¼˜åŒ–ä½†å®ƒä¸èƒ½ã€‚ã€‚æˆ‘ç›¸ä¿¡ä¸€å®šå¯ä»¥ä¼˜åŒ–ï¼</p><p>å‘ç°æœ‰å†³ç­–å•è°ƒæ€§ï¼š$calc(l - 1, r + 1) + calc(l, r) \geq calc(l - 1, r) + calc(l, r + 1)$<br>æ˜“è¯ã€‚<br>äºæ˜¯å¯ä»¥ç»å…¸å†³ç­–å•è°ƒåˆ†æ²» + æ ‘çŠ¶æ•°ç»„æ¨åŒºé—´ã€‚<br>$O(Knlog^2n)$</p><h2 id="mathcal-12-8"><a href="#mathcal-12-8" class="headerlink" title="$\mathcal{12.8}$"></a>$\mathcal{12.8}$</h2><hr><h3 id="æ´›è°·4128-æœ‰è‰²å›¾"><a href="#æ´›è°·4128-æœ‰è‰²å›¾" class="headerlink" title="$æ´›è°·4128-æœ‰è‰²å›¾$"></a><a href="https://www.luogu.com.cn/problem/P4128" target="_blank" rel="noopener">$æ´›è°·4128-æœ‰è‰²å›¾$</a></h3><p>æŸ“è‰²çš„æ˜¯è¾¹ï¼Œè½¬çš„æ˜¯ç‚¹ã€‚è€ƒè™‘å¯¹äºæŸç§è½¬ç‚¹æ–¹æ¡ˆï¼Œå…¶ç­‰ä»·ç±»ä¸ªæ•°ã€‚é‚£è¾¹å°±è¦åˆ†_è¿æ¥åŒä¸ªå¾ªç¯çš„ç‚¹_å’Œ_è¿æ¥ä¸åŒå¾ªç¯çš„ç‚¹_è®¨è®ºã€‚</p><p>åŒä¸ªå¾ªç¯ï¼šè®¾é•¿åº¦ä¸º $b_i$ï¼Œæœ‰ $b_i / 2$ ç§ç­‰ä»·ç±»</p><p>ä¸åŒå¾ªç¯ï¼šç­‰ä»·ç±»å¤§å°ä¸º $lcm(b_i, b_j)$ï¼Œç­‰ä»·ç±»ä¸ªæ•°ä¸º $b_i * b_j / lcm(b_i, b_j) = gcd(b_i, b_j)$</p><p>ç°åœ¨çŸ¥é“äº†å…·ä½“ $b_i$ å°±èƒ½ç®—ç­”æ¡ˆäº†ã€‚<br>è€ƒè™‘ $n$ çš„åˆ†æ‹†ï¼Œ$n$ åªæœ‰ $53$ï¼Œååˆ†ç¨³ï¼ˆå®é™…ä¸Šè¦ $7e7$ï¼‰ï¼ˆé—®é¢˜ä¸å¤§ï¼‰</p><p>æˆ‘ä»¬æšä¸¾ $b$ çš„å¤šé‡é›†ï¼Œç³»æ•°ä¹ŸæŒºæ­£å¸¸çš„ï¼š$\frac{n!}{\prod b_i!} * \prod (b_i - 1)! * \frac{1}{c_i!}$</p><p>å…¶ä¸­ç¬¬ä¸€é¡¹æ˜¯æŠŠç‚¹åˆ†é…åˆ°å¤šé‡é›†é‡Œï¼Œç¬¬äºŒé¡¹æ˜¯æ¯ä¸ªé›†åˆæ’é¡ºåºï¼ˆæ˜¯ç½®æ¢å˜›ï¼‰ï¼Œç¬¬ä¸‰é¡¹æ˜¯é™¤æ‰å¤§å°ç›¸åŒçš„é›†åˆç®—é‡çš„æ–¹æ¡ˆã€‚</p><p>æœ‰åŒå€ç»éªŒé¢˜ï¼šHNOI2009-å›¾çš„åŒæ„è®¡æ•°ã€‚ç¬¬ä¸€ååº”æ˜¯æ— æ ‡å·è¿é€šå›¾è®¡æ•° + èƒŒåŒ…â€”â€”ä¸å¯¹åŠ²ï¼Œæˆ‘åªä¼šæœ‰æ ‡å·çš„ã€‚å†ä¸€æƒ³ï¼Œè¾¹çš„æœ‰æ— ä¸æ­£å¯¹åº”ç€æ­¤é¢˜ä¸­æŸ“æˆé»‘æˆ–ç™½è‰²å—ï¼Ÿäºæ˜¯çœ‹é¢˜è§£ï¼ŒæœçœŸå°±æ˜¯æœ‰è‰²å›¾çš„å¡å¸¸ç‰ˆâ€”â€”æŠŠ gcd åœ¨ä¸­é€”è®¡ç®—æ‰å°±èƒ½ AC æ­¤é¢˜ã€‚</p><h2 id="mathcal-12-9"><a href="#mathcal-12-9" class="headerlink" title="$\mathcal{12.9}$"></a>$\mathcal{12.9}$</h2><hr><h2 id="mathcal-12-10"><a href="#mathcal-12-10" class="headerlink" title="$\mathcal{12.10}$"></a>$\mathcal{12.10}$</h2><hr><h3 id="ZJOI2019-å¼€å…³"><a href="#ZJOI2019-å¼€å…³" class="headerlink" title="$ZJOI2019-å¼€å…³$"></a><a href="https://www.luogu.com.cn/problem/P5326" target="_blank" rel="noopener">$ZJOI2019-å¼€å…³$</a></h3><p>å•ç‹¬å†™åšå®¢äº†</p><h2 id="mathcal-12-11"><a href="#mathcal-12-11" class="headerlink" title="$\mathcal{12.11}$"></a>$\mathcal{12.11}$</h2><hr><h3 id="BZOJ4221-Kangaroo"><a href="#BZOJ4221-Kangaroo" class="headerlink" title="$BZOJ4221-Kangaroo$"></a><a href="https://darkbzoj.tk/problem/4221" target="_blank" rel="noopener">$BZOJ4221-Kangaroo$</a></h3><p>æˆ‘ä»¬å‘ç°è¢‹é¼ å’Œè¢‹å­å¯æ‹†ã€‚ä¸å¦¨åˆ†åˆ«å‡åºæ’åˆ—ï¼Œçœ‹èµ·æ¥å¾ˆå¯ä»¥ dpã€‚æˆ‘ä»¬è¦åšåˆ°çš„å°±æ˜¯æ²¡åŒ¹é…çš„ $min(a) \geq max(b)$ã€‚</p><p>æšä¸¾ä»å·¦å¾€å³ç¬¬ä¸€ä¸ªæ²¡æœ‰è¢«å¡åˆ°è¢‹å­é‡Œçš„è¢‹é¼  $s$ï¼Œå¯¹äºè¿™ä¸ª $s$ æ‰¾åˆ°å®ƒèƒ½åŒ¹é…çš„æœ€å°çš„è¢‹å­ $t$ã€‚ç”±äº $s$ æ˜¯ç¬¬ä¸€ä¸ªæ²¡åŒ¹é…çš„è¢‹é¼ ï¼Œ$s$ å·¦è¾¹çš„è¢‹é¼ å’Œ $t$ åŠå…¶å³è¾¹çš„è¢‹å­éƒ½è¢«åŒ¹é…äº†ã€‚æ€ä¹ˆç»Ÿè®¡æ–¹æ¡ˆæ•°ï¼Ÿæšä¸¾è·¨è¶Š $(s, t)$ çš„å¯¹æ•°ï¼Œå³å°äº $s$ çš„è¢‹é¼ åŒå¤§äº $t$ çš„è¢‹å­åŒ¹é…ã€‚é™¤å»è¿™äº›ï¼Œå‰©ä¸‹çš„åŒ¹é…å¯¹å°±æ˜¯å°äº $s$ å’Œå°äº $t$ï¼Œå¤§äº $s$ å’Œå¤§äº $t$ã€‚å·¦å³åˆ†åˆ« $n^2$ dpã€‚</p><p><a href="https://darkbzoj.tk/submission/99567" target="_blank" rel="noopener">$Code$</a></p><h2 id="mathcal-12-12"><a href="#mathcal-12-12" class="headerlink" title="$\mathcal{12.12}$"></a>$\mathcal{12.12}$</h2><hr><p>ä¸‹åˆçš„ THUPC2020ï¼Œäº«å—æ¯”èµ›ï¼Œå¥½å¥½æ‰“å§ï¼</p><h2 id="mathcal-12-13"><a href="#mathcal-12-13" class="headerlink" title="$\mathcal{12.13}$"></a>$\mathcal{12.13}$</h2><hr><p>ä¸ºäº†åšã€Œå¦‚æœå¥‡è¿¹æœ‰é¢œè‰²ã€ï¼Œå­¦ä¹ äº†åŠä¸ªå¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨ã€‚éå¸¸é¢“åºŸï¼Œè‚äº† 15 é¡µç”Ÿç‰©ã€‚</p><h2 id="mathcal-12-14"><a href="#mathcal-12-14" class="headerlink" title="$\mathcal{12.14}$"></a>$\mathcal{12.14}$</h2><hr><p>AC äº†ã€Œå¦‚æœå¥‡è¿¹æœ‰é¢œè‰²ã€ã€‚é¢˜è§£åœ¨ã€Œã€å­¦ä¹ ç¬”è®°ã€‘å¸¸ç³»æ•°é½æ¬¡çº¿æ€§é€’æ¨ã€é‡Œã€‚ç°åœ¨æƒ³å»æ•°æ•°ã€‚</p><p>åšäº†ã€Œçƒ·åŸºè®¡æ•°ã€ï¼Œé¢˜è§£åœ¨ã€Œã€å­¦ä¹ ç¬”è®°ã€‘ç”Ÿæˆå‡½æ•°ã€</p><h3 id="comet2280-å¦ä¸€é“æ ‘é¢˜"><a href="#comet2280-å¦ä¸€é“æ ‘é¢˜" class="headerlink" title="$comet2280-å¦ä¸€é“æ ‘é¢˜$"></a><a href="https://cometoj.com/contest/48/problem/D?problem_id=2280" target="_blank" rel="noopener">$comet2280-å¦ä¸€é“æ ‘é¢˜$</a></h3><p>è®¡æ•°è½¬æœŸæœ›ï¼ŒæœŸæœ›ç”¨æ•´æ•°æ¦‚ç‡å…¬å¼æ‹†åˆ†ã€‚è¿™æ ·å°±åŒ–â€œæ°å¥½â€ä¸ºâ€œè‡³å°‘â€äº†ï¼Œç°åœ¨æˆ‘ä»¬è¦ç»Ÿè®¡èµ° $i - 1$ æ­¥ä¸ä¼šèµ°åˆ°ä¸€å—çš„æ–¹æ¡ˆæ•°ã€‚åªè¦å¹¶æŸ¥é›†æŠŠèµ°åˆ°ä¸€å—çš„å¹¶èµ·æ¥ï¼Œæ–¹æ¡ˆæ•°å°±æ˜¯ $(\prod (siz + 1)) - n$ï¼Œæœ€åè¿˜è¦å‡å» $n$ã€‚</p><h3 id="PKUWC2018-Slay-the-Spire"><a href="#PKUWC2018-Slay-the-Spire" class="headerlink" title="[$PKUWC2018-Slay the Spire$]"></a>[$PKUWC2018-Slay the Spire$]</h3><p>è¿™æ˜¯ä¸€é“æ±‚å’Œé¢˜ã€‚<br>å‡è®¾é€‰äº† $i$ å¼ å¼ºåŒ–ç‰Œå’Œ $m - i$ å¼ æ”»å‡»ç‰Œ</p><ol><li>$i &lt; K$ï¼Œ$i$ å¼ å¼ºåŒ–ç‰Œï¼Œ$K - i$ å¼ æœ€å¤§çš„æ”»å‡»ç‰Œ</li><li>$i \geq K$ï¼Œ$K - 1$ å¼ æœ€å¤§çš„å¼ºåŒ–ç‰Œï¼Œä¸€å¼ æœ€å¤§çš„æ”»å‡»ç‰Œã€‚</li></ol><p>æ­£ç¡®æ€§æ˜“è¯ã€‚æ‰€ä»¥åªè¦ $dp$ å°±å¥½äº†ï¼Ÿ$f[i, j]$ è¡¨ç¤ºå‰ $i$ å¼ å¼ºåŒ–ç‰Œæ‘¸äº† $j$ å¼ çš„å€æ•°å’Œï¼Œ$g[i, j]$ è¡¨ç¤ºå‰ $i$ å¼ æ”»å‡»ç‰Œæ‘¸äº† $j$ å¼ çš„å’Œã€‚æ³¨æ„ $dp$ çš„æ—¶å€™å¦‚æœæ”»å‡»ç‰Œæ•° $j \leq m - (K - 1)$ï¼Œé‚£åªèƒ½å–ä¸€å¼ ç‰Œï¼Œä¸ºäº†æ–¹ä¾¿ $dp$ æˆ‘ä»¬æŠŠæ”»å‡»ç‰Œå‡åºæ’åºï¼Œè¿™æ ·å–çš„ç‰Œå°±æ˜¯å½“å‰è¿™å¼ ã€‚ç¬¬ä¸€ç»´å¯ä»¥å€’åºææ‰ã€‚</p><h2 id="mathcal-12-15"><a href="#mathcal-12-15" class="headerlink" title="$\mathcal{12.15}$"></a>$\mathcal{12.15}$</h2><hr><p>åšäº†ã€Œçƒ·çƒƒè®¡æ•°ã€ï¼Œé¢˜è§£åœ¨ã€Œã€å­¦ä¹ ç¬”è®°ã€‘ç”Ÿæˆå‡½æ•°</p><h3 id="æ‰¾æ ‘"><a href="#æ‰¾æ ‘" class="headerlink" title="$æ‰¾æ ‘$"></a><a href="https://loj.ac/p/6622" target="_blank" rel="noopener">$æ‰¾æ ‘$</a></h3><p>è¦ç†è§£é€ã€‚è§£æ³•æ˜¯çŸ©é˜µæ ‘çš„å˜å½¢åº”ç”¨ï¼šä¼—æ‰€å‘¨çŸ¥çŸ©é˜µæ ‘åªèƒ½æ±‚ç”Ÿæˆæ ‘ä¸ªæ•°å’Œç”Ÿæˆæ ‘è¾¹ç§¯å’Œã€‚è€ƒè™‘å…¨æ˜¯å¼‚æˆ–æ€ä¹ˆåšï¼Œå°±æ˜¯åŠ ä¸€ç»´ $a[x, y, z]$ è¡¨ç¤ºçŸ©é˜µ $[x, y]$ ä½ç½®å€¼ä¸º $[z]$ çš„ä¸ªæ•°ï¼Œé‚£ä¹ˆæ±‚è¡Œåˆ—å¼çš„æ—¶å€™ä¹˜æ³•å˜æˆ $FWT$ å°±è¡Œäº†ã€‚</p><p>ä½†ä½ æ€ä¹ˆå®šä¹‰ $FWT$ çš„é€†å…ƒï¼Ÿå¤ª $naive$ äº†è¿˜æ˜¯ï¼</p><p>å…ˆ $FWT$ï¼Œå¯¹äºæ¯ä¸ª $[z]$ æ±‚å‡ºè¡Œåˆ—å¼æ”¾åœ¨ç­”æ¡ˆæ•°ç»„é‡Œï¼Œå†æŠŠç­”æ¡ˆæ•°ç»„ $IFWT$ å›å»å°±å¥½äº†ã€‚å¤æ‚åº¦ $O(n^32^w + n^2w2^w)$ï¼Œ$1e9$ï¼Œåœ¨æ±‚è¡Œåˆ—å¼é‚£é‡Œç‰¹åˆ¤ä¸€ä¸‹å¦‚æœå‡ºç° $0$ å°±ç›´æ¥è¿”å› $0$ï¼Œå°± $AC$ äº†ã€‚è¿™æ˜¯æ€ä¹ˆä¸€å›äº‹å‘¢ï¼Œå°ç¼–ä¹Ÿå¾ˆæƒŠè®¶ã€‚</p><h3 id="å¸Œæœ›"><a href="#å¸Œæœ›" class="headerlink" title="$å¸Œæœ›$"></a><a href="https://loj.ac/p/3053" target="_blank" rel="noopener">$å¸Œæœ›$</a></h3><p>å†™åœ¨ã€ŒåäºŒçœè”è€ƒã€ã€‚</p><h2 id="mathcal-12-16"><a href="#mathcal-12-16" class="headerlink" title="$\mathcal{12.16}$"></a>$\mathcal{12.16}$</h2><hr><p>æ¸æ¸ï¼Œå¯¹äºå®‰é€¸äº«ä¹çš„äººå®ƒæ˜¯ä¸€æ¡é•¿é•¿çš„ä¸‹å¡è·¯ï¼Œé€šå‘æ·±æ¸Šï¼›å¯¹äºä¸Šè¿›çš„äººå®ƒæ˜¯ä¸€æ¡é•¿é•¿çš„é˜¶æ¢¯ï¼Œé€šå‘å¤©å ‚ã€‚</p><p>ä¸ºäº†ä¸æ»‘è¿›æ·±æ¸Šæˆ‘åªæœ‰æ‹¼å°½å…¨åŠ›ã€‚<strong>æˆ‘è¦ç»ˆæ­¢çœ‹é¢˜è§£çš„ä¸è‰¯ä¹ æƒ¯â€”â€”å†è¿™æ ·ä¸‹å»ï¼Œxmlï¼Œä½ ä¼šå…‰é€Ÿé€€å½¹çš„ã€‚</strong></p><p>cometç¬¬å…­åœº Eï¼Œuoj311ï¼Œuoj370ï¼Œuoj316ï¼Œloj2570, vp ä¸€åœº cfï¼ˆå“¼ï¼Œç—´äººè¯´æ¢¦ï¼‰</p><h3 id="LOJ6356-å››è‰²ç¯"><a href="#LOJ6356-å››è‰²ç¯" class="headerlink" title="$LOJ6356-å››è‰²ç¯$"></a><a href="https://loj.ac/p/6356" target="_blank" rel="noopener">$LOJ6356-å››è‰²ç¯$</a></h3><p>$O(nm)$ æ˜¯éå¸¸å¥½åšçš„å•Šï¼Œç®—å‡ºæ¯ä¸ªä½ç½®è¢«ç»è¿‡çš„æ¬¡æ•° $cnt$ï¼Œè´¡çŒ®å°±æ˜¯ $\sum_k C(cnt, 4k) * 2^{m - cnt}$</p><p>è€ƒè™‘ $cnt \in [0, 20]$ï¼Œæˆ‘ä»¬æšä¸¾é€‰äº†å“ªäº› $x_i$ã€‚è®¾è¯¥é›†åˆä¸º $s$ï¼Œé‚£ä¹ˆè¢« $lcm(x \in S)$ ç»è¿‡çš„ç‚¹åº”å½“æœ‰è´¡çŒ®ã€‚ä½†æ˜¯å¯¹äº $s \subset sâ€™$ï¼Œ$sâ€™$ ç»è¿‡çš„ç‚¹ $s$ ä¹Ÿç»è¿‡äº†ï¼Œæ‰€ä»¥éœ€è¦å®¹æ–¥å‡ºè¢« $s$ ç»è¿‡ä¸”ä¸è¢«ä»»ä½• $s$ çš„è¶…é›†ç»è¿‡çš„ç‚¹ä¸ªæ•°ï¼Œè¡¨ç¤ºä¸º $g[s]$ã€‚</p><p>ç›´æ¥æšä¸¾è¶…é›† $O(3^m)$ï¼ŒTLEï¼›è€ƒè™‘è¿›ä¸€æ­¥ä¼˜åŒ–ã€‚å†™å‡ºæŸ¿å­ï¼š$\sum_s g[s] \sum_k C(|S|, 4k) * 2^{m - |S|}$ï¼Œå‘ç° $|S|$ ç›¸åŒçš„å¯ä»¥æ‹¢åˆ°ä¸€èµ·ã€‚è®¾ $G[i] = \sum\limits_{|S| = i} g[s]$ï¼Œ$G$ å¾ˆå®¹æ˜“å®¹æ–¥å¾—åˆ°ï¼Œæ¯”å¦‚ $j &gt; i$ï¼Œè€ƒè™‘ $G[j]$ å¯¹ $G[i]$ çš„å®¹æ–¥è´¡çŒ®ï¼Œåªæ˜¯æŠŠåŸå…ˆåˆ†é¡¹å¹¶åˆ°äº†ä¸€èµ·ï¼Œä¹˜ç»„åˆæ•° $C(j, i)$ å°±å¥½ã€‚</p><p><a href="https://loj.ac/s/1013566" target="_blank" rel="noopener">$Code$</a></p><h2 id="mathcal-12-17"><a href="#mathcal-12-17" class="headerlink" title="$\mathcal{12.17}$"></a>$\mathcal{12.17}$</h2><hr><p>æ„Ÿè§‰åšäº‹åƒæœ‰é˜»åŠ›ä¸€æ ·ã€‚è¿™é˜»åŠ›æ¥è‡ªå“ªé‡Œï¼Ÿè¿‡äºæ³¨é‡å½¢å¼ï¼Œä¾¿é¢“åºŸäº†ã€‚è¿™é˜»åŠ›ä¹Ÿæ˜¯çŠ¹è±«ä¸å†³ï¼Œæ˜¯è‡ªæˆ‘æ€€ç–‘ï¼Œè™½ç„¶å·²ç»æ¯”å‰å‡ ä¸ªæœˆçš„æˆ‘ç—‡çŠ¶è½»å¤šäº†ã€‚åŒè„šå¾€å‰æŠµç€æ€ä¹ˆä¼šèµ°çš„å¿«ã€èµ°å¾—è½»æ¾å‘¢ï¼Ÿ</p><p>çœ‹é¢˜è§£è¿™ä¸ªäº‹æƒ…ï¼Œæœ¬è´¨æ˜¯æ€¥äºæ±‚æˆï¼Œä½†åªæ˜¯ä¸€æ—¶ä¹‹åˆ©ï¼Œäºé•¿è¿œåˆ™æ˜¯é€€å½¹çš„åŠ é€Ÿå™¨ã€‚æ€è€ƒçš„å……åˆ†ä¸€ç‚¹ï¼Œä¸€é“é¢˜åšå‡ ä¸ªå°æ—¶ä¹Ÿæ˜¯ä¸äºçš„ã€‚<strong>åŠ¡å¿…ä»ç°åœ¨å¼€å§‹åŠ å¼ºç‹¬ç«‹æ€è€ƒï¼ï¼ï¼</strong></p><p>æœºæˆ¿çš„å¤§ç¯å¢ƒä¸æˆ‘æ˜¯ä¸¤ä¸ªä¸–ç•Œï¼Œå¸¦ä¸Šè€³å¡ï¼Œæ²‰æµ¸åœ¨è‡ªå·±çš„æ¢ç©¶ä¸­ã€‚å…¥ç¥æ—¶ä¾¿ä¸å—å¤§ç¯å¢ƒå½±å“äº†ã€‚</p><p>åšé¢˜é‡è¦é‡‡å–ç­–ç•¥æ¥ä¿è¯ï¼Œä¸€å¤©ä¸€å¥— CFã€‚æˆ‘æ˜¯è¯´ï¼Œåœ¨å­¦æ•°å­¦çš„åŒæ—¶ä¹Ÿåˆ«å¿˜äº† CFï¼Œä½ çœ‹ zjyã€kqh CF éƒ½åˆ‡çš„å¾ˆå¤šã€‚åšå¥½é¢˜ï¼Œä¸è¦åšç½‘çº¢é¢˜ï¼Œè¦æŒ‰ç…§è‡ªå·±çš„å¼±ç‚¹æ¥é€‰é¢˜ã€‚æœ€è¿‘çš„çœé€‰æ¨¡æ‹Ÿèµ›ï¼Œæ‰“æ»¡æ—¶é—´æ„Ÿè§‰ä¸ç°å®ï¼Œä½†æ¯é“é¢˜éƒ½è¦æ€è€ƒé€ã€‚</p><p>å†™é¢˜ï¼Œæ€è€ƒé€å†å¼€ç ã€‚</p><p>æ¯å¤©åšæŒç€å……å®ç€ï¼Œæœ‰ä»˜å‡ºæœ‰æ”¶è·ï¼Œä¸€åˆ‡éƒ½ä¼šå˜å¥½çš„ï¼ï¼ï¼ï¼ˆæœ€è¿‘å°±æ˜¯æ•ˆç‡ä½ä¸‹ï¼Œæ„Ÿåˆ°ç©ºè™šäº†ã€‚</p><p>åŠ³è°¦å›å­ï¼Œæœ‰ç»ˆå‰ã€‚</p><h3 id="XJOI1626-T3"><a href="#XJOI1626-T3" class="headerlink" title="$XJOI1626 T3$"></a>$XJOI1626 T3$</h3><p>$n = 50$ æ˜¯ $TC$ åŸé¢˜ã€‚ä½†æ˜æ˜¾å¯ä»¥ä¼˜åŒ–å˜›ã€‚å‘ç°ç“¶é¢ˆåœ¨äºå®¹æ–¥æ—¶å¹¶æŸ¥é›†çš„æ“ä½œã€‚æƒ³åˆ°æ¯ä¸€ä½å»ºè™šç‚¹ã€‚è¿é€šå—æ•°ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šè¢«é€‰çš„è™šç‚¹å’Œä¸å®ƒç›¸è¿çš„ç‚¹ä»¬ï¼Œæ²¡è¢«é€‰çš„ç‚¹ä»¬ã€‚å¤§æ¦‚å¯ä»¥é«˜ç»´å‰ç¼€å’Œã€‚ï¼ˆé«˜ç»´å‰ç¼€å’Œè¿™ä¸ªä¸œè¥¿å°±æ˜¯ FMT å•¦ã€‚</p><h3 id="XJOI1627"><a href="#XJOI1627" class="headerlink" title="$XJOI1627$"></a>$XJOI1627$</h3><h4 id="T1"><a href="#T1" class="headerlink" title="$T1$"></a>$T1$</h4><p>ç»å…¸å¥—è·¯ï¼Œæ ‘ä¸Šè·¯å¾„é—®é¢˜è€ƒè™‘è¾¹åˆ†æ²»æˆ–è€…ç‚¹åˆ†æ²» + å †ã€‚æˆ‘åŸæ¥å†™çš„è¾¹åˆ†ï¼Œä¹Ÿå¯ä»¥å§ï¼Œä½†æ˜¯ç‚¹åˆ†å¤šé¦™å•Šï¼Œä¸ç”¨ä¸‰åº¦åŒ–ã€‚</p><p>ä¸ºä»€ä¹ˆä¸èƒ½å¯¹æ¯ä¸ªé‡å¿ƒå°†å­æ ‘å¤§å°æ’åºç®—ç­”æ¡ˆï¼Ÿæ¯ä¸ªé‡å¿ƒä¸¢ $K$ ä¸ªè·ç¦»åˆ°ç­”æ¡ˆå †é‡Œï¼Œå †ä¸å¾—ç‚¸æ‰ã€‚ã€‚å¤æ‚åº¦ä¹Ÿä¸å¯¹å˜›ã€‚â€”â€”é‚£å°±åˆ«æ€¥ç€ç®—å‡ºå½“å‰æœ€ä¼˜å•Šï¼Œä¸å¦‚æŠŠæ‰€æœ‰é‡å¿ƒå…¨éƒ¨è·‘å®Œå†ç®—æœ€ä¼˜ã€‚è¿™å°±æ˜¯è¶…çº§é’¢ç´çš„å¥—è·¯äº†ã€‚</p><p>å¯¹æ¯ä¸ªé‡å¿ƒï¼Œå®ƒçš„å­æ ‘ä¸­ç‚¹çš„è¿è¾¹æƒ…å†µæ˜¯ä¸€ä¸ªåŒºé—´ã€‚ä¸¢åŒºé—´è¿›å †ï¼Œ$st$ è¡¨ç»´æŠ¤ $\max$ã€‚æ¯æ¬¡å–åŒºé—´ï¼Œç»Ÿè®¡ç­”æ¡ˆï¼Œè£‚æˆä¸¤åŠã€‚</p><p>ç‚¹åˆ†æ²»çš„ä¼˜ç‚¹åœ¨å“ªå„¿å‘¢ï¼Ÿç‚¹å’Œç‚¹çš„è·ç¦»å¯ä»¥ç›´æ¥ç›¸åŠ å¾—å‡ºã€‚$O(nlog^2n + mlogn)$ï¼ŒAC ä¸äº†å°±å¾ˆéš¾å—ã€‚</p><p>updï¼šè¿™é¢˜é‡ç‚¹åœ¨è¶…çº§é’¢ç´å•Šï¼Œå‰é¢çš„æœ‰ä¸€ç™¾ç§åšæ³•ï¼Œåªè¦ä¿è¯è·ç¦»å¯ä»¥ç›´æ¥ç›¸åŠ å¾—å‡ºå°±å¥½ã€‚ç®€å•çš„ dfs åºä¸Šè·‘ä¹Ÿå¯ä»¥é¢ã€‚æˆ–è€…çº¿æ®µæ ‘ç»´æŠ¤ç›´å¾„é›†åˆã€‚</p><h4 id="T2"><a href="#T2" class="headerlink" title="$T2$"></a>$T2$</h4><p><a href="https://www.cnblogs.com/chdy/p/13114664.html" target="_blank" rel="noopener">é¢˜è§£</a></p><p>æˆ‘æƒ³äº†ä¸ª $O(\frac{n^4}{32})$ çš„ bitset å‡åšæ³•ï¼Œè¢«å¤§æ†ç»‘æ€äº†</p><p>çœ‹åˆ°è¿™ä¸ªçŸ©é˜µé‡Œæ’åˆ—çš„å½¢å¼å®¹æ˜“æƒ³åˆ°è¡Œåˆ—å¼çš„å®šä¹‰ï¼Œåˆ©ç”¨æŒ‡æ•°åŒ–åŠ ä¸ºä¹˜ï¼Œå¾—åˆ°ä¸€ä¸ªé¡¹æ•°ä¸º $nk$ çš„å¤šé¡¹å¼ï¼Œæˆ‘ä»¬åªå…³å¿ƒ $k$ çš„å€æ•°é¡¹ç³»æ•°æ˜¯å¦æœ‰ä¸ä¸º $0$ çš„ã€‚ä½†æ˜¯ç›´æ¥ç…§ç€ç®—è¡Œåˆ—å¼æ˜¯ä¸å¯¹çš„ï¼Œå› ä¸ºè¡Œåˆ—å¼æŸ¿å­é‡Œæœ‰ä¸ª $(-1)^{é€†åºå¯¹æ•°}$ çš„ç©æ„ï¼Œå¾ˆå®¹æ˜“æŠµæ¶ˆã€‚</p><p>ç›´æ¥ä¹˜ä¸€ä¸ª $rand$ å°±å¯ä»¥å•¦ï¼</p><p>ç„¶åä¹Ÿä¸ç”¨çœŸçš„æ‹‰æ ¼æœ—æ—¥æ’å€¼ï¼Œå¯ä»¥ç”¨å•ä½æ ¹çš„ç¥å¥‡æ€§è´¨ä¼˜åŒ–ã€‚å¾€é‡Œå¸¦ $mod - 1$ çš„ $K$ æ¬¡å•ä½æ ¹ $wn$ï¼Œå…¶ä¸­ $mod = vk + 1$ï¼Œå¸¦ $k$ æ¬¡ã€‚æ­£ç¡®æ€§è§å¤§ä½¬åšå®¢ï¼Œorzï¼</p><p>äº¤äº† $114514$ æ¬¡æ‰è¿‡çš„ã€‚å¤§æ†ç»‘æˆ‘åï¼</p><h4 id="T3"><a href="#T3" class="headerlink" title="$T3$"></a>$T3$</h4><p>ä¸€ä¸ªå¾ªç¯èŠ‚ $2$ çš„ä¸²ä¼šè¢« $4$ çš„æ—¶å€™å†ç»Ÿè®¡ä¸€æ¬¡ï¼Œè€ƒè™‘åæ¼”å‡ºæ¥ï¼š$f[i, j]$ è¡¨ç¤ºä»¥ $i$ ä¸ºç»“å°¾çš„ä¸²ï¼Œå¾ªç¯èŠ‚æ°å¥½ä¸º $j$ çš„ä¸ªæ•°ï¼Œ$g[i, j]$ è¡¨ç¤ºä»¥ $i$ ä¸ºèŠ‚ç‚¹çš„ä¸²ï¼Œå¾ªç¯èŠ‚æ˜¯ $j$ çš„å› æ•°çš„ä¸ªæ•°ã€‚é‚£ä¹ˆæ˜¾ç„¶æœ‰ $g[i, j] = \sum\limits_{d | j} f[i, d]$, $f[i, j] = \sum\limits_{d | j} g[i, d] * \mu(\frac{j}{d})$ã€‚ç­”æ¡ˆæ˜¯ $C(n + 1, 2) - \sum{f[i, j]}$ï¼Œç°åœ¨è€ƒè™‘æ€ä¹ˆç®— $g$.</p><p>æšä¸¾ $d$ï¼ŒæŠŠæ•´ä¸ªä¸²åˆ’åˆ†ä¸ºé•¿åº¦ä¸º $d$ çš„å—ï¼Œå—ä¸å—ä¹‹é—´çš„ä½ç½®æˆ‘ä»¬ç§°ä¸ºå…³é”®ç‚¹ï¼Œç®—å‡ºç›¸é‚»å…³é”®ç‚¹å‘å·¦çš„æœ€é•¿å…¬å…±åç¼€å’Œå‘å³çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚è¦ç›¸åŠ  $\geq d$ æ‰è¡Œï¼Œç»´æŠ¤åˆ°å½“å‰å—çš„æœ€é•¿åˆæ³•å—ä½ç½®å°±å¥½äº†ï¼Œæ˜¯ $O(nlogn)$ çš„ï¼$hehezhou$ $nb$ï¼ï¼ï¼</p><p>è¿˜æœ‰ä¸€ç§åšæ³•å°±æ˜¯å‘ç°æŸä¸ªç­”æ¡ˆä¸²å¿…ç„¶åŒ…å«äº† $Lyndon\ root$ï¼Œç„¶åè·‘ $Runs$ã€‚ï¼ˆè™½ç„¶æ²¡å¬æ‡‚ä½†è¿˜æ˜¯è¦è®°ä¸‹æ¥</p><h3 id="ZJOI2020-ä¼ ç»Ÿè‰ºèƒ½"><a href="#ZJOI2020-ä¼ ç»Ÿè‰ºèƒ½" class="headerlink" title="$ZJOI2020-ä¼ ç»Ÿè‰ºèƒ½$"></a><a href="https://loj.ac/p/3312" target="_blank" rel="noopener">$ZJOI2020-ä¼ ç»Ÿè‰ºèƒ½$</a></h3><p>å’Œ 19 å¹´çš„ä¸€æ ·è®¨è®ºå•Šã€‚ã€‚$K$ å¦‚æ­¤ä¹‹å¤§ï¼Œåˆ—å‡º $dp$ æ–¹ç¨‹åå®¹æ˜“æƒ³åˆ°çŸ©é˜µå¿«é€Ÿå¹‚å§ã€‚ç®—æ˜¯ 2.0 ç‰ˆæœ¬å§ï¼Œä¾æ—§è§‰å¾—ç»´æŠ¤è¿™äº”ä¸ªé‡â€”â€”è®¿é—®ç¥–å…ˆ/è‡ªå·±/å­æ ‘/å…„å¼Ÿ/ä¸äº¤ï¼ŒæŒºå·§å¦™çš„ã€‚$O(n3^3logK)$</p><p><a href="https://loj.ac/s/1014629" target="_blank" rel="noopener">$Code$</a></p><h2 id="mathcal-12-18"><a href="#mathcal-12-18" class="headerlink" title="$\mathcal{12.18}$"></a>$\mathcal{12.18}$</h2><hr><p>åˆšåˆšå»å¬äº†èŒä¸šè§„åˆ’çš„è®¡ç®—æœºä¸“åœºã€‚é«˜è–ªã€åˆ›æ–° å¤§æ¦‚æ˜¯ä¸€äº›å…³é”®è¯å§ã€‚ç†ç§‘è¦å¥½ã€‚èŒä¸šçš„æ´»åŠ¨æ€§å¾ˆå¤§ï¼ˆæˆ‘åœ¨è¯´ä»€ä¹ˆå•Šï¼‰å¯èƒ½æ€§å¾ˆå¤šã€‚ä¸»è¦æ˜¯åšå¤§æ•°æ®ï¼Œç½‘ç»œä¹‹ç±»çš„ã€‚è¯´å®è¯ç›®å‰çœŸæ²¡ä»€ä¹ˆå…´è¶£ã€‚å•è®ºå…´è¶£çš„è¯æœ€ç°å®çš„åº”è¯¥æ˜¯å°æç´å§ï¼ˆä½ è¿½çš„ä¸Šäººå®¶ä¸“ä¸šç”Ÿå˜›ï¼‰è¿˜æ²¡æƒ³å¥½ï¼Œæ€»ä¹‹å…ˆèµ°ç€å§ï¼Œâ€œå¦‚æœæ²¡æœ‰å‘ï¼Œå°±å…ˆè®©è‡ªå·±æˆä¸ºèåœâ€ã€‚</p><h3 id="UOJ549-åºåˆ—å¦™å¦™å€¼"><a href="#UOJ549-åºåˆ—å¦™å¦™å€¼" class="headerlink" title="[$UOJ549-åºåˆ—å¦™å¦™å€¼$]"></a>[$UOJ549-åºåˆ—å¦™å¦™å€¼$]</h3><p>åˆ† subtask dp æœ‰ 60 åˆ†ã€‚æ­£è§£æ€ä¹ˆåšï¼Ÿçœ‹åˆ° $2^8$ å’Œ $2^{16}$ï¼Œå®¹æ˜“æƒ³åˆ°å€¼åŸŸåˆ†å—ï¼Œé«˜ä½å…«ä½åˆ†å—åšï¼ˆâ€”â€”è¯´èµ·æ¥è¿˜æ˜¯åœ¨ä»Šå¹´åˆèµ›ç¬¬ä¸€æ¬¡ç¢°è§çš„è¿™ç§å¥—è·¯= = æœç„¶å¤ªé—­å¡äº†ï¼‰$f[i, j, s1, s2]$ è¡¨ç¤ºå‰ $i$ ä½ï¼Œåˆ† $j$ æ®µï¼Œé«˜å…«ä½å‰ç¼€å¼‚æˆ–å€¼æ˜¯ $s1$ï¼Œé¢„è®¡ä¸‹ä¸€ä¸ªè½¬ç§»çš„æ•°ä½å…«ä½ä¸º $s2$ã€‚æœ¬è´¨è¿˜æ˜¯å‡æ‘Šå¤æ‚åº¦ã€‚</p><h2 id="mathcal-12-20"><a href="#mathcal-12-20" class="headerlink" title="$\mathcal{12.20}$"></a>$\mathcal{12.20}$</h2><hr><h3 id="XJOI1629"><a href="#XJOI1629" class="headerlink" title="$XJOI1629$"></a>$XJOI1629$</h3><h4 id="T1-1"><a href="#T1-1" class="headerlink" title="$T1$"></a>$T1$</h4><p>éª—äº† 20 åˆ†ã€‚ã€‚= = æ„Ÿæ€§ç†è§£ä¸‹æœ€ä¼˜è§£ä¸€å®šæ˜¯ $max$ é‡Œçš„ $\sum$ ç›¸ç­‰çš„æƒ…å†µï¼ˆæ­£è§£å‘Šè¯‰ä½ å°±æ˜¯ä¸€å †ä¸€æ¬¡å‡½æ•°çš„äº¤ç‚¹ï¼‰ï¼Œç›´æ¥ $n^3$ é«˜æ–¯æ¶ˆå…ƒè§£æ–¹ç¨‹å°±èƒ½è·å¾— $60$ åˆ†çš„å¥½æˆç»©ã€‚</p><p>å…³äºæ­£è§£â€”â€”åˆ†æ²»ï¼ˆ$height$ ä¸Šå»ºç¬›å¡å°”æ ‘ï¼‰æ˜¯ç¥ï¼Œä» $height$ æœ€å°å¤„åˆ’æˆä¸¤åŠï¼Œåˆ† $k$ å°±å…ˆåˆ†ç»™ä¸€è¾¹ $1$ï¼Œå¤šäº†å¯ä»¥åšå®Œåä¹˜æ¯”ä¾‹ï¼Œè¿™ä¸ªä¹Ÿè¶…å¦™ã€‚åˆ†é…çš„æ¯”ä¾‹è¶Šå¤§ï¼Œ$max$ è¶Šå¤§ï¼Œæ¯”ä¾‹ä¸ $max$ æˆæ­£æ¯”ï¼Œè¿™è¿˜æ˜¯æ˜¾ç„¶çš„ã€‚</p><p>å·¦å³åˆå¹¶ï¼Œç­”æ¡ˆæ˜¯ $max( lans * x + (1 - x) * h, rans * (1 - x) + x * h )$ï¼Œæ˜¯ä¸¤ä¸ªä¸€æ¬¡å‡½æ•°ï¼Œå¿…ç„¶å­˜åœ¨ä¸€ä¸ªäº¤ç‚¹ï¼Œå³ä¸¤è€…ç›¸ç­‰ï¼Œå°±æ˜¯æœ€å°å€¼ï¼Œè§£æ–¹ç¨‹ç®— $x$ã€‚</p><p>ä¹Ÿå¯ä»¥ç”¨ $SAM$ çš„ $parent$ æ ‘ï¼Œæ ‘å½¢ $dp$ï¼Œåˆå¹¶ä¸¤ä¸ªå­æ ‘çš„æ—¶å€™è·Ÿä¸Šé¢ä¸€æ ·åˆ†é…æ¯”ä¾‹ã€‚</p><h4 id="T2-1"><a href="#T2-1" class="headerlink" title="$T2$"></a>$T2$</h4><p>hhz è®²äº†ä»çŸ©é˜µå¿«é€Ÿå¹‚åˆ‡å…¥çš„æ–¹æ³•ï¼Œä¸æ–­ä¼˜ä¼˜ä¼˜åŒ–ã€‚</p><p>é¦–å…ˆè€ƒè™‘æœ¬è´¨ä¸åŒå­åºåˆ—æ€ä¹ˆ $dp$ï¼š$dp[i]$ è¡¨ç¤ºä»¥ $i$ ç»“å°¾çš„æœ¬è´¨ä¸åŒå­åºåˆ—ä¸ªæ•°ï¼Œ$dp[i] = 1 + \sum\limits_{j = 1}^n dp[lst_j]$</p><p>ä¹˜æ³•æ˜¯ä¸€ä¸ªåˆ—å‘é‡ä¹˜ä¸€ä¸ªè½¬ç§»çŸ©é˜µçš„å½¢å¼ï¼Œåˆ—å‘é‡é‡Œè®°å½•çš„æ˜¯ $dp[lst_1]$, $dp[lst_2]$, â€¦ $dp[lst_m]$, $1$ã€‚è½¬ç§»çŸ©é˜µæœ‰ä¸€è¡Œå…¨æ˜¯ $1$ï¼Œè¿™æ ·é•¿çš„ç‰¹æ®Šçš„çŸ©é˜µå¾ˆç¨€ç–ï¼Œåªæœ‰ $O(n)$ ä¸ªä½ç½®ä¸º $1$ï¼Œä¹˜æ³•å¤æ‚åº¦å°±å˜çº¿æ€§äº†ã€‚è¯¢é—®ç¦»çº¿åšå³å¯ã€‚</p><h4 id="T3-1"><a href="#T3-1" class="headerlink" title="$T3$"></a>$T3$</h4><p>åŠ ä¸€ç»´æ—¶é—´ã€‚é‚£æ¯ä¸ªæ“ä½œå°±æ˜¯ä¸€ä¸ªé¢ä¸Šçš„ä¸€ä¸ªçŸ©å½¢ï¼Œæ¯æ¬¡è¯¢é—®ç©¿è¿‡ä¸€äº›çŸ©å½¢ã€‚è€ƒè™‘å¯¹äºä¸€æ¡çº¿ï¼Œç©¿è¿‡çš„æœ‰çŸ©å½¢è¦†ç›–çš„ç‚¹ $(p, q)$ï¼Œæ— çŸ©å½¢è¦†ç›–çš„ $(1, 0)$ï¼Œå°±çº¿æ®µæ ‘ç»´æŠ¤ã€‚</p><p>ç§»åŠ¨æ˜¯ $O(log)$ çš„ï¼Œè«é˜Ÿå¯ä»¥åšåˆ° $O(n\sqrt(n)logn)$ï¼Œ$kd-tree$ å¯ä»¥åšåˆ° $O(n\sqrt(n))$ï¼ˆä¸€æ—¶å£èƒ¡ä¸€æ—¶çˆ½</p><h3 id="THUSC2016-æˆç»©å•"><a href="#THUSC2016-æˆç»©å•" class="headerlink" title="$THUSC2016-æˆç»©å•$"></a><a href="https://loj.ac/p/2292" target="_blank" rel="noopener">$THUSC2016-æˆç»©å•$</a></h3><p>ç¥ä»™é¢˜ï¼Ÿ</p><p>é¦–å…ˆè‚¯å®šæ˜¯åŒºé—´ dpã€‚æœ€ååˆ é™¤çš„æ˜¯ä¸€ä¸ªé¢œè‰²åŒºé—´çš„ç‰©å“ï¼Œæ ¹æ®è¿™ä¸ªåˆ é™¤çš„è§„å¾‹æ¥è®¾è®¡æ–¹æ¡ˆã€‚</p><p>$f[i, j, l, r]$ è¡¨ç¤º $[i, j]$ åªå‰©ä¸‹ $[l, r]$ é¢œè‰²åŒºé—´çš„ç‰©å“æ²¡åˆ çš„æœ€å°ä»£ä»·, $g[i, j]$ è¡¨ç¤º $[i, j]$ åŒºé—´æ¶ˆå®Œäº†çš„æœ€å°ä»£ä»·ã€‚è½¬ç§» $f$ï¼Œæœ‰ä¸¤ç§ï¼šä¸€æ˜¯ $j$ å’Œä¹‹å‰çš„å¹¶ä¸€èµ·ï¼›äºŒæ˜¯æšä¸¾æ–­è£‚ç‚¹ã€‚<br>ç¬¬äºŒç§æƒ…å†µè¦åˆ†ç±»è®¨è®º $[l, r]$ é¢œè‰²åŒºé—´çš„ç‰©å“åˆ†æ•£åœ¨æ–­è£‚ç‚¹çš„å“ªä¸€è¾¹ï¼š1. åªæœ‰å·¦ 2. åªæœ‰å³ 3. ä¸¤è¾¹éƒ½æœ‰</p><h2 id="mathcal-12-21"><a href="#mathcal-12-21" class="headerlink" title="$\mathcal{12.21}$"></a>$\mathcal{12.21}$</h2><hr><h3 id="XJOI1630"><a href="#XJOI1630" class="headerlink" title="$XJOI1630$"></a>$XJOI1630$</h3><h4 id="T1-2"><a href="#T1-2" class="headerlink" title="$T1$"></a>$T1$</h4><p>æˆ‘æ˜æ˜å†™çš„å°±æ˜¯å€å¢å˜›(;Â´à¼àº¶Ğ”à¼àº¶`) æƒ¨æ­»äº†ï¼Œæš´åŠ›éƒ½ WA é£äº†ã€‚å€å¢å°±ä¸€æ­¥ä¸€æ­¥è·³ï¼Œä¸è¦å­¦ xml æ€¥äºæ±‚æˆä¸€æ¬¡è·³ä¸€å—å¯¼è‡´å…¨æ˜¯é”™çš„ã€‚</p><h4 id="T2-2"><a href="#T2-2" class="headerlink" title="$T2$"></a>$T2$</h4><p>å†™äº† $40$ åˆ†ï¼Œ$XJ$ åˆyÃ²uåŒshuÄngå’ruÃ²å•zhuÃ³æ²¡æœ‰ $SPJ$ï¼ï¼ˆupdï¼šè¡¥äº†ã€‚æ„ŸåŠ¨ã€‚ï¼‰</p><p>æ­£è§£æ˜¯æœ€å°åœ†è¦†ç›–ï¼ŒåŠå¾„çš„ä¸Šç•Œå¿…ç„¶æ˜¯çœ‹ä½œåŒä¸ªå¹³é¢ä¸Šæ—¶è¦†ç›–äº†æ‰€æœ‰ç‚¹çš„æœ€å°åœ†åŠå¾„ï¼Œæšä¸¾é«˜åº¦ï¼ŒåŠå¾„çš„å‡å°é‡éšç€é«˜åº¦çš„å¢åŠ è€Œå‡å°ã€‚ä¼—æ‰€å‘¨çŸ¥æœ€å°åœ†è¦†ç›–å¤æ‚åº¦ $O(n)$ï¼Œå› ä¸ºä¸€ä¸ªç‚¹è´¡çŒ®åˆ°åœ†ä¸Šçš„æœŸæœ›æ˜¯ $\frac{3}{i}$ã€‚</p><h4 id="T3-2"><a href="#T3-2" class="headerlink" title="$T3$"></a>$T3$</h4><p>$40$ åˆ† $Tarjan$ ç¼©è¾¹åŒã€‚è®°å¾—åˆ¤è¿›æ¥çš„è¾¹å•Šï¼æ­£è§£æ˜¯ LCTï¼Œé“¾èµ‹å€¼ã€‚</p><p><a href="https://www.luogu.com.cn/problem/P5489" target="_blank" rel="noopener">æŒ‡è·¯</a></p><h3 id="LOJ6611-æ‘§æ¯æ—¶é—´çº¿"><a href="#LOJ6611-æ‘§æ¯æ—¶é—´çº¿" class="headerlink" title="$LOJ6611-æ‘§æ¯æ—¶é—´çº¿$"></a><a href="https://loj.ac/p/6611" target="_blank" rel="noopener">$LOJ6611-æ‘§æ¯æ—¶é—´çº¿$</a></h3><p>æœ‰ sb $18$ åˆ†åšæ³•â€”â€”çŠ¶å‹ã€‚ä¸è¦å‚»æ‰äº†å•Šï¼å¦‚æœæ²¡æœ‰ $i + 1$ å’Œ $i + 2$ çš„è¦æ±‚ï¼Œæ˜¾ç„¶å¯ä»¥åŒºé—´ $dp$ å•Šï¼Œ$f[i, j]$ è¡¨ç¤º $[i, j]$ æ¯” $i - 1$ å’Œ $j + 1$ å…ˆæ¶ˆã€‚<br>è€ƒè™‘ $i + 1$ å’Œ $i + 2$ï¼Œä¿¡æ¯å¤šäº†ï¼Œå¤šè®°å½•å‡ ç»´å°±è¡Œ:<br>$f[i, j, t, u]$ è¡¨ç¤º $[i, j]$ æ—©äº $i - 1$ å’Œ $j + 1$ è¢«åˆ ï¼Œ$i + 2$ æ˜¯ $t$ï¼Œ$[i, u)$ éƒ½è¦æ—©äº $u$ è¢«åˆ ã€‚å…¶ä¸­ $[i, j]$ çš„æ–­è£‚ç‚¹ $k \in [u, j]$. $O(n^6)$</p><p><a href="https://loj.ac/s/1016858" target="_blank" rel="noopener">$Code$</a></p><h3 id="UOJ165-Flea"><a href="#UOJ165-Flea" class="headerlink" title="$UOJ165-Flea$"></a><a href="https://uoj.ac/problem/165" target="_blank" rel="noopener">$UOJ165-Flea$</a></h3><p>å¥½å¦™ã€ç—´å‚»ã€‘å¤æ‚åº¦è‚¯å®šæ˜¯å»å’Œ $n$ æ‰¯å…³ç³»çš„ã€‚</p><p>æˆ‘ä»¬ä¸€ä¸ªä¸€ä¸ªå‡½æ•°åŠ å…¥ã€‚è¿™æ˜¯ä¸ªåˆ†æ®µäºŒæ¬¡å‡½æ•°ã€‚ä¸€ä¸ªå¾ˆé‡è¦çš„äº‹æƒ…ï¼šå‡½æ•°åªæœ‰ $n$ æ®µã€‚å¯¹æ¯æ®µå•ç‹¬åšâ€”â€”æ˜¾ç„¶æˆ‘ä»¬åªå…³æ³¨ç«¯ç‚¹ã€‚<br>äºŒåˆ†ç«¯ç‚¹ä½ç½® $x$ ç„¶åæ›´æ–° $x$ çš„ç­”æ¡ˆã€‚</p><p>è¯¢é—®å¾ˆçè´µï¼Œé€‰å“ªä¸ªç‚¹è¯¢é—®å‘¢ï¼Ÿå‡è®¾å½“å‰åœ¨é—®ç¬¬ $i$ ä¸ªå‡½æ•°ï¼ˆä¸è¦æ±‚æŒ‰é¡ºåºæ¥ï¼‰ï¼Œé€‰å‰ $i - 1$ æ¬¡è·³å¾—æœ€é«˜çš„è·³èš¤ï¼›è‹¥è·å¾—çš„å‡½æ•°ä¸ä¹‹å‰ç›¸åŒé‚£è¯¥è·³èš¤é«˜åº¦å°±æ˜¯ç­”æ¡ˆï¼ˆå› ä¸ºå…¶ä»–è·³èš¤é«˜åº¦åªä¼šå˜å°ï¼‰ï¼Œå¦åˆ™å°±åŠ å…¥æ–°çš„å‡½æ•°ã€‚$O(n^2)$</p><p><a href="https://uoj.ac/submission/443496" target="_blank" rel="noopener">$Code$</a></p><h3 id="å¤§è‘±çš„ç¥åŠ›"><a href="#å¤§è‘±çš„ç¥åŠ›" class="headerlink" title="$å¤§è‘±çš„ç¥åŠ›$"></a><a href="https://loj.ac/p/2288" target="_blank" rel="noopener">$å¤§è‘±çš„ç¥åŠ›$</a></h3><p>å•ç‹¬å†™åšå®¢äº†ã€‚</p><h2 id="mathcal-12-22"><a href="#mathcal-12-22" class="headerlink" title="$\mathcal{12.22}$"></a>$\mathcal{12.22}$</h2><hr><h3 id="XJOI1631"><a href="#XJOI1631" class="headerlink" title="$XJOI1631$"></a>$XJOI1631$</h3><p>ä»Šå¤©æ•°å­¦åœºï¼Œé¢˜ç›®æœ‰äº›è®¸æ¯’ç˜¤ï¼Œæˆ‘æœ‰äº›è®¸è‡ªé—­ã€‚</p><h4 id="T1-3"><a href="#T1-3" class="headerlink" title="$T1$"></a>$T1$</h4><p>å’•å’•ï¼Œé¸½é¸½</p><h4 id="T2-3"><a href="#T2-3" class="headerlink" title="$T2$"></a>$T2$</h4><p>åŸºç¯æ ‘æœ¬è´¨ä¸åŒæŸ“è‰²æ•°ã€‚å…ˆæ ‘å“ˆå¸Œåˆ¤ç¯ä¸Šæ ‘åŒæ„ï¼Œå¹¶ç®—å‡ºæ¯ä¸ªæ ‘ç­‰ä»·ç±»çš„æŸ“è‰²æ•°ã€‚åš $burnside$ çš„æ—¶å€™ï¼Œä¸èƒ½åƒä»¥å‰ä¸€æ ·æšä¸¾ $gcd$ äº†ï¼Œå› ä¸ºæ¯ç§æ—‹è½¬æ–¹æ¡ˆçš„ç­‰ä»·ç±»æŸ“è‰²æ•°éƒ½ä¸åŒã€‚ç”±äº $n$ å¾ˆå°ï¼Œä»…æšä¸¾å› æ•°å³å¯ï¼Œå› ä¸ºä¸æ˜¯å› æ•°çš„è·³å‡ºæ¥ä¹Ÿæ˜¯è·ç¦»ç›¸ç­‰çš„å› æ•°å½¢æ€ï¼ˆè¡¨è¾¾ä¸å¤ªæ¸…æ¥šï¼Œæ„ä¼šä¸€ä¸‹</p><p>æ‰¾åˆ°æœ€å°çš„åˆæ³•æ—‹è½¬è·ç¦» $d$ã€‚å®é™…ä¸Š $d$ å°±æ˜¯æ‰€æœ‰å¯è¡Œæ­¥é•¿çš„ $gcd$ã€‚æŠŠç›¸é‚» $d$ ä¸ªçœ‹ä½œä¸€å—å†åš $burnside$ã€‚</p><h4 id="T3-3"><a href="#T3-3" class="headerlink" title="$T3$"></a>$T3$</h4><p>å¥½å¦™å•Šã€‚å°±æœ‰è¿™ä¹ˆä¸ª $trick$ï¼šå°äºæŸä¸ª $limit$ çš„æ“ä½œéƒ½è¢«æ‰§è¡Œï¼Œå°±å¯ä»¥ä»å°å¾€å¤§æ‰§è¡Œæ“ä½œã€‚</p><p>æ³¨æ„åˆ°ä¸€ä¸ªæ“ä½œåªæœ‰åœ¨ $gap \leq T$ çš„æ—¶å€™æ‰ä¼šè¢«æ‰§è¡Œï¼Œå°±æŒ‰ $gap$ ä»å°å¾€å¤§åŠ å…¥æ“ä½œï¼Œçº¿æ®µæ ‘ç»´æŠ¤æ¯ä¸ªæ“ä½œåŒºé—´èƒ½èµ°åˆ°çš„åŒºé—´ã€‚</p><h3 id="åäºŒçœè”è€ƒ2019-å­—ç¬¦ä¸²é—®é¢˜"><a href="#åäºŒçœè”è€ƒ2019-å­—ç¬¦ä¸²é—®é¢˜" class="headerlink" title="$åäºŒçœè”è€ƒ2019-å­—ç¬¦ä¸²é—®é¢˜$"></a><a href="https://loj.ac/p/3049" target="_blank" rel="noopener">$åäºŒçœè”è€ƒ2019-å­—ç¬¦ä¸²é—®é¢˜$</a></h3><p>å†™åœ¨ã€ŒåäºŒçœè”è€ƒã€ã€‚</p><h3 id="åäºŒçœè”è€ƒ-çš®é…"><a href="#åäºŒçœè”è€ƒ-çš®é…" class="headerlink" title="$åäºŒçœè”è€ƒ-çš®é…$"></a><a href="https://loj.ac/p/3051?keyword=3051" target="_blank" rel="noopener">$åäºŒçœè”è€ƒ-çš®é…$</a></h3><p>å†™åœ¨ã€ŒåäºŒçœè”è€ƒã€ã€‚</p><h2 id="mathcal-12-23"><a href="#mathcal-12-23" class="headerlink" title="$\mathcal{12.23}$"></a>$\mathcal{12.23}$</h2><hr><h3 id="XJOI1632"><a href="#XJOI1632" class="headerlink" title="$XJOI1632$"></a>$XJOI1632$</h3><p>XJ ç°åœ¨é¢˜å¥½åƒä¸é‚£ä¹ˆæ—§äº†ï¼Ÿç‚¹èµï¼æˆ‘éƒ½è¦è®¢ï¼</p><h4 id="T1-4"><a href="#T1-4" class="headerlink" title="$T1$"></a>$T1$</h4><p>æ±‚æœ¬è´¨ä¸åŒå­ä¸²çš„æœ¬è´¨ä¸åŒå­ä¸²ï¼Œ</p><p>å’•å’•ï¼Œé¸½é¸½ï¼ˆåŒºé—´æœ¬è´¨ä¸åŒå­ä¸²åšæ³•ï¼ŸLCT + SAMï¼Ÿæœ‰ç©ºå†è¡¥</p><h4 id="T2-4"><a href="#T2-4" class="headerlink" title="$T2$"></a>$T2$</h4><p>åŸé¢˜ $HNOI2016-åºåˆ—$ã€‚å®¹æ˜“å‘ç°å°±æ˜¯è¦ç»´æŠ¤æ‰€æœ‰å­åŒºé—´æœ€å¤§å€¼ä¹‹å’Œã€‚</p><p>å¤„ç†åŒºé—´çš„å¥—è·¯ï¼šå›ºå®šä¸€ç»´å…ˆç®—ï¼Œå†æ±‚å’Œã€‚ï¼ˆæ¯”èµ›æ—¶å°±è¿™ä¸ªå¦¹æƒ³åˆ°ï¼ï¼‰</p><p>$f[i]$ è¡¨ç¤ºä»¥ $i$ ä¸ºå³ç«¯ç‚¹çš„åŒºé—´ç­”æ¡ˆå’Œã€‚è®¾ $pre[i]$ è¡¨ç¤º $i$ å‰é¢æœ€è¿‘çš„å°äº $a[i]$ çš„ä½ç½®ï¼Œåˆ™ $f[i] = f[pre[i]] + a[i] * (i - pre[i])$ã€‚å¯¹ $f$ æ±‚å‰ç¼€å’Œè®¾ä¸º $g$ã€‚</p><p>æ€ä¹ˆå›ç­”ä¸€ä¸ª $[l, r]$ çš„è¯¢é—®ï¼Ÿè®¾ $pos$ è¡¨ç¤º $[l, r]$ ä¸­æœ€å°çš„ä½ç½®ï¼Œé—®é¢˜å°±åœ¨äºæ€ä¹ˆè®¡ç®— $(pos, r]$ çš„å­åŒºé—´ç­”æ¡ˆã€‚ç­”æ¡ˆå°±æ˜¯ $g[r] - g[pos] - f[pos] * (r - pos)$ï¼ŒæŒºå¥½ç†è§£ã€‚$[l, pos)$ ä¸€ä¸ªé“ç†ã€‚</p><h4 id="T3-4"><a href="#T3-4" class="headerlink" title="$T3$"></a>$T3$</h4><p>è€ƒå¯Ÿè€ƒç”Ÿç†Ÿç»ƒæ¢ç»´ $dp$ çš„èƒ½åŠ›ã€‚</p><p>$bitset$ å¥½æƒ³ï¼Œ$30$ åˆ†æš´åŠ›æ‹¿åˆ°ã€‚æ¥ç€æ€è·¯æƒ³ä¸‹å»ï¼Œè€ƒè™‘ä¼˜åŒ–ã€‚</p><p>$f[i, j]$ è¡¨ç¤ºå‰ $i$ ç§ç‰©å“ï¼Œé€‰äº† $j$ ç§ï¼Œèƒ½é€‰çš„ä½“ç§¯ï¼Œç¬¬ä¸‰ç»´ç”¨ $bitset$ è¡¨ç¤ºã€‚</p><p>æ¢äºŒä¸‰ç»´ã€‚</p><p>$$f[i, j] = f[i - 1, j]\ |\ OR_{k = 1}^{c[i]} (f[i - 1, j - k * v[i]] &lt;&lt; 1)$$</p><p>æ¢ä¸€äºŒç»´ã€‚</p><p>$$f[j] = f[j]\ |\ OR_{k = 1}^{c[i]} (f[j - k * v[i]] &lt;&lt; 1)$$</p><p>å‘ç°å¯¹ $j$ ä»¥ $mod\ v[i]$ å€¼åˆ†ç±»ï¼Œæ¯ç±»äº’ä¸å¹²æ‰°ï¼Œäºæ˜¯å¯ä»¥åˆ†åˆ«æ‹å‡ºæ¥ç®—ï¼Œé‚£å°±æ˜æ˜¾äº†ï¼šæ±‚åŒºé—´æˆ–ã€‚</p><p><del>é‚£ä¸ç›´æ¥ st è¡¨å˜›</del>æ¸…é†’ç‚¹ï¼Œå¹³ç™½å¤šä¸ª $log$ï¼ˆæ®è¯´å¯ä»¥ç”¨ $\pm1\ rmq$ å®ç°ï¼Œç”¨äººè¯å°±æ˜¯åˆ†å— $st$ è¡¨ï¼‰</p><p><del>é‚£ä¸ç›´æ¥å‰åç¼€å˜›</del>æ¸…é†’ç‚¹ï¼Œä¸å¯é€†</p><p>äºæ˜¯å·§å¦™åˆ†å—ï¼Œä»¥ $c[i]$ ä¸ºå—å¤§å°ï¼Œæ¯å—ç»´æŠ¤å‰åç¼€æˆ–å°±å¯ä»¥äº†ã€‚ç„¶åè¦åŠ ä¸€äº›æŒ‡æ ‡é›†ä¼˜åŒ–ä¸ç„¶ä¼š T æˆ 40ã€‚</p><p>å­¦ä¹ äº†æœ€å°åœ†è¦†ç›–ã€‚</p><h3 id="JOI2017-æ˜¥å­£åˆå®¿"><a href="#JOI2017-æ˜¥å­£åˆå®¿" class="headerlink" title="$JOI2017-æ˜¥å­£åˆå®¿$"></a><a href="https://uoj.ac/problem/355" target="_blank" rel="noopener">$JOI2017-æ˜¥å­£åˆå®¿$</a></h3><p><strong>å‘ç°çºµå‘é•¿åº¦å’Œæ¨ªå‘é•¿åº¦å›ºå®šäº†ï¼Œæ¯ä¸ªç§å­éƒ½è´¡çŒ®ä¸€å—å½¢çŠ¶å¤§å°ç›¸åŒçš„çŸ©å½¢ï¼Œæ‰€ä»¥é¡ºåºæ— å…³ã€‚</strong></p><p>å›ºå®šä¸€ç»´å¤„ç†å¦ä¸€ç»´çš„æ€è·¯ã€‚æšä¸¾çºµå‘é•¿åº¦ï¼Œå‘ç°æœ‰ä¸¤ç§æƒ…å†µçºµå‘é•¿åº¦ä¼šå½±å“æ¨ªå‘é•¿åº¦ï¼š$1$. çºµå‘ä¸¤ä¸ªç§å­åˆ°äº†è¾¹ç•Œ $2$. ä¸¤ä¸ªç§å­ç¢°åˆ°å½¼æ­¤äº†ã€‚æ‰€ä»¥å…±æœ‰ $O(n^2)$ ç§ã€‚</p><p>å†è®¡ç®—æœ€å°æ¨ªå‘é•¿åº¦ï¼Œè®¾æœ€å·¦è¾¹çš„ç§å­åˆ°å·¦è¾¹ç•Œä¸º $a$ï¼Œæœ€å³è¾¹çš„ç§å­åˆ°å³è¾¹ç•Œè·ç¦»ä¸º $b$ï¼Œç§å­æ¨ªåæ ‡å·®æœ€å¤§ä¸º $c$ï¼Œé‚£ä¹ˆæœ€å°æ¨ªå‘é•¿åº¦å°±æ˜¯ $\max(a + b, c)$ã€‚</p><p>è¾¹ç•Œå¾ˆæ¶å¿ƒï¼Œäºæ˜¯è´ºäº†ä»£ç ï¼Œå¯è€» à²¥_à²¥</p><p><a href="https://loj.ac/s/1019368" target="_blank" rel="noopener">$Code$</a></p><h2 id="mathcal-12-24"><a href="#mathcal-12-24" class="headerlink" title="$\mathcal{12.24}$"></a>$\mathcal{12.24}$</h2><hr><h3 id="XJOI1633"><a href="#XJOI1633" class="headerlink" title="$XJOI1633$"></a>$XJOI1633$</h3><h4 id="T1-5"><a href="#T1-5" class="headerlink" title="$T1$"></a>$T1$</h4><p>æ•°è®ºé¢˜ï¼å®¹æ˜“å‘ç°æ˜¯åæ¼”ï¼Œéœ€è¦ä¸€ä¸ªå…³é”®æŸ¿å­ï¼ˆæˆ‘ä¸ä¼šæ‰€ä»¥å°± ggï¼‰ï¼ˆxml ä½ çœŸå¾—æ¡æ•°è®ºäº†ï¼‰ï¼š$\sum\limits_{i = 1}^n \cos\frac{2\pi i}{n} = [n = 1]$ï¼Œè¯æ˜å¯ä»¥è€ƒè™‘å¤æ•°å¹³é¢ä¸Šçš„å•ä½æ ¹ï¼š$\sum\limits_{i = 1}^n \omega_n^i = [n = 1]$</p><p>ç­”æ¡ˆåšå·®åˆ†å¾—: $f(r + 1) - f(l)$ï¼Œè€ƒè™‘ $f(n) = \sum\limits_{d = 1}^n \mu(\frac{n}{d})g(d)$ï¼Œæ˜¾ç„¶å¯ä»¥æ•´æ•°åˆ†å— + æœæ•™ç­›æ±‚ $\mu$; $g(n) = C(n, 2) + 1 - n$ï¼Œåé¢è¿™ä¸ªä¸œè¥¿æ˜¯ $(\sum\limits_{i = 1}^n \sum\limits_{j = 1}^i cos\frac{2\pi j}{i}) - (\sum\limits_{i = 1}^n cos\frac{2\pi i}{i})$</p><h4 id="T2-5"><a href="#T2-5" class="headerlink" title="$T2$"></a>$T2$</h4><p>ã€Œæœ‰è‰²å›¾ã€ä¸‰å€ç»éªŒé¢˜ï¼Œæ²¡åˆ‡ä¸åº”è¯¥â€”â€”æˆ‘è„‘æŠ½è§‰å¾— $C_{i, j, k}$ åªæœ€å¤šåœ¨ä¸¤ä¸ªç½®æ¢ä¸­ã€‚å¥½å¯æƒœå•Šå•Šå•Šå•Šå•Šå•Šï¼ï¼ï¼å°±å·®è·¨è¶Šä¸‰ä¸ªç½®æ¢çš„æƒ…å†µæˆ‘å°± AC äº†ï¼ˆåè¡€ï¼‰ç¥­å¥ æˆ‘è€ƒåœºä¸Šé“å¤´çš„ä¸¤å°æ—¶ (;Â´à¼àº¶Ğ”à¼àº¶`)</p><p><del>ä¹Ÿè®¸ä»¥ååŠŸæˆåå°±æ¥å‡ºé¢˜ï¼Œå¯ä»¥å‡ºå››å€ç»éªŒé¢˜ï¼Œæ¥ä¸€ä¸ª $D_{i, j, k, l}$ï¼ˆä½ è¿™å‡ºé¢˜äººä¸è®²å””å¾—ï¼ï¼‰</del></p><h4 id="T3-5"><a href="#T3-5" class="headerlink" title="$T3$"></a>$T3$</h4><p>è€é¢˜ï¼Ÿç‰›å®¢ç½‘ä¸Šè§è¿‡æ²¡åˆ‡æˆ‘çˆªå·´ã€‚åšæ³•æœ‰ä¸€åƒç§ï¼Œæ ¹å·ã€$2$/$3$ åª $log$ ç­‰ç­‰ã€‚</p><p>è€ƒè™‘ç‚¹åˆ†æ²»ï¼Œç¦»çº¿è¯¢é—®ï¼Œæ¯æ¬¡å¤„ç†è¿‡åˆ†æ²»é‡å¿ƒçš„è¯¢é—®ï¼Œå¯¹äº $S -&gt; lca$ å°±ç»´æŠ¤å’Œä»¥åŠæœ€åçš„é‚£ä¸ªæœ€å°å€¼ï¼ˆå¯ä»¥å€å¢æ‰¾ä½ç½®ï¼‰ï¼Œå¯¹äº $lca -&gt; T$ å°±ç»´æŠ¤ç¬¬ä¸€ä¸ªå°äº $S -&gt; lca$ æœ€å°å€¼çš„ä½ç½®ï¼ˆå¯ä»¥äºŒåˆ†ï¼‰</p><p>æ€è·¯å¾ˆæ¸…æ¥šï¼Œç„¶åå°±æ˜¯å¤§åŠ›å †ä»£ç ã€‚æœ‰ä¸ªåœ°æ–¹æ²¡å†™</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (mark[x]) continue;</span><br></pre></td></tr></table></figure><p>T é£äº† = =</p><p>hhzï¼šä¸ç”¨äºŒåˆ†ï¼Œå¯¹äº $S -&gt; lca$ æœ€å°å€¼ä»å°åˆ°å¤§æ’åºä¾æ¬¡åšï¼ŒæŠŠæ¯”å½“å‰æœ€å°å€¼ä¾¿å®œçš„ç‚¹åŠ è¿›å›¾é‡Œï¼Œå¹¶æŸ¥é›†ç»´æŠ¤æ ¹å°±å¯ä»¥å•¦ä¸è¿‡æ˜¯ $O(nlogn\alpha)$ çš„ï¼Œå¯ä»¥ $O(1)$ æ ‘ä¸Šå¹¶æŸ¥é›†å»æ‰ $\alpha$ã€‚ï¼ˆæ˜¯æˆ‘ä¸ä¼šçš„ç§‘æŠ€ï¼‰</p><h3 id="æ­Œå”±ç‹å›½"><a href="#æ­Œå”±ç‹å›½" class="headerlink" title="$æ­Œå”±ç‹å›½$"></a><a href="https://www.luogu.com.cn/problem/P4548" target="_blank" rel="noopener">$æ­Œå”±ç‹å›½$</a></h3><p>å¦™è¯¶ã€‚ã€‚æ·éª°å­ç±»å‹é¢˜çš„æ¦‚ç‡ç”Ÿæˆå‡½æ•°ï¼š$F(x)$ è¡¨ç¤ºæ‰” $i$ æ¬¡æˆåŠŸçš„æ¦‚ç‡ï¼Œ$G(x)$ è¡¨ç¤ºæ‰” $i$ æ¬¡ä¸æˆåŠŸçš„æ¦‚ç‡ã€‚ç„¶åæ ¹æ®æ‰”éª°å­çš„åç»§å¯èƒ½èƒ½åˆ—å‡ºä¿©æŸ¿å­ï¼š</p><ol><li>$xG(x) + 1 = F(x) + G(x)$</li><li>$G(x) \cdot (\frac{1}{n})^m = \sum\limits_{i = 1}^m [name_{1\ to\ i}\ is\ a\ border] F(x) (\frac{1}{n})^{m - i}$</li></ol><p>æ±‚çš„æ˜¯æœŸæœ›ä¹Ÿå°±æ˜¯ $Fâ€™(1)$ï¼Œå¯¹ä¸Šä¸¤æŸ¿åŒ–å¾—ï¼š</p><ol><li><p>$xGâ€™(x) + G(x) = Fâ€™(x) + Gâ€™(x) \Rightarrow Fâ€™(x) = (x - 1)Gâ€™(x) + G(x) \Rightarrow Fâ€™(1) = G(1)$</p></li><li><p>$G(x) = \sum\limits_{i = 1}^m [name_{1\ to\ i}\ is\ a\ border] F(x) (\frac{1}{n})^{i} \Rightarrow G(1) = \sum\limits_{i = 1}^m [name_{1\ to\ i}\ is\ a\ border] F(1) (\frac{1}{n})^{i} = \sum\limits_{i = 1}^m [name_{1\ to\ i}\ is\ a\ border] (\frac{1}{n})^{i}$</p></li></ol><p>è”ç«‹ä¸¤æŸ¿å¾— $Fâ€™(1)$ã€‚ç®€å• $kmp$ å°±å¥½äº† hohoï¼</p><h2 id="mathcal-12-25"><a href="#mathcal-12-25" class="headerlink" title="$\mathcal{12.25}$"></a>$\mathcal{12.25}$</h2><hr><p>åœ£è¯èŠ‚ï¼ï¼ï¼ğŸ„ğŸ…ğŸğŸ° æˆ‘ä»¬éƒ½æ˜¯å»¶ç†„äººã€è¡¥è¯¾äººã€åƒé¥ºå­äººï¼Œæˆ‘å¦ˆè¯´å¥¹æ˜¯åšé¥ºå­äºº qwq</p><h3 id="XJOI1634"><a href="#XJOI1634" class="headerlink" title="$XJOI1634$"></a>$XJOI1634$</h3><h4 id="T1-6"><a href="#T1-6" class="headerlink" title="$T1$"></a>$T1$</h4><p>$O(n2^{n/2})$ çŠ¶å‹ï¼Œæƒ³åˆ°äº†ä½†æ˜¯è¦ $EXCRT$ åˆå¹¶ /è‚‹æœ¨</p><h4 id="T2-6"><a href="#T2-6" class="headerlink" title="$T2$"></a>$T2$</h4><p>åŸé¢˜ $BZOJ3838$.</p><p>hhz ä¸€è¯­é“ç ´å¤©æœºï¼šæ¨¡æ‹Ÿè´¹ç”¨æµæ¨¡æ‹Ÿçš„æ˜¯æœ€çŸ­è·¯å¢å¹¿çš„è¿‡ç¨‹â€”â€”æ¢ç”¨æ•°æ®ç»“æ„ç»´æŠ¤æµã€‚è¿™ç±»é¢˜ä¸€èˆ¬é¬¼ç•œï¼Œä½†å®¹æ˜“å»ºå‡ºè´¹ç”¨æµæ¨¡å‹ï¼Œå‘ç°æ¨¡å‹ä¸€èˆ¬å¾ˆç®€å•ï¼Œå°±å¯ä»¥è€ƒè™‘å®ƒå¢å¹¿åˆ°åº•åœ¨å¹²å•¥äº†ã€‚æ¨èåšé¢˜ï¼š<a href="https://loj.ac/p/6405" target="_blank" rel="noopener">$Conquer the World$</a></p><p>å»ºå‡ºæ¨¡å‹ï¼šâ€™(â€˜ å‘æºç‚¹è¿è¾¹ï¼Œâ€™)â€™ å‘æ±‡ç‚¹è¿è¾¹ï¼Œ$K / 2$ æ¬¡å¢å¹¿è·‘è´¹ç”¨æµã€‚æ¨¡å‹éå¸¸ç®€å•ï¼Œè€ƒè™‘æ¨¡æ‹Ÿè´¹ç”¨æµï¼</p><p>è¿™è´¹ç”¨æµåœ¨å¹²å•¥ï¼Ÿæ¯æ¬¡å–ä¸€å¯¹æ‹¬å·, ä½ç½®åˆ†åˆ«ä¸º $l$ å’Œ $r$, å¦‚æœå–çš„æ˜¯ â€˜()â€™ åˆ™å¯¹ $[l, r)$ åŒºé—´ $+1$ï¼›å¦‚æœå–çš„æ˜¯ â€˜)(â€˜ åˆ™å¯¹ $[r, l)$ åŒºé—´ $-1$ï¼ŒåŒæ—¶è¦éè´Ÿã€‚</p><p>å°±å¯ä»¥çº¿æ®µæ ‘ç»´æŠ¤å–çš„è¿‡ç¨‹ï¼Œç»´æŠ¤ä¸€å †é‡ï¼š</p><ul><li>$tag$</li><li>$min$ï¼ˆå‡å®šåŒºé—´æœ€å°å€¼ä¸º $0$ï¼Œä»¥æœ€å°å€¼ä¸ºå‚ç…§è€ƒè™‘æŸä¸ª $a$ æˆ– $b$ èƒ½å¦å–ï¼‰</li><li>$min_a$, $min_b$ï¼ˆåŒºé—´æœ€å° $a$/$b$ï¼‰</li><li>$lmin_a$, $rmin_b$ï¼ˆä¸ºäº†ä¸è·¨è¶Šæœ€å°å€¼ï¼ŒåŒºé—´è¢«åˆ†æˆè®¸å¤šæ®µï¼Œæ˜¾ç„¶æˆ‘ä»¬åˆå¹¶æ—¶åªç”¨åˆ°æœ€å·¦æ®µæœ€å° $a$ å’Œæœ€å³æ®µæœ€å° $b$ï¼‰</li></ul><p>è¿˜æœ‰ä¸€ç§åšæ³•â€”â€”å¸¦æ‚”è´ªå¿ƒï¼Œä»å·¦å¾€å³æ’å…¥ â€˜(â€˜ å’Œ â€˜)â€™ï¼Œâ€™)â€™ çš„æ—¶å€™å¯ä»¥é€‰æ–°çš„ â€˜(â€˜ ä¹Ÿå¯ä»¥é€‰ä¸€ä¸ªä»¥å‰åŒ¹é…æ‰çš„ â€˜(â€˜ã€‚æ‰€ä»¥åŒ¹é…ä¸Šè¿˜è¦ä¸¢ä¸€ä¸ª $-a[]$ ä»¥å¤‡åæ‚”ã€‚ä½†æ˜¯è¿™æ ·è¿˜æ˜¯é”™çš„ï¼Œå› ä¸ºæ²¡æœ‰æ¯æ¬¡ä¸ªæ•°å¢åŠ  $1$ çš„é˜¶æ®µæ€§ã€‚æœ‰ç¥ä»™æ›°ï¼š$wqs$ äºŒåˆ†ï¼Œ<strong>å°±å¯ä»¥ä¸¢æ‰ä¸ªæ•°çš„é™åˆ¶äº†ï¼</strong> äºŒåˆ†æ–œç‡ $k$ï¼ŒåŒ¹é…ä¸Šè¦ä¸¢çš„ä¸œè¥¿å°±å˜æˆ $-a[] - k$ äº†ã€‚</p><h4 id="T3-6"><a href="#T3-6" class="headerlink" title="$T3$"></a>$T3$</h4><p>è¿™é¢˜ä¸éš¾ï¼Œæƒ³åˆ°æ­£è§£äº†ã€‚</p><p>æœ€ç»ˆæ˜¯å¾ˆå¤šä¸ªæ–­å¼€çš„è¿ç»­æ®µï¼Œè€ƒè™‘æŸä¸ªåŒºé—´æ˜¯å¦å¯ä»¥ä½œä¸ºè¿ç»­æ®µï¼Œåªè¦ç»´æŠ¤æ¯ä¸ªä½ç½®å‘å·¦æœ€è¿œä½ç½®ï¼ˆ$mn$ï¼‰å’Œå‘å³æœ€è¿œä½ç½®ï¼ˆ$mx$ï¼‰ï¼Œæ ‘çŠ¶æ•°ç»„ $O(nlogn)$ã€‚</p><p>$dp$ï¼Œ$dp[i]$ è¡¨ç¤º $i$ ä¸ºæœ€åä¸€ä¸ªè¿ç»­æ®µå³ç«¯ç‚¹çš„ $dp$ å€¼ï¼Œæ˜¾ç„¶å½“ $p$ ä¸ºå·¦ç«¯ç‚¹æ—¶è´¡çŒ®æ˜¯ $sum[p - 2]$ï¼Œ$sum$ æ˜¯ $dp$ æ•°ç»„å‰ç¼€å’Œã€‚</p><p>æšä¸¾å³ç«¯ç‚¹ $r$ï¼Œæˆ‘ä»¬åªè¦ç»´æŠ¤å·¦ç«¯ç‚¹åœ¨ $[mn[r], r]$ ä¸­ä¸”å‘å³æœ€è¿œä½ç½® $\geq r$ çš„è¿ç»­æ®µè´¡çŒ®å°±å¥½ï¼Œå‘ç°è¿™æ ·è¿ç»­æ®µå·¦ç«¯ç‚¹éšç€å³ç«¯ç‚¹å•è°ƒï¼Œäºæ˜¯å¯ä»¥æ ‘çŠ¶æ•°ç»„åšã€‚</p><p>å‘ç°è‡ªå·±æƒ³åˆ°è§£æ³•ï¼Œè¯´å‡ºæ¥æˆ–è€…å†™å‡ºæ¥ä¼šæ¸…æ¥šå¾ˆå¤šã€‚æ²¡å•¥å¥½è¯´çš„ï¼Œæš´åŠ›éƒ½å†™æŒ‚äº†ï¼ï¼ï¼ï¼ˆåæ¥å‘ç° bug åœ¨é¢„å¤„ç†æœ€è¿œä½ç½® = =</p><h3 id="çç "><a href="#çç " class="headerlink" title="$çç $"></a><a href="https://loj.ac/p/3120" target="_blank" rel="noopener">$çç $</a></h3><p>å†™åœ¨ã€Œç”Ÿæˆå‡½æ•°ã€é‡Œäº†ã€‚</p><p><a href="https://loj.ac/s/1019774" target="_blank" rel="noopener">$Code$</a></p><h3 id="ICPC-World-Final-2018-Conquer-the-World"><a href="#ICPC-World-Final-2018-Conquer-the-World" class="headerlink" title="$ICPC\ World\ Final\ 2018\ Conquer\ the\ World$"></a><a href="https://loj.ac/p/6405" target="_blank" rel="noopener">$ICPC\ World\ Final\ 2018\ Conquer\ the\ World$</a></h3><p>æ‹†è·ç¦»ä¸º $dist = dep_x + dep_y - 2 * dep_{lca}$ã€‚æ³¨æ„å› ä¸ºå¼ºåˆ¶æ´å…¨éƒ¨æ»¡ï¼Œæ´çš„ $dep$ å¯ä»¥å‡å» $\infty$ æœ€åå†åŠ å›æ¥ã€‚</p><p>åœ¨æ¯ä¸ª $x$ ä½œä¸º $LCA$ æ—¶æ“ä½œæ‰å­æ ‘é‡Œæ‰€æœ‰åŒ¹é…èµ·æ¥è´¡çŒ® $&lt; 0$ çš„å¯¹ï¼Œç„¶åä¸ºäº†åœ¨ç¥–å…ˆå¤„å¯ä»¥åæ‚”ï¼Œè¿˜è¦åˆ†åˆ«ä¸¢è¿›å † $dist - dep_x$ å’Œ $dist - dep_y$ã€‚ä¸ä¼šå‡ºç°è·¯å¾„é‡åˆçš„å¯¹å› ä¸ºé‚£è‚¯å®šä¸ä¼˜ã€‚</p><h2 id="mathcal-12-26"><a href="#mathcal-12-26" class="headerlink" title="$\mathcal{12.26}$"></a>$\mathcal{12.26}$</h2><hr><p>å­¦ä¹ äº†æœ€å¤§æƒé—­åˆå­å›¾ã€‚</p><h3 id="Salty-Fish"><a href="#Salty-Fish" class="headerlink" title="$Salty\ Fish$"></a><a href="https://vjudge.net/problem/HDU-6634" target="_blank" rel="noopener">$Salty\ Fish$</a></h3><p>å†™åœ¨ã€Œæœ€å¤§æƒé—­åˆå­å›¾ã€å­¦ä¹ ç¬”è®°é‡Œäº†ã€‚</p><h3 id="CF280D-k-Maximum-Subsequence-Sum"><a href="#CF280D-k-Maximum-Subsequence-Sum" class="headerlink" title="$CF280D-k-Maximum Subsequence Sum$"></a><a href="https://www.luogu.com.cn/problem/CF280D" target="_blank" rel="noopener">$CF280D-k-Maximum Subsequence Sum$</a></h3><p>å®¹æ˜“å»ºå‡ºè´¹ç”¨æµæ¨¡å‹ã€‚å‘ç°ä¸€æ¬¡å¢å¹¿åæ²¿é€”çš„è´¹ç”¨è¢«å–è´Ÿï¼Œçº¿æ®µæ ‘æ¨¡æ‹Ÿç»´æŠ¤æµå³å¯ã€‚</p><p><a href="https://codeforces.com/contest/280/submission/102359458" target="_blank" rel="noopener">$Code$</a></p><h3 id="BZOJ4977-è·³ä¼æ±‚ç”Ÿ"><a href="#BZOJ4977-è·³ä¼æ±‚ç”Ÿ" class="headerlink" title="[$BZOJ4977-è·³ä¼æ±‚ç”Ÿ$]"></a>[$BZOJ4977-è·³ä¼æ±‚ç”Ÿ$]</h3><p>å¸¦æ‚”è´ªå¿ƒï¼Œå¥½åƒä¸å¤ªå¯ä»¥ä»æ¨¡æ‹Ÿè´¹ç”¨æµçš„è§’åº¦è§£é‡Šï¼ŸæŒ‰è¡€é‡å‡åºæ’åºï¼Œæ¯ä¸ªè€é¼ å¿…é¡»åŒ¹é…ï¼Œæ¯ä¸ªæ´ä¸ä¸€å®šè¦åŒ¹é…ï¼Œäºæ˜¯è€é¼ æ‰¾å·²åœ¨çš„æœªåŒ¹é…çš„æ´ï¼Œæˆ–è€…å·²åœ¨çš„å·²åŒ¹é…çš„æ´ã€‚è¿™é‡Œæ¶‰åŠçš„åæ‚”æ“ä½œå¾ˆç®€å•â€”â€”æ¶ˆé™¤è€é¼ çš„è´¡çŒ®å°±å¥½ã€‚</p><h3 id="LOJ6289-èŠ±æœµ"><a href="#LOJ6289-èŠ±æœµ" class="headerlink" title="$LOJ6289-èŠ±æœµ$"></a><a href="https://loj.ac/problem/6289" target="_blank" rel="noopener">$LOJ6289-èŠ±æœµ$</a></h3><p>å•ç‹¬å†™åšå®¢äº†ã€‚</p><h3 id="CF995F"><a href="#CF995F" class="headerlink" title="$CF995F$"></a><a href="https://www.luogu.com.cn/problem/CF995F" target="_blank" rel="noopener">$CF995F$</a></h3><p>ï¼ˆæ„Ÿè§‰è¿™ç©æ„ä»¥å‰åœ¨ h2 åšåˆ°è¿‡ï¼‰</p><p>æš´åŠ› $dp$, $f[x, c]$ è¡¨ç¤º $x$ æƒå€¼ä¸º $c$ çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™ $f[x, c] = \prod s[y, c]$ å…¶ä¸­ $s$ æ˜¯ $f$ çš„å‰ç¼€å’Œ</p><p>$D$ å¤ªå¤§äº†ï¼Œä½†è€ƒè™‘åˆ°åªä¼šå‡ºç° $n$ ç§æƒå€¼ï¼Œå¯ä»¥ä»¥ç¦»æ•£åŒ–çš„æ€æƒ³æ±‚å‡º $f[x, c]$ è¡¨ç¤º $x$ çš„æƒå€¼åœ¨å½“å‰æœ‰çš„æƒå€¼ä¸­æ’åç¬¬ $c$ å°ã€‚ä½†ç»„åˆæ•°å°±ä¸èƒ½ç›´æ¥æ±‚äº†â€”â€”å‡ºç°çš„æƒå€¼ç§ç±»ä¸çŸ¥é“ã€‚</p><p>è€ƒè™‘ $f[1, i]$ æ˜¯å•¥ï¼Œå°±æ˜¯ç”¨äº† $\leq i$ ç§æƒå€¼ä¸”ä¸€å®šç”¨äº†ç¬¬ $i$ ç§æƒå€¼çš„æ–¹æ¡ˆæ•°ï¼Œé‚£å®¹æ–¥ä¸å°±å¥½äº†ä¹ˆï¼Ÿ</p><p>$$F[i] = f[1, i] - \sum\limits_{j = 1}^{i - 1} C(i - 1, j - 1) * F[j]$$</p><p><a href="http://codeforces.com/contest/995/submission/102377434" target="_blank" rel="noopener">$Code$</a></p><h2 id="mathcal-12-27"><a href="#mathcal-12-27" class="headerlink" title="$\mathcal{12.27}$"></a>$\mathcal{12.27}$</h2><hr><h3 id="XJOI1628"><a href="#XJOI1628" class="headerlink" title="XJOI1628"></a>XJOI1628</h3><h4 id="T3-7"><a href="#T3-7" class="headerlink" title="T3"></a>T3</h4><p>æ„é€ ä¸€ä¸ªæ’åˆ—ä½¿å¾—æƒå€¼æœ€å¤§â€”â€”ç”¨è´¹ç”¨æµæ±‚è§£ã€‚åªæœ‰ä¸‰ç§è¿è¾¹ï¼Œçº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾å³å¯ã€‚</p><h4 id="T4"><a href="#T4" class="headerlink" title="T4"></a>T4</h4><p>ä¸€çœ¼å¹¿ä¹‰ SAM ä½†æ˜¯æ ¹æœ¬ä¸ä¼šï¼ˆé‚£æ˜¯ä¸æ˜¯ä¸å«â€œä¸€çœ¼â€ï¼Ÿ</p><h3 id="åŒºé—´æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°"><a href="#åŒºé—´æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°" class="headerlink" title="$åŒºé—´æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°$"></a><a href="https://www.luogu.com.cn/problem/P6292" target="_blank" rel="noopener">$åŒºé—´æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°$</a></h3><p>å†™åœ¨ã€ŒSAMã€å­¦ä¹ ç¬”è®°é‡Œäº†ã€‚</p><h2 id="mathcal-12-28"><a href="#mathcal-12-28" class="headerlink" title="$\mathcal{12.28}$"></a>$\mathcal{12.28}$</h2><hr><h3 id="XJOI1634-1"><a href="#XJOI1634-1" class="headerlink" title="$XJOI1634$"></a>$XJOI1634$</h3><h4 id="T1-7"><a href="#T1-7" class="headerlink" title="$T1$"></a>$T1$</h4><p>å‰–é“¾ï¼Œæ¯æ¡é“¾åšï¼ŒæŠŠå°ç«è½¦æ‹†æˆ $O(logn)$ æ®µï¼Œä¸€äº›æ–œç‡ä¸º $1$ å’Œ $-1$ çš„çº¿æ®µï¼Œæ±‚äº¤ç‚¹ã€‚æ–œç‡ç›¸åŒè¦ä¹ˆé‡åˆè¦ä¹ˆåŒèµ·ç‚¹ï¼Œå˜æˆä¸€ç»´é—®é¢˜ï¼Œç»å…¸ç‚¹å‡è¾¹æ±‚å‡ºç›¸äº¤å¯¹æ•°ï¼›æ–œç‡ä¸åŒæ—‹è½¬ $45$ åº¦æ‰«æçº¿ï¼Œä¸ç”¨ç‚¹å‡è¾¹ã€‚</p><h4 id="T2-7"><a href="#T2-7" class="headerlink" title="$T2$"></a>$T2$</h4><p>$T2$ æ²¡åšå‡ºæ¥å¤ªä¸åº”è¯¥äº†ã€‚åæ€ä¸€ä¸‹åˆ°åº•æ˜¯å“ªå„¿å‡ºäº†é—®é¢˜ï¼Ÿä¹Ÿè®¸æˆ‘è„‘è¢‹ä¸­æœ‰è¿‡ä¸€é—ªè€Œè¿‡çš„â€œæšä¸¾æœ€å€¼â€çš„æƒ³æ³•ã€‚</p><p>è¿™é¢˜è¦åšä¸ªè½¬åŒ–â€”â€”æƒå€¼ $\geq$ æœ€å°å€¼çš„è¾¹æƒå€¼ä¸å˜ï¼Œæƒå€¼ $&lt;$ æœ€å°å€¼çš„è¾¹æƒå€¼ä¸º $0$. è€ƒè™‘åˆ°è¾¹åªæœ‰ $3e3$ æ¡ï¼Œä¾æ¬¡æšä¸¾ + æœ€çŸ­è·¯å³å¯ã€‚</p><h4 id="T3-8"><a href="#T3-8" class="headerlink" title="$T3$"></a>$T3$</h4><p>äºŒç»´çº¿æ®µæ ‘æ˜¾ç„¶</p><h2 id="mathcal-12-29"><a href="#mathcal-12-29" class="headerlink" title="$\mathcal{12.29}$"></a>$\mathcal{12.29}$</h2><hr><p>ä»Šå¤©æ”¾äº†ä¸€å † $ACM$ é¢˜ã€‚æŠ±çµè¾£</p><h4 id="T1-8"><a href="#T1-8" class="headerlink" title="$T1$"></a>$T1$</h4><p>ä¸€ç›´åœ¨è€ƒè™‘ä¸€æ®µçš„è¿›ä½ã€‚ã€‚æˆ‘æ˜¯ sbï¼Œçœ‹å“ªä½ç›´æ¥æŠŠé‚£ä½ä¹‹å‰çš„æ‹å‡ºæ¥è®°ä½œ $b[i]$, $b[i] + b[j] \geq 10^p$ å°±æ˜¯è¿›ä½ï¼Œæ˜¾ç„¶æ’åº + åŒæŒ‡é’ˆç®—å¯¹æ•°å°±å¥½äº†ã€‚</p><h4 id="T2-8"><a href="#T2-8" class="headerlink" title="$T2$"></a>$T2$</h4><p>å®¹æ˜“æƒ³åˆ°ç¬›å¡å°”æ ‘ä¹‹ç±»çš„ï¼Œæ¯ä¸ªæ•°æœ‰ä¸€ä¸ªç®¡è¾–èŒƒå›´ï¼Œå¹¶ä¸”ç»„æˆæ–°åºåˆ—çš„æ•°å­—é¡ºåºä¸å˜ $unique$ åæ˜¯åŸæ•°åˆ—çš„ä¸€ä¸ªå­åºåˆ—, $dp[i, j, k]$ è¡¨ç¤ºåˆ°åŸåºåˆ—ç¬¬ $i$ ä¸ªï¼Œç»„æˆæ–°åºåˆ—å‰ $j$ ä¸ªï¼Œï¼ˆæœ€å°ï¼‰æ¬¡æ•°ä¸º $k$ çš„æ–¹æ¡ˆæ•°ã€‚</p><p>cly è¯´ä¹Ÿå¯ä»¥ç¬›å¡å°”æ ‘ä¸Š $dp$ï¼Œ$dp[i, j, k]$ è¡¨ç¤º $i$ èŠ‚ç‚¹å‰/åç¼€ä¸º $j$ï¼Œæ¬¡æ•° $= k$ çš„æ–¹æ¡ˆæ•°ï¼Œè½¬ç§»è¦é«˜ç»´å‰ç¼€å’Œã€‚</p><h4 id="T3-9"><a href="#T3-9" class="headerlink" title="$T3$"></a>$T3$</h4><p>åˆ©ç”¨ç±»ä¼¼ $Hash$ çš„çº¿æ€§æ¢æµ‹æ³•å³å¯ $AC$ã€‚</p><h4 id="T4-1"><a href="#T4-1" class="headerlink" title="$T4$"></a>$T4$</h4><p>åœ¨ $\sqrt{S}$ é™„è¿‘æš´æœå³å¯ã€‚ï¼ˆ$T3$ &amp; $T4$ éƒ½å¥½æš´åŠ›å•Šï¼</p><h4 id="T5"><a href="#T5" class="headerlink" title="$T5$"></a>$T5$</h4><p>é¢˜ç›®çœ‹é”™ $* n$ã€‚é¦–å‘çš„ $A$ å’Œ $B$ ä¼šé€‰ä¸¤ä¸ªä¸åŒè¡Œä¸åŒåˆ—çš„ï¼Œå‰©ä¸‹ $6$ ä¸ªè·Ÿä¹‹å‰é€‰çš„åŒè¡ŒåŒåˆ—çš„æ ¼å­ï¼Œå’Œ $1$ ä¸ªä¸åŒè¡Œä¸åŒåˆ—çš„æ ¼å­ï¼Œå¿…è´¥çŠ¶æ€æ˜¯ $6$ ä¸ªå…¨ä¸º $1$ï¼Œ$1$ ä¸ªä¸º $0$ï¼Œ$sg\ å€¼\ =\ XOR(\ a[i, j]\ åŒè¡ŒåŒåˆ—\ ?\ a[i, j] - 1\ :\ a[i, j]\ )$</p><h4 id="T6"><a href="#T6" class="headerlink" title="$T6$"></a>$T6$</h4><ul><li><p>ç«èµ›å›¾å³æ˜¯æœ‰å‘å®Œå…¨å›¾ã€‚</p></li><li><p>$kosaraju$ æ˜¯å•¥ï¼Ÿå’•ä¸€ä¸ª</p></li></ul><p>å¬è¯´æ˜¯ åŒ—å¤§é›†è®­$2020$ æŸé¢˜çš„å¼±åŒ–ç‰ˆã€‚å…ˆæ‰¾ä¸€ä¸ªå“ˆå¯†é¡¿å›è·¯ï¼ˆ$Graph\ Theory$ï¼šç«èµ›å›¾ä¸€å®šå­˜åœ¨å“ˆå¯†é¡¿é€šè·¯ï¼‰ï¼Œå›è·¯å¤–çš„è¾¹ä¿®æ”¹éƒ½ä¸å½±å“å¼ºè¿é€šæ€§ï¼Œè€Œç¿»è½¬å›è·¯ä¸Šçš„è¾¹ä¼šå½¢æˆé“¾ï¼ŒåŸæœ¬ä¸åœ¨å›è·¯ä¸Šçš„è¾¹ç°åœ¨è¦†ç›–äº†ä¸€äº›åŒºé—´ï¼Œç„¶ååˆ†ç±»è®¨è®ºï¼Œç¼©ç‚¹å•Šä»€ä¹ˆçš„ã€‚</p><h4 id="T7"><a href="#T7" class="headerlink" title="$T7$"></a>$T7$</h4><p>æˆ‘çœ‹åˆ°é‚£ä¸ª $3$ æ“ä½œå•Šæˆ‘å°±å¤§æ„äº†ï¼æˆ‘ä»¥ä¸ºæ˜¯ $splay$ï¼Œæ ¹æœ¬ä¸ç”¨çš„å•Šï¼å°±çœ‹ä½œç¯å½¢ç§»ä½å°±å¥½äº†å•Šï¼æ›´æ”¹èµ·ç‚¹å°±å¥½äº†å•Šï¼è¢«å·è¢­äº†å•Šï¼</p><p><strong>$FLAG$ï¼šä»Šæ˜ä¸¤å¤©æå®Œ $SAM$ï¼Œå¾—ç«‹åˆ»å›å»æ $AGC$ å’Œé›†è®­é˜Ÿä½œä¸šå’Œ $TC$ å¥½é¢˜äº†å•Šï¼Œè½åäºå½“ä»£ $OI$ äº†å•Šå•Šã€‚ã€‚äººå‚»æ²¡æ•‘äº†å•Šå•Šã€‚ã€‚</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OI is full of Theories...</span><br></pre></td></tr></table></figure><h2 id="mathcal-12-30"><a href="#mathcal-12-30" class="headerlink" title="$\mathcal{12.30}$"></a>$\mathcal{12.30}$</h2><hr><p>æ—¶å…‰é£é€ï¼Œæ—¥æœˆå¦‚æ¢­ï¼Œå…‰é˜´èè‹’â€¦ï¼ˆå’³å’³ï¼‰xml è¿˜æ˜¯è¿™ä¹ˆèœï¼$2021\ is\ coming$ï¼å†å†²ä¸¤å¤©å°±å¿«å¿«ä¹ä¹è·¨å¹´å’¯ ~</p><h3 id="BJWC2018-Border-çš„å››ç§æ±‚æ³•"><a href="#BJWC2018-Border-çš„å››ç§æ±‚æ³•" class="headerlink" title="$BJWC2018-Border çš„å››ç§æ±‚æ³•$"></a><a href="https://www.luogu.com.cn/problem/P4482" target="_blank" rel="noopener">$BJWC2018-Border çš„å››ç§æ±‚æ³•$</a></h3><p>å†™åœ¨ã€ŒSAMã€é‡Œäº†ã€‚</p><h3 id="CF1326F2"><a href="#CF1326F2" class="headerlink" title="$CF1326F2$"></a><a href="https://codeforces.com/contest/1326/problem/F2" target="_blank" rel="noopener">$CF1326F2$</a></h3><p>$nb$ é¢˜ã€‚å®¹æ˜“æƒ³åˆ° $dp$ å‡ºé›†åˆ $s$ é‡Œçš„ç‚¹å½¢æˆé“¾çš„æ–¹æ¡ˆæ•°å†æ‹¼èµ·æ¥ï¼Œä½†è¿™ä¸å¯¹å› ä¸ºè¿æ¥å¤„ç‚¹ä¸ä¸€å®šæ²¡è¾¹ã€‚</p><p>è€ƒè™‘å­é›†åæ¼”ã€‚è®¾ç­”æ¡ˆæ•°ç»„ä¸º $f$ï¼Œåˆ™è®¾ $g[S] = \sum\limits_{S \subseteq T} f[T]$ï¼Œä»æ„ä¹‰ä¸Šç†è§£ $g$ å°±æ˜¯ä»»é€‰ä¸€äº›é“¾ï¼Œä¸ç®¡è¿æ¥å¤„ï¼Œæ‹¼èµ·æ¥çš„æ–¹æ¡ˆæ•°ã€‚åªè¦æ±‚å‡º $g$ å°±å¥½äº†ã€‚</p><p>å¯¹äºé“¾é•¿åº¦é›†åˆç›¸åŒçš„æ–¹æ¡ˆåªæ˜¯äº¤æ¢é¡ºåºï¼Œæ–¹æ¡ˆæ•°ç›¸åŒï¼Œæˆ‘ä»¬ä»…è€ƒè™‘æšä¸¾ $n$ çš„åˆ†æ‹†ã€‚</p><p>ç›´æ¥ $dp$ï¼ˆ$dpâ€™[s] = \sum dp[s - t] * g[t]$ï¼‰è¦åš $n$ çš„æ‹†åˆ†æ•°æ¬¡å­é›†å·ç§¯ï¼Œå¤æ‚åº¦å¤§çº¦æ˜¯ $P(n) * n * 2^n$, åƒä¸æ¶ˆã€‚</p><p>æœ‰ç¥ä»™ç”¨å®¹æ–¥ä¼˜åŒ–ï¼šå¯¹ $dp$ è¿›è¡Œå®¹æ–¥ï¼Œæ•æ‰å®¹æ–¥åˆ‡å£ï¼šä»¤ $g[s]$ è¡¨ç¤ºä½¿ç”¨ $s$ é›†åˆé‡Œçš„ç‚¹æ„æˆçš„æŸäº›é•¿åº¦çš„é“¾æ–¹æ¡ˆæ•°ï¼Œ$dp$ è‹¥é‡å¤ç”¨ç‚¹åˆ™å¿…ç„¶ä¼šæ¼æ‰ä¸€äº›ç‚¹ä¸ç”¨ï¼Œå°±å¯ä»¥å®¹æ–¥äº†ã€‚å¿«åœ¨å“ªå„¿å‘¢ï¼ŸåŸå…ˆä¸­é€”è¾¹æšä¸¾æ‹†åˆ†è¾¹å·ï¼Œç°åœ¨åªè¦æšä¸¾å®Œå·ä¸€æ¬¡å†å®¹æ–¥ä¸€æ¬¡ï¼Œå¤æ‚åº¦æ˜¯ $P(n) * 2^n$ â€”â€”ç¨³äº†ï¼</p><p><a href="https://codeforces.com/contest/1326/submission/102753163" target="_blank" rel="noopener">$Code$</a></p><h2 id="mathcal-12-31"><a href="#mathcal-12-31" class="headerlink" title="$\mathcal{12.31}$"></a>$\mathcal{12.31}$</h2><hr><p>è·¨å¤§å¹´è¾£ï¼ï¼ï¼ï¼ï¼<del>è¿™ç¯‡åšå®¢ä¹Ÿå®Œç»“äº†QWQ</del></p><h3 id="XJOI1639"><a href="#XJOI1639" class="headerlink" title="$XJOI1639$"></a>$XJOI1639$</h3><h4 id="T1-9"><a href="#T1-9" class="headerlink" title="$T1$"></a>$T1$</h4><p>hhz: è¿™ä¹ˆè¾“å…¥åªæœ‰ä¸¤ç§ç›®çš„ï¼š1. åŠ å¿«è¯»å…¥ 2. æ•°æ®éšæœºã€‚è¿™é¢˜æ˜æ˜¾æ˜¯éšæœºã€‚</p><p>è¿™æ˜¯é“è¯¯å·®åˆ†æé¢˜ï¼Œä»»ä½•æ•°é™¤ä»¥ 999â€¦ éƒ½æ˜¯å¾ªç¯èŠ‚ï¼Œæƒ³åˆ°æŠŠ $\lfloor \frac{x}{111â€¦} \rfloor$ å˜æˆ $\lfloor \frac{9x}{10^i - 1} \rfloor$ã€‚æ•´æ•°ä½å…ˆåŠ ï¼Œå†åŠ å°æ•°ä½ã€‚</p><p>ç„¶åå’•å’•äº†ï¼Œå®åœ¨å˜æ€å•Šã€‚ã€‚</p><h4 id="T2-9"><a href="#T2-9" class="headerlink" title="$T2$"></a>$T2$</h4><p>å¥½é¢˜ã€‚å®¹æ˜“æƒ³åˆ° $n^2$ dp: $f[i, j]$ è¡¨ç¤ºåˆ°ç¬¬ $i$ ä½ï¼Œä¸¤æ”¯é˜Ÿä¼ç»“å°¾åˆ†åˆ«æ˜¯å½“å‰æœ€é«˜é«˜åº¦ä½ç½®ï¼ˆè¿™æ˜¯å›ºå®šçš„ï¼‰å’Œ $j$ çš„æœ€å°ä¸æ»¡åº¦ã€‚è¿™å¤§æ¦‚æ˜¯æ²¡æœ‰å‰é€”çš„æ€è·¯ã€‚</p><p>è€ƒè™‘å¦ä¸€ç§æš´åŠ›: è®¾ $Max$ ä¸ºå½“å‰å‡ºç°çš„æœ€å¤§é«˜åº¦ï¼Œ$max$ ä¸ºå½“å‰å‡ºç°çš„æ¬¡å¤§é«˜åº¦ï¼Œ$f[i, max]$ è¡¨ç¤ºåˆ°ç¬¬ $i$ ä½ï¼Œæ¬¡é«˜é«˜åº¦ä¸º $max$ çš„æœ€å°ä¸æ»¡åº¦ï¼Œåˆ™æ–°åŠ ä¸€ä¸ª $h$ è¿›æ¥æœ‰ä¸¤ç§è½¬ç§»â€”â€” $max$ å˜ä¸ä¸å˜ã€‚å°±åƒæœ€çŸ­è·¯ä¸€æ ·è½¬ç§»ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">h &gt; Max:</span><br><span class="line">    i  i+1</span><br><span class="line"> ä½  â—‹   â—‹</span><br><span class="line">     â—‹ â†˜ â—‹ è¾¹æƒ 0</span><br><span class="line"> é«˜  â—‹   â—‹</span><br><span class="line"></span><br><span class="line">h &lt; Max:</span><br><span class="line">    â—‹ â†’ â—‹ è¾¹æƒ max - h</span><br><span class="line">    â—‹   â—‹</span><br><span class="line">    â—‹   â—‹</span><br><span class="line"></span><br><span class="line">    â—‹ â†’ â—‹ è¾¹æƒ a</span><br><span class="line">    â—‹ â†’ â—‹ è¾¹æƒ a + 1</span><br><span class="line">    â—‹ â†’ â—‹ è¾¹æƒ a + 2</span><br><span class="line">    ã€‚ã€‚ã€‚</span><br><span class="line">    å°±æ˜¯åŠ ç­‰å·®æ•°åˆ—å•¦ã€‚</span><br></pre></td></tr></table></figure><p>ä¸¤ç§åšæ³•ï¼Œæ­£åšååšã€‚</p><p>æ­£åšéœ€è¦åŒºé—´åŠ ç­‰å·®æ•°åˆ—å’Œç»´æŠ¤å‰ç¼€ $min$ï¼Œé‡‡å–å·®åˆ†æ€æƒ³ï¼Œç­‰å·®æ•°åˆ—å˜æˆåŒºé—´åŠ å¸¸æ•°ï¼Œç¦»æ•£åŒ–ä¸‹æ ‡ï¼Œåˆ©ç”¨å¹³è¡¡æ ‘ç»´æŠ¤ã€‚</p><p>ååšå°±æ¯”è¾ƒå·§å¦™äº†ï¼Œç›¸å½“äºåè·‘æœ€çŸ­è·¯ï¼Œæ¯ä¸€åˆ—ç‚¹ä¸€å®šä¸Šå°ä¸‹å¤§ï¼Œä¸ºå•¥ï¼Ÿåˆ†æ®µè¯ï¼Œ$h &lt; max$ æ—¶ä¸Šå°ä¸‹å¤§åºåˆ— + ä¸Šå°ä¸‹å¤§ç­‰å·®æ•°åˆ—ï¼Œå•è°ƒæ€§æ˜¾ç„¶ï¼›$h &gt; max$ æ—¶åªä¼šå¹³ç§»å’Œä¸Šç§»å– $min$ï¼Œå•è°ƒæ€§æ˜¾ç„¶ã€‚</p><p>æœ‰äº†å•è°ƒæ€§å°±ä¸ç”¨ç»´æŠ¤å‰ç¼€ $min$ äº†ï¼Œçº¿æ®µæ ‘ç»´æŠ¤åŒºé—´åŠ å¸¸æ•°ã€åŒºé—´å– $min$ã€åŒºé—´åŠ ç­‰å·®æ•°åˆ—ã€‚é‡‡å–å·®åˆ†æ€æƒ³ï¼Œå˜æˆå•ç‚¹åŠ ã€åŒºé—´å– $min$ã€åŒºé—´åŠ å¸¸æ•°ã€‚</p><p>PSï¼šè¿™ç±»é¢˜å…¶å®ä¹‹å‰æ¨¡æ‹Ÿèµ›é‡åˆ°è¿‡ï¼Œä¹Ÿæ˜¯ç¬¬ä¸€ç§æš´åŠ›æ²¡å‰é€”ã€ç¬¬äºŒç§æš´åŠ›å¯ä»¥ç”¨ $Trie$ æ ‘ä¼˜åŒ–ã€‚</p><h4 id="T3-10"><a href="#T3-10" class="headerlink" title="$T3$"></a>$T3$</h4><p>è®¾ $f[i, j]$ è¡¨ç¤ºå·²ç»è€ƒè™‘äº†è¿ç»­çš„ $i$ ä¸ªï¼Œé€‰äº†é‡Œé¢ $j$ ä¸ªäººï¼Œè®¨è®ºæ–°åŠ ä¸€ä¸ªäººåˆ°å¼€å¤´/ç»“å°¾ï¼Œæœ‰ï¼š</p><ul><li>$f[i, j] = f[i - 1, j] * p^j + f[i - 1, j - 1] * q^{i - j}$</li><li>$f[i, j] = f[i - 1, j] * q^j + f[i - 1, j - 1] * p^{i - j}$</li></ul><p>è”ç«‹è§£å¾— $f[i - 1, j]$ å…³äº $f[i - 1, j - 1]$ çš„é€’æ¨å¼ï¼Œç›´æ¥æ¨å°±å®Œäº‹äº†ï¼ï¼ï¼$f[i - 1, j] = \frac{ p^{i - j} - (1 - p)^{i - j} }{ p^j - (1 - p)^j } f[i - 1, j - 1]$ï¼Œæ³¨æ„åˆ¤ $p = \frac{1}{2}$ çš„æƒ…å†µã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘ç”Ÿæˆå‡½æ•°</title>
      <link href="2020/12/06/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/"/>
      <url>2020/12/06/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E7%94%9F%E6%88%90%E5%87%BD%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<p>è¿æ°”å¥½çš„è¯ä¹Ÿè®¸ä¸ç”¨é‡ä¿®ï¼Ÿæ„Ÿè§‰æŒºå¥½ç†è§£å‘€ï¼</p><h2 id="æ— è¶£çš„-åŸºæœ¬æ¦‚å¿µå’ŒæŠ€æœ¯"><a href="#æ— è¶£çš„-åŸºæœ¬æ¦‚å¿µå’ŒæŠ€æœ¯" class="headerlink" title="æ— è¶£çš„$åŸºæœ¬æ¦‚å¿µå’ŒæŠ€æœ¯$"></a><del>æ— è¶£çš„</del>$åŸºæœ¬æ¦‚å¿µå’ŒæŠ€æœ¯$</h2><hr><ul><li>çº¦å®šï¼š$fâ€™(x)$ è¡¨ç¤ºå¯¹ $f(x)$ æ±‚å¯¼</li></ul><p>ç”Ÿæˆå‡½æ•°çš„ç³»æ•°ä»å…·ä½“çš„æ•°è¢«æ¨å¹¿åˆ°äº†<strong>å½¢å¼å¹‚çº§æ•°</strong>ã€‚</p><p>å¤§å°å‡½æ•°ï¼šå¥½éš¾è¯´æ¸…æ¥šï¼Ÿå°±æ˜¯æ¯”å¦‚æŸä¸ªç”Ÿæˆå‡½æ•°ç¬¬ $n$ é¡¹çš„å¤§å°å‡½æ•° $= n$ã€‚ä¸åŒçš„æƒ…å¢ƒä¸‹å¤§å°å‡½æ•°è¢«èµ‹äºˆä¸åŒçš„å®é™…æ„ä¹‰ã€‚</p><p>æ™®é€šç”Ÿæˆå‡½æ•°ï¼šOGF</p><ul><li>æ— æ ‡å·xxè®¡æ•°</li></ul><p>æŒ‡æ•°ç”Ÿæˆå‡½æ•°ï¼šEGF</p><ul><li>æœ‰æ ‡å·xxè®¡æ•°ï¼Œæ˜¯æ³°å‹’çº§æ•°çš„å½¢å¼ã€‚åˆå¹¶çš„æ—¶å€™ä¼š $C(n + m, n)$ é‡æ–°åˆ†é…æ ‡å·ï¼š$[x^n]f(x) = a_n\frac{x^n}{n!}$, $[x^m]g(x) = b_m\frac{x^m}{m!}$, åˆå¹¶èµ·æ¥å°±å¯¹ $[x^{n + m}]$ æœ‰è´¡çŒ®ï¼š$a_nb_m\frac{x^{n + m}}{n!m!}$ã€‚</li></ul><p>æ³°å‹’çº§æ•°ï¼š</p><ul><li><p>$e^x = \sum\limits_{k \geq 0} \frac{x^k}{k!}$</p></li><li><p><a href="https://baike.baidu.com/item/%E6%B3%B0%E5%8B%92%E5%85%AC%E5%BC%8F/7681487?fr=aladdin" target="_blank" rel="noopener">æ³°å‹’å±•å¼€</a></p></li></ul><p>æ±‚å¯¼ï¼š$x^n = nx^{n - 1}$ï¼Œä¸ç”Ÿæˆå‡½æ•°çš„å·¦ç§»ä½ç›¸å¯¹åº”ã€‚</p><p>æ±‚ç§¯åˆ†ï¼š$\int x^n dx = \frac{1}{n + 1} x^{n + 1}$ï¼Œä¸ç”Ÿæˆå‡½æ•°çš„å³ç§»ä½ç›¸å¯¹åº”ã€‚</p><p>ä¹˜æ³•é€†å…ƒï¼š</p><ul><li><p>$A(x)B(x) \equiv 1 \pmod {x^n}$</p></li><li><p>$A(x)$ æœ‰ä¹˜æ³•é€†å…ƒçš„å……è¦æ¡ä»¶æ˜¯ $A(x)$ çš„å¸¸æ•°é¡¹æœ‰ä¹˜æ³•é€†å…ƒã€‚å¿…è¦æ€§ï¼š$[x^0] A(x) [x^0] B(x) = 1$</p></li><li><p>æœ‰<a href="https://www.luogu.com.cn/paste/2x7n21r1" target="_blank" rel="noopener">æ±‚æ³•</a>,ï¼ˆæ³¨ï¼šè¿™é‡Œçš„ $Bâ€™$ ä¸æ˜¯æ±‚å¯¼ï¼Œå°±æ˜¯å•çº¯è¡¨ç¤ºå¦ä¸€ä¸ªç”Ÿæˆå‡½æ•°ï¼‰æ¯æ¬¡ç®—å‡º $2Bâ€™ - ABâ€™^2$ èµ‹ç»™ $B$ï¼Œæ¯æ¬¡è§„æ¨¡å‡å°ä¸€åŠï¼Œ$T(n) = T(n/2)+O(nlogn) = O(nlogn)$ï¼ˆæ˜¯ä¸æ˜¯å¾ˆåƒç‰›é¡¿è¿­ä»£ï¼Ÿï¼‰</p></li></ul><p>å¤åˆé€†ï¼šè‹¥å¯¹äºä¿©å‡½æ•° $f(x)$ å’Œ $g(x)$ è€Œè¨€æœ‰ $g(f(x)) = x$ï¼Œåˆ™å¯ä»¥çœ‹ä½œ $x$ åœ¨ $g \cdot f$ çš„ä½œç”¨ä¸‹ä¿æŒä¸å˜ï¼Œç§° $g$ ä¸º $f$ çš„å¤åˆé€†ã€‚<strong>å¯¹ $f$ å’Œ $g$ æœ‰è¦æ±‚ï¼šå¸¸æ•°é¡¹ä¸º 0 ä¸”ä¸€æ¬¡é¡¹ç³»æ•°ä¸ä¸º 0</strong>ã€‚</p><ul><li><p>æœ‰ç»“è®ºï¼šè‹¥ $g(f(x)) = x$ åˆ™ $f(g(x)) = x$ï¼Œ$f$ ä¸ $g$ äº’ä¸ºå¤åˆé€†ã€‚</p></li><li><p>æœ‰æ±‚å¯¼æ–¹å¼ï¼š$f(g(x))â€™ = fâ€™(g(x))gâ€™(x)$</p></li><li><p>æœ‰æ±‚æ³•ï¼šğŸ‘‡</p></li></ul><p>æ±‚æ³•å°±æ˜¯æ‹‰æ ¼æœ—æ—¥åæ¼”ï¼š</p><ul><li><p>å·²çŸ¥ $f(x)$ æ±‚ $g(x)$ï¼Œ$[x^n] g(x) = \frac{1}{n} [w^{n - 1}] (\frac{w}{f(w)})^n$</p></li><li><p>æ¨å¹¿å½¢å¼ï¼š$[x^n]h(g(x)) = \frac{1}{n} [w^{n - 1}] hâ€™(w) (\frac{w}{f(w)})^n$</p></li></ul><p>å¯¹æ•°å‡½æ•°ï¼š$ln$</p><ul><li><p>$ln(A(x)) = \sum\limits_{i \geq 1} \frac{A(x)^i}{i}$</p></li><li><p>æœ‰ç»“è®ºï¼š$lnâ€™(x) = \frac{1}{x}$</p></li><li><p>æœ‰æ±‚æ³•ï¼š$ln(A(x)) = \int (ln A(x))â€™ = \int \frac{Aâ€™(x)}{A(x)}$ï¼Œæ‰€ä»¥å¯¹ $A(x)$ æ±‚å¯¼ä½œä¸º $a$ï¼Œæ±‚é€†ä½œä¸º $b$ï¼Œ$a * b$ å†ç§¯åˆ†å°±å¾—åˆ°äº† $ln$ã€‚</p></li></ul><p>æŒ‡æ•°å‡½æ•°ï¼š$exp$</p><ul><li><p>$exp(A(x)) = \sum\limits_{i \geq 0} \frac{A(x)^i}{i!}$</p></li><li><p>æœ‰æ±‚æ³•ï¼šğŸ‘‡</p></li></ul><p>æ±‚æ³•å°±æ˜¯ç‰›é¡¿è¿­ä»£ï¼š</p><ul><li>è®¾ $f(x) = e^{A(x)}$, åˆ™å¾—åˆ°æ–¹ç¨‹ $g(f(x)) = ln(f(x)) - A(x) = 0$. è®¾å·²æ±‚å¾— $f$ å‰ $n$ é¡¹ $f_0(x)$ï¼Œå³ $f(x) \equiv f_0(x) \pmod {x^n}$. å¯¹ $g(f(x))$ ä½œæ³°å‹’å±•å¼€ï¼Œæ•´ç†å¯å¾— $f(x) \equiv f_0(x) - \frac{g(f_0(x))}{gâ€™(f_0(x))} \pmod {x^{2n}}$, å¸¦å…¥ $g(f(x))$ å®šä¹‰å¯å¾— $f(x) = f_0(x)(1 - ln(f_0(x)) + A(x))$ï¼ŒæŒ‰æ­¤è¿­ä»£ï¼Œ$T(n) = T(n/2)+O(nlogn) = O(nlogn)$</li></ul><p>å¯¹æ•°å‡½æ•°å’ŒæŒ‡æ•°å‡½æ•°çš„æ€§è´¨åœ¨è¿™é‡Œä»ç„¶æˆç«‹ã€‚</p><p>å¤šé¡¹å¼å¿«é€Ÿå¹‚ï¼šæ±‚ $A(x)^k$</p><ul><li>ç›´æ¥å¿«é€Ÿå¹‚æ˜¯ $O(n\ logn\ logk)$ çš„</li><li>æœ‰ $O(nlogn)$ æ±‚æ³•ï¼š$A(x)^k = exp(k\ ln\ A(x))$</li></ul><h2 id="æœ‰è¶£çš„è¡¨ç¤ºï¼"><a href="#æœ‰è¶£çš„è¡¨ç¤ºï¼" class="headerlink" title="$æœ‰è¶£çš„è¡¨ç¤ºï¼$"></a>$æœ‰è¶£çš„è¡¨ç¤ºï¼$</h2><hr><p>æœ‰æ ‡å·ç®€å•æ— å‘å›¾çš„ EGFï¼š$G(x) = \sum\limits_{n \geq 0} 2^{\binom{n}{2}} \frac{x^n}{n!}$</p><p>æœ‰æ ‡å·æ— å‘è¿é€šå›¾çš„ EGFï¼š$C(x) = ln(G(x))$</p><p>æ— æ ‡å·ç¯çš„ OGFï¼š$-\sum\limits_{d \geq 1} \frac{\phi(d)}{d} ln(1 - A(x^d))$, $ln(1 - A(x^d))$ ä¸­åªæœ‰ $n/d$ é¡¹æ˜¯æœ‰ç”¨çš„</p><h2 id="æœ‰è¶£çš„é¢˜ç›®ï¼"><a href="#æœ‰è¶£çš„é¢˜ç›®ï¼" class="headerlink" title="$æœ‰è¶£çš„é¢˜ç›®ï¼$"></a>$æœ‰è¶£çš„é¢˜ç›®ï¼$</h2><hr><h3 id="åŸå¸‚è§„åˆ’"><a href="#åŸå¸‚è§„åˆ’" class="headerlink" title="$åŸå¸‚è§„åˆ’$"></a><a href="https://www.luogu.com.cn/problem/P4841" target="_blank" rel="noopener">$åŸå¸‚è§„åˆ’$</a></h3><p>$G(x) = e^{C(x)} = \sum\limits_{n \geq 0} 2^{\binom{n}{2}} \frac{x^n}{n!}$ï¼Œç›´æ¥æ±‚ $ln(G(x))$ å³å¯</p><h3 id="The-Child-and-Binary-Tree"><a href="#The-Child-and-Binary-Tree" class="headerlink" title="$The\ Child\ and\ Binary\ Tree$"></a><a href="https://www.luogu.com.cn/problem/CF438E" target="_blank" rel="noopener">$The\ Child\ and\ Binary\ Tree$</a></h3><h3 id="ZJOI2019-å¼€å…³"><a href="#ZJOI2019-å¼€å…³" class="headerlink" title="$ZJOI2019-å¼€å…³$"></a><a href="https://www.luogu.com.cn/problem/P5326" target="_blank" rel="noopener">$ZJOI2019-å¼€å…³$</a></h3><p>å•å†™åšå®¢äº†</p><h3 id="LOJ6538-çƒ·åŸºè®¡æ•°"><a href="#LOJ6538-çƒ·åŸºè®¡æ•°" class="headerlink" title="$LOJ6538-çƒ·åŸºè®¡æ•°$"></a><a href="https://loj.ac/p/6538" target="_blank" rel="noopener">$LOJ6538-çƒ·åŸºè®¡æ•°$</a></h3><p>æ…•åè€Œæ¥ï¼</p><p>å“¦ï¼Œæ‰€ä»¥æ— æ ‡å·è®¡æ•°ä¸€èˆ¬ä¼šç”¨åˆ°ç¾¤è®ºé‚£å¥—ç†è®ºæ˜¯å—ï¼Ÿå¦ˆå¦ˆæˆ‘ $burnside$ å­¦å€¼äº†ï¼</p><p>è®¾çƒ·åŸºç”Ÿæˆå‡½æ•°ä¸º $A(x)$ã€‚$A(x) = 1 + xA(x)^3$ æ˜¾ç„¶ä¸è¡Œã€‚è€ƒè™‘ $burnside$ï¼Œä¸€ä¸ªç‚¹åªæœ‰ä¸‰ä¸ªå„¿å­å…± $3! = 6$ ç§ç½®æ¢ï¼š</p><ul><li>$(1, 2, 3): A(x)^3$</li><li>$(1, 3, 2)(3, 2, 1)(2, 1, 3): 3A(x)A(x^2)$</li><li>$(2, 3, 1)(3, 1, 2): 2A(x^3)$</li></ul><p>æ‰€ä»¥ $A(x) = 1 + \frac{x}{6}(A(x)^3 + 3A(x)A(x^2) + 2A(x^3))$</p><p>åˆ†æ²» NTT $O(nlog^2n)$, ç‰›é¡¿è¿­ä»£ $O(nlogn)$</p><p>æˆ‘åªä¼šåˆ†æ²» NTTã€‚ã€‚å·å•Šå·å·å•Šå· å°±å¯ä»¥äº†ã€‚å…·ä½“æ¥è¯´å·çš„æ–¹æ³•åˆ†åˆ«å¦‚ä¸‹ï¼š</p><ul><li>$A(x)^3$: $[l, mid]$ ä¸‰æ¬¡</li><li>$3A(x)A(x^2)$: $[l, mid]$ ä¸€æ¬¡ï¼Œ$[mid + 1, r]$ ä¸€æ¬¡</li><li>$2A(x^3)$: $l \neq 0$ çš„æ—¶å€™ $2l &gt; r$ï¼Œæ‰€ä»¥ $[l, mid]$ ä¸€æ¬¡ï¼Œ$[0, r - l]$ ä¸¤æ¬¡ï¼›$l = 0$ çš„æ—¶å€™ $[l, mid]$ ä¸‰æ¬¡ã€‚</li></ul><p><a href="https://loj.ac/s/1012212" target="_blank" rel="noopener">$Code$</a></p><h3 id="LOJ6512-çƒ·çƒƒè®¡æ•°"><a href="#LOJ6512-çƒ·çƒƒè®¡æ•°" class="headerlink" title="$LOJ6512-çƒ·çƒƒè®¡æ•°$"></a><a href="https://loj.ac/p/6512" target="_blank" rel="noopener">$LOJ6512-çƒ·çƒƒè®¡æ•°$</a></h3><p>ä¸ä¸Šä¸€é¢˜çš„åŒºåˆ«ä¹Ÿæ˜¯æ­¤é¢˜çš„éš¾ç‚¹ï¼Œæ˜¯<strong>æ— æ ¹æ ‘</strong>ã€‚ä¸éš¾æƒ³åˆ°æ ‘çš„é‡å¿ƒï¼Œç”šè‡³ $4$ ä¸ªå„¿å­çš„ $burnside$ å¼•ç†ä½ éƒ½æƒ³å¥½äº†ä½†è¿˜æ˜¯ä¸çŸ¥é“æ€ä¹ˆåˆ‡å…¥ã€‚</p><p>è®¾çƒ·çƒƒç”Ÿæˆå‡½æ•°ä¸º $B(x)$ã€‚</p><blockquote><p>æœ‰ç»“è®ºï¼š$c - d + e = 1$</p><p>$c$ ä¸ºç‚¹ç­‰ä»·ç±»ä¸ªæ•°ã€‚ä¸¤ä¸ªç‚¹åœ¨ä¸€ä¸ªç­‰ä»·ç±»ä¸­ï¼Œå½“ä¸”ä»…å½“åˆ†åˆ«ä»¥ä¸¤ä¸ªç‚¹ä¸ºæ ¹çš„æœ‰æ ¹æ ‘åŒæ„ã€‚</p><p>$d$ ä¸ºè¾¹ç­‰ä»·ç±»ä¸ªæ•°ã€‚ä¸¤æ¡è¾¹åœ¨ä¸€ä¸ªç­‰ä»·ç±»ä¸­ï¼Œå½“ä¸”ä»…å½“åˆ†åˆ«åˆ å»ä¸¤æ¡è¾¹å¾—åˆ°çš„æœ‰æ ¹æ ‘åŒæ„ã€‚</p><p>$e$ ä¸ºæ˜¯å¦å­˜åœ¨ä¸€æ¡è¾¹ä½¿å¾—æ–­æ‰åä¸¤è¾¹ä»¥æ–­è¾¹ç«¯ç‚¹ä¸ºæ ¹çš„å­æ ‘åŒæ„ã€‚</p><p>è¯æ˜ï¼š</p><ol><li>$e = 0$ï¼Œæ ¹ä¸ºé‡å¿ƒï¼Œè‡ªæˆä¸€ä¸ªç­‰ä»·ç±»ï¼›å¯¹äºå‰©ä¸‹çš„ç‚¹ï¼Œå®ƒä»¬çš„çˆ¶è¾¹åœ¨åŒä¸€ä¸ªè¾¹ç­‰ä»·ç±»ä¸­ï¼Œå½“ä¸”ä»…å½“å®ƒä»¬åœ¨åŒä¸€ä¸ªç‚¹ç­‰ä»·ç±»ä¸­ï¼Œ$c - d = 1$.</li><li>$e = 1$ï¼Œåœ¨è¿æ¥ä¸¤ä¸ªé‡å¿ƒçš„è¾¹ä¸ŠåŠ å…¥ä¸€ä¸ªç‚¹å˜æˆæœ‰æ ¹æ ‘ï¼Œè½¬ä¸ºæƒ…å†µ 1.</li></ol></blockquote><p>æ¨åˆ°ç”Ÿæˆå‡½æ•°å½¢å¼ï¼Œ$C(x) - D(x) + E(x) = B(x)$</p><p>$C(x)$ å¯ä»¥çœ‹ä½œæ‰€æœ‰ä¸åŒæ„çš„æ— æ ‡å·æ— æ ¹æ ‘çš„ $c$ ä¹‹å’Œï¼Œå³æ‰€æœ‰ä¸åŒæ„çš„æ— æ ‡å·æœ‰æ ¹æ ‘ä¸ªæ•°ï¼Œ$C(x) = \frac{x}{24} ( A(x)^4 + 6A(x)^2A(x^2) + 3A^2(x^2) + 8A(x)A(x^3) + 6A(x^4) )$</p><p>$D(x)$ å¯ä»¥çœ‹ä½œåœ¨è¾¹ä¸ŠåŠ ä¸€ä¸ªç‚¹èƒ½æ„æˆå¤šå°‘ä¸ªä¸åŒçš„æœ‰æ ¹æ ‘ï¼Œ$D(x) = \frac{(A(x) - 1)^2 + (A(x^2) - 1)}{2}$</p><p>$E(x)$ å¯ä»¥çœ‹ä½œåŒæ„æœ‰æ ¹æ ‘ä¸ªæ•°ï¼Œ$E(x) = A(x^2)$</p><p><a href="https://loj.ac/s/1012789" target="_blank" rel="noopener">$Code$</a></p><h3 id="çç "><a href="#çç " class="headerlink" title="$çç $"></a><a href="https://loj.ac/p/3120" target="_blank" rel="noopener">$çç $</a></h3><p>æ¦‚ç‡ç”Ÿæˆå‡½æ•°ç›¸å…³ã€‚</p><p>ã€ç™½äº‘ç™½å…”å¯çˆ±ï¼å–œæ¬¢é¢˜é¢ã€‘.jpg</p><p>å·§å¦™ç”Ÿæˆå‡½æ•°ï¼$\sum\limits_{i = 1}^D \lfloor \frac{cnt_i}{2} \rfloor \geq m \Rightarrow \sum\limits_{i = 1}^D cnt_i % 2 \leq n - 2m$ï¼Œç‰¹åˆ¤ä¸åˆæ³•æƒ…å†µã€‚</p><p>æšä¸¾ $cnt_i % 2 = 1$ å³å¥‡æ•°çš„ä¸ªæ•°ï¼Œè®¾ $odd_i$ è¡¨ç¤ºæœ‰ $i$ ä¸ªå¥‡æ•°çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™ $ans = \sum\limits_{i = 1}^{n - 2m}$</p><p>$odd$ æ˜¯æ°å¥½ï¼Œä¸å¥½ç®—ï¼ŒäºŒé¡¹å¼åæ¼”ä¸€æ³¢ï¼šè®¾ $f$ è¡¨ç¤ºè‡³å°‘, æ¥ä¸‹æ¥å°±ç®— $f$</p><p>$$odd_i = \sum\limits_{j = i}^D (-1)^{j - i} C(j, i) f_j$$</p><p>$$= \sum\limits_j (-1)^{j - i} \frac{j!}{i!(j - i)!} f_j$$</p><p>$$= \frac{1}{i!} \sum_j \frac{(-1)^{j - i}}{(j - i)!} j!f_j$$</p><p>æ˜¾ç„¶çš„å·ç§¯å½¢å¼ã€‚</p><p>ä¼šæƒ³èµ·æ•°åˆ— ${0, 1, 0, 1, \cdots}$ çš„ $EGF$ ä¸º $\frac{e^x - e^{-x}}{2}$ï¼Œæœ‰ï¼š</p><p>$$f_k = C(D, k) n! [x^n] ( (\frac{e^x - e^{-x}}{2})^k (e^x)^{D - k} )$$</p><p>$$= C(D, k) \frac{n!}{2^k}\sum\limits_{j = 0}^k C(k, j) (-1)^{k - j} e^{(D + 2(j - k))x}$$</p><p>$$= \frac{C(D, k)}{2^k} \sum\limits_{j = 0}^k \frac{k!}{j!(k - j)!} (-1)^j (D - 2j)^n$$</p><p>$$= \frac{D!}{2^k(D - k)!} \sum\limits_{j = 0}^k \frac{(-1)^j (D - 2j)^n}{j!} \frac{1}{(k - j)!}$$</p><p>å·ç§¯ï¼å®Œäº‹äº†ã€‚</p><h3 id="CF755G-Poland-Ball-and-many-other-Balls"><a href="#CF755G-Poland-Ball-and-many-other-Balls" class="headerlink" title="CF755G-Poland Ball and many other Balls"></a><a href="https://www.luogu.com.cn/problem/CF755G" target="_blank" rel="noopener">CF755G-Poland Ball and many other Balls</a></h3><p>æ€è·¯ç®€å•ï¼Œé€‚åˆç»ƒä¹ å¤„ç†ç”Ÿæˆå‡½æ•°çš„ Trickã€‚</p><p>å®¹æ˜“å†™å‡º $dp$ æŸ¿å­ï¼š$f_{n, k} = f_{n - 1, k} + f_{n - 1, k - 1} + f_{n - 2, k - 1}$</p><h3 id="1-ç‰¹å¾æ–¹ç¨‹"><a href="#1-ç‰¹å¾æ–¹ç¨‹" class="headerlink" title="$1. ç‰¹å¾æ–¹ç¨‹$"></a>$1. ç‰¹å¾æ–¹ç¨‹$</h3><p>æœ‰é€’æ¨å…³ç³»â€”â€” $K$ ç”± $K$ å’Œ $K - 1$ æ¨å¾—ï¼Œäºæ˜¯è®¾ $F(x)$ è¡¨ç¤º $\sum_k f_{n, k}x^k$, åˆ—å‡ºç”Ÿæˆå‡½æ•°ï¼š$F_n(x) = F_{n - 1}(x) + xF_{n - 1}(x) + xF_{n - 2}(x)$ï¼Œå³ $F_n(x) = (1 + x)F_{n - 1}(x) + xF_{n - 2}(x)$</p><p>è¿™ç©æ„é•¿å¾—ä¸€è„¸ç‰¹å¾æ–¹ç¨‹ï¼Œäºæ˜¯å¼•å…¥æ–°çš„å…ƒ $z$ï¼Œè§£å‡º $z = \frac{ 1 + x \pm \sqrt{ 1 + 6x + x^2 } }{2}$</p><p>ç®—å‡ºé€’æ¨å¼çš„ $c_1$ å’Œ $c_2$ ä»¥åå¤šé¡¹å¼å…¨å®¶æ¡¶å°±å®Œäº‹äº†ã€‚ç„¶è€Œè’Ÿè’»å¹¶ä¸ä¼šç®—ï¼Ÿ</p><h3 id="2-å€å¢"><a href="#2-å€å¢" class="headerlink" title="$2. å€å¢$"></a>$2. å€å¢$</h3><p>è¿˜æ˜¯ä¸Šé¢é‚£ä¸ªæŸ¿å­ï¼Œä¸ä¸€æ ·çš„è§’åº¦çœ‹åˆ°çš„æ˜¯åŠ å¤§æ­¥é•¿è½¬ç§»â€”â€” æ ¹æ®ä¸­é—´æ˜¯å¦å‰²å¼€ä¸€ä¸ªç›¸é‚»çš„å—åˆ†ç±»è®¨è®ºï¼Œ$F_{n + m}(x) = F_n(x)F_m(x) + xF_{n - 1}(x)F_{m - 1}(x)$</p><p>$F_{2n}(x) = F_n^2(x) + xF_{n - 1}^2(x)$</p><p>$F_{2n - 1}(x) = F_n(x)F_{n - 1}(x) + xF_{n - 1}(x)F_{n - 2}(x)$</p><p>$F_{2n - 2}(x) = F_{n - 1}^2(x) + xF_{n - 2}^2(x)$</p><p>äºæ˜¯å°±å¯ä»¥ç”± $F_n(x)$, $F_{n - 1}(x)$, $F_{n - 2}(x)$ å¾—åˆ° $F_{2n}(x)$, $F_{2n - 1}(x)$, $F_{2n - 2}(x)$ å•¦</p><h3 id="3-ç»„åˆå®¹æ–¥"><a href="#3-ç»„åˆå®¹æ–¥" class="headerlink" title="$3. ç»„åˆå®¹æ–¥$"></a>$3. ç»„åˆå®¹æ–¥$</h3><p>è¿™ä¸ªæ¯”è¾ƒæœ‰æ„æ€ï¼ˆé›¾ï¼‰ï¼Œè’Ÿè’»æƒ³å†™è¿™ä¸ªæ–¹æ³•ã€‚ä¸èƒ½ä¸€ä¸Šæ¥å°±è¯´â€œæ»¡è„¸â€/â€œä¸€çœ¼â€ä¹‹ç±»çš„è¯å•Šï¼Œä½ æ ¹æœ¬éƒ½è¿˜æ²¡çœ‹å‡ºé—¨é“å‘¢ã€‚</p><p>æšä¸¾ä¸¤çƒç»„çš„ä¸ªæ•°ï¼Œ$f(k) = \sum_i \binom{n - i}{k} \binom{k}{i}$ã€‚ç„¶åå°±ä¸ä¼šäº†ï¼Œè¿™ç©æ„å’‹æ•´å•Šï¼Ÿ</p><p>é¢˜è§£æœ‰ç¥ä»™åŠæ³•ï¼Œéœ€è¦ä½ è¶³å¤Ÿçµæ´»ï¼šç»„åˆæ„ä¹‰ï¼Œå…ˆä»å‰ $K$ ä¸ªé‡Œé€‰ä»»æ„ä¸ªï¼Œå†ä»å‰©ä¸‹çš„é‡Œé€‰ $K$ ä¸ªã€‚</p><p>è¿™æœ‰ä¸ªè›‹ç”¨ï¼Ÿ</p><p>éšè—å…³ç³»ï¼š<em>ä¸é‡å¤</em>ã€‚é‡å¤è¿™ç©æ„å°±å¯ä»¥å®¹æ–¥ï¼Œè®¾ $F(k)$ è¡¨ç¤ºæ°å¥½é‡å¤ $k$ ä¸ªï¼Œ$G(k)$ è¡¨ç¤ºè‡³å°‘é‡å¤ $k$ ä¸ªã€‚</p><p>$$G(i) = \binom{k}{i} \binom{n - i}{k - i} 2^{k - i}$$</p><p>$$F(0) = \sum\limits_{i = 0}^k (-1)^i G(i)$$</p><p>$$= \frac{k!}{(n - k)!} \sum\limits_{i = 0}^k \frac{(-1)^i(n - i)!}{i!} \cdot \frac{2^{k - i}}{((k - i)!^2)}$$</p><p>$n$ è¿‡å¤§ï¼Œæ€ä¹ˆåŠï¼ŸåŒ–ä¸‹é™å¹‚ã€‚ã€‚è¿™å…¶å®æ˜¯ä¸€ä¸ªè‡ªç„¶çš„äº‹æƒ…ï¼Œå¯èƒ½æˆ‘è¿˜æ²¡é€‚åº”ç½¢ã€‚</p><p>$$= \frac{k!n!}{(n - k)!} \sum\limits_{i = 0}^k \frac{(-1)^i(n - i)!}{i!n!} \cdot \frac{2^{k - i}}{((k - i)!^2)}$$</p><p>$$= k!n^{\underline{k}} \sum\limits_{i = 0}^k \frac{(-1)^i}{i!n^{\underline{i}}} \cdot \frac{2^{k - i}}{((k - i)!^2)}$$</p><p><a href="https://codeforces.com/problemset/submission/755/102687760" target="_blank" rel="noopener">$Code$</a></p><p>æ³¨æ„ç©ºé—´è¦å¼€è¶³ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç”Ÿæˆå‡½æ•° </tag>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NOIP2020èµ›å‰è®­ç»ƒå°ç»“</title>
      <link href="2020/12/05/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%91NOIP2020%E8%B5%9B%E5%89%8D%E8%AE%AD%E7%BB%83%E5%B0%8F%E7%BB%93/"/>
      <url>2020/12/05/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%91NOIP2020%E8%B5%9B%E5%89%8D%E8%AE%AD%E7%BB%83%E5%B0%8F%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>å¼€ä¸€ç¯‡åšå®¢ï¼ŒåŠ©åŠ› $NOIP2020$</p><p>å°‘æµªè´¹æ—¶é—´åœ¨æ— æ„ä¹‰çš„è‡ªæˆ‘æ€€ç–‘ä¸­ï¼Œ$you\ do\ have\ a\ lot\ to\ learn$ï¼Œä¿æŒç¨³å®šè€Œæ¬£å–œçš„å¿ƒæ€ å¥”è·‘å§ï¼</p><p><em>çœ¼é«˜æ‰‹ä½é€šè¿‡ç»ƒä¹ æ‰‹ä¼šæ…¢æ…¢å˜é«˜ï¼Œçœ¼ä½æ‰‹ä½ç»ƒåˆ°æ­»éƒ½æ˜¯èœã€‚</em></p><p><em>æŠ±æ€¨èº«å¤„é»‘æš—ï¼Œä¸å¦‚æç¯å‰è¡Œã€‚æ„¿ 11.7 å‡ºè€ƒåœºçš„æˆ‘ä¸ç•™é—æ†¾ï¼</em></p><p><em>ä¸éª„ï¼Œä¸èºï¼Œä¸æƒ§ï¼Œä¸æ‚”ã€‚</em></p><hr><h3 id="9-5"><a href="#9-5" class="headerlink" title="9.5"></a>9.5</h3><p>noi2019D1T1ï¼ˆæ–œç‡ä¼˜åŒ–ï¼‰ï¼Œapio2020T2ï¼ˆkruskalé‡æ„æ ‘ï¼‰, ä¸€é“çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾ï¼Œæ˜¥èŠ‚åäºŒå“ï¼ˆå †å’Œè´ªå¿ƒï¼‰</p><h3 id="9-6"><a href="#9-6" class="headerlink" title="9.6"></a>9.6</h3><p>uoj455ï¼ˆå¯æ’¤é”€è´ªå¿ƒæ¨¡æ‹Ÿè´¹ç”¨æµï¼‰ï¼Œluogu4260ï¼ˆè®¡æ•° + è«é˜Ÿç®—ç»„åˆæ•°å‰ç¼€å’Œï¼‰</p><h3 id="9-7"><a href="#9-7" class="headerlink" title="9.7"></a>9.7</h3><p>cf558eï¼ˆçº¿æ®µæ ‘åŒºé—´æ’åºï¼Œå®è´¨æ˜¯åŒºé—´èµ‹å€¼ï¼‰ï¼Œcf1194fï¼ˆæœŸæœ›è®¡æ•° + å¤æ‚åº¦åˆ†æï¼‰ï¼Œcf round 664 div1 A ~ C</p><h3 id="9-8"><a href="#9-8" class="headerlink" title="9.8"></a>9.8</h3><p>luogu2542ï¼ˆæœ‰ç‚¹ç‚¹å¥—è·¯çš„æ ‘å‰–é¢˜ï¼‰ï¼Œcf1327fï¼ˆé™åˆ¶dpï¼‰ï¼Œuoj209ï¼ˆæ€ç»´ï¼‰ï¼Œuoj210ï¼ˆ2-satï¼‰</p><h3 id="9-9"><a href="#9-9" class="headerlink" title="9.9"></a>9.9</h3><p>loj3158ï¼ˆè´ªå¿ƒ + å †ï¼Œæ¨¡æ‹Ÿè´¹ç”¨æµï¼‰ï¼Œuoj58</p><h3 id="9-10"><a href="#9-10" class="headerlink" title="9.10"></a>9.10</h3><p>9.10 çš„è®­ç»ƒè®°å½•è¢«åäº†</p><h3 id="9-14"><a href="#9-14" class="headerlink" title="9.14"></a>9.14</h3><p>cf986cï¼ˆç®€å•äºŒè¿›åˆ¶é¢˜ï¼‰ï¼Œloj3303ï¼ˆçº¿æ®µæ ‘åˆå¹¶ 01 trieï¼‰ï¼Œuoj137ï¼ˆå·§å¦™åŠ ç»´ dpï¼‰ï¼Œuoj134ï¼ˆå›¾çš„è¿é€šæ€§ï¼‰ï¼Œç‰›å®¢ç»ƒä¹ èµ›69ï¼ˆABCEï¼‰ï¼Œæ€»ç»“å°±æ˜¯åˆ‡äº†ä¸€å¤©æ°´é¢˜</p><hr><p>æˆ‘æ¥å¡«å‘ï¼Œåˆèµ› 90.5 ç¨³ç¨³é£è¿‡ï¼Œå¸Œæœ›å¤èµ›ä¹Ÿèƒ½ç¨³ç¨³çš„å‘€ ~ å‰æ®µæ—¶é—´å¤ªå¿™äº†ï¼Œä½†æ˜¯è§‰å¾—è®­ç»ƒå°ç»“å¾ˆé‡è¦ï¼Œå¸Œæœ›å¯¹è‡ªå·±çš„ç¨‹åº¦æœ‰æ¸…æ™°çš„è®¤çŸ¥ã€‚</p><h3 id="10-17"><a href="#10-17" class="headerlink" title="10.17"></a>10.17</h3><p>æ¨¡æ‹Ÿèµ›ç®€å•æ•°è®ºï¼ˆå at é£ï¼‰+ èƒŒåŒ…åˆ†æ²»ï¼ˆå¥—è·¯é£ç„¶è€Œè¿˜æ˜¯ä¸ä¼šã€‚ã€‚ï¼‰+ è®¡æ•°æ¨æŸ¿å­ï¼Œæ„Ÿè§‰è‡ªå·±è®¡æ•°çš„æ°´å¹³æœ‰é•¿è¿›ä½†è¿˜ä¸å¤Ÿã€‚<strong>dp å¤šç»ƒï¼</strong></p><h3 id="10-18"><a href="#10-18" class="headerlink" title="10.18"></a>10.18</h3><p>cf div2 æ‰‹é€Ÿåœº 4 é“ã€‚wxw 26 min AC 2E å¥½å¼ºå‘€ï¼cf ç°åœºçœŸçš„è·Ÿ vp ä¸ä¸€æ ·ã€‚ç»“è®ºï¼š<strong>å¤šæ‰“ cfï¼</strong>ï¼ˆæœ‰æ—¶é—´ vp å°±ä¸é”™äº†= =</p><p>AT ä¸¤é“ï¼Œä¸€æ˜¯ç¥å¥‡çš„å¼‚æˆ–è½¬ % 2 æ„ä¹‰ä¸‹åŠ æ³•ï¼Œç”¨å¤šé¡¹å¼ gcd åšï¼›äºŒæ˜¯ä¸éš¾ä½†å°å·§æ¸…æ–°çš„åŒä½™æœ€çŸ­è·¯ã€‚</p><h3 id="10-19"><a href="#10-19" class="headerlink" title="10.19"></a>10.19</h3><p>è¢«åäº†ï¼ˆå¿˜è®°è®°å½•äº†</p><h3 id="10-20"><a href="#10-20" class="headerlink" title="10.20"></a>10.20</h3><p>æ•ˆç‡ä½çš„ä¸€å¤©â€¦qaq å†™äº† LCT æ¿å­ï¼Œè¿˜æœ‰ä¸€å †ç®€å•é¢˜</p><h3 id="10-21"><a href="#10-21" class="headerlink" title="10.21"></a>10.21</h3><p>ä»Šå¤©ä¹Ÿæ²¡æœ‰æ¨¡æ‹Ÿèµ›ã€‚ã€‚å¼€å¿ƒ ä½†æ˜¯æœ‰ç‚¹æ…Œï¼Œæ„Ÿè§‰è‡ªå·±å¤èµ›æ°´å¹³ååˆ†ä¸ç¨³</p><h3 id="10-22"><a href="#10-22" class="headerlink" title="10.22"></a>10.22</h3><p>XJ æ¨¡æ‹Ÿèµ›åæ°´äº†ï¼Œvp cf è¿œå¤åœºï¼ˆæ‰ä¿¡å¿ƒï¼‰å§ï¼è¿˜å†™äº†ä¸¤é“ at</p><h3 id="10-23"><a href="#10-23" class="headerlink" title="10.23"></a>10.23</h3><p>ä»Šå¤©æ•ˆç‡ä¸é«˜ã€‚ä¸è¿‡å¼€å§‹å¬è¯¾å•¦ï¼åŠ æ²¹åŠ æ²¹åŠ åŠ æ²¹ï¼ï¼ï¼ï¼</p><p>ç®€å•é¢˜åŠ ä¸Šå¯¹æ‹éƒ½èƒ½ä¿è¯å†™å‡ºäº†ï¼Œç°åœ¨å°±æ˜¯é•¿ä»£ç çš„è°ƒå†™å’Œæ€ç»´è¦åŠ é‡è®­ç»ƒã€‚</p><hr><p>CSP æ²¡æœ‰è€ƒå¥½ï¼Œå‰æœŸçš„è®­ç»ƒè¿˜æ˜¯æŒºæµ®èºçš„ï¼Œå¿ƒæ€ä¹Ÿæ²¡å…»å¥½ã€‚ä¸éª„ä¸èºï¼Œä¸æƒ§ä¸æ‚”ï¼Œåšå®šçš„æ²‰é™çš„èµ°è‡ªå·±çš„è®¡åˆ’ã€‚ç»§ç»­å¼€å‘ã€‚</p><h3 id="11-19"><a href="#11-19" class="headerlink" title="11.19"></a>11.19</h3><p>å­¦äº†æ–¯å¦çº³æ ‘ã€‚åšäº† THUSCH-å·§å…‹åŠ›ã€‚vp å¹¶è®¢æ­£äº† CF185(Div1) BCDã€‚åšäº† loj2277, loj6033ã€‚çœ‹åˆ°æœ‰è¶£çš„é¢˜ä¼šåŠ è¿›é¢˜å•é‡Œçš„ã€‚</p><p>psï¼šæˆ‘çœŸçš„å¥½å–œæ¬¢ LOJ å‘€ ~</p><h3 id="11-20"><a href="#11-20" class="headerlink" title="11.20"></a>11.20</h3><p>To do listï¼šuer 4 å’Œ 6 çš„ T3, å¤§å‰å¤© T3ï¼Œæ¨æŸ¿å­</p><p>vp å¹¶è®¢æ­£äº† CF#FF(Div1) çš„ BCDã€‚åšäº† loj2118ã€‚è‡ªå·±æ¨äº†ä¸€ä¸ªå¹³å¹³æ— å¥‡çš„æŸ¿å­ï¼ˆ</p><h3 id="11-21"><a href="#11-21" class="headerlink" title="11.21"></a>11.21</h3><ul><li>ä»Šå¤©æ¨¡æ‹Ÿèµ›æ²¡æœ‰ fstï¼300ï¼ï¼ˆæœ‰ç”Ÿä¹‹å¹´ç³»åˆ— (<em>â—‘âˆ‡â—‘)çˆ»(â—âˆ‡â—</em>)ï¼ˆè™½ç„¶å¤§å®¶ä»Šå¤©åˆ†éƒ½å¾ˆé«˜ï¼ˆä½†æ˜¯æˆ‘å’Œ LMOliver ç¥ä»™åŒåˆ†è¯¶ï¼ˆä¸è¦ä¹æç”Ÿæ‚²= = å¹³é™ä¸€ç‚¹ï¼ˆä½ çš„å†…å¿ƒæˆå·²ç»æº¢å‡ºå±å¹•äº†^-^</li></ul><p>To do list: è®¢æ­£ monisaiï¼Œuer 4 å’Œ 6 çš„ T3ï¼Œå¤§å¤§å‰å¤© T3</p><p>è®¢æ­£äº† monisaiï¼Œåšäº† uer 4 çš„ T3</p><h3 id="11-22"><a href="#11-22" class="headerlink" title="11.22"></a>11.22</h3><p>To do list: uer 6 çš„ T3ï¼Œuoj274, å¤§å¤§å¤§å‰å¤© T3ï¼Œè®¢æ­£ vp, litble * 1</p><p>åšäº† uer 6 çš„ T3ï¼Œè®¢æ­£äº† vp çš„ CF1163C2ã€Eã€F</p><h3 id="11-23"><a href="#11-23" class="headerlink" title="11.23"></a>11.23</h3><p>To do list: è®¢æ­£æ¨¡æ‹Ÿèµ›ã€vpï¼Œåˆ‡æ ‘æ¸¸æˆ, å›½ç‹é¥®æ°´è®°ï¼Œæ—¶ç©ºæ—…è¡Œï¼Œloj3057</p><p>è®¢æ­£äº†æ¨¡æ‹Ÿèµ›ï¼Œvp CF516 BCDEï¼Œåˆ‡æ ‘æ¸¸æˆ</p><h3 id="11-24"><a href="#11-24" class="headerlink" title="11.24"></a>11.24</h3><p>âš ï¸ ä»Šå¤©çš„æ¨¡æ‹Ÿèµ›ğŸ’¥äº†ï¼ˆæ‰¾å€Ÿå£ï¼šæ¯”èµ›çš„æ—¶å€™ç©¿çš„å¤ªå¤šäº†</p><p>å®é™…ä¸Šæ˜¯ï¼Œè·Ÿ T2 åˆšäº†æ¯”è¾ƒä¹…ï¼Œè‡ªä»¥ä¸ºå†™äº†æ­£ç¡®çš„åšæ³•å°±ä¸¢äº†ï¼Œåˆå†™äº† T3 çš„ 40 åˆ†æš´åŠ›å°±å¿ƒæ»¡æ„è¶³ä»¥ä¸ºå…¶ä»–äººä¹Ÿä¸è¿‡ 40 åˆ†ï¼Œå› ä¸ºæˆ‘ä»¥ä¸º T3 æ˜¯ç¥ä»™æ–œç‡ä¼˜åŒ–ï¼Œäº‹å®è¯æ˜æˆ‘å®Œå…¨æƒ³éš¾äº†ï¼æŠŠ w_i æ‹†å¼€å°±æ˜¯ä¸ª sb è´ªå¿ƒï¼æ‰€ä»¥å°±ç‚¸çš„å¾ˆå½»åº•äº†ã€‚äººå‡ 300 çš„åœºå­æˆ‘ 182ï¼Œå¾—æ·±åˆ»åæ€äº†ã€‚</p><p>ä¸éª„ä¸èºï¼Œä¸èƒ½å› ä¸ºå‰ä¸¤å¤©æ‰“å¾—è¿˜è¡Œå°±é£˜äº†ï¼Œnoip æ‰æ˜¯å®šèƒœè´Ÿçš„ä¸€å±€ã€‚ä¸è¿‡ä¹Ÿåˆ«ç´§å¼ äº†ï¼Œæ¯•ç«Ÿåªæ˜¯äººç”Ÿæ¼«æ¼«é•¿è·¯çš„ä¸€å¹•è€Œå·²</p><p>è¿˜æœ‰å°±æ˜¯ï¼Œå›ºå®šæ€ç»´æ˜¯æœ€å¯æ€•çš„ï¼Œä¸èƒ½å› ä¸ºå‰ä¸¤å¤©æ–œç‡ä¼˜åŒ–åšå¤šäº†å°±çœ‹å•¥éƒ½æ˜¯æ–œç‡ä¼˜åŒ–ï¼Œå®ƒæ¥ä¸ªè´ªå¿ƒä½ å°±çŒä¸åŠé˜²ã€‚å‰å‡ å¤©æ‰“å¾—ä¸é”™ä¹Ÿæ˜¯å› ä¸ºæ•¢ä¸æ–­å»å°è¯•æ–°çš„è§’åº¦ã€‚ï¼ˆè¯¶ï¼Œè¿™é¢˜è¿™ä¹ˆåšå¥½åƒæœ‰é«˜åˆ†æš´åŠ›æ‹¿/å¥½åƒå¯ä»¥è‰¹æ ‡ï¼‰æœ€è¿‘é¢˜åˆç®€å•ï¼ŒçœŸçš„ï¼Œå‚»é€¼é¢˜ä¸ä¼šåšå¤ªå¯æ€•äº†ï¼ˆå›æƒ³èµ· csp é¢å¯¹ T3 çš„æ— åŠ©å’Œèµ›åçš„ç—›å¿ƒç–¾é¦–äº†å—ï¼Ÿï¼‰</p><p><strong>æŠŠé—®é¢˜æƒ³å¤æ‚ï¼Œæœ¬è´¨å°±æ˜¯æ²¡æœ‰ä»”ç»†åˆ†æé—®é¢˜æ€§è´¨ï¼</strong> æœç„¶è¿˜æ˜¯æµ®èºäº†å—ã€‚</p><p><strong>å¬ç€ xmlï¼æ¥ä¸‹æ¥çš„ä¸¤å‘¨ï¼Œè¦é¿å…ä¸€åˆ‡å¯èƒ½ä¼šè®©å¿ƒèºèµ·æ¥çš„äº‹æƒ…ã€‚è™½ç„¶å¬ç€å¥½ç¬‘ï¼Œä½†çš„ç¡®æ˜¯è¿™ä¹ˆå›äº‹ã€‚</strong></p><p>To do list: è®¢æ­£ T4ï¼Œå›½ç‹é¥®æ°´è®°ï¼Œvpï¼Œbzoj3636ï¼Œloj3057ï¼Œæ´›è°·3553ã€3558</p><p>T4 æ˜¯é“æ²¡æ„æ€çš„å¤§æ•°æ®ç»“æ„ï¼ŒLCT ä»€ä¹ˆçš„â€¦?ï¼ˆæˆ‘ä¸ç²¾é€š LCT å•Š qaqï¼‰æœ¬è´¨æ˜¯ä¸ª easy çš„é˜¶æ¢¯ nimï¼Œæˆ‘ç«Ÿç„¶ä¸€ç›´åœ¨æƒ³åˆå¹¶å’‹åœ°å’‹åœ°ã€‚ã€‚ã€‚éƒ½è¯´æ˜¯é˜¶æ¢¯ nim äº†ï¼ï¼ï¼æœç„¶è¿˜æ˜¯å­¦è‰ºä¸ç²¾å—ï¼ï¼ï¼</p><p>èƒ¡äº†å›½ç‹é¥®æ°´è®°ï¼ˆä¸æƒ³å†™ï¼‰ï¼ˆåªä¼šæ–œç‡ä¼˜åŒ–ä¸ä¼šè´ªå¿ƒï¼‰ï¼Œvp CF461 BCDEï¼Œbzj3636</p><h3 id="11-25"><a href="#11-25" class="headerlink" title="11.25"></a>11.25</h3><p>ä»Šå¤©æ”¾äº†ä»¥å‰å“¥å“¥ç»™æˆ‘åšè¿‡çš„ mjy çš„ä¸€å¥—é¢˜ï¼ŒT2 ä¸å¹³ç­‰åšå¼ˆæˆ‘å†™ sgã€‚ã€‚ã€‚å…‰è£çˆ† 5ptsã€‚å¦å¤– T3 å‡äº†å¥½å‡ ç§åšæ³•ï¼›æƒ³åˆ°äº†åˆ†æ²»ï¼Œè§‰å¾—ååˆ†æœ‰å‰é€”ï¼Œä½†æ˜¯æ‰‹ç©å°æ ·ä¾‹æŠŠè‡ªå·±å‰äº†ï¼Œåæ¥äº‹å®è¯æ˜è¿™æ˜¯é“ä¸å¯åšé¢˜ï¼Œé¢˜è§£å†™çš„å§å•¦é•¿ï¼Œæœ€å°å‰² dp æ˜¯ä»€ä¹ˆç¥ä»™ç©æ„å•Š (â€ºÂ´Ï‰`â€¹ )ï¼ˆä½†æ˜¯è«åè§‰å¾—åˆ†æ²»æœ‰äº›æ­è¾¹ï¼Ÿ</p><p>To do listï¼šè®¢æ­£æ¨¡æ‹Ÿèµ› T3ï¼Œcf468dï¼Œloj3057, sp3734ï¼Œæ¸¸æˆ</p><p>åšäº† loj3057, cf468d, sp3734ï¼Œæ¸¸æˆ</p><h3 id="11-26"><a href="#11-26" class="headerlink" title="11.26"></a>11.26</h3><p>ä»Šå¤©ä¹Ÿé­é‡äº†ä½ç´ è´¨å‡ºé¢˜äººçš„ç‹‚è½°æ»¥ç‚¸ã€‚T3 polya æ¿é¢˜ä¸ä¼šï¼ŒT4 å®ƒ nã€mã€p çš„æœ€å¤§å€¼éƒ½ä¸åœ¨åŒä¸€æ¡£åˆ†å®³æˆ‘ RE æŒ‚äº† 80ï¼Ÿï¼Ÿï¼Ÿï¼ˆè¿™å¹´å¤´ä»€ä¹ˆæ²™é›•éƒ½æœ‰</p><p>To do listï¼šè®¢æ­£ vpï¼Œå­¦ä¹ polyaï¼ˆé€‰ï¼‰ï¼ŒDruzynyï¼Œuoj390, åºåˆ—, AGC011F</p><ul><li><p>å› ä¸ºå¤šäººè®²è¯¾ï¼ˆtyy &amp; kqhï¼‰æ‰€ä»¥è®¡åˆ’å’•äº†ä¸€å¤§åŠ</p></li><li><p>å‘ç° kqh è®²è¯¾éå¸¸å½¢è±¡ï¼Œå„ç§ç®—æ³•éƒ½èƒ½éšä¾¿ç”»ç¤ºæ„å›¾ï¼Œå¤§æ¦‚è¿™æ ·ä¼šå¸®åŠ©åŠ æ·±ç†è§£ã€‚æˆ‘ä¹Ÿè¯•è¯•ï¼Ÿï¼</p></li></ul><p>åšäº† CF578 çš„ CDE, Druzyny</p><h3 id="11-27"><a href="#11-27" class="headerlink" title="11.27"></a>11.27</h3><p>ä»Šå¤©ä¹Ÿé­é‡äº† sb çš„è‡ªå·±ã€‚ç¬¬ä¸‰æ¬¡åœ¨æ’åºå‰æ±‚å‰ç¼€å’Œäº† æˆ‘æ˜¯ sbï¼ï¼ï¼</p><p>To do listï¼šè®¢æ­£æ˜¨å¤© Fï¼Œuoj390ï¼ŒAGC011Fï¼Œloj3276, å­¦ä¹  polya &amp; è®¢æ­£æ˜¨å¤© T3ï¼Œvp</p><p>æ²¡é”™ï¼Œåšä¸å®Œå‰é¢çš„ä»Šå¤©ä½  xml å°±åˆ«æƒ³ vpã€‚</p><p>åšäº† æ˜¨å¤© Fï¼Œuoj390ï¼Œç–«æƒ…æ§åˆ¶ï¼ŒåŠé“ AGC011Fï¼ŒåŠé“ loj3276</p><h3 id="11-28"><a href="#11-28" class="headerlink" title="11.28"></a>11.28</h3><p>ä»Šå¤©æ˜¯ Fuyuki å‡ºçš„å¤šæ ¡è”è€ƒé¢˜ã€‚æ²¡æ‰“æŒ‚ï¼hohoï¼280ï¼ï¼ˆå…¶å®æ˜¯æ•°æ®æ°´ï¼Œå¤šç»™æˆ‘ 30ï¼ˆç„¶åæ‰“å‡ºäº† 100 80 60 40 è¿™æ ·æ¼‚äº®çš„ç­‰å·®æ•°åˆ—åˆ†</p><p>ä½ çœ‹äººå®¶ ä¸‡è€çˆ·ï¼ŒåŒæ · 280ï¼Œäººå®¶ T1 fst æˆ 0ï¼Œæœ¬æ¥åŠæ‰“æˆ‘ 100 åˆ†å‘¢ï¼ä¸éª„ä¸èºï¼Œä»è¦å‘ä¸‹æ‰æ ¹ï¼Œå‘ä¸Šç»“æœã€‚æˆ‘ä»¬æ¯ä¸€ä¸ªäººéƒ½è¦ç ¥ç ºå‰è¡Œã€‚</p><p>åŒºé—´å‘åŒºé—´è¿è¾¹ï¼Œå¦‚æœæœ‰åºå°±å¯ä»¥è€ƒè™‘å€å¢å¹¶æŸ¥é›†æˆ–è€…çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾ä»€ä¹ˆçš„â€¦</p><p>To do list: loj3276, 3277, 3278, å­¦ä¹  polya è®¢æ­£ T3ï¼ŒAGC011F</p><p>åšäº† loj3276. æ‰€ä»¥ä»Šå¤©æ˜¯å¾—æ„å¿˜å½¢çš„é¢“åºŸçš„ä¸€å¤©ï¼Œè¶…çº§å·®è¯„ï¼Œxml ä½ æ¸…é†’ä¸€ç‚¹ï¼Ÿï¼Ÿï¼Ÿ</p><h3 id="11-29"><a href="#11-29" class="headerlink" title="11.29"></a>11.29</h3><p>æ‰“äº†å›¾çµæ¯ï¼Œzzq å‡ºçš„é¢˜çœŸçš„ä¸€è¨€éš¾å°½ã€‚ã€‚ã€‚</p><p>çŸ¥é“æœ‰ä¸€ç§å¿«é€Ÿé˜¶ä¹˜ç®—æ³•ï¼š<a href="https://www.cnblogs.com/gryzy/p/6015485.html" target="_blank" rel="noopener">https://www.cnblogs.com/gryzy/p/6015485.html</a></p><p>To do listï¼šloj3277ï¼Œloj3278ï¼Œvp cfï¼ŒAGC011Fï¼Œå“¥å“¥çš„ SRM</p><p>åšäº† loj3277ï¼Œloj3278ï¼Œvp CF657 AB</p><h3 id="11-30"><a href="#11-30" class="headerlink" title="11.30"></a>11.30</h3><p>æœ€è¿‘è”è€ƒé¢˜ï¼Œè´¨é‡æ¯” XJ è‡ªå·±çš„æ¨¡æ‹Ÿèµ›å¥½å¤šäº†ï¼ï¼ï¼ï¼ˆæ„Ÿè§‰åƒé¥¿ä¹…äº†çš„å­©å­åƒåˆ°è‚‰çš„å¿ƒæƒ…</p><p>å¸¦æ‚”è´ªå¿ƒçœŸçš„å–µå–µ!! ,,Ô¾ã…‚Ô¾,,</p><p>To do list: è®¢æ­£ CF657 CDEï¼ŒAGC011Fï¼Œè®¢æ­£æ¨¡æ‹Ÿèµ›ï¼Œloj3275, loj3271, loj3281ï¼Œå“¥å“¥çš„ SRM</p><p>è®¢æ­£ CF657 CDEã€æ¨¡æ‹Ÿèµ›ï¼Œåšäº† AGC011F, loj3271</p><ul><li>å†™åæ‚”è´ªå¿ƒçš„æ€»ç»“ï¼Ÿä»Šå¤© T4 + é›ªç¾ä¸å¤–å–ï¼ˆæ¨¡æ‹Ÿè´¹ç”¨æµä¹Ÿå®‰æ’ä¸Šï¼‰</li></ul><h3 id="12-1"><a href="#12-1" class="headerlink" title="12.1"></a>12.1</h3><p>ä»Šå¤©å‡ ä¹ AK äº†ã€‚ã€‚é¢˜è¿˜ä¸é”™å§æˆ‘è§‰å¾—ï¼ˆï¼Ÿï¼‰T4 çº¯ç²¹æ˜¯å†™æ³•é—®é¢˜å•¦ã€‚ã€‚åœ¨çº¿çº¿æ®µæ ‘å°±æ˜¯è·‘ä¸è¿‡ç¦»çº¿æ ‘çŠ¶æ•°ç»„å˜›ï¼Œæ— è®ºä»ç©ºé—´è¿˜æ˜¯æ—¶é—´ä¸Šçœ‹ã€‚</p><p>To do listï¼šè®¢æ­£ T4ï¼Œloj3275, vpï¼Œå“¥å“¥çš„ SRMï¼Œbzoj3864</p><p>è®¢æ­£ T4ï¼Œvp CF673 EFï¼Œloj3275</p><h3 id="12-2"><a href="#12-2" class="headerlink" title="12.2"></a>12.2</h3><p>csp T2 é¢˜ç›®æ¼æ‰ä¸€å¥è¯ï¼Œå†™äº†ç¦»æ•£åŒ–è¢«å¡äº† 35 åˆ†ã€‚ã€‚ã€‚<strong>xml ä½ ä¸è¦å†è¯»é”™é¢˜äº†å•Šï¼</strong></p><p>ä¸ºäº†ä¸è¯»é”™é¢˜ï¼Œç¬¬ä¸€éå°±è¦å¾ˆè®¤çœŸå¾ˆä»”ç»†ã€‚æˆ‘è§‰å¾—æœ€å¥½çš„åŠæ³•å°±æ˜¯å¼€è€ƒé€šè¯»æ‰€æœ‰é¢˜ï¼Œè¿™æ—¶å€™å› ä¸ºè¿˜æ²¡å¼€è°ƒï¼Œå¿ƒæ€æ˜¯æ¯”è¾ƒç¨³å¥çš„ã€‚å…³äºæ•°æ®èŒƒå›´ã€æ®µæœ«æ®µä¸­çš„ç»†èŠ‚ä¹‹å¤„ï¼Œå„ç§å¥‡æ€ªçš„â€œä¿è¯â€ï¼Œåˆ‡è«å¿½è§†äº†ï¼è€Œä¸”ç¬¬ä¸€éå¦‚æœè¯»é”™ï¼Œåé¢å°±æå®¹æ˜“é™·å…¥æƒ¯æ€§æ€ç»´ï¼Œå°±æ— æ„ä¸­çŠ¯ä¸‹äº†æ¯”èµ›å¤§å¿Œã€‚</p><p>å…³äºä»Šå¤©çš„æ¨¡æ‹Ÿèµ›ï¼Œæ¬äº† LOJ é¦–é¡µ COCI2020 å››é“åŸé¢˜ã€‚ã€‚ã€‚T2 æœ¬è¯¥æƒ³å‡ºæ¥çš„ï¼Œæ ‘çš„é‡å¿ƒä¹Ÿæ²¡é”™ï¼Œä½†åŒä¸€ä¸ªå­æ ‘é‡Œä¹Ÿå¯ä»¥é€‰ä¸¤ä¸ªå°å­æ ‘å•Šã€‚ã€‚T3 æ ‘å½¢ dp æ²¡å†™å‡ºæ¥ï¼Œç»†èŠ‚è´¼å¤šã€‚ã€‚T4 å£èƒ¡åº”è¯¥æ˜¯å¯¹çš„ï¼Œç¬›å¡å°”æ ‘ + çº¿æ®µæ ‘ç»´æŠ¤å‡¸åŒ…ï¼ˆæˆ–ç»´æŠ¤å•è°ƒæ ˆï¼Œåº”è¯¥å·®ä¸ç¦»ï¼‰ï¼Œä½†å¥½éš¾å†™çš„æ„Ÿè§‰ = = æœ‰äº›è®¸è‡ªé—­ã€‚ã€‚ã€‚</p><p>ã€Œæˆ‘ä¼šå˜æˆä¸€ä¸ªæ›´å¥½çš„äººå— / ç›¸æ¯”è‡ªå·± ç›¸æ¯”æ˜¨å¤© / â€œä½ ä¼šå•Šâ€ã€</p><p>To do list: è®¢æ­£ T2ã€T3ã€T4ï¼Œè®¢æ­£æ˜¨å¤© vp çš„ Fï¼Œloj3280ï¼Œbzoj3864, å“¥å“¥çš„ SRMï¼Œéº»å°†</p><p>è®¢æ­£äº† T2ï¼ŒT3ï¼ŒT4ï¼Œæ˜¨å¤© Fï¼Œbzoj3864, loj3272</p><h3 id="12-3"><a href="#12-3" class="headerlink" title="12.3"></a>12.3</h3><p>ä»Šå¤© T2 æš´åŠ›æ²¡æŒ‚ï¼rush äº† T2 ä¸¤åª log åšæ³•ç»“æœ wa å¾—æ¸£éƒ½ä¸å‰© ğŸ˜ŠğŸ’¢ T1 äººç±»æ™ºæ…§é¢˜æˆ‘è®¤è¾“ï¼ˆè™½ç„¶ä¸éš¾ï¼‰ï¼ŒT3 å…¶å®ä¸éš¾æƒ³ï¼è€ƒåœºä¸Šå°±ä»¥ä¸ºåªæœ‰ LCT èƒ½åšï¼Œå®é™…ä¸ŠæŠŠæ“ä½œæ”¾åˆ°æ ‘å½¢ç»“æ„ä¸Šçœ‹å°±å¯ä»¥ç”¨æ¸…çœŸçš„å¹¶æŸ¥é›†ç»´æŠ¤ã€‚</p><p>æ„Ÿè§‰è‡ªå·±æœ€è¿‘æ‡‚å¾—ä¸œè¥¿å¤šä¸€äº›äº†ï¼Œå°±è€æŠŠé¢˜å¾€éš¾äº†æƒ³ï¼ˆè¿˜æ˜¯èœçš„ä¸€ç§ä½“ç°ï¼‰ï¼Œè®¸å¤šé¢˜éƒ½æœ‰æ¸…çœŸçš„ç²¾å¦™åšæ³•å•Šã€‚</p><p>To do list: è®¢æ­£æ¨¡æ‹Ÿèµ› T2ã€T3ï¼Œloj3280ï¼Œvpï¼Œæ¸¸å›­ä¼šï¼Œéº»å°†ï¼Œå“¥å“¥çš„ SRMï¼Œxza åœº</p><ul><li>å¥—è·¯ï¼šç®€å• dp å±•å¼€ï¼Œå¦‚ f[i] = min(f[i - 1] + 1, a[i]) å¯å±•å¼€æˆ f[r] = min(f[l - 1] + 1, a[l], a[l + 1], â€¦ a[r]) ç„¶åå°±èƒ½ä¸Šæ•°æ®ç»“æ„äº†ã€‚</li></ul><p>è®¢æ­£äº† T3ã€T2ï¼Œvp äº† CF806 Dï¼ˆE å£èƒ¡ï¼ŒF æŒ–å‘ã€‚ã€‚ï¼‰loj3280ï¼ˆå£èƒ¡ï¼‰, æ¸¸å›­ä¼šï¼ˆæˆ‘çˆ± dp å¥— dpï¼ï¼‰</p><h3 id="12-4"><a href="#12-4" class="headerlink" title="12.4"></a>12.4</h3><p>è€ƒå‰æœ€åä¸€å¤©ï¼å¥¥åˆ©ç»™ï¼ï¼ï¼</p><p>To do listï¼šè®¢æ­£ vpï¼Œéº»å°†ï¼Œå“¥å“¥çš„ SRMï¼Œxza åœºï¼Œloj3280ï¼Œloj6302ï¼Œä¸€äº›å›é¡¾ã€‚</p><ul><li>çœ‹<a href="https://www.cnblogs.com/owenyu/p/7815234.html" target="_blank" rel="noopener">è¿™ä¸ª</a></li></ul><p>æ²¡å®Œæ²¡äº†çš„è‡ªé—­ï¼Œxml ä½ çƒ¦ä¸çƒ¦å•Šä½ ï¼</p><p>ä»Šå¤©æ¨¡æ‹Ÿèµ›ï¼Œä¿¡å¿ƒèµ›ï¼Œå´æ¥è¿è¯»é”™ä¸¤é“é¢˜ã€‚è¦æ˜¯åœ¨æ˜å¤©çš„ NOIP è€ƒåœºä¸Šå› ä¸ºè¯»é¢˜å¤±åˆ†é‚£çœŸæ˜¯è¿½æ‚”è«åŠäº†å•Šï¼ä¸è¦è®©æœªæ¥ä¸ºäº†è‡ªå·±çš„å‚»é€¼ä¹°å•ã€‚å› ä¸ºæ˜å¤©å°±è¦æ¯”èµ›ï¼Œä»Šå¤©çš„å¿ƒæ€ä¸å¹³å’Œã€‚è¦æ˜¯è¿™æ ·åˆ°æ˜å¤©çš„èµ›åœºä¸Šå²‚ä¸æ˜¯é‡è¹ˆ CSP çš„è¦†è¾™ï¼Ÿæ²‰ç¨³ä¸‹æ¥ï¼Œä¸“æ³¨äºé¢˜ç›®ï¼Œæœ‰æ—¶é—´ä¸€å®šè¦å¯¹æ‹ã€‚</p><p>æ˜¯æŒ‘æˆ˜ï¼Œä¹Ÿæ˜¯æœºé‡ã€‚Hope it can bring out the best in me.</p><p>åšäº† éº»å°†ï¼loj6302ï¼Œloj3280, è®¢æ­£äº† vp çš„ D</p><p>å®šä¸€ä¸‹æ˜å¤©çš„è€ƒè¯•ç­–ç•¥ï¼šå¼€åœºè¯»é¢˜ï¼Œè®¤çœŸä»”ç»†ï¼Œpdf è§å…‰ç¬”åˆ’å‡ºå‘ç‚¹ï¼Œè€ƒè™‘æ¯é“é¢˜çš„æ—¶é—´å¸ƒå±€ï¼›æ‰“é¢˜ä»”ç»†ä¸¥è°¨ï¼Œæ³¨æ„ç©ºé—´å’Œæ¨¡æ•°ä¸ä¸º 0 ç­‰å‘ç‚¹ï¼Œå¾ˆä¹…éƒ½è°ƒè¯•ä¸å‡ºæ¥ä¸å¦‚å…ˆå¼ƒæ‰å»å†™å…¶ä»–é¢˜çš„æš´åŠ›ï¼›æœ€åæ£€æŸ¥ä¸€éæ€è·¯å’Œä»£ç å®ç°æœ‰æ— æ‰‹è¯¯ï¼Œæœ€åäº”åˆ†é’Ÿç¼–è¯‘ä¸€æ¬¡ï¼Œåˆ é™¤è°ƒè¯•è¯­å¥ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">namespace NOIP &#123;</span><br><span class="line">    struct OIer &#123;</span><br><span class="line">        int rp = inf;</span><br><span class="line">    &#125; xml;</span><br><span class="line">&#125; NOIP2020;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    while(1) NOIP2020::xml.rp++!</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="12-5"><a href="#12-5" class="headerlink" title="12.5"></a>12.5</h3><p>åƒåœ¾æ„é€ æ¯æˆ‘é’æ˜¥ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NOIP2020 å‰çš„åšé¢˜è®°å½•æ•´ç†</title>
      <link href="2020/12/05/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%91NOIP2020%20%E5%89%8D%E7%9A%84%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%E6%95%B4%E7%90%86/"/>
      <url>2020/12/05/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%91NOIP2020%20%E5%89%8D%E7%9A%84%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%E6%95%B4%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>NOIP å‰ä¹Ÿåšäº†ä¸å°‘å¥½é¢˜ï¼ä½†æ˜¯ä¾ç„¶è€ƒçš„é‚£ä¹ˆå·®ã€‚ã€‚ã€‚QAQ æ¯é“é¢˜éƒ½å¾ˆå¥½ï¼ä½†å¤ªéš¾äº†éƒ½æ²¡åšå¤ªæ·±å…¥çš„æ€è€ƒ QAQã€‚ã€‚ã€‚æ‰€ä»¥æ¥ä¸‹æ¥åˆ° NOIP2021 çš„ 300 å¤šå¤©è¦å°½å¯èƒ½äº‰å–å®Œæ•´çš„åšå‡ºé¢˜ã€‚</p><h1 id="ç«‹ä¸‹-Flagï¼ˆå¸Œæœ›å®ƒæ°¸è¿œä¸å€’ï¼‰ï¼šæ¯å¤©éƒ½è‡ªå·±ç‹¬ç«‹åšå‡ºä¸€é“æœ‰è´¨é‡çš„é¢˜"><a href="#ç«‹ä¸‹-Flagï¼ˆå¸Œæœ›å®ƒæ°¸è¿œä¸å€’ï¼‰ï¼šæ¯å¤©éƒ½è‡ªå·±ç‹¬ç«‹åšå‡ºä¸€é“æœ‰è´¨é‡çš„é¢˜" class="headerlink" title="ç«‹ä¸‹ Flagï¼ˆå¸Œæœ›å®ƒæ°¸è¿œä¸å€’ï¼‰ï¼šæ¯å¤©éƒ½è‡ªå·±ç‹¬ç«‹åšå‡ºä¸€é“æœ‰è´¨é‡çš„é¢˜"></a>ç«‹ä¸‹ Flagï¼ˆå¸Œæœ›å®ƒæ°¸è¿œä¸å€’ï¼‰ï¼šæ¯å¤©éƒ½è‡ªå·±ç‹¬ç«‹åšå‡ºä¸€é“æœ‰è´¨é‡çš„é¢˜</h1><h3 id="ZJOI2019-éº»å°†"><a href="#ZJOI2019-éº»å°†" class="headerlink" title="$ZJOI2019-éº»å°†$"></a><a href="https://loj.ac/p/3042" target="_blank" rel="noopener">$ZJOI2019-éº»å°†$</a></h3><hr><p>$dp$ å¥— $dp$ å°±æ˜¯çŠ¶æ€é—´çš„è½¬ç§»ä¹Ÿæœ‰ $dp$ å…³ç³»ï¼Œ$f[i]$ è½¬ç§»åˆ° $f[j]$, $i$ å’Œ $j$ æœ‰ dp å…³ç³»ã€‚æ‰€ä»¥è¦ $dp$ é¢„å¤„ç†çŠ¶æ€å’ŒçŠ¶æ€çš„è½¬ç§»è¾¹ã€‚ï¼ˆè¿™ä¸å°±æ˜¯è‡ªåŠ¨æœºå˜›ï¼Ÿï¼‰</p><p>æˆ‘ä»¬éœ€è¦å¯¹å­æ•°å’Œé¢å­æ•°æ¥è¡¨ç¤ºæ‘¸å‡ºçš„ç‰Œçš„çŠ¶æ€ã€‚</p><p>åˆ»å­ç”¨åˆ°çš„æ˜¯åŒç§ç‰Œï¼Œæ‰€ä»¥å¯ä»¥è½¬ç§»æ—¶æšä¸¾ä¸ªæ•°ï¼Œä¸ç”¨è¡¨ç¤ºåˆ°çŠ¶æ€é‡Œå› ä¸ºå¯¹åç»­æ— å½±å“ã€‚</p><p>å¯¹åç»­æœ‰å½±å“çš„å°±æ˜¯é¡ºå­ã€‚<br>$f[i, 0/1, j, k]$ è¡¨ç¤ºè€ƒè™‘åˆ°ç¬¬ $i$ ç§ç‰Œï¼Œæ˜¯å¦æœ‰è¿‡å¯¹å­ï¼Œæˆ‘å†³å®šåˆ†å‡ºçš„ $(i - 1, i, i + 1)$ å‹çš„é¡ºå­ä¸ªæ•°ä¸º $j$ï¼Œæˆ‘å†³å®šåˆ†å‡ºçš„ $(i, i + 1, i + 2)$ å‹çš„é¡ºå­ä¸ªæ•°ä¸º $k$ï¼Œæ­¤æ—¶å·²ç»å‡‘å‡ºçš„æœ€å¤§é¢å­æ•°ã€‚<br>äºæ˜¯è½¬ç§»åˆ° $i + 1$ çš„æ—¶å€™ $j + k$ å¼ å’Œä¹‹å‰çš„ç»„é¡ºå­ï¼ˆæ­¤æ—¶æœ‰ $j$ ä¸ªé¢å­è¯ç”Ÿäº†ï¼‰<br>$j$, $k$ å¿…ç„¶ä¸ä¼šå¤§äº 2 å¦åˆ™å°±æ˜¯ä¸‰å¼ åˆ»å­ï¼ˆæ•°é‡ç›¸ç­‰çš„æƒ…å†µä¸‹ä¼˜å…ˆå‡‘åˆ»å­ï¼‰<br>å‘ç°ç”¨ $cnt$ï¼ˆå¯¹å­ä¸ªæ•°ï¼‰å’Œ $f[0/1, j, k]$ å°±å¯ä»¥è¡¨ç¤ºçŠ¶æ€ã€‚</p><p>å› ä¸ºä½ å‘ç°è¿™å°±æ˜¯ä¸ªåœ¨çŠ¶æ€é—´ä¸æ–­è½¬ç§»çš„è·³ $n$ æ­¥çš„ä¸œè¥¿ï¼Œæ‰€ä»¥å¯ä»¥å‘½åä¸ºâ€œéº»å°†è‡ªåŠ¨æœºâ€ 2333ï¼<br>è‡ªåŠ¨æœºä¸Šçš„èŠ‚ç‚¹è¡¨ç¤ºçš„çŠ¶æ€å°±æ˜¯æŠŠ $cnt$ å’Œ $[0/1, j, k]$ å‹åœ¨ä¸€å—<br>å‚ç…§åœ¨ $AC$ è‡ªåŠ¨æœºä¸Š $dp$ çš„å¥—è·¯ï¼Œæˆ‘ä»¬æ•²å®šæœ€ç»ˆ $dp$ çŠ¶æ€ï¼š$f[i, j, k]$ è¡¨ç¤ºè€ƒè™‘åˆ°ç¬¬ $i$ ç§ç‰Œï¼Œåœ¨è‡ªåŠ¨æœºä¸Šç¬¬ $j$ ä¸ªèŠ‚ç‚¹ï¼Œå…±æ‘¸äº† $k$ å¼ ç‰Œçš„æ–¹æ¡ˆæ•°</p><p>æ ¹æ®æœŸæœ›çš„çº¿æ€§æ€§å’Œæ•´æ•°æ¦‚ç‡å…¬å¼ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠç­”æ¡ˆæ‹†åˆ†ä¸º $P$ çš„æƒå€¼çš„æ¯ä¸ª $1$ å¯¹ç­”æ¡ˆçš„è´¡çŒ®ï¼Œå³æ¯ä¸ªæ—¶åˆ»æ²¡èƒ¡ç‰Œçš„æ–¹æ¡ˆæ•° $*$ æ¦‚ç‡ã€‚<br>é‚£ä¸ªæ–¹æ¡ˆæ•°ç›´æ¥å–è‡ªåŠ¨æœºä¸Šçš„å°±å¥½ï¼Œå› ä¸ºèƒ½å¾…åœ¨è‡ªåŠ¨æœºä¸Šçš„å°±ä¸€å®šæ²¡èƒ¡ã€‚</p><p>ä»”ç»†æƒ³æƒ³å¥½åƒä¹‹å‰å†™çš„ä¸¤é“ $dp$ å¥— $dp$ ä¹Ÿå¾ˆè‡ªåŠ¨æœºå•Šã€‚</p><p><a href="https://loj.ac/s/1005925" target="_blank" rel="noopener">$Code$</a></p><h3 id="LOJ3280-é¦–éƒ½åŸå¸‚"><a href="#LOJ3280-é¦–éƒ½åŸå¸‚" class="headerlink" title="$LOJ3280-é¦–éƒ½åŸå¸‚$"></a><a href="https://loj.ac/p/3280" target="_blank" rel="noopener">$LOJ3280-é¦–éƒ½åŸå¸‚$</a></h3><hr><p>è€ƒè™‘é€‰é¢œè‰² a ä¼šè®©é¢œè‰² b ä¹Ÿå¿…é€‰ï¼Œä¸å¦¨ a -&gt; b è¿è¾¹ã€‚ä½†æ˜¯é¢œè‰² -&gt; é¢œè‰²è¿è¾¹ä¸å®¹æ˜“ï¼Œè€ƒè™‘è®©ç‚¹ä½œä¸ºä¸­è½¬ç«™ï¼Œé¢œè‰² -&gt; ç‚¹ (å¯ä»¥é€šè¿‡æ ‘ä¸Šå€å¢ä¼˜åŒ–å»ºå›¾) å† ç‚¹ -&gt; é¢œè‰²ã€‚</p><p><a href="https://loj.ac/s/1006784" target="_blank" rel="noopener">$Code$</a></p><h3 id="CF673F-Bearish-Fanpages"><a href="#CF673F-Bearish-Fanpages" class="headerlink" title="$CF673F-Bearish Fanpages$"></a><a href="https://www.luogu.com.cn/problem/CF643D" target="_blank" rel="noopener">$CF673F-Bearish Fanpages$</a></h3><hr><p><del>å˜Ÿå˜Ÿ</del>è¯»æ‡‚é¢˜æ„ä½ å°±ä¼šå‘ç°è¿™æ˜¯é“æ¨¡æ‹Ÿé¢˜ã€‚å› ä¸ºæ ¹æ®è€å¥—è·¯ï¼Œä¿®æ”¹åªè¦æ”¹å¯¹çˆ¶äº²çš„ï¼Œçˆ¶äº²å¯¹å„¿å­çš„æŸ¥è¯¢æ—¶åŠ ä¸Šã€‚ï¼ˆæ‰€ä»¥å®ƒä¸ºä»€ä¹ˆé»‘äº†å•Šï¼Ÿ</p><p>è¿™é¢˜å·¨çƒ¦å¥¥ï¼ä¸€ä¸ªç‚¹çš„åº¦æ•°å½±å“å®ƒçš„å„¿å­ï¼Œå®ƒçš„çˆ¶äº²ï¼Œå®ƒè‡ªå·±</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">x -&gt; f -&gt; ff -&gt; fff</span><br><span class="line">    son   son   son</span><br><span class="line">    val   val</span><br><span class="line">    deg</span><br><span class="line">ï¼ˆä¸‹é¢æ˜¯å½±å“çš„ä¸œè¥¿ï¼‰</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯æ€ä¹ˆå¤„ç†çˆ¶äº²åº¦æ•°å˜äº†ï¼Œå„¿å­åœ¨å…¨å±€ set é‡Œçš„å˜åŒ–å‘¢ï¼Ÿæˆ‘ä»¬å¯¹æ¯ä¸ªç‚¹å¼€ä¸€ä¸ª setï¼Œç»´æŠ¤å…¶å„¿å­é›†åˆçš„æœ€å¤§æœ€å°æƒå€¼ã€‚æ‰€ä»¥å…¨å±€ set å…¶å®è£…çš„å°±æ˜¯æ¯ä¸ª set çš„æœ€å¤§æœ€å°æƒå€¼ã€‚</p><p><a href="http://codeforces.com/contest/643/submission/100179942" target="_blank" rel="noopener">$Code$</a></p><h3 id="CF806D-Perishable-Roads"><a href="#CF806D-Perishable-Roads" class="headerlink" title="$CF806D-Perishable Roads$"></a><a href="https://www.luogu.com.cn/problem/CF773D" target="_blank" rel="noopener">$CF806D-Perishable Roads$</a></h3><hr><p>é¦–å…ˆä¼šæƒ³åˆ°è´ªå¿ƒçš„æŠŠç‚¹éƒ½æŒ‚åˆ°æœ€çŸ­è¾¹çš„ä¸€ç«¯ï¼Œåƒä¸ªæ‰«å¸šã€‚ä½†è¿™æ˜¯æœ‰é—®é¢˜çš„ï¼šå¦‚æœæœ€çŸ­è¾¹ä¸æ ¹ä¸ç›´æ¥ç›¸è¿ï¼Œæœ‰äº›ç‚¹å°±å¤„äºæ ¹åˆ°æœ€çŸ­è¾¹çš„è·¯å¾„ä¸Šï¼Œæ²¡æ³•æŒ‚è¿‡å»ã€‚</p><p>å°†é™¤äº†æœ€çŸ­è¾¹å¤–çš„æ‰€æœ‰è¾¹æƒå€¼å‡å»æœ€çŸ­è¾¹æƒå€¼ï¼Œè·‘æ ¹åˆ°æœ€çŸ­è¾¹çš„æœ€çŸ­è·¯å°±å¥½ã€‚</p><h3 id="LOJ3385-Svjetlo"><a href="#LOJ3385-Svjetlo" class="headerlink" title="$LOJ3385-Svjetlo$"></a><a href="https://loj.ac/p/3385" target="_blank" rel="noopener">$LOJ3385-Svjetlo$</a></h3><hr><p>è¢«å‡ºåˆ°æ¨¡æ‹Ÿèµ›é‡Œäº†ã€‚è€ƒåœºä¸Šæˆ‘çš„ dp çŠ¶æ€æ˜¯ $f[x, 0/1, 0/1]$ è¡¨ç¤º $x$ å›ä¸å›æ¥ï¼Œ$x$ å½“å‰çš„é¢œè‰²ã€‚ç„¶è€Œå·¨éš¾å†™ï¼ï¼ˆè€Œä¸”è¿˜æ˜¯é”™çš„ã€‚æ­£è§£ $f[x, 0/1/2, 0/1]$ è¡¨ç¤º x å­æ ‘å†…çš„è·¯å¾„æ¥å£çŠ¶æ€å’Œ x å½“å‰çš„é¢œè‰²ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f çš„å®šä¹‰æ˜¯ åŒ…æ‹¬èµ·å§‹ç‚¹ï¼Œä¹ŸåŒ…æ‹¬ç»ˆç‚¹ã€‚</span><br><span class="line">0: â¬‡ï¸â¬†ï¸  1: â¬†ï¸æˆ–â¬‡ï¸  2: â¬†ï¸â¬‡ï¸</span><br></pre></td></tr></table></figure><p>è¿™ç§çŠ¶æ€è®¾è®¡æ˜¯æ€ä¹ˆæƒ³åˆ°çš„å‘¢ï¼Ÿ<br>ä¸€æ¡è·¯å¾„ï¼Œç”±ï¼šâ¬†ï¸ / â¬‡ï¸â¬†ï¸ / â¬‡ï¸ ä¸‰éƒ¨åˆ†ç»„æˆï¼Œå…¶ä¸­ä¸€å’Œä¸‰éƒ½æœ€å¤šåªæœ‰ä¸€ä¸ªï¼›ä¸ºäº†æ–¹ä¾¿è®¨è®ºï¼Œæˆ‘ä»¬è§„å®šå•ä¸ªç‚¹ä¹Ÿå¯ä»¥çœ‹ä½œ â¬†ï¸ æˆ– â¬‡ï¸ã€‚dp å°±å¯ä»¥åƒèƒŒåŒ…ä¸€æ ·åšäº†ã€‚</p><p><a href="https://loj.ac/s/1003823" target="_blank" rel="noopener">$Code$</a></p><h3 id="LOJ3370-Histogram"><a href="#LOJ3370-Histogram" class="headerlink" title="$LOJ3370-Histogram$"></a><a href="https://loj.ac/p/3370" target="_blank" rel="noopener">$LOJ3370-Histogram$</a></h3><hr><p>è¿˜æ˜¯æ¨¡æ‹Ÿèµ›é¢˜ QAQï¼ˆå£èƒ¡å·®ç‚¹æ­£ç¡®ï¼è€¶ï¼</p><p>æˆ‘å£èƒ¡çš„æ˜¯æŒ‰ $a$ é™åºåˆ†æ²»ï¼ˆå°±æ˜¯ç¬›å¡å°”æ ‘ï¼‰ï¼Œæ¯ä¸ªå—ç”¨ä¸¤ä¸ªçº¿æ®µæ ‘ç»´æŠ¤ä¸¤ä¸ªå•è°ƒæ ˆç„¶åä¸Šçº¿æ®µæ ‘åˆå¹¶ï¼Œä½†é‚£æ ·å¥½åƒæœ‰äº¿ç‚¹è›‹ç–¼ï¼ˆå› ä¸ºç¬›å¡å°”æ ‘åˆ†æ²» $n$ æ¬¡ï¼Œå•æ¬¡æŸ¥è¯¢ &amp; åˆå¹¶åªèƒ½æ˜¯ $log$ çº§åˆ«çš„</p><p>æ­£è§£å°±æ˜¯ç®€å•ç²—æš´ï¼Œæ¯æ¬¡æŠŠåŒºé—´åˆ’ä¸¤åŠçš„åˆ†æ²»ï¼Œè®¡ç®—è·¨ä¸­ç‚¹çš„åŒºé—´è´¡çŒ®ã€‚</p><p>è®¨è®º $a$ å’Œ $b$ æœ€å°å€¼åŒåœ¨ä¸€è¾¹å’Œä¸åœ¨ä¸€è¾¹ä¸¤ç§æƒ…å†µã€‚åŒåœ¨ä¸€è¾¹æ˜¯æœ‰å•è°ƒæ€§çš„ï¼Œç›´æ¥åŒæŒ‡é’ˆã€‚ä¸åœ¨ä¸€è¾¹çš„è¯å°±è¦éº»çƒ¦ä¸€äº›ï¼šè€ƒè™‘ $b$ æœ€å°å€¼åœ¨å·¦è¾¹ï¼Œç°åœ¨è¦åœ¨å³è¾¹æ‰¾ä¸€ä¸ª $a$ æœ€å°å€¼ã€‚</p><p>è®¾ $r_1$ æ¯” $r_2$ ä¼˜ï¼Œåˆ™ $a[r_1] * b * (r_1 - l + 1) \geq a[r_2] * b * (r_2 - l + 1)$<br>åŒ–æˆæ–œç‡ä¼˜åŒ–çš„æŸ¿å­å°±æ˜¯ $(a[r_2] * (r_2 + 1) - a[r_1] * (r_1 + 1)) / (a[r_2] - a[r_1]) \geq l$ï¼Œè€Œ $l$ å•è°ƒé€’å‡ã€‚</p><p>çº¿æ®µæ ‘ç»´æŠ¤å‡¸åŒ…å°±å¯ä»¥æ”¯æŒåŒºé—´æŸ¥è¯¢å•¦ï¼$O(n log^2 n)$ å› ä¸ºæœ‰ $logn$ ä¸ªåŒºé—´ï¼Œæ¯ä¸ªåŒºé—´è¦ $logn$ å‡¸åŒ…æŸ¥è¯¢</p><p><a href="https://loj.ac/s/1004609" target="_blank" rel="noopener">$Code$</a></p><h3 id="JOI2020-æ±‰å ¡è‚‰"><a href="#JOI2020-æ±‰å ¡è‚‰" class="headerlink" title="$JOI2020-æ±‰å ¡è‚‰$"></a><a href="https://loj.ac/p/3272" target="_blank" rel="noopener">$JOI2020-æ±‰å ¡è‚‰$</a></h3><hr><p>å¾ˆå¦™å•Šï¼ï¼ˆ$K \geq 4$ å°±æ˜¯äººç±»æ™ºæ…§é¢˜</p><p>é¦–å…ˆå››ä¸ªç­¾åªä¼šå‡ºç°åœ¨å››æ¡çº¿ä¸Šï¼š$max(L)$, $min(R)$, $max(D)$, $min(U)$ã€‚</p><p>è¯æ˜ï¼š</p><ol><li>$max(L) \leq min(R)$, $max(D) \leq min(U)$ï¼Œåªè¦å¾€å›´æˆçš„çŸ©å½¢é‡Œæ’ä¸€æ ¹ç­¾</li><li>$max(L) &gt; min(R)$, $max(D) \leq min(U)$ï¼Œ$max(L)$ å³è¾¹å¿…ç„¶æœ‰ç­¾ï¼Œ$min(R)$ å·¦è¾¹å¿…ç„¶æœ‰ç­¾ï¼Œå¹¶ä¸”ä¸¤è¾¹çš„ç­¾é€šè¿‡å¹³ç§»éƒ½å¯ä»¥ç§»åŠ¨åˆ°ä¸¤æ¡çº¿ä¸Šã€‚å¦ä¸€ç§ç›¸åæƒ…å†µä¹Ÿå¦‚æ­¤ã€‚</li><li>$max(L) &gt; min(R)$, $max(D) &gt; min(U)$ï¼Œé“ç†åŒä¸Šã€‚</li></ol><p>è¯æ¯•ã€‚</p><p>$max$ å’Œ $min$ éå¸¸å¥½ï¼Œä¸ºä»€ä¹ˆï¼Ÿä»¥ $max(L)$ ä¸ºä¾‹åˆ†æï¼Œé¦–å…ˆå®ƒå³è¾¹å¿…å®šè¦æœ‰ç­¾ï¼Œåœ¨æœ‰ç­¾çš„æƒ…å†µä¸‹è¿™ç­¾å°½é‡å·¦åˆæ˜¯æœ€ä¼˜çš„ï¼Œè€Œç«–ç›´æ–¹å‘å¯¹å®ƒæ— å½±å“å› ä¸ºå·²ç»æ˜¯ $max$ äº†ã€‚</p><p>$K \leq 3$ æ ¹æ®æŠ½å±‰åŸç†å°±ä¸€å®šæœ‰ç­¾å‡ºç°åœ¨äº¤ç‚¹ä¸Šäº†ã€‚æœ‰ç­¾åœ¨äº¤ç‚¹ä¸Šçš„æƒ…å†µå¯ä»¥ç›´æ¥æš´æœå‡ºè§£ï¼ˆæ¯æ¬¡é€‰äº¤ç‚¹ï¼Œåˆ æ‰è¦†ç›–åˆ°çš„çŸ©å½¢ï¼Œå‰©ä¸‹çš„ç»§ç»­é€’å½’é€‰äº¤ç‚¹ï¼‰ã€‚å‰©ä¸‹å°±æ˜¯ç­¾éƒ½åœ¨çº¿æ®µä¸Šçš„æƒ…å†µã€‚</p><p>é¦–å…ˆæŸå—æ±‰å ¡è‚‰å¦‚æœç›¸é‚»ä¸‰è¾¹éƒ½æ˜¯ä»¥ä¸Šé‚£å››ç§çº¿æ®µä¹‹ä¸€ï¼ˆå³åŒ…å«äº†ä¸€æ•´æ¡è¾¹ï¼‰ï¼Œå®ƒå¿…å®šæ’ç­¾ï¼Œå¯ä»¥ä¸ç”¨è€ƒè™‘ï¼›å¦åˆ™ç¦»æ•£åŒ–ï¼ˆä¸ç”¨çœŸçš„ç¦»æ•£åŒ–ï¼‰çŸ©å½¢è¾¹åæ ‡ï¼Œå¯¹æ¯æ¡è¾¹å¯ä»¥å•ç‹¬åšå‰åç¼€è¿è¾¹çš„ $2-SAT$ã€‚</p><p>ä¸¥è°¨åœ°è¯´ï¼Œè¦åˆ¤æ— è§£ï¼Œä½†æ˜¯æœ¬é¢˜ä¿è¯æœ‰è§£ qwq</p><p>ç„¶åè¿™é¢˜éšæœºåŒ–ä¹Ÿèƒ½è‰¹è¿‡å»ï¼Œå¥½åƒæ˜¯ä»€ä¹ˆåˆ† $K$ ç±»ï¼Œæ¯ç±»ç®—çŸ©å½¢å¹¶ï¼Œè®©çŸ©å½¢å¹¶æœ€å¤§</p><p><a href="https://loj.ac/s/1002813" target="_blank" rel="noopener">$Code$</a></p><h3 id="JOI2020-å»ºç­‘è£…é¥°4"><a href="#JOI2020-å»ºç­‘è£…é¥°4" class="headerlink" title="$JOI2020-å»ºç­‘è£…é¥°4$"></a><a href="https://loj.ac/p/3271" target="_blank" rel="noopener">$JOI2020-å»ºç­‘è£…é¥°4$</a></h3><hr><p>$n^2$ dp è¿˜æ˜¯å¾ˆå¥½æƒ³çš„ã€‚$dp[i, 0/1, j]$ è¡¨ç¤ºåˆ° $i$ï¼Œç¬¬ $i$ ä½æ˜¯å¦ä¸º $A$ï¼Œé€‰äº† $j$ ä¸ª $A$ çš„å€¼ï¼Œåªä¸º $1$ æˆ– $0$ã€‚æœ‰ä¸€ç§åšæ³•æ˜¯ï¼ˆçŒœï¼‰ç»“è®ºï¼š$dp[i, 0/1]$ å€¼ä¸º $1$ çš„æ˜¯ä¸€æ®µåŒºé—´ã€‚å½’çº³å¯è¯ï¼Ÿä½†æ˜¯è¿™å°±æ²¡æ„æ€äº†å•Š qwq</p><p>è€ƒè™‘å…¶ä»–åšæ³•ã€‚ä¸å¦¨äº¤æ¢çŠ¶æ€ä¸å€¼ï¼š$dp[i, 0/1, 0/1]$ è¡¨ç¤ºåˆ° $i$ï¼Œç¬¬ $i$ ä½æ˜¯å¦ä¸º $A$ï¼Œ$A$/$B$ çš„æœ€å¤šä¸ªæ•°èƒ½æ˜¯å¤šå°‘ã€‚å®¹æ˜“è®°å½•è·¯å¾„ã€‚è¾“å‡ºæ–¹æ¡ˆæ—¶ä»åå¾€å‰ã€‚</p><p><a href="https://loj.ac/s/1001454" target="_blank" rel="noopener">$Code$</a></p><h3 id="JOI2020-æœ‰è¶£çš„-Joitter-äº¤å‹"><a href="#JOI2020-æœ‰è¶£çš„-Joitter-äº¤å‹" class="headerlink" title="$JOI2020-æœ‰è¶£çš„ Joitter äº¤å‹$"></a><a href="https://loj.ac/p/3275" target="_blank" rel="noopener">$JOI2020-æœ‰è¶£çš„ Joitter äº¤å‹$</a></h3><hr><p>æœ€å¤§å€¼æ˜¯å”¬ä½ çš„ï¼Œå°±æ˜¯èƒ½å…³æ³¨åˆ™å…³æ³¨ã€‚è€ƒè™‘ä¸€ä¸ªå…³æ³¨äº‹ä»¶ä¼šæœ‰ä»€ä¹ˆâ€œå‰¯äº§å“â€ï¼šæ‰€æœ‰å’Œ $B$ ç”¨æˆ·äº’ç›¸å…³æ³¨çš„ $C$ éƒ½ä¼šè¢« $A$ å…³æ³¨ã€‚è¿™äº’ç›¸å…³æ³¨çš„å…³ç³»å…·æœ‰ä¼ é€’æ€§ï¼Œå…³æ³¨å…³ä¸€å›¢ï¼Œå¯å‘æˆ‘ä»¬æŠŠæœ‰åŒå‘è¾¹çš„ç‚¹å¯¹ç¼©ç‚¹ã€‚å‘ç°ç­”æ¡ˆç­‰äº $\sum_S sz(S)(sz(S) - 1) + sz(S)in_deg(S)$</p><p>ç°åœ¨è¦åˆå¹¶ä¸¤ä¸ªå›¢ï¼Œè¦ç»´æŠ¤ $sz(sz - 1)$ å’Œ $sz * in_deg$ çš„å˜åŒ–ï¼Œè¿˜è¦åˆå¹¶ $in$ å’Œ $out$ çš„ç‚¹å¯¹ã€‚ç”¨å¯å‘å¼åˆå¹¶ + set å­˜å…¥è¾¹å‡ºè¾¹ + å¹¶æŸ¥é›†ï¼ˆåˆå¹¶çš„æ—¶å€™æŠŠä¿¡æ¯éƒ½æ‹¢åˆ°æ ¹ä¸Šï¼Œå¹¶æŸ¥é›†å¸®åŠ©æ‰¾æ ¹ï¼‰å¯ä»¥åšåˆ° $O(nlog^2n)$ï¼</p><p>è¿˜æœ‰ä¸€ä¸ªç»†èŠ‚ï¼Œåˆå¹¶å¯èƒ½é€ æˆè¿é”ååº”ï¼Œé‚£ä¹ˆå¯¹äºæ–°çš„è¦åˆå¹¶çš„ç‚¹å¯¹é€’å½’å¤„ç†å°±å¥½ã€‚</p><p><a href="https://loj.ac/s/1002124" target="_blank" rel="noopener">$Code$</a></p><h3 id="JOI2020-é—è¿¹"><a href="#JOI2020-é—è¿¹" class="headerlink" title="$JOI2020-é—è¿¹$"></a><a href="https://loj.ac/p/3276" target="_blank" rel="noopener">$JOI2020-é—è¿¹$</a></h3><hr><p><a href="https://blog.csdn.net/qq_39972971/article/details/105074251" target="_blank" rel="noopener">CCCOrz</a></p><p><a href="https://blog.csdn.net/jokerwyt/article/details/105116540" target="_blank" rel="noopener">CCCOrz</a></p><p>å¾ˆå¦™çš„é¢˜ï¼æ²¡æœ‰æ€è·¯ï¼Œä¸€å®šå…ˆå‰–æè¿™ä¸ªæ“ä½œçš„åŸç†ï¼šæ€ä¹ˆæ‰¾é•¿åº¦ä¸º $2N$ çš„åºåˆ—çš„ç»“æœåºåˆ—ã€‚</p><p>å‘ç°å…¶ä¸­ä¸€ç§æ–¹æ³•æ˜¯ä»åå¾€å‰ï¼Œå¯¹äºæ¯ä¸ª $a[i]$ å¦‚æœ $\leq a[i]$ æœ‰ç©ºç€çš„ä½ç½®å°±é€‰ $i$ å¹¶ä¸”å¡«ä¸Šç©ºä½ã€‚å‘ç°è¿™ç§æ–¹æ³•å¾ˆåˆ©äº $dp$ã€‚æœ‰ä¸ª $simple$ çš„æƒ³æ³•æ˜¯ $O(n2^n)$ çš„çŠ¶å‹ï¼Œ$dp[i, S]$ è¡¨ç¤º $i$ ~ $2N$ é€‰çš„ä½å¡«çš„é›†åˆæ˜¯ $S$</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ä¸é€‰ï¼šç³»æ•°ä¸º j - [å·²å¡«çš„ä½ç½®æ•°]</span><br><span class="line">è¦é€‰ï¼šf[i, j] = f[i + 1, j]</span><br><span class="line">     f[i, j + k] = f[i + 1, j] * C([i ~ 2N è¦é€‰çš„ä½ç½®æ•°] - j, k - 1) * (k + 1) * g[k - 1, k - 1] * fac[k - 1]</span><br><span class="line">     ï¼ˆä¸ä¸ 1 ç›¸è¿çš„ è´¡çŒ®å¯ä»¥ä¹‹åç®— â€”â€” è¿™æ­¥å®åœ¨å¤ªå¦™äº†ï¼Œé¿å…äº†è®°å½•çŠ¶æ€ï¼‰</span><br><span class="line">    å…¶ä¸­ g[i, j] è¡¨ç¤º j ä¸ªå…³é”®ä½å¡«äº† &lt;= i çš„æ•°ï¼Œdp é¢„å¤„ç†çš„æ—¶å€™è¦æ»¡è¶³ [1, i] å†…çš„ä¸ªæ•° &lt;= i</span><br></pre></td></tr></table></figure><p>æœ€åé™¤ä»¥ $2^n$ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ä¸€å¼€å§‹å°±å†³å®šä¸ºäº†æ–¹ä¾¿ï¼ŒæŠŠä¸¤ä¸ªç›¸åŒçš„æ•°ä¹Ÿçœ‹ä½œæœ‰æ ‡å·çš„ã€‚</p><p>è¿™é¢˜çš„æŸä¸ªéš¾ç‚¹åœ¨äºâ€œè™šå®ç»“åˆâ€ï¼Œå®é™…å¡«çš„æ•°åœ¨æœ€åå¯¹åº”çš„æ˜¯å¦ä¸€ä¸ªæ•°</p><p><a href="https://loj.ac/s/999539" target="_blank" rel="noopener">$Code$</a></p><h3 id="JOI2020-æ˜Ÿåº§-3"><a href="#JOI2020-æ˜Ÿåº§-3" class="headerlink" title="$JOI2020-æ˜Ÿåº§ 3$"></a><a href="https://loj.ac/p/3277" target="_blank" rel="noopener">$JOI2020-æ˜Ÿåº§ 3$</a></h3><hr><p>å¤§å£°å–Šå‡ºæ¥ï¼šç½‘ æ ¼ å›¾ çš„ å¥— è·¯ æ˜¯ ä»€ ä¹ˆï¼Ÿâ€”â€”ç¬›â€”â€”å¡â€”â€”å°”â€”â€”æ ‘</p><p>ï¼ˆå¤§é›¾</p><p>æ¯æ¬¡ä»æœ€å¤§çš„ä½ç½® $x$ pia å¼€ï¼Œæ˜Ÿç©ºè¢«åˆ†æˆä¸‰éƒ¨åˆ†ï¼šå·¦ï¼Œ$x$ å¤´é¡¶çš„ï¼Œå³</p><p>$dp[x, i]$ è¡¨ç¤ºç¬›å¡å°”æ ‘ç¬¬ $x$ ä¸ªèŠ‚ç‚¹æœ€å¤§çš„ä½ç½®å¤´ä¸Šæœ€é«˜çš„æ˜Ÿæ˜Ÿé«˜åº¦ä¸º $i$ã€‚åˆå¹¶çš„æ—¶å€™ä¸‰éƒ¨åˆ†åªèƒ½æœ‰æœ€å¤šä¸€é¢—æ˜Ÿæ˜Ÿæ¯”æœ€å¤§ä½ç½®é«˜ã€‚ç”¨ $pair$ï¼ˆæœ€é«˜æ˜Ÿæ˜Ÿé«˜åº¦ + $dp$ å€¼ï¼‰+ $set$ å¯ä»¥è½»æ¾å®ç°ï¼Œå¯å‘å¼åˆå¹¶ $O(n log^2 n)$</p><p><a href="https://loj.ac/s/1000065" target="_blank" rel="noopener">$Code$</a></p><h3 id="JOI2020-æ”¶è·"><a href="#JOI2020-æ”¶è·" class="headerlink" title="$JOI2020-æ”¶è·$"></a><a href="https://loj.ac/p/3278" target="_blank" rel="noopener">$JOI2020-æ”¶è·$</a></h3><hr><p>æ¶å¿ƒ &amp; æœ‰æ„æ€çš„é¢˜ã€‚</p><p>å‘˜å·¥æ˜¯ä¸å®šçš„ï¼Œè€Œè‹¹æœæˆç†Ÿçš„æ—¶é—´éƒ½ç›¸åŒï¼Œå› ä¸ºè¯¢é—®çš„æ˜¯äººï¼Œè€ƒè™‘äººä¸åŠ¨ï¼Œè‹¹æœåŠ¨ï¼Œä¹Ÿè®¸ä¼šæœ‰ä¸€äº›ç»å¦™çš„å‘ç°ã€‚ä»è‹¹æœå‘ç¬¬ä¸€ä¸ªé‡‡æ‘˜å®ƒçš„å‘˜å·¥ 1 è¿è¾¹ï¼Œå†ä»å‘˜å·¥ 1 å‘ç¬¬äºŒä¸ªé‡‡æ‘˜å®ƒçš„å‘˜å·¥ 2 è¿è¾¹â€¦ æ¯ä¸ªå‘˜å·¥éƒ½æœ‰ä¸€ä¸ªå‡ºè¾¹ï¼Œå½¢æˆäº†åŸºç¯å†…å‘æ ‘æ£®æ—ã€‚åˆ†åˆ«å¯¹æ¯æ£µåŸºç¯å†…å‘æ ‘ç»Ÿè®¡ç­”æ¡ˆã€‚æŠŠè¯¢é—®ç¦»çº¿ä¸‹æ¥æ”¾åœ¨èŠ‚ç‚¹ä¸Šã€‚</p><p>ä¸€ä¸ªè‹¹æœçš„è´¡çŒ®æ€ä¹ˆç®—ï¼Ÿå…ˆæ–­ç¯æˆé“¾ï¼Œæœ‰ä¸¤ç§æƒ…å†µï¼š</p><ol><li>è‹¹æœåˆ°è¯¥ç‚¹æ²¡æœ‰ç»è¿‡æ–­è¾¹</li><li>ç»è¿‡äº†æ–­è¾¹</li></ol><p>ç¬¬ä¸€ç§æƒ…å†µå°±åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ï¼ˆä¸‹æ ‡ä¸ºæ—¶é—´ï¼‰ï¼Œç¬¬äºŒç§å¯ä»¥åŒ–æˆä¸‹å–æ•´æŸ¿å­ç„¶åç»´æŠ¤ä½™æ•°ã€‚ä¸€ä¸ªå­æ ‘çš„è´¡çŒ®å¯ä»¥è¿›å»å’Œå‡ºå»æ—¶åšå·®å¾—åˆ°ã€‚</p><p><a href="https://loj.ac/s/1000206" target="_blank" rel="noopener">$Code$</a></p><h3 id="CF436E"><a href="#CF436E" class="headerlink" title="$CF436E$"></a><a href="https://www.luogu.com.cn/problem/CF436E" target="_blank" rel="noopener">$CF436E$</a></h3><hr><p>å‡ºåˆ°æ¨¡æ‹Ÿèµ›é‡Œï¼Œæ¯”èµ›æ—¶å°±çŸ¥é“è‚¯å®šæ˜¯åæ‚”è´ªå¿ƒäº†ï¼Œä½†æˆ‘å°±æ˜¯ä¸ä¼šã€‚ã€‚</p><p>åæ‚”è´ªå¿ƒå…ˆå›ºå®šä¸€ç§é¡ºåºï¼Œä¸€èˆ¬æ˜¯ä¸ªæ•°æ¯æ¬¡åŠ ä¸€ï¼Œç„¶åæ¯æ­¥è¦ä¹ˆé€‰æ‹©ï¼Œè¦ä¹ˆåæ‚”ã€‚ä¸€èˆ¬ç”¨å †æ¥ç»´æŠ¤å†³ç­–é›†åˆã€‚ï¼ˆä¸ºä»€ä¹ˆç”¨å †å°±ä¸ç”¨è¯´äº†å§ï¼Ÿï¼ï¼‰</p><p>æœ¬é¢˜å…±æœ‰å››ç§å†³ç­–ï¼š</p><ul><li>é€‰æ‹©<ol><li>é€‰ä¸€ä¸ªæ–°çš„ $i$, $a_i$</li><li>ä»é€‰äº†ä¸€ä¸ªçš„ $i$ é‡Œå†é€‰ä¸€ä¸ª, $b_i - a_i$</li></ol></li><li>åæ‚”<ol><li>å»æ‰åªé€‰äº†ä¸€ä¸ªçš„ $i$ï¼Œå†é€‰ä¸¤ä¸ª $j$ï¼Œ$b_j - a_i$</li><li>å»æ‰é€‰äº†ä¸¤ä¸ªçš„ $i$ çš„ç¬¬äºŒä¸ªï¼Œå†é€‰ä¸¤ä¸ª $j$ï¼Œ$b_j - (b_i - a_i)$<br>ç”¨å››ä¸ªå †åˆ†åˆ«ç»´æŠ¤è¿™å››ç§å†³ç­–ã€‚</li></ol></li></ul><p>è¿™é¢˜æœ‰å¥½å¤šç§ä¹±æåšæ³•ã€‚<br>æ¯”å¦‚ $dst$ çš„ï¼š<br>æŒ‰ç…§ $a_i$ å’Œ $b_i - a_i$ çš„å¤§å°å…³ç³»åˆ†ç±»<br>$a_i \leq b_i - a_i$ æ²¡æœ‰ä¾èµ–å…³ç³»ï¼Œå¯ä»¥å•ç‹¬è€ƒè™‘ï¼›<br>ä½†æ˜¯ $a_i &gt; b_i - a_i$ çš„å°±è¦æ†ç»‘äº†<br>æœ€åå¯èƒ½ä¼šæœ‰å‰©ä¸€ä¸ªç©ºçš„æƒ…å†µï¼Œé‚£ä¹ˆæšä¸¾ + åˆ†è®¨å°±å¥½äº†ï¼Ÿ</p><h3 id="WC2008-æ¸¸è§ˆè®¡åˆ’"><a href="#WC2008-æ¸¸è§ˆè®¡åˆ’" class="headerlink" title="$WC2008-æ¸¸è§ˆè®¡åˆ’$"></a><a href="https://www.luogu.com.cn/problem/P4294" target="_blank" rel="noopener">$WC2008-æ¸¸è§ˆè®¡åˆ’$</a></h3><hr><p>ä¸€çœ¼æœ€å°ç”Ÿæˆæ ‘ã€‚ä½†æ˜¯ä¸Šæ–¹æ ¼å›¾äº†ï¼Ÿï¼Ÿï¼Ÿ</p><p>æ–¯å¦çº³æ ‘ï¼Œä¸€ç§ å¥‡ å½¢ æ€ª çŠ¶ çš„çŠ¶å‹æœ€å°ç”Ÿæˆæ ‘ç®—æ³•ã€‚</p><p>$dp[i, S]$ è¡¨ç¤ºä¸²èµ·äº† $S$ é›†åˆçš„ç‚¹ï¼Œæ ¹ä¸º $i$ã€‚ä¸¤ç§è½¬ç§»ï¼š</p><ol><li>æ¯æ¬¡å°±æŠŠä¸€ä¸ªé›†åˆå¾€æ ¹ä¸Šå¹¶å°±å¥½: $dp[i, S | Sâ€™] = min{ dp[i, S] + dp[i, Sâ€™] - val[i] }$</li><li>æ¢æ ¹å°±ä¸€æ­¥ä¸€æ­¥å¾€èº«è¾¹çš„èŠ‚ç‚¹æ¢: $dp[i, S] = min{ dp[j, S] + val[i], (i, j) \in E }$</li></ol><p>å‘ç°ç¬¬ä¸€ä¸ªè½¬ç§»æŒ‰ç§©ï¼Œç¬¬äºŒä¸ªè½¬ç§»æ— æ˜æ˜¾é¡ºåºï¼Œå¹²è„†å¥—ä¸ª $spfa$ï¼Œå°±åšå®Œäº†ã€‚ä»¥ $s$ ä¸ºåˆ’åˆ†é˜¶æ®µã€‚</p><p>è¿™æ˜¯æ–¯å¦çº³æ ‘çš„å¸¸è§„å¥—è·¯ã€‚</p><h3 id="THUSCH2017-å·§å…‹åŠ›"><a href="#THUSCH2017-å·§å…‹åŠ›" class="headerlink" title="$THUSCH2017-å·§å…‹åŠ›$"></a><a href="https://loj.ac/p/2977" target="_blank" rel="noopener">$THUSCH2017-å·§å…‹åŠ›$</a></h3><p>å¾ˆå¥½çš„ <del>éš æœº åŒ–</del> æ–¯å¦çº³æ ‘é¢˜ã€‚é¦–å…ˆå¦‚æœ $C$ å¾ˆå°çš„è¯æ€ä¹ˆåšï¼Ÿæˆ‘ä»¬å¯ä»¥äºŒåˆ†ä¸­ä½æ•°ï¼ˆå˜æƒå€¼ä¸º $0$/$1$ï¼‰ + çŠ¶å‹è·‘æ–¯å¦çº³æ ‘ã€‚ä½†æ˜¯æˆ‘ä»¬é¦–è¦çš„æ˜¯é€‰çš„å—æ•°å°½é‡å°‘ï¼Œæ¬¡è¦çš„æ˜¯é€‰çš„ $0$ å°½é‡å¤šï¼Œæ€ä¹ˆ $dp$ï¼Ÿ<strong>è¿™é‡Œæœ‰ä¸ªè¶…å¥½çš„ Trickï¼šæŠŠ $0$ èµ‹ä¸º $inf - 1$ï¼ŒæŠŠ $1$ èµ‹ä¸º $inf + 1$ï¼Œå—æ•°å°±æ˜¯ $\lfloor \frac{val + 300}{1000} \rfloor$</strong></p><p>ä½†æ˜¯ $C$ å¤§è€Œ $K$ å°ã€‚äºæ˜¯æƒ³åˆ°æŠŠ $C$ ç§é¢œè‰²éšæœºåˆ†ä¸º $K$ ç±»è·‘çŠ¶å‹ã€‚æ­£ç¡®ç‡æ˜¯ $\frac{k!}{k^k}$ï¼Œçº¦ç­‰äº $0.0384$, è·‘ä¸ªå‡ ç™¾æ¬¡å°±æ²¡é—®é¢˜äº†ã€‚</p><p><a href="https://loj.ac/s/991228" target="_blank" rel="noopener">$Code$</a></p><h3 id="HNOI2013-ä¸æˆ–é"><a href="#HNOI2013-ä¸æˆ–é" class="headerlink" title="$HNOI2013-ä¸æˆ–é$"></a><a href="https://www.luogu.com.cn/problem/P3220" target="_blank" rel="noopener">$HNOI2013-ä¸æˆ–é$</a></h3><hr><p>ï¼ˆåŸæ¥ä¸éï¼ˆ$nand$ï¼‰æ˜¯çœŸçš„å­˜åœ¨å•Šï¼Œï¼Œä¸æ˜¯ä¸ºé¢˜è€Œç¼–å‡ºæ¥çš„ï¼Œï¼Œï¼‰</p><p>è¿™æ˜¯ä¸ªå¾ˆå¼ºå¤§çš„è¿ç®—ï¼Œ$and$ã€$or$ã€$xor$ã€$not$ å‡å¯ç”¨ $nand$ æ¥è¡¨ç¤ºã€‚$not\ A = A\ nand\ A$, $A\ and\ B = not\ (A\ nand\ B)$, $A\ or\ B = (not\ A)\ nand\ (not\ B)$ï¼Œè€Œ $xor$ æ˜¾ç„¶å¯ä»¥ç”±å¦å¤–ä¸‰ç§è¡¨å‡ºã€‚</p><p>æ‰€ä»¥é¢˜ç›®ç­‰ä»·äºå¯ä»¥å°† $n$ ä¸ªæ•°ä»»æ„ä½è¿ç®—èµ·æ¥ï¼å¼å¼</p><p>å˜ä¸­æ‰¾ä¸å˜ã€‚è‹¥å­˜åœ¨ä¸¤ä¸ªä½ç½® $i$ å’Œ $j$ ä½¿å¾— $n$ ä¸ªæ•°çš„ $i$ å’Œ $j$ ä½éƒ½ç›¸åŒï¼Œæ˜¾ç„¶æœ€ç»ˆæå‡ºçš„æ•° $i$ å’Œ $j$ ä½ä¹Ÿæ˜¯ç›¸åŒçš„ã€‚å› æ­¤æ•°ä½ $dp$ çš„æ—¶å€™ä»é«˜ä½åˆ°ä½ä½è€ƒè™‘ï¼Œç¡®å®šå½“å‰ä½åå¿…é¡»å°†å’Œå®ƒç›¸åŒçš„ä½æ ‡è®°ä¸€ä¸‹ã€‚</p><p>å‰©ä½™æ²¡æœ‰äº’ç›¸é™åˆ¶çš„ä½ç½®å¯ä»¥ä»»æ„å– $0$ æˆ– $1$ã€‚ä¸ºä»€ä¹ˆï¼Ÿï¼Ÿè€ƒè™‘ç”¨çº¿æ€§åŸºçš„æ€æƒ³æ„é€ è§£ï¼ˆå‡è®¾å½“å‰è¦å–ç¬¬ $x$ ä½ä¸º $1$ï¼‰ï¼šé€šè¿‡ä¸€äº›æ“ä½œæŠŠ $n$ ä¸ªæ•°æ¶ˆæˆä¸Šä¸‰è§’ï¼›å¯¹äºç¬¬ $x$ ä½ä¸º $0$ çš„ $a_i$ æŠŠ $a_i$ å–åï¼Œå¦åˆ™ä¸åŠ¨ã€‚æŠŠ $a$ å…¨éƒ¨ &amp; èµ·æ¥ï¼Œ$x$ ä½ä¸Šå¿…ç„¶æ˜¯ $1$ï¼›åŒæ—¶ç”±äº $x$ æ²¡æœ‰äº’ç›¸é™åˆ¶çš„ä½ç½®ï¼Œæ²¡æœ‰å…¶ä»–ä½ä¸Šä¸º $1$ã€‚</p><h3 id="é‡è¿”ç°ä¸–"><a href="#é‡è¿”ç°ä¸–" class="headerlink" title="$é‡è¿”ç°ä¸–$"></a><a href="https://www.luogu.com.cn/problem/P4707" target="_blank" rel="noopener">$é‡è¿”ç°ä¸–$</a></h3><hr><p>å¥½åƒç¬¬ä¸€æ¬¡åš $k-th\ \min-\max$ å®¹æ–¥çš„é¢˜ã€‚ã€‚å¯èƒ½åªæ˜¯æ¿å­é¢˜ï¼Œä½†æ˜¯ $dp$ å®¹æ–¥ç³»æ•°çš„æ–¹æ³•æŒºé‡è¦ï¼Œç¢°åˆ°å¥½å‡ æ¬¡äº†è®°å½•ä¸€ä¸‹ã€‚</p><p>$\min_k$ å’Œ $\max_k$ å¯ä»¥è½¬åŒ–ã€‚<br>$$E(\max_k(S)) = \sum\limits_{T \subset S} (-1)^{|T| - k} \binom{|T| - 1}{k - 1} * E(\min(T))$$<br>$$E(\min(T)) = \frac{m}{\sum\limits_{t \in T} p_t}$$<br>å®¹æ–¥è¿™ä¸œè¥¿çš„ç³»æ•°æ˜¾ç„¶å¯ä»¥ $dp$ï¼Œè€å¥—è·¯äº†ã€‚</p><p>è€ƒè™‘çŠ¶æ€æ€ä¹ˆè®¾è®¡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ $k$ å’Œ $E(\min(T))$ ç»™è¡¨ç¤ºåˆ°çŠ¶æ€é‡Œï¼š$f[i, j, k]$ è¡¨ç¤º, å½“å‰åˆ°ç¬¬ $i$ ç§åŸæ–™ï¼Œ$\sum p_t = j$, æŸ¿å­ä¸­çš„ $k = k$ æ—¶, $\sum\limits_{T \subset S} (-1)^{|T| - k} \binom{|T| - 1}{k - 1}$ çš„å’Œã€‚è½¬ç§»ï¼š</p><p>$f[i, j, k] = f[i - 1, j, k]$ (ä¸é€‰ $i$)</p><p>$+ f[i - 1, j - p_i, k - 1] - f[i - 1, j - p_i, k]$ï¼ˆé€‰ $i$ï¼‰</p><p>è¿™æ˜¯å› ä¸º $|T|$ å¢åŠ  $1$ æ—¶, $\binom{|T| - 1}{k - 1} = \binom{|T| - 2}{k - 1} + \binom{|T| - 2}{k - 2}$ï¼ˆæ ¹æ®ç»„åˆæ•°çš„å®šä¹‰ï¼‰ç„¶å $-1$ çš„æŒ‡æ•°ä¹Ÿæ”¹å˜äº†ï¼Œè´Ÿè´Ÿå¾—æ­£ã€‚</p><p>è¾¹ç•Œï¼š$f[0, 0, k] = 0$,<br>$f[i, p_i, k] = f[i - 1, p_i, k] + (-1)^{1 - k}\binom{0}{k - 1}$ï¼Œåé¢è¿™å¨ç­‰ä»·äº $[k == 1]$</p><h3 id="è½¬ç›˜"><a href="#è½¬ç›˜" class="headerlink" title="$è½¬ç›˜$"></a><a href="http://loj.ac/p/2495" target="_blank" rel="noopener">$è½¬ç›˜$</a></h3><hr><p>æˆ‘ä»¬å‘ç°å¦‚æœæ—¶é—´è¢«æŸä¸ªç‚¹é™åˆ¶ä½ï¼Œå°±æ²¡å¿…è¦åœ¨èµ°åˆ°é‚£ä¸ªç‚¹çš„è·¯ä¸Šèµ°èµ°åœåœï¼Œç›´æ¥åœ¨å‡ºå‘å‰ä¸€æ¬¡åœä¸ªå¤Ÿã€‚</p><p>ç ´ç¯æˆé“¾ï¼Œåœ¨èµ·å§‹ç‚¹åœæ»¡æ—¶é—´ã€‚æšä¸¾èµ·å§‹ç‚¹ï¼Œå‡è®¾ä» $st$ å¼€å§‹ï¼Œ$ans = \min\limits_{st}( \max\limits_i( T_i - dist(i, st) ) ) + n - 1$</p><p>æš´åŠ›è®¡ç®—æ˜¯ $O(n^2)$ çš„ï¼Œè€ƒè™‘æ•°æ®ç»“æ„ç»´æŠ¤</p><p>æ‹†ä¸€æ³¢ $dist$ï¼ˆå»æ‰ç¯çš„å½±å“ï¼‰ï¼š<br>$ans = \min\limits_{ 1 \leq i \leq n }( \max\limits_{ 0 \leq j \le n }(T_{i + j} - j) ) + n - 1$</p><p>è®¾ $a_i = T_i - i$ï¼Œ$ans = \min\limits_{ 1 \leq i \leq n }( \max\limits_{ i \leq j \le i + n - 1 }{a_j} + i ) + n - 1$ï¼Œå‘ç°æ˜¯ä¸€ä¸ªåç¼€ $\max$ çš„ $\min$ï¼Œ$\min$ ç›´æ¥çº¿æ®µæ ‘ï¼Œ<br>åç¼€ $\max$ æ€ä¹ˆæï¼Ÿå•è°ƒé˜Ÿåˆ— $O(n)$ï¼Œçº¿æ®µæ ‘ç»´æŠ¤ $a$ çš„å•è°ƒå¢çš„é˜Ÿåˆ—å°±å¥½äº†ï¼</p><p>ç”¨ <a href="https://www.luogu.com.cn/problem/P4198" target="_blank" rel="noopener">è¿™é¢˜</a> çš„åšæ³•ï¼Œåˆ†æ²»çš„åˆå¹¶ï¼Œéå¸¸å¼ºã€‚</p><p>æ¥ä¸‹æ¥è¯æ˜æˆ‘ä»¬å¯ä»¥ç»Ÿè®¡çª—å£å¤§å° $= n$ çš„ç­”æ¡ˆã€‚å› ä¸º $a_i = T_i - i, a_{i + n} = T_i - i - n$, æ‰€ä»¥çª—å£å¤§å° <strong>$\leq n$</strong>;<br>åˆå› ä¸ºçª—å£å¤§å° $\geq \frac{1}{2}$ åŒºé—´é•¿åº¦ï¼Œå¯¹äºæœ€å¤§çš„åŒºé—´ $[1, 2n]$ è€Œè¨€ **$\geq n$**ã€‚</p><p><a href="https://loj.ac/s/985524" target="_blank" rel="noopener">$Code$</a></p><h3 id="ZJOI2019-çº¿æ®µæ ‘"><a href="#ZJOI2019-çº¿æ®µæ ‘" class="headerlink" title="$ZJOI2019-çº¿æ®µæ ‘$"></a><a href="https://uoj.ac/problem/467" target="_blank" rel="noopener">$ZJOI2019-çº¿æ®µæ ‘$</a></h3><hr><p>ç°åœ¨çœ‹çœ‹ï¼Œä¸€çœ¼æœŸæœ›å˜›ã€‚ã€‚è€å¥—è·¯äº†ï¼šç”¨æœŸæœ›åšè®¡æ•°é¢˜</p><p>æ¯”è¾ƒå·§å¦™çš„æ˜¯çŠ¶æ€è®¾è®¡ï¼Œé™¤äº†ç»´æŠ¤æœ¬ç‚¹ä¸º $1$ çš„æ¦‚ç‡å¤–ï¼Œè¿˜ç»´æŠ¤ç¥–å…ˆä¸º $1$ çš„æ¦‚ç‡ã€‚è®¾å…¶åˆ†åˆ«ä¸º $f$ å’Œ $g$ã€‚</p><p>ä¸‹é¢åˆ†äº”ç§æƒ…å†µï¼š</p><ol><li>å…¨è¦†ç›–çš„ç‚¹: $g_i = \frac{1}{2} g_i + \frac{1}{2}$</li><li>æœ¬ç‚¹: $f_i = \frac{1}{2}f_i + \frac{1}{2}$, $g_i = \frac{1}{2}g_i + \frac{1}{2}$</li><li>åˆ°æ ¹ç»è¿‡çš„è·¯å¾„ä¸Šç‚¹: $f_i = \frac{1}{2}f_i$, $g_i = \frac{1}{2}g_i$</li><li>é è¿‘è·¯å¾„ä½†å…¨ä¸è¦†ç›–çš„ç‚¹: $f_i = \frac{1}{2}f_i + \frac{1}{2}g_i$, $g_i = g_i$</li><li>æ¯«æ— å½±å“çš„ç‚¹: $f_i = f_i$, $g_i = g_i$</li></ol><p>$2$, $3$ å’Œ $4$ éƒ½æ˜¯ $modify$ çš„æ—¶å€™ä¼š $psd$ çš„ï¼Œæ‰€ä»¥ç›´æ¥æ“ä½œå°±å¥½ã€‚å”¯ç‹¬è¦ç»™ $1$ æ‰“ $tag$ï¼šæˆ‘ä»¬è®©è¿™ä¸ª $tag$ æ‰“åœ¨ç³»æ•°å’Œå¸¸æ•°ä¸Šï¼Œå‘ç°è‹¥æ‰“äº† $k$ ä¸ª $\frac{1}{2}$ï¼Œç³»æ•°å°±æ˜¯ $(\frac{1}{2})^k$, å¸¸æ•°æ˜¯ $1 - (\frac{1}{2})^k$</p><p><a href="https://uoj.ac/submission/438768" target="_blank" rel="noopener">$Code$</a></p><h3 id="ä¸‰è§’å½¢"><a href="#ä¸‰è§’å½¢" class="headerlink" title="$ä¸‰è§’å½¢$"></a><a href="https://uoj.ac/problem/418" target="_blank" rel="noopener">$ä¸‰è§’å½¢$</a></h3><hr><p>æ­£ç€åšï¼Œæ¯ä¸ªç‚¹å—åˆ°å®ƒæ‰€æœ‰å„¿å­çš„é™åˆ¶ï¼Œæ— æ³•é¿å…è¿™ä¸ªé™åˆ¶ï¼Œæ²¡æ³•åšã€‚æŠ€å·§ï¼šå¾—å¤±è½¬æ¢é¢˜è€ƒè™‘å€’ä¸€ä¸‹é¡ºåºï¼Œ<strong>æ¯ä¸ªç‚¹å°±åªå—çˆ¶äº²å½±å“äº†</strong></p><p>æ¯æ¬¡æ“ä½œå¯ä»¥ç”¨äºŒå…ƒç»„ $((\sum w_{son}) - w_i$, $\sum w_{son})$æ¥è¡¨ç¤ºï¼Œåˆ†åˆ«æ˜¯æœ€ç»ˆå½±å“å’Œæ“ä½œè¿‡ç¨‹ä¸­è¾¾åˆ°çš„æœ€å¤§å€¼</p><p>ä¼˜å…ˆçº§å¥½ç®—ï¼Œå †ç»´æŠ¤ï¼Œå–é˜Ÿé¦–å’Œçˆ¶äº²ç»‘ä¸€å—ï¼Œè€å¥—è·¯äº†ã€‚</p><p><strong>æ“ä½œä¼˜å…ˆçº§æ€ä¹ˆç®—ï¼Ÿ</strong>å°†äºŒå…ƒç»„çœ‹ä½œ $(x, y)$ï¼Œæ¯”è¾ƒ $(x, y)$ å’Œ $(xâ€™, yâ€™)$ã€‚æˆ‘ä»¬æ¯”è¾ƒçš„å®—æ—¨æ˜¯è®©ç¬¬äºŒç»´æœ€å°ï¼Œå³å¦‚æœ $\max(y, x + yâ€™) &lt; \max(yâ€™, xâ€™ + y)$ é‚£å…ˆä¸€åäºŒï¼Œå¦åˆ™å…ˆäºŒåä¸€ã€‚</p><p>æœ€æ¶å¿ƒçš„æ¥äº†â€”â€”<strong>è¿™æ ·å†™ä¼š Tï¼</strong><br>æ‰€ä»¥è€å®åˆ†ç±»è®¨è®ºå§ã€‚æ³¨æ„æ‹†æ‰ $x + yâ€™ &lt; \max(xâ€™ + y, yâ€™)$ å³è¾¹çš„ $\max$ æ—¶ $x$ å¿…é¡» $\geq 0$ï¼Œæ‰€ä»¥ $x$ã€$xâ€™ &lt; 0$ çš„æ—¶å€™è¦ç‰¹æ®Šè®¨è®ºã€‚</p><p>ç»‘çš„æ—¶å€™åˆå¹¶æ“ä½œï¼Œå½±å“ç›¸åŠ ï¼Œæœ€å¤§å€¼æ›´æ–°ã€‚è¿™æ ·å°±ç®—å‡ºäº†å…¨å±€æœ€ä¼˜è§£ã€‚</p><p>è€Œæ ¹æ®æ“ä½œåºåˆ—åæ¨å‡ºæ¯ä¸ªå­æ ‘ç­”æ¡ˆçš„æ–¹æ³•ä¹Ÿå¾ˆå·§å¦™ï¼šè€ƒè™‘æ¯ä¸ªå­æ ‘çš„æ“ä½œåºåˆ—æ˜¯å…¨å±€çš„ä¸€ä¸ªå­åºåˆ—ï¼Œæˆ‘ä»¬ç”¨çº¿æ®µæ ‘åˆå¹¶æ±‚è§£æ‰€æœ‰å­æ ‘çš„ç­”æ¡ˆå°±å¯ä»¥äº†ã€‚çº¿æ®µæ ‘ä¸Šä»¥æ—¶é—´ä¸ºä¸‹æ ‡ã€‚</p><p><a href="https://uoj.ac/submission/438673" target="_blank" rel="noopener">$Code$</a></p><h3 id="UOJ211-é€ƒè·‘"><a href="#UOJ211-é€ƒè·‘" class="headerlink" title="$UOJ211-é€ƒè·‘$"></a><a href="https://uoj.ac/problem/211" target="_blank" rel="noopener">$UOJ211-é€ƒè·‘$</a></h3><p>æ±‚æ–¹å·®å°±æ˜¯æ±‚æ¯ç§æƒ…å†µç»è¿‡ä½ç½®ä¸ªæ•°å’Œï¼Œä»¥åŠç»è¿‡ä½ç½®ä¸ªæ•°å¹³æ–¹å’Œã€‚ä¸ªæ•°å’Œå¯ä»¥ $dp$: $f[i, x, y]$ è¡¨ç¤ºèµ°äº† $i$ æ­¥ç¬¬ä¸€æ¬¡åˆ°è¾¾ $(x, y)$ çš„æ¦‚ç‡ï¼Œ$g[i, x, y]$ è¡¨ç¤ºèµ°äº† $i$ æ­¥åˆ°è¾¾ $(x, y)$ çš„æ¦‚ç‡ï¼Œæ˜¾ç„¶ $f$ å¯ä»¥ç”± $f$ å’Œ $g$ å®¹æ–¥å¾—åˆ°ã€‚</p><p>å¹³æ–¹å’Œè€å¥—è·¯ï¼ŒæŠŠ $x^2$ æ‹†æˆ $C(x, 2) + x$ï¼Œè€ƒè™‘å…¶å®é™…æ„ä¹‰å°±æ˜¯åˆ°è¾¾äº†ä¸¤ä¸ªåœ°ç‚¹çš„æ¦‚ç‡â€”â€”è¿™æ€ä¹ˆæï¼Ÿ$h[i, x, y]$ è¡¨ç¤ºèµ°äº† $i$ æ­¥åœ¨åˆ°è¾¾ $(a, b)$ å‰åˆ°è¾¾è¿‡ $(a - x, b - y)$ çš„æ¦‚ç‡å’Œï¼Œè¦å‡å»åœ¨åˆ°è¾¾ $(a - x, b - y)$ å‰åˆ°è¾¾è¿‡ $(a, b)$ çš„æ¦‚ç‡å’Œã€‚</p><p><a href="https://uoj.ac/submission/440153" target="_blank" rel="noopener">$Code$</a></p><h3 id="UOJ141-é‡å­æ€çš„æ£‹ç›˜"><a href="#UOJ141-é‡å­æ€çš„æ£‹ç›˜" class="headerlink" title="$UOJ141-é‡å­æ€çš„æ£‹ç›˜$"></a><a href="https://uoj.ac/problem/141" target="_blank" rel="noopener">$UOJ141-é‡å­æ€çš„æ£‹ç›˜$</a></h3><hr><p>é¦–å…ˆé‚£ä¹ˆå¤šçƒæ˜¯å”¬ä½ çš„ï¼šå‡è®¾æœ‰ $a$ ä¸ªçƒæµåˆ° $(x, y)$ ä¸Šï¼Œé‚£ä¹ˆä¼šåˆ†ä¸ºä¸¤ä¸ªæ”¯æµï¼Œåˆ†åˆ«ä¸º $a / 2$ å’Œ $(a + 1) / 2$ï¼Œå°±çœ‹ $(x, y)$ åˆå§‹çŠ¶æ€å†³å®šé‚£ä¸ªæ”¯æµåˆ°é‚£ä¸ªæ–¹å‘ã€‚$n$ã€$m$ é‚£ä¹ˆå°ï¼Œç›´æ¥ $80$ è¿›åˆ¶çŠ¶å‹ï¼Œæ€»çŠ¶æ€æ•°åªæœ‰å‡ åä¸‡ï¼Œ$hashmap$ å†²ä¸€å‘å°±å¥½ã€‚</p><p><a href="https://uoj.ac/submission/440103" target="_blank" rel="noopener">$Code$</a></p><h3 id="CF1163E"><a href="#CF1163E" class="headerlink" title="$CF1163E$"></a><a href="https://www.luogu.com.cn/problem/CF1163E" target="_blank" rel="noopener">$CF1163E$</a></h3><hr><p><a href="https://www.cnblogs.com/p-b-p-b/p/11741238.html" target="_blank" rel="noopener">é¢˜è§£</a></p><p>è¿™é¢˜å¥½å¦™ï¼æ„Ÿè§‰çº¿æ€§åŸºçš„é¢˜ç›®æƒ³è·Ÿæˆ‘è®²é“ç†éƒ½ä¸è¡Œ= = æ„è¯†æµèµ›é«˜ã€‚ã€‚</p><p>å¤§æ¦‚æ˜¯åªèƒ½ç”¨ $&lt; 2^x$ çš„æ•°ï¼›åŒæ—¶æ„æˆå¤§å°ä¸º $k$ çš„çº¿æ€§æ— å…³ç»„ï¼ˆçº¿æ€§åŸºï¼‰ï¼Œè¿™ä¸ªçº¿æ€§åŸºèƒ½å¼‚æˆ–å‡º $2^x - 1$ ä¸ªæ•°ï¼Œæ„é€ å°±éšæ€§ä¸€ç‚¹ï¼Œæ¯æ¬¡ pia ä¸¤åŠï¼Œå·¦å³å› ä¸ºä¸­é—´æœ‰ä¸ªæ•°ï¼ˆåŸºé‡Œçš„æ•°ï¼Œä»€ä¹ˆæ•°éƒ½è¡Œï¼Œæœ¬ä»£ç ä¸­ä¸æ·±åº¦æœ‰å…³ï¼‰ï¼Œå¿…ç„¶æ˜¯ä¸åŒçš„ã€‚<br>å¤ªå¦™äº†ï¼ŒæŠŠçº¿æ€§æ— å…³è¿ç”¨çš„æ·‹æ¼“å°½è‡´ã€‚</p><h3 id="CF1163F"><a href="#CF1163F" class="headerlink" title="$CF1163F$"></a><a href="https://www.luogu.com.cn/problem/CF1163F" target="_blank" rel="noopener">$CF1163F$</a></h3><hr><p>è¯»å®Œé¢˜æˆ‘æƒ³ï¼šå¦‚æœèƒ½ç»´æŠ¤ä¸ç»è¿‡æŸæ¡è¾¹çš„æœ€çŸ­è·¯å°±å¥½äº†ã€‚ã€‚</p><p>æ­£è§£å¾ˆç¡¬æ ¸ï¼Œç›´æ¥æœ€çŸ­è·¯æ ‘ + åˆ†è®¨</p><ol><li>$(u, v)$ ä¸åœ¨æœ€çŸ­è·¯ä¸Šï¼Œå˜å°ï¼Œæ–°å€¼ä¸åˆå§‹ç­”æ¡ˆå–ä¸ª $\min$</li><li>$(u, v)$ ä¸åœ¨æœ€çŸ­è·¯ä¸Šï¼Œå˜å¤§ï¼Œæ— å½±å“</li><li>$(u, v)$ åœ¨æœ€çŸ­è·¯ä¸Šï¼Œå˜å°ï¼Œç­”æ¡ˆå‡å°å¯¹åº”çš„å€¼ï¼›</li><li>$(u, v)$ åœ¨æœ€çŸ­è·¯ä¸Šï¼Œå˜å¤§ï¼Œè¿™ä¸ªæ¯”è¾ƒéº»çƒ¦ã€‚<br>å›ç­”ä¸Šé¢é‚£ä¸ªé—®é¢˜ï¼çº¿æ®µæ ‘ï¼</li></ol><p>æ‡‚äº†å—ï¼Ÿçº¿æ®µæ ‘åªè¦ç»´æŠ¤åŸå§‹æœ€çŸ­è·¯çš„æ–­è¾¹æƒ…å†µã€‚$[L, R]$ è¡¨ç¤ºä¸ç”¨åŒºé—´ $[L, R]$ çš„è¾¹çš„æœ€çŸ­è·¯</p><p>ç»å…¸å¥—è·¯ï¼š<strong>æ‰¹é‡</strong>ç»´æŠ¤åˆ é™¤æŸä¸ªç‚¹æˆ–è¾¹çš„å¯ä»¥å°è¯•åˆ†æ²»</p><p>æŸæ¡è¾¹ $(u, v)$ æ‰€åœ¨çš„æœ€çŸ­è·¯ï¼Œå¯¹åˆ é™¤<em>è¿æ¥ $u$ çš„ã€åœ¨ $u$ ä¹‹å‰ï¼Œåœ¨æœ€çŸ­è·¯ä¸Šçš„æœ€åç‚¹</em> ~ _è¿æ¥ $v$ çš„ã€åœ¨ $v$ ä¹‹åï¼Œåœ¨æœ€çŸ­è·¯ä¸Šçš„æœ€å‰ç‚¹_ä¹‹é—´çš„è¾¹æœ‰è´¡çŒ®</p><h3 id="CF516E"><a href="#CF516E" class="headerlink" title="$CF516E$"></a><a href="https://www.luogu.com.cn/problem/CF516E" target="_blank" rel="noopener">$CF516E$</a></h3><p>æˆ‘å³æ•°å­¦é»‘æ´ï¼</p><p>è®¾ $x = i % n$, $y = i % m$</p><p>$i = k1 * n + x = k2 * m + y$</p><p>$x \equiv y \pmod {gcd(n, m)}$</p><p>è®¾ $d = gcd(n, m)$, äºæ˜¯å°±å¯ä»¥æŠŠç”·å¥³ç”Ÿå…³äº $d$ å½’ä¸º $0 ~ d - 1$ ç±»ï¼Œä¸åŒç±»é—´äº’ä¸å½±å“ï¼Œäºæ˜¯å˜æˆäº† $d$ ä¸ªå­é—®é¢˜ã€‚ä¸€ä¸ªå­é—®é¢˜çš„è´¡çŒ®æ˜¯è¿™ä¸€ç±»çš„æ‰€æœ‰ç”·å¥³ç”Ÿå˜å¼€å¿ƒçš„æ—¶é—´ã€‚ï¼ˆæ¥ä¸‹æ¥çš„ $n$ å’Œ $m$ æ˜¯é™¤ä»¥ $d$ åçš„ï¼Œäº’è´¨ï¼‰</p><p>å¦‚æœ $i % n$ ç”·ç”Ÿè®© $i % m$ å¥³ç”Ÿå˜å¼€å¿ƒäº†ï¼Œé‚£ $(i + n) % m$ å¥³ç”Ÿåœ¨ $n$ æ—¶é—´åä¹Ÿä¼šå˜å¼€å¿ƒï¼Œ<br>æ‰€ä»¥è¿è¾¹ï¼š$i -&gt; (i + n) % m$, $n$</p><p>å†å¯¹äºæ‰€æœ‰åˆå§‹å°±å¼€å¿ƒçš„ $i$ è¿è¾¹ï¼š$S -&gt; i$, $i$</p><p>ç„¶åè·‘æœ€çŸ­è·¯ã€‚ä½†æ˜¯å›¾å¤ªå¤§äº†ã€‚</p><p>è€ƒè™‘ç¬¬ä¸€ç§è¾¹ï¼Œå› ä¸º $n$ å’Œ $m$ äº’è´¨ï¼Œæ‰€ä»¥ä¼šè¿æˆä¸€ä¸ªå¤§ç¯ï¼Œæˆ‘ä»¬æŠŠä¸ $S$ ç›¸è¿çš„ç‚¹ç§°ä¸ºå…³é”®ç‚¹ï¼ŒæŠŠæ‰€æœ‰å…³é”®ç‚¹æ‹å‡ºæ¥ï¼Œå¯¹æœ€å¤§æ—¶é—´æœ‰è´¡çŒ®çš„å¿…ç„¶æ˜¯ç›¸é‚»ä¸¤ç‚¹ä¹‹é—´æœ€é å³çš„éå…³é”®ç‚¹ï¼ˆç”»å›¾å°±æ˜ç™½äº†ï¼‰</p><p>é‚£æ€ä¹ˆç»™æ‹å‡ºæ¥çš„å…³é”®ç‚¹é‡æ ‡å·ï¼ˆæ’åºï¼‰å‘¢ï¼Ÿ$exgcd$ ç®—èµ·ç‚¹åˆ°å®ƒä»¬çš„è·ç¦»ï¼Œå°±åšå®Œäº†ã€‚</p><p>åè®°ï¼šxml å› ä¸ºè´ºäº†ä¸€æ•´é¢˜æ‰€ä»¥éå¸¸éš¾å—ã€‚</p><h3 id="BZOJ3636-æ•™ä¹‰é—®ç­”æ‰‹å†Œ"><a href="#BZOJ3636-æ•™ä¹‰é—®ç­”æ‰‹å†Œ" class="headerlink" title="$BZOJ3636-æ•™ä¹‰é—®ç­”æ‰‹å†Œ$"></a><a href="https://darkbzoj.tk/problem/3636" target="_blank" rel="noopener">$BZOJ3636-æ•™ä¹‰é—®ç­”æ‰‹å†Œ$</a></h3><p>ä¸èƒ½é‡å ï¼Œè€Œä¸”æ˜¯è‹¥å¹²æ¡ã€‚</p><p>é¦–å…ˆæœ‰æ˜¾ç„¶çš„ $n^2$ $dp$ï¼š<br>$f[l, r]$ è¡¨ç¤ºåŒºé—´ $[l, r]$ çš„ç­”æ¡ˆï¼Œé‚£ä¹ˆ<br>$f[l, r] = max(f[l, r - 1], f[l, r - L] + s[r] - s[r - L])$</p><p>å½“ç„¶ä¹Ÿå¯ä»¥åå‘ï¼š<br>$f[l, r] = max(f[l + 1, r], f[l + L, r] + s[l + L - 1] - s[l - 1])$</p><p>æ‰€ä»¥æˆ‘ä»¬çŸ¥é“äº†æŸä¸ªç«¯ç‚¹å°±å¯ä»¥ $O(n)$ è®¡ç®—æˆ‘ä»¬æƒ³è¦çš„ä¸œè¥¿</p><p>ç¥ litbleï¼šä¸èƒ½ $AC$ ä½†å¾ˆå¦™çš„åˆ†å—ï¼ˆæ­£è§£æ— å…³ï¼‰ï¼šå¯¹äºæ¯ä¸ªå—çš„å·¦ç«¯ç‚¹ $l$ï¼Œé¢„å¤„ç†æ‰€æœ‰ç‚¹ä½œä¸º $r$ çš„ $f$ã€‚</p><p>æ­£è§£ï¼šå¯¹äºæ¯ä¸ªä¸­ç‚¹å¤„ç†è¿‡ä¸­ç‚¹çš„è¯¢é—®ã€‚<br>è¦ä¹ˆä¸å–è·¨ä¸­ç‚¹çš„åŒºé—´ï¼Œè¦ä¹ˆå–ï¼Œ$O(L)$ æšä¸¾è·¨ä¸­ç‚¹åŒºé—´çš„å·¦ç«¯ç‚¹å† $O(n)$ è®¡ç®—æœªè¢«åŒ…æ‹¬åœ¨è·¨ä¸­ç‚¹åŒºé—´é‡Œçš„åŒºé—´ç­”æ¡ˆï¼ˆç”¨ä¸Šé¢çš„ $dp$ï¼‰</p><p>æ‰€ä»¥æ˜¯ $O(nL log n)$</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CSP2020 æ€»ç»“</title>
      <link href="2020/11/18/CSP2020%20%E6%80%BB%E7%BB%93/"/>
      <url>2020/11/18/CSP2020%20%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>è¢« T1 æå¾—å¿ƒæ€çˆ†ç‚¸å¯¼è‡´ T3 å½»åº•é™æ™ºï¼Œæœ€åä¸€å°æ—¶æµ‘æµ‘å™©å™©ä¸€åˆ†éƒ½æ²¡æç€ï¼Œå¤§å¤±è´¥ï¼</p><h2 id="T1-å„’ç•¥æ—¥"><a href="#T1-å„’ç•¥æ—¥" class="headerlink" title="$T1. å„’ç•¥æ—¥$"></a>$T1. å„’ç•¥æ—¥$</h2><hr><p>æ‰“äº†ä¸€ä¸ªåŠå°æ—¶å·¦å³ï¼ŒçœŸçš„æ˜¯ã€‚ã€‚ã€‚æœ¬åœºå´©çš„ç½ªé­ç¥¸é¦–ï¼Œå…³é”®æ˜¯å¹´ä»½è¿˜ç®—é”™äº†ä¸€å¤„ï¼ˆå–æ¨¡ï¼‰ï¼Œåªæ‹¿åˆ°äº†æš´åŠ›åˆ†ã€‚ã€‚ã€‚ã€‚</p><p><del>å•Šï¼ï¼ï¼ï¼æ°”æ­»æˆ‘äº†ï¼ï¼ï¼ï¼</del></p><p>T1 çš„ä½¿å‘½å°±æ˜¯æ¥è€—æ—¶é—´çš„ï¼Œè€ƒå¯Ÿé€‰æ‰‹ä»£ç èƒ½åŠ›ã€‚å³é€‰æ‹©è¾ƒä¼˜çš„å†™æ³•ï¼Œä»¥ç¼©çŸ­æ—¶é—´ã€‚ã€‚ã€‚æ¯”å¦‚è¯´äºŒåˆ†å’Œå°èŒƒå›´çš„é¢„å¤„ç†å°±å¾ˆå¥½ã€‚ç‹‚ç  200 è¡Œçš„é€‰æ‰‹å¦‚æˆ‘ï¼Œä¸å´©è°å´©ï¼Ÿ</p><p><a href="https://loj.ac/submission/990046" target="_blank" rel="noopener">$Code$</a></p><h2 id="T2-åŠ¨ç‰©å›­"><a href="#T2-åŠ¨ç‰©å›­" class="headerlink" title="$T2. åŠ¨ç‰©å›­$"></a>$T2. åŠ¨ç‰©å›­$</h2><hr><p>å‘µï¼Œæœ€å 5 min å‘ç°æ•°æ®èŒƒå›´ $0 \leq k \leq 64$â€¦ å†è§ï¼Œè¿™ç¾ä¸½çš„ä¸–ç•Œã€‚</p><p>äºæ˜¯æ¯”å»å¹´æ›´çƒ¦äº†ä¸€é‡ï¼šè¦åˆ¤ = 64 å’Œ 65 çš„ï¼Œ65 å°±æ˜¯å…ˆå‡ååŠ ã€‚</p><p><a href="https://loj.ac/submission/990047" target="_blank" rel="noopener">$Code$</a></p><h2 id="T3-å‡½æ•°è°ƒç”¨"><a href="#T3-å‡½æ•°è°ƒç”¨" class="headerlink" title="$T3. å‡½æ•°è°ƒç”¨$"></a>$T3. å‡½æ•°è°ƒç”¨$</h2><hr><p>è¢« T1 çƒ¦åˆ°äº†ï¼Œæ€è·¯å®Œå…¨ä¹±æ‰ï¼Œå½’æ ¹ç»“åº•è¿˜æ˜¯å¿ƒç†ç´ è´¨å¤ªå·®äº†ï¼</p><p>è¿™é¢˜åªæ˜¯ç®€å•çš„åŠ æ³•ä¹˜æ³•åŸç†é¢˜ï¼Œåªè¦æ³¨æ„åˆ°è´¡çŒ®éƒ½æ˜¯ä»¥åŠ ä¸ºæ ¹æœ¬ï¼Œä»¥ä¹˜ä¸ºè¾…ï¼Œå¤§æ¦‚å°±èƒ½æƒ³å‡ºæ¥ã€‚æœ€ç»ˆç­”æ¡ˆçš„åŸå…ˆé¢ç›®éƒ½æ˜¯ä¸€äº›åŠ æ“ä½œå•Šã€‚</p><p>äºæ˜¯è€ƒè™‘ç»´æŠ¤ä¹˜æ“ä½œå¯¹åŠ æ“ä½œçš„å½±å“ï¼Œè®°ä¸€ä¸ªåç¼€ä¹˜ç§¯å°±å¥½äº†ï¼Œæ‹“æ‰‘çœ‹ä¼¼éš¾å†™å®åˆ™å¥½å†™ã€‚ã€‚ã€‚</p><p><a href="https://loj.ac/submission/990045" target="_blank" rel="noopener">$Code$</a></p><h2 id="T4-è´ªåƒè›‡"><a href="#T4-è´ªåƒè›‡" class="headerlink" title="$T4. è´ªåƒè›‡$"></a>$T4. è´ªåƒè›‡$</h2><hr><p>è¿™é¢˜çœ‹ä¼¼ç®€å• å®åˆ™ä¸æ„§å¯¹å…¶ç¬¬å››é¢˜çš„åœ°ä½ã€‚ã€‚ã€‚æ€ç»´ä¸¥å¯†ï¼ŒæŒºæœ‰æ„æ€çš„ã€‚</p><p>é‡è¦æ€§è´¨ï¼ˆä¸ 16 å¹´çš„èš¯èš“ååˆ†ç›¸ä¼¼ï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿›é£Ÿçš„è›‡ä¸¢è¿›å¦ä¸€ä¸ªé˜Ÿåˆ—é‡Œï¼Œå‘ç°å½“å‰ä¸¢çš„ä¸€å®šæ˜¯è¿›é£Ÿè¿‡çš„è›‡é‡Œæœ€å¼±çš„</span><br></pre></td></tr></table></figure><p>çŒœæƒ³ï¼šå¦‚æœå½“å‰ $max$ åƒäº† $min$ï¼Œä¸ä¼šå˜æˆ $min$ï¼Œå°±ä¸€å®šä¼šåƒ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯æ˜ï¼šä¹‹ååƒäº†çš„ max ä¼šæ¯”å½“å‰åƒå®Œçš„ max æ›´å°ã€‚</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š</p><ol><li>å½“å‰ $max$ åƒäº† $min$ï¼Œä¸ä¼šå˜æˆ $min$ï¼Œå°±ä¸€ç›´åƒ</li><li>å½“å‰ $max$ åƒäº† $min$ï¼Œä¼šå˜æˆ $min$ï¼Œä¼šä¸€ç›´è¿›è¡Œä¸‹å»ç›´åˆ°æŸæ¡è›‡åƒäº†ä¸ä¼šå˜æˆ $min$ æˆ–æ€»æ•° $= 2$ï¼Œè¿™æ—¶æœ€ååƒçš„é‚£æ¡ä¼šåæ‚”ï¼Œå€’æ•°ç¬¬äºŒæ¡åƒçš„ä¸€å®šä¼šåƒï¼Œå€’æ•°ç¬¬ä¸‰æ¡ä¼šåæ‚”ã€‚ã€‚ã€‚å‘ç°å’Œé€’å½’å±‚æ•°çš„å¥‡å¶æ€§æœ‰å…³ã€‚æ„Ÿè§‰ååˆ†nbã€‚<br>$set$ ç»´æŠ¤ $max$ &amp; $min$ï¼Œ$O(Tnlogn)$ï¼Œ$70$ åˆ†ã€‚</li></ol><p>è€ƒè™‘ä¼˜åŒ–ï¼Œé‚£å¿…é¡» $O(n)$ äº†</p><p>è€ƒè™‘åŒç«¯é˜Ÿåˆ—</p><p>åˆ’ä¸€ä¸‹é¢˜ç›®ä¸­å®¹æ˜“é—æ¼çš„æ¡ä»¶ï¼šä¿è¯æ¯ç»„æ•°æ®ï¼ˆåŒ…æ‹¬æ‰€æœ‰ä¿®æ”¹å®Œæˆåçš„ï¼‰çš„ $a_i$ ä»¥ä¸é™é¡ºåºæ’åˆ—ã€‚</p><p>â€”â€”ä¸ç”¨ $sort$ äº†ï¼</p><p>$q1$ ç»´æŠ¤æ²¡åƒè¿‡å’Œæ²¡è¢«åƒè¿‡çš„ï¼Œ$q2$ ç»´æŠ¤åƒè¿‡çš„ã€‚æ˜¾ç„¶éƒ½æ˜¯æœ‰åºçš„ã€‚</p><p>å°±æ˜¯åœ¨æš´åŠ›çš„åŸºç¡€ä¸Šæ”¹ä¸€æ”¹</p><p>å¯¹äºæˆ‘è¿™ç§æ²¡æœ‰ğŸ§ çš„é€‰æ‰‹æ¥è¯´ï¼Œå…ˆå†™æš´åŠ›æ‰æœ‰å¯èƒ½ä¼˜åŒ–æˆæ­£è§£ã€‚ã€‚ã€‚è€Œä¸”æš´åŠ›ä¹Ÿæ›´ç¨³ï¼Œè€ƒåœºä¸Šè¦å°½åŠ›çš„æ‰“é«˜åˆ†å•Šï¼</p><p><a href="https://loj.ac/submission/989975" target="_blank" rel="noopener">$Code$(æš´åŠ›)</a></p><p><a href="https://loj.ac/submission/990038" target="_blank" rel="noopener">$Code$(æ­£è§£)</a></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="$æ€»ç»“$"></a>$æ€»ç»“$</h2><hr><p>ä¸è¦å“€æ±‚ï¼Œå­¦ä¼šäº‰å–ã€‚æ„Ÿè§‰æ€ç»´è¿˜æ˜¯å¤ªæ…¢äº†ï¼Œç»†èŠ‚åˆæ¨ä¸å¹²å‡€ï¼Œæ¥ä¸‹æ¥è¦è®­ç»ƒæ€ç»´çš„æ•æ·æ€§ï¼Œä¹Ÿè¦æ³¨é‡æ¨¡æ‹Ÿèµ›çš„è®­ç»ƒã€‚</p><p>è€ƒåœºæƒ…å†µå¤šï¼Œç¨³ä½ã€‚åƒµä½çš„çŠ¶æ€å¯ä»¥å»çª—å£æ·±å‘¼å¸ï¼Œå›æ¥ç»§ç»­æ‹¼æŠ¢ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NOIP2020å¤ä¹ è®¡åˆ’</title>
      <link href="2020/11/10/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%91NOIP2020%E5%A4%8D%E4%B9%A0%E8%AE%A1%E5%88%92/"/>
      <url>2020/11/10/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%91NOIP2020%E5%A4%8D%E4%B9%A0%E8%AE%A1%E5%88%92/</url>
      
        <content type="html"><![CDATA[<ul><li>ç›¸å…³é¢˜ç›®ç‰¹å¾</li><li>ç®—æ³•å†…å®¹</li><li>å¤æ‚åº¦</li><li>ä¹ é¢˜</li></ul><hr><h1 id="TRICK"><a href="#TRICK" class="headerlink" title="TRICK"></a><em>TRICK</em></h1><ul><li>ä¸­ä½æ•°ç›¸å…³å¯è€ƒè™‘äºŒåˆ†ï¼Œå°†å°äºäºŒåˆ†å€¼çš„æ ‡ä¸º -1ï¼Œå¤§äºäºŒåˆ†å€¼çš„æ ‡ä¸º 1</li><li>çœ‹è§ä¹˜ç§¯è€ƒè™‘å– logï¼Œè¿™æ ·å¼€æ–¹å°±å˜æˆé™¤æ³•ï¼Œä¹˜å°±å˜æˆåŠ æ³•äº†ï¼Œæœ‰å¾ˆå¤šä¼˜ç§€çš„æ€§è´¨</li><li><a href="https://www.cnblogs.com/gryzy/p/6015485.html" target="_blank" rel="noopener">å¿«é€Ÿé˜¶ä¹˜ç®—æ³•</a></li><li>ç½‘æ ¼å›¾å¥—è·¯ä¸€è§ˆï¼šC = V - E + F; åˆ†æ²»æœ€çŸ­è·¯ï¼›äºŒåˆ†å›¾æŸ“è‰²ï¼›ç¬›å¡å°”æ ‘ï¼ˆå¾…è¡¥ï¼‰</li></ul><hr><h1 id="è´ªå¿ƒ"><a href="#è´ªå¿ƒ" class="headerlink" title="è´ªå¿ƒ"></a><em>è´ªå¿ƒ</em></h1><ul><li>åŒºé—´å–ç‚¹</li></ul><h1 id="DP"><a href="#DP" class="headerlink" title="DP"></a><em>DP</em></h1><h2 id="01èƒŒåŒ…-amp-å®Œå…¨èƒŒåŒ…-amp-å¤šé‡èƒŒåŒ…"><a href="#01èƒŒåŒ…-amp-å®Œå…¨èƒŒåŒ…-amp-å¤šé‡èƒŒåŒ…" class="headerlink" title="01èƒŒåŒ… &amp; å®Œå…¨èƒŒåŒ… &amp; å¤šé‡èƒŒåŒ…"></a>01èƒŒåŒ… &amp; å®Œå…¨èƒŒåŒ… &amp; å¤šé‡èƒŒåŒ…</h2><h2 id="æ•°ä½dp"><a href="#æ•°ä½dp" class="headerlink" title="æ•°ä½dp"></a>æ•°ä½dp</h2><h2 id="åŒºé—´dp"><a href="#åŒºé—´dp" class="headerlink" title="åŒºé—´dp"></a>åŒºé—´dp</h2><h2 id="æ ‘å‹dp"><a href="#æ ‘å‹dp" class="headerlink" title="æ ‘å‹dp"></a>æ ‘å‹dp</h2><h2 id="æ¦‚ç‡dp"><a href="#æ¦‚ç‡dp" class="headerlink" title="æ¦‚ç‡dp"></a>æ¦‚ç‡dp</h2><h2 id="çŠ¶å‹dp"><a href="#çŠ¶å‹dp" class="headerlink" title="çŠ¶å‹dp"></a>çŠ¶å‹dp</h2><h2 id="æ’å¤´dp"><a href="#æ’å¤´dp" class="headerlink" title="æ’å¤´dp"></a>æ’å¤´dp</h2><h2 id="æ–œç‡ä¼˜åŒ–"><a href="#æ–œç‡ä¼˜åŒ–" class="headerlink" title="æ–œç‡ä¼˜åŒ–"></a>æ–œç‡ä¼˜åŒ–</h2><h2 id="å†³ç­–å•è°ƒæ€§-amp-å››è¾¹å½¢ä¸ç­‰å¼"><a href="#å†³ç­–å•è°ƒæ€§-amp-å››è¾¹å½¢ä¸ç­‰å¼" class="headerlink" title="å†³ç­–å•è°ƒæ€§ &amp; å››è¾¹å½¢ä¸ç­‰å¼"></a>å†³ç­–å•è°ƒæ€§ &amp; å››è¾¹å½¢ä¸ç­‰å¼</h2><h2 id="æ•°æ®ç»“æ„ä¼˜åŒ–"><a href="#æ•°æ®ç»“æ„ä¼˜åŒ–" class="headerlink" title="æ•°æ®ç»“æ„ä¼˜åŒ–"></a>æ•°æ®ç»“æ„ä¼˜åŒ–</h2><h2 id="çŸ©é˜µä¹˜æ³•ä¼˜åŒ–"><a href="#çŸ©é˜µä¹˜æ³•ä¼˜åŒ–" class="headerlink" title="çŸ©é˜µä¹˜æ³•ä¼˜åŒ–"></a>çŸ©é˜µä¹˜æ³•ä¼˜åŒ–</h2><ul><li>å˜å½¢ï¼š+ å’Œ max</li></ul><h2 id="wqs-äºŒåˆ†"><a href="#wqs-äºŒåˆ†" class="headerlink" title="wqs äºŒåˆ†"></a>wqs äºŒåˆ†</h2><hr><h1 id="å›¾è®º"><a href="#å›¾è®º" class="headerlink" title="å›¾è®º"></a><em>å›¾è®º</em></h1><h2 id="A-amp-IDA"><a href="#A-amp-IDA" class="headerlink" title="$A^{}$ &amp; $IDA^{}$"></a>$A^{<em>}$ &amp; $IDA^{</em>}$</h2><h2 id="æ ‘"><a href="#æ ‘" class="headerlink" title="æ ‘"></a>æ ‘</h2><ul><li>dfs &amp; æ¬§æ‹‰åº &amp; æ‹¬å·åºåˆ—ã€‚é…åˆæ•°æ®ç»“æ„é£Ÿç”¨ã€‚</li><li>æ ‘çš„é‡å¿ƒ &amp; ç›´å¾„</li><li>LCA</li><li>æ ‘é“¾å‰–åˆ† &amp; é•¿é“¾å‰–åˆ†</li></ul><h2 id="è™šæ ‘"><a href="#è™šæ ‘" class="headerlink" title="è™šæ ‘"></a>è™šæ ‘</h2><h2 id="Pruferåºåˆ—åŠCayleyå®šç†"><a href="#Pruferåºåˆ—åŠCayleyå®šç†" class="headerlink" title="Pruferåºåˆ—åŠCayleyå®šç†"></a>Pruferåºåˆ—åŠCayleyå®šç†</h2><ul><li>prufer åºåˆ—æ˜¯<strong>æ— æ ¹æ ‘</strong>çš„æ•°åˆ—ï¼Œä¸€æ£µ $n$ ä¸ªç‚¹çš„æ— æ ¹æ ‘ï¼Œprufer åºåˆ—é•¿åº¦ä¸º $n - 2$ã€‚</li><li>æ— æ ¹æ ‘è½¬æ•°åˆ—ï¼šæ‰¾åˆ°ç¼–å·æœ€å°çš„å¶å­ç»“ç‚¹ï¼Œåœ¨æ ‘ä¸Šåˆ é™¤å®ƒå¹¶å°†å®ƒä¸å®ƒç›¸è¿çš„ç‚¹åŠ å…¥ prufer åºåˆ—ã€‚é‡å¤æ“ä½œç›´åˆ°åªå‰© 2 ä¸ªç‚¹ã€‚</li><li>æ•°åˆ—è½¬æ— æ ¹æ ‘ï¼šæ¯æ¬¡å°† prufer åºåˆ—æœ€å‰é¢çš„å…ƒç´ å’Œ å½“å‰åœ¨æ ‘ä¸Šçš„ä¸”æ²¡åœ¨ prufer åºåˆ—é‡Œå‡ºç°çš„æœ€å°èŠ‚ç‚¹ è¿è¾¹ã€‚</li><li>Cayleyå®šç†ï¼š$n$ ä¸ªç‚¹çš„<strong>æ— å‘å®Œå…¨å›¾</strong>çš„ç”Ÿæˆæ ‘ä¸ªæ•°ï¼š$n^{n - 2}$</li><li>$n$ ä¸ªèŠ‚ç‚¹ï¼Œç¬¬ $i$ ä¸ªç‚¹åº¦ä¸º $d_i$ çš„ç”Ÿæˆæ ‘ä¸ªæ•°ï¼š$\frac{(n - 2)!}{\prod\limits_i (d_i - 1)!}$</li><li>$n$ ä¸ªèŠ‚ç‚¹ï¼Œ$k$ ä¸ªè¿é€šå—ï¼Œç¬¬ $i$ ä¸ªå—å¤§å°æ˜¯ $a_i$ï¼Œç¬¬ $i$ ä¸ªå—çš„åº¦æ•°ä¸º $d_i$ï¼Œåœ¨å—ä¹‹é—´è¿ $k - 1$ æ¡è¾¹ä½¿å¾—è¿é€šçš„æ–¹æ¡ˆæ•°ï¼š$n^{k - 2} \times \prod a_i$ <a href="https://oi-wiki.org/graph/prufer/#_3" target="_blank" rel="noopener">è¯æ˜</a></li><li><a href="https://www.luogu.com.cn/paste/jbsz4em1" target="_blank" rel="noopener">51nod1601</a> <a href="https://www.luogu.com.cn/paste/8pjpuesx" target="_blank" rel="noopener">CF917D</a></li></ul><h2 id="æœ€å°ç”Ÿæˆæ ‘"><a href="#æœ€å°ç”Ÿæˆæ ‘" class="headerlink" title="æœ€å°ç”Ÿæˆæ ‘"></a>æœ€å°ç”Ÿæˆæ ‘</h2><h2 id="kruskalé‡æ„æ ‘"><a href="#kruskalé‡æ„æ ‘" class="headerlink" title="kruskalé‡æ„æ ‘"></a>kruskalé‡æ„æ ‘</h2><ul><li><a href>[NOI2018]-å½’ç¨‹</a> <a href>[APIO2020]-äº¤æ¢åŸå¸‚</a></li></ul><h2 id="tarjanå¼ºè”é€šåˆ†é‡"><a href="#tarjanå¼ºè”é€šåˆ†é‡" class="headerlink" title="tarjanå¼ºè”é€šåˆ†é‡"></a>tarjanå¼ºè”é€šåˆ†é‡</h2><ul><li>æœ‰å‘å›¾é‡Œçš„ã€‚å®šä¹‰æ˜¯ä»»ä½•ä¸¤ä¸ªç‚¹éƒ½èƒ½äº’ç›¸åˆ°è¾¾ã€‚</li><li>å¼ºè¿é€šåˆ†é‡çš„åŸºå›¾æ˜¯è¾¹åŒè¿é€šåˆ†é‡ï¼Œå³å­˜åœ¨ä¸€ç§ç»™è¾¹åŒåˆ†é‡ä¸­çš„è¾¹å®šå‘çš„æ–¹æ¡ˆä½¿å¾—å…¶å¼ºè¿é€šã€‚æ˜“è¯ï¼XD</li></ul><h2 id="tarjanåŒè”é€šåˆ†é‡"><a href="#tarjanåŒè”é€šåˆ†é‡" class="headerlink" title="tarjanåŒè”é€šåˆ†é‡"></a>tarjanåŒè”é€šåˆ†é‡</h2><h2 id="å‰²ç‚¹å’Œæ¡¥"><a href="#å‰²ç‚¹å’Œæ¡¥" class="headerlink" title="å‰²ç‚¹å’Œæ¡¥"></a>å‰²ç‚¹å’Œæ¡¥</h2><h2 id="åœ†æ–¹æ ‘"><a href="#åœ†æ–¹æ ‘" class="headerlink" title="åœ†æ–¹æ ‘"></a>åœ†æ–¹æ ‘</h2><h2 id="åŸºç¯æ ‘"><a href="#åŸºç¯æ ‘" class="headerlink" title="åŸºç¯æ ‘"></a>åŸºç¯æ ‘</h2><ul><li><p>åˆ†åˆ«å¯¹æ ‘å’Œç¯å¤„ç†ã€‚</p></li><li><p>æ‰£ç¯ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getlop</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fr)</span> </span>&#123;  <span class="comment">// è¿™é‡Œæ˜¯æ‰£ä¸¤ä¸ªç‚¹çš„ç¯ï¼Œè®°å½•çš„ä¸æ˜¯ fa è€Œæ˜¯æ¥çš„é‚£æ¡è¾¹</span></span><br><span class="line">    <span class="keyword">if</span> (vis[x]) &#123; rt = x; <span class="keyword">return</span> <span class="number">1</span>; &#125;</span><br><span class="line">    vis[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((i &gt;&gt; <span class="number">1</span>) == fr) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">int</span> t = getlop(y, i &gt;&gt; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (t) &#123;</span><br><span class="line">            <span class="keyword">if</span> (t == <span class="number">1</span>) &#123;</span><br><span class="line">                lop[++num] = x, dis[num] = val[i], inl[x] = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (x != rt) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><a href="https://www.luogu.com.cn/problem/P4381" target="_blank" rel="noopener">IOI2008-Island</a>, å°æ¸…æ–°åŸºç¯æ ‘é¢˜ï¼Œæ±‚æ¯æ£µæ ‘çš„ç›´å¾„ä¹‹å’Œ</p></li><li><p><a href="https://www.luogu.com.cn/paste/uc2gqdkt" target="_blank" rel="noopener">ARC079D-Namori Grundy</a></p></li></ul><h2 id="ç‚¹åˆ†æ²»"><a href="#ç‚¹åˆ†æ²»" class="headerlink" title="ç‚¹åˆ†æ²»"></a>ç‚¹åˆ†æ²»</h2><h2 id="2-sat"><a href="#2-sat" class="headerlink" title="2-sat"></a>2-sat</h2><ul><li>æœ‰è¯¸å¤šé™åˆ¶ï¼Œéæ­¤å³å½¼çš„é€»è¾‘å…³ç³»ï¼Œä¸”æ˜¯äºŒå…ƒå…³ç³»ã€‚</li><li>æ‹†ç‚¹åšã€‚<strong>è€ƒè™‘è¦å…¨é¢</strong>ã€‚æ‹“æ‰‘åºæ˜¯åçš„ï¼Œæ‰€ä»¥è¾“å‡ºç­”æ¡ˆå°±æ˜¯é€‰ä¸¤è€…ä¸­å¼ºè¿é€šåˆ†é‡ç¼–å·è¾ƒå°çš„ï¼Œå› ä¸ºåœ¨æ‹“æ‰‘åºä¸Šå®ƒæ¯”è¾ƒé åã€‚å¤æ‚åº¦å’Œ tarjan ç›¸åŒï¼Œæœ‰ $n$ ä¸ªç‚¹ $m$ æ¡é™åˆ¶ï¼ˆå³è¾¹ï¼‰å°±æ˜¯ $O(n + m)$</li><li><a href="https://www.luogu.com.cn/paste/142viofa" target="_blank" rel="noopener">UOJ210</a></li></ul><h2 id="æœ€çŸ­è·¯"><a href="#æœ€çŸ­è·¯" class="headerlink" title="æœ€çŸ­è·¯"></a>æœ€çŸ­è·¯</h2><ul><li>spfa &amp; bellman-ford:</li><li>Dijkstra:</li><li>Floyd:</li><li>å·®åˆ†çº¦æŸ:</li><li>kçŸ­è·¯:</li></ul><h2 id="ç½‘ç»œæµ"><a href="#ç½‘ç»œæµ" class="headerlink" title="ç½‘ç»œæµ"></a>ç½‘ç»œæµ</h2><ul><li>æœ€å¤§æµ = æœ€å°å‰²</li><li>è´¹ç”¨æµ</li><li>æœ‰ä¸Šä¸‹ç•Œçš„ç½‘ç»œæµ</li><li>äºŒåˆ†å›¾ï¼ˆæœ€å¤§åŒ¹é…ï¼Œæœ€å¤§ç‹¬ç«‹é›†ï¼Œæœ€å¤§ç‚¹å…¨è¦†ç›–é›†ï¼Œæœ€å°è·¯å¾„è¦†ç›–çš„ä¸€äº›æ€§è´¨ï¼‰ï¼ˆåŒˆç‰™åˆ©ç®—æ³•ï¼‰ </li></ul><h2 id="æ¬§æ‹‰å›¾"><a href="#æ¬§æ‹‰å›¾" class="headerlink" title="æ¬§æ‹‰å›¾"></a>æ¬§æ‹‰å›¾</h2><ul><li>å¥—åœˆæ³•</li></ul><h2 id="æ‹“æ‰‘æ’åº"><a href="#æ‹“æ‰‘æ’åº" class="headerlink" title="æ‹“æ‰‘æ’åº"></a>æ‹“æ‰‘æ’åº</h2><hr><h1 id="æ•°è®º"><a href="#æ•°è®º" class="headerlink" title="æ•°è®º"></a><em>æ•°è®º</em></h1><h2 id="åŸƒæ°ç­›-amp-çº¿æ€§ç­›"><a href="#åŸƒæ°ç­›-amp-çº¿æ€§ç­›" class="headerlink" title="åŸƒæ°ç­› &amp; çº¿æ€§ç­›"></a>åŸƒæ°ç­› &amp; çº¿æ€§ç­›</h2><h2 id="é«˜æ–¯æ¶ˆå…ƒ"><a href="#é«˜æ–¯æ¶ˆå…ƒ" class="headerlink" title="é«˜æ–¯æ¶ˆå…ƒ"></a>é«˜æ–¯æ¶ˆå…ƒ</h2><h2 id="è¡Œåˆ—å¼"><a href="#è¡Œåˆ—å¼" class="headerlink" title="è¡Œåˆ—å¼"></a>è¡Œåˆ—å¼</h2><h2 id="åŸæ ¹"><a href="#åŸæ ¹" class="headerlink" title="åŸæ ¹"></a>åŸæ ¹</h2><h2 id="gcd-amp-exgcd"><a href="#gcd-amp-exgcd" class="headerlink" title="gcd &amp; exgcd"></a>gcd &amp; exgcd</h2><h2 id="CRT-amp-exCRT"><a href="#CRT-amp-exCRT" class="headerlink" title="CRT &amp; exCRT"></a>CRT &amp; exCRT</h2><h2 id="ç½®æ¢"><a href="#ç½®æ¢" class="headerlink" title="ç½®æ¢"></a>ç½®æ¢</h2><h2 id="æ¬§æ‹‰å‡½æ•°"><a href="#æ¬§æ‹‰å‡½æ•°" class="headerlink" title="æ¬§æ‹‰å‡½æ•°"></a>æ¬§æ‹‰å‡½æ•°</h2><h2 id="æ¦‚ç‡ä¸æœŸæœ›"><a href="#æ¦‚ç‡ä¸æœŸæœ›" class="headerlink" title="æ¦‚ç‡ä¸æœŸæœ›"></a>æ¦‚ç‡ä¸æœŸæœ›</h2><h2 id="æ›´ç›¸å‡æŸæœ¯"><a href="#æ›´ç›¸å‡æŸæœ¯" class="headerlink" title="æ›´ç›¸å‡æŸæœ¯"></a>æ›´ç›¸å‡æŸæœ¯</h2><h2 id="è«æ¯”ä¹Œæ–¯åæ¼”"><a href="#è«æ¯”ä¹Œæ–¯åæ¼”" class="headerlink" title="è«æ¯”ä¹Œæ–¯åæ¼”"></a>è«æ¯”ä¹Œæ–¯åæ¼”</h2><h2 id="çŸ©é˜µæ ‘å®šç†"><a href="#çŸ©é˜µæ ‘å®šç†" class="headerlink" title="çŸ©é˜µæ ‘å®šç†"></a>çŸ©é˜µæ ‘å®šç†</h2><h2 id="çº¿æ€§åŸº"><a href="#çº¿æ€§åŸº" class="headerlink" title="çº¿æ€§åŸº"></a>çº¿æ€§åŸº</h2><h2 id="äºŒé¡¹å¼åæ¼”"><a href="#äºŒé¡¹å¼åæ¼”" class="headerlink" title="äºŒé¡¹å¼åæ¼”"></a>äºŒé¡¹å¼åæ¼”</h2><h2 id="ç¾¤è®º-amp-Burnside-amp-Polya"><a href="#ç¾¤è®º-amp-Burnside-amp-Polya" class="headerlink" title="ç¾¤è®º &amp; Burnside &amp; Polya"></a>ç¾¤è®º &amp; Burnside &amp; Polya</h2><h2 id="æ–¯ç‰¹æ—æ•°"><a href="#æ–¯ç‰¹æ—æ•°" class="headerlink" title="æ–¯ç‰¹æ—æ•°"></a>æ–¯ç‰¹æ—æ•°</h2><h2 id="lucaså®šç†"><a href="#lucaså®šç†" class="headerlink" title="lucaså®šç†"></a>lucaså®šç†</h2><h2 id="åˆ†æ‹†æ•°"><a href="#åˆ†æ‹†æ•°" class="headerlink" title="åˆ†æ‹†æ•°"></a>åˆ†æ‹†æ•°</h2><hr><h1 id="åšå¼ˆè®º"><a href="#åšå¼ˆè®º" class="headerlink" title="åšå¼ˆè®º"></a><em>åšå¼ˆè®º</em></h1><p>è™½ç„¶è¿™ä¸ªä¸œè¥¿åœ¨ noip é‡Œå‡ ä¹ä¸è€ƒï¼Œä½†ä¹Ÿæ˜¯å¾ˆå¸¸è§ï¼ˆè€Œä¸”æˆ‘å‡ ä¹ä¸€æ— æ‰€çŸ¥ï¼‰çš„çŸ¥è¯†ç‚¹ã€‚æ¥ç³»ç»Ÿåœ°æ•´ç†ä¸€ä¸‹å§ã€‚</p><p>å¿…èƒœæ€è½¬ç§»ä¼šåˆ°è‡³å°‘ä¸€ä¸ªå¿…è´¥æ€ï¼Œå¿…è´¥æ€ä¸€å®šä¼šåˆ°å¿…èƒœæ€ã€‚ç»ˆæ­¢çŠ¶æ€ä¸€å®šæ˜¯å¿…è´¥æ€ï¼Œå› æ­¤å¯ä»¥è€ƒè™‘åˆ†æç»ˆæ­¢çŠ¶æ€çš„æ€§è´¨ã€‚</p><h2 id="bashåšå¼ˆ"><a href="#bashåšå¼ˆ" class="headerlink" title="bashåšå¼ˆ"></a>bashåšå¼ˆ</h2><ul><li>ä¸€å †çŸ³å­æœ‰ n ä¸ªï¼Œæ¯æ¬¡æœ€å°‘å– 1 ä¸ªï¼Œæœ€å¤šå– m ä¸ªã€‚(m + 1) | n æ—¶å…ˆæ‰‹å¿…è´¥ï¼Œå¦åˆ™å…ˆæ‰‹å¿…èƒœã€‚</li></ul><h2 id="nimåšå¼ˆ"><a href="#nimåšå¼ˆ" class="headerlink" title="nimåšå¼ˆ"></a>nimåšå¼ˆ</h2><ul><li>n å †çŸ³å­ï¼Œæ¯å †æœ‰ a_i ä¸ªï¼Œæ¯æ¬¡é€‰æ‹©ä¸€å †é€‰è‹¥å¹²ä¸ªã€‚XOR(a_i) = 0 åˆ™å…ˆæ‰‹å¿…è´¥ï¼Œå¦åˆ™å…ˆæ‰‹å¿…èƒœã€‚</li><li>è¯æ˜ï¼šè®¾ k = XOR(a_i), a_i ä¸ºåŒ…å« k æœ€é«˜ä½çš„ä¸€å †ä¸ªæ•°ï¼Œè€ƒè™‘å– $a_i - (a_i\ xor\  k)$ ä¸ªä½¿å¾— a_i å˜ä¸º a_i\ xor\ kï¼Œè¿™æ ·æ€»çš„å¼‚æˆ–å’Œåˆå˜ä¸º 0ã€‚è¿™è·Ÿ bash åšå¼ˆæœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™çš„å°±æ˜¯ç»´æŒä¸€ä¸ªç¨³å®šæ€ï¼ˆåæ‰‹å¿…è´¥æ€ï¼‰ã€‚</li></ul><h2 id="Wythoffåšå¼ˆ"><a href="#Wythoffåšå¼ˆ" class="headerlink" title="Wythoffåšå¼ˆ"></a>Wythoffåšå¼ˆ</h2><ul><li>ä¸¤å †çŸ³å­ï¼Œä¸¤äººè½®æµä»ä»»æ„ä¸€å †ä¸­å–è‡³å°‘ä¸€ä¸ªæˆ–åŒæ—¶ä»ä¸¤å †ä¸­å–åŒæ ·å¤šçš„ç‰©å“ï¼Œå–ä¸åˆ°è€…è´¥ã€‚</li><li>å’•å’•</li></ul><h2 id="å˜å½¢"><a href="#å˜å½¢" class="headerlink" title="å˜å½¢"></a>å˜å½¢</h2><ol><li>bash + nimã€‚å°±æ˜¯åœ¨æ¨¡æ„ä¹‰ä¸‹çš„ nim æ¸¸æˆå•¦ï¼Œæ¯å † % ä¸Š (m + 1) å†åš nimã€‚</li><li>nim-kï¼Œæ¯æ¬¡å¯ä»¥ä»æœ€å¤š k å †çŸ³å­é‡Œæ‹¿ä»»æ„ä¸ªã€‚ç»“è®ºæ˜¯æŠŠæ¯ä¸ªä½ç½®ä¸Šçš„çŸ³å­æ•°è¡¨ç¤ºæˆäºŒè¿›åˆ¶ï¼Œè‹¥æ¯ä¸€ä½ä¸Š 1 çš„ä¸ªæ•° % (k + 1) éƒ½ç­‰äº 0 é‚£ä¹ˆå…ˆæ‰‹å¿…è´¥ï¼Œå¦åˆ™å¿…èƒœã€‚ç»“è®ºéš¾æƒ³ä½†è¯æ˜è¿˜æ˜¯å¥½èƒ¡çš„ã€‚</li><li>é˜¶æ¢¯åšå¼ˆï¼Œæ¯æ¬¡å¯ä»¥å°†ä¸€ä¸ªçŸ³å­ç§»åˆ°å®ƒæ‰€åœ¨é˜¶æ¢¯çš„ä¸‹ä¸€é˜¶æ¢¯ï¼Œä½äº 0 çš„çŸ³å­ä¸èƒ½åŠ¨ï¼ˆçŸ³å­å¯ä»¥å èµ·æ¥ï¼‰ã€‚ç»“è®ºæ˜¯ç›´æ¥åšå¥‡æ•°çº§é˜¶æ¢¯çš„ nimã€‚è¯æ˜ï¼šå¯¹æ‰‹ç§»åŠ¨å¥‡æ•°ä½ç½®ï¼Œå°±æŒ‰ç…§ nim çš„ç§»æ³•å»ç§»ï¼›å¯¹æ‰‹ç§»åŠ¨å¶æ•°ä½ç½®ï¼Œå°±é¡ºåŠ¿æŠŠè¿™ä¸ªçŸ³å­ç§»åˆ°ä¸‹ä¸€ä¸ªå¶æ•°ä½ç½®ã€‚è¿™æ ·å°±å¯ä»¥è§†â€œå¥‡æ•°ä½ç½®çš„çŸ³å­è¢«ç§»åŠ¨â€ä¸ºâ€œé‚£é¢—çŸ³å­æ²¡äº†â€ï¼Œå°±æ˜¯æ™®é€š nim äº†ã€‚å½“ç„¶é¢˜ç›®ä¸ä¼šè¿™ä¹ˆè£¸ï¼Œè¦åšè½¬åŒ–ï¼Œæ¯”å¦‚ <a href="https://loj.ac/submission/929939" target="_blank" rel="noopener">[SDOI2019]-ç§»åŠ¨é‡‘å¸</a></li></ol><h2 id="SG"><a href="#SG" class="headerlink" title="SG"></a>SG</h2><ul><li>ä¸‡èƒ½çš„å­˜åœ¨= =ã€‚å¯¹äºä¸€ä¸ªæ¸¸æˆï¼Œ$SG(x) = mex_{y = x.nxt}{SG(y)}$ï¼›æ‰€æœ‰æ¸¸æˆçš„ SG å¼‚æˆ–ä¸º 0 æ—¶å…ˆæ‰‹å¿…è´¥ï¼Œå¦åˆ™å¿…èƒœã€‚</li></ul><h2 id="min-maxåšå¼ˆï¼ˆæœç´¢ï¼‰-amp-alpha-betaå‰ªæ"><a href="#min-maxåšå¼ˆï¼ˆæœç´¢ï¼‰-amp-alpha-betaå‰ªæ" class="headerlink" title="min-maxåšå¼ˆï¼ˆæœç´¢ï¼‰ &amp; alpha-betaå‰ªæ"></a>min-maxåšå¼ˆï¼ˆæœç´¢ï¼‰ &amp; alpha-betaå‰ªæ</h2><hr><h1 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a><em>æ•°æ®ç»“æ„</em></h1><h2 id="æ ˆ-amp-å•è°ƒæ ˆ-amp-é˜Ÿåˆ—-amp-å•è°ƒé˜Ÿåˆ—"><a href="#æ ˆ-amp-å•è°ƒæ ˆ-amp-é˜Ÿåˆ—-amp-å•è°ƒé˜Ÿåˆ—" class="headerlink" title="æ ˆ &amp; å•è°ƒæ ˆ &amp; é˜Ÿåˆ— &amp; å•è°ƒé˜Ÿåˆ—"></a>æ ˆ &amp; å•è°ƒæ ˆ &amp; é˜Ÿåˆ— &amp; å•è°ƒé˜Ÿåˆ—</h2><ul><li>å’ŒåŒºé—´é—®é¢˜é…åˆé£Ÿç”¨ï¼Œå¯ä»¥æ±‚å‡ºä¸€äº›èŒƒå›´</li></ul><h2 id="å“ˆå¸Œè¡¨"><a href="#å“ˆå¸Œè¡¨" class="headerlink" title="å“ˆå¸Œè¡¨"></a>å“ˆå¸Œè¡¨</h2><h2 id="å¹¶æŸ¥é›†"><a href="#å¹¶æŸ¥é›†" class="headerlink" title="å¹¶æŸ¥é›†"></a>å¹¶æŸ¥é›†</h2><ul><li>è·¯å¾„å‹ç¼©</li><li>å¸¦æƒå¹¶æŸ¥é›†</li><li>æ‹†ç‚¹</li></ul><h2 id="åˆ†å—"><a href="#åˆ†å—" class="headerlink" title="åˆ†å—"></a>åˆ†å—</h2><h2 id="è«é˜Ÿ"><a href="#è«é˜Ÿ" class="headerlink" title="è«é˜Ÿ"></a>è«é˜Ÿ</h2><ul><li>æ ¹å·æ•°æ®ç»“æ„å˜›ã€‚ã€‚1e5 å†…éƒ½å¯åšã€‚å¦å¤–ç›¸é‚»çŠ¶æ€èƒ½ $O(1)$ è½¬ç§»ã€‚$O(log)$ è¦çœ‹è¿‡ä¸è¿‡å¾—å»äº†ã€‚ã€‚ï¼Ÿ</li><li>ä¸å¸¦ä¿®è«é˜Ÿï¼šè®°å½• $(l, r)$ï¼ŒæŒ‰$l$ ç¬¬ä¸€å…³é”®å­—ï¼Œ$r$ ç¬¬äºŒå…³é”®å­—æ’åºã€‚æ¢å— $O(n)$ï¼ŒåŒä¸€ä¸ªå—ä¸­ $O(\sqrt{n})$ï¼Œæ‰€ä»¥æ€»å…± $O(n\sqrt{n})$</li><li>å¸¦ä¿®è«é˜Ÿï¼šè®°å½• $(l, r, t)$ï¼Œ$t$ è¡¨ç¤ºç¬¬å‡ æ¬¡ä¿®æ”¹ï¼ŒæŒ‰$l$ ç¬¬ä¸€å…³é”®å­—ï¼Œ$r$ ç¬¬äºŒå…³é”®å­—ï¼Œ$t$ ç¬¬ä¸‰å…³é”®å­—æ’åºï¼Œæ¯æ¬¡è‹¥å½“å‰ä¿®æ”¹æ•°æ¯” $t$ å°‘å°±å°†æ²¡ä¿®æ”¹çš„ä¿®æ”¹ï¼Œå¦åˆ™å›é€€ã€‚æ³¨æ„å¦‚æœä¿®æ”¹ $(l, r)$ é‡Œçš„ä¿¡æ¯è¦æ›´æ–°ç­”æ¡ˆã€‚å¤æ‚åº¦ä¸ä¼šåˆ†æï¼Œè§†ä½œ $n = m$ çš„è¯ï¼Œå—å¤§å°å– $n^{\frac{2}{3}}$ æ—¶æœ‰æœ€å°å€¼ $n^{\frac{5}{3}}$ï¼Œæ‰€ä»¥å¤§çº¦æ˜¯ $O(n^{\frac{5}{3}} + n\ log\ n)$</li><li>æ ‘ä¸Šè«é˜Ÿï¼šè¿˜æ˜¯åºåˆ—é—®é¢˜ï¼Œå°†æ ‘è½¬åŒ–æˆæ¬§æ‹‰åºã€‚æ³¨æ„ç‰¹åˆ¤ LCAã€‚å¤æ‚åº¦åˆ†æè§†ä½œåºåˆ—é—®é¢˜ï¼Œå¸¦ä¿®å’Œä¸å¸¦ä¿®å¤æ‚åº¦åŒä¸Šâ¬†</li><li><a href="http://uoj.ac/submission/430504" target="_blank" rel="noopener">[UOJ58]-ç³–æœå…¬å›­</a>ï¼Œä¸€é“æœ´å®æ— åçš„å¸¦ä¿®æ ‘ä¸Šè«é˜Ÿï¼ˆè¿™é‡Œé‡‡ç”¨çš„æ˜¯ç›´æ¥è·³ LCA + ç›´æ¥åˆ†å—ï¼Œä¹Ÿå¯ä»¥æ¬§æ‹‰åºï¼‰</li></ul><h2 id="bitset"><a href="#bitset" class="headerlink" title="bitset"></a>bitset</h2><h2 id="æ ‘çŠ¶æ•°ç»„"><a href="#æ ‘çŠ¶æ•°ç»„" class="headerlink" title="æ ‘çŠ¶æ•°ç»„"></a>æ ‘çŠ¶æ•°ç»„</h2><h2 id="çº¿æ®µæ ‘"><a href="#çº¿æ®µæ ‘" class="headerlink" title="çº¿æ®µæ ‘"></a>çº¿æ®µæ ‘</h2><ul><li><p>lazy-tag</p><h2 id="çº¿æ®µæ ‘åˆå¹¶"><a href="#çº¿æ®µæ ‘åˆå¹¶" class="headerlink" title="çº¿æ®µæ ‘åˆå¹¶"></a>çº¿æ®µæ ‘åˆå¹¶</h2></li><li><p>ç»å¸¸ç»“åˆæ ‘ä¸Šé—®é¢˜é£Ÿç”¨ï¼Œé™åˆ¶å°±æ˜¯æ’å…¥çš„ä¿¡æ¯ä¸€å®šå¾—æ˜¯ O(n) çº§åˆ«çš„å¤æ‚åº¦æ‰ä¸ä¼šé”™ã€‚ã€‚æ¥è¯æ˜ä¸€ä¸‹å®ƒ O(nlogn) çš„å¤æ‚åº¦å§ï¼šå‘ç°åˆå¹¶ä¸¤æ£µçº¿æ®µæ ‘çš„å¤æ‚åº¦æ˜¯å®ƒä»¬é‡åˆçš„ç‚¹æ•°ï¼Œåˆå¹¶ä¸¤ä¸ªç‚¹çš„å¤æ‚åº¦æ˜¯ O(logn)ï¼Œå…±åˆå¹¶ n - 1 æ¬¡æ‰€ä»¥æ˜¯ O(nlogn)ã€‚</p></li><li><p>é™¤äº†æƒå€¼å•Šä¸‹æ ‡çº¿æ®µæ ‘åˆå¹¶çš„ï¼Œè¿˜èƒ½åš 01 trie åˆå¹¶å“¦ã€‚</p></li><li><p><a href="https://loj.ac/submission/932042" target="_blank" rel="noopener">LOJ3303(01 trie åˆå¹¶)</a></p></li><li><p>åŠ¨æ€å¼€ç‚¹</p></li><li><p>zkwï¼Ÿ</p></li><li><p>ä¸»å¸­æ ‘</p></li></ul><h2 id="splay"><a href="#splay" class="headerlink" title="splay"></a>splay</h2><h2 id="æ ‘å¥—æ ‘"><a href="#æ ‘å¥—æ ‘" class="headerlink" title="æ ‘å¥—æ ‘"></a>æ ‘å¥—æ ‘</h2><hr><h1 id="è®¡ç®—å‡ ä½•"><a href="#è®¡ç®—å‡ ä½•" class="headerlink" title="è®¡ç®—å‡ ä½•"></a><em>è®¡ç®—å‡ ä½•</em></h1><p>è§‰å¾—ä¸ä¼šè€ƒæ‰€ä»¥åªå¤ä¹ å‡¸åŒ…ï¼ˆ</p><h2 id="å‡¸åŒ…"><a href="#å‡¸åŒ…" class="headerlink" title="å‡¸åŒ…"></a>å‡¸åŒ…</h2><hr><h1 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a><em>å­—ç¬¦ä¸²</em></h1><p>è¿™å—çœŸæ˜¯ä¸€çªä¸é€š :(</p><h2 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h2><h2 id="æœ€å°è¡¨ç¤ºæ³•"><a href="#æœ€å°è¡¨ç¤ºæ³•" class="headerlink" title="æœ€å°è¡¨ç¤ºæ³•"></a>æœ€å°è¡¨ç¤ºæ³•</h2><h2 id="Trie-æ ‘"><a href="#Trie-æ ‘" class="headerlink" title="Trie æ ‘"></a>Trie æ ‘</h2><ul><li>01 Trie æ˜¯ xor é—®é¢˜çš„æ€æ‰‹ä¹‹ä¸€ã€‚å¯æŒä¹…åŒ–åå¯ä»¥æŸ¥è¯¢æŸä¸ªåŒºé—´çš„å¼‚æˆ–å€¼ã€‚</li><li><a href="https://loj.ac/submission/935085" target="_blank" rel="noopener">åäºŒçœè”è€ƒ2019-å¼‚æˆ–ç²½å­</a></li></ul><h2 id="ACè‡ªåŠ¨æœº"><a href="#ACè‡ªåŠ¨æœº" class="headerlink" title="ACè‡ªåŠ¨æœº"></a>ACè‡ªåŠ¨æœº</h2><h2 id="SA"><a href="#SA" class="headerlink" title="SA"></a>SA</h2><ul><li>å¤§å¤šæ˜¯ç”¨ $height$ æ•°ç»„æäº‹æƒ…ã€‚ï¼ˆ$height[i]$ è¡¨ç¤ºæ’å $i$ çš„åç¼€å’Œæ’å $i - 1$ çš„åç¼€çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚ï¼‰</li><li>å€å¢ + æ¡¶æ’ä¸å¤šè¯´ï¼Œå¤æ‚åº¦ $O(n\ log\ n)$ã€‚é‡ç‚¹æ˜¯ $height$ æ•°ç»„ï¼Œæœ‰ç»“è®ºï¼š$height[rk[i]] &gt;= height[rk[i - 1]] - 1$ï¼Œè¿‘ä¼¼å•è°ƒï¼Œå› æ­¤å¯ä»¥ $O(n)$ æ±‚ã€‚</li><li><a href="https://loj.ac/submission/929295" target="_blank" rel="noopener">[NOI2016]-ä¼˜ç§€çš„æ‹†åˆ†</a></li></ul><h2 id="SAM"><a href="#SAM" class="headerlink" title="SAM"></a>SAM</h2><h2 id="manacher"><a href="#manacher" class="headerlink" title="manacher"></a>manacher</h2><hr><h1 id="å…¶ä»–"><a href="#å…¶ä»–" class="headerlink" title="å…¶ä»–"></a>å…¶ä»–</h1><h2 id="åˆ†æ²»-amp-äºŒåˆ†-amp-ä¸‰åˆ†"><a href="#åˆ†æ²»-amp-äºŒåˆ†-amp-ä¸‰åˆ†" class="headerlink" title="åˆ†æ²» &amp; äºŒåˆ† &amp; ä¸‰åˆ†"></a>åˆ†æ²» &amp; äºŒåˆ† &amp; ä¸‰åˆ†</h2><ul><li>äºŒåˆ†ï¼šæœ‰å•è°ƒæ€§çš„å¯ä»¥äºŒåˆ†ã€‚<a href="https://www.luogu.com.cn/paste/oakm4jh5" target="_blank" rel="noopener">ä¸å­˜åœ¨çš„ BZOJ3580-å†’æ³¡æ’åº</a></li><li>01 åˆ†æ•°è§„åˆ’ï¼šäºŒåˆ†æ¯”å€¼ï¼Œæ³¨æ„ä¸ç­‰å·æ–¹å‘ä»¥åŠå–ä¸å–çš„åˆ° â€˜=â€™ã€‚<a href="https://loj.ac/submission/931538" target="_blank" rel="noopener">[BJOI2019]-å¥¥æœ¯ç¥æ–</a></li><li>å¹³é¢åˆ†æ²»ï¼ˆå¹³é¢æœ€è¿‘ç‚¹å¯¹ï¼‰</li><li>cdq åˆ†æ²»</li><li>æ•´ä½“äºŒåˆ†</li></ul><h2 id="å¯å‘å¼åˆå¹¶"><a href="#å¯å‘å¼åˆå¹¶" class="headerlink" title="å¯å‘å¼åˆå¹¶"></a>å¯å‘å¼åˆå¹¶</h2><h2 id="å“ˆå¤«æ›¼ç¼–ç "><a href="#å“ˆå¤«æ›¼ç¼–ç " class="headerlink" title="å“ˆå¤«æ›¼ç¼–ç "></a>å“ˆå¤«æ›¼ç¼–ç </h2><h2 id="çº¿æ€§è§„åˆ’"><a href="#çº¿æ€§è§„åˆ’" class="headerlink" title="çº¿æ€§è§„åˆ’"></a>çº¿æ€§è§„åˆ’</h2><h2 id="æœ±åˆ˜ç®—æ³•"><a href="#æœ±åˆ˜ç®—æ³•" class="headerlink" title="æœ±åˆ˜ç®—æ³•"></a>æœ±åˆ˜ç®—æ³•</h2><h2 id="çˆ¬å±±"><a href="#çˆ¬å±±" class="headerlink" title="çˆ¬å±±"></a>çˆ¬å±±</h2><h2 id="DLX"><a href="#DLX" class="headerlink" title="DLX"></a>DLX</h2>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Comet OJ Contest 75</title>
      <link href="2020/09/25/Comet%20OJ%20Contest%2075/"/>
      <url>2020/09/25/Comet%20OJ%20Contest%2075/</url>
      
        <content type="html"><![CDATA[<p><a href="https://cometoj.com/contest/75/problems" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>sooke è¿™å¥—çœŸæ˜¯é«˜è´¨é‡å¥½é¢˜ /dz</p><h2 id="A-ç»å¢ƒ"><a href="#A-ç»å¢ƒ" class="headerlink" title="$A. ç»å¢ƒ$"></a>$A. ç»å¢ƒ$</h2><hr><p>è€ƒè™‘å®¹æ–¥ï¼Œç­”æ¡ˆå°±æ˜¯æ¯ç§ $n - 1$ ä¸ªæ“ä½œçš„äº¤é›†å‡å» $n$ ä¸ªæ“ä½œçš„äº¤é›†ã€‚æ±‚çŸ©å½¢äº¤çš„å‰åç¼€å’Œï¼</p><p><a href="https://cometoj.com/status/ykj87mpwfh7me0lbi15ciah6vj67ryd4" target="_blank" rel="noopener">$Code$</a></p><h2 id="B-å‘½è¿"><a href="#B-å‘½è¿" class="headerlink" title="$B. å‘½è¿$"></a>$B. å‘½è¿$</h2><hr><p>æ³¨æ„ï¼Œè¾¹ä¸ç›¸äº¤è¿™æ˜¯ä¸ªå¾ˆæœ‰ç”¨è€Œä¸”å¾ˆå¼ºçš„æ¡ä»¶ï¼è¿™æ ·é™å®šäº† $i$ ä½ç½®å–çš„ $in_i$ ä¸ªç‚¹åªèƒ½æ˜¯ä¸Šæ–¹çš„åº•éƒ¨å’Œä¸‹æ–¹çš„é¡¶ç«¯ä¸€äº›ç‚¹ã€‚</p><p>ç‰¹æ®Šæ€§è´¨ä¸€æ˜¯å¾ˆæœ‰å¯å‘æ„ä¹‰çš„ä¸€æ¡£ã€‚å‘ç°æ¯ä¸ªç‚¹å¼•å‡ºçš„è¾¹æ–¹å‘ç¡®å®šäº†ï¼ä¸ºä»€ä¹ˆï¼Ÿè‹¥ $p_{i - 1} + 1 = p_i$ åˆ™å‘å³ï¼Œè‹¥ $p_{i - 1} - 1 = p_i$ åˆ™å‘å·¦ã€‚ç„¶åå¯ä»¥æ„‰å¿«çš„dpï¼Œ$f[i, j]$ è¡¨ç¤ºåˆ°ç¬¬ $i$ ç‚¹å¤„ç†å®Œåï¼Œä¸Šæ–¹æœ‰ $j$ æ¡è¾¹ï¼ˆä¸‹æ–¹æœ‰ $p_i - j$ æ¡è¾¹ï¼‰</p><p>æ¨å¹¿ä¸€ä¸‹å‘ç°ï¼Œæ¯ä¸ªç‚¹çš„å…¥åº¦å’Œå‡ºåº¦éƒ½å®šäº†ï¼ä¸ºå•¥å•Š</p><ul><li>$in_i + out_i = d_i$</li><li>$p_{i - 1} - in_i + out_i = p_i$</li></ul><p>ç„¶åç»§ç»­ç”¨åˆšæ‰æ€è·¯åšï¼Œæšä¸¾ä¸Šæ–¹å‡ æ¡å…¥è¾¹å’Œå‡ºè¾¹ï¼š$f[i, j] = \sum_x \sum_y f[i - 1, j - x + y]$</p><p>è½¬ç§»æ˜¯ $n^2$ çš„ã€‚ã€‚ã€‚ä¼˜åŒ–ï¼š$g[i, j] = \sum\limits_{x = 0}^{in_i} f[i - 1, j + x]$    $f[i, j] = \sum\limits_{y = 0}^{out_i} g[i, j - y]$ å‘ç°éƒ½æ˜¯å‰ç¼€å’Œå½¢å¼ï¼Œå‰ç¼€å’Œä¼˜åŒ–ã€‚</p><p><a href="https://cometoj.com/status/fxs5bt46b7u243sfjl627cmk3nze4yxb" target="_blank" rel="noopener">$Code$</a></p><h2 id="C-ç»ˆç„‰"><a href="#C-ç»ˆç„‰" class="headerlink" title="$C. ç»ˆç„‰$"></a>$C. ç»ˆç„‰$</h2><hr><p>ç­”æ¡ˆæ˜¾ç„¶æ˜¯æ–­è¾¹æ•° + 1ã€‚</p><p>æŠ€å·§/ç»å…¸å¥—è·¯1ï¼šä¿®æ”¹æ˜¯æ”¹å˜ä¸€ä¸ªç‚¹å’Œå®ƒå‘¨å›´ä¸€åœˆç‚¹æ—¶ï¼Œè€ƒè™‘å®ƒçš„<strong>æ ‘ä¸Šç»“æ„</strong>ï¼Œåªè¦ä¿®æ”¹çˆ¶äº²èŠ‚ç‚¹å¤„å°±å¥½äº†ï¼</p><p>é›†åˆå¹‚çº§æ•°ï¼ŸFWTã€FMTï¼Ÿï¼Ÿå¥½åƒéƒ½åªèƒ½åšéƒ¨åˆ†åˆ†</p><p>$f[x, s]$ è¡¨ç¤ºèŠ‚ç‚¹ $x$ å„¿å­ä¸­çŠ¶æ€ä¸º $s$ çš„æ•°é‡ï¼Œå‘ç°è¿™æ ·ä¿®æ”¹å’ŒæŸ¥è¯¢ä¸€ä¸ªæ˜¯ $O(2^m)$ï¼Œä¸€ä¸ªæ˜¯ $O(1)$ï¼Œè¿™å¤ªä¸å‡åŒ€äº†ï¼</p><p>ç»å…¸å¥—è·¯2ï¼šåˆ†ä¸¤æ®µï¼Œæ¯”å¦‚è¯´ä¿®æ”¹ $x$ å€¼ä¸º $s$ï¼Œé‚£ä¹ˆ $f[fa, t]++$ï¼Œå…¶ä¸­å‰åŠæ®µ $t$ å’Œ $s$ ç›¸åŒï¼ŒååŠæ®µ $s$ æ˜¯ $t$ çš„å­é›†ï¼›<br>æŸ¥è¯¢çš„è¯å°±å…ˆ $s = ~s$ï¼Œ$ans += f[fa, t]$ï¼Œå…¶ä¸­ååŠæ®µ $t$ å’Œ $s$ ç›¸åŒï¼Œå‰åŠæ®µ $t$ æ˜¯ $s$ çš„å­é›†ã€‚ä½†è¿™æ ·æ—¶é—´æ˜¯ $O(n2^{m / 2})$ äº†ï¼Œç©ºé—´è¿˜æ˜¯ $O(n2^m)$</p><p>ç»å…¸å¥—è·¯3ï¼šåº¦æ•°åˆ†å—</p><p>è€ƒè™‘ $bound$ï¼Œå½“åº¦æ•° $&lt; bound$ æ—¶æš´åŠ›ä¿®æ”¹/è¯¢é—®ï¼Œ$&gt; bound$ æ—¶ç”¨ä¸Šé¢çš„æ•°ç»„åšï¼Œå‘ç°è¿™æ ·ç©ºé—´å¤æ‚åº¦æ˜¯ $O(n / d * 2^{m / 2})$ï¼›å‘ç° $d = 2^{m / 2}$ æ—¶æœ€ä¼˜ï¼</p><p>å°±åšå®Œå•¦ã€‚</p><p><a href="https://cometoj.com/status/n8s13h50ao6gc6fvte6gb5opzqpcanel" target="_blank" rel="noopener">$Code$</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NOIP2020 æ€»ç»“ &amp; é¢˜è§£</title>
      <link href="2020/09/14/NOIP2020%20%E6%80%BB%E7%BB%93%20&amp;%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/09/14/NOIP2020%20%E6%80%BB%E7%BB%93%20&amp;%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="å†™åœ¨-NOIP2020-ä¹‹å"><a href="#å†™åœ¨-NOIP2020-ä¹‹å" class="headerlink" title="å†™åœ¨ NOIP2020 ä¹‹å"></a>å†™åœ¨ NOIP2020 ä¹‹å</h2><hr><p>T3 æ„é€ æˆ‘ç›´æ¥å‚»çœ¼ï¼Œæäº†ä¿©å°æ—¶ä¸€åˆ†æ²¡å¾—ï¼ˆè¿™æ„é€ æœ¬è´¨æ˜¯æ¨¡æ‹Ÿï¼‰ã€‚æœ€è¿‘å¤§èµ›è€ƒéæ­£å¸¸é¢˜è¶Šæ¥è¶Šå¤šäº†ï¼Œå¯¹ç åŠ›çš„è¦æ±‚ä¹Ÿé€æ­¥ä¸Šå‡ï¼Œè¿™ä¿©æˆ‘éƒ½ä¸æ“…é•¿ã€‚å¯¹è€Œä¸”æˆ‘è¿˜ä¸æ“…é•¿æ€ç»´é¢˜ã€‚æˆ‘æ“…é•¿å•¥å‘¢ï¼Ÿå¥—è·¯é¢˜ï¼ˆæœ‰æ‰‹å°±è¡Œçš„ sb é¢˜ï¼‰ã€‚</p><p>æƒ³è¦å¤šå†™ LOJ çš„ç¥é¢˜ã€å¥—è·¯é¢˜ã€éæ­£å¸¸é¢˜ï¼Œæƒ³å­¦ç”Ÿæˆå‡½æ•°ã€‚åœ¨å½¹çš„æ—¶é—´ï¼Œæœ‰ä¸€å¤©ä¾¿çœ‹ä¸€å¤©çš„é£æ™¯ï¼Œdp å¥— dpã€ç”Ÿæˆå‡½æ•°è¿™äº›äººç±»æ™ºæ…§ä¸çœ‹ä¼šåæ‚”çš„å§ qvqï¼Ÿ å‘å‰è·‹æ¶‰å§ï¼<strong>â€œæ°¸è¿œä¸è¦ç”¨è¡Œä¸ºä¸Šçš„åŠªåŠ›æ¥æ©ç›–æ€ç»´ä¸Šçš„æ‡’æƒ°ã€‚â€</strong></p><h2 id="æˆç»©å‡ºäº†"><a href="#æˆç»©å‡ºäº†" class="headerlink" title="æˆç»©å‡ºäº†"></a>æˆç»©å‡ºäº†</h2><hr><p>ä¸§æ°”è¯åˆ äº†ã€‚â€œä¸–ä¸Šä¸€åˆ‡ä¸å¹¸éƒ½æ˜¯ç”±äºå½“äº‹è€…èƒ½åŠ›ä¸è¶³â€</p><h2 id="é¢˜è§£"><a href="#é¢˜è§£" class="headerlink" title="é¢˜è§£"></a>é¢˜è§£</h2><hr><h3 id="T1"><a href="#T1" class="headerlink" title="T1"></a>T1</h3><p>å…ˆ ä¹˜ å é™¤ /åè¡€ ç—›å¤± 30 åˆ†ï¼Œ<strong>ç—›å¤±é«˜ä¸€èµ›å­£ï¼</strong></p><p>æ­£è§£å°±ç»´æŠ¤æŒ‡æ•°</p><h3 id="T2"><a href="#T2" class="headerlink" title="T2"></a>T2</h3><p>å¥½å§ã€‚ã€‚è¿™é¢˜å°±æ˜¯å¤æ‚åº¦ä¼˜åŒ–é¢˜ã€‚åé¢ä¸œè¥¿ç”¨æ ‘çŠ¶æ•°ç»„æˆ‘åšåˆ°äº†ï¼Œå‰é¢é‚£ä¸ªç”¨å€å¢æˆ‘çœŸæƒ³ä¸åˆ°å•Šã€‚ã€‚</p><p>è‚¯å®šè¦æšä¸¾ ABï¼Œç„¶åå‘ç°ç¡®å®šäº† AB çš„é•¿åº¦ï¼ŒC çš„å¥‡æ•°ä¸ªæ•°åªæœ‰ 2 ç§å€¼ï¼Œå°±å¾ˆç®€å•äº†ã€‚</p><h3 id="T3"><a href="#T3" class="headerlink" title="T3"></a>T3</h3><p>æ®è¯´æˆ‘å†™çš„æ˜¯ $70$ åˆ†ï¼Œå°±æ¯æ¬¡æŒ‘ä¸¤ä¸ªæŸ±å­ï¼Œå½“å‰æŸ±æœ‰ $x$ ä¸ªé»‘ï¼Œ$y$ ä¸ªç™½ï¼ˆæ˜¾ç„¶é¢œè‰²ä¸é‡è¦ï¼Œæˆ‘ä»¬å°±çœ‹ä½œé»‘ç™½ï¼‰ï¼Œç„¶åæŠŠä¸¤ä¸ªæŸ±å­å‡†å¤‡ä¸€ä¸‹ï¼Œå³ä¸€ä¸ªç•™ $x$ ä¸ªç©ºä½ï¼Œä¸€ä¸ªç•™ $y$ ä¸ªç©ºä½ï¼Œä½†æˆ‘è°ƒäº†å¾ˆä¹…ï¼Œè¿˜å†™æŒ‚äº†ï¼Œç—›å¤± $70$ åˆ†ã€‚èµ›åçœ‹é¢˜è§£çŸ¥é“è‡ªå·±åªæƒ³åˆ°äº†å‡ ä¸ªå…³é”®ç»†èŠ‚ä¸­çš„ä¸€ä¸ªã€‚</p><p>æˆ‘ä»¬é’¦å®šæ€»æœ‰ä¸€ä¸ªæŸ±å­æ˜¯ç©ºçš„ï¼Œå³æ¯æ¬¡æ“ä½œå®Œï¼Œæœ‰ $n$ ä¸ªæŸ±å­éƒ½æ˜¯æ»¡çš„ï¼Œè¿™æ ·å¯ä»¥ç®€åŒ–å¾ˆå¤šã€‚ï¼ˆç¬¬äºŒä¸ªç»†èŠ‚ï¼‰</p><p>å…ˆçœ‹ $n = 2$ çš„æƒ…å†µã€‚å‘ç°å¯ä»¥åœ¨ä¸æ”¹å˜å…¶ä»–æŸ±å­çŠ¶æ€çš„æƒ…å†µä¸‹æ•´ç†ä¸€ä¸ªæŸ±å­ï¼Œå³ç™½çš„åœ¨ä¸‹ï¼Œé»‘çš„åœ¨ä¸Šã€‚ï¼ˆç¬¬ä¸‰ä¸ªç»†èŠ‚ï¼‰</p><p>ç„¶åå¯ä»¥å°†æŸ±å­æ•´ç†æˆåŒè‰²çš„ï¼Œå…·ä½“å°±æ˜¯ï¼Œé€šè¿‡ç©ºæŸ±å­ï¼Œæˆ‘ä»¬å¯ä»¥ $reverse$ ä¸€ä¸ªæŸ±å­ï¼›ä¸¤ä¸ªæŸ±å­é€‰ä¸€ç§é¢œè‰²çš„çƒï¼Œ**éœ€è¦ä¿è¯ä¸¤ä¸ªæŸ±å­ä¸Šæ­¤é¢œè‰²çš„çƒæ•°ä¹‹å’Œ $\leq m$**ï¼Œç»™ä¸¢åˆ°ç©ºæŸ±å­ä¸Šï¼Œç”¨ä¸€ä¸ªæŸ±å­ä¸Šçš„çƒå¡«æ»¡å¦ä¸€ä¸ªæŸ±å­å†å°†å¡åˆ°ç©ºæŸ±å­ä¸Šçš„çƒæ‹¿å›æ”¾åœ¨è¿™ä¸ªæŸ±å­ä¸Šã€‚ï¼ˆç¬¬å››ä¸ªç»†èŠ‚ï¼‰</p><p>$n &gt; 2$ çš„æƒ…å†µåˆ†æ²»å°±å¥½äº†ï¼Œå¤æ‚åº¦ $O(5nmlogn)$ï¼Œæé™æ•°æ®åªè·‘äº† $500000$ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯èƒ½å­˜åœ¨ä¸€ä¸ªæŸ±å­é¢œè‰²å…¨æ˜¯é»‘æˆ–å…¨æ˜¯ç™½ï¼Œmerge çš„æ—¶å€™å¯èƒ½ä¼š $&gt; m$ï¼Œéœ€è¦ç‰¹åˆ¤ã€‚</p><h3 id="T4"><a href="#T4" class="headerlink" title="T4"></a>T4</h3><p>æš´ åŠ› å†™ æŒ‚ æˆ‘æ˜¯å±‘</p><p>åˆæ˜¯æ„é€ åˆæ˜¯å¤šé¡¹å¼çš„ï¼Œçˆ½å•¦ã€‚</p><p>å¯¹äºæš´åŠ›å’Œæ­£è§£éƒ½å¾ˆé‡è¦çš„ä¸€ä¸ªæ€æƒ³ï¼šæ¯ç»´æ˜¯ç‹¬ç«‹çš„ã€‚</p><p>å¦‚æœæ¨¡æ‹Ÿä¸¤è½®æ²¡èµ°å®Œï¼Œå‘ç°æ¯è½®åˆæ³•ä½ç½®çš„å˜åŒ–é‡æ˜¯çº¿æ€§çš„ï¼Œå³å¯¹äºç¬¬ $i$ ç»´ï¼Œç¬¬ä¸€è½®èµ°äº† $a_i$ï¼Œç¬¬äºŒè½®èµ°äº† $b_i$ï¼Œé‚£ä¹ˆå†èµ° $x$ è½®å‡å°‘çš„å°±æ˜¯ $b_i - (a_i - b_i) * x$</p><p>æšä¸¾ $i$ï¼Œç°åœ¨è®¡ç®—çš„æ˜¯ç¬¬ $x + 2$ è½®åšå®Œç¬¬ $i$ æ­¥çš„ç­”æ¡ˆï¼Œåˆæ³•çš„ä½ç½®æ•°æ˜¯æ¯ç»´çš„åˆæ³•ä½ç½®ä¹˜èµ·æ¥ã€‚</p><p>å°† $x$ çœ‹ä½œè‡ªå˜é‡ï¼Œæšä¸¾ $i$ï¼Œç¬¬ $x$ è½®èµ°äº† $i$ æ­¥çš„ç­”æ¡ˆæ˜¯ $f(x) = \prod_j (tot_{j, i} - (a_j - b_j) * x)$ï¼Œ$tot_{j, i}$ è¡¨ç¤ºç¬¬ $j$ ç»´èµ°äº† $i$ æ­¥çš„åˆæ³•ä½ç½®æ•°</p><p>$\prod$ å†™ä½œ $\sum$, $f(x) = \sum_i c_i x^i$ï¼Œæœ€ç»ˆç­”æ¡ˆå³ä¸º $\sum_i c_i (\sum\limits_{i = 1}^{mx} x_i)$ï¼ˆ$mx$ æ˜¯èµ°çš„è½®æ•°ä¸Šé™ã€‚</p><p>åé¢è¿™ç©æ„æ˜¯ä¸ªè‡ªç„¶æ•°å¹‚å’Œï¼Œ$k \leq 3$ æ—¶æœ‰é€šé¡¹å…¬å¼ï¼Œ$k &gt; 3$ æ—¶å¯ä»¥é¢„å¤„ç†å› ä¸ºé¢˜ç›®ä¿è¯ $max_{w_i} \leq 1e6$.</p><p>$O(nk^2)$ï¼Œä¹˜æ³•æ˜¯ $k^2$, å¬è¯´å› ä¸º $F$ å˜åŒ–é‡å°ï¼Œé€šè¿‡ä»€ä¹ˆæ‹‰æ ¼æœ—æ—¥æ’å€¼å¯ä»¥åšåˆ° $O(nk)$ï¼ˆè’Ÿè’»ä¸ä¼šå†…ä¸ª</p><h1 id="ã€Œä¸è¦åœ¨è„‘æµ·é‡Œæ¿€æƒ…æ¾æ¹ƒä¸€ä¼šå„¿å°±å½“åŠªåŠ›è¿‡äº†ã€‚ã€"><a href="#ã€Œä¸è¦åœ¨è„‘æµ·é‡Œæ¿€æƒ…æ¾æ¹ƒä¸€ä¼šå„¿å°±å½“åŠªåŠ›è¿‡äº†ã€‚ã€" class="headerlink" title="ã€Œä¸è¦åœ¨è„‘æµ·é‡Œæ¿€æƒ…æ¾æ¹ƒä¸€ä¼šå„¿å°±å½“åŠªåŠ›è¿‡äº†ã€‚ã€"></a><em>ã€Œä¸è¦åœ¨è„‘æµ·é‡Œæ¿€æƒ…æ¾æ¹ƒä¸€ä¼šå„¿å°±å½“åŠªåŠ›è¿‡äº†ã€‚ã€</em></h1>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘å¹³é¢å›¾</title>
      <link href="2020/09/14/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E5%B9%B3%E9%9D%A2%E5%9B%BE/"/>
      <url>2020/09/14/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E5%B9%B3%E9%9D%A2%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<p>ä»€ä¹ˆæ˜¯å¹³é¢å›¾ï¼Ÿé™¤äº†èŠ‚ç‚¹å¤–è¾¹æ²¡æœ‰äº¤ç‚¹çš„å›¾ã€‚å¯¹äºä¸€ä¸ªåŒºåŸŸï¼Œæˆ‘ä»¬ç§°å…¶ä¸º<strong>é¢</strong>ï¼›åŒ…å›´è¿™ä¸ªåŒºåŸŸçš„è¾¹ç§°å…¶ä¸º<strong>è¾¹ç•Œ</strong>ï¼›è¾¹ç•Œçš„é•¿åº¦ç§°ä¸ºè¿™ä¸ªé¢çš„<strong>åº¦</strong>ã€‚</p><hr><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1. |E| &lt;= 3|V| - 6</span><br></pre></td></tr></table></figure><p>è¿™å‘Šè¯‰æˆ‘ä»¬ <strong>å¹³é¢å›¾é‡Œ m ä¸ n åŒé˜¶</strong>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2. V - E + F = K + 1</span><br><span class="line"></span><br><span class="line">ä»»ä½•ä¸€ä¸ªå‡¸å¤šé¢ä½“ï¼ˆæˆ–è¿é€šå¹³é¢å›¾ï¼‰æ»¡è¶³ä¸Šå¼ï¼Œå…¶ä¸­ F ä¸ºé¢æ•°ï¼ŒK ä¸ºè¿é€šå—æ•°ã€‚</span><br></pre></td></tr></table></figure><p>æ¬§æ‹‰å®šç†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3. å¹³é¢å›¾çš„åˆ¤å®šï¼šï¼ˆä»¥ [HNOI2010]-planar ä¸ºä¾‹ï¼‰ï¼ˆå…¶å®æ˜¯åªä¼šå­˜åœ¨å“ˆå¯†é¡¿å›è·¯çš„ï¼‰å“ˆå¯†é¡¿å›è·¯ä¼šè¿æˆä¸€ä¸ªç¯ï¼Œæ¯æ¡è¾¹å°±æ˜¯ç¯ä¸Šçš„ä¸€æ¡å¼¦ï¼Œä¸¤æ¡è¾¹ i å’Œ j è‹¥ xi &lt; xj &lt; yi &lt; yj åˆ™ç›¸äº¤ï¼Œåªèƒ½ä¸€æ¡æ”¾ç¯é‡Œã€ä¸€æ¡æ”¾ç¯å¤–â€”â€”è¿™æ˜¯ä¸ªäºŒåˆ†å›¾å˜›ï¼äºŒåˆ†å›¾æœ‰æ— åˆæ³•æŸ“è‰²ç­‰ä»·äºæœ‰æ— è§£å•¦ã€‚</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥æ˜¯å¹³é¢å›¾è½¬å¯¹å¶å›¾ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">4. å¯¹äºä¸€ä¸ª s-t å¹³é¢å›¾ï¼ˆæœ‰æºç‚¹å’Œæ±‡ç‚¹çš„å¹³é¢å›¾ï¼‰ï¼Œå…¶å¯¹å¶å›¾ä¸­çš„ä¸€ä¸ªç¯å¯¹åº”ç€åŸå›¾ä¸­çš„ä¸€ä¸ªå‰²ã€‚</span><br><span class="line">å°†å¹³é¢å›¾æœ€å°å‰²æˆ–æœ€å¤§æµè½¬åŒ–æˆå¯¹å¶å›¾æœ€çŸ­è·¯ï¼Œæ•ˆæœç»ä½³ã€‚ï¼ˆä½†æˆ‘æ²¡å†™è¿‡qvqï¼‰</span><br></pre></td></tr></table></figure><p>ä¾‹é¢˜ï¼š<a href="https://www.luogu.com.cn/problem/P3209" target="_blank" rel="noopener">HNOI2011-å¹³é¢å›¾åˆ¤å®š</a></p><p>åˆ©ç”¨å“ˆå¯†é¡¿è·¯å¾„ä¸Šçš„ç¼–å·å…ˆå åˆ¤æ–­è¾¹æ˜¯å¦äº¤ï¼Œè½¬äºŒåˆ†å›¾åˆ¤å®šå°±å¥½å•¦ï¼Œå¹¶æŸ¥é›†å’Œ $2-sat$ éƒ½å¯ä»¥</p>]]></content>
      
      
      
        <tags>
            
            <tag> å¹³é¢å›¾ </tag>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»¥ CF1327F ä¸ºä»£è¡¨çš„ä¸€ç±»é™åˆ¶è®¡æ•°é—®é¢˜</title>
      <link href="2020/09/08/%E4%BB%A5%20CF1327F%20%E4%B8%BA%E4%BB%A3%E8%A1%A8%E7%9A%84%E4%B8%80%E7%B1%BB%E9%99%90%E5%88%B6%E8%AE%A1%E6%95%B0%E9%97%AE%E9%A2%98/"/>
      <url>2020/09/08/%E4%BB%A5%20CF1327F%20%E4%B8%BA%E4%BB%A3%E8%A1%A8%E7%9A%84%E4%B8%80%E7%B1%BB%E9%99%90%E5%88%B6%E8%AE%A1%E6%95%B0%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>è¿™ç±»æœ‰é™åˆ¶çš„è®¡æ•°é—®é¢˜ï¼Œå¥—è·¯åœ¨çŠ¶æ€è®¾è®¡ä¸Šã€‚ä¸€èˆ¬æ˜¯åŒºé—´ä¸Šçš„é—®é¢˜ï¼Œåˆ‡å…¥ç‚¹æ˜¯å‘ç° dp çš„è¦ç‚¹æœ‰å½“å‰ä½ç½®å’Œæ»¡è¶³é™åˆ¶çš„ä½ç½®ä»¥åŠæ»¡è¶³äº†å“ªäº›é™åˆ¶ï¼›è½¬ç§»å°±æ˜¯ å¯¹äºåŒä¸€ç§é™åˆ¶åŒä¸€ä¸ªå³ç«¯ç‚¹æ‰¾åˆ°æœ€å¤§çš„å·¦ç«¯ç‚¹ï¼Œè¿™ä¹‹é—´å¿…é¡»æœ‰ä¸€ä¸ªæ»¡è¶³è¦æ±‚çš„ä½ç½®ã€‚</p><h2 id="CF1327F"><a href="#CF1327F" class="headerlink" title="$CF1327F$"></a>$CF1327F$</h2><hr><p>æŒ‰ä½å¤„ç†ï¼Œå¯ä»¥ç®—å‡ºæ¯ä¸€ä½çš„ç­”æ¡ˆç„¶åä¹˜èµ·æ¥ã€‚å­é—®é¢˜çš„è§£å†³å¿…é¡»æ˜¯ $O(n)$ çš„ï¼ï¼</p><p>é™åˆ¶ä¸º 1 å¾ˆå¥½å¤„ç†ï¼Œå…¨éƒ¨å¼ºåˆ¶ä¸º 1 å°±å¯ä»¥äº†ï¼›ä¸º 0 å°±æ¯”è¾ƒéš¾æï¼Œè¦æ±‚è‡³å°‘æœ‰ä¸€ä¸ªä½ç½®æ˜¯ 0ã€‚</p><p>å…ˆåªè€ƒè™‘ä¸º 0 çš„é™åˆ¶ã€‚å¯¹äºä¸€ä¸ªä½ç½® $i$ æ‰¾åˆ°æ‰€æœ‰å³ç«¯ç‚¹ $\leq i$ çš„é™åˆ¶çš„æœ€å¤§å·¦ç«¯ç‚¹ï¼Œè®¾å…¶ä¸º $l_i$ã€‚$f[i, j]$ è¡¨ç¤ºå¡«å®Œäº†å‰ $i$ ä¸ªä½ç½®ï¼Œæ»¡è¶³äº†å³ç«¯ç‚¹ $\leq i$ çš„æ‰€æœ‰é™åˆ¶ï¼Œæœ€åä¸€ä¸ª 0 çš„ä½ç½®åœ¨ $j$ï¼Œå…¶ä¸­ $l_i \leq j \leq i$ çš„æ–¹æ¡ˆæ•°</p><p>é‚£ä¹ˆ $f[i, j] = f[i - 1, j]$ $(j &lt; i)$ï¼Œ$f[i, i] = \sum\limits_{k = l_{i - 1}}^{i - 1} f[i - 1, k]$</p><p>æƒ³ä¼˜åŒ–ç©ºé—´ã€‚å‘ç° $i \neq j$ çš„ $f[i, j]$ å¥½åƒæ²¡ä»€ä¹ˆç”¨ï¼Œå¹²è„†ä»¤ $f[i]$ è¡¨ç¤ºåŸæ¥çš„ $f[i, i]$ï¼Œ$f[i] = \sum\limits_{k = l_{i - 1}}^{i - 1} f[k]$ã€‚å‘ç°æ±‚äº†ä¸€ä¸ªåç¼€å’Œï¼Œåˆå‘ç° $l_i$ å•è°ƒé€’å¢ï¼Œæ‰€ä»¥ dp æ˜¯ $O(n)$ çš„ã€‚</p><p>é‚£åŠ ä¸Š 1 çš„é™åˆ¶æ€ä¹ˆåŠï¼ŸæŠŠé‚£äº›å·²ç»å¼ºåˆ¶ä¸º 1 çš„ç‚¹æ‹èµ°ï¼Œå‰©ä¸‹çš„åš dpã€‚</p><p><a href="https://codeforces.com/problemset/submission/1327/92203899" target="_blank" rel="noopener">$Code$</a></p><h2 id="æ¸…åé›†è®­2017-æŸä¸ªæ­Œå§¬çš„æ•…äº‹"><a href="#æ¸…åé›†è®­2017-æŸä¸ªæ­Œå§¬çš„æ•…äº‹" class="headerlink" title="$[æ¸…åé›†è®­2017]-æŸä¸ªæ­Œå§¬çš„æ•…äº‹$"></a>$[æ¸…åé›†è®­2017]-æŸä¸ªæ­Œå§¬çš„æ•…äº‹$</h2><hr><p>ç¦»æ•£åŒ–ï¼ˆu1s1è¿™é¢˜ç¦»æ•£åŒ–æ˜¯å¤§æ¯’ç˜¤ã€‚ï¼‰</p><p>é¢„å¤„ç†å‡ºæ¯ä¸ªä½ç½®çš„ä¸Šé™ $up_i$ï¼Œè¿™æ ·å°±æŠŠ $up_i$ ç›¸åŒçš„ç›¸é‚»ä½ç½®ç¼©æˆäº†ä¸€ä¸ªç‚¹ã€‚</p><p>å¯¹äºé™åˆ¶ $[l_j, r_j, m_j]$ æ˜¾ç„¶åªæœ‰ $l_j \leq i \leq r_j$ ä¸­ $up_i = m_j$ çš„ç‚¹èƒ½è´¡çŒ®ã€‚<br>äºæ˜¯å¯¹äºæ¯ä¸ª $m_j$ å°†æ‰€æœ‰ $up_i = m_j$ çš„ç‚¹æ‹¿å‡ºæ¥åš dpã€‚</p><p>æ€ä¹ˆdï¼Ÿæ˜¾ç„¶æ˜¯æ»¡è¶³æ¯ä¸ªé™åˆ¶åŒºé—´å†…æœ‰ä¸€ä¸ªç‚¹è¾¾åˆ°ä¸Šé™å³å¯ã€‚<br>ä»¤ $f[i, j]$ è¡¨ç¤ºæ»¡è¶³æ‰€æœ‰ å³ç«¯ç‚¹åœ¨ $1$ ~ $i$ çš„é™åˆ¶ï¼Œé€‰çš„æœ€åä¸€ä¸ªç‚¹æ˜¯ $j$ çš„æ–¹æ¡ˆæ•°ã€‚</p><p>ä¸åŒçš„ $m_j$ æ˜¯ç‹¬ç«‹çš„ï¼Œåˆ†åˆ« dp åæŠŠç­”æ¡ˆä¹˜èµ·æ¥ã€‚</p><p><a href="https://loj.ac/submission/927800" target="_blank" rel="noopener">$Code$</a></p><h2 id="NOI2020-D1T2-å‘½è¿"><a href="#NOI2020-D1T2-å‘½è¿" class="headerlink" title="$[NOI2020 D1T2]-å‘½è¿$"></a>$[NOI2020 D1T2]-å‘½è¿$</h2><hr><p>åŒº é—´ ä¸Š æ ‘ï¼ˆ</p><p>è¿™ä¸ªæ¯”èµ›æ—¶è¿ dp æ–¹ç¨‹éƒ½æƒ³ä¸åˆ°ã€‚ã€‚ã€‚å°±å†™äº†æœ€æš´åŠ›çš„æŒ‡æ•°çº§å®¹æ–¥ã€‚ã€‚<strong>ä½†å®é™…ä¸Šè·Ÿå‰ä¸¤é¢˜çš„ dp è®¾è®¡æ€è·¯æ˜¯å¾ˆç›¸ä¼¼çš„ï¼</strong></p><p>$dp[i, j]$ è¡¨ç¤º $i$ çš„å­æ ‘å†…çŠ¶æ€å·²ç»ç¡®å®šï¼Œæ²¡æœ‰æ»¡è¶³çš„é“¾é¡¶ç‚¹çš„æœ€å¤§æ·±åº¦ä¸º $j$ çš„æ–¹æ¡ˆæ•°ï¼ˆè®°å½•æœ€æ·±æ˜¯å› ä¸ºæ·±çš„æ»¡è¶³äº†ï¼Œæµ…çš„ä¹Ÿæ»¡è¶³äº†ï¼‰ï¼Œè¾¹ç•Œå°±æ˜¯é“¾éƒ½æ»¡è¶³äº†ï¼Œ$j = 0$</p><p>$$dp[x, i] = (\sum\limits_{j = 0}^{dep_x} dp[x, i] \times dp[y, j]) + (\sum\limits_{j = 0}^i dp[x, i] \times dp[y, j]) + (\sum\limits_{j = 0}^{i - 1} dp[x, j] \times dp[y, i])$$</p><p>å‰ä¸¤éƒ¨åˆ†åˆ†åˆ«æ˜¯ $(x, y)$ è¿™æ¡è¾¹ä¸º 1 å’Œä¸º 0 çš„æ–¹æ¡ˆæ•°ã€‚</p><p>äºŒç»´dpï¼Œå‰ç¼€å’Œå½¢å¼ã€‚ã€‚å™«ï¼Œè¿™ä¸ªä¸œè¥¿å’Œ pkuwc2018-minimax å¥½åƒå•Šï¼æ²¡é”™ï¼Œå°±æ˜¯æ•´ä½“dpï¼Œä¸Šçº¿æ®µæ ‘åˆå¹¶ã€‚</p><p>è·Ÿ minimax ä¸€æ ·çš„ï¼Œç¢°åˆ°å¶å­ç»“ç‚¹å°±è¿”å›ï¼Œå…¶ä»–èŠ‚ç‚¹ç”±å„¿å­èŠ‚ç‚¹ upd ä¸Šæ¥ã€‚</p><p><a href="https://loj.ac/submission/927792" target="_blank" rel="noopener">$Code$</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> è®¡æ•° </tag>
            
            <tag> æ€ç»´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[COCI2010]-ZUMA</title>
      <link href="2020/09/08/%5BCOCI2010%5D-ZUMA/"/>
      <url>2020/09/08/%5BCOCI2010%5D-ZUMA/</url>
      
        <content type="html"><![CDATA[<p>ç¬¬ä¸€æ¬¡ç¢°åˆ°ä¸ä¼šåšçš„åŒºé—´ dpã€‚ã€‚è¿™é¢˜çš„éš¾ç‚¹åœ¨äºè®¾è®¡ dp çŠ¶æ€ã€‚ã€‚</p><p>å‘ç°æ™®é€šçš„æ€è·¯ $f[i, j]$ æ²¡æœ‰åŠæ³•åš</p><p>$f[i, j, k]$ è¡¨ç¤ºåœ¨åŒºé—´ $[i, j]$ å‰æ”¾äº† $k$ ä¸ªä¸ $c[i]$ åŒè‰²çš„çƒï¼Œè¿å¸¦ç€æ–°åŠ çš„çƒå…¨éƒ¨æ¶ˆæ‰çš„æœ€å°çƒæ•°ã€‚</p><p>$f[i, j, k] =$</p><ol><li>$f[i, j, k + 1] + 1$ï¼ˆåœ¨å‰é¢åŠ ä¸€ä¸ªçƒï¼‰</li><li>$f[i + 1, j, k + 1]$ $(c[i] = c[i + 1])$</li><li>$f[i + 1, p - 1, 0] + f[p, j, k + 1]$ $(c[i] = c[p])$</li></ol><p>è¾¹ç•Œï¼š$f[i, i, j] = K - 1 - j$</p><p>$f[i, j, K - 1] =$</p><ol><li>$f[i + 1, j, 0]$</li><li>$f[i + 1, j, K - 1]$ $(c[i] = c[i + 1])$ï¼ˆå› ä¸ºè¦æ±‚ $\geq K$ ä¸ªè¿ç»­çš„çƒï¼‰</li><li>$f[i + 1, p - 1, 0] + f[p, j, K - 1]$ï¼ˆç†ç”±åŒ 2ï¼‰</li></ol><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">105</span>, KK = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, K, c[N], f[N][N][KK];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">chkmin</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y)</span> </span>&#123; x = min(x, y); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; K;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; c[i];</span><br><span class="line">        rep(j, <span class="number">0</span>, K - <span class="number">1</span>) f[i][i][j] = K - <span class="number">1</span> - j;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(len, <span class="number">2</span>, n) &#123;</span><br><span class="line">        rep(i, <span class="number">1</span>, n - len + <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> j = i + len - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            chkmin(f[i][j][K - <span class="number">1</span>], f[i + <span class="number">1</span>][j][<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">if</span> (c[i] == c[i + <span class="number">1</span>])</span><br><span class="line">                chkmin(f[i][j][K - <span class="number">1</span>], f[i + <span class="number">1</span>][j][K - <span class="number">1</span>]);</span><br><span class="line">            rep(p, i + <span class="number">2</span>, j)</span><br><span class="line">                <span class="keyword">if</span> (c[i] == c[p])</span><br><span class="line">                    chkmin(f[i][j][K - <span class="number">1</span>], f[i + <span class="number">1</span>][p - <span class="number">1</span>][<span class="number">0</span>] + f[p][j][K - <span class="number">1</span>]);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = K - <span class="number">2</span>; k &gt;= <span class="number">0</span>; k--) &#123;</span><br><span class="line">                chkmin(f[i][j][k], f[i][j][k + <span class="number">1</span>] + <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span> (c[i] == c[i + <span class="number">1</span>])</span><br><span class="line">                    chkmin(f[i][j][k], f[i + <span class="number">1</span>][j][k + <span class="number">1</span>]);</span><br><span class="line">                rep(p, i + <span class="number">2</span>, j)</span><br><span class="line">                    <span class="keyword">if</span> (c[i] == c[p])</span><br><span class="line">                        chkmin(f[i][j][k], f[i + <span class="number">1</span>][p - <span class="number">1</span>][<span class="number">0</span>] + f[p][j][k + <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, f[<span class="number">1</span>][n][<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
            <tag> åŒºé—´dp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 664 Div1</title>
      <link href="2020/09/08/Codeforces%20Round%20664%20Div1/"/>
      <url>2020/09/08/Codeforces%20Round%20664%20Div1/</url>
      
        <content type="html"><![CDATA[<p>China-Round å¥½ç¥ä»™ &gt; &lt;</p><p>xry éƒ½å‚ä¸å‡ºé¢˜å•¦ï¼Œæˆ‘ä»¬è¿™å±Šä¹Ÿå¼€å§‹å¾æˆ˜å››æ–¹äº†ï¼åŠ æ²¹ï¼Œæ— é™å¯èƒ½ã€‚</p><h2 id="A"><a href="#A" class="headerlink" title="$A$"></a>$A$</h2><hr><p>å°è´ªå¿ƒï¼Œå…ˆåˆ†æˆä¸¤ä¸ªé›†åˆï¼Œæšä¸¾å¤§çš„é›†åˆå–å‡ ä¸ªã€‚</p><p><a href="https://codeforces.com/contest/1394/submission/92126211" target="_blank" rel="noopener">$Code$</a></p><h2 id="B"><a href="#B" class="headerlink" title="$B$"></a>$B$</h2><hr><p>è¶£é¢˜ï¼è¦æ±‚çš„æ˜¯<strong>ä»»ä½•</strong>ç‚¹éƒ½èƒ½èµ°å›åˆ°è‡ªå·±ï¼Œ$k$ è¿™ä¹ˆå°æ˜¾ç„¶æŒ‡æ•°çº§æšä¸¾å•¦ï¼Œé—®é¢˜åœ¨äºæ€ä¹ˆå¿«é€Ÿåˆ¤æ–­</p><p>è€ƒè™‘ $n$ æ¡è¾¹è¿™ä¸ªæ¡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´æœ‰ $n$ ä¸ªå…¥åº¦ï¼Œè€Œæ¯ä¸ªç‚¹éƒ½èƒ½èµ°å›åˆ°è‡ªå·±ï¼Œæ¯ä¸ªç‚¹éƒ½æœ‰ä¸€ä¸ªå…¥åº¦ï¼Œè¿™æ„å‘³ç€ $n$ æ¡è¾¹çš„ç»ˆç‚¹éå¸ƒ $n$ ä¸ªç‚¹</p><p>é‚£ä¹ˆé¢„å¤„ç†ä¸€äº›ä¸œè¥¿ï¼Œåªè¦èƒ½å®ç°é›†åˆå¹¶å°±å¥½äº†ã€‚$bitset$ è¿‡ä¸å»ï¼Œæ€ä¹ˆåŠï¼Ÿ$hash$ï¼$O(1)$ åˆå¹¶</p><p>æ³¨æ„å†™åŒ$hash$ï¼å­¦ä¹ ä¸€æ³¢æ–°å†™æ³• :)</p><p><a href="https://codeforces.com/contest/1394/submission/92131053" target="_blank" rel="noopener">$Code$</a></p><h2 id="C"><a href="#C" class="headerlink" title="$C$"></a>$C$</h2><hr><p>å¥½é¢˜ï¼</p><p>æœ€å¤§å€¼æœ€å°ï¼Œè€ƒè™‘äºŒåˆ†ï¼ˆåˆ¤å®šæ€§é—®é¢˜å°±å¯åšå¾ˆå¤šå•¦ï¼</p><p>å‘ç°ä¸¤ä¸ªä¸²ç›¸ä¼¼çš„æ¡ä»¶æ˜¯ B å’Œ N çš„ä¸ªæ•°ç›¸ç­‰ï¼Œæ“ä½œå…¶å®æ˜¯åŠ æˆ–å‡ $B$ã€$N$ã€$BN$</p><p>é‚£ä¹ˆé—®é¢˜è½¬åŒ–ä¸ºåˆ¤å®šæ˜¯å¦å­˜åœ¨ä¸€ä¸ª $t$ ä½¿å¾—å¯¹äºä»»ä½• $i$ï¼Œ$dis(s_i, t) \leq mid$</p><p>æ¥ç»†åŒ–ä¸€ä¸‹ï¼šåœ¨å¹³é¢ä¸Šï¼Œè®¾ $s_i$ å¯¹åº”çš„ç‚¹ä¸º $(a, b)$, $t$ å¯¹åº”çš„ç‚¹ä¸º $(c, d)$, $dis(s_i, t) =$</p><ol><li>$(a - c)(b - d) &gt; 0$: $max{|a - c|, |b - d|}$</li><li>$(a - c)(b - d) &lt; 0$: $|a - c| + |b - d|$</li></ol><p>æ˜¾ç„¶æ»¡è¶³å¼‚å·é™åˆ¶çš„ç‚¹å¿…ç„¶æ»¡è¶³åŒå·é™åˆ¶ï¼Œå³å¯ä»¥çœ‹åšåŒå·é™åˆ¶å¯¹æ‰€æœ‰ $s_i$ éƒ½é€‚ç”¨</p><p>åŒ–å¼€æ¥ $|x - x_i| \leq mid$, $|y - y_i| \leq mid$ï¼Œå³ $x \in [x_i - mid, x_i + mid]$, $y \in [y_i - mid, y_i + mid]$</p><p>å¯¹äºå¼‚å·é™åˆ¶ï¼Œæƒ³æƒ³æ€ä¹ˆæŠŠå®ƒåŒ–ä½œâ€œå¯¹æ‰€æœ‰éƒ½é€‚ç”¨ä¸”åˆšå¥½é™åˆ¶åˆ°å¼‚å·ç‚¹â€</p><p><strong>è¿™é‡Œæœ‰ä¸ªç»å…¸trickï¼š$|x| + |y| = |x - y|$ï¼Œå¯¹äºåŒå·æ²¡æœ‰å½±å“ï¼Œè€Œå¯¹äºå¼‚å·æ˜¯ç­‰ä»·çš„</strong></p><p>æ‰€ä»¥ $|(x - y) - (x_i - y_i)| \leq mid$ï¼Œå³ $(x - y) \in [x_i - y_i - mid, x_i - y_i + mid]$</p><p>è‡³æ­¤æˆ‘ä»¬å¾—åˆ°äº† $x$, $y$, $x - y$ çš„é™åˆ¶ï¼Œæšä¸¾ä¸€ç»´å°±èƒ½å¾—åˆ°å¦ä¸€ç»´çš„èŒƒå›´ï¼Œåˆ¤æ–­æœ‰æ— äº¤å°±å¯ä»¥äº†ã€‚</p><p><a href="https://codeforces.com/contest/1394/submission/92186512" target="_blank" rel="noopener">$Code$</a></p><h2 id="D"><a href="#D" class="headerlink" title="$D$"></a>$D$</h2><hr><p><a href="https://blog.aor.sd.cn/archives/1246/" target="_blank" rel="noopener">å’•å’•ï¼Œè®°ä¸€ä¸‹å¤§ä½¬åšå®¢</a></p><h2 id="E"><a href="#E" class="headerlink" title="$E$"></a>$E$</h2><hr><p>å’•å’•</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[LG4260]-åšå¼ˆè®ºä¸æ¦‚ç‡ç»Ÿè®¡</title>
      <link href="2020/09/06/%5BLG4260%5D-%E5%8D%9A%E5%BC%88%E8%AE%BA%E4%B8%8E%E6%A6%82%E7%8E%87%E7%BB%9F%E8%AE%A1/"/>
      <url>2020/09/06/%5BLG4260%5D-%E5%8D%9A%E5%BC%88%E8%AE%BA%E4%B8%8E%E6%A6%82%E7%8E%87%E7%BB%9F%E8%AE%A1/</url>
      
        <content type="html"><![CDATA[<p>èµ¢çš„åœºæ•°éƒ½ç¡®å®šäº†ï¼Œ$p$ ä¸€ç‚¹ç”¨éƒ½æ²¡æœ‰ï¼Œæˆ‘ä»¬è¦ç®—å‡ºå¾—åˆ†ä¹‹å’Œä»¥åé™¤ä»¥ $C(n + m, n)$ã€‚æ‰€ä»¥è¿™æ˜¯é“è®¡æ•°é¢˜ï¼Ÿ</p><p>ä¸èƒ½å°äº $0$ï¼Œæƒ³åˆ°äº†å•¥ï¼Œå¡ç‰¹å…°æ•°ï¼è€ƒè™‘å¹³é¢ä¸Šå‘å³å‘ä¸Šèµ°é—®é¢˜</p><p>å‡è®¾ $n \geq m$, ä» $(0, 0)$ èµ°åˆ° $(n, m)$ è´¡çŒ®æ˜¯ $n - m$ï¼Œæ–¹æ¡ˆæ•°æ˜¯ $C(n + m, n) - C(n + m, n + 1)$ï¼Œå°±æ˜¯ç”¨æ€»æ•° - ç¢°åˆ°äº†è¾¹ç•Œçº¿çš„æ–¹æ¡ˆæ•°</p><p>ä» $(0, 0)$ èµ°åˆ° $(n, m - 1)$ è´¡çŒ®æ˜¯ $n - m + 1$ï¼Œæ–¹æ¡ˆæ•°æ˜¯ $C(n + m, n + 1) - C(n + m, n + 2)$</p><p>â€¦</p><p>æ‰€ä»¥æ€»è´¡çŒ®æ˜¯ $\sum \limits_{i = 0}^{m} (C(n + m, n + i) - C(n + m, n + i + 1))(n - m + i) = (n - m)C(n + m, n) + \sum\limits_{i = 0}^{m - 1}C(n + m, i)$</p><p>$n &lt; m$ ä¼šæ€ä¹ˆæ ·ï¼Œ$\sum \limits_{i = m - n}^{m} (C(n + m, n + i) - C(n + m, n + i + 1))(n - m + i) = \sum\limits_{i = 0}^{n - 1}C(n + m, i)$</p><p>è¿™æ ·å°±ç»“æŸå•¦ï¼ˆ</p><p>å“¦ä¸ å¤šç»„è¯¢é—®ã€‚ã€‚</p><p>å‘ç°å½¢å¦‚ $f(n, k) = \sum\limits_{i = 0}^k C(n, i)$ çš„ä¸œè¥¿å¾ˆéš¾æ±‚</p><p>å‘ç° $f(n, k) = \sum\limits_{i = 0}^k C(n - 1, i - 1) + C(n - 1, i) = 2f(n - 1, k) - C(n - 1, k)$</p><p>å‘ç°çŸ¥é“äº† $f(n, k)$ å°±å¯ä»¥åœ¨ $O(1)$ æ—¶é—´å†…æ¨å‡º $f(n \pm 1, k)$ å’Œ $f(n, k \pm 1)$ï¼</p><p>è«é˜Ÿæ±‚è§£ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>, N = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line">ll T, p, unit = <span class="number">500</span>, tot;</span><br><span class="line">ll ans[N], fac[N], inv[N], divv[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">que</span> &#123;</span> ll n, k, id; &#125;q[N];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quick_pow</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ret = ret * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">    &#125; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    fac[<span class="number">0</span>] = inv[<span class="number">0</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) fac[i] = fac[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">    rep(i, <span class="number">2</span>, n) inv[i] = (mod - mod / i) * inv[mod % i] % mod;</span><br><span class="line">    rep(i, <span class="number">2</span>, n) inv[i] = inv[i] * inv[i - <span class="number">1</span>] % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">C</span><span class="params">(ll n, ll m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fac[n] * inv[m] % mod * inv[n - m] % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(que a, que b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.n / unit == b.n / unit ? a.k &lt; b.k : a.n / unit &lt; b.n / unit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T &gt;&gt; p;</span><br><span class="line">    pre(<span class="number">500000</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, T) &#123;</span><br><span class="line">        ll n, m;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;n, &amp;m);</span><br><span class="line">        <span class="keyword">if</span> (n &gt;= m) &#123;</span><br><span class="line">            ans[i] = (n - m) * C(n + m, n) % mod;</span><br><span class="line">            q[i].k = m - <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            q[i].k = n - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        q[i].id = i;</span><br><span class="line">        q[i].n = n + m;</span><br><span class="line">        divv[i] = fac[n] * fac[m] % mod * inv[n + m] % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(q + <span class="number">1</span>, q + T + <span class="number">1</span>, cmp);</span><br><span class="line">    q[<span class="number">0</span>].n = <span class="number">-1e9</span>;</span><br><span class="line">    ll nn = <span class="number">0</span>, kk = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, T) &#123;</span><br><span class="line">        <span class="keyword">if</span> (q[i].k &lt; <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (q[i - <span class="number">1</span>].k &lt; <span class="number">0</span> || q[i - <span class="number">1</span>].n / unit &lt; q[i].n / unit) &#123;</span><br><span class="line">            nn = q[i].n, kk = q[i].k;</span><br><span class="line">            tot = <span class="number">0</span>;</span><br><span class="line">            rep(j, <span class="number">0</span>, kk) (tot += C(nn, j)) %= mod;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">while</span> (nn &lt; q[i].n) tot = (tot * <span class="number">2</span> % mod - C(nn, kk) + mod) % mod, ++nn;</span><br><span class="line">            <span class="keyword">while</span> (nn &gt; q[i].n) --nn, tot = (tot + C(nn, kk)) % mod * inv[<span class="number">2</span>] % mod;</span><br><span class="line">            <span class="keyword">while</span> (kk &lt; q[i].k) ++kk, (tot += C(nn, kk)) %= mod;</span><br><span class="line">        &#125;</span><br><span class="line">        (ans[q[i].id] += tot + mod) %= mod;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, T) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[i] * divv[i] % mod);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> è®¡æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[LnOI2019]-åŠ ç‰¹æ—è½®ç›˜èµŒ</title>
      <link href="2020/09/05/%5BLnOI2019%5D-%E5%8A%A0%E7%89%B9%E6%9E%97%E8%BD%AE%E7%9B%98%E8%B5%8C/"/>
      <url>2020/09/05/%5BLnOI2019%5D-%E5%8A%A0%E7%89%B9%E6%9E%97%E8%BD%AE%E7%9B%98%E8%B5%8C/</url>
      
        <content type="html"><![CDATA[<p>æœ‰æ„æ€çš„é¢˜ï¼ˆæˆ‘ä¸ä¼šæ¦‚ç‡æ‰€ä»¥å®ƒè¶…æœ‰æ„æ€ï¼ˆ</p><p>æ¯”è¾ƒå¦™çš„é€šè¿‡â€œç¯â€çš„æ€§è´¨ï¼ŒåŒ–æ— é™ä¸ºé€’æ¨ã€‚è®¾ $f[n, k]$ è¡¨ç¤ºé•¿åº¦ä¸º $n$ çš„ç¯ä¸­ç¬¬ $k$ ä¸ªäººå”¯ä¸€å¹¸å­˜çš„æ¦‚ç‡ï¼Œé‚£ä¹ˆæœ‰ $f[n, k] = p0 \times f[n - 1, k - 1] + (1 - p0) \times f[n, k - 1]$, ç‰¹åˆ«çš„ $f[n, 1] = (1 - p0) \times f[n, n]$</p><p>è¿™ç©æ„ä½œä¸º dp æœ‰åæ•ˆæ€§ï¼Œæƒ³åˆ°æ¶ˆå…ƒã€‚æš´åŠ›æ¶ˆå…ƒç‚¸æ²¡äº†ï¼Œä½†æˆ‘ä»¬å‘ç°å‡è®¾å‰ $i - 1$ è¡Œéƒ½ç®—å‡ºæ¥äº†ï¼Œç¬¬ $i$ è¡Œæ‰€æœ‰ $f[i, j]$ åªä¸ $f[i, 1]$ æœ‰å…³ï¼Œäºæ˜¯æƒ³åˆ°ç»å…¸å¥—è·¯ï¼šè¡¨ç¤ºæˆ $a \times f[i, 1] + b$ çš„å½¢å¼ï¼Œ$\sum\limits_{j = 1}^i f[i, j] = 1$ï¼Œè§£å‡º $f[i, 1]$ã€‚</p><p>$O(n^2)$</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">double</span> p0, f[<span class="number">2</span>][N];</span><br><span class="line"><span class="keyword">int</span> n, K, cur = <span class="number">1</span>, lst;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; p0 &gt;&gt; n &gt;&gt; K;</span><br><span class="line">    <span class="keyword">if</span> (!p0) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(n == <span class="number">1</span> ? <span class="string">"1"</span> : <span class="string">"0"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    f[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">2</span>, n) &#123;</span><br><span class="line">        lst = cur; cur ^= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">double</span> a = <span class="number">1</span>, A = <span class="number">0</span>, b = <span class="number">0</span>, B = <span class="number">0</span>;</span><br><span class="line">        rep(j, <span class="number">2</span>, i) &#123;</span><br><span class="line">            a *= (<span class="number">1</span> - p0);</span><br><span class="line">            A += a;</span><br><span class="line">            b = p0 * f[lst][j - <span class="number">1</span>] + (<span class="number">1</span> - p0) * b;</span><br><span class="line">            B += b;</span><br><span class="line">        &#125;</span><br><span class="line">        f[cur][<span class="number">1</span>] = (<span class="number">1</span> - B) / (A + <span class="number">1</span>);</span><br><span class="line">        rep(j, <span class="number">2</span>, i)</span><br><span class="line">            f[cur][j] = p0 * f[lst][j - <span class="number">1</span>] + (<span class="number">1</span> - p0) * f[cur][j - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.8lf\n"</span>, f[cur][K]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•åˆ©ç”¨ç­‰æ¯”æ•°åˆ—æ±‚å’Œå…¬å¼ã€‚è®¾å½“å‰è½® $f[i]$ è¡¨ç¤º $i$ å”¯ä¸€å­˜æ´»çš„æ¦‚ç‡ï¼Œ$g[i]$ è¡¨ç¤º $i$ è¢«æ‰“æ­»çš„æ¦‚ç‡ï¼Œ$g[i] = (1 - p0)^{i - 1} p (\sum\limits_{j = 0}^{\infty} ((1 - p)^n)^i) = \frac{(1 - p)^{i - 1}}{1 - ((1 - p)^n)^i}$ï¼Œç„¶åæ¯æ‰“æ­»ä¸€ä¸ªäººå°±å¾—åˆ°ä¸€ä¸ªæ–°çš„å±€é¢ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¦‚ç‡ä¸æœŸæœ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ZJOI2020 é¢˜è§£</title>
      <link href="2020/09/04/ZJOI2020%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/09/04/ZJOI2020%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="D1T1-å­—ç¬¦ä¸²"><a href="#D1T1-å­—ç¬¦ä¸²" class="headerlink" title="$D1T1. å­—ç¬¦ä¸²$"></a>$D1T1. å­—ç¬¦ä¸²$</h2><hr><h2 id="D1T2-ä¼ ç»Ÿè‰ºèƒ½"><a href="#D1T2-ä¼ ç»Ÿè‰ºèƒ½" class="headerlink" title="$D1T2. ä¼ ç»Ÿè‰ºèƒ½$"></a>$D1T2. ä¼ ç»Ÿè‰ºèƒ½$</h2><hr><h2 id="D1T3-åºåˆ—"><a href="#D1T3-åºåˆ—" class="headerlink" title="$D1T3. åºåˆ—$"></a>$D1T3. åºåˆ—$</h2><hr><h2 id="D2T1-æŸ“è‰²æ¸¸æˆ"><a href="#D2T1-æŸ“è‰²æ¸¸æˆ" class="headerlink" title="$D2T1. æŸ“è‰²æ¸¸æˆ$"></a>$D2T1. æŸ“è‰²æ¸¸æˆ$</h2><hr><h2 id="D2T2-æŠ½å¡"><a href="#D2T2-æŠ½å¡" class="headerlink" title="$D2T2. æŠ½å¡$"></a>$D2T2. æŠ½å¡$</h2><hr><h2 id="D2T3-å¯†ç "><a href="#D2T3-å¯†ç " class="headerlink" title="$D2T3. å¯†ç $"></a>$D2T3. å¯†ç $</h2><hr>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 666 Div1</title>
      <link href="2020/09/03/Codeforces%20Round%20666%20Div1/"/>
      <url>2020/09/03/Codeforces%20Round%20666%20Div1/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘åœºéƒ½å¥½æ€ç»´å•Š</p><h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><hr><p>å·§å¦™æ„é€ ï¼Œç¬¬ä¸€æ¬¡å– n - 1 ä¸ªï¼Œç¬¬äºŒæ¬¡å–å‰©ä¸‹ 1 ä¸ªï¼Œç¬¬ä¸‰æ¬¡å– n ä¸ªï¼Œå‰ä¸¤æ¬¡çš„ç›®çš„å°±æ˜¯æŠŠæ‰€æœ‰å…ƒç´ å˜æˆ n çš„å€æ•°</p><h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><hr><p>æ²¡æœ‰æ€è·¯ï¼Œå°† a æ’åºï¼Œå‘ç°å¦‚æœæœ€å¤§çš„æ¯”å…¶ä»–å’Œéƒ½å¤§é‚£å…ˆæ‰‹æ˜¾ç„¶å¿…èƒœã€‚è¿™ä¸ªæ€è·¯æœ‰ç‚¹ä¸œè¥¿ï¼Œç»§ç»­æŒ–æ˜å‘ç°ä¸¤ä¸ªäººéƒ½å°½é‡é¿å…å‡ºç°è¿™ç§ä¸å‡è¡¡çš„å±€é¢ï¼Œ<strong>æ‰€æœ‰å…ƒç´ å°±ä¼šè¢«å–å®Œ</strong>ï¼Œæ‰€ä»¥åˆ¤æ–­å¥‡å¶æ€§å°±å¯ä»¥äº†ã€‚</p><h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><hr><p>1 &lt;= r1 &lt;= r2 &lt;= r3 !!! è¿™ä¸ªæ¡ä»¶æœ‰ç‚¹éšè”½ï¼Œä½†æ˜¯èƒ½ç®€åŒ–ä¸€äº›åˆ†ç±»è®¨è®º</p><p>æ‰€ä»¥è¦ä¹ˆ 1 æˆ– 2 å°†æ‰€æœ‰çš„è¡€é‡å‡ä¸€å†ç”¨ 1 æ‰“æ‰bossï¼Œè¦ä¹ˆ 1 æ‰“æ‰å°æ€ªå† 3 æ‰“æ‰boss</p><p>åå¤æ¨ªè·³ã€‚å…·ä½“æ¥è¯´æ˜¯è·³ä¸€æ®µå›ä¸€æ­¥è·³ä¸€æ®µå›ä¸€æ­¥â€¦è¿™æ ·</p><p>dp, $f[i, 0/1]$ è¡¨ç¤ºæœ€è¿œåˆ°ç¬¬ $i$ å…³ï¼Œå‰ $i - 1$ å…³éƒ½æ¶ˆç­äº†ï¼Œæ˜¯å¦æ¶ˆç­äº†bossï¼Œ0 ä»£è¡¨æ¶ˆç­</p><p>åˆå§‹ $f[1, 0] = a[1] * r1 + r3$, $f[1, 1] = min(r1 * (a[1] + 1), r2)$</p><p>$f[i, 0] = min(f[i - 1, 0] + d + (r1 * a[i] + r3), f[i - 1, 1] + d + min(r1 * (a[i] + 1), r2) + d + r1 + d + r1)$</p><p>$f[i, 1] = min(f[i - 1, 0] + d + min(r1 * (a[i] + 1), r2), f[i - 1, 1] + d + min(r1 * (a[i] + 1), r2) + d + r1 + d)$</p><p>ç­”æ¡ˆæ˜¯ $min(f[n, 0], f[n - 1, 1] + d + a[n] * r1 + r3 + d + r1)$</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>USACO20OPEN (Gold) é¢˜è§£</title>
      <link href="2020/09/02/USACO20OPEN%20(Gold)%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/09/02/USACO20OPEN%20(Gold)%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="T1-Haircut"><a href="#T1-Haircut" class="headerlink" title="T1. Haircut"></a>T1. Haircut</h2><hr><p>è®¾æ¯ä¸ªç‚¹åˆå§‹è´¡çŒ®æ˜¯ v[i], é‚£ä¹ˆå‘ç° v[i] ä¸€å®šæ˜¯åˆ°äº†æŸä¸ªæ—¶åˆ»ï¼ˆå…¶å®å°±æ˜¯ h[i]ï¼‰åˆ·ä¸€ä¸‹å˜æˆ 0 äº†ï¼Œæ ‘çŠ¶æ•°ç»„ç»´æŠ¤ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lowbit(x) ((x) &amp; (-(x)))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, a[N], ans[N], C[N], num[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (; x &lt;= n + <span class="number">1</span>; x += lowbit(x)) C[x] += v;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (; x; x -= lowbit(x)) ret += C[x];</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]);</span><br><span class="line">        ++a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> tot = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        num[i] = i - <span class="number">1</span> - query(a[i]);</span><br><span class="line">        tot += num[i];</span><br><span class="line">        add(a[i], <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(C, <span class="number">0</span>, <span class="keyword">sizeof</span>(C));</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        add(<span class="number">1</span>, -num[i]), add(a[i] + <span class="number">1</span>, num[i]);</span><br><span class="line">    <span class="keyword">int</span> lst = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, query(i) + tot);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="T2-Favorite-Colors"><a href="#T2-Favorite-Colors" class="headerlink" title="T2. Favorite Colors"></a>T2. Favorite Colors</h2><hr><p>æ¯”è¾ƒæš´åŠ›çš„æ€è·¯ï¼Œå¹¶æŸ¥é›† + å¯å‘å¼åˆå¹¶ï¼Œå°±æ˜¯å¾ˆæš´åŠ›çš„å°†æ¯ä¸ªç‚¹çš„å­èŠ‚ç‚¹éƒ½å¹¶èµ·æ¥ï¼ŒO(n log n)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, idx, fa[N], col[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[N], t[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fa[x] == x ? x : fa[x] = getfa(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (g[x].size() &lt; <span class="number">2</span>) <span class="keyword">return</span>;</span><br><span class="line">    t[x] = g[x];</span><br><span class="line">    g[x].clear();</span><br><span class="line">    <span class="keyword">int</span> rt = t[x][<span class="number">0</span>];</span><br><span class="line">    rt = getfa(rt);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; t[x].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = t[x][i];</span><br><span class="line">        y = getfa(y);</span><br><span class="line">        <span class="keyword">if</span> (rt == y) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (g[rt].size() &gt;= g[y].size()) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; g[y].size(); j++) g[rt].push_back(g[y][j]);</span><br><span class="line">            g[y].clear();</span><br><span class="line">            fa[y] = rt;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; g[rt].size(); j++) g[y].push_back(g[rt][j]);</span><br><span class="line">            g[rt].clear();</span><br><span class="line">            rt = fa[rt] = y;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    g[x].push_back(rt);</span><br><span class="line">    dfs(rt);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) fa[i] = i;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        g[x].push_back(y);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) dfs(i);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = getfa(i);</span><br><span class="line">        <span class="keyword">if</span> (!col[x]) col[x] = ++idx;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, col[x]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="T3-Exercise"><a href="#T3-Exercise" class="headerlink" title="T3. Exercise"></a>T3. Exercise</h2><hr><p>k = lcm(ç¯é•¿)ï¼Œè€Œ n = sum(ç¯é•¿)</p><p>è€ƒè™‘ lcm è¿™ä¸ªä¸œè¥¿æœ¬è´¨æ˜¯æŠŠè´¨å› æ•°æ¯ä¸€ä½å–æœ€é«˜æ¬¡å¹‚ä¹˜èµ·æ¥</p><p><a href="https://www.cnblogs.com/123789456ye/p/12739149.html" target="_blank" rel="noopener">è¿™ä¸ªè€æ¸…æ¥šäº†</a></p><p>æœ¬é¢˜ä¸­è¿ç”¨çš„â€œæœ€ä¼˜æ„é€ â€æ€æƒ³æ˜¯å¾ˆå¸¸ç”¨çš„ï¼Œåœ¨ä¸ä¼šå½±å“ç­”æ¡ˆçš„æƒ…å†µä¸‹è´ªå¿ƒçš„å–ã€‚</p><p>å¦å¤–æ˜¾ç„¶å¹¶ä¸ä¼šé‡å¤è®¡ç®—æŸä¸ª k</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, tot, f[N], vis[N], p[N], ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">2</span>, n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i]) p[++tot] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt;= n; j += i) vis[j] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, tot)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = n; j &gt;= p[i]; j--) &#123;</span><br><span class="line">            <span class="keyword">int</span> tmp = p[i];</span><br><span class="line">            <span class="keyword">while</span> (tmp &lt;= j) &#123;</span><br><span class="line">                f[j] = (f[j] + <span class="number">1l</span>l * f[j - tmp] * tmp % m) % m;</span><br><span class="line">                tmp *= p[i];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    rep(i, <span class="number">0</span>, n) ans = (ans + f[i]) % m;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> è®¡æ•° </tag>
            
            <tag> æ€ç»´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NOIonline 1~3åœºé¢˜è§£</title>
      <link href="2020/09/02/NOIonline%201~3%E5%9C%BA%E9%A2%98%E8%A7%A3/"/>
      <url>2020/09/02/NOIonline%201~3%E5%9C%BA%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>æ¥è®¢é¢˜ï¼ˆå’•</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CSP2019 é¢˜è§£</title>
      <link href="2020/09/02/CSP2019%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/09/02/CSP2019%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>å¿«è¦ csp2020 äº†ï¼Œæ¥è¡¥ 2019 çš„é¢˜ï¼ˆå’•</p><h2 id="D1T1"><a href="#D1T1" class="headerlink" title="D1T1"></a>D1T1</h2><hr><p>æ‰‹ç©å°±å‡ºæ¥äº†ï¼Ÿ</p><h2 id="D1T2"><a href="#D1T2" class="headerlink" title="D1T2"></a>D1T2</h2><hr><p>å®¹æ˜“æƒ³åˆ°ç»Ÿè®¡æ¯ä¸ªèŠ‚ç‚¹ä¸ºå³ç«¯ç‚¹çš„å­ä¸²æ•°ï¼Œç„¶åç»§æ‰¿ç»™å­èŠ‚ç‚¹å°±å¥½äº†ã€‚ç„¶åè®°å½•æ¯ä¸ªèŠ‚ç‚¹ç¥–å…ˆä¸­ç¦»å®ƒæœ€è¿‘çš„æœªåŒ¹é…çš„ â€˜(â€˜ æ˜¯å“ªä¸ªï¼Œå†è®°å½•ä¸€ä¸‹æ¯ä¸ªèŠ‚ç‚¹ä¸ºå³ç«¯ç‚¹çš„åˆæ³•çš„ â€˜(â€¦)â€™ æ•°ï¼Œå°±å¥½äº†ï¼</p><p>æ¡æ¡å¤§è·¯é€šç½—é©¬ï¼Œæœ‰æ—¶å€™é”™è¯¯çš„æ€è·¯ä¹Ÿä¼šå¯¼å‡ºæ­£ç¡®çš„æ€è·¯ã€‚è¦æœ‰ä¿¡ä»°ï¼ï¼ï¼</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line">ll n, res;</span><br><span class="line">ll fa[N], ans[N], lst[N], cur[N];</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">2</span>, n) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;fa[i]);</span><br><span class="line">    rep(x, <span class="number">1</span>, n) &#123;</span><br><span class="line">        ans[x] = ans[fa[x]];</span><br><span class="line">        lst[x] = lst[fa[x]];</span><br><span class="line">        <span class="keyword">if</span> (s[x] == <span class="string">'('</span>) lst[x] = x;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (s[x] == <span class="string">')'</span> &amp;&amp; lst[x]) &#123;</span><br><span class="line">            cur[x] = cur[fa[lst[x]]] + <span class="number">1</span>;</span><br><span class="line">            lst[x] = lst[fa[lst[x]]];</span><br><span class="line">            ans[x] += cur[x];</span><br><span class="line">        &#125;</span><br><span class="line">        res ^= (<span class="number">1l</span>l * x * ans[x]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, res);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="D1T3"><a href="#D1T3" class="headerlink" title="D1T3"></a>D1T3</h2><hr><p>éƒ¨åˆ†åˆ†æ¨å‡ºæ­£è§£ã€‚</p><p>èŠèŠ±ï¼šå°†æ•°å­—æŒ‰ç…§ $(rt, p_1, p_2, â€¦ p_{n - 1})$ æ’å‡ºæ¥ï¼Œå‘ç°ç›¸å½“äºæ¯ä¸ªä½ç½®ä¸Šçš„æ•°å¾€åç§»äº†ä¸€ä½ã€‚è´ªå¿ƒçš„æ„é€ è½®æ¢ã€‚</p><p>é“¾ï¼šå¯¹äºåœ¨ $u$ ä½ç½®çš„è¦ç§»åˆ° $v$ ä½ç½®ï¼ˆå‡è®¾ $u &lt; v$ï¼‰ï¼Œæ˜¾ç„¶ $[u, v]$ ä¹‹é—´çš„åˆ è¾¹é¡ºåºæ˜¯ä»å·¦åˆ°å³ï¼Œ$u$ å³è¾¹æ¯” $u$ å·¦è¾¹åˆ çš„æ—©ã€‚æ‰“æ ‡è®°ï¼Œ$i$ ç‚¹ $tag_i = 0, 1, 2$ è¡¨ç¤ºæ— æ ‡è®°ï¼Œå…ˆå·¦åå³ï¼Œå…ˆå³åå·¦</p><p>è¿™æ˜¯<strong>å¾ˆæœ‰å¯å‘æ€§</strong>çš„ä¸¤æ¡£åˆ†ï¼æ¥ä¸‹æ¥è€ƒè™‘æ»¡åˆ†åšæ³•ï¼Œæ˜¾ç„¶å°±æ˜¯ $u$ æŒ‡å‘ $v$ çš„å‡ºè¾¹æ˜¯ç¬¬ä¸€ä¸ªåˆ çš„ï¼Œ$v$ æŒ‡å‘ $u$ çš„å‡ºè¾¹æ˜¯ç¬¬ä¸€ä¸ªåˆ çš„ï¼Œ$[u, v]$ ä¹‹é—´çš„ç‚¹éƒ½è¿˜æ²¡è¢«åˆ ã€‚<br>æŠ½è±¡ä¸€ç‚¹å°±æ˜¯æŠŠå›¾åˆ†æˆå¾ˆå¤šä¸ç›¸äº¤çš„é“¾äº†ã€‚</p><p>å¤æ‚åº¦ $O(n^2)$</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>, N = <span class="number">2e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> T, n, w[N];</span><br><span class="line"><span class="keyword">int</span> to[N &lt;&lt; <span class="number">1</span>], nxt[N &lt;&lt; <span class="number">1</span>], lnk[N], cnt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> deg, beg, end, fa[N];  <span class="comment">// end å’Œ beg åˆ†åˆ«è®°å½•è¯¥ç‚¹ç¬¬ä¸€æ¡åˆ é™¤çš„å…¥è¾¹å’Œå‡ºè¾¹ï¼Œfa å°†æˆå¯¹åˆ é™¤çš„é‚»è¾¹ç»‘åœ¨ä¸€èµ·</span></span><br><span class="line">    <span class="keyword">bool</span> st[N], ed[N];  <span class="comment">// ed å’Œ st æ˜¯è®°å½•æŸæ¡è¾¹æœ‰æ— ä½œä¸ºè¯¥è¾¹çš„ å…¥/å‡º è¾¹ï¼Œè‡³äºä¸ºä»€ä¹ˆè¦åˆ†å¼€è®°å½•è¿˜ä¸æ˜¯å¾ˆæ‡‚ã€‚ã€‚</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        beg = end = <span class="number">-1</span>, deg = <span class="number">0</span>;</span><br><span class="line">        rep(i, <span class="number">0</span>, n) st[i] = ed[i] = <span class="number">1</span>, fa[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> fa[x] == x ? x : fa[x] = getfa(fa[x]); &#125;</span><br><span class="line">&#125;a[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    to[cnt] = y, nxt[cnt] = lnk[x], lnk[x] = cnt, ++cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getpos</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = n + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (~id &amp;&amp; (a[x].end == <span class="number">-1</span> || a[x].end == id)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[x].ed[id] &amp;&amp; (a[x].beg == <span class="number">-1</span> || a[x].deg &lt;= <span class="number">1</span> || a[x].getfa(id) != a[x].getfa(a[x].beg)))</span><br><span class="line">            ret = x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; ~i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (id == (i &gt;&gt; <span class="number">1</span>)) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">int</span> ed = (i &gt;&gt; <span class="number">1</span>), y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (~id) &#123;</span><br><span class="line">            <span class="keyword">if</span> (id == a[x].end || ed == a[x].beg || a[x].getfa(id) == a[x].getfa(ed))</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (!a[x].ed[id] || !a[x].st[ed]) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (~a[x].beg &amp;&amp; ~a[x].end &amp;&amp; a[x].deg &gt; <span class="number">2</span> &amp;&amp; a[x].getfa(id) == a[x].getfa(a[x].beg) &amp;&amp; a[x].getfa(ed) == a[x].getfa(a[x].end))</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            ret = min(ret, getpos(y, ed));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[x].beg == <span class="number">-1</span> || a[x].beg == ed) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!a[x].st[ed]) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span> (~a[x].end &amp;&amp; a[x].deg &gt; <span class="number">1</span> &amp;&amp; a[x].getfa(ed) == a[x].getfa(a[x].end)) <span class="keyword">continue</span>;</span><br><span class="line">                ret = min(ret, getpos(y, ed));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> id, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x == p) <span class="keyword">return</span> a[x].end = id, <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; ~i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (id == (i &gt;&gt; <span class="number">1</span>)) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">int</span> ed = (i &gt;&gt; <span class="number">1</span>), y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (Link(y, ed, p)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (~id) &#123;</span><br><span class="line">                a[x].ed[id] = a[x].st[ed] = <span class="number">0</span>, --a[x].deg;</span><br><span class="line">                a[x].fa[a[x].getfa(id)] = a[x].getfa(ed);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                a[x].beg = ed;</span><br><span class="line">            &#125; <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">        <span class="built_in">memset</span>(lnk, <span class="number">-1</span>, <span class="keyword">sizeof</span>(lnk));</span><br><span class="line">        cnt = <span class="number">0</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;w[i]);</span><br><span class="line">            a[i].init();</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">            add(x, y), add(y, x);</span><br><span class="line">            ++a[x].deg, ++a[y].deg;</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">            <span class="keyword">int</span> pos = getpos(w[i], <span class="number">-1</span>);</span><br><span class="line">            Link(w[i], <span class="number">-1</span>, pos);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d "</span>, pos);</span><br><span class="line">        &#125; <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="D2T1"><a href="#D2T1" class="headerlink" title="D2T1"></a>D2T1</h2><hr><p>ï¼ˆå•Šã€‚ã€‚è¿™ä¸ªé¢˜ç›®çœŸçš„æ¶å¿ƒã€‚ã€‚å·®ç‚¹æ²¡æ‡‚ï¼‰</p><p>è€ƒè™‘æ¯ç§é£Ÿæéƒ½ä¸è¶…è¿‡ $\lfloor \frac{k}{2} \rfloor$ è¿™ä¸ªé™åˆ¶å¾ˆçƒ¦ï¼Œè€ƒè™‘å®¹æ–¥ï¼Œç»Ÿè®¡æ¯ç§é£Ÿææ‰“ç ´é™åˆ¶çš„æ€»æ–¹æ¡ˆæ•°ç„¶åå‡æ‰å°±å¥½äº†ã€‚</p><p>å¯¹äºç¬¬ $col$ ç§é£Ÿææ‰“ç ´é™åˆ¶ï¼Œè®¾ $f[i, j]$ è¡¨ç¤ºå‰ $i$ ä¸ªçƒ¹é¥ªæ–¹æ³•ä¸­é€‰çš„ç¬¬ $col$ ç§é£Ÿæçš„èœä¸ä¸æ˜¯ç¬¬ $col$ ç§é£Ÿæçš„èœçš„ä¸ªæ•°å·®ä¸º $j$ çš„æ–¹æ¡ˆæ•°ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>, N = <span class="number">102</span>, M = <span class="number">2002</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, m, tot = <span class="number">1</span>, ans;</span><br><span class="line">ll a[N][M], f[N][N &lt;&lt; <span class="number">1</span>], s[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">1</span>, m)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i][j]), s[i] = (s[i] + a[i][j]) % mod;</span><br><span class="line">        tot = tot * (s[i] + <span class="number">1</span>) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(col, <span class="number">1</span>, m) &#123;</span><br><span class="line">        f[<span class="number">0</span>][N] = <span class="number">1</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, n)</span><br><span class="line">            rep(j, N - i, N + i)</span><br><span class="line">                f[i][j] = (f[i - <span class="number">1</span>][j] + f[i - <span class="number">1</span>][j - <span class="number">1</span>] * a[i][col] % mod + f[i - <span class="number">1</span>][j + <span class="number">1</span>] * (s[i] - a[i][col] + mod) % mod) % mod;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) ans = (ans + f[n][N + i]) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, (tot - <span class="number">1</span> - ans + mod) % mod);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="D2T2"><a href="#D2T2" class="headerlink" title="D2T2"></a>D2T2</h2><hr><p>è€ƒåœºä¸Šå†™äº† $n^3$ æš´åŠ›åçªç„¶èªæ˜äº†ä¸€ä¸‹ï¼Œè¾“å‡ºäº†ä¸€äº›ä¸œè¥¿ï¼Œå‘ç°è¿™ç©æ„æ˜¯å•è°ƒçš„ç„¶åå°±å¤šäº† 32 åˆ† qvq è®ºä¿¡ä»°çš„åŠ›é‡ã€‚ã€‚</p><p>88 åˆ†å°±æ˜¯å†åŠ ä¸ªå•è°ƒé˜Ÿåˆ—ï¼100 åˆ†å†åŠ ä¸ªé«˜ç²¾åº¦ã€‚ã€‚ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œ$j$ èƒ½è½¬ç§»åˆ° i å½“ä¸”ä»…å½“ $pre[i] - pre[j] &gt;= len[j]$ï¼Œ$len[j]$ è¡¨ç¤ºä»¥ $j$ ä¸ºç»“æŸçš„æ®µï¼Œ$pre[i] &gt;= pre[j] + len[j]$ã€‚å‘ç° $j$ è¶Šå¤§è¶Šå¥½ï¼ˆè¿™å°±æ˜¯æˆ‘è€ƒåœºä¸Šå‘ç°çš„å•è°ƒæ€§ï¼‰ï¼Œå•è°ƒé˜Ÿåˆ—ä¸€æ³¢å°±å¯ä»¥äº†ã€‚</p><p><a href="http://matthew99.blog.uoj.ac/blog/5299" target="_blank" rel="noopener">å•è°ƒæ€§çš„è¯æ˜</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 88 åˆ†ä»£ç </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e7</span> + <span class="number">5</span>;</span><br><span class="line">ll n, tp, len[N], f[N], q[N], pre[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; tp;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;pre[i]);</span><br><span class="line">        pre[i] += pre[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">1</span>, r = <span class="number">0</span>;</span><br><span class="line">    q[++r] = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">while</span> (l &lt; r &amp;&amp; pre[q[l + <span class="number">1</span>]] + len[q[l + <span class="number">1</span>]] &lt;= pre[i]) ++l;</span><br><span class="line">        len[i] = pre[i] - pre[q[l]];</span><br><span class="line">        f[i] = f[q[l]] + (pre[i] - pre[q[l]]) * (pre[i] - pre[q[l]]);</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r &amp;&amp; pre[q[r]] + len[q[r]] &gt;= pre[i] + len[i]) --r;</span><br><span class="line">        q[++r] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, f[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="D2T3"><a href="#D2T3" class="headerlink" title="D2T3"></a>D2T3</h2><hr><p>å­¦ä¹ äº† xht37 çš„æ€è·¯ï¼ˆæ˜¯æˆ‘æ¯”è¾ƒé€‚åº”çš„æ–¹æ³•ï¼‰ï¼šç®—å‡ºæ¯ä¸€ä¸ªèŠ‚ç‚¹ä¸ºé‡å¿ƒçš„æ¬¡æ•°ã€‚</p><p>é€‰ä¸€ä¸ªé‡å¿ƒä¸ºæ ¹ï¼Œå¯¹äºæˆ‘ä»¬è€ƒè™‘çš„ $x\ (x\neq rt)$ï¼Œ<strong>å‰²çš„è¾¹ä¸€å®šä¸åœ¨ x çš„å­æ ‘é‡Œ</strong>ã€‚è®¾ $mx[x] = \max{size[y]}$, $S$ = å‰²æ‰è¾¹åä¸åŒ…å« $x$ çš„é‚£å—çš„ $size$ï¼Œé‚£ä¹ˆæœ‰ï¼š$2(n - S - size[x]) \leq n - S$, $2mx[x] \leq n - S$ï¼Œä¹Ÿå°±æ˜¯è¦æ±‚ $n - 2size[x] \leq S \leq n - 2mx[x]$ ä¸”è¾¹ä¸åœ¨ $x$ å­æ ‘ä¸­çš„è¾¹æ•°</p><p>é‚£ä¸ªä¸ç­‰å¼ç”¨æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ä¸€ä¸‹ï¼Œå°±æˆäº†åŒºé—´æ±‚å’Œï¼›ç¬¬äºŒä¸ªçº¦æŸå¯ä»¥åœ¨è¿›å‡ºæŸä¸ªå­æ ‘çš„æ—¶å€™ä½œå·®ã€‚</p><p>$x = rt$ æ—¶æ€ä¹ˆåŠï¼Ÿè®¾ $size$ æœ€å¤§çš„å­æ ‘æ˜¯ $u$ çš„ï¼Œæ¬¡å¤§çš„æ˜¯ $v$ çš„ã€‚å‰²è¾¹åœ¨ $u$ å­æ ‘ä¸­æ—¶ $2size[u] \leq n - S$, åœ¨ $v$ å­æ ‘ä¸­æ—¶ $2size[v] \leq n - S$</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lowbit(x) ((x) &amp; (-(x)))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> T, n, rt, u, v;</span><br><span class="line"><span class="keyword">int</span> sz[N], mx[N], C1[N], C2[N];</span><br><span class="line">ll ans;</span><br><span class="line"><span class="keyword">bool</span> mark[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> C[], <span class="keyword">int</span> x, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    ++x;  <span class="comment">// ä½¿å¾— x ä¸ä¸º 0 çš„æŠ€å·§</span></span><br><span class="line">    <span class="keyword">for</span> (; x &lt;= n + <span class="number">1</span>; x += lowbit(x)) C[x] += v;  <span class="comment">// !!!</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> C[], <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    ++x;  <span class="comment">// æŸ¥è¯¢ä¹Ÿä¸€å®šè¦å•Šï¼ï¼ï¼</span></span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (; x; x -= lowbit(x)) ret += C[x];</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> ff = <span class="number">1</span>;</span><br><span class="line">    sz[x] = <span class="number">1</span>, mx[x] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[x].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = g[x][i];</span><br><span class="line">        <span class="keyword">if</span> (y == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs1(y, x);</span><br><span class="line">        <span class="keyword">if</span> (sz[y] &gt; (n &gt;&gt; <span class="number">1</span>)) ff = <span class="number">0</span>;</span><br><span class="line">        sz[x] += sz[y];</span><br><span class="line">        mx[x] = max(mx[x], sz[y]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ((n - sz[x]) &gt; (n &gt;&gt; <span class="number">1</span>)) ff = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (ff &amp;&amp; !rt) rt = x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    add(C1, sz[fa], <span class="number">-1</span>);</span><br><span class="line">    add(C1, n - sz[x], <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (x ^ rt) &#123;</span><br><span class="line">        ans += <span class="number">1l</span>l * x * (ask(C1, n - <span class="number">2</span> * mx[x]) - ask(C1, n - <span class="number">2</span> * sz[x] - <span class="number">1</span>));</span><br><span class="line">        ans += <span class="number">1l</span>l * x * (ask(C2, n - <span class="number">2</span> * mx[x]) - ask(C2, n - <span class="number">2</span> * sz[x] - <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">if</span> (mark[fa]) mark[x] = <span class="number">1</span>;</span><br><span class="line">        ans += rt * (sz[x] &lt;= n - <span class="number">2</span> * sz[mark[x] ? v : u]);  <span class="comment">// rt çš„è´¡çŒ®ç›´æ¥ç»´æŠ¤</span></span><br><span class="line">    &#125;</span><br><span class="line">    add(C2, sz[x], <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[x].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = g[x][i];</span><br><span class="line">        <span class="keyword">if</span> (y == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs2(y, x);</span><br><span class="line">    &#125;</span><br><span class="line">    add(C1, sz[fa], <span class="number">1</span>);</span><br><span class="line">    add(C1, n - sz[x], <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">if</span> (x ^ rt) &#123;</span><br><span class="line">        ans -= <span class="number">1l</span>l * x * (ask(C2, n - <span class="number">2</span> * mx[x]) - ask(C2, n - <span class="number">2</span> * sz[x] - <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) g[i].clear();</span><br><span class="line">        rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">            g[x].push_back(y), g[y].push_back(x);</span><br><span class="line">        &#125;</span><br><span class="line">        ans = rt = <span class="number">0</span>;</span><br><span class="line">        dfs1(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        dfs1(rt, <span class="number">0</span>);</span><br><span class="line">        u = v = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[rt].size(); i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = g[rt][i];</span><br><span class="line">            <span class="keyword">if</span> (sz[x] &gt; sz[u]) v = u, u = x;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (sz[x] &gt; sz[v]) v = x;</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i, <span class="number">1</span>, n + <span class="number">1</span>) C1[i] = C2[i] = <span class="number">0</span>, mark[i] = <span class="number">0</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) add(C1, sz[i], <span class="number">1</span>);</span><br><span class="line">        mark[u] = <span class="number">1</span>;</span><br><span class="line">        dfs2(rt, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>[PKUWC2018]-Minimax</title>
      <link href="2020/08/30/%5BPKUWC2018%5D-Minimax/"/>
      <url>2020/08/30/%5BPKUWC2018%5D-Minimax/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.luogu.com.cn/problem/P5298" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>ä»¥å‰å¥½åƒç¢°åˆ°è¿‡ç±»ä¼¼ dp å¥—è·¯ï¼Ÿç¦»æ•£åŒ–ï¼Œ$f[i, j]$ è¡¨ç¤ºç¬¬ $j$ å°çš„æ•°ç•™åˆ°äº† $i$ èŠ‚ç‚¹çš„æ¦‚ç‡ã€‚è½¬ç§»ï¼š</p><p>$$f[i, j] = f[ls, j] * (p[i] * \sum\limits_{k = 1}^{j - 1} f[rs, k] + (1 - p[i]) * \sum\limits_{k = j + 1}^m f[rs, k]) + f[rs, j] * (p[i] * \sum\limits_{k = 1}^{j - 1} f[ls, k] + (1 - p[i]) * \sum\limits_{k = j + 1}^m f[ls, k])$$</p><p>å‘ç°æ¯ä¸ªå¶å­ç»“ç‚¹çš„æƒå€¼éƒ½ä¸åŒï¼Œä¸”éƒ½åªä¼šè´¡çŒ®ä¸€æ¬¡ï¼Œ<strong>æƒ³åˆ°çº¿æ®µæ ‘åˆå¹¶</strong>ï¼ˆæ³¨æ„è¦åˆå¹¶çš„ä¸œè¥¿å¿…é¡»æ˜¯ $O(n)$ åŠä»¥ä¸‹çº§åˆ«çš„ï¼Œä¸ç„¶ä¸Šä¸äº†çº¿æ®µæ ‘åˆå¹¶ï¼‰ã€‚ç„¶åå‘ç°çº¿æ®µæ ‘å¯ä»¥å¾ˆå¥½åœ°ç»´æŠ¤åŒºé—´å’Œã€åŒºé—´ä¹˜æ ‡è®°ç­‰ä¸œè¥¿ï¼</p><p>ï¼ˆå“‡çº¿æ®µæ ‘åˆå¹¶å¤æ‚åº¦æ˜¯å•¥å‘€æˆ‘åˆä¸ä¼šäº†ï¼‰</p><p>å¥½å§æ¥çœ‹çœ‹ï¼Œåˆå¹¶ä¸¤é¢—çº¿æ®µæ ‘çš„å¤æ‚åº¦çº¦ç­‰äºå®ƒä»¬ <strong>é‡åˆ</strong> çš„ç‚¹æ•°ï¼Œè®¾æ ‘æœ‰ $n$ ä¸ªèŠ‚ç‚¹ï¼Œçº¿æ®µé•¿åº¦æ˜¯ $m$ï¼Œæ€»å¤æ‚åº¦å°±æ˜¯ $O(nlogm)$ï¼ˆæ„Ÿæ€§ç†è§£å°±æ˜¯æ¯åŠ è¿›æ¥ä¸€ä¸ªç‚¹æœ€å¤šå¢åŠ  $logm$ çš„å¤æ‚åº¦ï¼‰</p><p>è¿™ç±»é¢˜ï¼Œå³ç”¨åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ä¼˜åŒ–çš„äºŒç»´dpï¼Œæœ‰ä¸ªæ–°åè¯å«åšâ€œæ•´ä½“dpâ€ï¼</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>, N = <span class="number">3e5</span> + <span class="number">10</span>, M = N * <span class="number">60</span>, inv = <span class="number">796898467</span>, P = mod;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, m, idx;</span><br><span class="line"><span class="keyword">int</span> son[N][<span class="number">2</span>], h[N], val[N], ans, ls[M], rs[M], tag[M], f[M], rt[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">psd</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (tag[x] != <span class="number">1</span>) &#123;</span><br><span class="line">        tag[ls[x]] = <span class="number">1l</span>l * tag[ls[x]] * tag[x] % mod;</span><br><span class="line">        tag[rs[x]] = <span class="number">1l</span>l * tag[rs[x]] * tag[x] % mod;</span><br><span class="line">        f[ls[x]] = <span class="number">1l</span>l * f[ls[x]] * tag[x] % mod;</span><br><span class="line">        f[rs[x]] = <span class="number">1l</span>l * f[rs[x]] * tag[x] % mod;</span><br><span class="line">        tag[x] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    f[x] = (f[ls[x]] + f[rs[x]]) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> pos)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x) x = ++idx, tag[idx] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        f[x] = <span class="number">1</span>; <span class="keyword">return</span>;  <span class="comment">// æ¦‚ç‡æ˜¯ 100%</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (pos &lt;= mid) insert(ls[x], l, mid, pos);</span><br><span class="line">    <span class="keyword">else</span> insert(rs[x], mid + <span class="number">1</span>, r, pos);</span><br><span class="line">    upd(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> la, <span class="keyword">int</span> ra, <span class="keyword">int</span> lb, <span class="keyword">int</span> rb, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x &amp;&amp; !y) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (x) psd(x);</span><br><span class="line">    <span class="keyword">if</span> (y) psd(y);</span><br><span class="line">    <span class="keyword">if</span> (x &amp;&amp; !y) &#123;</span><br><span class="line">        <span class="keyword">int</span> t = (<span class="number">1l</span>l * p * lb % mod + <span class="number">1l</span>l * (<span class="number">1</span> - p + mod) % mod * rb % mod) % mod;</span><br><span class="line">        f[x] = <span class="number">1l</span>l * f[x] * t % mod;</span><br><span class="line">        tag[x] = <span class="number">1l</span>l * tag[x] * t % mod;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!x &amp;&amp; y) &#123;</span><br><span class="line">        <span class="keyword">int</span> t = (<span class="number">1l</span>l * p * la % mod + <span class="number">1l</span>l * (<span class="number">1</span> - p + mod) % mod * ra % mod) % mod;</span><br><span class="line">        f[y] = <span class="number">1l</span>l * f[y] * t % mod;</span><br><span class="line">        tag[y] = <span class="number">1l</span>l * tag[y] * t % mod;</span><br><span class="line">        <span class="keyword">return</span> y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> a = f[ls[x]], b = f[ls[y]];</span><br><span class="line">    <span class="keyword">int</span> cur = ++idx; tag[cur] = <span class="number">1</span>;</span><br><span class="line">    ls[cur] = merge(ls[x], ls[y], la, (ra + f[rs[x]]) % mod, lb, (rb + f[rs[y]]) % mod, p);</span><br><span class="line">    rs[cur] = merge(rs[x], rs[y], (la + a) % mod, ra, (lb + b) % mod, rb, p);</span><br><span class="line">    upd(cur);</span><br><span class="line">    <span class="keyword">return</span> cur;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!son[x][<span class="number">0</span>] &amp;&amp; !son[x][<span class="number">1</span>]) &#123;</span><br><span class="line">        insert(rt[x], <span class="number">1</span>, m, val[x]);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!son[x][<span class="number">1</span>]) &#123;</span><br><span class="line">        dfs(son[x][<span class="number">0</span>]);</span><br><span class="line">        rt[x] = rt[son[x][<span class="number">0</span>]];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(son[x][<span class="number">0</span>]), dfs(son[x][<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">int</span> p = <span class="number">1l</span>l * val[x] * inv % mod;</span><br><span class="line">    rt[x] = merge(rt[son[x][<span class="number">0</span>]], rt[son[x][<span class="number">1</span>]], <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc_ans</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x) <span class="keyword">return</span>;</span><br><span class="line">    psd(x);</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        ans = (ans + <span class="number">1l</span>l * l * h[l] % mod * f[x] % mod * f[x] % mod) % mod;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    calc_ans(ls[x], l, mid), calc_ans(rs[x], mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">        <span class="keyword">if</span> (!son[x][<span class="number">0</span>]) son[x][<span class="number">0</span>] = i;</span><br><span class="line">        <span class="keyword">else</span> son[x][<span class="number">1</span>] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;val[i]);</span><br><span class="line">        <span class="keyword">if</span> (!son[i][<span class="number">0</span>] &amp;&amp; !son[i][<span class="number">1</span>]) h[++m] = val[i];</span><br><span class="line">    &#125;</span><br><span class="line">    sort(h + <span class="number">1</span>, h + m + <span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> (!son[i][<span class="number">0</span>] &amp;&amp; !son[i][<span class="number">1</span>])</span><br><span class="line">            val[i] = lower_bound(h + <span class="number">1</span>, h + m + <span class="number">1</span>, val[i]) - h;</span><br><span class="line">    dfs(<span class="number">1</span>);</span><br><span class="line">    calc_ans(rt[<span class="number">1</span>], <span class="number">1</span>, m);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘åˆå¹¶ </tag>
            
            <tag> æ¦‚ç‡ä¸æœŸæœ› </tag>
            
            <tag> æ•´ä½“dp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[NOI2012]-è¿·å¤±æ¸¸ä¹å›­</title>
      <link href="2020/08/29/%5BNOI2012%5D-%E8%BF%B7%E5%A4%B1%E6%B8%B8%E4%B9%90%E5%9B%AD/"/>
      <url>2020/08/29/%5BNOI2012%5D-%E8%BF%B7%E5%A4%B1%E6%B8%B8%E4%B9%90%E5%9B%AD/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.luogu.com.cn/problem/P2081" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>çœ‹èµ·æ¥å·¨å¤æ‚çš„ä¸€é“æœŸæœ›å—·ï¼Œä½†æ˜¯åŸºç¯æ ‘è¿˜æ˜¯æ¯”è¾ƒå¥—è·¯çš„</p><p>å…ˆè€ƒè™‘çº¯æ ‘çš„æƒ…å†µï¼šè®¾ $f[x]$ ä¸º $x$ å¾€ä¸‹èµ°çš„æœŸæœ›ï¼Œ$g[x]$ ä¸ºå¾€ä¸Šèµ°çš„æœŸæœ›</p><p>$f[x] = \frac{1}{son[x]} \sum (f[y] + w(x, y))$ï¼Œ$g[y] = w(x, y) + \frac{g[x] + f[x] \times son[x] - (f[y] + w(x, y))}{son[x] - [x == root]}$ æ³¨æ„åˆ†æ¯å¯èƒ½ä¸º 0ï¼Œè¦ç‰¹åˆ¤ã€‚<br>$ans[x] = \frac{f[x] \times son[x] + g[x]}{son[x] + [x \neq root]}$</p><p>å¥½å•¦ 50 åˆ†åˆ°æ‰‹ï¼Œå†æ¥æƒ³æƒ³åŸºç¯æ ‘ï¼Œå‘ç°ç¯ä¸ŠèŠ‚ç‚¹å¥½å°‘å•Šï¼Œ<strong>ä¸ç®¡æ€æ ·å…ˆç”¨åŒæ ·çš„æ€è·¯æ’•çƒ¤æ’•çƒ¤</strong></p><p>å‘ç° $f$ å’Œä¸åœ¨ç¯ä¸Šçš„ç‚¹çš„ $g$ å’Œ $ans$ æ˜¯ä¸€æ ·è®¡ç®—çš„ï¼Œç¯ä¸Šç‚¹çš„ $g$ æå‡ºæ¥ä»¥åå¯ä»¥æŠŠä¸åœ¨ç¯ä¸Šç‚¹çš„ $g$ ä¹Ÿç®—å‡ºæ¥</p><p>å¯¹äºç¯ä¸Šç‚¹ï¼Œå¯¹äºä¸¤ä¸ªæ–¹å‘éƒ½åšä¸€éï¼Œä»¥å‘å·¦ä¸ºä¾‹ï¼Œ$l[x] = \frac{l[nxt] + f[nxt]}{2}$, $g[x] = \frac{l[x] + r[x]}{2}$, $ans[x] = \frac{f[x] \times son[x] + g[x] \times 2}{son[x] + 2}$</p><p>å°±åšå®Œäº†</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, top, idx;</span><br><span class="line"><span class="keyword">int</span> stk[N], dfn[N], son[N];</span><br><span class="line"><span class="keyword">int</span> to[N &lt;&lt; <span class="number">1</span>], nxt[N &lt;&lt; <span class="number">1</span>], lnk[N], cnt, w[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">double</span> f[N], g[N], ans;</span><br><span class="line"><span class="keyword">bool</span> onc[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span> </span>&#123;</span><br><span class="line">    to[++cnt] = y, nxt[cnt] = lnk[x], lnk[x] = cnt, w[cnt] = z;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getf</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    f[x] = <span class="number">0</span>;</span><br><span class="line">    son[x] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (y == fa || onc[y]) <span class="keyword">continue</span>;</span><br><span class="line">        ++son[x];</span><br><span class="line">        getf(y, x);</span><br><span class="line">        f[x] += f[y] + w[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (son[x]) f[x] /= son[x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getg</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, <span class="keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (y == fa || onc[y]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (x == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (son[x] == <span class="number">1</span>) &#123;</span><br><span class="line">                    g[y] = w[i];</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    g[y] = w[i] + (f[x] * son[x] - (f[y] + w[i])) / (son[x] - <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                g[y] = w[i] + (g[x] + f[x] * son[x] - (f[y] + w[i])) / son[x];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (onc[x]) &#123;</span><br><span class="line">                g[y] = w[i] + (g[x] * <span class="number">2</span> + f[x] * son[x] - (f[y] + w[i])) / (son[x] + <span class="number">1</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                g[y] = w[i] + (g[x] + f[x] * son[x] - (f[y] + w[i])) / son[x];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        getg(y, x, op);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    getf(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    getg(<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">    ans = f[<span class="number">1</span>];</span><br><span class="line">    rep(i, <span class="number">2</span>, n)</span><br><span class="line">        ans += (f[i] * son[i] + g[i]) / (son[i] + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.5lf\n"</span>, ans / n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">findcir</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    stk[++top] = x;</span><br><span class="line">    dfn[x] = ++idx;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (y == fa) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (!dfn[y]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (findcir(y, x)) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (dfn[y] &lt; dfn[x]) &#123;</span><br><span class="line">            <span class="keyword">while</span> (top &amp;&amp; stk[top] != y) onc[stk[top--]] = <span class="number">1</span>;</span><br><span class="line">            onc[y] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    --top;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, <span class="keyword">int</span> st)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (y == fa || !onc[y]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (y == st) <span class="keyword">return</span> f[x];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> (calc(y, x, st) + w[i] + f[x] * son[x]) / (son[x] + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calcg</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (!onc[y]) <span class="keyword">continue</span>;</span><br><span class="line">        g[x] += calc(y, x, x) + w[i];</span><br><span class="line">    &#125;</span><br><span class="line">    g[x] /= <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    findcir(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> (onc[i]) getf(i, <span class="number">0</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> (onc[i]) calcg(i);</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> (onc[i]) getg(i, <span class="number">0</span>, <span class="number">2</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> (!onc[i]) ans += (f[i] * son[i] + g[i]) / (son[i] + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">else</span> ans += (f[i] * son[i] + g[i] * <span class="number">2</span>) / (son[i] + <span class="number">2</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.5lf\n"</span>, ans / n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y, z; <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;x, &amp;y, &amp;z);</span><br><span class="line">        add(x, y, z), add(y, x, z);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; m) solve1();</span><br><span class="line">    <span class="keyword">else</span> solve2();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¦‚ç‡ä¸æœŸæœ› </tag>
            
            <tag> æ ‘å½¢dp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ä¹ é¢˜é€‰è®²ã€‘ç®€å•è®¡æ•°é¢˜é€‰åšï¼ˆ1ï¼‰</title>
      <link href="2020/08/20/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91%E7%AE%80%E5%8D%95%E8%AE%A1%E6%95%B0%E9%A2%98%E9%80%89%E5%81%9A%EF%BC%881%EF%BC%89/"/>
      <url>2020/08/20/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91%E7%AE%80%E5%8D%95%E8%AE%A1%E6%95%B0%E9%A2%98%E9%80%89%E5%81%9A%EF%BC%881%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p>å®¹æ–¥ã€$dp$ ä»€ä¹ˆçš„éƒ½æ˜¯åŸºç¡€ï¼Œæˆ‘è¿™å—ä¸æ‰å®= = ä¸èƒ½å°±è¿™ä¹ˆå¿ƒç”˜æƒ…æ„¿è¢«åŒºåˆ†äº†å•Šï¼Œæ€»æ˜¯è¦æŒ£æ‰çš„å¯¹å§ã€‚</p><h2 id="LG6075"><a href="#LG6075" class="headerlink" title="LG6075"></a><a href="https://www.luogu.com.cn/problem/P6075" target="_blank" rel="noopener">LG6075</a></h2><hr><p>æ¥åšç»¿é¢˜äº†ï¼ˆã€‚å‘ç°æ¯ä¸ªå…ƒç´ æ˜¯ç‹¬ç«‹çš„ï¼Œé‚£ç®—ä¸€ä¸ªçš„è´¡çŒ®ç„¶å $n$ æ¬¡æ–¹å°±å¥½äº†ã€‚å‘ç°ä¸€ä¸ªå…ƒç´ å–ä¸ä¸å–çš„æƒ…å†µæ˜¯å·¦ä¸‹è§’å¼•ä¸€æ¡å‘å³æˆ–å‘ä¸Šçš„æŠ˜çº¿ï¼Œä¸€ç›´èµ°ç›´åˆ°åˆ°è¾¾è¾¹ç•Œï¼Œè¿™æ ·æŠ˜çº¿çš„æ–¹æ¡ˆæ•°æ˜¯ $2^k$ï¼Œæ‰€ä»¥æ€»æ–¹æ¡ˆå°±æ˜¯ $(2^k)^n$ã€‚</p><h2 id="USACO20JAN-Cave-Paintings-P"><a href="#USACO20JAN-Cave-Paintings-P" class="headerlink" title="[USACO20JAN]-Cave Paintings P"></a><a href="https://www.luogu.com.cn/problem/P6008" target="_blank" rel="noopener">[USACO20JAN]-Cave Paintings P</a></h2><hr><p>å‘ç°å¡«äº†ä¸€ä¸ªå°±è¦å¡«ä¸€å—ï¼Œæƒ³åˆ°å¹¶æŸ¥é›†ã€‚æˆ‘ä»¬ä»ä¸‹å¾€ä¸Šåˆå¹¶ï¼Œæ³¨æ„ä¸è¿é€šå—åˆå¹¶çš„æ—¶å€™ï¼Œæ–¹æ¡ˆæ•°æ˜¯ç›¸ä¹˜çš„ã€‚</p><h2 id="HNOI2015-è½å¿†æ«éŸ³"><a href="#HNOI2015-è½å¿†æ«éŸ³" class="headerlink" title="[HNOI2015]-è½å¿†æ«éŸ³"></a><a href="https://www.luogu.com.cn/problem/P3244" target="_blank" rel="noopener">[HNOI2015]-è½å¿†æ«éŸ³</a></h2><hr><p>$DAG$ çš„æ ‘å½¢å›¾ä¸ªæ•°æ˜¯ $\prod in[i]$ï¼ˆæ„Ÿæ€§ç†è§£å°±æ˜¯æ¯ä¸ªç‚¹æ‰¾ä¸€ä¸ª$fa$ï¼Œç”±äºä¸ä¼šå½¢æˆç¯ï¼Œæ€ä¹ˆæ‰¾éƒ½æ˜¯åˆç†çš„ï¼Œæ®è¯´å¯ä»¥ç”¨çŸ©é˜µæ ‘å®šç†è¯ä½†è’Ÿè’»ä¸ä¼šï¼‰ç”¨ä¸¥è°¨çš„è¯­è¨€è¡¨è¾¾ï¼Œè¿™ä¸ªå®šç†æ˜¯<strong>æœ‰å‘æ— ç¯å›¾çš„ç”Ÿæˆå¤–å‘æ ‘ä¸ªæ•°ä¸ºæ‰€æœ‰å…¥åº¦é 0 çš„ç‚¹çš„å…¥åº¦ä¹˜ç§¯</strong></p><p>å†è€ƒè™‘æœ‰ç¯çš„æƒ…å†µï¼Œæ˜¾ç„¶è¦å‡å»ä¸€äº›æœ‰ç¯å­˜åœ¨çš„çŠ¶æ€ï¼ˆè¿™ç¯ä¸€å®šåŒ…å«æ–°åŠ è¿›æ¥çš„é‚£æ¡è¾¹å•¦ï¼‰ å³ $\frac{\prod in[i]}{\prod\limits_{i\ on\ circle} in[i]}$ã€‚$dp$, $g[x]$ è¡¨ç¤ºä» $ed$ åˆ° $x$ çš„ä¸Šé¢è¿™ä¸ªä¸œè¥¿ä¹‹å’Œï¼Œæ‰€ä»¥ $g[x] = \frac{1}{in[x]}\sum\limits_y g[y]$ã€‚è®¡ç®— $g$ æ•°ç»„å¯ä»¥å»ºåå›¾ + è®°å¿†åŒ–æœç´¢ï¼ˆæ³¨æ„è¿™é‡Œæ­£åçš„æ™ºæ…§ï¼‰æ‰€ä»¥ç­”æ¡ˆå°±æ˜¯ $(\prod in[i]) - g[st]$</p>]]></content>
      
      
      
        <tags>
            
            <tag> è®¡æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[LOJ6289]-èŠ±æœµ</title>
      <link href="2020/08/19/%5BLOJ6289%5D-%E8%8A%B1%E6%9C%B5/"/>
      <url>2020/08/19/%5BLOJ6289%5D-%E8%8A%B1%E6%9C%B5/</url>
      
        <content type="html"><![CDATA[<p><a href="https://loj.ac/problem/6289" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>çœ‹å®ƒ $id$ è·Ÿæˆ‘ $loj$ $id$ ç›¸åŒå°±åšäº†åš =&gt; è°ƒäº† $3h+$ æƒ¨è´¥</p><hr><p>$upd$ï¼šé‡æ„ $AC$ å•¦= =</p><p>æ ¹æ® $dp$ æ–¹ç¨‹äº¤æ¢äºŒä¸‰ä¸¤ç»´å¯ä»¥å¾—åˆ°ï¼š<br>$$f[x, 0] = \prod (f[y, 0] + f[y, 1])$$<br>$$f[x, 1] = \prod f[y, 0]$$</p><p>å°± nm åƒçŸ©é˜µä¹˜æ³•ï¼ä½†æ˜¯ä¸Šæ ‘äº†ã€‚è¯´ä¸ªç¬‘è¯ï¼Œæš´åŠ›å·æ˜¯ $n^2logn$ çš„ï¼ˆ</p><p>éƒ¨åˆ†åˆ†çš„é“¾å’ŒèŠèŠ±å¯ç¤ºæˆ‘ä»¬è¦ä¼˜é›…çš„å·ï¼Œæ¯”å¦‚å‰–æˆé“¾ï¼Œæ¯æ¡é“¾å…ˆå•ç‹¬å·</p><p>é•¿é“¾è¿˜æ˜¯é‡é“¾å‘¢ï¼Ÿå½“ç„¶æ˜¯é‡é“¾å•¦ï¼Œä¸€æ¬¡å·ç§¯çš„æ—¶é—´å¤æ‚åº¦å–å†³äºå·çš„æ•°ç»„å¤§å°ï¼Œé•¿é“¾é‚£æ·±åº¦å·®å¯å¤§äº†ã€‚</p><p>ç»†ä¸€ç‚¹è¯´ï¼ŒæŠŠè½»é“¾ä¿¡æ¯ç”¨åˆ†æ²»å· å¹¶åˆ°è½»é“¾é¡¶ç‚¹çš„çˆ¶äº²ä¸Šï¼Œä¸€æ¬¡ $O(size(x)log^2size(x))$ï¼Œç”±äº è½»å„¿å­ç‚¹æ•°å’Œ$=\sum size(x) = O(nlogn)$ï¼Œæ‰€ä»¥æ€»å…±å°±æ˜¯ $O(nlog^3n)$ï¼›å†ç”¨åˆ†æ²»å· å·é‡é“¾ï¼Œæ€»å…± $O(nlog^2n)$ï¼ˆè¿™é‡Œè¦æ³¨æ„ï¼Œä¹‹å‰å·è½»é“¾çš„æ—¶å€™åªè¦é¡¾åŠè½»é“¾é¡¶ç‚¹å’Œçˆ¶äº²çš„ $0$/$1$ æ˜¯å¦åˆæ³•ï¼Œå·é‡é“¾çš„æ—¶å€™è¿˜è¦é¡¾åŠä¸¤éƒ¨åˆ†æ¥å£å¤„çš„ $0$/$1$ æ˜¯å¦åˆæ³•ï¼Œæ‰€ä»¥è¦ç»´æŠ¤å½“å‰æ®µçš„é¦–å°¾æ˜¯å¦ä¸º $1$ï¼‰</p><p>å°±åšå®Œå•¦ï¼Œåšåšï¼ä¸‰åª $log$ ä¸‰åª $log$ è·‘å¾—å¿«è·‘å¾—å¿« ~</p><p><a href="https://loj.ac/s/1020721" target="_blank" rel="noopener">$Code$</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> æ ‘é“¾å‰–åˆ† </tag>
            
            <tag> FFT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NOI2020ç½‘ç»œåŒæ­¥èµ›ä½“éªŒè®°</title>
      <link href="2020/08/18/NOI2020%E7%BD%91%E7%BB%9C%E5%90%8C%E6%AD%A5%E8%B5%9B%E4%BD%93%E9%AA%8C%E8%AE%B0/"/>
      <url>2020/08/18/NOI2020%E7%BD%91%E7%BB%9C%E5%90%8C%E6%AD%A5%E8%B5%9B%E4%BD%93%E9%AA%8C%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="Day1"><a href="#Day1" class="headerlink" title="$Day1$"></a>$Day1$</h2><hr><p>å‹¤å‹¤æ³æ³çš„æ‰£äº† 114 åˆ†ï¼Œå–æ¨¡é”™è¯¯ wa + å­—æ¯æ‰“é”™ï¼Œfst æˆ 82 åˆ†ã€‚ã€‚ã€‚å¥½éš¾å—å•Š</p><p>æ•´æ•´ 32 åˆ†å•Šã€‚è¿™å¦‚æœæ˜¯è”èµ›ï¼Œè°æ‹…çš„èµ·å‘¢ã€‚</p><h2 id="Day2"><a href="#Day2" class="headerlink" title="$Day2$"></a>$Day2$</h2><hr><p>å‹¤å‹¤æ³æ³çš„æŠ äº† ï¼Ÿåˆ†ï¼ˆå¯¹æˆ‘è‡ªå·±éƒ½ä¸ç¡®å®šæ­£ç¡®æ€§ï¼‰ï¼Œæ°‘é—´æ•°æ®è¿˜æ²¡å‡ºï¼ˆå‡ºäº†ä¹Ÿä¸æµ‹ qvqï¼‰</p><h2 id="å‡ºæˆç»©äº†"><a href="#å‡ºæˆç»©äº†" class="headerlink" title="å‡ºæˆç»©äº†"></a>å‡ºæˆç»©äº†</h2><hr><p>108</p><hr><p>ã€æ­¤å¤„åº”æœ‰é¢˜è§£ã€‘</p><hr><p>æ¥è¡¥äº†ã€‚</p><h2 id="D1T1-ç¾é£Ÿå®¶"><a href="#D1T1-ç¾é£Ÿå®¶" class="headerlink" title="$D1T1. ç¾é£Ÿå®¶$"></a>$D1T1. ç¾é£Ÿå®¶$</h2><p>æˆ‘æƒ³åˆ°çŸ©é˜µå¿«é€Ÿå¹‚äº†ï¼å†™å‡º $5n$ ä¸ªç‚¹çš„è½¬ç§»æŸ¿å­äº†ï¼ç”šè‡³æƒ³åˆ°é¢„å¤„ç† $2^i$ çš„çŸ©é˜µã€è¡Œå‘é‡å»ä¹˜æ˜¯ $n^2$ çš„äº†ï¼</p><p>ä½†æˆ‘æ²¡å†™å‡ºæ¥ã€‚ã€‚ã€‚å¥½å§ï¼Œä¸ä¼šå°±æ˜¯ä¸ä¼šï¼Œå¤æ‚åº¦æ˜¯ $O((5n)^3\ log\ T + (5n)^2\ log\ T \times K)$ã€‚ä½ åˆ«çœ‹ä»–æœ‰ 4e8ï¼Œäººå®¶æ˜¯ O(èƒ½è¿‡) è€¶= =</p><p>updï¼šè€ƒåœºä»£ç åˆ†æ®µä¹˜çš„æ—¶å€™é¢å¤–è´¡çŒ®åŠ é”™ä½ç½®äº†= = æˆ‘å“­</p><p><a href="https://loj.ac/submission/927790" target="_blank" rel="noopener">$Code$</a></p><h2 id="D1T2-å‘½è¿"><a href="#D1T2-å‘½è¿" class="headerlink" title="$D1T2. å‘½è¿$"></a>$D1T2. å‘½è¿$</h2><p><a href="https://imilyx.github.io/2020/09/08/%E4%BB%A5%20CF1327F%20%E4%B8%BA%E4%BB%A3%E8%A1%A8%E7%9A%84%E4%B8%80%E7%B1%BB%E9%99%90%E5%88%B6%E8%AE%A1%E6%95%B0%E9%97%AE%E9%A2%98/" target="_blank" rel="noopener">é“¾æ¥</a></p><h2 id="D1T3-æ—¶ä»£çš„çœ¼æ³ª"><a href="#D1T3-æ—¶ä»£çš„çœ¼æ³ª" class="headerlink" title="$D1T3. æ—¶ä»£çš„çœ¼æ³ª$"></a>$D1T3. æ—¶ä»£çš„çœ¼æ³ª$</h2><p>å’•å’•</p><h2 id="D2T1-åˆ¶ä½œèœå“"><a href="#D2T1-åˆ¶ä½œèœå“" class="headerlink" title="$D2T1. åˆ¶ä½œèœå“$"></a>$D2T1. åˆ¶ä½œèœå“$</h2><p>å…ˆå°† $d$ æ’åºã€‚</p><p>å‘ç°å¤§æ•°æ®èŒƒå›´é‡Œæœ‰ $n - 2 \leq m$ï¼Œéƒ¨åˆ†åˆ† $m = n - 1$ ä¼¼ä¹å¾ˆæœ‰æœªæ¥ã€‚</p><p>è€ƒè™‘éƒ¨åˆ†åˆ† $m = n - 1$ï¼Œ$d_1$ ä¸€å®šæ˜¯ $&lt; k$ çš„ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå¦‚æœ $d_1 \geq k$, é‚£ä¹ˆ $\sum d_i \geq n times k &gt; (n - 1) times k = m \times k = \sum d_i$ï¼ŒçŸ›ç›¾ã€‚æ¯æ¬¡å‰Šæ‰ç¬¬ä¸€é¡¹ï¼Œ$n$ è½¬åŒ–æˆ $n - 1$ï¼Œä¸€å®šèƒ½å¤Ÿæ„é€ å‡ºæ¥ã€‚åŒæ—¶ $d_1 + d_n \neq k$ï¼Œç”¨åè¯æ³•ä¹Ÿå¯ä»¥è¯æ˜ã€‚</p><p>è€ƒè™‘ $m \geq n$ æ—¶ï¼Œ$d_n \geq k$ï¼Œè¯æ˜æ–¹æ³•åŒä¸Šé¢ç±»ä¼¼ã€‚äºæ˜¯å°† $d_n -= k$ï¼Œ<strong>å°±è½¬åŒ–æˆäº† $m = n - 1$ çš„é—®é¢˜</strong></p><p>æœ€åä¸€æ­¥ï¼$m = n - 2$ æ€ä¹ˆæã€‚ã€‚å¯ä»¥è¯æ˜ï¼Œ$m = n - 2$ æœ‰è§£çš„å……è¦æ¡ä»¶æ˜¯å¯ä»¥åˆ’åˆ†ä¸ºä¸¤ä¸ª $m = n - 1$ çš„å­é—®é¢˜ã€‚å……åˆ†æ€§å¾ˆå¥½è¯ï¼Œå¿…è¦æ€§å°±æ¯”è¾ƒå¦™ï¼šè€ƒè™‘ä¸€ä¸ª n ä¸ªç‚¹çš„å›¾ï¼Œèœå“è§†ä¸ºè¾¹ï¼Œé‚£ä¹ˆæœ€å¤šåªæœ‰ n - 2 æ¡è¾¹ï¼Œä¸ä¼šè¿é€šï¼Œæ­¤æ—¶å¿…ç„¶å­˜åœ¨è‡³å°‘ä¸¤ä¸ªè¿é€šå—æ˜¯æ ‘çš„å½¢æ€â€”â€”ä¸ºä»€ä¹ˆï¼Ÿå¦‚æœæ˜¯ç¯ï¼Œè¾¹å°±ä¸å¤Ÿç”¨äº†ã€‚</p><p>å®ç°çš„è¯ï¼Œè®¾ $S$ æ˜¯åˆ†å‡ºæ¥çš„é›†åˆä¹‹ä¸€ï¼Œ$sz = |S|$, é‚£ä¹ˆ $\sum\limits_{i \in S} d_i = (sz - 1) \times k$ï¼Œ$\sum\limits_{i \in S} (d_i - k) = -k$ï¼Œè¿™æ˜¯ä¸ª dpï¼Œ$f[i, j]$ è¡¨ç¤ºå‰ i ä¸ªä»»æ„å–èƒ½å¦ä½¿å¾—æ€»å’Œä¸º jï¼Œbitset ç»´æŠ¤, $O(\frac{n \times (n \times k)}{w})$</p><p><a href="https://loj.ac/submission/927794" target="_blank" rel="noopener">$Code$</a></p><h2 id="D2T2-è¶…ç°å®æ ‘"><a href="#D2T2-è¶…ç°å®æ ‘" class="headerlink" title="$D2T2. è¶…ç°å®æ ‘$"></a>$D2T2. è¶…ç°å®æ ‘$</h2><p>è¿™é¢˜å¥½ AT çš„æ ·å­ï¼Œç»“æœæ˜¯é“ç»“è®ºé¢˜ï¼ˆè„‘å­ä¸å¥½ æ­»ä¹Ÿæƒ³ä¸å‡ºå•Šã€‚ã€‚</p><p><a href="https://www.luogu.com.cn/blog/startd/solution-p6776" target="_blank" rel="noopener">å¤§ä½¬æ€è·¯</a></p><p>â€œå‡ ä¹å®Œå¤‡â€è¿™ç§å…³ç³»å¯ä»¥ä¼ é€’ã€‚å¤ªå¦™äº†å§ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</p><p><a href="https://loj.ac/submission/927797" target="_blank" rel="noopener">$Code$</a></p><h2 id="D2T3-ç¿»ä¿®é“è·¯"><a href="#D2T3-ç¿»ä¿®é“è·¯" class="headerlink" title="$D2T3. ç¿»ä¿®é“è·¯$"></a>$D2T3. ç¿»ä¿®é“è·¯$</h2><p>å’•å’•</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 659 Div1</title>
      <link href="2020/08/15/Codeforces%20Round%20659%20Div1/"/>
      <url>2020/08/15/Codeforces%20Round%20659%20Div1/</url>
      
        <content type="html"><![CDATA[<p>æœ€è¿‘çš„åœºå­ï¼Œåšä¸€ä¸‹ã€‚</p><h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><hr><p>è´ªå¿ƒå°±å¥½äº†ï¼Ÿä¹Ÿå¯ä»¥å¹¶æŸ¥é›†ç»´æŠ¤ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> T, n, num[<span class="number">30</span>][<span class="number">30</span>];</span><br><span class="line"><span class="keyword">char</span> a[N], b[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s%s"</span>, a + <span class="number">1</span>, b + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">bool</span> ff = <span class="number">1</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) <span class="keyword">if</span> (a[i] &gt; b[i]) &#123; ff = <span class="number">0</span>; <span class="keyword">break</span>; &#125;</span><br><span class="line">        <span class="keyword">if</span> (!ff) &#123; <span class="built_in">puts</span>(<span class="string">"-1"</span>); <span class="keyword">continue</span>; &#125;</span><br><span class="line">        <span class="built_in">memset</span>(num, <span class="number">0</span>, <span class="keyword">sizeof</span>(num));</span><br><span class="line">        rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i] != b[i])</span><br><span class="line">                num[a[i] - <span class="string">'a'</span>][b[i] - <span class="string">'a'</span>]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        rep(i, <span class="number">0</span>, <span class="number">25</span>) &#123;</span><br><span class="line">            rep(j, i + <span class="number">1</span>, <span class="number">25</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (num[i][j]) &#123;</span><br><span class="line">                    ++ans;</span><br><span class="line">                    num[i][j] = <span class="number">0</span>;</span><br><span class="line">                    rep(k, j + <span class="number">1</span>, <span class="number">25</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (num[i][k]) &#123;</span><br><span class="line">                            num[j][k] += num[i][k], num[i][k] = <span class="number">0</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><hr><p>å‘ç°å¦‚æœæœ‰ä¸€ä½ 1 çš„ä¸ªæ•°æ˜¯å¥‡æ•°å°±å¿…ç„¶ä¸ä¼šå¹³å±€ï¼Œç„¶ååˆ†ç±»è®¨è®ºå°±å¥½äº†ã€‚</p><h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><hr><p>C å’Œ A çš„åŒºåˆ«åœ¨äº C æœ‰ç¯ã€‚</p><h2 id="D"><a href="#D" class="headerlink" title="D"></a>D</h2><hr><h2 id="E"><a href="#E" class="headerlink" title="E"></a>E</h2><hr>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>APIO2020 ä½“éªŒè®°</title>
      <link href="2020/08/15/APIO2020%20%E4%BD%93%E9%AA%8C%E8%AE%B0/"/>
      <url>2020/08/15/APIO2020%20%E4%BD%93%E9%AA%8C%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p>å¹³å¿ƒè€Œè®ºï¼Œè¿™ä¸€åœºçš„æš´åŠ›å¹¶ä¸æ¯” APIO2019 å°‘å¾ˆå¤šï¼Œæ‰€ä»¥å¦‚æœç­–ç•¥ä¸å¤±è¯¯çš„è¯å‡ ååˆ†æ˜¯è‚¯å®šæœ‰çš„ã€‚ä½†æ˜¯ä¸€ç›´åœ¨åˆš T1ï¼ŒæœŸé—´çŸ­æš‚çš„æ€è€ƒè¿‡ T2ï¼ŒT1 ä¸çŸ¥é“æ˜¯ä»€ä¹ˆæ¶å¿ƒæ•°æ®æŠŠæˆ‘å¡äº†= = äºæ˜¯å°±çˆ† 0 äº† æ²¡æœ‰ä½“ä¼šåˆ°æ‹¿åˆ†çš„å¿«æ„Ÿ</p><p>æ‰€ä»¥<strong>ç­–ç•¥</strong>æ˜¯å¤šä¹ˆé‡è¦å•Šï¼Œ<strong>å¼€é¢˜é¡ºåº</strong>ä¸ä¼šæ°¸è¿œæ˜¯ 1-&gt;2-&gt;3 çš„å•Šã€‚</p><p>ä¸‹é¢å°±æ”¾ä¸€äº›è®¢æ­£çš„é¢˜è§£å§ã€‚</p><h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><hr><p>é¢„å¤„ç† + å•è°ƒé˜Ÿåˆ—ï¼Œæœ€ä¼˜æ€§é—®é¢˜ -&gt; åˆ¤å®šæ€§é—®é¢˜</p><p>ç”±äºä¿è¯äº† $\sum f(k)^2 \leq 4e5$ï¼Œæ‰€ä»¥ $max(f(k))$ æœ€å¤§å°± 600 å¤šï¼Œè™½ç„¶å¾ˆç²—ç³™ä½†è¿™æ˜¯æˆ‘ä»¬å¾—åˆ°çš„æœ€ä¸ºæœ‰æ•ˆçš„ä¿¡æ¯</p><p>åªè®²é¢„å¤„ç†ã€‚$dp[i, j]$ è¡¨ç¤ºåˆ°ä½ç½® $i$ã€æ‰¿åŒ…å•† $j$ çš„æœ€å¤§ç²‰åˆ·é•¿åº¦ï¼Œ$dp[i, j] \geq m$ é‚£ $[i - m + 1, i]$ å°±èƒ½è¢«ç²‰åˆ·ã€‚</p><p>$dp[i, j] = dp[i - 1, (j - 1 + m)\ %\ m] + 1(j \in c_i)$ï¼Œè¿™æ ·æ—¶ç©ºéƒ½æ˜¯ $O(nm)$ çš„ï¼Œç©ºé—´å¯ä»¥æ»šåŠ¨æ•°ç»„ä¼˜åŒ–ï¼Œæ—¶é—´å¯ä»¥ç”¨ $vector$ å­˜æ¯ä¸ªä½ç½®åˆæ³•çš„ $j$ï¼Œè¿™æ ·å¤§æ¦‚æ˜¯ $O(n * max(f(k)))$ï¼Œç¨³å¾—å¾ˆ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"paint.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>, M = <span class="number">5e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, K, C[N], A[M], B[N], f[<span class="number">2</span>][M], dp[N], q[N], l, r;</span><br><span class="line"><span class="keyword">bool</span> valid[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; c, a, id[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &gt; b;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">minimumInstructions</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m, <span class="keyword">int</span> K, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; c, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &gt; b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">0</span>, m - <span class="number">1</span>) &#123;</span><br><span class="line">        rep(j, <span class="number">0</span>, a[i] - <span class="number">1</span>) &#123;</span><br><span class="line">            id[b[i][j]].push_back(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">0</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        x ^= <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; id[c[i - <span class="number">2</span>]].size(); k++) &#123;</span><br><span class="line">                <span class="keyword">int</span> j = id[c[i - <span class="number">2</span>]][k];</span><br><span class="line">                f[x][j] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; id[c[i]].size(); k++) &#123;</span><br><span class="line">            <span class="keyword">int</span> j = id[c[i]][k];</span><br><span class="line">            f[x][j] = f[x ^ <span class="number">1</span>][(j - <span class="number">1</span> + m) % m] + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (f[x][j] &gt;= m) valid[i] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(dp));</span><br><span class="line">    dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    q[l = r = <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r &amp;&amp; q[l] &lt; i - m) ++l;</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= r &amp;&amp; valid[i - <span class="number">1</span>]) dp[i] = dp[q[l]] + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r &amp;&amp; dp[q[r]] &gt;= dp[i]) --r;</span><br><span class="line">        q[++r] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (dp[n] &gt; <span class="number">1e9</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">return</span> dp[n];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><hr><p>æ±‚çš„æ˜¯æœ€å°éé“¾çŠ¶ç“¶é¢ˆè·¯ï¼Œå¯ä»¥åœ¨æ±‚æœ€å°ç“¶é¢ˆè·¯çš„ç®—æ³•â€”â€”$kruskal$é‡æ„æ ‘ä¸Šç•¥ä½œä¿®æ”¹ã€‚</p><p>å…·ä½“æ¥è¯´ï¼ŒåŠ è¾¹çš„æ—¶å€™å°±ä¸è¦èˆå¼ƒè¾¹äº†ï¼Œéƒ½åŠ ä¸Šã€‚è€ƒè™‘$kruskal$é‡æ„æ ‘çš„æ€§è´¨ï¼Œä¸€ä¸ªç‚¹æƒä¸º $w$ çš„èŠ‚ç‚¹å­æ ‘å†…çš„ç‚¹ç»„æˆä¸€ä¸ªè¾¹æƒä¸è¶…è¿‡ $w$ çš„è¿é€šå—ã€‚å¯¹äºæ¯ä¸ªé‡æ„æ ‘ä¸Šçš„èŠ‚ç‚¹ï¼Œç»´æŠ¤ä¸€ä¸ªæ ‡è®°è¡¨ç¤ºå®ƒå¯¹åº”çš„è¿é€šå—æ˜¯å¦æ˜¯éé“¾çŠ¶è·¯ã€‚éé“¾çŠ¶è·¯çš„å…³ç³»å¯ä»¥ä¼ é€’ï¼Œå³å¦‚æœå„¿å­çš„æ ‡è®° $= 1$ é‚£ä¹ˆçˆ¶äº²çš„æ ‡è®°ä¹Ÿ $= 1$ã€‚æ¯æ¬¡è¯¢é—®å€å¢æ‰¾ç¬¬ä¸€ä¸ªæ ‡è®° $= 1$ çš„ç‚¹ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"swap.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, Q, U[N], V[N], W[N], f[N][<span class="number">21</span>], fa[N], idx, deg[N], dep[N], val[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; u, v, w, g[N];</span><br><span class="line"><span class="keyword">bool</span> mark[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span> <span class="keyword">int</span> x, y, z; &#125;e[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fa[x] == x ? x : fa[x] = getfa(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(edge a, edge b)</span> </span>&#123; <span class="keyword">return</span> a.z &lt; b.z; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[x].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = g[x][i];</span><br><span class="line">        dep[y] = dep[x] + <span class="number">1</span>;</span><br><span class="line">        dfs(y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Kruskal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) fa[i] = i;</span><br><span class="line">    sort(e + <span class="number">1</span>, e + m + <span class="number">1</span>, cmp);</span><br><span class="line">    idx = n;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = getfa(e[i].x), y = getfa(e[i].y), z = e[i].z;</span><br><span class="line">        ++idx;</span><br><span class="line">        <span class="keyword">if</span> (x == y) &#123;</span><br><span class="line">            val[idx] = z;</span><br><span class="line">            f[x][<span class="number">0</span>] = idx;</span><br><span class="line">            fa[x] = fa[idx] = idx;</span><br><span class="line">            mark[idx] = <span class="number">1</span>;</span><br><span class="line">            g[idx].push_back(x);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            val[idx] = z;</span><br><span class="line">            f[x][<span class="number">0</span>] = f[y][<span class="number">0</span>] = idx;</span><br><span class="line">            fa[x] = fa[y] = fa[idx] = idx;</span><br><span class="line">            <span class="keyword">if</span> (mark[x] || mark[y] || (++deg[e[i].x]) &gt; <span class="number">2</span> || (++deg[e[i].y]) &gt; <span class="number">2</span>)  <span class="comment">// å­æ ‘ä¸­å­˜åœ¨éé“¾çŠ¶å—</span></span><br><span class="line">                mark[idx] = <span class="number">1</span>;</span><br><span class="line">            g[idx].push_back(x), g[idx].push_back(y);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    mark[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    rep(j, <span class="number">1</span>, <span class="number">19</span>)</span><br><span class="line">        rep(i, <span class="number">1</span>, idx)</span><br><span class="line">            f[i][j] = f[f[i][j - <span class="number">1</span>]][j - <span class="number">1</span>];</span><br><span class="line">    dep[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    dfs(idx);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> nn, <span class="keyword">int</span> mm,</span></span></span><br><span class="line"><span class="function"><span class="params">          <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; u, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v, <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; w)</span> </span>&#123;</span><br><span class="line">    n = nn, m = mm;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">        e[i + <span class="number">1</span>] = (edge)&#123;u[i] + <span class="number">1</span>, v[i] + <span class="number">1</span>, w[i]&#125;;</span><br><span class="line">    Kruskal();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[x] &lt; dep[y]) swap(x, y);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">19</span>; i &gt;= <span class="number">0</span>; --i)</span><br><span class="line">        <span class="keyword">if</span> (dep[f[x][i]] &gt;= dep[y]) x = f[x][i];</span><br><span class="line">    <span class="keyword">if</span> (x == y) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">19</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">if</span> (f[x][i] != f[y][i]) x = f[x][i], y = f[y][i];</span><br><span class="line">    <span class="keyword">return</span> f[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getMinimumFuelCapacity</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> xy = lca(++x, ++y);</span><br><span class="line">    <span class="keyword">if</span> (mark[xy]) <span class="keyword">return</span> val[xy];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">19</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">if</span> (!mark[f[xy][i]]) xy = f[xy][i];</span><br><span class="line">    xy = f[xy][<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">return</span> xy ? val[xy] : <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><hr><p>å’•å’•ï¼Ÿ</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XJOI200814 é¢˜è§£</title>
      <link href="2020/08/14/XJOI200814%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/08/14/XJOI200814%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©èµ› 1 æ˜¯è”èµ›éš¾åº¦ã€‚æ„Ÿåˆ°è‡ªå·±æœ‰å¾ˆå¤šä¸è¶³ã€‚</p><p>èµ›2ï¼šä»€ä¹ˆå«åšä¹±æå•Š /kk</p><p><a href="http://115.236.49.52:83/contest/1587" target="_blank" rel="noopener">èµ›1</a>    <a href="http://115.236.49.52:83/contest/1588" target="_blank" rel="noopener">èµ›2</a></p><h2 id="1A"><a href="#1A" class="headerlink" title="1A"></a>1A</h2><hr><p>æ²¡æƒ³å‡ºæ¥ä½†è¿™ç§é¢˜æœ‰å¯èƒ½ä¼šå‡ºç°åœ¨æ­£å¼èµ›åœºä¸Šï¼Œ<strong>æ‰€ä»¥è¦ä¼šä¹±æå•Šï¼</strong></p><p>æ­£è§£å°±æ˜¯é€‰å‡º K / m ä¸ªæ•´è¡ŒåŠ ä¸Š K % m ä¸ªåœ¨åŒä¸€è¡Œçš„å…ƒç´ ã€‚</p><p>æœ‰ä¸ªä¼ªè¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(a, b, c, d), e, f</span><br><span class="line">(h, i, j), k, l, m</span><br><span class="line"></span><br><span class="line">åˆ’äº†æ‹¬å·çš„æ˜¯é€‰çš„ã€‚</span><br><span class="line">1. j = e é‚£ä¹ˆä¸é€‰ (i, j) æ”¹é€‰ (e, f) ä¸ä¼šæ›´åŠ£</span><br><span class="line">2. j &gt; e ä¸é€‰ (i, j) æ”¹é€‰ (e, f)</span><br><span class="line">3. j &lt; e é‚£ä¹ˆ b &gt;= c &gt;= d &gt;= e &gt; j &gt;= k &gt;= l &gt;= mï¼Œä¸é€‰ (b, c, d) æ”¹é€‰ (k, l, m)</span><br><span class="line">æ‰€ä»¥å¤§æ¦‚å¯ä»¥è¯´æ˜ä¸¤è¡Œå¯ä»¥åˆå¹¶æˆä¸€è¡Œï¼Œå³å¿…é¡»å–æ»¡å…¶ä¸­ä¸€è¡Œã€‚</span><br></pre></td></tr></table></figure><h2 id="1B"><a href="#1B" class="headerlink" title="1B"></a>1B</h2><hr><p>å›¾è®ºä»Šå¤©çœŸçš„è¦åˆ·èµ·æ¥äº†ï¼Œè¿™é¢˜ lca æä¸€æå°±å¥½äº†å•Šï¼éƒ½å¿˜å…‰äº†ã€‚ã€‚ã€‚æ ‘ä¸Šè·¯å¾„å°±æ˜¯åˆ° lca çš„è·¯å¾„å•Šã€‚ã€‚ã€‚</p><p>é‚£ä¹ˆåˆ†ä¸¤ç§æƒ…å†µï¼š</p><ul><li>$lca(c, d)$ åœ¨ $lca(a, b)$ å­æ ‘ä¸­ï¼šå‘ç° $lca(c, d)$ ä¸åœ¨ $a$ åˆ° $b$ è·¯å¾„ä¸Šå³å¯</li><li>$lca(c, d)$ ä¸åœ¨ $lca(a, b)$ å­æ ‘ä¸­ï¼š$c$ åˆ° $d$ çš„è·¯å¾„ä¸ç»è¿‡è¿æ¥ $lca(a, b)$ å’Œ $fa[lca(a, b)]$ çš„è¾¹å³å¯</li></ul><p>äºæ˜¯é¢„å¤„ç†ä¸€æ³¢å°±å¯ä»¥äº†ã€‚</p><p>ï¼ˆxjæ•°æ®æ°´ï¼Œæˆ‘ä¸€ä¸ª $O(n(nq + n^2))$ çš„æš´åŠ›è·‘è¿‡å»äº†ã€‚ã€‚ã€‚ã€‚ï¼‰</p><h2 id="1C"><a href="#1C" class="headerlink" title="1C"></a>1C</h2><hr><p>ç¥ä»™æ„é€ ï¼ˆnoipè€ƒæ„é€ å—ï¼‰æ˜¾ç„¶ $S &gt; \frac{n(n - 1)}{2}$ çš„æ—¶å€™æ— è§£ã€‚ç„¶åè¿˜ä¸ä¼šã€‚ã€‚å’•å’•</p><h2 id="2A"><a href="#2A" class="headerlink" title="2A"></a>2A</h2><hr><p>è¿™å¾ˆ Atcoder å•Šã€‚ã€‚ç¥ä»™æ„é€  + å¤§ä¹±æé¢˜ï¼Ÿå’•å’•</p><h2 id="2B"><a href="#2B" class="headerlink" title="2B"></a>2B</h2><hr><p>ç«Ÿç„¶ç»™æˆ‘ä¹±æå‡ºæ¥äº†ï¼è€ƒè™‘æ“ä½œåºåˆ—æ˜¯å½¢å¦‚ $(((S + k_1a)b + k_2a)b + k_3a)b + â€¦$ è¿™æ ·çš„ã€‚æˆ‘ä»¬æšä¸¾æœ‰å‡ ä¸ª $b$ï¼ˆæ˜¾ç„¶åªæœ‰ log ç§ï¼‰ï¼Œå°±å˜æˆç±»ä¼¼äºè¿›åˆ¶ï¼Œæ‰€ä»¥è¦è®© $\sum_i k_i$ æœ€å°ï¼Œåªè¦â€œèƒ½å‡åˆ™å‡â€å°±å¯ä»¥äº†ã€‚</p><p>â€”åˆ†å‰²çº¿â€”</p><p>æˆ‘é”™äº†ã€‚è¿™é¢˜æ²¡æœ‰ä¸€ç‚¹ç´ è´¨ï¼Œå®ƒçš„é‡ç‚¹æ ¹æœ¬å°±æ˜¯åˆ†ç±»è®¨è®ºï¼Œæˆ‘åäº† æ€åšé¢˜ğŸ’¢</p><p>!s   !t   s &lt; t   !a   !b   b = 1 è¿™äº›ä½ éƒ½åˆ¤äº†å—</p><h2 id="2C"><a href="#2C" class="headerlink" title="2C"></a>2C</h2><hr><p>å‚»äº†å‚»äº†ï¼Œæšä¸¾<strong>ç¬¬ä¸€ä¸ª</strong>aã€bã€cå‡ºç°çš„ä½ç½®å°±å¥½äº†å‘—ï¼è¿™æ˜¯ $O(n^3)$ çš„ï¼Œç„¶å $O(n^2)$ çš„ç”¨æ ‘çŠ¶æ•°ç»„ç»´æŠ¤å°±å¥½äº†ï¼ˆï¼Ÿ</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¨¡æ‹Ÿèµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XJOI200813 é¢˜è§£</title>
      <link href="2020/08/13/XJOI200813%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/08/13/XJOI200813%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>åˆæ˜¯ä¸€å¤©ä¸¤åœºçš„ XJOI noi æ¨¡æ‹Ÿèµ›ï¼Œæ¯å¤©éƒ½æ˜¯æš´åŠ›é€‰æ‰‹ è¢«åŠç€æ‰“ /kk</p><p><a href="http://115.236.49.52:83/contest/1583" target="_blank" rel="noopener">èµ›1</a>    <a href="http://115.236.49.52:83/contest/1585" target="_blank" rel="noopener">èµ›2</a></p><h2 id="1A"><a href="#1A" class="headerlink" title="1A"></a>1A</h2><hr><p>å†™äº† $n^2$ çš„ dpï¼Œä¸€éè¿‡æ ·ä¾‹å¥½è¯„ï¼ˆã€‚ï¼‰æ­£è§£æ˜¯ dp ä¼˜åŒ–ï¼Œç„¶è€Œè¿™é¢˜ dp æœ‰å¾ˆå¤šç§ï¼Œæˆ‘è¿™ç§æ²¡æ³•ä¼˜åŒ–çš„æ ·å­ï¼ˆçœ‹èµ·æ¥å¾ˆç¬¨ï¼ï¼‰</p><p><a href="https://www.cnblogs.com/Flying2018/p/13498384.html" target="_blank" rel="noopener">æ¥çœ‹çœ‹flying2018å¤§ä½¬çš„é¢˜è§£</a></p><h2 id="1B"><a href="#1B" class="headerlink" title="1B"></a>1B</h2><hr><p>æš´åŠ›æ²¡å†™å°±ç‰¹åˆ«ä¸åº”è¯¥ã€‚æ¨¡å¹¶ä¸ä¼šå¯¹æ­£ç¡®æ€§æœ‰å½±å“ã€‚ã€‚ã€‚30åˆ†è¿˜æ˜¯å¾ˆå¥½æ‹¿åˆ°çš„ã€‚è€ƒè™‘ $gcd = 1$ çš„é‚£æ¡£å­åˆ†ï¼Œç”»ä¸€ç”»å›¾æ‰¾è§„å¾‹å°±å¥½äº†å‘—ï¼Œ60åˆ†ä¹Ÿä¸éš¾å•Šã€‚</p><h2 id="1C"><a href="#1C" class="headerlink" title="1C"></a>1C</h2><hr><p>60åˆ†è¿™ä¹ˆé¦™ä½ ä¸ºä»€ä¹ˆä¸å†™ï¼Ÿå•Šï¼Ÿå•Šï¼Ÿï¼Ÿå•Šï¼Ÿï¼Ÿï¼$T = 2$ dp, $f[i, j]$ è¡¨ç¤ºç¬¬ $i$ ä¸ªåŒºé—´èƒ½å¦å’Œç¬¬ $i + 1$ ä¸ªåŒºé—´äº¤æ¢ï¼›$l_i = i$ çš„é‚£æ¡£å­åˆ†æ‰“ä¸ªè¡¨æ‰¾è§„å¾‹å°±å‡ºæ¥äº†ï¼Œ$g[i] = 2g[i - 1] + i - 2$</p><h2 id="2A"><a href="#2A" class="headerlink" title="2A"></a>2A</h2><hr><p>é¢˜ç›®å¥½åƒå‡ºé”…äº†ï¼Œå’•å’•</p><h2 id="2B"><a href="#2B" class="headerlink" title="2B"></a>2B</h2><hr><p>ä¸ä¼šï¼Œå’•å’•</p><p>â€”åˆ†å‰²çº¿â€”</p><p>æ¥è®¢æ­£äº†ã€‚æ€ç»´æœ‰ç‚¹éš¾åº¦ä½†å¹¶ä¸æ˜¯å¾ˆæ¯’çš„å›¾è®ºé¢˜ï¼Œå›¾è®ºæˆ‘å¤ªèœäº†å•Š /kk ä¸“é¢˜è¦åˆ·èµ·æ¥äº†ï¼</p><p>æ˜¾ç„¶æ“ä½œäºŒå’Œä¸‰å»ºåå›¾é¢„å¤„ç†ä¸€æ³¢å°±å¥½äº†ï¼Œéš¾ç‚¹åœ¨æ“ä½œä¸€ã€‚åŸé¢˜æ˜¯ <a href="https://www.luogu.com.cn/problem/P3573" target="_blank" rel="noopener">[POI2014]RAJ-Rally</a></p><p>è€ƒè™‘ DAG çš„æ€§è´¨ã€‚è®¾ x çš„æ‹“æ‰‘åºä¸º dfn[x], å¯¹äºä¸€æ¡è¾¹ (x, y) æ˜¾ç„¶ dfn[x] &lt; dfn[y]ã€‚å¼ºåˆ¶èµ° (x, y) çš„è¯æ˜¾ç„¶æ‹“æ‰‘åºåœ¨ dfn[x] ~ dfn[y] ä¹‹é—´çš„ç‚¹éƒ½ä¸ä¼šç»è¿‡ï¼Œäºæ˜¯æƒ³åˆ°ç”¨ (x, y) æ¥æ›´æ–°é‚£äº›ç‚¹ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œè®¾æ‹“æ‰‘åºæ¯” x å°çš„é›†åˆä¸º Aï¼Œæ¯” x å¤§çš„é›†åˆä¸º Bï¼Œä»¥ x ä¸ºç»ˆç‚¹çš„æœ€é•¿è·¯å¾„ä¸º dt[x]ï¼Œä¸ºèµ·ç‚¹çš„æœ€é•¿è·¯å¾„ä¸º ds[x], $f[x] = \max\limits_{(u, v) \in E, u \in A, v \in B}(dt[u] + 1 + ds[v])$</p><p>é¢„å¤„ç†è¿™ä¸ª f, å‘ç°æ¯æ¬¡ x å¢å¤§ï¼ŒA åªä¼šå¤šä¸€ä¸ªæ•°ï¼ŒB åªä¼šå°‘ä¸€ä¸ªæ•°ï¼Œå¯ä»¥åŠ¨æ€ç»´æŠ¤æœ€å¤§å€¼ã€‚</p><p><a href="https://www.luogu.com.cn/blog/ButterflyDew/solution-p3573" target="_blank" rel="noopener">è¿™ç¯‡åšå®¢çš„å›¾éå¸¸æ¸…æ™°ï¼Œå¯ä»¥å¸®åŠ©ç†è§£åŠ¨æ€ç»´æŠ¤çš„è¿‡ç¨‹</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, K;</span><br><span class="line"><span class="keyword">int</span> degt[N], degs[N], dt[N], ds[N], ans[N], id[N], tot;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span> <span class="keyword">int</span> x, y; &#125;e[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; gt[N], gs[N];</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"><span class="built_in">multiset</span>&lt;<span class="keyword">int</span>&gt; s;</span><br><span class="line"><span class="built_in">multiset</span>&lt;<span class="keyword">int</span>&gt;::iterator it;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; K;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        e[i].x = x, e[i].y = y;</span><br><span class="line">        degt[y]++, degs[x]++;</span><br><span class="line">        gt[x].push_back(y), gs[y].push_back(x);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="keyword">if</span> (!degt[i]) q.push(i);</span><br><span class="line">    <span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front(); q.pop();</span><br><span class="line">        id[++tot] = x;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; gt[x].size(); i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = gt[x][i];</span><br><span class="line">            dt[y] = max(dt[y], dt[x] + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (!(--degt[y])) q.push(y);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="keyword">if</span> (!degs[i]) q.push(i);</span><br><span class="line">    <span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front(); q.pop();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; gs[x].size(); i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = gs[x][i];</span><br><span class="line">            ds[y] = max(ds[y], ds[x] + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (!(--degs[y])) q.push(y);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    rep(i, <span class="number">1</span>, n) s.insert(ds[i]);</span><br><span class="line">    rep(o, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = id[o];</span><br><span class="line">        s.erase(s.find(ds[x]));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; gs[x].size(); i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = gs[x][i];</span><br><span class="line">            s.erase(s.find(ds[x] + <span class="number">1</span> + dt[y]));</span><br><span class="line">        &#125;</span><br><span class="line">        ans[x] = *s.rbegin();</span><br><span class="line">        s.insert(dt[x]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; gt[x].size(); i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = gt[x][i];</span><br><span class="line">            s.insert(dt[x] + <span class="number">1</span> + ds[y]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (K--) &#123;</span><br><span class="line">        <span class="keyword">int</span> ty, x; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;ty, &amp;x);</span><br><span class="line">        <span class="keyword">if</span> (ty == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[x]);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (ty == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, dt[x] + ds[x]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, dt[e[x].x] + ds[e[x].y] + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2C"><a href="#2C" class="headerlink" title="2C"></a>2C</h2><hr><p>min25ç­›å’Œæš´æœå‡å¯ ACï¼ˆé›¾ï¼‰ä¸ä¼š min25 å°±åªèƒ½å†™æš´æœå•¦ï¼</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line">ll n, P;</span><br><span class="line">ll mark[N], p[N], tot, cnt[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">2</span>, n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!mark[i]) p[++tot] = i, cnt[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; i * p[j] &lt;= n; j++) &#123;</span><br><span class="line">            mark[i * p[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">2</span>, n) cnt[i] += cnt[i - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(ll x, ll t)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (t &gt; tot || x * p[t] &gt; n) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (x * p[t] * p[t] &gt; n) <span class="keyword">return</span> cnt[min(P, n / x)] - t + <span class="number">2</span>;  <span class="comment">// ä¼˜ç§€çš„å‰ªæä»¬</span></span><br><span class="line">    ll ret = dfs(x, t + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (; x * p[t] &lt;= n; ) &#123;</span><br><span class="line">        x *= p[t];</span><br><span class="line">        ret += dfs(x, t + <span class="number">1</span>);</span><br><span class="line">        x *= p[t];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; P;</span><br><span class="line">    sieve(P);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, dfs(<span class="number">1</span>, <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¨¡æ‹Ÿèµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XJOI200812 é¢˜è§£</title>
      <link href="2020/08/12/XJOI200812%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/08/12/XJOI200812%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>ä¸§å¿ƒç—…ç‹‚ï¼Œæ‰“äº†ä¸¤åœºæï¼ˆnï¼‰é«˜ï¼ˆoï¼‰ç»„ï¼ˆiï¼‰æ¨¡æ‹Ÿèµ›ã€‚ã€‚ã€‚ä¸€å¤©å°±è¿™ä¹ˆæ²¡äº†ã€å“­ã€‘</p><p><a href="http://115.236.49.52:83/contest/1578" target="_blank" rel="noopener">èµ›1</a>    <a href="http://115.236.49.52:83/contest/1579" target="_blank" rel="noopener">èµ›2</a></p><h2 id="1A"><a href="#1A" class="headerlink" title="1A"></a>1A</h2><hr><p>ä¸ç”¨ Boruvkaï¼Œç›´æ¥ Kruskalï¼Œä»å¤§åˆ°å°æšä¸¾è¾¹æƒç„¶åèƒ½è¿åˆ™è¿ã€‚</p><h2 id="1B"><a href="#1B" class="headerlink" title="1B"></a>1B</h2><hr><p>ç¥ä»™é¢˜ï¼ï¼ˆä¹Ÿå¯èƒ½åªæ˜¯æˆ‘ä¸ä¼šçº¿æ€§ä»£æ•°Â¯_(ãƒ„)_/Â¯ï¼‰åŸé¢˜æ˜¯ <a href="https://www.luogu.com.cn/problem/CF388D" target="_blank" rel="noopener">CF388D</a></p><p>è€ƒè™‘å¼‚æˆ– ä¸€èˆ¬æ¥è¯´ å°±æ˜¯ Trie å’Œçº¿æ€§åŸº</p><p>è¯¶ï¼Ÿçº¿æ€§åŸºå¥½åƒå¯ä»¥ï¼æœ¬é¢˜ç›¸å½“äºç»™ä¸€ç»„çº¿æ€§åŸºå°±èƒ½äº§ç”Ÿä¸€å †å¼‚æˆ–å€¼ï¼Œçº¿æ€§åŸºå’Œå¼‚æˆ–å€¼å…±åŒç»„æˆé›†åˆ</p><p>ä¸€ç»„çº¿æ€§åŸºå¯¹åº”ä¸€ä¸ªé›†åˆï¼Œä½†<strong>ä¸€ä¸ªé›†åˆå¯ä»¥æœ‰å¤šç»„çº¿æ€§åŸº</strong>ï¼Œå¦‚æœèƒ½è®©é›†åˆå’Œçº¿æ€§åŸºä¸€ä¸€å¯¹åº”ï¼Œé›†åˆçš„è®¡æ•°å°±è½¬åŒ–æˆäº†çº¿æ€§åŸºçš„è®¡æ•°</p><p>æ ¹æ®â€œç‰¹å¾ç‚¹â€çš„æ€æƒ³ï¼Œæˆ‘ä»¬å¯¹æ¯ç»„çº¿æ€§åŸºé«˜æ–¯æ¶ˆå…ƒã€‚å¯ä»¥è¯æ˜é«˜æ¶ˆåï¼Œä¸åŒçš„çº¿æ€§åŸºç”Ÿæˆçš„é›†åˆä¸€å®šä¸åŒã€‚</p><p>æ¥ä¸‹æ¥å¯¹çº¿æ€§åŸºåš dp å°±å¥½äº†ã€‚æ³¨æ„ï¼Œé«˜æ¶ˆåçº¿æ€§åŸºèƒ½å¼‚æˆ–å‡ºæ¥çš„æœ€å¤§å€¼å°±æ˜¯æ‰€æœ‰å…ƒç´ çš„å¼‚æˆ–å€¼</p><p>dp çš„çŠ¶æ€è®¾è®¡ï¼šdp[i, j, k] è¡¨ç¤ºä»æœ€é«˜ä½åˆ°ç¬¬ i ä½é€‰äº† j ä¸ªåŸºï¼Œå¼‚æˆ–å¾—åˆ°çš„æœ€å¤§å€¼æ˜¯å¦é¡¶åˆ°ä¸Šç•Œï¼ˆæ˜¯åˆ™ k = 1ï¼Œå¦åˆ™ k = 0ï¼‰æœ‰ç‚¹ç±»ä¼¼äºæ•°ä½ dp</p><p><a href="https://blog.csdn.net/C202044zxy/article/details/106119810" target="_blank" rel="noopener">ç»†èŠ‚</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, dp[<span class="number">32</span>][<span class="number">32</span>][<span class="number">2</span>], ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(ll &amp;x, ll y)</span> </span>&#123; x = (x + y) % mod; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    dp[<span class="number">30</span>][<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">30</span>; i &gt;= <span class="number">1</span>; i--) &#123;</span><br><span class="line">        rep(j, <span class="number">0</span>, <span class="number">30</span> - i + <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="comment">// k = 0</span></span><br><span class="line">            add(dp[i - <span class="number">1</span>][j][<span class="number">0</span>], dp[i][j][<span class="number">0</span>] * (<span class="number">1</span> &lt;&lt; j) % mod);</span><br><span class="line">            add(dp[i - <span class="number">1</span>][j + <span class="number">1</span>][<span class="number">0</span>], dp[i][j][<span class="number">0</span>]);</span><br><span class="line">            <span class="comment">// k = 1</span></span><br><span class="line">            ll x = (j == <span class="number">0</span> ? <span class="number">1</span> : (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))), y = (j == <span class="number">0</span> ? <span class="number">0</span> : (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>)));</span><br><span class="line">            <span class="keyword">if</span> ((n &gt;&gt; (i - <span class="number">1</span>)) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">                add(dp[i - <span class="number">1</span>][j][<span class="number">0</span>], x * dp[i][j][<span class="number">1</span>] % mod);</span><br><span class="line">                add(dp[i - <span class="number">1</span>][j][<span class="number">1</span>], y * dp[i][j][<span class="number">1</span>] % mod);</span><br><span class="line">                add(dp[i - <span class="number">1</span>][j + <span class="number">1</span>][<span class="number">1</span>], dp[i][j][<span class="number">1</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                add(dp[i - <span class="number">1</span>][j][<span class="number">1</span>], x * dp[i][j][<span class="number">1</span>] % mod);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">0</span>, <span class="number">30</span>) add(ans, (dp[<span class="number">0</span>][i][<span class="number">0</span>] + dp[<span class="number">0</span>][i][<span class="number">1</span>]) % mod);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="1C"><a href="#1C" class="headerlink" title="1C"></a>1C</h2><hr><p>å…ˆå†³é¢˜ç›®æ˜¯ [ZJOI2016]-æ—…è¡Œè€…ï¼Œè¿™é‡Œå†™ä¸€ä¸‹é¢˜è§£</p><p>ç½‘æ ¼å›¾å¯ä»¥åˆ†æ²»ï¼æ‰¾åˆ°çŸ©å½¢çš„é•¿è¾¹ï¼Œç”¨ä¸€æ¡ä¸­è½´çº¿åˆ‡æˆä¸¤åŠï¼Œå½“å‰åˆ†æ²»çš„åŒºé—´æ˜¯ (lx, ly) (rx, ry)ï¼Œå¤„ç†çš„è¯¢é—®æ˜¯ (ql, qr)ï¼ˆç±»ä¼¼äºæ•´ä½“äºŒåˆ†ï¼‰ã€‚å¯¹äºæ¯ä¸ªè¯¢é—®ï¼š</p><ul><li>èµ·å§‹ç‚¹åœ¨ä¸­è½´çº¿ä¸¤ä¾§ï¼Œå¯¹äºä¸­è½´çº¿ä¸Šæ¯ä¸ªç‚¹è·‘æœ€çŸ­è·¯æ›´æ–°ç­”æ¡ˆ</li><li>èµ·å§‹ç‚¹åœ¨ä¸€ä¾§ï¼Œ<strong>å¯èƒ½</strong>æœ€çŸ­è·¯ä¹Ÿç»è¿‡ä¸­è½´çº¿ï¼Œä¹Ÿæ›´æ–°ä¸€æ³¢ï¼Œå†é€’å½’åˆ†æ²»</li></ul><p>å¡äº†å°å¸¸ï¼ŒåŠ äº†ç„å­¦å¤´æ–‡ä»¶<br><a href="https://blog.csdn.net/neither_nor/article/details/51733997" target="_blank" rel="noopener">å¤æ‚åº¦æ˜¯ O(S logS sqrt(S))</a><br><a href="https://www.luogu.com.cn/discuss/show/74578" target="_blank" rel="noopener">å¦‚æœæ²¡çœ‹æ‡‚è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªï¼ˆè¿˜æ˜¯ä¸æ‡‚ã€‚ã€‚</a></p><p>â€”åˆ†å‰²çº¿â€”</p><p>æœ¬é¢˜çš„åŒºåˆ«å°±æ˜¯æœ‰ä¿®æ”¹å•¦ã€‚æˆ‘ä»¬å¯ä»¥çŸ¥é“æ¯ä¸ªæ ¼å­å˜ä¸ºä¸èƒ½èµ°çš„æ—¶é—´ï¼ˆè¿™ä¸ªæ•´ä½“äºŒåˆ†åšï¼‰ï¼Œå®šä¹‰ä¸€æ¡è·¯å¾„çš„å€¼ä¸ºè¿™æ¡è·¯å¾„ä¸Šæ ¼å­ä¸èƒ½èµ°æ—¶é—´çš„æœ€å°å€¼ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦æ‰¾ä¸€æ¡å€¼æœ€å¤§çš„è·¯å¾„çœ‹è¿™ä¸ªå€¼æ˜¯å¦å¤§äºè¯¢é—®çš„æ—¶é—´ã€‚ç¦»çº¿ï¼Œç”¨æ—…è¡Œè€…çš„ åˆ†æ²» + dp åšã€‚ç„¶è€Œä¸ä¼šå†™ä»£ç ï¼Œæˆ‘åªä¼šå’•å’•</p><h2 id="2A"><a href="#2A" class="headerlink" title="2A"></a>2A</h2><hr><p>åªä¼š 16 åˆ† O(nT)ï¼Œå‘Šè¾ï¼ˆå’•å’•</p><p><a href="https://www.luogu.com.cn/paste/a8hdc624" target="_blank" rel="noopener">æ­£è§£æ˜¯æ–¯ç‰¹æ—æ•°ç›¸å…³ï¼Ÿï¼Ÿï¼Ÿæˆ‘è°”è°”</a></p><p>æœ€åå°±æ˜¯ä¸ªå·ç§¯å½¢å¼äº†ã€‚</p><h2 id="2B"><a href="#2B" class="headerlink" title="2B"></a>2B</h2><hr><p>è«åå°±æœ‰ 60 åˆ†ï¼Œå¯æƒœ T äº†ä¸€ä¸ªç‚¹</p><p>æ­£è§£ è¦ç”¨ ODT ç»´æŠ¤ï¼Ÿï¼Ÿï¼Ÿæˆ‘è°”è°”</p><h2 id="2C"><a href="#2C" class="headerlink" title="2C"></a>2C</h2><hr><p>ç¥ä»™è®¡ç®—å‡ ä½•é¢˜ï¼Œå’•å’•</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¨¡æ‹Ÿèµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AGC 047 é¢˜è§£</title>
      <link href="2020/08/11/AGC%20047%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/08/11/AGC%20047%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><hr><p>å®¹æ˜“æƒ³åˆ°ä¹˜ä¸Š 1e9ï¼Œé‚£ä¹ˆæ„å‘³ç€ç›¸ä¹˜å¾—åˆ°çš„æ•°æ˜¯ 1e18 çš„å€æ•°ã€‚å³å› å­ä¸­ 2 å’Œ 5 çš„ä¸ªæ•°éƒ½ &gt;= 18ï¼Œå¼€ä¸ªæ¡¶éšä¾¿åšä¸€ä¸‹ã€‚ã€æ³¨æ„è¯»å…¥ï¼Œæˆ‘æ²¡ç”¨å­—ç¬¦ä¸²å°± wa äº† qvq æ²¡è¯•è¿‡ long double ä¸çŸ¥é“è¡Œä¸è¡Œ</p><h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><hr><p>å®¹æ˜“å‘ç°è‹¥ T èƒ½å’Œ S åŒ¹é…ï¼ŒæŠŠ T ç¬¬ä¸€ä¸ªå­—ç¬¦å»æ‰ä»¥åå°±æ˜¯ S çš„ä¸€ä¸ªåç¼€ã€‚</p><p>é¢˜ç›®åªç»™å‡ºäº†<strong>æ€»</strong>ä¸²é•¿ï¼è¿™å¯å‘æˆ‘ä»¬æƒ³åˆ°ç»“åˆ Trie æ ‘ç­‰ç»“æ„å®ç°ä¸€ä¸ª O(n) çš„ç®—æ³•ã€‚</p><h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><hr><p>å¯¹å¤šé¡¹å¼å¤§å¸ˆæ¥è¯´æ˜¯å¥—è·¯é¢˜ï¼Œå¯¹æˆ‘æ¥è¯´ã€‚ã€‚qvq</p><p>å®¹æ˜“æƒ³åˆ°æšä¸¾æ¨¡åä¹˜ç§¯ã€‚</p><p>$$F(x) = \sum [a_i == x]$$</p><p>$$ans = \sum\limits_d d \sum_{(xy\bmod P == d)}F(x)F(y)$$</p><p>æˆ‘ä»¬æƒ³åˆ°äº†å·ç§¯ï¼Œä½†è¿™è¿˜ä¸æ˜¯å·ç§¯å½¢å¼ï¼Œäºæ˜¯å†åŒ–ä¸€æ­¥ï¼š</p><p>$$F(x) = \sum [g^{a_i} == x]$$</p><p>å…¶ä¸­ g æ˜¯ P çš„åŸæ ¹ä¹‹ä¸€</p><p>$$ans = \sum\limits_d g^d \sum_{((x + y)\bmod P == d)}F(x)F(y)$$</p><p>é‚£è¿™å°±æ˜¯ä¸ªå¾ªç¯å·ç§¯å•¦ã€‚</p><p>å…³äºåŸæ ¹ï¼šåŸæ ¹çš„å®šä¹‰å’Œæ€§è´¨ï¼šå¯¹äºä»»ä½• $0$ ~ $P - 1$ ä¸­çš„æ•° $i$ã€$j$($i \neq j$), æœ‰ $g^i \neq g^j(\bmod P)$ï¼Œå³ $g^i$ åœ¨ mod P æ„ä¹‰ä¸‹å¯ä»¥å–é $0$ ~ $P - 1$ æ‰€æœ‰æ•°ã€‚</p><p>å…³äºæ‰¾åŸæ ¹ï¼šåŸæ ¹å¾ˆå°ï¼Œä¸€èˆ¬åœ¨ 100 ä»¥å†…ï¼Œæšä¸¾ï¼Œè‹¥å­˜åœ¨ P çš„å› å­ x ä½¿å¾— $g^{\frac{P - 1}{x}} \equiv 1 (\bmod P)$ é‚£ä¹ˆ g å°±ä¸æ˜¯åŸæ ¹ã€‚å¦åˆ™å°±æ˜¯ã€‚</p><h2 id="D"><a href="#D" class="headerlink" title="D"></a>D</h2><hr><p>å’•å’•</p><h2 id="E"><a href="#E" class="headerlink" title="E"></a>E</h2><hr><p>å’•å’•</p><h2 id="F"><a href="#F" class="headerlink" title="F"></a>F</h2><hr><p>å’•å’•</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ä¹ é¢˜é€‰è®²ã€‘æ¦‚ç‡ä¸æœŸæœ›</title>
      <link href="2020/08/11/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91%E6%A6%82%E7%8E%87%E4%B8%8E%E6%9C%9F%E6%9C%9B/"/>
      <url>2020/08/11/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91%E6%A6%82%E7%8E%87%E4%B8%8E%E6%9C%9F%E6%9C%9B/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å¿«ä¹æœŸæœ› ~</span><br></pre></td></tr></table></figure><p>æœŸæœ›é¢˜å¾€å¾€åº”ç”¨åˆ°äº†æœŸæœ›çš„çº¿æ€§æ€§è´¨ï¼Œå¯ä»¥è¯´æ˜¯è§£é¢˜çš„åŸºç¡€ã€‚</p><p>åœ¨å›¾ä¸Šçš„è§£é¢˜æ–¹å¼ä¸€èˆ¬å°±æ˜¯ï¼šæ ‘ä¸Šdpï¼ŒåŸºç¯æ ‘dpï¼ŒDAG dpï¼Œç¼©ç‚¹å dpï¼Œåˆ†å±‚å›¾è§£åŒä¸€å±‚æ–¹ç¨‹ dp</p><h2 id="å¥—è·¯1-ç›´æ¥é€’æ¨-dp"><a href="#å¥—è·¯1-ç›´æ¥é€’æ¨-dp" class="headerlink" title="å¥—è·¯1. ç›´æ¥é€’æ¨/dp"></a><strong>å¥—è·¯1. ç›´æ¥é€’æ¨/dp</strong></h2><hr><h3 id="NOI2005-èªèªä¸å¯å¯"><a href="#NOI2005-èªèªä¸å¯å¯" class="headerlink" title="$[NOI2005]-èªèªä¸å¯å¯$"></a><a href="https://www.luogu.com.cn/problem/P4206" target="_blank" rel="noopener">$[NOI2005]-èªèªä¸å¯å¯$</a></h3><p>ç®€å•é¢˜çš„æ ·å­ï¼Œ$f[i, j] = \frac{\sum f[nxt, k]}{deg_j + 1} + 1$ï¼Œå…¶ä¸­ nxt æ˜¯ i ä¸¤æ­¥èƒ½åˆ°è¾¾çš„ï¼Œk æ˜¯ j ä¸€æ­¥èƒ½åˆ°è¾¾çš„ã€‚<strong>çŒ«å’Œé¼ çš„è·ç¦»ä¸æ–­å‡å°‘</strong>ï¼Œæ‰€ä»¥çŠ¶æ€ä¸ä¼šå½¢æˆç¯ï¼Œè®°å¿†åŒ–æœç´¢å°±å¥½äº†ã€‚</p><h3 id="SCOI2008-å¥–åŠ±å…³"><a href="#SCOI2008-å¥–åŠ±å…³" class="headerlink" title="$[SCOI2008]-å¥–åŠ±å…³$"></a><a href="https://www.luogu.com.cn/problem/P2473" target="_blank" rel="noopener">$[SCOI2008]-å¥–åŠ±å…³$</a></h3><p>n è¿™ä¹ˆå°ä¸€å®šæ˜¯çŠ¶å‹å•¦ã€‚é¦–å…ˆè¦æ˜ç¡®çš„æ˜¯ï¼ŒæŠ›å‡ºä»€ä¹ˆå®ç‰©æ˜¯éšæœºçš„ï¼Œä½†é€‰æ‹©ä¸å¦æ˜¯æˆ‘ä»¬å†³å®šçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦æ±‚<strong>æœ€ä¼˜ç­–ç•¥ä¸‹çš„æœ€å¤§æœŸæœ›å¾—åˆ†</strong></p><p>$f[i, S]$ è¡¨ç¤ºå‰ $i - 1$ è½®å–åˆ°çš„çŠ¶æ€ä¸º $S$ï¼Œ$i$ ~ $K$ è½®çš„æœ€å¤§æœŸæœ›å¾—åˆ†ã€‚é‚£ä¹ˆå°±æœ‰ </p><p>$$f[i, S] = \frac{1}{n}(\sum\limits_{k\ is\ valid} max(f[i + 1, S], f[i + 1, S | (1 &lt;&lt; (k - 1))] + p_k) + \sum\limits_{k\ isnâ€™t\ valid} f[i + 1, S])$$</p><h3 id="æ¸…åé›†è®­2017-å°-Y-å’Œææ€–çš„å¥´éš¶ä¸»"><a href="#æ¸…åé›†è®­2017-å°-Y-å’Œææ€–çš„å¥´éš¶ä¸»" class="headerlink" title="$[æ¸…åé›†è®­2017]-å° Y å’Œææ€–çš„å¥´éš¶ä¸»$"></a><a href="https://www.luogu.com.cn/problem/P4007" target="_blank" rel="noopener">$[æ¸…åé›†è®­2017]-å° Y å’Œææ€–çš„å¥´éš¶ä¸»$</a></h3><p>n è¿™ä¹ˆå¤§ä¸€å®šæ˜¯çŸ©é˜µå¿«é€Ÿå¹‚ä¼˜åŒ– dp å•¦ï¼ˆé›¾ï¼‰ã€‚ä»¥ $m = 3$ ä¸ºä¾‹ï¼Œè®¾ $f[i, a, b, c]$ è¡¨ç¤º $i$ è½®æ”»å‡»åæœ‰ $a$ ä¸ª 1 è¡€éšä»ã€$b$ ä¸ª 2 è¡€éšä»ã€$c$ ä¸ª 3 è¡€éšä»çš„æ¦‚ç‡ï¼Œè½¬ç§»æ–¹ç¨‹å°±å¾ˆå¥½æƒ³ã€‚ã€‚ç„¶åå‘ç°è¿™ä¸ªä¸œè¥¿çŠ¶æ€æ•°æ˜¯ 166, å¤æ‚åº¦ $O(T166^3logn)$ï¼Œè€ƒè™‘æŠŠ $2^i$ çš„çŸ©é˜µé¢„å¤„ç†å‡ºæ¥ï¼Œæ¯æ¬¡è¯¢é—®å°±åªéœ€ç”¨ä¸€ä¸ªè¡Œå‘é‡å»ä¹˜ logn æ¬¡çŸ©é˜µï¼Œå¤æ‚åº¦å°±å˜æˆäº† $O(T166^2logn)$ï¼Œç„¶åè¿˜è¦å¡å¾ˆå¤šå¸¸ã€‚ã€‚ã€‚æ‰€ä»¥è¿™æ˜¯é“æ¯’é¢˜</p><h2 id="å¥—è·¯2-æ— é™å¾ªç¯è½¬é€’æ¨"><a href="#å¥—è·¯2-æ— é™å¾ªç¯è½¬é€’æ¨" class="headerlink" title="å¥—è·¯2. æ— é™å¾ªç¯è½¬é€’æ¨"></a><strong>å¥—è·¯2. æ— é™å¾ªç¯è½¬é€’æ¨</strong></h2><hr><p>ï¼ˆè¿™éƒ¨åˆ†å¥½ç¥ä»™çš„ï¼è¦å·§å¦™è®¾è®¡çŠ¶æ€ï¼Œæˆ–è€…é”™ä½ç›¸å‡æ³•ï¼ˆç­‰æ¯”æ•°åˆ—æ±‚å’Œå¿…å¤‡æŠ€èƒ½ï¼‰ç­‰æ–¹æ³•åŒ–æŸ¿å­ qvqï¼‰</p><h3 id="SHOI2002-ç™¾äº‹ä¸–ç•Œæ¯ä¹‹æ—…"><a href="#SHOI2002-ç™¾äº‹ä¸–ç•Œæ¯ä¹‹æ—…" class="headerlink" title="$[SHOI2002]-ç™¾äº‹ä¸–ç•Œæ¯ä¹‹æ—…$"></a><a href="https://www.luogu.com.cn/problem/P1291" target="_blank" rel="noopener">$[SHOI2002]-ç™¾äº‹ä¸–ç•Œæ¯ä¹‹æ—…$</a></h3><p>åº”ç”¨æé™çš„æ€æƒ³ <a href="https://www.luogu.com.cn/blog/ButterflyDew/solution-p1291" target="_blank" rel="noopener">é¢˜è§£</a></p><h3 id="å…­çœè”è€ƒ2017-åˆ†æ‰‹æ˜¯ç¥æ„¿"><a href="#å…­çœè”è€ƒ2017-åˆ†æ‰‹æ˜¯ç¥æ„¿" class="headerlink" title="$[å…­çœè”è€ƒ2017]-åˆ†æ‰‹æ˜¯ç¥æ„¿$"></a><a href="https://www.luogu.com.cn/problem/P3750" target="_blank" rel="noopener">$[å…­çœè”è€ƒ2017]-åˆ†æ‰‹æ˜¯ç¥æ„¿$</a></h3><p>çœ‹èµ·æ¥å¾ˆç¥çš„æœŸæœ›é¢˜</p><p>é¦–å…ˆ 50 åˆ†ä»åå¾€å‰å–ï¼Œå¥½æ‹¿å§</p><p>è€ƒè™‘æ­£è§£ï¼ä»åå¾€å‰å–ä¼šç¡®å®šä¸€äº›<strong>å¿…é¡»è¦å–</strong>çš„é”®ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºé™¤å¼€è¿™äº›é”® æŒ‰äº†å…¶ä»–çš„é”® <strong>å°±å¾—æŒ‰åŒä¸€ä¸ªé”®æŒ‰å›æ¥</strong>ï¼Œç›¸å½“äºå¤šäº†ä¸€ä¸ªå¿…é¡»è¦æŒ‰çš„é”®ï¼ˆæ‰€ä»¥ f çš„é¢„å¤„ç†å¾—ä» nï¼Œä¸èƒ½ä» cnt å¼€å§‹ï¼ï¼‰ã€‚æ‰€ä»¥ dp çš„çŠ¶æ€å°±æ˜¯ f[i] è¡¨ç¤ºä» i ä¸ªå¿…é€‰çš„é”®è½¬ç§»åˆ° i - 1 ä¸ªå¿…é€‰çš„é”®çš„æœŸæœ›æ“ä½œæ¬¡æ•°</p><p>$$f[i] = \frac{i}{n} + \frac{n - i}{n}(1 + f[i] + f[i + 1])$$</p><p>ç¬¬ä¸€é¡¹è¡¨ç¤ºé€‰äº†ä¸€ä¸ªå¿…é€‰çš„ï¼Œä¸€æ¬¡å°±åˆ° i - 1 å»äº†ï¼›</p><p>ç¬¬äºŒé¡¹è¡¨ç¤ºé€‰äº†ä¸€ä¸ªå…¶ä»–çš„ï¼Œå°±å¾— f[i + 1] æ¬¡æŒ‰å›æ¥ï¼Œå† f[i] æ¬¡æŒ‰åˆ° i - 1 å»ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">100003</span>, N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, K, cnt, res;</span><br><span class="line">ll col[N], f[N];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quick_pow</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ret = ret * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">    &#125; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; K;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;col[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i; --i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (col[i]) &#123;</span><br><span class="line">            ++cnt;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j * j &lt;= i; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i % j == <span class="number">0</span>) &#123;</span><br><span class="line">                    col[j] ^= <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">if</span> (j * j != i) col[i / j] ^= <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i; --i)  <span class="comment">// !!! ä» n å¼€å§‹</span></span><br><span class="line">        f[i] = (f[i + <span class="number">1</span>] * (ll)(n - i) % mod + n) % mod * quick_pow(i, mod - <span class="number">2</span>) % mod;</span><br><span class="line">    <span class="keyword">if</span> (cnt &lt;= K) res = cnt;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        res = K;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = cnt; i &gt; K; --i) res = (res + f[i]) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) res = res * (ll)i % mod;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, res);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="UVA10529-Dumb-Bones"><a href="#UVA10529-Dumb-Bones" class="headerlink" title="$[UVA10529]-Dumb Bones$"></a><a href="https://www.luogu.com.cn/problem/UVA10529" target="_blank" rel="noopener">$[UVA10529]-Dumb Bones$</a></h3><p>å¤ªç¥ä»™äº†å§woc</p><p>è€ƒè™‘<strong>å•ç‹¬</strong>ä¸€å¼ éª¨ç‰Œæ‘†æ”¾æˆåŠŸçš„æœŸæœ›æ¬¡æ•° E</p><p>ç„å­¦åŒ–æŸ¿å­ï¼ˆæ„Ÿæ€§ç†è§£ï¼‰<br>$$E = 1 + pl(1 + pl(â€¦) + pr(â€¦)) + pr(1 + pl(â€¦) + pr(â€¦))$$<br>$$= 1 + (pl + pr)(1 + (pl + pr)(â€¦))$$<br>$$= 1 + (pl + pr) + (pl + pr)^2 + (pl + pr)^3 â€¦ + (pl + pr)^{\infty}$$<br>$$= \frac{1}{1 - pl - pr}$$<br>ï¼ˆåˆ«åŒ–æ™•äº†</p><p>è€ƒè™‘è¿ç»­çš„ x å¼ éª¨ç‰ŒæˆåŠŸçš„æœŸæœ›ã€‚<strong>æ³¨æ„é‡‡å–æœ€ä¼˜ç­–ç•¥</strong></p><p>æ”¾ç¬¬ x å¼ éª¨ç‰Œæ—¶ï¼Œå¦‚æœå‘å·¦/å³ï¼Œå°±è¦èŠ±è´¹ä¸€äº›æ­¥æ•°å»æ‰¶èµ·å·¦/å³è¾¹çš„éª¨ç‰Œã€‚åé¢é‚£å¨ä¸œè¥¿ï¼Œæ ¹æ®<strong>æœŸæœ›çš„çº¿æ€§æ€§è´¨</strong></p><p>$$f[x] = \min\limits_{i = 1}^x{f[i - 1] \times \frac{1 - pr}{1 - pl - pr} + f[x - i] \times \frac{1 - pl}{1 - pl - pr} + \frac{1}{1 - pl - pr}}$$</p><p>ä»¥å¾€å·¦å€’ä¸ºä¾‹è§£é‡Šä¸€ä¸‹ï¼šå·¦è¾¹è¦é‡æ­ $f[i - 1] \times [å¾€å·¦å€’çš„æœŸæœ›æ¬¡æ•°] = f[i - 1] \times (E - 1) \times \frac{pl}{pl + pr}$ï¼Œæ³¨æ„è¿™æ˜¯é‡æ­çš„ï¼Œåˆå§‹è¿˜æœ‰ä¸€æ¬¡ï¼Œæ‰€ä»¥æ˜¯ $f[i - 1] \times \frac{1 - pr}{1 - pl - pr}$</p><p>å°±åšå®Œäº†ã€‚uva æ•°æ®åªæœ‰ä¸€ç»„ï¼Œéå¸¸çš„æ°´ï¼Œæˆ‘æ€•äº†ï¼Œé¢˜è§£æŸ¿å­éƒ½ä¸ä¸€æ ·ã€‚</p><p>æ„Ÿæƒ³å°±æ˜¯ï¼Œ<strong>æœŸæœ›çš„çº¿æ€§æ€§è´¨çœŸçš„å¤ªé‡è¦äº†ï¼</strong> ä¸ç„¶è¿™ç§äº’ç›¸å½±å“çš„é—®é¢˜å°±æ²¡æ³•åšäº†ã€‚</p><h3 id="CF908D-New-Year-and-Arbitrary-Arrangement"><a href="#CF908D-New-Year-and-Arbitrary-Arrangement" class="headerlink" title="$[CF908D]-New Year and Arbitrary Arrangement$"></a><a href="https://www.luogu.com.cn/problem/CF908D" target="_blank" rel="noopener">$[CF908D]-New Year and Arbitrary Arrangement$</a></h3><p>è¿™é¢˜çš„å…³é”®åœ¨å¤„ç†è¾¹ç•Œå•¦ã€‚</p><p>å®¹æ˜“å‘ç°æˆ‘ä»¬éœ€è¦è®°å½•çš„æ˜¯å½“å‰ a å’Œ ab çš„æ•°é‡ã€‚è®¾ f[i, j] è¡¨ç¤º i ä¸ª aï¼Œj ä¸ª abï¼Œé‚£ä¹ˆ $f[i, j] = \frac{pa}{pa + pb}f[i + 1, j] + \frac{pb}{pa + pb}f[i, i + j]$</p><p>å¼€å¤´æ— é™å¤šä¸ª b æ€ä¹ˆåŠï¼Ÿå¿½ç•¥æ‰ï¼Œå› ä¸ºå¯¹ ab çš„æ•°é‡æ²¡æœ‰å½±å“ã€‚</p><p>ç»“å°¾æ— é™å¤šä¸ª a æ€ä¹ˆåŠï¼Ÿè¿™ä¸ªå°±è¦æä¸€æäº†ã€‚å¦‚æœ i + j &gt;= kï¼Œé‚£ä¹ˆåªè¦åŠ ä¸€ä¸ª b å°±èƒ½ç»“æŸã€‚è®¾ $P_a = \frac{pa}{pa + pb}$, $P_b = \frac{pb}{pa + pb}$</p><p>$$f[i, j] = P_b \sum\limits_{k = 0}^{\infty} P_a^k (i + j + k)$$</p><p>$$= P_b\sum\limits_{k = 0}^{\infty} P_a^k \times k + P_b(i + j)\sum\limits_{k = 0}^{\infty}P_a^k$$</p><p>$$= i + j + \frac{P_a}{P_b}$$</p><h3 id="ã€ŒPKUWC2018ã€çŒäººæ€"><a href="#ã€ŒPKUWC2018ã€çŒäººæ€" class="headerlink" title="$ã€ŒPKUWC2018ã€çŒäººæ€$"></a><a href="https://loj.ac/problem/2541" target="_blank" rel="noopener">$ã€ŒPKUWC2018ã€çŒäººæ€$</a></h3><p>å¾ˆå¦™çš„æ¦‚ç‡é¢˜ã€‚</p><p>åˆ†æ¯æ˜¯å˜åŒ–çš„ï¼Œå¾ˆä¸å¥½æ±‚ã€‚</p><p>é—®é¢˜å¯ä»¥è½¬åŒ–ä¸€æ³¢ï¼Œå˜æˆï¼šæ­»æ‰çš„çŒäººä¾æ—§ç®—åœ¨æ¦‚ç‡é‡Œé¢ï¼Œæ¯ä¸€è½®ä¸€ç›´å¼€æªç›´åˆ°å°„æ­»ä¸€ä¸ªæ²¡æ­»è¿‡çš„çŒäººã€‚è¿™æ ·æ¯æ¬¡èƒ½é€‰çš„å°±æ˜¯å…¨é›†äº†ã€‚</p><p>è®¾ $W = \sum w_i$, $T = {w_i\ |\ (i\ has\ died)}$, $sum(T) = \sum\limits_{i\ has\ died} w_i$</p><p>è½¬åŒ–å‰å°„æ­» $i$ çš„æ¦‚ç‡ $P = \frac{wi}{(W - T)}$</p><p>è½¬åŒ–åå°„æ­» $i$ çš„æ¦‚ç‡ $P = \frac{T}{W}P + \frac{wi}{W} = \frac{wi}{W - T}$</p><p>ä¸¤è€…ç›¸ç­‰ã€‚</p><p>ã€‚</p><p>ã€‚</p><p>ç„¶åè€ƒè™‘å®¹æ–¥ï¼Œé’¦å®šä¸€ä¸ªä¸åŒ…å« 1 çš„çŒäººé›†åˆ T åœ¨ 1 ä¹‹åæ­»å»ã€‚é™¤äº†é›†åˆ T å’ŒçŒäºº 1 ä»¥å¤–çš„å‰©ä½™çš„çŒäººä¸ç”¨è€ƒè™‘ï¼Œå› ä¸ºä»–ä»¬å¯ä»¥ä»»æ„æ‘†æ”¾åœ¨ 1 çš„å‰é¢åé¢ï¼ˆä¹Ÿå°±æ˜¯è¯´æ¦‚ç‡æ˜¯ 1ï¼‰</p><p>é›†åˆä¸º T çš„äººåœ¨ 1 åé¢æ­»çš„æ¦‚ç‡ï¼š</p><p>$$P = \frac{w_1}{W}\sum\limits_{i = 0}^{\infty} (1 - \frac{sum(T) + w_1}{W})^i = \frac{w_1}{sum(T) + w_1}$$</p><p>å®¹æ–¥</p><p>$$ans = \sum\limits_{T} (-1)^{|T|} \frac{w_1}{sum(T) + w_1}$$</p><p>æšä¸¾ $T$ å†èƒŒåŒ…é¢„å¤„ç†å®¹æ–¥ç³»æ•°å¯ä»¥åšåˆ° $n^2$ï¼Œ50 ptsï¼š</p><p>$$ans = \sum\limits_{num = 0}^{W} \frac{w_1}{num + w_1} (\sum\limits_T (-1)^{|T|} [sum(T) == num])$$</p><p>å¥½å¦™ã€åè¡€è€Œäº¡</p><p>100 pts çš„è¯å°±æ˜¯åé¢é‚£å¨å®¹æ–¥ç³»æ•°ç”¨åˆ†æ²»çš„ NTT å·ä¸€ä¸‹äº†ï¼ˆä¸‹æ ‡æ˜¯ Tï¼‰ï¼Œæ³¨æ„ä¸æ˜¯ cdq åˆ†æ²»ï¼Œå°±æ˜¯æ™®é€šçš„åˆ†æ²»ã€‚æˆ–è€…ä¹Ÿå¯ä»¥å †ä¼˜åŒ–ï¼Œå³æ¯æ¬¡é€‰ä¸¤ä¸ªé•¿åº¦æœ€å°çš„å·ã€‚nlog^2n</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>, N = <span class="number">3e5</span> + <span class="number">10</span>, G1 = <span class="number">3</span>, G2 = (mod + <span class="number">1</span>) / G1;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, w[N], lim, sum[N], stk[<span class="number">32</span>], top, g[<span class="number">32</span>][N], ans, f[N], L, rev[N];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quick_pow</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ret = ret * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">    &#125; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_rev</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">1</span>, lim - <span class="number">1</span>)</span><br><span class="line">        rev[i] = (rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (L - <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span><span class="params">(ll a[], <span class="keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">1</span>, lim - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; rev[i]) swap(a[i], a[rev[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; lim; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        ll W = quick_pow(op == <span class="number">1</span> ? G1 : G2, (mod - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; lim; j += (mid &lt;&lt; <span class="number">1</span>)) &#123;</span><br><span class="line">            ll w = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k++, w = w * W % mod) &#123;</span><br><span class="line">                ll x = a[j + k], y = w * a[j + k + mid] % mod;</span><br><span class="line">                a[j + k] = (x + y) % mod, a[j + k + mid] = (x - y + mod) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">-1</span>) &#123;</span><br><span class="line">        ll Inv = quick_pow(lim, mod - <span class="number">2</span>);</span><br><span class="line">        rep(i, <span class="number">0</span>, lim - <span class="number">1</span>) a[i] = a[i] * Inv % mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(ll f[], <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        f[<span class="number">0</span>] = <span class="number">1</span>, f[w[l]] = mod - <span class="number">1</span>; <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>, ls, rs;</span><br><span class="line">    ls = stk[top--], solve(g[ls], l, mid);</span><br><span class="line">    rs = stk[top--], solve(g[rs], mid + <span class="number">1</span>, r);</span><br><span class="line">    lim = <span class="number">1</span>, L = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (lim &lt;= sum[r] - sum[l - <span class="number">1</span>]) lim &lt;&lt;= <span class="number">1</span>, ++L;</span><br><span class="line">    get_rev();</span><br><span class="line">    NTT(g[ls], <span class="number">1</span>), NTT(g[rs], <span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">0</span>, lim - <span class="number">1</span>) f[i] = g[ls][i] * g[rs][i] % mod;</span><br><span class="line">    NTT(f, <span class="number">-1</span>);</span><br><span class="line">    rep(i, <span class="number">0</span>, lim - <span class="number">1</span>) g[ls][i] = g[rs][i] = <span class="number">0</span>;</span><br><span class="line">    stk[++top] = ls, stk[++top] = rs;  <span class="comment">// åƒåœ¾å›æ”¶</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;w[i]), sum[i] = sum[i - <span class="number">1</span>] + w[i];</span><br><span class="line">    rep(i, <span class="number">1</span>, <span class="number">30</span>) stk[++top] = i;</span><br><span class="line">    solve(f, <span class="number">2</span>, n);</span><br><span class="line">    rep(i, <span class="number">0</span>, sum[n] - w[<span class="number">1</span>])</span><br><span class="line">        ans = (ans + w[<span class="number">1</span>] * quick_pow(i + w[<span class="number">1</span>], mod - <span class="number">2</span>) % mod * f[i] % mod) % mod;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¥—è·¯3-é«˜æ–¯æ¶ˆå…ƒ"><a href="#å¥—è·¯3-é«˜æ–¯æ¶ˆå…ƒ" class="headerlink" title="å¥—è·¯3. é«˜æ–¯æ¶ˆå…ƒ"></a><strong>å¥—è·¯3. é«˜æ–¯æ¶ˆå…ƒ</strong></h2><hr><p>ç»ˆäºåˆ°äº†æˆ‘æœ€å–œæ¬¢çš„éƒ¨åˆ† ~ é«˜æ¶ˆï¼</p><p>æˆ‘çº ç»“äº†å¾ˆä¹…çš„é—®é¢˜ï¼šå›¾ä¸Šæ¸¸èµ°é—®é¢˜ æ˜¯ä»¥å‡ºå‘ç‚¹åº¦æ•°ä½œä¸ºåˆ†æ¯è¿˜æ˜¯ç»ˆç‚¹åº¦æ•°ä½œä¸ºåˆ†æ¯ï¼Œä½†è¿™å…¶å®åº”é¢˜è€Œå¼‚ï¼Œä¸»è¦è·Ÿä½ è®¾è®¡çš„ dp çŠ¶æ€æœ‰å…³ã€‚</p><h3 id="USACO10HOL-Driving-Out-the-Piggies-G"><a href="#USACO10HOL-Driving-Out-the-Piggies-G" class="headerlink" title="$[USACO10HOL]-Driving Out the Piggies G$"></a><a href="https://www.luogu.com.cn/problem/P2973" target="_blank" rel="noopener">$[USACO10HOL]-Driving Out the Piggies G$</a></h3><p>$f[x]$ è¡¨ç¤ºèµ°åˆ° x ä¸çˆ†ç‚¸çš„æ¦‚ç‡ï¼ˆçˆ†ç‚¸åªè¦ä¹˜ä¸Š $\frac{p}{q}$ å°±å¥½äº†ï¼‰</p><p>å¯¹äºéèµ·å§‹ç‚¹çš„ xï¼Œ$f[x] = \sum \frac{(1 - \frac{p}{q})f[y]}{deg_y}$</p><h3 id="HNOI2013-æ¸¸èµ°"><a href="#HNOI2013-æ¸¸èµ°" class="headerlink" title="$[HNOI2013]-æ¸¸èµ°$"></a><a href="https://www.luogu.com.cn/problem/P3232" target="_blank" rel="noopener">$[HNOI2013]-æ¸¸èµ°$</a></h3><p>å‡ ä¸ªæœˆå‰åšçš„ï¼Œç°åœ¨æ¥çœ‹å´æœ‰äº†æ–°çš„ä½“ä¼šã€‚</p><p>æ ¹æ®æœŸæœ›çš„çº¿æ€§æ€§è´¨ï¼Œ$E[åˆ†æ•°ä¹‹å’Œ] = \sum_{(u, v) \in G} E[(u, v)åˆ†æ•°] = \sum_{(u, v) \in G} E[ç»è¿‡(u, v)çš„æ¬¡æ•°] \times val(u, v)$ï¼Œé‚£ä¹ˆç®—å‡ºæ¯æ¡è¾¹è¢«ç»è¿‡æ¬¡æ•°åä»å°åˆ°å¤§æ’åºï¼Œè´ªå¿ƒçš„ä»å¤§åˆ°å°èµ‹è¾¹æƒå°±å¯ä»¥äº†ã€‚</p><p>è¾¹ç»è¿‡çš„æœŸæœ›æ¬¡æ•°å¯ä»¥è½¬åŒ–æˆç‚¹ç»è¿‡çš„æœŸæœ›æ¬¡æ•°ã€‚$E[u, v] = \frac{E[u]}{deg_u} + \frac{E[v]}{deg_v}$, $E[u] = \sum \frac{E[v]}{deg_v} + [u == 1]$</p><h3 id="HNOI2011-XORå’Œè·¯å¾„"><a href="#HNOI2011-XORå’Œè·¯å¾„" class="headerlink" title="$[HNOI2011]-XORå’Œè·¯å¾„$"></a><a href="https://www.luogu.com.cn/problem/P3211" target="_blank" rel="noopener">$[HNOI2011]-XORå’Œè·¯å¾„$</a></h3><p>æ•´ä¸ªåšä¸å¥½åšã€‚æ ¹æ®æœŸæœ›çš„çº¿æ€§æ€§è´¨ï¼ŒæŒ‰ä½è€ƒè™‘ï¼Œè®¡ç®—å‡ºæ¯ä¸€ä½ä¸º 1 çš„æ¦‚ç‡ç›´æ¥ç›¸åŠ ã€‚$f[x]$ è¡¨ç¤ºä» x åˆ° n å½“å‰ä½ä¸º 1 çš„æ¦‚ç‡ã€‚</p><p>$$f[x] = \sum\limits_{(x, y) = 0} \frac{f[y]}{deg_y} + \sum\limits_{(x, y) = 1} \frac{1 - f[y]}{deg_y}$$</p><p>ç§»é¡¹ä»¥åé«˜æ¶ˆã€‚æ³¨æ„è¾¹ç•Œï¼Œ$f[n] = 0$</p><h2 id="å¥—è·¯4-åˆ†å¼€è€ƒè™‘è´¡çŒ®"><a href="#å¥—è·¯4-åˆ†å¼€è€ƒè™‘è´¡çŒ®" class="headerlink" title="å¥—è·¯4. åˆ†å¼€è€ƒè™‘è´¡çŒ®"></a><strong>å¥—è·¯4. åˆ†å¼€è€ƒè™‘è´¡çŒ®</strong></h2><hr><p>è¿™éƒ¨åˆ†ä¸»è¦æ˜¯æœŸæœ›çš„çº¿æ€§æ€§è´¨çš„åº”ç”¨ã€‚å…¶å®å‰é¢çš„é¢˜ç›®ä¹Ÿæœ‰ä½“ç°ã€‚</p><h3 id="ä»“é¼ æ‰¾sugar-II"><a href="#ä»“é¼ æ‰¾sugar-II" class="headerlink" title="$ä»“é¼ æ‰¾sugar II$"></a><a href="https://www.luogu.com.cn/problem/P3412" target="_blank" rel="noopener">$ä»“é¼ æ‰¾sugar II$</a></h3><p>æ•°æ®èŒƒå›´è¿™ä¹ˆå¤§ ä¸èƒ½é«˜æ¶ˆ =&gt; æˆ‘ä¸ä¼šåšäº†ï¼</p><p>æŠŠç›®æ ‡èŠ‚ç‚¹çœ‹ä½œæ ¹ï¼Œè¿™æ ·ç­”æ¡ˆå°±æˆäº†åˆ°è¾¾æ ¹çš„æœŸæœ›æ­¥æ•°å’Œ</p><p>è®¾ $f[x]$ è¡¨ç¤ºä» x å‘ä¸Šèµ°ä¸€æ­¥çš„æœŸæœ›æ­¥æ•°ï¼Œé‚£ä¹ˆ $f[x] = \frac{1}{deg_x} + \frac{deg_x - 1}{deg_x}(1 + \frac{\sum\limits_{y \in Son(x)} f[y]}{deg_x - 1} + f[x]) = 1 + \frac{\sum\limits_{y \in Son(x)} f[y]}{deg_x} + f[x] = deg_x + \sum\limits_{y \in Son(x)}f[y]$, å¶å­ $x$ çš„ $f[x] = 1$</p><p>æ ‘å½¢dp $n$ æ¬¡èƒ½è·å¾— 50 åˆ†çš„å¥½æˆç»©ï¼Œè€ƒè™‘å†ä¼˜åŒ–â€”â€”æ¢æ ¹æ³•ã€‚</p><p>è®¾ $g[x]$ è¡¨ç¤ºåœ¨ $fa[x]$ çš„å„¿å­ä¸­é™¤äº† $x$ ä»¥å¤–çš„ $f$ å€¼ä¹‹å’Œã€‚æ ¹ä» $u$ å˜æˆ $v$ å®é™…ä¸Šåªä¼šå½±å“ $u$ å’Œ $v$ çš„ $f$ å€¼å’Œå­æ ‘å¤§å°ï¼Œå³ $f[u] = deg_u + g[v], f[v] = 0$ï¼Œå­æ ‘å’Œéšä¾¿æä¸€ä¸‹ã€‚$ans = \frac{\sum\limits_{rt = 1}^n\sum\limits_{x = 1}^n f[x] \times sz[x]}{n^2}$</p><h3 id="å°é­”å¥³å¸•çª"><a href="#å°é­”å¥³å¸•çª" class="headerlink" title="$å°é­”å¥³å¸•çª$"></a><a href="https://www.luogu.com.cn/problem/P3802" target="_blank" rel="noopener">$å°é­”å¥³å¸•çª$</a></h3><p>æ ¹æ®æœŸæœ›çš„çº¿æ€§æ€§è´¨ï¼Œ$E[æ€»æ•°] = \sum\limits_i E[ä» i å¼€å§‹çš„ä¸ƒä¸ªé­”æ³•éƒ½ä¸ç›¸åŒ]$ï¼Œæ¯ä¸ªä½ç½® i çš„è¿ç»­ä¸ƒä¸ªä¸ç›¸åŒçš„æ¦‚ç‡éƒ½æ˜¯ç›¸åŒçš„ã€‚ç­”æ¡ˆå°±æ˜¯ $7! \times \prod\limits_{i = 1}^7 \frac{a_i}{N - i + 1} \times (N - 6)$</p><h3 id="HNOI2015-äºšç‘Ÿç‹"><a href="#HNOI2015-äºšç‘Ÿç‹" class="headerlink" title="$[HNOI2015]-äºšç‘Ÿç‹$"></a><a href="https://www.luogu.com.cn/problem/P3239" target="_blank" rel="noopener">$[HNOI2015]-äºšç‘Ÿç‹$</a></h3><p>æ ¹æ®æœŸæœ›çš„çº¿æ€§æ€§è´¨ï¼Œè€ƒè™‘æ¯å¼ ç‰Œå¯¹ç­”æ¡ˆçš„è´¡çŒ®ã€‚å‘ç°ç¬¬ $i$ å¼ ç‰Œè¢«è€ƒè™‘åˆ°çš„æ¬¡æ•°<strong>åª</strong>å’Œå‰ $i - 1$ å¼ ç‰Œäº§ç”Ÿè´¡çŒ®çš„<strong>æ•°é‡</strong>æœ‰å…³ï¼ˆè®¾å…¶ä¸º $j$ï¼‰ï¼Œå› ä¸ºè¿™ $j$ å¼ ç‰Œäº§ç”Ÿè´¡çŒ®çš„æ—¶é—´å’Œé¡ºåºä¸è®ºæ€æ ·å˜æ¢ï¼Œç¬¬ $i$ å¼ ç‰Œéƒ½èƒ½è¢«è€ƒè™‘åˆ° $r - j$ æ¬¡ã€‚</p><p>äºæ˜¯æƒ³åˆ° dpã€‚$f[i, j]$ è¡¨ç¤ºåœ¨ $r$ è½®ä¸­å‰ $i$ å¼ ç‰Œæœ‰ $j$ å¼ äº§ç”Ÿè´¡çŒ®çš„æ¦‚ç‡ï¼Œ$g[i]$ è¡¨ç¤ºç¬¬ $i$ å¼ ç‰Œäº§ç”Ÿè´¡çŒ®çš„æ¦‚ç‡ã€‚é‚£ä¹ˆ</p><p>$$f[i, j] = [j &lt;= i - 1] \times f[i - 1, j] \times (1 - p[i])^{r - j} + [j &gt; 0] \times f[i - 1, j - 1] \times (1 - (1 - p[i])^{r - j + 1})$$</p><p>$$g[i] = \sum\limits_{j = 0}^{min(i - 1, r)}f[i - 1, j] \times (1 - (1 - p[i])^{r - j})$$</p><p>æœ€ç»ˆ $ans = \sum\limits_{i = 1}^n g[i] \times d[i]$</p><p>æœ€ç»ˆç­”æ¡ˆå°±æ˜¯ $f[1, 0]$</p><h2 id="å¥—è·¯5-æ•´æ•°æ¦‚ç‡å…¬å¼"><a href="#å¥—è·¯5-æ•´æ•°æ¦‚ç‡å…¬å¼" class="headerlink" title="å¥—è·¯5. æ•´æ•°æ¦‚ç‡å…¬å¼"></a><strong>å¥—è·¯5. æ•´æ•°æ¦‚ç‡å…¬å¼</strong></h2><hr><p>è¿™éƒ¨åˆ†æ˜¯çœŸçš„æ²¡æ€ä¹ˆç»ƒè¿‡ã€‚ã€‚</p><p>åæ­£è¦çŸ¥é“å…¬å¼ï¼šå¯¹äºéšæœºå˜é‡ $k &gt;= 0$, $E(k) = \sum\limits_{i = 0}^{\infty} P(k \ge i)$</p><h3 id="éšæœºæ•°ç”Ÿæˆå™¨"><a href="#éšæœºæ•°ç”Ÿæˆå™¨" class="headerlink" title="$éšæœºæ•°ç”Ÿæˆå™¨$"></a><a href="https://www.luogu.com.cn/problem/P3600" target="_blank" rel="noopener">$éšæœºæ•°ç”Ÿæˆå™¨$</a></h3><p>æ ¹æ®ä¸Šé¢é‚£ä¸ªå…¬å¼ï¼Œæˆ‘ä»¬å°±æ˜¯è¦è®¡ç®—å‡º $P(ans \ge i)$ã€‚å‘ç° $\ge$ ä¸å¥½æ±‚ï¼Œ$\leq$ æŒºå¥½æ±‚ï¼Œå› ä¸ºæ¯ä¸ªåŒºé—´é‡Œè‡³å°‘æœ‰ä¸€ä¸ª $\leq i$ çš„å°±ç®—æ»¡è¶³æ¡ä»¶äº†ï¼Œæ‰€ä»¥è€ƒè™‘å°† $P(ans \ge i)$ è½¬åŒ–ä¸º $1 - P(ans &lt; i)$ã€‚</p><p>æˆ‘ä»¬å‘ç°ä¸¤ä¸ªåŒºé—´æ˜¯åŒ…å«å…³ç³»çš„è¯ï¼Œå¤§çš„åŒºé—´å¯¹ç­”æ¡ˆæ²¡æœ‰è´¡çŒ®ï¼Œäºæ˜¯æ“ä½œä¸€æ³¢ä½¿å¾—åŒºé—´ä»¬çš„å·¦å³ç«¯ç‚¹ä¸å‡ã€‚è€ƒè™‘æŸä¸ªä½ç½®çš„æ•°ï¼Œå¦‚æœå®ƒ $\leq i - 1$ å°±èƒ½å¯¹è¦†ç›–è‡ªå·±çš„åŒºé—´äº§ç”Ÿè´¡çŒ®ï¼Œè€Œä¸”è¦†ç›–è‡ªå·±çš„åŒºé—´ç¼–å·è¿ç»­ã€‚è€ƒè™‘å°†ç‚¹å’ŒåŒºé—´äº’æ¢ï¼Œé—®é¢˜ç­‰ä»·äºæ¯ä¸ªç‚¹èƒ½è¦†ç›–ä¸€äº›åŒºé—´ï¼Œä¸”è¦†ç›–çš„æ¦‚ç‡ä¸º $p = \frac{i - 1}{x}$ï¼Œç”¨ä¸€äº›ç‚¹å»è¦†ç›–æ‰€æœ‰åŒºé—´çš„æ¦‚ç‡ã€‚</p><p>å®¹æ˜“æƒ³åˆ° dpï¼Œè®¾ $l[i]$ è¡¨ç¤ºç‚¹ i è¦†ç›–çš„æœ€å·¦è¾¹çš„åŒºé—´ï¼Œ$r[i]$ æ˜¯æœ€å³è¾¹çš„ï¼Œ$f[i]$ è¡¨ç¤ºå¼ºåˆ¶é€‰ç¬¬ i ä¸ªç‚¹ï¼Œç„¶åè¦†ç›–äº† $1$ ~ $r[i]$ æ‰€æœ‰åŒºé—´çš„æ¦‚ç‡ï¼Œé‚£ä¹ˆ</p><p>$$f[i] = p \times (\sum\limits_{r[j] \ge l[i] - 1} f[j] \times (1 - p)^{i - 1 - j} + [l[i] = 1](1 - p)^{i - 1})$$</p><p>æœ€ç»ˆç­”æ¡ˆå°±æ˜¯ $\sum\limits_{r[i] = Q}f[i] \times (1 - p)^{n - i}$</p><p>ç›´æ¥åšæ˜¯ $n^3$ çš„ï¼Œå‰ç¼€å’Œç»´æŠ¤ä¸€ä¸‹å°±å¥½äº†ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e3</span> + <span class="number">10</span>, mod = <span class="number">666623333</span>;</span><br><span class="line"><span class="keyword">int</span> n, x, Q, top, L, R;</span><br><span class="line"><span class="keyword">int</span> stk[N], l[N], r[N];</span><br><span class="line">ll f[N], ans, pre[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span> <span class="keyword">int</span> l, r; &#125;q[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node a, node b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.l == b.l ? a.r &gt; b.r : a.l &lt; b.l;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ret = ret * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">    &#125; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prework</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    sort(q + <span class="number">1</span>, q + Q + <span class="number">1</span>, cmp);</span><br><span class="line">    rep(i, <span class="number">1</span>, Q) &#123;</span><br><span class="line">        <span class="keyword">while</span> (top &amp;&amp; q[stk[top]].r &gt;= q[i].r) --top;</span><br><span class="line">        stk[++top] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    Q = top;</span><br><span class="line">    rep(i, <span class="number">1</span>, Q) q[i] = q[stk[i]];</span><br><span class="line">    L = <span class="number">1</span>, R = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">while</span> (R &lt; Q &amp;&amp; q[R + <span class="number">1</span>].l &lt;= i) ++R;</span><br><span class="line">        <span class="keyword">while</span> (L &lt;= R &amp;&amp; q[L].r &lt; i) ++L;</span><br><span class="line">        l[i] = L, r[i] = R;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; x &gt;&gt; Q;</span><br><span class="line">    rep(i, <span class="number">1</span>, Q) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;q[i].l, &amp;q[i].r);</span><br><span class="line">    prework();</span><br><span class="line">    rep(i, <span class="number">1</span>, x) &#123;</span><br><span class="line">        ll sum = <span class="number">0</span>, tot = <span class="number">1</span>;</span><br><span class="line">        ll p = (i - <span class="number">1</span>) * qpow(x, mod - <span class="number">2</span>) % mod;</span><br><span class="line">        ll pp = mod + <span class="number">1</span> - p;</span><br><span class="line">        ll invp = qpow(pp, mod - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">int</span> lst = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">        f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        rep(j, <span class="number">1</span>, n) &#123;</span><br><span class="line">            <span class="keyword">while</span> (lst &lt; j &amp;&amp; r[lst] &lt; l[j] - <span class="number">1</span>)</span><br><span class="line">                tot = (tot - f[lst] * qpow(invp, lst) % mod + mod) % mod, ++lst;</span><br><span class="line">            f[j] = p * tot % mod * qpow(pp, j - <span class="number">1</span>) % mod;</span><br><span class="line">            tot = (tot + f[j] * qpow(invp, j) % mod) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = n; j &amp;&amp; r[j] == Q; --j) sum = (sum + f[j] * qpow(pp, n - j) % mod) % mod;</span><br><span class="line">        ans = (ans + <span class="number">1</span> - sum + mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¦‚ç‡ä¸æœŸæœ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[SHOI2016]-æˆç»©æ¯”è¾ƒ</title>
      <link href="2020/08/11/%5BSHOI2016%5D-%E6%88%90%E7%BB%A9%E6%AF%94%E8%BE%83/"/>
      <url>2020/08/11/%5BSHOI2016%5D-%E6%88%90%E7%BB%A9%E6%AF%94%E8%BE%83/</url>
      
        <content type="html"><![CDATA[<p>é¦–å…ˆå‘ç°æ°å¥½ K åç¢¾å‹çš„å¥½éš¾ç®—å•Šï¼è®¡æ•°é¢˜å˜›ï¼Œæƒ³åˆ°å®¹æ–¥ï¼Œf æ°å¥½ï¼Œg è‡³å°‘ï¼Œå¥—è·¯ä¸€æ³¢ã€‚</p><p>$$g(k) = C^{k}<em>{n - 1} \times ( \prod</em>{i = 1}^m C^{n - r_i - k}<em>{n - k - 1} \sum\limits</em>{j = 1}^{U_i} j^{n - r_i} (U_i - j)^{r_i - 1} )$$</p><p>å‘ç°å¾ˆæœ‰å¸Œæœ›ï¼Œä½†æ˜¯åé¢é‚£ä¸ª sigma ä¸å¤ªå¥½æï¼Œè€ƒè™‘æ‹¿å‡ºæ¥é¢„å¤„ç†ï¼Œè¿ç”¨äºŒé¡¹å¼å®šç†å¾—</p><p>$$\sum\limits_{l = 0}^{r_i - 1} C_{r_i - 1}^l (-1)^l U_i^{r_i - 1 - l} \sum\limits_{j = 1}^{U_i} j^{n - r_i + l}$$</p><p>åé¢é‚£ä¸ª sigma æ˜¯ä¸ªè‡ªç„¶æ•°å¹‚æ±‚å’Œï¼Œç”¨æ‹‰æ ¼æœ—æ—¥æ’å€¼æ³•æ±‚ï¼Œç„¶è€Œæˆ‘ä¸ä¼šæ‰€ä»¥<strong>å’•å’•</strong></p>]]></content>
      
      
      
        <tags>
            
            <tag> è®¡æ•° </tag>
            
            <tag> å®¹æ–¥åŸç† </tag>
            
            <tag> æ‹‰æ ¼æœ—æ—¥æ’å€¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 ç™¾åº¦ä¹‹æ˜Ÿç¨‹åºè®¾è®¡å¤§èµ› - å¤èµ›</title>
      <link href="2020/08/11/2020%20%E7%99%BE%E5%BA%A6%E4%B9%8B%E6%98%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%A4%A7%E8%B5%9B%20-%20%E5%A4%8D%E8%B5%9B/"/>
      <url>2020/08/11/2020%20%E7%99%BE%E5%BA%A6%E4%B9%8B%E6%98%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%A4%A7%E8%B5%9B%20-%20%E5%A4%8D%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><hr><p>A å˜åŒ–çš„æœŸæœ›å°±æ˜¯ (m - B æ”»å‡»æˆåŠŸçš„æœŸæœ›æ¬¡æ•°)ï¼ŒæŒºç®€å•çš„ä¸€é¢˜</p><h1 id="B"><a href="#B" class="headerlink" title="B"></a>B</h1><hr><p>é¢˜ç›®è¯»é”™äº†ï¼ˆè¿™ä¹Ÿèƒ½é”™ï¼Ÿï¼‰æˆ‘çœ‹æˆåœ¨ä»»æ„ä½ç½®åŠ ä¸€äº†å°±ä¸ä¼šåšå•Šå•Šå•Š</p><p>æ“ä½œäºŒåªä¼šæ‰§è¡Œä¸€æ¬¡æˆ–ä¸æ‰§è¡Œï¼Œå› ä¸ºæŠŠå‰é¢ä¸€ä¸²æ¸…é›¶äº†è¿˜è¦å˜æˆ 1 æ‰èƒ½å†åšæ“ä½œäºŒï¼Œç›®çš„ä»…ä»…ä¸ºäº†å°†åé¢ä¸€ä½å˜æˆ 1ï¼Œè¿™æ˜¾ç„¶ç”¨æ“ä½œä¸€å°±å¤Ÿäº†ã€‚ã€‚æšä¸¾æ“ä½œäºŒæŠŠå¤šé•¿çš„å‰ç¼€å˜æˆ 0 å°±å¥½äº†ã€‚</p><h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><hr><p>å°æ„é€ é¢˜ã€‚æœ€å°å’Œæœ€å¤§æ˜¯ç›¸ä¼¼çš„æƒ…å†µï¼Œè¿™é‡Œå°±è€ƒè™‘æœ€å¤§çš„ã€‚è€ƒè™‘æˆ‘ä»¬æƒ³è¦å¤§çš„æ•°è´¡çŒ®å°½é‡å¤§ï¼Œå¯ä»¥è¿™æ ·æ„é€ ï¼šl = 8, k = 3ï¼Œ000001110000011100000111â€¦ ä»å¤§åˆ°å°ä¾æ¬¡ç»™ 1 èµ‹å€¼ã€‚</p><h2 id="D"><a href="#D" class="headerlink" title="D"></a>D</h2><hr><p>å’•å’•</p><h2 id="E"><a href="#E" class="headerlink" title="E"></a>E</h2><hr><p>æ”»å‡»æ€»å…±æœ‰å››ç§æƒ…å†µï¼Œå…¶ä¸­å¦‚æœåŒä¸€è½®ä¸­ä¸¤ä¸ªäººéƒ½ miss äº†ç›¸å½“äºæ²¡æœ‰è´¡çŒ®ï¼Œå…·ä½“æ¥è¯´</p><p>è®¾ $f(n, m)$ ä¸ºä» (n, m) å‡ºå‘ï¼ŒAlice æ´»ä¸‹æ¥çš„æ¦‚ç‡ã€‚é‚£ä¹ˆ</p><p>$f(n, m) = f(n, m)(1 - p)(1 - q) + f(n, m - 1)p(1 - q) + f(n - 1, m)q(1 - p) + f(n - 1, m - 1)pq$</p><p>$f(n, m) = \frac{f(n, m - 1)p(1 - q) + f(n - 1, m)q(1 - p) + f(n - 1, m - 1)pq}{1 - (1 - p)(1 - q)}$</p><p>å¯ä»¥çœ‹ä½œ </p><ul><li>case 1: $(n, m)$ æœ‰ $a = \frac{pq}{1 - (1 - p)(1 - q)}$ çš„æ¦‚ç‡è½¬åˆ° $(n - 1, m - 1)$</li><li>case 2: æœ‰ $b = \frac{p(1 - q)}{1 - (1 - p)(1 - q)}$ çš„æ¦‚ç‡è½¬åˆ° $(n, m - 1)$</li><li>case 3: æœ‰ $c = \frac{q(1 - p)}{1 - (1 - p)(1 - q)}$ çš„æ¦‚ç‡è½¬åˆ° $(n - 1, m)$</li></ul><p>è®¾æœ€ç»ˆç§»åŠ¨åˆ°äº† $(r, 1)$ <strong>(ä¸ºä»€ä¹ˆä¸æ˜¯ $(r, 0)$ï¼Ÿå› ä¸ºæœ€åä¸€æ¬¡ Alice æŠŠ Bob æ‰“æ­»ï¼ŒBob æ²¡æœ‰æœºä¼šæ”»å‡» Alice)</strong> ï¼Œcase 1 æ“ä½œäº† $x$ æ¬¡ï¼Œé‚£ä¹ˆ case 2 æ“ä½œäº† $m - 1 - x$ æ¬¡ï¼Œcase 3 æ“ä½œäº† $n - r - x$ æ¬¡ï¼Œå°±å¯ä»¥å†™å‡ºæŸ¿å­ï¼š</p><p>$\sum\limits_{r = 1}^n \sum\limits_{x = 0}^{min(n - r, m - 1)} C(m - 1, x) \times C(m - 1 + n - r - x, m - 1) \times a^x b^{m - 1 - x} c^{n - r - x}$</p><p>è¿™ä¸ªä¸å¥½æï¼Œç»§ç»­æ¨ï¼Œè®¾ i = n - r - x</p><p>$\sum\limits_{x = 0}^{min(n - 1, m - 1)} a^xb^{m - 1 - x} C(m - 1, x) \sum\limits_{i = 0}^{n - 1 - x} C(m - 1 + i, i) c^i$</p><p>å…¶ä¸­åé¢é‚£ä¸ª sigma å¯ä»¥å‰ç¼€å’Œé¢„å¤„ç†ã€‚</p><h2 id="F"><a href="#F" class="headerlink" title="F"></a>F</h2><hr><p>å’•å’•</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘SAM</title>
      <link href="2020/08/10/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91SAM/"/>
      <url>2020/08/10/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91SAM/</url>
      
        <content type="html"><![CDATA[<p>ä»¥ å¤‡ é‡ ä¿®ï¼ˆæˆ‘è§‰å¾—è‡³å°‘è¿˜å¾—é‡ä¿®ä¸ªä¸‰å››æ¬¡ QAQï¼‰</p><p><a href="https://oi-wiki.org/string/sam/" target="_blank" rel="noopener">OI-wiki</a>ï¼ˆå›¾ç‰‡éå¸¸æ¸…æ™°ç›´è§‚ï¼‰</p><p><a href="https://www.cnblogs.com/Flying2018/p/13444085.html" target="_blank" rel="noopener">Flying2018å¤§ä½¬çš„è®²è§£</a></p><p>å‡ ä¸ªæ¦‚å¿µ/ä¸€ç‚¹ç†è§£ï¼š</p><ul><li>$len[u]$ è¡¨ç¤ºä»¥èŠ‚ç‚¹ $u$ ä¸ºå°¾å·´çš„æœ€é•¿è·¯å¾„ã€‚ä¹Ÿç­‰äºå®ƒæ’å…¥æ—¶çš„å­—ç¬¦ä¸²é•¿åº¦ã€‚</li><li>ä¸æ°å½“çš„æ¯”å–»ï¼š$SAM$ çš„è‚‰ä½“æ˜¯ä¸€æ£µå‹ç¼©çš„ $Trie$ æ ‘ï¼Œéª¨æ¶æ˜¯ $parent$ æ ‘ã€‚</li><li>èµ·ç‚¹åˆ°æ¯ä¸ªç»ˆæ­¢èŠ‚ç‚¹æ˜¯ä¸€æ¡ $S$ çš„åç¼€ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä»£è¡¨æŸä¸ªé•¿åº¦ä¸º $len[u]$ çš„å‰ç¼€çš„ä¸€äº›_é•¿åº¦å¤§äºæŸä¸€é•¿åº¦çš„åç¼€_ã€‚æ›´ç¡®åˆ‡çš„ï¼Œ$u$ è¡¨ç¤ºçš„å­ä¸²é•¿åº¦æ˜¯ $(len[fa], len[u]]$ èŒƒå›´å†…çš„ã€‚æœ¬è´¨ä¸åŒçš„å­ä¸²æ•°ç­‰äºä»èµ·ç‚¹å‡ºå‘çš„è·¯å¾„æ•°ï¼Œä¹Ÿç­‰äº $\sum len[u] - len[fa[u]]$ã€‚ï¼ˆ$SAM$ å½“ç„¶æ˜¯ä¸ª $DAG$ å•¦</li><li>æ ¹æ® $endpos$ çš„æ¦‚å¿µï¼Œæœ‰ç¥–å…ˆå…³ç³»çš„èŠ‚ç‚¹ $endpos$ æ˜¯å­é›†ï¼ˆå®Œå…¨åŒ…å«ï¼‰å…³ç³»ï¼Œæ²¡æœ‰ç¥–å…ˆå…³ç³»çš„èŠ‚ç‚¹ endpos å°±æ˜¯ä¸äº¤çš„ã€‚</li><li>æ¯æ¬¡åŠ å…¥ä¸€ä¸ªèŠ‚ç‚¹æœ€å¤šä¼šå¢åŠ ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œç©ºé—´å¤æ‚åº¦æ˜¯ $O(n)$ çš„ã€‚</li></ul><p>å‘ç‚¹ï¼š</p><ul><li>ç©ºé—´ä¸¤å€ QWQ</li></ul><h3 id="CF1037H"><a href="#CF1037H" class="headerlink" title="$CF1037H$"></a>$CF1037H$</h3><p>æ€è·¯æ˜¯è´ªå¿ƒã€‚</p><p>å¦‚æœ $l = 1$ï¼Œ$r = n$ï¼Œç”±äºè¦æ‰¾çš„æ˜¯å­—å…¸åºä¸¥æ ¼å¤§äº $T$ çš„ï¼Œæˆ‘ä»¬è€ƒè™‘æ‰¾ä¸€ä¸ª $S$ çš„å‰ç¼€ï¼Œåé¢è·Ÿä¸€ä¸ªç¨å¤§çš„å­—ç¬¦ $ch$ã€‚ç”¨ SAM æ±‚å‡ºæ¯ä¸€ä½çš„ $ch$ï¼Œæ²¡æœ‰çš„è¯å°±æ˜¯ $-1$. æœ€åå€’ç€æ‰¾ç¬¬ä¸€ä¸ªä¸ä¸º $-1$ çš„ã€‚</p><p>è€ƒè™‘ $l$ å’Œ $r$ æœ‰é™åˆ¶æ€ä¹ˆåšï¼Œå¢åŠ ä¸€æ­¥ï¼šæ‰¾ $ch$ çš„æ—¶å€™åˆ¤æ–­ $endpos$ é›†åˆé‡Œæœ‰æ— åŒºé—´ $[l, r]$ çš„ä¸²ã€‚</p><p>$endpos$ é›†åˆåœ¨è¿™é“é¢˜é‡Œå¿…é¡»æ±‚å‡ºï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ç»å…¸å¥—è·¯â€”â€”$parent$æ ‘ä¸Šè·‘çº¿æ®µæ ‘åˆå¹¶ã€‚</p><h3 id="CF700E"><a href="#CF700E" class="headerlink" title="$CF700E$"></a>$CF700E$</h3><p>å­ä¸²å•Šä»€ä¹ˆçš„è€ƒè™‘ SAMã€‚</p><p>è€ƒè™‘åˆ° $s_i$ å¿…ç„¶æ˜¯ $s_{i + 1}$ çš„å‰ç¼€å’Œåç¼€ï¼ˆä¸ç„¶å‰Šæ‰å‰/åç¼€ä¸ä¼šæ›´åŠ£ï¼‰ï¼Œåœ¨ $parent$ æ ‘ä¸Šä½“ç°ä¸º $s_i$ æ˜¯ $s_{i + 1}$ çš„ç¥–å…ˆï¼Œäºæ˜¯æƒ³åˆ° $dp$ï¼Œæ‰¾æœ€é•¿é“¾</p><p>æ€ä¹ˆåˆ¤æ–­å‡ºç°äº†ä¸¤æ¬¡å‘¢ï¼Ÿè®°å½•ä»»æ„ä¸€ä¸ª $s_{i + 1}$ çš„ä½ç½®ï¼Œ$endpos$ é›†åˆç”¨çº¿æ®µæ ‘åˆå¹¶ï¼Œå°±èƒ½æŸ¥è¯¢äº†ã€‚</p><h3 id="åŒºé—´æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°"><a href="#åŒºé—´æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°" class="headerlink" title="$åŒºé—´æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°$"></a><a href="https://www.luogu.com.cn/problem/P6292" target="_blank" rel="noopener">$åŒºé—´æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°$</a></h3><p>ç±»ä¼¼äºâ€œåŒºé—´å…ƒç´ æ•°â€ï¼Œæˆ‘ä»¬ç¦»çº¿è¯¢é—®ï¼Œç»™æ¯ç§å…ƒç´ é€‰ä¸€ä¸ªç‰¹å¾ç‚¹ï¼Œå¯¹äºæ¯ä¸ªå³ç«¯ç‚¹ç»´æŠ¤å·¦ç«¯ç‚¹çš„ç­”æ¡ˆã€‚å…·ä½“æ¥è¯´ï¼Œæ¯æ¬¡æ›´æ–°ä»¥å½“å‰ä½ç½®ä¸ºå³ç«¯ç‚¹çš„ä¸²çš„ $lstpos$ï¼Œä¸€ä¸ªé•¿åº¦ä¸º $T$ çš„ä¸²å¯¹å·¦ç«¯ç‚¹åœ¨ $[1, lstpos - T + 1]$ çš„è¯¢é—®æœ‰è´¡çŒ®ã€‚</p><p>è€ƒè™‘ $SAM$ï¼ŒåŒºé—´å³ç«¯ç‚¹å³ç§»è‡³ $r$ åœ¨ $SAM$ ä¸Šå°±è¦æŠŠä¸€æ•´æ¡è·¯å¾„é›†åˆé‡Œçš„å­ä¸² $lstpos$ æ›´æ”¹ä¸º $r$ã€‚æš´åŠ›åšæ˜¾ç„¶è¡¥æ˜Ÿã€‚è¿™æ˜¯ä¸ªé“¾èµ‹å€¼æ“ä½œï¼Œäºæ˜¯è€ƒè™‘ $LCT$ + $tag$ã€‚æ¯ä¸ªä½ç½® $access$ ååˆ°æ ¹çš„è·¯å¾„ä¸Š $lstpos$ éƒ½ç›¸åŒï¼Œä¸”ä»£è¡¨çš„å­ä¸²é•¿åº¦è¿ç»­ï¼ˆæ ¹æ® $endpos$ çš„å®šä¹‰ï¼‰ï¼Œå¯ä»¥ç›´æ¥åŒºé—´ä¿®æ”¹åŒºé—´æŸ¥è¯¢ã€‚</p><h3 id="äº‹æƒ…çš„ç›¸ä¼¼åº¦"><a href="#äº‹æƒ…çš„ç›¸ä¼¼åº¦" class="headerlink" title="$äº‹æƒ…çš„ç›¸ä¼¼åº¦$"></a><a href="https://loj.ac/p/6041" target="_blank" rel="noopener">$äº‹æƒ…çš„ç›¸ä¼¼åº¦$</a></h3><p>ä¸¤ä¸ªå‰ç¼€ $x$ å’Œ $y$ çš„æœ€é•¿å…¬å…±åç¼€å°±æ˜¯ $parent$ æ ‘ä¸Šçš„ $len[lca(x, y)]$ã€‚ç°åœ¨è¦æ±‚åŒºé—´æœ€æ·± $len[lca]$ã€‚</p><p>è€ƒè™‘ç¦»çº¿è¯¢é—®ï¼Œæ¯æ¬¡å³ç§»è€ƒè™‘ $r$ çš„è´¡çŒ®ã€‚$SAM$ ä¸Šæ¯ä¸ªç‚¹ç»´æŠ¤å®ƒåˆ°ç›®å‰è¢«åˆ°è¾¾çš„æœ€å¤§æ—¶é—´ï¼Œ$LCT$ $access$ èµ‹å€¼æ‰“æ ‡è®°ï¼ˆåŒä¸€æ¡é“¾ä¸Šçš„æœ€å¤§æ—¶é—´è‚¯å®šç›¸åŒï¼‰ï¼Œæ¯æ¬¡è·³ $parent$ æ ‘æ›´æ–°ç­”æ¡ˆï¼Œæ³¨æ„æ›´æ–°çš„æ˜¯ä¸€ä¸ªåŒºé—´çš„ç­”æ¡ˆï¼Œçº¿æ®µæ ‘å– $\max$ã€‚</p><p>è¿˜æœ‰ä¸€ç§åšæ³•ï¼šå®¹æ˜“æƒ³åˆ° $dfn$ åºè¶Šè¿‘çš„å¯¹è¶Šä¼˜ç§€ï¼Œä¸æ˜¯æœ€è¿‘çš„å¯¹å¯¹äºç­”æ¡ˆæ²¡æœ‰è´¡çŒ®ã€‚æƒ³åˆ°å¯å‘å¼åˆå¹¶ $endpos$ é›†åˆï¼Œ$set$ ç»´æŠ¤ï¼Œæ‰¾å‰é©±åç»§ã€‚â€”â€”æŸ¥è¯¢åŒºé—´å•Šï¼Œæ€ä¹ˆåŠï¼Ÿæ³¨æ„åˆ°æ˜¯ä¸‰å…ƒç»„ $(l, r, v)$ ï¼Œä¸¢åˆ°äºŒç»´å¹³é¢ä¸ŠäºŒç»´æ•°ç‚¹å°±å¥½ã€‚</p><p>è®°å½• xml çš„æ¯æ—¥ sbï¼š**$parent$ æ ‘ä¸ŠèŠ‚ç‚¹ $x$ çš„ç¥–å…ˆ $id$ ä¸€å®šéƒ½å°äº $x$ï¼Œåä»£ä¸ä¸€å®šå°äº $x$ã€‚ä¸ºä»€ä¹ˆï¼Ÿæ€ä¹ˆå»ºæ ‘çš„ä½ çœ‹çœ‹å»ã€‚** æ‰€ä»¥è¦å¤„ç†ä¸€ä¸ªæŒ‰é•¿åº¦ä»å¤§åˆ°å°çš„æ“ä½œåºåˆ—ã€‚</p><p>éƒ½æ˜¯ä¸¤åª $log$ çš„ã€‚å› ä¸ºã€ŒåŒºé—´æœ¬è´¨ä¸åŒå­ä¸²ã€å†™è¿‡ç¬¬ä¸€ç§åšæ³•å•¦ï¼Œè¿™é‡Œæƒ³è¯•è¯•ç¬¬äºŒç§ï¼ï¼ˆå“¦å‘¼</p><p><a href="https://loj.ac/s/1022230" target="_blank" rel="noopener">$Code$</a></p><h3 id="BJWC2018-Border-çš„å››ç§æ±‚æ³•"><a href="#BJWC2018-Border-çš„å››ç§æ±‚æ³•" class="headerlink" title="$BJWC2018-Border çš„å››ç§æ±‚æ³•$"></a><a href="https://www.luogu.com.cn/problem/P4482" target="_blank" rel="noopener">$BJWC2018-Border çš„å››ç§æ±‚æ³•$</a></h3><p>ç¥é¢˜ï¼Œæ¯”ã€ŒåŒºé—´æœ¬è´¨ä¸åŒå­ä¸²ã€å’Œã€Œäº‹æƒ…çš„ç›¸ä¼¼åº¦ã€é«˜åˆ°ä¸çŸ¥é“å“ªé‡Œå»äº†ã€‚</p><p>å¾€ $SAM$ æƒ³ï¼Œç®€ç›´ä¸€è„¸è’™è”½å•Šã€‚ã€‚è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦ä¸€äº›<strong>å½¢å¼åŒ–</strong>ï¼šå¯»æ‰¾æœ€å¤§çš„ $i$ æ»¡è¶³ $i - l + 1 \leq lcs(r, i)$ï¼Œ$lcs$ æ˜¯æœ€é•¿å…¬å…±åç¼€</p><p>å¦‚æœæ•°æ®éšæœºï¼Œé‚£ $parent$ æ ‘é•¿å¾—å°±æ¯”è¾ƒå¹³è¡¡ï¼Œæ ‘é«˜ $log$ï¼Œæš´è·³ + æŸ¥è¯¢æ¯ä¸ª $r$ çš„ç¥–å…ˆ $endpos$ é›†åˆé‡Œæ»¡è¶³é™åˆ¶çš„ $i$ æœ€å¤§å€¼ï¼Œçº¿æ®µæ ‘åˆå¹¶ $endpos$ å³å¯ã€‚</p><p>å¦‚æœä¸éšæœºå‘¢ï¼Ÿæ ‘é«˜å°± $O(n)$ å•¦ã€‚ä¸ä¼šåšå•¦ï¼Œ$GG$ å•¦ã€‚çœ‹é¢˜è§£å•¦ã€‚ <a href="https://www.luogu.com.cn/blog/c2522943959/solution-p4482" target="_blank" rel="noopener">é¢˜è§£</a></p><p>æ ‘åˆ†æ²»/é“¾åˆ†æ²»ï¼Œå¯¹é‡è¾¹çš„å¤„ç†å’Œè½»è¾¹çš„åˆå¹¶åŠå¤„ç†å¾€å¾€å…·æœ‰ä¼˜ç§€çš„å®ç°æ–¹æ³•åŠå¤æ‚åº¦ï¼Œè¢«å¥—åœ¨æ ‘ä¸Šé—®é¢˜ä¹Ÿæ˜¯å¾ˆå¸¸è§çš„å•Šå•¦å•¦ï¼ï¼</p><p>è€ƒè™‘ä¸€ä¸ªè¯¢é—®æŸ¥è¯¢äº†å…¶å­æ ‘çš„è´¡çŒ®å’Œå…¶æ‰€æœ‰ç¥–å…ˆåŠç¥–å…ˆå…¶ä»–å­æ ‘çš„è´¡çŒ®ï¼Œå­æ ‘è´¡çŒ®å¯ä»¥çº¿æ®µæ ‘åˆå¹¶ç…§æ—§ç®—ã€‚ç¥–å…ˆå‘¢ï¼Ÿ</p><p>è€ƒè™‘é‡é“¾å‰–åˆ†åæŠŠè¯¢é—®å¤åˆ¶ $log$ ä»½æŒ‚åˆ°ç¥–å…ˆé‡é“¾ä¸Šï¼ˆä¸å®ƒåˆ°æ ¹çš„è·¯å¾„äº¤å‰éƒ¨åˆ†çš„æœ«ç«¯ï¼‰ï¼Œè¿™æ ·å°±åªè¦åˆ†åˆ«å¤„ç†æ¯æ¡é“¾çš„è¯¢é—®äº†ã€‚æ€»ç‚¹æ•° $O(nlogn)$ã€‚</p><p>æ¯æ¡é“¾ä»ä¸Šåˆ°ä¸‹æŠŠè½»å„¿å­çš„è´¡çŒ®åˆå¹¶è¿›æ¥ï¼Œå¯ä»¥æš´åŠ›æ’è´¡çŒ®å› ä¸ºè½»å„¿å­æ€»æ•°ä¹Ÿå°± $O(nlogn)$ï¼Œæ‹¿ä¸€ä¸ªä¸‹æ ‡ä¸º $i$ã€æƒå€¼ä¸º $i - len[lca] + 1$ çš„çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´æœ€å°å€¼ï¼Œè¿™æ ·æŸ¥è¯¢åœ¨çº¿æ®µæ ‘ä¸ŠäºŒåˆ†ã€æ ¹æ®æœ€å°å€¼åšå‡ºå†³ç­–å°±å¯ä»¥äº†ã€‚</p><p>è¯´è¯´å°±å¥½çƒ¦äº†å‘¢qwqï¼Œå†™äº†ä¸€æ™šä¸Š + è°ƒäº†åŠä¸ªä¸Šåˆ 200 è¡Œç»ˆäº AC äº†å‘¢qwqï¼å¤šæƒ³ï¼Œå¤šæ€è€ƒã€‚</p><p><a href="https://www.luogu.com.cn/record/44414778" target="_blank" rel="noopener">$Code$</a></p><h3 id="NOI2018-ä½ çš„åå­—"><a href="#NOI2018-ä½ çš„åå­—" class="headerlink" title="$NOI2018-ä½ çš„åå­—$"></a><a href="https://loj.ac/p/2720" target="_blank" rel="noopener">$NOI2018-ä½ çš„åå­—$</a></h3><p>é—®å•¥ï¼Ÿè¯¢é—®ä¸²æœ‰å¤šå°‘ä¸ªå­ä¸²ä¸æ˜¯å¦ä¸€ä¸ªè¯¢é—®ä¸²çš„å­ä¸²ã€‚æˆ‘ä»¬è¦æ±‚çš„æ˜¯ç”¨ T çš„æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•° - ä¸¤ä¸²æœ¬è´¨ä¸åŒå…¬å…±å­ä¸²ä¸ªæ•°ã€‚</p><p>å‡è®¾ $l = 1$, $r = |S|$, ç­”æ¡ˆå°±æ˜¯ $\sum\limits_{i = 2}^{T.cnt} max(0, len[i] - max(len[fa[i]], ç¬¬ä¸€æ¬¡èµ°åˆ° i çš„ T ä¸²ä½ç½®ä¸ S çš„ LCS))$ ä¸ºä»€ä¹ˆæ˜¯ç¬¬ä¸€æ¬¡èµ°åˆ°ï¼Ÿç¬¬ä¸€æ¬¡èµ°åˆ°å°±æ˜¯æœ€è¿œçš„å˜›ï¼Œæ˜¯ $(len[fa[i]], len[i]]$ çš„ $len[i]$ è€Œä¸æ˜¯ $len[fa[i]] + 1$ã€‚ä¸ºä»€ä¹ˆè¦æœ€è¿œï¼Ÿæœ¬è´¨ä¸åŒå…¬å…±å­ä¸²ä¸ªæ•°ç­‰äºè¦åœ¨ $parent$ æ ‘ä¸Šå–è·¯å¾„å¹¶å•Šã€‚</p><p>è‹¥ $l$ å’Œ $r$ ä»»æ„ï¼ŒåŠ ä¸€ä¸ªçº¿æ®µæ ‘åˆå¹¶ $endpos$ é›†åˆå¸®åŠ©åœ¨è·³ $S$ çš„ $parent$ æ ‘æ—¶åˆ¤æ–­å½“å‰ä½ç½®æ˜¯å¦åˆæ³•ï¼Œå°±å¯ä»¥äº†ã€‚</p><hr><p>å¹¿ä¹‰ SAMï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> SAM </tag>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XJOI200808 é¢˜è§£</title>
      <link href="2020/08/08/XJOI200808%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/08/08/XJOI200808%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><hr><p>å’•å’•</p><h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><hr><p>éƒ¨åˆ†åˆ†æé†’æ­£è§£ã€‚è€ƒè™‘ n &lt;= 2 æ—¶ï¼Œè®¾ $a_1 = A$, $a_2 = B$ï¼Œé‚£ä¹ˆ A å…ˆå–å®Œæ—¶æœŸæœ›ä¸ªæ•°å°±æ˜¯ $a_1 + \sum\limits_{i = 0}^{B - 1} \frac{C(A - 1 + i, i)}{2^{B + 1}} i$ï¼ŒB å…ˆå–å®Œæ—¶å°±æ˜¯ $a_1 + \sum\limits_{i = 0}^{A - 1} \frac{C(B - 1 + i, i)}{2^{B + 1}} B$ã€‚</p><p>æ ¹æ®æœŸæœ›çš„çº¿æ€§æ€§è´¨ï¼Œ$ans = (\sum\limits_{i = 2}^n {ç¬¬ i ä¸ªè¢«æ‹¿çš„æœŸæœ›ä¸ªæ•°}) + a_1$ã€‚ç°åœ¨å°±æ˜¯æ€ä¹ˆæ±‚è§£æ¯ç§çƒçš„æœŸæœ›ä¸ªæ•°ã€‚æˆ‘ä»¬è®¾ç¬¬ i ç§çƒçš„æœŸæœ›ä¸ªæ•°ä¸º $f_i$ã€‚</p><p>æ³¨æ„åˆ°é€‰é¢œè‰²æ˜¯<strong>ç­‰æ¦‚ç‡</strong>çš„ã€‚æœ¬é¢˜ä¸­å”¯ä¸€çš„é™åˆ¶å°±æ˜¯ç¬¬ä¸€ç§çƒå¿…é¡»å–å®Œï¼Œé‚£ä¹ˆ $f_i$ åªä¸åœ¨ç¬¬ä¸€ç§çƒå–å®Œå‰ å–äº†å¤šå°‘ä¸ªç¬¬ i ç§çƒæœ‰å…³ï¼Œå–å…¶ä»–çƒå¯¹å®ƒä»¬æ²¡æœ‰å½±å“ï¼Œè€Œä¸”å®ƒä»¬è¢«å–çš„æ¦‚ç‡æ˜¯ç›¸åŒçš„ï¼Œé‚£å°±ç­‰ä»·äºä¹‹å‰çš„éƒ¨åˆ†åˆ†ç®—æ³•ã€‚è¿™æ ·æ˜¯ 60 åˆ†ã€‚</p><p>è€ƒè™‘ä¼˜åŒ–ï¼šå°†ä¸Šé¢çš„æ–¹æ³•çœ‹ä½œä» $(a_1, a_i)$ å‡ºå‘æ¯æ¬¡éšæœºå‘ä¸‹æˆ–å‘å·¦èµ°ä¸€æ­¥ï¼Œç›´åˆ°èµ°åˆ°åæ ‡è½´ã€‚èµ°åˆ° $(0, a)$ çš„è´¡çŒ®æ˜¯ $a_i - a$ï¼Œèµ°åˆ° $(a, 0)$ çš„è´¡çŒ®æ˜¯ $a_i$ï¼Œå°±èƒ½åˆ—å‡ºè´¡çŒ®æŸ¿å­ï¼š</p><p>$$f_i = \sum\limits_{j = 0}^{a_i - 1} \frac{C(a_1 - 1 + j, j)}{2^{a_1 + j}} \times j + a_i(1 - \sum\limits_{j = 0}^{a_i - 1} \frac{C(a_1 - 1 + j, j)}{2^{a_1 + j}})$$</p><p>å®¹æ˜“å‘ç° $a_i$ å¢åŠ  1 çš„æ—¶å€™ ä¸¤éƒ¨åˆ†çš„è´¡çŒ®åˆ†åˆ«éƒ½åªä¼šå¢åŠ ä¸€é¡¹ï¼Œå¯ä»¥ O(1) ç®—ï¼è¿™æ ·å°±èƒ½çº¿æ€§æ±‚è§£äº†ï¼Œæ˜¯ O(å€¼åŸŸ) çš„ã€‚</p><h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><hr><p>å’•å’•</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
            <tag> æ¨¡æ‹Ÿèµ› </tag>
            
            <tag> æ¦‚ç‡ä¸æœŸæœ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[UOJ310]-é»æ˜å‰çš„å·§å…‹åŠ›</title>
      <link href="2020/08/08/%5BUOJ310%5D-%E9%BB%8E%E6%98%8E%E5%89%8D%E7%9A%84%E5%B7%A7%E5%85%8B%E5%8A%9B/"/>
      <url>2020/08/08/%5BUOJ310%5D-%E9%BB%8E%E6%98%8E%E5%89%8D%E7%9A%84%E5%B7%A7%E5%85%8B%E5%8A%9B/</url>
      
        <content type="html"><![CDATA[<p>æ±‚çš„å°±æ˜¯ $\sum\limits_{xor(S) = 0} 2^{|S|}$</p><p><strong>è€ƒè™‘å®ƒçš„ç”Ÿæˆå‡½æ•°</strong>: $\prod (1 + 2x^)$ï¼Œå…¶ä¸­è¿™é‡Œçš„ $\prod$ è¡¨ç¤ºå¼‚æˆ–å·ç§¯</p><p>ç›´æ¥ FWT + ç‚¹ä¹˜ è‚¯å®šä¸è¡Œã€‚ã€‚</p><p>å‘ç°å¯¹ $(1 + 2x^{a_i})$ åš FWT åçš„ç‚¹å€¼ä¸æ˜¯ -1 å°±æ˜¯ 3ï¼ˆ1 ä¹Ÿå°±æ˜¯ $x^0$ï¼Œå®ƒå¯¹æ¯ä½çš„è´¡çŒ®æ˜¯ 1ï¼Œ$2x^{a_i}$ å¯¹æ¯ä½çš„è´¡çŒ®æ˜¯ 2 æˆ– -2ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªè¦çŸ¥é“æ¯ä½æœ‰å¤šå°‘ä¸ª -1/3 å°±å¥½äº†</p><p>æœ‰ä¸ªæ€§è´¨ï¼šçº¿æ€§å˜æ¢çš„å’Œ = å’Œçš„çº¿æ€§å˜æ¢ï¼Œäºæ˜¯æˆ‘ä»¬æŠŠæ‰€æœ‰å¤šé¡¹å¼åŠ èµ·æ¥åšä¸€é FWTï¼Œå¯¹äºç¬¬ $i$ ä½è®¾æœ‰ $k$ ä¸ª -1ï¼Œé‚£ä¹ˆ $-k + 3(n - k) = f_i$ï¼ˆ$f_i$ å°±æ˜¯å’Œçš„ FWTï¼‰ï¼Œå°±èƒ½è§£å‡º $k$ï¼Œä¹Ÿå°±å¾—åˆ°äº†ç¬¬ $i$ ä½ç‚¹ä¹˜çš„ç»“æœï¼ç„¶åä¸€é IFWT å°±å¥½äº†ï¼ï¼</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>, N = <span class="number">2e6</span> + <span class="number">10</span>, inv2 = (mod + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">ll n, a[N], f[N], bit3[N];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quick_pow</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ret = ret * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">    &#125; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FWT_xor</span><span class="params">(ll a[], <span class="keyword">int</span> n, <span class="keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        rep(j, <span class="number">0</span>, (<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> (!((j &gt;&gt; (i - <span class="number">1</span>)) &amp; <span class="number">1</span>)) &#123;</span><br><span class="line">                ll x = a[j], y = a[j + (<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>))];</span><br><span class="line">                a[j] = (x + y) % mod, a[j + (<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>))] = (x - y + mod) % mod;</span><br><span class="line">                <span class="keyword">if</span> (op == <span class="number">-1</span>) (a[j] *= inv2) %= mod, (a[j + (<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>))] *= inv2) %= mod;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    f[<span class="number">0</span>] = n;</span><br><span class="line">    bit3[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]);</span><br><span class="line">        bit3[i] = bit3[i - <span class="number">1</span>] * <span class="number">3</span> % mod;</span><br><span class="line">        f[a[i]] += <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    FWT_xor(f, <span class="number">20</span>, <span class="number">1</span>);</span><br><span class="line">    ll inv4 = quick_pow(<span class="number">4</span>, mod - <span class="number">2</span>);</span><br><span class="line">    rep(i, <span class="number">0</span>, (<span class="number">1</span> &lt;&lt; <span class="number">20</span>) - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> k = ((<span class="number">3</span> * n - f[i] + mod) % mod) * inv4 % mod;</span><br><span class="line">        f[i] = (k &amp; <span class="number">1</span> ? mod - bit3[n - k] : bit3[n - k]);</span><br><span class="line">    &#125;</span><br><span class="line">    FWT_xor(f, <span class="number">20</span>, <span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, (f[<span class="number">0</span>] - <span class="number">1</span> + mod) % mod);  <span class="comment">// å‡å»ç©ºé›†</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> é›†åˆå¹‚çº§æ•° </tag>
            
            <tag> ç”Ÿæˆå‡½æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘é›†åˆå¹‚çº§æ•°</title>
      <link href="2020/08/07/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%9B%86%E5%90%88%E5%B9%82%E7%BA%A7%E6%95%B0/"/>
      <url>2020/08/07/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E9%9B%86%E5%90%88%E5%B9%82%E7%BA%A7%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ‰“å¼€äº†æ–°ä¸–ç•Œçš„å¤§é—¨ã€‚</span><br></pre></td></tr></table></figure><p>æŠ½ä¸ªæ—¶é—´è¡¥ä¸€ä¸‹ ~ ä¸å†™ç‚¹ä»€ä¹ˆè¿™ç©æ„å¾ˆå¿«å°±åœ¨å¤§è„‘é‡Œå°±å˜æˆé»‘ç®±å­äº†ã€‚</p><h2 id="FMT"><a href="#FMT" class="headerlink" title="FMT"></a>FMT</h2><hr><p>ç”¨æ¥è®¡ç®—é›†åˆå¹‚çº§æ•°ä¹˜æ³•ã€‚è¿˜æœ‰ä¸€ç§åˆ†æ²»ä¹˜æ³•ï¼Œæœ¬è´¨ç›¸åŒã€‚</p><p>FMT: $\hat{f_S} = \sum\limits_{T \subseteq S} f_T$</p><p>FMIï¼š$f_S = \sum\limits_{T \subseteq S} (-1)^{|S| - |T|} \hat{f_T}$</p><p>ï¼ˆå­é›†åæ¼”å°±æ˜¯ FMT å’Œ FMIï¼‰</p><p>ä¸€ä¸ªé›†åˆå¹‚çº§æ•°æœ‰é€†å…ƒå½“ä¸”ä»…å½“ FMT åæ‰€æœ‰ç³»æ•°å‡ä¸ä¸º $0$ã€‚</p><p>ç±»ä¼¼ FFT å¸¦ $n$ æ¬¡å•ä½æ ¹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä½œå¾€é‡Œå¸¦äº†ä¸€å †ç‰¹å¾å‘é‡æœ€åæ’å€¼æ’äº†å›æ¥ã€‚ä½†æ˜¯ç”±äºåšä¸»è¿‡èœï¼Œè®ºæ–‡è¿™éƒ¨åˆ†æ²¡çœ‹å¤ªæ‡‚ã€‚ã€‚</p><h2 id="FWT"><a href="#FWT" class="headerlink" title="FWT"></a>FWT</h2><hr><p>æœ‰ç»“è®ºï¼šå¯¹äºä¸€ä¸ªé›†åˆ $S$ æœ‰ $\frac{1}{2^n} \sum\limits_{T \subseteq 2^U}(-1)^{|S\cap T|} = [S = \emptyset]$ï¼Œè¯æ˜è€ƒè™‘ $S$ ä¸ä¸ºç©ºæ—¶ä» $S$ é‡Œæ‹èµ°ä¸€ä¸ªæ•°å $-1$ çš„æ­£è´Ÿæ€§æ”¹å˜ï¼Œä¸æ‹èµ°å‰çš„æŠµæ¶ˆã€‚</p><p>é‚£ä¹ˆå¯¹äºå¼‚æˆ–å·ç§¯ $h_S = \sum\limits_{L \subseteq 2^U} \sum\limits_{R \subseteq 2^U} [L \oplus R = S] f_Lg_R$ å°±æœ‰æ–°çš„æ€è·¯ï¼š</p><p>$$h_S = \sum\limits_{L \subseteq 2^U} \sum\limits_{R \subseteq 2^U} [L \oplus R \oplus S = \emptyset] f_Lg_R$$</p><p>$$= \sum\limits_{L \subseteq 2^U} \sum\limits_{R \subseteq 2^U} \frac{1}{2^n} \sum\limits_{T \subseteq 2^U} (-1)^{|T \cap (L \oplus R \oplus S)|} f_Lg_R$$</p><p>$$= \sum\limits_{L \subseteq 2^U} \sum\limits_{R \subseteq 2^U} \frac{1}{2^n} \sum\limits_{T \subseteq 2^U} (-1)^{|T \cap L|} (-1)^{|T \cap R|} (-1)^{|T \cap S|} f_Lg_R$$</p><p>$$= \frac{1}{2^n} \sum\limits_{T \subseteq 2^U} (-1)^{|T \cap S|} ( \sum\limits_{L \subseteq 2^U} (-1)^{|T \cap L|} f_L ) ( \sum\limits_{R \subseteq 2^U} (-1)^{|T \cap R|} g_R )$$</p><p>äºæ˜¯å®šä¹‰ FWTï¼š$\hat{f_S} = \sum\limits_{T \subseteq 2^U} (-1)^{|T \cap S|} f_T$</p><p>IFWTï¼š$\hat{f_S} = \frac{1}{2^n} \sum\limits_{T \subseteq 2^U} (-1)^{|T \cap S|} f_T$</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FWT_xor</span><span class="params">(ll a[], <span class="keyword">int</span> op = <span class="number">1</span>)</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        rep(j, <span class="number">0</span>, (<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> (!((j &gt;&gt; (i - <span class="number">1</span>)) &amp; <span class="number">1</span>)) &#123;</span><br><span class="line">                ll x = a[j], y = a[j + (<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>))];</span><br><span class="line">                a[j] = (x + y) % mod, a[j + (<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>))] = (x - y + mod) % mod;</span><br><span class="line">                <span class="keyword">if</span> (op == <span class="number">-1</span>) (a[j] *= inv2) %= mod, (a[j + (<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>))] *= inv2) %= mod;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Or-å’Œ-And-å·ç§¯"><a href="#Or-å’Œ-And-å·ç§¯" class="headerlink" title="Or å’Œ And å·ç§¯"></a>Or å’Œ And å·ç§¯</h2><hr><p>ä»¥ Or ä¸ºä¾‹ï¼š</p><p>$$h_S = \sum\limits_{L \subseteq 2^U} \sum\limits_{R \subseteq 2^U} [L \cup R = S] f_Lg_R$$</p><p>å¯¹ä¸¤è¾¹åŒæ—¶åš FMT</p><p>$$\hat{h_S} = \sum\limits_{L \subseteq 2^U} \sum\limits_{R \subseteq 2^U} [L \cup R \subseteq S] f_Lg_R$$</p><p>$$= \sum\limits_{L \subseteq 2^U} \sum\limits_{R \subseteq 2^U} [L \subseteq S][R \subseteq S] f_Lg_R$$</p><p><strong>Or å·ç§¯æœ¬è´¨æ˜¯é«˜ç»´å‰ç¼€å’Œã€‚</strong> </p><p>And å·ç§¯å–åååš Or å·ç§¯å†å–åä¹Ÿæ˜¯å¯è¡Œçš„ qwqã€‚å½“ç„¶ä¹Ÿæœ‰æœ´ç´ çš„åˆ†æ²»ä¹˜æ³•ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FWT_or</span><span class="params">(ll a[], <span class="keyword">int</span> op = <span class="number">1</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt; (<span class="number">1</span> &lt;&lt; n); k &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; n); i += (k &lt;&lt; <span class="number">1</span>))</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; k; ++j)</span><br><span class="line">                a[i + j + k] = (a[i + j + k] + a[i + j] * op + mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FWT_and</span><span class="params">(ll a[], <span class="keyword">int</span> op = <span class="number">1</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt; (<span class="number">1</span> &lt;&lt; n); k &lt;&lt;= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; n); i += (k &lt;&lt; <span class="number">1</span>))</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; k; ++j)</span><br><span class="line">                a[i + j] = (a[i + j] + a[i + j + k] * op + mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// FMT(= FWT_and)</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FMT</span><span class="params">(<span class="keyword">int</span> op = <span class="number">1</span>)</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        rep(j, <span class="number">0</span>, (<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> ((j &gt;&gt; (i - <span class="number">1</span>)) &amp; <span class="number">1</span>)</span><br><span class="line">                f[j] = (f[j] + f[j - (<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>))] * op + mod) % mod;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å­é›†å·ç§¯"><a href="#å­é›†å·ç§¯" class="headerlink" title="å­é›†å·ç§¯"></a>å­é›†å·ç§¯</h2><hr><p>$$\hat{h_S} = \sum\limits_{L \subseteq 2^U} \sum\limits_{R \subseteq 2^U} [L \cup R = S] [L \cap R = \emptyset] f_Lg_R$$</p><p>ç›´æ¥æšä¸¾å­é›† $3^n$ã€‚</p><p>$[L \cup R = S] [L \cap R = \emptyset] = [L \oplus R = S][|L| + |R| = |S|]$ï¼Œè®°å½•ä¸€ä¸ªå ä½æ•°é‡ï¼Œåˆ†å±‚å·ã€‚åº”è¯¥æ»¡è¶³ $1$ çš„ä¸ªæ•°æ°å¥½ä¸ºä¸¤è€…ä¹‹å’Œï¼Œ<strong>å¦åˆ™æ¸…ç©º</strong>ã€‚$O(n^22^n)$</p><h2 id="æ‹“å±•ï¼ˆ-K-è¿›åˆ¶å¼‚æˆ–å·ç§¯ï¼‰"><a href="#æ‹“å±•ï¼ˆ-K-è¿›åˆ¶å¼‚æˆ–å·ç§¯ï¼‰" class="headerlink" title="æ‹“å±•ï¼ˆ$K$ è¿›åˆ¶å¼‚æˆ–å·ç§¯ï¼‰"></a>æ‹“å±•ï¼ˆ$K$ è¿›åˆ¶å¼‚æˆ–å·ç§¯ï¼‰</h2><hr><p>And, Or å·ç§¯åœ¨ $K$ è¿›åˆ¶ä¸‹å¯ä»¥æ‹“å±•ä¸ºå– $\min$, $\max$ï¼Œåšé«˜ç»´å‰ç¼€å’Œã€‚</p><p>$K$ è¿›åˆ¶ä¸‹çš„ Xor å…¶å®æ˜¯ä¸¤ä¸ªå‘é‡åˆ—å¯¹åˆ—çš„ä¸è¿›ä½å–æ¨¡åŠ æ³•ï¼Œ<strong>æ˜¯ä¸ªé«˜ç»´ DFT</strong>ï¼Œå³<strong>åœ¨ $n$ ä¸ªç»´åº¦ä¸Šåˆ†åˆ«åšå¤§å°ä¸º $K$ çš„å¾ªç¯å·ç§¯</strong>ï¼Œå› æ­¤éœ€è¦ç”¨åˆ° $K$ æ¬¡å•ä½æ ¹ $\omega_K$ã€‚</p><p>è€ƒè™‘ DFT å¸¦å•ä½æ ¹è¿›å»ï¼Œå®é™…ä¸Šæ˜¯ä¹˜äº†è¿™ä¹ˆä¸ªçŸ©é˜µï¼ˆèŒƒå¾·è’™å¾·çŸ©é˜µï¼‰ï¼š</p><p>$$<br>T_k =<br>\left[<br>\begin{matrix}<br>\omega_{k}^{0} &amp; \omega_{k}^{0} &amp; \omega_{k}^{0} &amp; \cdots &amp; \omega_{k}^{0} \<br>\omega_{k}^{0} &amp; \omega_{k}^1 &amp; \omega_{k}^2 &amp; \cdots &amp; \omega_{k}^{k - 1} \<br>\omega_{k}^{0} &amp; \omega_{k}^2 &amp; \omega_{k}^4 &amp; \cdots &amp; \omega_{k}^{2(k - 1)} \<br>\cdots &amp; \cdots &amp; \cdots &amp; \ddots &amp; \cdots \<br>\omega_{k}^{0} &amp; \omega_{k}^{k - 1} &amp; \omega_{k}^{2(k - 1)} &amp; \cdots &amp; \omega_{k}^{(k - 1)(k - 1)} \<br>\end{matrix}<br>\right]<br>$$</p><p>è€Œ IDFT å®é™…ä¸Šæ˜¯ä¹˜äº† $T_k$ çš„é€†çŸ©é˜µï¼š</p><p>$$<br>T_k^{-1} = \frac{1}{k}<br>\left[<br>\begin{matrix}<br>\omega_{k}^{0} &amp; \omega_{k}^{0} &amp; \omega_{k}^{0} &amp; \cdots &amp; \omega_{k}^{0} \<br>\omega_{k}^{0} &amp; \omega_{k}^{-1} &amp; \omega_{k}^{-2} &amp; \cdots &amp; \omega_{k}^{-(k - 1)} \<br>\omega_{k}^{0} &amp; \omega_{k}^{-2} &amp; \omega_{k}^{-4} &amp; \cdots &amp; \omega_{k}^{-2(k - 1)} \<br>\cdots &amp; \cdots &amp; \cdots &amp; \ddots &amp; \cdots \<br>\omega_{k}^{0} &amp; \omega_{k}^{-(k - 1)} &amp; \omega_{k}^{-2(k - 1)} &amp; \cdots &amp; \omega_{k}^{-(k - 1)(k - 1)} \<br>\end{matrix}<br>\right]<br>$$</p><p>ä¾æ¬¡æšä¸¾ $0$ ~ $n - 1$ æ¯ç»´ï¼Œå°†æ¯ç»´ DFTï¼Œå†å°†ç‚¹å€¼å¯¹åº”ç›¸ä¹˜ï¼Œæœ€å IDFT å›æ¥ï¼ˆæ³¨æ„æœ€åè¦é™¤ä»¥ $K^n$ï¼Œå› ä¸ºå…±æœ‰ $n$ å±‚ï¼Œ$T_k * T_k^{-1} = KE$ï¼Œ$E$ ä¸ºå•ä½çŸ©é˜µï¼Œæ¯å±‚éƒ½å¤šä¹˜äº†ä¸€ä¸ª $K$ï¼›ä¹Ÿå¯ä»¥ä» IFWT åŸç†ç†è§£ï¼‰ã€‚æ­£ç¡®æ€§å¯ä»¥ç”¨é€’å½’çš„æ€æƒ³ç†è§£ã€‚</p><p>å¤æ‚åº¦ $O(n * K^{n - 1} * K^2)$ï¼ˆç†è§£ä¸º O(èƒ½è¿‡) å³å¯ï¼‰</p><p>æ™®é€šçš„ FWT å°±æ˜¯ä¸ªç‰¹ä¾‹å•¦ï¼Œ$\omega_2$ è¿™é‡Œå– $-1$ï¼Œå®ƒçš„çŸ©é˜µæ˜¯ï¼š</p><p>$$<br>T_2 =<br>\left[<br>\begin{matrix}<br>1 &amp; 1 \<br>1 &amp; -1<br>\end{matrix}<br>\right]<br>$$</p><h3 id="çŸ³å®¶åº„çš„å·¥äººé˜¶çº§é˜Ÿä¼æ¯”è¾ƒåšå¼º"><a href="#çŸ³å®¶åº„çš„å·¥äººé˜¶çº§é˜Ÿä¼æ¯”è¾ƒåšå¼º" class="headerlink" title="çŸ³å®¶åº„çš„å·¥äººé˜¶çº§é˜Ÿä¼æ¯”è¾ƒåšå¼º"></a><a href="https://uoj.ac/problem/272" target="_blank" rel="noopener">çŸ³å®¶åº„çš„å·¥äººé˜¶çº§é˜Ÿä¼æ¯”è¾ƒåšå¼º</a></h3><p>å½“ç„¶è¦åŒ–å¥‡æ€ªè§„åˆ™ä¸ºä¸€èˆ¬ã€‚å‘ç°èµ¢çš„ç›¸å‡ä¸º $1$ï¼Œå–æ¨¡æ„ä¹‰ä¸‹è¾“çš„ç›¸å‡ä¸º $2$ï¼Œå¹³å±€å½“ç„¶æ˜¯ $0$ äº†ã€‚è®° $B_{x - y} = b_{u, v} = b_{cnt(x - y, 1), cnt(x - y, 2)}$ã€‚åˆ™ $f_{i, z} = \sum\limits_{x + y = z} f_{i - 1, x} B_{y}$ï¼Œè¿™é‡Œçš„åŠ å‡æ³•æ˜¯ä¸‰è¿›åˆ¶ä¸è¿›ä½åŠ å‡æ³•ã€‚</p><p>æ‰€ä»¥è¿™å°±æ˜¯ä¸ª $n$ ç»´ï¼Œæ¯ç»´é•¿åº¦ $3$ çš„ DFT / $3$ è¿›åˆ¶ FWT åšç‚¹å€¼å¿«é€Ÿå¹‚ã€‚ç”¨ä¸Šé¢æ„é€ çŸ©é˜µçš„æ–¹æ³•æ„é€ ä¸€ä¸ª $3 * 3$ å•ä½æ ¹çŸ©é˜µã€‚$3$ çš„å•ä½æ ¹æ˜¯ $\omega = \frac{-1+\sqrt{3}i}{2}$ï¼Œæˆ‘ä»¬é€‰æ‹©æ‰©åŸŸï¼Œä½†æ˜¯ $\sqrt{3}$ ç²¾åº¦ä¼šæœ‰é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠå¤æ•°è¡¨ç¤ºæˆ $a + b\omega$ çš„å½¢å¼è€Œä¸æ˜¯ $a + bi$ï¼ŒIDFT ä¹‹å $\omega$ å°±æ²¡äº†ã€‚</p><p>æ ¹æ® $\omega_3$ çš„æ€§è´¨ï¼š$\omega^2 + \omega + 1 = 0$ï¼Œå¯ä»¥æ¨å¾—ä¹˜æ³•ï¼š$(a + b\omega)(c + d\omega) = (ac - bd) + (ad + bc - bd)\omega$</p><p>IDFT è¦é™¤ä»¥ $n = 3^m$ï¼Œéœ€è¦ $n$ å­˜åœ¨é€†å…ƒï¼Œå³æ¨¡æ•° $p$ ä¸æ˜¯ $3$ çš„å€æ•°ã€‚é¢˜ç›®é‚£ä¸ªæ€§è´¨ä¿è¯äº†è¿™ç‚¹ï¼šç”¨åè¯æ³•ï¼Œè®¾å­˜åœ¨æ­£æ•´æ•° $k = p / 3$ï¼Œé‚£ä¹ˆæœ‰ $1 / k + 1 / k(k + 1) = 1 / k = 3 / p$ï¼ŒçŸ›ç›¾ã€‚</p><p><a href="https://uoj.ac/submission/453533" target="_blank" rel="noopener">$Code$</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> é›†åˆå¹‚çº§æ•° </tag>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XJOI200807 é¢˜è§£</title>
      <link href="2020/08/07/XJOI200807%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/08/07/XJOI200807%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><hr><p>è¿™é¢˜å°±æ˜¯å…¸å‹çš„éƒ¨åˆ†åˆ†æé†’æ­£è§£ã€‚</p><p>01 é‚£éƒ¨åˆ†å¯ä»¥å¼•å¯¼æƒ³åˆ° bitsetï¼Œä½† $O(q * n / 32)$ çš„æ˜¾ç„¶ä¸å¯¹ï¼Œäºæ˜¯æƒ³åˆ° $O(q * 2^k / 32)$ çš„ï¼Œå³ $f[i, s]$ è¡¨ç¤ºåœ¨ç¬¬ i ä¸ªæ‰€åœ¨é›†åˆ s ä¸­æœ‰æ²¡æœ‰å€¼â€œæ‰©æ•£â€åˆ°ç¬¬ i ä¸ªï¼Œç„¶å or å’Œ and æ“ä½œèƒ½åˆ†åˆ«ä»£æ›¿ max å’Œ min æ“ä½œï¼Œå°±åšå®Œäº†ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, K, Q, cnt;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">13</span>][N], b[<span class="number">13</span>][N], t[<span class="number">13</span>];</span><br><span class="line"><span class="built_in">bitset</span>&lt;4096&gt; B[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; K &gt;&gt; Q;</span><br><span class="line">    rep(i, <span class="number">1</span>, K) rep(j, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i][j]);</span><br><span class="line">    rep(j, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(i, <span class="number">1</span>, K) t[i] = a[i][j];</span><br><span class="line">        sort(t + <span class="number">1</span>, t + K + <span class="number">1</span>);</span><br><span class="line">        rep(i, <span class="number">1</span>, K) b[i][j] = t[i];</span><br><span class="line">    &#125;</span><br><span class="line">    rep(s, <span class="number">0</span>, (<span class="number">1</span> &lt;&lt; K) - <span class="number">1</span>)</span><br><span class="line">        rep(i, <span class="number">1</span>, K) <span class="keyword">if</span> ((s &gt;&gt; (i - <span class="number">1</span>)) &amp; <span class="number">1</span>) B[i][s] = <span class="number">1</span>;</span><br><span class="line">    cnt = K;</span><br><span class="line">    <span class="keyword">while</span> (Q--) &#123;</span><br><span class="line">        <span class="keyword">int</span> op, x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;op, &amp;x, &amp;y);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">            B[++cnt] = (B[x] | B[y]);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (op == <span class="number">2</span>) &#123;</span><br><span class="line">            B[++cnt] = (B[x] &amp; B[y]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = K; j; --j) &#123;</span><br><span class="line">                <span class="keyword">int</span> s = <span class="number">0</span>;</span><br><span class="line">                rep(i, <span class="number">1</span>, K) <span class="keyword">if</span> (a[i][y] &gt;= b[j][y]) s |= (<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>));</span><br><span class="line">                <span class="keyword">if</span> (B[x][s]) &#123; <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, b[j][y]); <span class="keyword">break</span>; &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><hr><p>æ˜¾ç„¶è¦æšä¸¾æœ€ç»ˆé¢œè‰² $i$ã€‚é—®é¢˜æŠ½è±¡æˆæœ‰ $s + 1$ ä¸ªç‚¹ $0 ~ s$ï¼Œå½“å‰åœ¨ $a_i$ï¼Œæ¯æ­¥å¯ä»¥å‘å·¦å‘å³æˆ–ä¸åŠ¨ï¼Œé—®èµ°åˆ° $s$ çš„æœŸæœ›æ­¥æ•°ï¼Œå…¶ä¸­åœ¨ $0$ ç‚¹å’Œ $s$ ç‚¹æ—¶éƒ½æ˜¯ 0ã€‚</p><p><a href="https://www.luogu.com.cn/blog/cjyl/solution-cf850f" target="_blank" rel="noopener">é¢˜è§£</a>ï¼Œç­‰å·®æ•°åˆ—é‚£é‡Œè¿˜æ˜¯æ¯”è¾ƒå¦™çš„ï¼å…¶å®æœŸæœ›é¢˜å¤šæ˜¯ä»æ¦‚å¿µå‡ºå‘ï¼Œæˆ‘è¿˜æ˜¯æ¦‚å¿µä¸æ¸…å•Šã€‚</p><h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><hr><p>çœ‹èµ·æ¥å°±å¾ˆå¥—è·¯çš„é¢˜ã€‚æƒ³åˆ°è½¬åŒ–å°±å¥½ä¸å°‘= =</p><p>è¿™ä¸ªå¹³æ–¹å¾ˆéš¾æå•Šï¼è€ƒè™‘å®ƒçš„å®é™…æ„ä¹‰ï¼šè¿é€šå—è·¯å¾„æ•°æœŸæœ›çš„ä¸¤å€ã€‚æ ¹æ®æœŸæœ›çš„çº¿æ€§æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå¤§æœŸæœ›åŒ–æˆå°æœŸæœ›ï¼Œåˆ†åˆ«è€ƒè™‘æ¯æ¡è·¯å¾„çš„è´¡çŒ®ã€‚ï¼ˆå¥—è·¯ï¼æœ‰ç¢°åˆ°è¿‡å¥½å‡ æ¬¡å•Šå•Šå•Šï¼‰</p><p>è®¾ $p(i, x, y)$ è¡¨ç¤º $x$ã€$y$ åœ¨ $i$ å¤©åè¿˜åœ¨åŒä¸€è¿é€šå—çš„æ¦‚ç‡ï¼Œæ˜¾ç„¶å‰ $i - 1$ å¤© $x$ åˆ° $y$ çš„è·¯å¾„ä¸Šçš„è¾¹éƒ½æ²¡è¢«ç ï¼Œå› æ­¤</p><p>$$p(i, x, y) = \frac{ C(n - 1 - dist(x, y), i - 1) }{ C(n - 1, i - 1) } = \frac{(n - i)!(n - 1 - dist(x, y))!}{(n - 1)!(n - i - dist(x, y))!}$$</p><p>è®¾ $E(i)$ è¡¨ç¤ºç¬¬ $i$ å¤©çš„è·¯å¾„æ•°æœŸæœ›ï¼Œé‚£ä¹ˆ</p><p>$$E(i) = \sum\limits_{x, y \in V} p(i, x, y) \times 1$$</p><p>æšä¸¾ $z = dist(x, y)$ å°±èƒ½æŠŠç»„åˆæ•°æ‹†å¼€ï¼Œå°±å¯ä»¥åŒ–æˆå·ç§¯å½¢å¼äº†ã€‚è®¾ $g(z)$ è¡¨ç¤º $dist(x, y) = z$ çš„ $(x, y)$ å¯¹æ•°ï¼ˆç‚¹åˆ†æ²» + FFTï¼‰ï¼Œé‚£ä¹ˆ</p><p>$$E(i) = \frac{(n - i)!}{(n - 1)!} \sum\limits_z g(z) \times (n - 1 - z)! \times \frac{1}{(n - i - z)!}$$</p><p>å·ç§¯å½¢å¼ï¼ŒFFT å°±åšå®Œäº†ã€‚</p><p>è°ƒåˆ°å»ä¸–ï¼Œå‘ç°æ˜¯ä¸‰å¤„sbé”™è¯¯ ï¼šï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">10</span>, mod = <span class="number">998244353</span>, G1 = <span class="number">3</span>, G2 = (mod + <span class="number">1</span>) / G1;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, l, lim;</span><br><span class="line">ll f[N][<span class="number">20</span>], rev[N];</span><br><span class="line">ll fac[N], inv[N], F[N], G[N], A[N], B[N];</span><br><span class="line">ll sz[N], rt, T, mark[N], len[N], tot, bin[N], mxdep, num[N], mx[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nxt[N];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quick_pow</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ret = ret * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">    &#125; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    fac[<span class="number">0</span>] = inv[<span class="number">0</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) fac[i] = fac[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">    rep(i, <span class="number">2</span>, n) inv[i] = (mod - mod / i) * inv[mod % i] % mod;</span><br><span class="line">    rep(i, <span class="number">2</span>, n) inv[i] = inv[i] * inv[i - <span class="number">1</span>] % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_rev</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    l = <span class="number">0</span>, lim = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (lim &lt;= n) l++, lim &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, lim - <span class="number">1</span>) rev[i] = (rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span><span class="params">(ll a[], <span class="keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">0</span>, lim - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; rev[i]) swap(a[i], a[rev[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; lim; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        ll W = quick_pow(op == <span class="number">1</span> ? G1 : G2, (mod - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; lim; j += (mid &lt;&lt; <span class="number">1</span>)) &#123;</span><br><span class="line">            ll w = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k++, w = w * W % mod) &#123;</span><br><span class="line">                ll x = a[j + k], y = w * a[j + k + mid] % mod;</span><br><span class="line">                a[j + k] = (x + y) % mod, a[j + k + mid] = (x - y + mod) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">-1</span>) &#123;</span><br><span class="line">        ll Inv = quick_pow(lim, mod - <span class="number">2</span>);</span><br><span class="line">        rep(i, <span class="number">0</span>, lim - <span class="number">1</span>) (a[i] *= Inv) %= mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getrt</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    sz[x] = <span class="number">1</span>, mx[x] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nxt[x].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = nxt[x][i];</span><br><span class="line">        <span class="keyword">if</span> (y == fa || mark[y]) <span class="keyword">continue</span>;</span><br><span class="line">        getrt(y, x);</span><br><span class="line">        sz[x] += sz[y], mx[x] = max(mx[x], sz[y]);</span><br><span class="line">    &#125;</span><br><span class="line">    mx[x] = max(mx[x], T - sz[x]);</span><br><span class="line">    <span class="keyword">if</span> (mx[x] &lt; mx[rt]) rt = x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getdis</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa, ll dep)</span> </span>&#123;</span><br><span class="line">    ++bin[dep];</span><br><span class="line">    mxdep = max(mxdep, dep);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nxt[x].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = nxt[x][i];</span><br><span class="line">        <span class="keyword">if</span> (y == fa || mark[y]) <span class="keyword">continue</span>;</span><br><span class="line">        getdis(y, x, dep + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">    get_rev(mxdep &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">0</span>, mxdep) A[i] = B[i] = bin[i], bin[i] = <span class="number">0</span>;</span><br><span class="line">    rep(i, mxdep + <span class="number">1</span>, lim - <span class="number">1</span>) A[i] = B[i] = <span class="number">0</span>;</span><br><span class="line">    NTT(A, <span class="number">1</span>), NTT(B, <span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">0</span>, lim - <span class="number">1</span>) A[i] = (A[i] * B[i]) % mod;</span><br><span class="line">    NTT(A, <span class="number">-1</span>);</span><br><span class="line">    rep(i, <span class="number">0</span>, min(n, mxdep &lt;&lt; <span class="number">1</span>)) num[i] = (num[i] + op * A[i]) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    mark[x] = <span class="number">1</span>, mxdep = <span class="number">0</span>, getdis(x, <span class="number">0</span>, <span class="number">0</span>), calc(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nxt[x].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = nxt[x][i];</span><br><span class="line">        <span class="keyword">if</span> (mark[y]) <span class="keyword">continue</span>;</span><br><span class="line">        mxdep = <span class="number">0</span>, getdis(y, x, <span class="number">1</span>), calc(<span class="number">-1</span>);  <span class="comment">// å®¹æ–¥å‡ºä¸€å®šç»è¿‡ x çš„è·¯å¾„æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nxt[x].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = nxt[x][i];</span><br><span class="line">        <span class="keyword">if</span> (mark[y]) <span class="keyword">continue</span>;</span><br><span class="line">        T = sz[y], mx[rt = <span class="number">0</span>] = <span class="number">1e9</span>, getrt(y, x), solve(rt);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    init(n);</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        nxt[x].push_back(y), nxt[y].push_back(x);</span><br><span class="line">    &#125;</span><br><span class="line">    T = n, mx[rt = <span class="number">0</span>] = <span class="number">1e9</span>, getrt(<span class="number">1</span>, <span class="number">0</span>), solve(rt);</span><br><span class="line">    get_rev(n &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">0</span>, n - <span class="number">1</span>) num[i] = (num[i] + mod) % mod;</span><br><span class="line">    rep(i, <span class="number">0</span>, n - <span class="number">1</span>) A[i] = num[i] * fac[n - <span class="number">1</span> - i] % mod, B[i] = inv[i];</span><br><span class="line">    rep(i, n, lim - <span class="number">1</span>) A[i] = B[i] = <span class="number">0</span>;</span><br><span class="line">    NTT(A, <span class="number">1</span>), NTT(B, <span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">0</span>, lim - <span class="number">1</span>) A[i] = (A[i] * B[i]) % mod;</span><br><span class="line">    NTT(A, <span class="number">-1</span>);</span><br><span class="line">    rep(i, <span class="number">0</span>, n - <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">"%lld "</span>, A[n - i - <span class="number">1</span>] * fac[n - i - <span class="number">1</span>] % mod * inv[n - <span class="number">1</span>] % mod);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
            <tag> æ¨¡æ‹Ÿèµ› </tag>
            
            <tag> æ¦‚ç‡ä¸æœŸæœ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[PKUWC2018]-éšæœºæ¸¸èµ°</title>
      <link href="2020/08/06/%5BPKUWC2018%5D-%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0/"/>
      <url>2020/08/06/%5BPKUWC2018%5D-%E9%9A%8F%E6%9C%BA%E6%B8%B8%E8%B5%B0/</url>
      
        <content type="html"><![CDATA[<p>ç»ˆäºæ¥æè¿™ä¸ªæ—©å°±æƒ³æçš„é¢˜äº†ï¼ï¼è‘—åï¼ˆé›¾ï¼‰çš„ $minmax$ é¢˜</p><p>æ®è¯´å¯ä»¥<a href="https://www.cnblogs.com/Mychael/p/9229291.html" target="_blank" rel="noopener">ä¸ç”¨ $minmax$ å®¹æ–¥</a>ï¼Œè®¾ $f[i, S]$ è¡¨ç¤ºä» $i$ å‡ºå‘èµ°å®Œ $S$ é›†åˆçš„æœŸæœ› + æŠŠ dp æŸ¿å­è¡¨ç¤ºæˆ $Ax + B$ çš„å½¢å¼å°±å¯ä»¥åšåˆ° $O(n2^n)$ çš„å¤æ‚åº¦ã€‚ã€‚ã€‚å¤§åŒå°å¼‚å§</p><p>è€ƒè™‘ $minmax$ å®¹æ–¥ï¼Œè®¾ $f[i]$ ä¸ºä» $i$ ç‚¹å‡ºå‘ï¼Œåˆ°è¾¾é›†åˆ $S$ ä¸­ç¬¬ä¸€ä¸ªç‚¹çš„æœŸæœ›æ—¶é—´ï¼Œé‚£ä¹ˆåªè¦è®¡ç®— $f[x]$ å°±å¥½äº†ã€‚</p><p>æœ¬é¢˜æ˜¯æ ‘çš„å½¢æ€ï¼Œå¯ä»¥æ¨å¾—ï¼š</p><ul><li>$x \in S$, $f[x] = 0$</li><li>$x \notin S$, $f[x] = \frac{f[fa_x]}{deg_x} + (\sum\limits_{y \in Son(x)}\frac{f[y]}{deg_x}) + 1$</li></ul><p>å‘ç°çˆ¶äº²å’Œå„¿å­å¾ˆä¸å¥½æï¼Œè€Œæ¯ä¸ªèŠ‚ç‚¹åªæœ‰ä¸€ä¸ªçˆ¶äº²ï¼Œæˆ‘ä»¬å°±ç”¨åˆ°ä¸€ä¸ªå¥—è·¯ï¼šå°† $f[x]$ è¡¨ç¤ºä¸º $A * f[fa] + B$ çš„å½¢å¼</p><p>ä»ä¸‹å¾€ä¸Šåšï¼Œæ¨å¾—ï¼š$A_x = \frac{1}{deg_x - \sum A_y}$, $B_x = \frac{\sum B_y + deg_x}{deg_x - \sum A_y}$</p><p>å¤æ‚åº¦ $O(n2^n)$ã€‚å¯ä»¥ç”¨ FMT æˆ–è€… FWT_and åšå®¹æ–¥ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>, M = <span class="number">20</span>, N = (<span class="number">1</span> &lt;&lt; <span class="number">18</span>);</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, Q, st, S;</span><br><span class="line">ll f[N], g[N], deg[M], a[M], b[M];</span><br><span class="line"><span class="keyword">int</span> to[M &lt;&lt; <span class="number">1</span>], nxt[M &lt;&lt; <span class="number">1</span>], lnk[M], cnt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    to[++cnt] = y, nxt[cnt] = lnk[x], lnk[x] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quick_pow</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ret = ret * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">    &#125; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ((S &gt;&gt; (x - <span class="number">1</span>)) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">        a[x] = b[x] = <span class="number">0</span>; <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    a[x] = b[x] = deg[x];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (y == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(y, x);</span><br><span class="line">        a[x] = (a[x] - a[y] + mod) % mod;</span><br><span class="line">        b[x] = (b[x] + b[y]) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    a[x] = quick_pow(a[x], mod - <span class="number">2</span>);</span><br><span class="line">    b[x] = a[x] * b[x] % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FWT_or</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt; (<span class="number">1</span> &lt;&lt; n); k &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; n); i += (k &lt;&lt; <span class="number">1</span>))</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; k; ++j)</span><br><span class="line">                f[i + j + k] = (f[i + j + k] + f[i + j] + mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FMT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        rep(j, <span class="number">0</span>, (<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> ((j &gt;&gt; (i - <span class="number">1</span>)) &amp; <span class="number">1</span>)</span><br><span class="line">                f[j] = (f[j] + f[j - (<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>))]) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; Q &gt;&gt; st;</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        add(x, y), add(y, x);</span><br><span class="line">        ++deg[x], ++deg[y];</span><br><span class="line">    &#125;</span><br><span class="line">    rep(s, <span class="number">1</span>, (<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>) &#123;</span><br><span class="line">        S = s; dfs(st, <span class="number">0</span>);</span><br><span class="line">        f[s] = (__builtin_popcount(s) &amp; <span class="number">1</span>) ? b[st] : mod - b[st];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// FWT_or();  // ä¸¤ä¸ªç­‰ä»·çš„ã€‚éƒ½å¯ä»¥ã€‚</span></span><br><span class="line">    FMT();</span><br><span class="line">    <span class="keyword">while</span> (Q--) &#123;</span><br><span class="line">        <span class="keyword">int</span> k, x, bit = <span class="number">0</span>; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;k);</span><br><span class="line">        <span class="keyword">while</span> (k--)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x), bit |= (<span class="number">1</span> &lt;&lt; (x - <span class="number">1</span>));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, f[bit]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¦‚ç‡ä¸æœŸæœ› </tag>
            
            <tag> minmaxå®¹æ–¥ </tag>
            
            <tag> é›†åˆå¹‚çº§æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[æ¸…åé›†è®­2017]-æ— é™ä¹‹ç¯</title>
      <link href="2020/08/06/%5B%E6%B8%85%E5%8D%8E%E9%9B%86%E8%AE%AD2017%5D-%E6%97%A0%E9%99%90%E4%B9%8B%E7%8E%AF/"/>
      <url>2020/08/06/%5B%E6%B8%85%E5%8D%8E%E9%9B%86%E8%AE%AD2017%5D-%E6%97%A0%E9%99%90%E4%B9%8B%E7%8E%AF/</url>
      
        <content type="html"><![CDATA[<p>å¥½ç¥å¥‡çš„é¢˜ï¼</p><p>ä¸è”é€šæ€§ç›¸å…³çš„æœ€ä¼˜æ€§é—®é¢˜ï¼Œå…ˆè€ƒè™‘æ’å¤´dpï¼Œä½†æ˜¯æ•°æ®èŒƒå›´è¿‡å¤§ï¼Œggã€‚</p><p>è§‚å¯Ÿå›¾å½¢å‘ç°æ˜¯æœ‰é™ç§ä¸Šä¸‹å·¦å³çš„æ¥å£ï¼ˆæ³¨æ„ç›´ç®¡ä¸èƒ½ç¿»è½¬ï¼‰ï¼Œè€Œä¸”æ˜¯<strong>ç½‘æ ¼å›¾</strong>ï¼Œäºæ˜¯è€ƒè™‘è´¹ç”¨æµã€‚ï¼ˆæ ¹æœ¬æƒ³ä¸åˆ°ä¸”å°±ç®—çŸ¥é“äº†ä¹Ÿä¾æ—§ä¸ä¼šåšå•Šå•Šå•Šï¼‰</p><ul><li>æ€ä¹ˆåˆ¤æ–­å›¾æ˜¯å¦æ¼æ°´ï¼Ÿ</li></ul><p>å‘ç°æ°´åœ¨ç›¸é‚»çš„æ ¼å­é—´æµåŠ¨ï¼Œ<strong>ä¸æ¼ç­‰ä»·äºç›¸é‚»æ ¼å­é—´æ¥å£èƒ½å¯¹ä¸Š</strong>ï¼Œé‚£ä¹ˆæŠŠæ¥å£æŠ½è±¡æˆç®¡é“å°±æ˜¯ å®¹é‡ä¸º 1 ä¸”å¿…é¡»æ»¡æµã€‚é‚£ä¹ˆé»‘ç™½æŸ“è‰²ï¼Œç™½ç‚¹è¿ Sï¼Œé»‘ç‚¹è¿ Tï¼Œæ¯ä¸ªæ ¼å­åˆ†æˆä¸Šä¸‹å·¦å³ä¸­äº”ä¸ªç‚¹ï¼Œå¯¹äºç™½ç‚¹ï¼Œä¸­é—´æŒ‡å‘å‘¨å›´ï¼›å¯¹äºé»‘ç‚¹ï¼Œå‘¨å›´æŒ‡å‘ä¸­é—´ã€‚è¿™æ ·æ»¡æµï¼Œå³æµé‡ç­‰äºæ¥å£æ•°ï¼Œå°±æ˜¯ä¸æ¼ã€‚ï¼ˆåŒæ—¶ä¹Ÿæœ‰äº†è®©æ°´æµåŠ¨çš„åŠ¨åŠ›ï¼ï¼‰</p><p>è€ƒè™‘æ—‹è½¬æ€ä¹ˆå¤„ç†ï¼šæ”¹å˜çš„æ¥å£å¯¹åº”è¿è¾¹ï¼Œæ³¨æ„å®¹é‡éƒ½æ˜¯ 1ï¼Œè¿™æ ·è·‘è´¹ç”¨æµçš„æ—¶å€™ä¸€ä¸ªæ ¼å­åªèƒ½é€‰ä¸€ç§çŠ¶æ€ã€‚</p><p>ä»£ç åœ¨ uoj ä¸Šå¹¶æ²¡æœ‰ ACï¼ŒT äº†å¾ˆå¤šå‘ï¼Œå¤§æ¦‚æ˜¯å»ºè¾¹ä¸å¤Ÿä¼˜ç§€ï¼Œç„¶è€Œä¸æƒ³æ”¹äº†ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e3</span> + <span class="number">10</span>, inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, st, ed, idx, t1, t2, num;</span><br><span class="line"><span class="keyword">int</span> id[N][N][<span class="number">5</span>];</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> dx[<span class="number">4</span>] = &#123;<span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;, dy[<span class="number">4</span>] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> MCMF &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> M = N * <span class="number">5</span>, MM = N * <span class="number">100</span>;  <span class="comment">// å¼€è¶³äº†ï¼ï¼ï¼</span></span><br><span class="line">    <span class="keyword">int</span> lnk[M], fr[MM], to[MM], nxt[MM], cnt = <span class="number">1</span>, cap[MM], val[MM];</span><br><span class="line">    <span class="keyword">int</span> level[M], dis[M], pre[M], inq[M];</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> c, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">        ++num;</span><br><span class="line">        to[++cnt] = y, fr[cnt] = x, nxt[cnt] = lnk[x], lnk[x] = cnt, cap[cnt] = c, val[cnt] = v;</span><br><span class="line">        to[++cnt] = x, fr[cnt] = y, nxt[cnt] = lnk[y], lnk[y] = cnt, cap[cnt] = <span class="number">0</span>, val[cnt] = -v;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> c, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">        add(x, y, c, v), add(y, x, c, v);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> S, <span class="keyword">int</span> T)</span> </span>&#123;</span><br><span class="line">        rep(i, <span class="number">1</span>, T) dis[i] = inf, pre[i] = inq[i] = <span class="number">0</span>;</span><br><span class="line">        inq[S] = <span class="number">1</span>;</span><br><span class="line">        q.push(S);</span><br><span class="line">        <span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = q.front(); q.pop(); inq[x] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">                <span class="keyword">int</span> y = to[i];</span><br><span class="line">                <span class="keyword">if</span> (cap[i] &amp;&amp; dis[y] &gt; dis[x] + val[i]) &#123;</span><br><span class="line">                    dis[y] = dis[x] + val[i];</span><br><span class="line">                    pre[y] = i;</span><br><span class="line">                    <span class="keyword">if</span> (!inq[y]) q.push(y), inq[y] = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dis[T] != inf;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">McMf</span><span class="params">(<span class="keyword">int</span> S, <span class="keyword">int</span> T)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cost = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (spfa(S, T)) &#123;</span><br><span class="line">            --t1;</span><br><span class="line">            cost += dis[T];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> x = T; x != S; x = fr[pre[x]]) &#123;</span><br><span class="line">                cap[pre[x]]--, cap[pre[x] ^ <span class="number">1</span>]++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> t1 ? <span class="number">-1</span> : cost;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> MCMF;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) rep(j, <span class="number">1</span>, m) rep(k, <span class="number">0</span>, <span class="number">4</span>) id[i][j][k] = ++idx;</span><br><span class="line">    st = <span class="number">0</span>, ed = ++idx;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) rep(j, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, cnt = <span class="number">0</span>; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">        <span class="keyword">if</span> ((i + j) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">            rep(k, <span class="number">0</span>, <span class="number">3</span>) <span class="keyword">if</span> ((x &gt;&gt; k) &amp; <span class="number">1</span>) add(id[i][j][<span class="number">4</span>], id[i][j][k], <span class="number">1</span>, <span class="number">0</span>), ++cnt;</span><br><span class="line">            rep(k, <span class="number">0</span>, <span class="number">3</span>) &#123;</span><br><span class="line">                <span class="keyword">int</span> tx = i + dx[k], ty = j + dy[k];</span><br><span class="line">                <span class="keyword">if</span> (tx &amp;&amp; ty &amp;&amp; tx &lt;= n &amp;&amp; ty &lt;= m) add(id[i][j][k], id[tx][ty][(k + <span class="number">2</span>) &amp; <span class="number">3</span>], <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            add(st, id[i][j][<span class="number">4</span>], cnt, <span class="number">0</span>);</span><br><span class="line">            t1 += cnt;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            rep(k, <span class="number">0</span>, <span class="number">3</span>) <span class="keyword">if</span> ((x &gt;&gt; k) &amp; <span class="number">1</span>) add(id[i][j][k], id[i][j][<span class="number">4</span>], <span class="number">1</span>, <span class="number">0</span>), ++cnt;</span><br><span class="line">            add(id[i][j][<span class="number">4</span>], ed, cnt, <span class="number">0</span>);</span><br><span class="line">            t2 += cnt;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (x % <span class="number">5</span> == <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (cnt == <span class="number">1</span>) &#123;</span><br><span class="line">            rep(k, <span class="number">0</span>, <span class="number">3</span>) <span class="keyword">if</span> ((x &gt;&gt; k) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">                add2(id[i][j][(k + <span class="number">1</span>) &amp; <span class="number">3</span>], id[i][j][k], <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">                add2(id[i][j][(k + <span class="number">3</span>) &amp; <span class="number">3</span>], id[i][j][k], <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">                add2(id[i][j][(k + <span class="number">2</span>) &amp; <span class="number">3</span>], id[i][j][k], <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cnt == <span class="number">3</span>) &#123;</span><br><span class="line">            rep(k, <span class="number">0</span>, <span class="number">3</span>) <span class="keyword">if</span> (!((x &gt;&gt; k) &amp; <span class="number">1</span>)) &#123;</span><br><span class="line">                add2(id[i][j][k], id[i][j][(k + <span class="number">1</span>) &amp; <span class="number">3</span>], <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">                add2(id[i][j][k], id[i][j][(k + <span class="number">3</span>) &amp; <span class="number">3</span>], <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">                add2(id[i][j][k], id[i][j][(k + <span class="number">2</span>) &amp; <span class="number">3</span>], <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cnt == <span class="number">2</span>) &#123;</span><br><span class="line">            rep(k, <span class="number">0</span>, <span class="number">3</span>) <span class="keyword">if</span> ((x &gt;&gt; k) &amp; <span class="number">1</span>) add2(id[i][j][k], id[i][j][(k + <span class="number">2</span>) &amp; <span class="number">3</span>], <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// printf("%d\n", cnt);</span></span><br><span class="line">    <span class="keyword">if</span> (t1 != t2) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>), <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, McMf(st, ed));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ç½‘ç»œæµ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AGC 011 é¢˜è§£</title>
      <link href="2020/08/05/AGC%20011%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/08/05/AGC%20011%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>AB æ°´é¢˜= =</p><h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><hr><p>C æ¯” D éš¾è¯¶ /kk</p><p><a href="https://blog.csdn.net/WerKeyTom_FTD/article/details/78216823?locationNum=5&fps=1" target="_blank" rel="noopener">çœ‹äº†é¢˜è§£</a></p><p>ç‰¹â€”â€”åˆ«å¥½çš„é¢˜ï¼äºŒåˆ†å›¾çœŸé¦™</p><p>$C = V - E + F$ å­¦å‘†äº†ï¼Œç”¨ä¸åˆ°å°±æœ‰ç‚¹éš¾å—= = ï¼Ÿ</p><p>åŸå›¾ä¸­çš„ç‹¬ç«‹ç‚¹æ˜¯æœ€å¥½æçš„ï¼Œè®¾ç‹¬ç«‹ç‚¹ä¸ªæ•°ä¸º pï¼Œåˆ™è´¡çŒ®ä¸º $np * 2 - p^2$</p><p>è€ƒè™‘é¢˜ç›®æ¡ä»¶ï¼š$(a, b)$ åˆ° $(c, d)$ æœ‰è¾¹å½“ä¸”ä»…å½“ $a -&gt; c$ï¼Œ$b -&gt; d$ï¼Œç­‰ä»·äº $aã€b$ åŒæ—¶ç§»åŠ¨äº†ä¸€æ­¥åˆ°è¾¾ $cã€d$ã€‚å› æ­¤æ¨å¾—çŠ¶æ€ $(a, b)$ èƒ½åˆ°è¾¾çŠ¶æ€ $(c, d)$ ï¼Œæ˜¾ç„¶å½“ä¸”ä»…å½“è·¯å¾„ $a -&gt; c$ å’Œ $b -&gt; d$ çš„<strong>å¥‡å¶æ€§ç›¸åŒ</strong>ã€‚ç”±æ­¤è”æƒ³åˆ°<strong>äºŒåˆ†å›¾</strong>ã€‚</p><p>è€ƒè™‘â€œç‰¹å¾ç‚¹â€$(x, y)$ å³æ— æ³•åœ¨æ–°å›¾è¿é€šå—å†…åˆ°è¾¾ $(t, k)$ ä½¿å¾— $t &lt; x$ æˆ–åˆ°è¾¾ $(x, z)$ ä½¿å¾— $z &lt; y$ã€‚å¯ä»¥ç†è§£ä¸ºå­—å…¸åºæœ€å°ã€‚<strong>æ˜¾ç„¶ç‰¹å¾ç‚¹ä¸ªæ•°å°±æ˜¯è¿é€šå—ä¸ªæ•°ã€‚</strong></p><p>æˆ‘ä»¬å‘ç°ï¼Œç‰¹å¾ç‚¹ç¬¬ä¸€ç»´ $x$ å¿…é¡»æ˜¯åŸå›¾è¿é€šå—ä¸­æœ€å°çš„ç‚¹ã€‚ç¬¬äºŒç»´ $y$ å¯ä»¥æ˜¯æœ€å°çš„ç‚¹ã€‚ä½†å¦‚æœ $y$ æ‰€åœ¨è¿é€šå—æ˜¯äºŒåˆ†å›¾ï¼Œä¸”å’Œæ‰€åœ¨è¿é€šå—é‡Œçš„æœ€å°ç‚¹ $z$ ä¸åœ¨åŒä¸€è¾¹ï¼Œå°±æ— æ³•å˜æˆ $z$ï¼ˆ $(x, y) -&gt; (x, z)$ï¼Œ$x -&gt; x$ çš„å¥‡å¶æ€§å¯ä»¥çœ‹ä½œå¶ï¼Œé‚£ä¹ˆ $y -&gt; z$ çš„å¥‡å¶æ€§å¦‚æœæ˜¯å¥‡å°±ä¸è¡Œï¼‰ã€‚</p><h2 id="D"><a href="#D" class="headerlink" title="D"></a>D</h2><hr><p>æ‰¾è§„å¾‹å‘ç°æ»šä¸€æ¬¡çƒåä¸²å˜ä¸ºå–ååå·¦ç§»ä¸€ä½ï¼Œæœ«å°¾è¡¥ä½Aã€‚å¤§è‡´åŸå› å°±æ˜¯</p><ul><li>A-&gt; B å˜æˆ A A-&gt;</li><li>A-&gt; A å˜æˆ B A-&gt;</li><li>å¼€å¤´å’Œç»“å°¾ä¹Ÿç¬¦åˆè§„å¾‹</li></ul><p>å‘ç° 2n æ­¥ï¼ˆä¸æ˜¯ n æ­¥ï¼Œå› ä¸ºä¸²çš„å¥‡å¶æ€§æœ‰å½±å“ï¼‰å¿…ç„¶ä¼šæŠŠåˆå§‹çš„ä¸²ç»™æ›¿æ¢æ‰ï¼ˆå¯ä»¥ç†è§£ä¸ºä¸€ä½ä¸€ä½æº¢å‡ºäº†ï¼Œå…¶ä¸­æœ‰è‡³å¤š n æ­¥æ˜¯ç¬¬ä¸€ä½ä¸º A çš„è¦å¼¹å›ï¼‰ï¼Œä¸²å°±å˜æˆäº† ABABABâ€¦ æˆ–è€… BABABAâ€¦ çš„å½¢å¼ï¼Œè®¨è®ºä¸€ä¸‹å¥‡å¶æ€§å°±å¥½äº†</p><h2 id="E"><a href="#E" class="headerlink" title="E"></a>E</h2><hr><p>å’•å’•</p><h2 id="F"><a href="#F" class="headerlink" title="F"></a>F</h2><hr><p>å’•å’•</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ä¹ é¢˜é€‰è®²ã€‘xzaã€ŠGraph Theoryã€‹</title>
      <link href="2020/08/04/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91xza%E3%80%8AGraph%20Theory%E3%80%8B/"/>
      <url>2020/08/04/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91xza%E3%80%8AGraph%20Theory%E3%80%8B/</url>
      
        <content type="html"><![CDATA[<h2 id="TC10947-TwoSidedCards"><a href="#TC10947-TwoSidedCards" class="headerlink" title="$TC10947-TwoSidedCards$"></a><a href="https://vjudge.net/problem/TopCoder-10947" target="_blank" rel="noopener">$TC10947-TwoSidedCards$</a></h2><hr><p>æ­£-åï¼ŒäºŒå…ƒå…³ç³»ï¼Œæƒ³åˆ°æ­£åé¢æ•°å­—å¯¹åº”è¿è¾¹ï¼Œæ¯å¼ å¡éƒ½å˜æˆäº†ä¸€æ¡æœ‰å‘è¾¹ã€‚</p><p>æˆ‘ä»¬å‘ç°å½¢æˆçš„å›¾æ˜¯ä¸€ä¸ªç¯ï¼ï¼å› ä¸ºæ­£åéƒ½æ˜¯æ’åˆ—ï¼Œæ¯ä¸ªæ•°å­—çš„åº¦æ•°éƒ½æ˜¯ 2ã€‚</p><p>åˆ†ç¯è®¨è®ºï¼Œè®¾å½“å‰ç¯é•¿åº¦ä¸º $L$ï¼Œé€‰äº† $k$ ä¸ªæ•°å­—ï¼Œæ˜¾ç„¶ç›¸é‚»çš„ä¸èƒ½é€‰ï¼Œæ‰€ä»¥æ–¹æ¡ˆæ•°å°±æ˜¯ $C(L, 2k)$ è¿˜è¦ $*2$ã€‚</p><p>èƒŒåŒ…åˆå¹¶ã€‚</p><h2 id="CF547D-Mike-and-Fish"><a href="#CF547D-Mike-and-Fish" class="headerlink" title="$CF547D-Mike\ and\ Fish$"></a><a href="https://codeforces.com/problemset/problem/547/D" target="_blank" rel="noopener">$CF547D-Mike\ and\ Fish$</a></h2><hr><p><a href="https://blog.csdn.net/PoPoQQQ/article/details/46125833" target="_blank" rel="noopener">é¢˜è§£</a></p><p>å’Œä¸Šä¸€é¢˜æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚è¡Œ-åˆ—ï¼Œæƒ³åˆ°äºŒå…ƒå…³ç³»ï¼Œäºæ˜¯è¡Œåˆ—å»ºç‚¹ï¼Œæ¯ä¸ªç‚¹éƒ½å˜æˆäº†ä¸€æ¡æœ‰å‘è¾¹ã€‚è®¾çº¢è‰²è¡¨ç¤ºå…¥è¾¹ï¼Œè“è‰²è¡¨ç¤ºå‡ºè¾¹ï¼Œæˆ‘ä»¬è¦ç»™è¾¹å®šå‘ï¼Œä½¿å¾—æ–°å›¾æ¯ä¸ªç‚¹çš„å…¥åº¦å‡ºåº¦ä¹‹å·®ä¸è¶…è¿‡ 1ã€‚</p><p>æ€ä¹ˆåšï¼Ÿè€ƒè™‘<strong>æ„é€ æ¬§æ‹‰å›è·¯</strong>ã€‚å¤ä¹ ä¸€æ³¢æ¬§æ‹‰å›è·¯çš„å®šä¹‰ï¼šæ¬§æ‹‰å›è·¯æ˜¯ç»è¿‡å›¾ G ä¸­<strong>æ‰€æœ‰</strong>è¾¹çš„å›è·¯ã€‚ä½†ç›®å‰äºŒåˆ†å›¾ä¸­æœ‰å¶æ•°ä¸ªï¼ˆä¸€å®šæ˜¯å¶æ•°ä¸ªï¼Œå› ä¸ºä¿è¯æœ‰è§£ï¼‰å¥‡æ•°åº¦ç‚¹ã€‚æœ‰å¥‡æ•°åº¦ç‚¹å°±å¾ˆéš¾å¤„ç†ï¼</p><p>å¯ä»¥å°†å¥‡æ•°åº¦ç‚¹ä¸¤ä¸¤é…å¯¹ï¼ˆé€šè¿‡è¿ä¸€äº›æ— å…³ç´§è¦çš„è¾…åŠ©è¾¹ï¼‰ï¼Œå¯¹äºæ¯ä¸ªè¿é€šå—é€‰ä¸€ä¸ªåˆå§‹ä¸ºå¥‡æ•°åº¦çš„ç‚¹è·‘ï¼ˆæ³¨æ„å…ˆè·‘è¾…åŠ©è¾¹ï¼‰ï¼Œæ²¡æœ‰å°±è·‘åˆå§‹ä¸ºå¶æ•°åº¦çš„ç‚¹ï¼Œæ¬§æ‹‰å›è·¯çº¢è“æŸ“è‰²ï¼Œå°±å¾ˆå¥½å†™ã€‚</p><p>è¿™ä¸ªæ­£ç¡®æ€§æ¯”è¾ƒæ˜¾ç„¶ï¼šæ¬§æ‹‰å›è·¯ä¸Šæ¯ä¸ªç‚¹å…¥åº¦å‡ºåº¦éƒ½æƒ³åŒï¼Œæ¯ä¸ªç‚¹è¿çš„è¾…åŠ©è¾¹æœ€å¤š 1 æ¡ï¼Œåˆ å»è¾…åŠ©è¾¹åä»èƒ½æ»¡è¶³é™åˆ¶ã€‚</p><p>å¤ä¹ æ¬§æ‹‰å›è·¯åŸºæœ¬å†™æ³•ï¼šå¥—åœˆæ³•ï¼Œå…¶å®å°±æ˜¯æŠŠä¸åŒçš„ç¯è¿åœ¨ä¸€èµ·ï¼Œ<strong>dfs å‡½æ•°è¿˜æ˜¯æœ‰ä¸å°‘ç»†èŠ‚çš„</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    vis[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!mark[i]) &#123;</span><br><span class="line">            mark[i] = mark[i ^ <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">            lnk[x] = nxt[i];  <span class="comment">// å½“å‰å¼§ä¼˜åŒ–</span></span><br><span class="line">            dfs(to[i]);</span><br><span class="line">            stk[++top] = id[i];</span><br><span class="line">            i = lnk[x];  <span class="comment">// !!!</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="TC12330-CoinsGame"><a href="#TC12330-CoinsGame" class="headerlink" title="$TC12330-CoinsGame$"></a><a href="https://vjudge.net/problem/TopCoder-12330" target="_blank" rel="noopener">$TC12330-CoinsGame$</a></h2><hr><p>å‡è£…ä½ å·²ç»çŸ¥é“è¿™æ˜¯â€œç­‰ä»·ç±»â€çš„é¢˜ç›®ã€‚è€ƒè™‘ä¸¤ä¸ªæ ¼å­ç­‰ä»·ï¼Œå½“ä¸”ä»…å½“ä»»æ„æ“ä½œååŸæœ¬åœ¨ä¸¤ä¸ªæ ¼å­ä¸Šçš„ç¡¬å¸è¦ä¹ˆåŒæ—¶åœ¨æ£‹ç›˜ä¸Šï¼Œè¦ä¹ˆåŒæ—¶ç§»å‡ºäº†æ£‹ç›˜ï¼Œé‚£ä¹ˆåˆæ³•çš„æ–¹æ¡ˆè‡³å°‘æœ‰ä¸€ä¸ªè¿™æ ·çš„æ ¼å­å¯¹ã€‚</p><p>å‘ç°æ­£åšå¾ˆéš¾ï¼Œè€ƒè™‘è¡¥é›†è½¬åŒ–ã€‚å‘ç°ç­‰ä»·çš„å…³ç³»æ˜¯å¯ä»¥ä¼ é€’çš„ï¼Œé‚£ä¹ˆå°±å½¢æˆäº†å¾ˆå¤šä¸ªå›¢ã€‚ç­‰ä»·å…³ç³»å¯ä»¥ bfs æ‰¾ï¼Œå¹¶æŸ¥é›†ç»´æŠ¤ã€‚ç”¨æ€»æ–¹æ¡ˆå‡å»åªé€‰è¿™äº›å›¢çš„æ–¹æ¡ˆæ•°å°±å¥½äº†ã€‚</p><h2 id="CF19E-Fairy"><a href="#CF19E-Fairy" class="headerlink" title="$CF19E-Fairy$"></a><a href="https://codeforces.com/problemset/problem/19/E" target="_blank" rel="noopener">$CF19E-Fairy$</a></h2><hr><p>å¾ˆå¥½çš„é¢˜ã€‚</p><p><strong>å¯¹äºç¯çš„é¢˜ç›®ï¼Œå¯ä»¥è€ƒè™‘ dfs æ ‘ï¼Œå› ä¸ºæœ‰ä¸ªå¾ˆä¼˜çš„æ€§è´¨ï¼šæ‰€æœ‰ç¯åœ¨ dfs æ ‘ä¸Šçš„ä½“ç°å°±æ˜¯ æ ‘è¾¹ + è¿”ç¥–è¾¹ï¼ˆæ²¡æœ‰æ¨ªå‰è¾¹ï¼Œå› ä¸ºæ˜¯ dfs æ ‘ï¼‰</strong></p><p><strong>è€Œç¯åˆ° {è¿”ç¥–è¾¹é›†åˆ} æ˜¯å•å°„</strong></p><p>è®¾å¥‡ç¯æ•°ä¸º $x$</p><ul><li>$x = 0$ï¼Œåˆ ä»»ä½•ä¸€æ¡è¾¹éƒ½å¯ä»¥</li><li>$x = 1$ï¼Œåªèƒ½åˆ å¥‡ç¯ä¸Šçš„è¾¹</li><li>$x &gt; 1$ï¼Œä¸èƒ½åˆ è¿”ç¥–è¾¹ã€‚è€ƒè™‘æ‰€æœ‰çš„æ ‘è¾¹ï¼Œèƒ½è¢«åˆ æ‰å½“ä¸”ä»…å½“æ‰€æœ‰çš„å¥‡ç¯ç»è¿‡äº†å®ƒä¸”<strong>æ²¡æœ‰å¶ç¯ç»è¿‡å®ƒ</strong></li></ul><p>æ ‘ä¸Šå·®åˆ†å°±å¥½äº†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>APIO2019 é¢˜è§£</title>
      <link href="2020/08/04/APIO2019%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/08/04/APIO2019%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="T1-å¥‡æ€ªè£…ç½®"><a href="#T1-å¥‡æ€ªè£…ç½®" class="headerlink" title="$T1. å¥‡æ€ªè£…ç½®$"></a><a href="https://loj.ac/problem/3144" target="_blank" rel="noopener">$T1. å¥‡æ€ªè£…ç½®$</a></h2><hr><p>è€ƒè™‘åˆ°è¿™æœ‰å‘¨æœŸæ€§ï¼Œæˆ‘ä»¬æ€è€ƒæ—¶åˆ» $t1$ å’Œ $t2$ $(t1 &lt; t2)$ åœ¨ä½•æ—¶æ„ä¹‰ç›¸åŒï¼šè®¾ $L = t2 - t1$ ï¼ˆ$L$ å³æ˜¯å‘¨æœŸå¤§å°ï¼‰</p><p>$$L + \lfloor \frac{L}{B} \rfloor \equiv 0 (mod\ A)$$</p><p>$$L \equiv 0 (mod\ B)$$</p><p>é‚£ä¹ˆé‚£ä¸ªä¸‹å–æ•´å°±å¯ä»¥æ‹†äº†ï¼Œæ•´ç†ä¸€ä¸‹ï¼š</p><p>$$\frac{L(B + 1)}{B} \equiv 0 (mod\ A)$$</p><p>æœ‰ä¸€ä¸ªå®šç†ï¼š$ac \equiv bc(mod\ m)$ï¼Œåˆ™ $a \equiv b(mod\ \frac{m}{gcd(m, c)})$ï¼Œäºæ˜¯</p><p>$$L \equiv 0 (mod\ \frac{AB}{gcd(AB, B + 1)})$$</p><p>è€Œå› ä¸º $gcd(x, x + 1) = 1$ æ’æˆç«‹ï¼Œæ‰€ä»¥</p><p>$$L \equiv 0 (mod\ \frac{AB}{gcd(A, B + 1)})$$</p><p>å¾—åˆ°äº†å‘¨æœŸå¤§å°ï¼Œæˆ‘ä»¬å°†åŒºé—´åœ¨æ¨¡ $L$ æ„ä¹‰ä¸‹æ±‚åŒºé—´è¦†ç›–å°±å¥½äº†ã€‚</p><h2 id="T2-æ¡¥æ¢"><a href="#T2-æ¡¥æ¢" class="headerlink" title="$T2. æ¡¥æ¢$"></a><a href="https://loj.ac/problem/3145" target="_blank" rel="noopener">$T2. æ¡¥æ¢$</a></h2><hr><p>1ã€2ã€4æ¡£éƒ¨åˆ†åˆ†éƒ½æŒºå¥½æ‹¿çš„ï¼Ÿé‚£ä¸å°±æœ‰ 43 pts äº†</p><p>è€ƒè™‘æ²¡æœ‰ä¿®æ”¹æ“ä½œï¼šå¯¹äºæ¯ä¸ªè¯¢é—®ï¼Œå°†å€¼å¤§äºç­‰äº wi çš„è¾¹åŠ å…¥å¹¶æŸ¥é›†ï¼Œæœ€ç»ˆç­”æ¡ˆå°±æ˜¯ si æ‰€åœ¨å¹¶æŸ¥é›†å¤§å°ã€‚ä½†åŠ å…¥ä¿®æ”¹çš„è¯ï¼Œæšä¸¾æ‰€æœ‰è¾¹æˆ–è€…æ‰€æœ‰æ“ä½œéƒ½ TLEã€‚æ˜¾ç„¶è¿™æ˜¯å› ä¸ºï¼Œè¯¢é—®å¤ªå¤šçš„æ—¶å€™æšä¸¾è¾¹ä¼šç‚¸ï¼Œä¿®æ”¹å¤ªå¤šçš„æ—¶å€™æšä¸¾æ“ä½œä¼šç‚¸ã€‚</p><p>è€ƒè™‘<strong>å‡æ‘Šï¼ŒæŠŠæ“ä½œåˆ†å—</strong>ï¼Œè®¾å—å¤§å°ä¸º Sï¼Œæ¯è¿‡ S ä¸ªæ“ä½œå°±æš´åŠ›é‡æ„ä¸€æ¬¡ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œåˆ†å—å¤„ç†ï¼Œå°†ä¸€ä¸ªå—å†…çš„æ‰€æœ‰è¯¢é—®æŒ‰ç…§é‡é‡ä»å¤§åˆ°å°æ’åºï¼Œè¾¹æšä¸¾è¯¢é—®è¾¹å°†å—å†…ä¸ä¿®æ”¹çš„è¾¹æ’å…¥ï¼›è€Œå¯¹äºå—å†…ä¿®æ”¹çš„è¾¹ï¼Œé¡¶å¤š S æ¡ï¼Œç”¨å¯æ’¤é”€å¹¶æŸ¥é›†ç»´æŠ¤ï¼Œæš´åŠ›æ’å…¥å†æš´åŠ›åˆ é™¤ã€‚</p><p>O(Q/S * mlogm + QS)ï¼ŒS å– sqrt(mlogm) çš„æ—¶å€™æœ€ä¼˜ã€‚æˆ‘è§‰å¾—è¿™ä¸ªåˆ†å—å¾ˆéš¾æƒ³åˆ°ï¼Œå¾ˆç¥ä»™ï¼ˆè™½ç„¶æœ€ç»ˆå¤æ‚åº¦å…¶å®æ˜¯ 1e8ï¼Œéœ€è¦å¡å¸¸</p><p>ä»£ç ä¹Ÿå¤ªéš¾å†™äº†å§ï¼ï¼ï¼å•Šï¼ï¼ï¼</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e4</span> + <span class="number">10</span>, M = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line">ll n, m, Q, unit;</span><br><span class="line">ll fa[N], sz[N], pos[M], mark[M], pre[M], nxt[M];</span><br><span class="line">ll fax[M], fay[M], szx[M], szy[M], ans[M];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span> <span class="keyword">int</span> x, y, z, id; &#125;e[M], e2[M];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span> <span class="keyword">int</span> x, y, id; &#125;q1[M], q2[M];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmpe</span><span class="params">(edge a, edge b)</span> </span>&#123; <span class="keyword">return</span> a.z &gt; b.z; &#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmpq2</span><span class="params">(node a, node b)</span> </span>&#123; <span class="keyword">return</span> a.y &gt; b.y; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fa[x] == x ? x : getfa(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    x = getfa(x), y = getfa(y);</span><br><span class="line">    <span class="keyword">if</span> (x == y) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (sz[x] &gt; sz[y]) swap(x, y);</span><br><span class="line">    fa[x] = y, sz[y] += sz[x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> &amp;x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ff = <span class="number">1</span>, ch;</span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(ch = getchar())) ch == <span class="string">'-'</span> ? ff = <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">    x = ch &amp; <span class="number">15</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(ch = getchar())) x = (x &lt;&lt; <span class="number">1</span>) + (x &lt;&lt; <span class="number">3</span>) + (ch &amp; <span class="number">15</span>);</span><br><span class="line">    x = x * ff;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    unit = max(unit, <span class="number">1l</span>l);  <span class="comment">// !!!!</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> o = <span class="number">1</span>; o &lt;= (Q - <span class="number">1</span>) / unit + <span class="number">1</span>; ++o) &#123;</span><br><span class="line">        <span class="keyword">int</span> l = (o - <span class="number">1</span>) * unit + <span class="number">1</span>, r = min(o * unit, Q), l1 = <span class="number">0</span>, l2 = <span class="number">0</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, m) mark[i] = pre[i] = <span class="number">0</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, r - l + <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> op; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;op);</span><br><span class="line">            <span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">                ++l1;</span><br><span class="line">                read(q1[l1].x), read(q1[l1].y);</span><br><span class="line">                <span class="keyword">if</span> (pre[q1[l1].x]) nxt[pre[q1[l1].x]] = l1;</span><br><span class="line">                pre[q1[l1].x] = l1;</span><br><span class="line">                nxt[l1] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">if</span> (!mark[q1[l1].x])  <span class="comment">// !!!!</span></span><br><span class="line">                    mark[q1[l1].x] = i;</span><br><span class="line">                q1[l1].id = i;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                ++l2;</span><br><span class="line">                read(q2[l2].x), read(q2[l2].y);</span><br><span class="line">                q2[l2].id = i;</span><br><span class="line">            &#125;</span><br><span class="line">            ans[i] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">memcpy</span>(e2, e, <span class="keyword">sizeof</span>(*e) * (m + <span class="number">1</span>));  <span class="comment">// ï¼ï¼ï¼ï¼ï¼ï¼æ³¨æ„è¿™ä¹ˆå†™ä¼šå¿«å¾ˆå¤š</span></span><br><span class="line">        sort(e + <span class="number">1</span>, e + m + <span class="number">1</span>, cmpe);</span><br><span class="line">        sort(q2 + <span class="number">1</span>, q2 + l2 + <span class="number">1</span>, cmpq2);</span><br><span class="line"></span><br><span class="line">        rep(i, <span class="number">1</span>, n) fa[i] = i, sz[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> pos = <span class="number">1</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, l2) &#123;</span><br><span class="line">            <span class="keyword">while</span> (pos &lt;= m &amp;&amp; e[pos].z &gt;= q2[i].y) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!mark[e[pos].id]) &#123;</span><br><span class="line">                    merge(e[pos].x, e[pos].y);</span><br><span class="line">                &#125;</span><br><span class="line">                ++pos;</span><br><span class="line">            &#125;</span><br><span class="line">            rep(j, <span class="number">1</span>, l1) &#123;</span><br><span class="line">                <span class="keyword">if</span> (((!nxt[j] || q1[nxt[j]].id &gt; q2[i].id) &amp;&amp; q1[j].y &gt;= q2[i].y &amp;&amp; q1[j].id &lt; q2[i].id) ||  <span class="comment">// è¯¢é—®å‰æœ€åä¸€æ¬¡ä¿®æ”¹æˆ–ä¿®æ”¹åœ¨è¯¢é—®åä½†ä¹‹å‰çš„è¾¹é‡é‡ç¬¦åˆæ¡ä»¶</span></span><br><span class="line">                    (mark[q1[j].x] &gt; q2[i].id &amp;&amp; e2[q1[j].x].z &gt;= q2[i].y)) &#123; <span class="comment">// e æ’åºäº†ï¼Œè¦æœ‰ä¸ª e2 æ¥å­˜åŸæ¥çš„é¡ºåº</span></span><br><span class="line">                    <span class="keyword">int</span> x = getfa(e2[q1[j].x].x), y = getfa(e2[q1[j].x].y);</span><br><span class="line">                    fax[j] = x, fay[j] = y, szx[j] = sz[x], szy[j] = sz[y];</span><br><span class="line">                    merge(x, y);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ans[q2[i].id] = sz[getfa(q2[i].x)];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = l1; j; --j) &#123;</span><br><span class="line">                <span class="keyword">if</span> (fax[j]) &#123;</span><br><span class="line">                    <span class="keyword">int</span> x = fax[j], y = fay[j];</span><br><span class="line">                    fa[x] = x, fa[y] = y, sz[x] = szx[j], sz[y] = szy[j];</span><br><span class="line">                    fax[j] = fay[j] = szx[j] = szy[j] = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">memcpy</span>(e, e2, <span class="keyword">sizeof</span>(*e) * (m + <span class="number">1</span>));</span><br><span class="line">        rep(i, <span class="number">1</span>, l1)</span><br><span class="line">            e[q1[i].x].z = q1[i].y;</span><br><span class="line">        rep(i, <span class="number">1</span>, r - l + <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> (ans[i]) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    unit = <span class="built_in">sqrt</span>(m * <span class="built_in">log</span>(m) / <span class="built_in">log</span>(<span class="number">2</span>));</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;e[i].x, &amp;e[i].y, &amp;e[i].z);</span><br><span class="line">        e[i].id = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; Q;</span><br><span class="line">    solve();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="T3-è·¯ç¯"><a href="#T3-è·¯ç¯" class="headerlink" title="$T3. è·¯ç¯$"></a><a href="https://loj.ac/problem/3146" target="_blank" rel="noopener">$T3. è·¯ç¯$</a></h2><hr><p>ä¸¤é“æ•°æ®ç»“æ„é¢˜ï¼ï¼ï¼ã€‚ã€‚ã€‚1ã€2ã€4 æ¡£åˆ†å¥½å¥½æ‹¿å‘€= = çœ‹é¢˜è§£å­¦äº†æ­£è§£ã€‚</p><p>è€ƒè™‘åœ¨è¿é€šåŒºé—´ $[l, r]$ ä¸­å»æ‰ä¸€æ¡è¾¹ $[k, k + 1]$ï¼Œå½±å“çš„åªæ˜¯ $[l, k]$ åˆ° $[k + 1, r]$ çš„è”é€šæ€§ã€‚</p><p>è€ƒè™‘å°†è´¡çŒ®å·®åˆ†ï¼Œæ—¶é—´æ®µ = æ—¶é—´ç‚¹ç›¸å‡ï¼š</p><ul><li>åŠ å…¥è¾¹ï¼Œ$[l, k]$ åˆ° $[k + 1, r]$ æ‰€æœ‰ç­”æ¡ˆ $- i$</li><li>åˆ é™¤è¾¹ï¼Œ$[l, k]$ åˆ° $[k + 1, r]$ æ‰€æœ‰ç­”æ¡ˆ $+ i$</li></ul><p>åŒæ—¶å¯¹äºè¯¢é—®çš„æ—¶åˆ» tï¼Œè‹¥ä¸¤ä¸ªç‚¹è¿é€šï¼Œç­”æ¡ˆè¦ $+ t$</p><p>çœ‹åˆ°ç‚¹å¯¹ï¼Œæƒ³åˆ°è½¬åŒ–æˆå¹³é¢é—®é¢˜ã€‚æŠŠåŒºé—´æŠ½è±¡æˆåæ ‡ï¼Œå°±æ˜¯äºŒç»´æ•°ç‚¹é—®é¢˜ï¼Œç¦»çº¿ç”¨æ ‘çŠ¶æ•°ç»„å¥—çº¿æ®µæ ‘æˆ–è€… CDQ åˆ†æ²»ã€‚$O(nlog^2n)$</p><p>ç„¶è€Œä»£ç å…ˆå’•å’•</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘Boruvka</title>
      <link href="2020/08/01/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91Boruvka/"/>
      <url>2020/08/01/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91Boruvka/</url>
      
        <content type="html"><![CDATA[<p>$Boruvka..Bvroukaâ€¦Brouvkaâ€¦.???$</p><p>$Boruvka$ æ˜¯ä¸€ä¸ªå¤è€çš„æœ€å°ç”Ÿæˆæ ‘ç®—æ³•ï¼Œç»¼åˆäº† $Kruskal$ å’Œ $Prim$.ï¼ˆæˆ‘è§‰å¾—æ›´åƒæ˜¯è¿›é˜¶ç‰ˆ $Prim$ï¼‰</p><p>å®ƒçš„ç®—æ³•æµç¨‹æ˜¯ï¼šåˆå§‹æ—¶æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ä¸€ä¸ªè¿é€šå—ï¼Œæ¯æ¬¡ä»<strong>æ¯ä¸ª</strong>å—ä¼¸å‡ºå»ä¸€æ¡æœ€çŸ­è¾¹ï¼Œç„¶åæŠŠæ–°å½¢æˆçš„è¿é€šå—ç¼©æˆä¸€ä¸ªæ–°çš„å—ã€‚æ¯æ¬¡ å—ä¸ªæ•°è‡³å°‘å‡åŠï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ˜¯ log çš„ã€‚ç®—æ³•æ­£ç¡®æ€§å¯ä»¥å‚è€ƒ $Prim$ çš„ï¼Œç›¸å½“äºæ¯æ¬¡æ‰©å±•å¤šæ£µå­æ ‘ã€‚</p><p>B <strong>åˆå¹¶åªæœ‰ log æ¬¡</strong>ï¼Œè¿™æ˜¯ K å’Œ P åšä¸åˆ°çš„ã€‚</p><p>é€šå¸¸å®ƒä½œä¸ºä¸€ç§<strong>æ€æƒ³</strong>ä¼šå¾ˆæœ‰ç”¨ï¼Œæ¯”å¦‚<strong>ä½è¿ç®—ç”Ÿæˆæ ‘</strong>ï¼Œé€šå¸¸æ˜¯è¾¹æƒéš¾ä»¥ç›´æ¥ç»´æŠ¤çš„ã€‚</p><h2 id="CF888G"><a href="#CF888G" class="headerlink" title="$[CF888G]$"></a>$[CF888G]$</h2><hr><p>é¢˜æ„ï¼šè¾¹ $&lt;i, j&gt;$ è¾¹æƒä¸º $a_i\ XOR\ a_j$ çš„æœ€å°ç”Ÿæˆæ ‘</p><p>è€ƒè™‘ $Trie$ æ ‘ï¼Œå…±æœ‰ $n - 1$ ä¸ª $LCA$ï¼ˆ$n - 1$ ä¸ªæœ‰ä¸¤ä¸ªå„¿å­çš„èŠ‚ç‚¹ï¼‰</p><p>æ ¹æ® B ç®—æ³•çš„<strong>æ€æƒ³</strong>ï¼Œï¼ˆå°†æ¯ä¸ªå­æ ‘è§†ä¸ºä¸€ä¸ªå—ï¼‰ï¼Œå®¹æ˜“å‘ç°è‹¥ $x$ åŒæ—¶æœ‰ $0/1$ å­æ ‘ï¼Œä¸¤ä¸ªå­æ ‘å°±ä¼šè¿è¾¹</p><p>éå† $Trie$ æ ‘ï¼Œåœ¨æ¯ä¸ª $LCA$ å¤„åšå¯å‘å¼åˆå¹¶ã€æŸ¥å·¦å³å­æ ‘è¿è¾¹çš„æœ€å°å€¼</p><h2 id="CF1305G"><a href="#CF1305G" class="headerlink" title="$[CF1305G]$"></a>$[CF1305G]$</h2><hr><p>é¢˜æ„ï¼šè¿è¾¹ $&lt;i, j&gt;$ è§„åˆ™ä¸º $a_i\ AND\ a_j = 0$ çš„æœ€å¤§ç”Ÿæˆæ ‘</p><p>æ³¨æ„åˆ°è¿™æ˜¯ä¸€æ£µæ ‘ï¼Œä¸”å®ƒçš„ç‰¹æ€§åœ¨äºï¼Œæ¯ä¸ªç‚¹çš„å…¥åº¦ä»…ä¸º 1.</p><p>äºæ˜¯æœ‰ä¸ªå¾ˆå¦™çš„æ–¹æ³•ï¼šå°†æ¯æ¡è¾¹æƒå€¼æ”¹ä¸º $a_i + a_j$ï¼Œæœ€ç»ˆç­”æ¡ˆæ˜¯è¾¹æƒå’Œ $- \sum{a_i}$ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±è½¬åŒ–æˆæœ€å¤§ç”Ÿæˆæ ‘ã€‚</p><p>$boruvka$ ç®—æ³•ç›´æ¥åšï¼Œæ¯ä¸€è½®å­é›† dp ç»´æŠ¤å‡ºæ¯ä¸ªäºŒè¿›åˆ¶é›†åˆå†…æœ€å¤§å’Œæ¬¡å¤§çš„ç‚¹æƒï¼Œ<strong>ä¸¤ä¸ªç‚¹æ‰€åœ¨é›†åˆä¸åŒ</strong>ï¼Œè¿™æ ·æŸ¥è¯¢çš„æ—¶å€™æŸ¥è¯¢è¡¥é›†ï¼Œå°±ç®—æœ€å¤§çš„ç‚¹æƒå’Œå½“å‰ç‚¹åœ¨åŒä¸€é›†åˆé‡Œï¼Œä¹Ÿèƒ½â€œæ’â€æ‰ï¼Œé€‰åˆ°æ¬¡å¤§ç‚¹ã€‚å¯ä»¥ç”¨ pair è®°å½• &lt;ç‚¹æƒï¼Œé›†åˆçš„id&gt;ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">10</span>, M = (<span class="number">1</span> &lt;&lt; <span class="number">18</span>);</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">int</span> n, a[N], fa[N], cnt;</span><br><span class="line">ll ans;</span><br><span class="line">pii mx[M][<span class="number">2</span>], cur[M];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fa[x] == x ? x : fa[x] = getfa(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    x = getfa(x), y = getfa(y);</span><br><span class="line">    <span class="keyword">if</span> (x == y) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    fa[x] = y;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]), fa[i] = i;</span><br><span class="line">        ans -= a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    cnt = n + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (cnt &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        rep(i, <span class="number">0</span>, M - <span class="number">1</span>)</span><br><span class="line">            rep(j, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">                mx[i][j] = make_pair(<span class="number">-1</span>, <span class="number">-1</span>);</span><br><span class="line">        rep(i, <span class="number">0</span>, n) &#123;</span><br><span class="line">            pii t = make_pair(a[i], getfa(i));</span><br><span class="line">            <span class="keyword">if</span> (mx[a[i]][<span class="number">0</span>] &lt; t) &#123;</span><br><span class="line">                <span class="keyword">if</span> (mx[a[i]][<span class="number">0</span>].se != t.se) mx[a[i]][<span class="number">1</span>] = mx[a[i]][<span class="number">0</span>];</span><br><span class="line">                mx[a[i]][<span class="number">0</span>] = t;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mx[a[i]][<span class="number">1</span>] &lt; t) &#123;</span><br><span class="line">                <span class="keyword">if</span> (mx[a[i]][<span class="number">0</span>].se != t.se) mx[a[i]][<span class="number">1</span>] = t;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i, <span class="number">0</span>, M - <span class="number">1</span>) &#123;</span><br><span class="line">            rep(j, <span class="number">0</span>, <span class="number">18</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i &amp; (<span class="number">1</span> &lt;&lt; j)) &#123;</span><br><span class="line">                    rep(k, <span class="number">0</span>, <span class="number">1</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (mx[i][<span class="number">0</span>] &lt; mx[i ^ (<span class="number">1</span> &lt;&lt; j)][k]) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (mx[i][<span class="number">0</span>].se != mx[i ^ (<span class="number">1</span> &lt;&lt; j)][k].se) mx[i][<span class="number">1</span>] = mx[i][<span class="number">0</span>];</span><br><span class="line">                            mx[i][<span class="number">0</span>] = mx[i ^ (<span class="number">1</span> &lt;&lt; j)][k];</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mx[i][<span class="number">1</span>] &lt; mx[i ^ (<span class="number">1</span> &lt;&lt; j)][k]) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (mx[i][<span class="number">0</span>].se != mx[i ^ (<span class="number">1</span> &lt;&lt; j)][k].se) mx[i][<span class="number">1</span>] = mx[i ^ (<span class="number">1</span> &lt;&lt; j)][k];</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i, <span class="number">0</span>, n)</span><br><span class="line">            cur[i] = make_pair(<span class="number">-1</span>, <span class="number">-1</span>);</span><br><span class="line">        rep(i, <span class="number">0</span>, n) &#123;</span><br><span class="line">            <span class="keyword">int</span> f = getfa(i);</span><br><span class="line">            <span class="keyword">int</span> t = ((M - <span class="number">1</span>) ^ a[i]);</span><br><span class="line">            <span class="keyword">if</span> (mx[t][<span class="number">0</span>].se != <span class="number">-1</span> &amp;&amp; mx[t][<span class="number">0</span>].se != f) &#123;</span><br><span class="line">                cur[f] = max(cur[f], make_pair(mx[t][<span class="number">0</span>].fi + a[i], mx[t][<span class="number">0</span>].se));</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mx[t][<span class="number">1</span>].se != <span class="number">-1</span> &amp;&amp; mx[t][<span class="number">1</span>].se != f) &#123;</span><br><span class="line">                cur[f] = max(cur[f], make_pair(mx[t][<span class="number">1</span>].fi + a[i], mx[t][<span class="number">1</span>].se));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i, <span class="number">0</span>, n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (fa[i] == i &amp;&amp; merge(i, cur[i].se)) &#123;</span><br><span class="line">                cnt--, ans += cur[i].fi;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>$O(2^{18} * 18 * logn)$</p><h2 id="UOJ176"><a href="#UOJ176" class="headerlink" title="$[UOJ176]$"></a>$[UOJ176]$</h2><hr><p>é¢˜æ„ï¼šè¾¹ $&lt;i, j&gt;$ è¾¹æƒä¸º $a_i\ AND\ a_j$ çš„æœ€å¤§ç”Ÿæˆæ ‘</p><p>é€šè¿‡ cf1305gï¼Œæˆ‘ä»¬ç§¯ç´¯äº†ä¸€å®šçš„ç»éªŒã€‚ç›´æ¥æƒ³åˆ° B ç®—æ³•ï¼Œç°åœ¨çš„é—®é¢˜å°±æ˜¯æ€ä¹ˆç»´æŠ¤ a &amp; b æœ€å¤§ã€‚</p><p>æšä¸¾å­é›†çš„è¯åº”è¯¥å¯ä»¥åšï¼Œä¸è¿‡æ˜¯ 3^18 çš„ï¼Ÿ</p><p>å†æƒ³æƒ³ trie æ ‘ï¼Œæˆ‘ä»¬å‘ç°è·Ÿ XOR ä¸åŒçš„æ˜¯ï¼Œ1 çš„è¯èµ° 1ï¼Œ0 çš„è¯èµ° 0/1 çš†å¯ï¼Œå¯è¿™æ ·çš„å¤æ‚åº¦æ˜¯ä¸å¯¹çš„å•Šï¼Œ$O(n<em>2^m</em>logn)$ ï¼</p><p>è¿™æ—¶åªè¦<strong>è‡ªåº•å‘ä¸Š</strong>ï¼ˆä¸ç„¶ä¼šå‡ºé—®é¢˜ï¼‰å°† 1 å­æ ‘åˆå¹¶åˆ° 0 å­æ ‘ä¸Šå°±å¥½äº†ï¼å°±å˜æˆäº† 1 èµ° 1ï¼Œ0 èµ° 0ï¼å¤æ‚åº¦å°±æ˜¯ $O((n + 2^m) * mlogn)$</p><p>å®ç°ç»†èŠ‚è·Ÿå‰ä¸€é¢˜ä¸€æ ·ï¼Œä¿ç•™ä¸¤ä¸ªæœ€å¤§çš„ idï¼Œä¿è¯â€œæ’â€æ‰è¿˜æœ‰ï¼ŒæŸ¥è¯¢çš„æ—¶å€™è¦æ±‚æ¯æ—¶æ¯åˆ»èµ°åˆ°çš„å­æ ‘éƒ½æœ‰ å’Œå½“å‰ç‚¹ä¸åœ¨åŒä¸€é›†åˆçš„ç‚¹</p><p>æ€»ä¹‹å°±æ˜¯èµ° ä¿è¯å­˜åœ¨åˆæ³•è§£çš„æœ€ä¼˜è·¯å¾„ï¼</p><p>ï¼ˆè¿˜æœ‰ä¸€ä¸ªå®Œå…¨ä¸åŒã€è€Œä¸”ç‰¹åˆ«ç®€å•æ˜“æ‡‚çš„<a href="http://vfleaking.blog.uoj.ac/blog/1244" target="_blank" rel="noopener">å¥½åŠæ³•</a>ï¼Œè¯¦è§ç®—æ³•ä¸ƒï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>, M = <span class="number">8e6</span> + <span class="number">5</span>, inf = <span class="number">0x3f3f3f3f</span>;  <span class="comment">// æ— è¯­å­ğŸ˜“ M å¼€ 2 &lt;&lt; 18 å°± MLEï¼Œå¼€ 8e6 å°± ACã€‚ã€‚ã€‚</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">int</span> n, m, cnt, idx, rt, cas;</span><br><span class="line"><span class="keyword">int</span> a[N], fa[N], ch[M][<span class="number">2</span>], mx[M][<span class="number">2</span>];</span><br><span class="line">ll ans;</span><br><span class="line">pii cur[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fa[x] == x ? x : fa[x] = getfa(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x || !y) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (mx[x][<span class="number">0</span>] == mx[y][<span class="number">0</span>]) mx[x][<span class="number">1</span>] = max(mx[x][<span class="number">1</span>], mx[y][<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span> (mx[x][<span class="number">0</span>] &lt; mx[y][<span class="number">0</span>]) mx[x][<span class="number">1</span>] = max(mx[x][<span class="number">0</span>], mx[y][<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span> (mx[x][<span class="number">0</span>] &gt; mx[y][<span class="number">0</span>]) mx[x][<span class="number">1</span>] = max(mx[x][<span class="number">1</span>], mx[y][<span class="number">0</span>]);</span><br><span class="line">    mx[x][<span class="number">0</span>] = max(mx[x][<span class="number">0</span>], mx[y][<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">newnode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ++idx;</span><br><span class="line">    ch[idx][<span class="number">0</span>] = ch[idx][<span class="number">1</span>] = <span class="number">0</span>, mx[idx][<span class="number">0</span>] = mx[idx][<span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">return</span> idx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x || !y) <span class="keyword">return</span> x | y;</span><br><span class="line">    <span class="keyword">int</span> t = newnode();</span><br><span class="line">    ch[t][<span class="number">0</span>] = merge(ch[x][<span class="number">0</span>], ch[y][<span class="number">0</span>]);</span><br><span class="line">    ch[t][<span class="number">1</span>] = merge(ch[x][<span class="number">1</span>], ch[y][<span class="number">1</span>]);</span><br><span class="line">    upd(t, x), upd(t, y);</span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> dep)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep &lt; <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> ls = ch[x][<span class="number">0</span>], rs = ch[x][<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (ls) dfs(ls, dep - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (rs) dfs(rs, dep - <span class="number">1</span>);</span><br><span class="line">    ch[x][<span class="number">0</span>] = merge(ch[x][<span class="number">0</span>], ch[x][<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">unite</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    x = getfa(x), y = getfa(y);</span><br><span class="line">    <span class="keyword">if</span> (x == y) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    fa[x] = y;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> dep, <span class="keyword">int</span> val, <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x) x = ++idx;</span><br><span class="line">    <span class="keyword">if</span> (dep &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mx[x][<span class="number">0</span>] != id) &#123;</span><br><span class="line">            <span class="keyword">if</span> (mx[x][<span class="number">0</span>] &lt; id) mx[x][<span class="number">1</span>] = mx[x][<span class="number">0</span>], mx[x][<span class="number">0</span>] = id;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (mx[x][<span class="number">1</span>] &lt; id) mx[x][<span class="number">1</span>] = id;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> c = ((val &gt;&gt; dep) &amp; <span class="number">1</span>);</span><br><span class="line">    insert(ch[x][c], dep - <span class="number">1</span>, val, id);</span><br><span class="line">    mx[x][<span class="number">0</span>] = mx[x][<span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line">    upd(x, ch[x][<span class="number">0</span>]), upd(x, ch[x][<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">pii <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> dep, <span class="keyword">int</span> val, <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> make_pair(<span class="number">0</span>, (id == mx[x][<span class="number">0</span>] ? mx[x][<span class="number">1</span>] : mx[x][<span class="number">0</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> c = ((val &gt;&gt; dep) &amp; <span class="number">1</span>), ls = ch[x][<span class="number">0</span>], rs = ch[x][<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (c) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!rs || (id == mx[rs][<span class="number">0</span>] &amp;&amp; mx[rs][<span class="number">1</span>] == <span class="number">-1</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> query(ls, dep - <span class="number">1</span>, val, id);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            pii t = query(rs, dep - <span class="number">1</span>, val, id);</span><br><span class="line">            t.fi += (<span class="number">1</span> &lt;&lt; dep);</span><br><span class="line">            <span class="keyword">return</span> t;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> query(ls, dep - <span class="number">1</span>, val, id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">        fa[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    cnt = n;</span><br><span class="line">    <span class="keyword">while</span> (cnt &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        ++cas;</span><br><span class="line">        rep(i, <span class="number">0</span>, idx) &#123;</span><br><span class="line">            ch[i][<span class="number">0</span>] = ch[i][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">            mx[i][<span class="number">0</span>] = mx[i][<span class="number">1</span>] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        idx = rt = <span class="number">0</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">            insert(rt, m, a[i], getfa(i));</span><br><span class="line">            cur[i] = make_pair(<span class="number">-1</span>, <span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        dfs(rt, m);</span><br><span class="line">        rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">            <span class="keyword">int</span> f = getfa(i);</span><br><span class="line">            pii t = query(rt, m, a[i], f);</span><br><span class="line">            cur[f] = max(cur[f], t);</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (fa[i] == i &amp;&amp; cur[i].se &gt; <span class="number">0</span> &amp;&amp; unite(i, cur[i].se)) &#123;</span><br><span class="line">                cnt--, ans += cur[i].fi;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æœ€å°ç”Ÿæˆæ ‘ </tag>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20Jul CF&amp;AT ç»ƒé¢˜æ±‡æ€»</title>
      <link href="2020/07/31/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%9120Jul%20AT&amp;CF%20%E7%BB%83%E9%A2%98%E6%B1%87%E6%80%BB/"/>
      <url>2020/07/31/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%9120Jul%20AT&amp;CF%20%E7%BB%83%E9%A2%98%E6%B1%87%E6%80%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="CF1039D"><a href="#CF1039D" class="headerlink" title="CF1039D"></a><a href="https://www.luogu.com.cn/problem/CF1039D" target="_blank" rel="noopener">CF1039D</a></h2><hr><p>æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹è‡³å¤šå±äºå…¶ä¸­ä¸€æ¡è·¯å¾„!!!</p><p>çœ‹åˆ°é¢˜ç›®ï¼šè¿™èƒ½åšï¼Ÿèƒ½åšï¼Ÿï¼Ÿèƒ½åšï¼Ÿï¼Ÿï¼Ÿï¼Ÿ</p><p>å¯¹ä¸èµ·ï¼Œç”¨æ ¹å·åˆ†æ²»å°±æ˜¯èƒ½åšï¼ˆçš®</p><ul><li>k &lt;= sqrt(n) çš„æš´åŠ›ç®—ï¼ŒO(nsqrt(n))</li><li>k &gt; sqrt(n) çš„ï¼Œå®¹æ˜“å‘ç°ç­”æ¡ˆä¸€å®šåœ¨ (0, sqrt(n)) çš„åŒºé—´å†…å•è°ƒä¸å¢ï¼Œæœ€å¤šåªæœ‰ sqrt(n) ç§ï¼Œæ‰€ä»¥å¯¹äºå½“å‰çš„ k äºŒåˆ†å‡ºä¸å®ƒç­”æ¡ˆç›¸åŒçš„æœ€å³ä½ç½®ï¼Œæ›´æ–°è¿™ä¸€æ®µçš„ç­”æ¡ˆ</li></ul><p>å¤æ‚åº¦ O(nsqrt(n)*logn)</p><p>HINTï¼šå¸¸æ•°å·¨å¤§ï¼Œæ™®é€š dfs é€’å½’ä¼š Tã€‚ã€‚è¦å…ˆå¤„ç† dfs åºç„¶åä»ä¸‹å¾€ä¸Š dpã€‚ã€‚ã€‚5070msã€‚ã€‚ã€‚</p><p>æ®è¯´èƒ½ç”¨æ•´ä½“äºŒåˆ†åšï¼Œå…ˆå’•å’•</p><h2 id="CF1039E"><a href="#CF1039E" class="headerlink" title="CF1039E"></a><a href="https://www.luogu.com.cn/problem/CF1039E" target="_blank" rel="noopener">CF1039E</a></h2><hr><p>LCT + åˆ†å—ï¼Œå…ˆå’•å’•</p><h2 id="CF455D"><a href="#CF455D" class="headerlink" title="CF455D"></a><a href="https://www.luogu.com.cn/problem/CF455D" target="_blank" rel="noopener">CF455D</a></h2><hr><p>æ“ä½œ 1 æ¯æ¬¡åªç§»åŠ¨ä¸¤ä½ï¼Œè€Œä¸”æ“ä½œ 2 è¯¢é—®çš„ä¿¡æ¯å¯åˆå¹¶ï¼Œå¯ä»¥ç”¨åˆ†å— + åŒç«¯é˜Ÿåˆ—ï¼ŒO(n * sqrt(n) * logn) cf ç¥è¯„æµ‹æœºå°±è·‘è¿‡å»äº†ï¼</p><h2 id="CF1045B"><a href="#CF1045B" class="headerlink" title="CF1045B"></a><a href="https://www.luogu.com.cn/problem/CF1045B" target="_blank" rel="noopener">CF1045B</a></h2><hr><p><a href="https://www.cnblogs.com/yyf0309/p/9808323.html" target="_blank" rel="noopener">é¢˜è§£</a></p><p>å¦™é¢˜ï¼Œå®¹æ˜“æƒ³åˆ° æ— æ³•æ„æˆçš„æ•°å¯ä»¥å…¨ç”¨ A ä¸­æˆ–å…¨ç”¨ B ä¸­çš„æ•°æ„æˆã€‚è®¾ä¸èƒ½æ„æˆçš„æ•°ä¸º tï¼ŒA ä¸­æ„æˆ t çš„æ•°ä¸º X å’Œ Yã€‚</p><p>ç”±æ¨¡çš„æ€§è´¨å¾—ï¼Œè‹¥ X &lt; t åˆ™ Y &lt; t, è‹¥ X &gt; t åˆ™ Y &gt; tï¼Œæ‰€ä»¥ä»»ä½•ä¸€ä¸ª t å°† A é›†åˆåˆ’ä¸ºä¸¤åŠï¼Œæ¯ä¸€éƒ¨åˆ†é¦–å°¾é…å¯¹åï¼Œæ¯å¯¹çš„å’Œéƒ½ç­‰äº t</p><p>å¦‚ä½•åˆ¤ 1 ~ i é¦–å°¾é…å¯¹çš„å€¼ç›¸åŒï¼Ÿè®¾ 1 &lt;= a &lt; b &lt; c &lt; d &lt;= i, è‹¥ a + d = b + c åˆ™ a - b = c - dï¼Œåšä¸€ä¸ªå·®åˆ†ç„¶åè·‘ manacher æˆ– hash åˆ¤å›æ–‡å°±å¥½äº†ï¼Œå¦™å•Šã€‚</p><h2 id="CF1249D2"><a href="#CF1249D2" class="headerlink" title="CF1249D2"></a><a href="https://www.luogu.com.cn/problem/CF1249D2" target="_blank" rel="noopener">CF1249D2</a></h2><hr><p>è´ªå¿ƒï¼Œæˆ‘çœŸçš„ä¸è¡Œã€‚ã€‚æŒ‰å·¦ç«¯ç‚¹æ’åºï¼Œä»å·¦å¾€å³æ‰«ï¼Œå¤§æ ¹å †ç»´æŠ¤å³ç«¯ç‚¹ï¼Œè‹¥å·¦ç«¯ç‚¹è¦†ç›–æ¬¡æ•°è¶…è¿‡ K åˆ™å¼¹å‡ºå †é¡¶çº¿æ®µ</p><h2 id="CF255E"><a href="#CF255E" class="headerlink" title="CF255E"></a><a href="https://www.luogu.com.cn/problem/CF255E" target="_blank" rel="noopener">CF255E</a></h2><hr><p>ç¬¬ä¸€æ¬¡æ„Ÿè§‰åšå¼ˆè®ºæ²¡é‚£ä¹ˆé«˜å†·å“ˆå“ˆå“ˆ</p><p>æ‰“å‡º 1e6 çš„è¡¨å‘ç° sg å€¼å¾ˆå°ï¼Œåªä¸º 0 ï½ 3ã€‚å°† a ä»å°åˆ°å¤§æ’åºï¼Œå°ºå–æ³•åšï¼ˆå°±æ˜¯åŒæŒ‡é’ˆä¸€æ ·çš„ï¼Œå·¦ç«¯ç‚¹æŒª+å³ç«¯ç‚¹æŒªï¼‰ã€‚</p><p>æˆ–è€…å¯ä»¥å‰ç¼€å’Œï¼Œè®°å½• sum(i, j) è¡¨ç¤º 1 ~ i å†… sg = j çš„ä¸ªæ•°ï¼Œè¿™æ ·å°±å¯ä»¥ O(1) ç®—ï¼ï¼</p><h2 id="CF280C"><a href="#CF280C" class="headerlink" title="CF280C"></a><a href="https://www.luogu.com.cn/problem/CF280C" target="_blank" rel="noopener">CF280C</a></h2><hr><p>ä¸€ä¸ªèŠ‚ç‚¹æœ‰è´¡çŒ® 1 ï¼Œå½“ä¸”ä»…å½“å®ƒåˆ°æ ¹çš„è·¯å¾„ä¸Šæ²¡æœ‰ç‚¹æŸ“é»‘ã€‚æ‰€ä»¥é€‰åˆ°å®ƒçš„æ¦‚ç‡æ˜¯ 1 / dep[x], æœŸæœ›æ˜¯ 1 * 1 / dep[x]ï¼Œè·Ÿé™¤ç¥–å…ˆä»¬å¤–çš„èŠ‚ç‚¹æ— å…³ï¼ˆå…¶ä»–ä¸äº§ç”Ÿå½±å“çš„å°±å¯ä»¥ä¸ç®¡äº†ï¼Œåæ­£å¯¹äºä¸€ä¸ªå±€éƒ¨æ¥è¯´å•¥éƒ½æ²¡å‘ç”Ÿï¼‰</p><h2 id="CF200A"><a href="#CF200A" class="headerlink" title="CF200A"></a><a href="https://www.luogu.com.cn/problem/CF200A" target="_blank" rel="noopener">CF200A</a></h2><hr><p>æš´åŠ›ä¼˜åŒ–ï¼Œéå¸¸ä¹‹å‰å®³</p><p>è€ƒè™‘å¤šæ¬¡è¯¢é—®ä¸€ä¸ªä½ç½®ï¼Œæš´åŠ›æŸ¥è¯¢çš„è¯ä¼šé‡å¤æŸ¥è¯¢ä¸€äº›è·ç¦»ï¼Œå¼€æ•°ç»„å­˜ä¸€ä¸‹å°±å¥½äº†ã€‚</p><p>æ¯æ¬¡è¯¢é—®æ—¶æ›´æ–°ï¼ŒO(èƒ½è¿‡) ç³»åˆ—ä½†çœŸçš„è·‘çš„å¾ˆå¿«ï¼</p><h2 id="CF208B"><a href="#CF208B" class="headerlink" title="CF208B"></a><a href="https://www.luogu.com.cn/problem/CF208B" target="_blank" rel="noopener">CF208B</a></h2><hr><p>n å¾ˆå°ï¼Œè®°å¿†åŒ–æœç´¢ã€‚æ³¨æ„åˆ°æ¯ä¸€ä½åªå—åç¬¬ä¸€ä½å’Œåç¬¬ä¸‰ä½å½±å“ï¼ŒçŠ¶æ€åªè¦è®°å½•è¿ç»­ä¸‰ä½ã€‚</p><h2 id="CF187D"><a href="#CF187D" class="headerlink" title="CF187D"></a><a href="https://www.luogu.com.cn/problem/CF187D" target="_blank" rel="noopener">CF187D</a></h2><hr><p>å‘ç°è¢«ä¸€ä¸ªçº¢ç¯å¡äº†åï¼Œä¹‹åçš„èŠ±è´¹éƒ½æ˜¯å¯ä»¥é¢„å¤„ç†çš„ï¼ˆæ±‚ä¸€ä¸‹æ¯ä¸ªç‚¹ä» 0 æ—¶åˆ»èµ°åˆ°ç»ˆç‚¹çš„æ—¶é—´ï¼‰ã€‚æŠŠ dist éƒ½ mod(g + r)ï¼Œé—®é¢˜å°±å˜æˆäº†æ±‚å³è¾¹æœ€è¿‘çš„ dist åœ¨ [g, r - 1] å†…çš„ä½ç½®ï¼Œæƒå€¼çº¿æ®µæ ‘ç»´æŠ¤åŒºé—´æœ€å°å€¼</p><h2 id="CF190E"><a href="#CF190E" class="headerlink" title="CF190E"></a><a href="https://www.luogu.com.cn/problem/CF190E" target="_blank" rel="noopener">CF190E</a></h2><hr><p>å¤æ‚åº¦æ˜¯å…³äº m çš„ã€‚ã€‚é“¾è¡¨æˆ– set ä¼˜åŒ– bfsï¼Œæ¯ä¸ªç‚¹åªä¼šè¢«è®¿é—®åº¦æ•°æ¬¡ï¼Œå¤æ‚åº¦ O(mlogn)</p><h2 id="CF191E"><a href="#CF191E" class="headerlink" title="CF191E"></a><a href="https://www.luogu.com.cn/problem/CF191E" target="_blank" rel="noopener">CF191E</a></h2><hr><p>æ±‚ç¬¬ K å¤§è¿ç»­åŒºé—´çš„ val å’Œã€‚è€ƒè™‘äºŒåˆ†åˆ¤å®šï¼Œç¦»æ•£åŒ– + æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ã€‚</p><h2 id="CF185D"><a href="#CF185D" class="headerlink" title="CF185D"></a><a href="https://www.luogu.com.cn/problem/CF185D" target="_blank" rel="noopener">CF185D</a></h2><hr><p>å¾ˆå¥½çš„æ•°å­¦é¢˜</p><p>è®¾ $x = k^{2^l} + 1$</p><p>$k^{2^{l + 1}} + 1 = (x - 1)^2 + 1$</p><p>$gcd(x, (x - 1)^2 + 1) = gcd(x, x^2 - 2x + 1) = gcd(x, 2)$</p><ul><li>k ä¸ºå¥‡æ•°ï¼šans = $\frac{PROD}{2^{r - l}}$</li><li>k ä¸ºå¶æ•°ï¼šans = $PROD$</li></ul><p>æ ¹æ®ç­‰æ¯”æ•°åˆ—çš„çŸ¥è¯†ï¼Œ$PROD = \frac{(k^{2^{r + 1}} - 1)}{(k^{2^l} - 1)}$</p><h2 id="CF432D"><a href="#CF432D" class="headerlink" title="CF432D"></a><a href="https://www.luogu.com.cn/problem/CF432D" target="_blank" rel="noopener">CF432D</a></h2><hr><p><a href="https://ouuan.github.io/post/cf432d-prefixes-and-suffixeskmp/" target="_blank" rel="noopener">è®²å¾—å¥½çš„é¢˜è§£</a></p><p>KMP æ€§è´¨é¢˜ï¼Œf[nxt[i]] = 1 + sum{f[i]}</p><h2 id="CF1107F"><a href="#CF1107F" class="headerlink" title="CF1107F"></a><a href="https://www.luogu.com.cn/problem/CF1107F" target="_blank" rel="noopener">CF1107F</a></h2><hr><p>è´·æ¬¾æœ‰ä¸‰ç§ï¼šä¸ç”¨ï¼Œä»˜å®Œï¼Œæ²¡ä»˜å®Œ</p><p>è€ƒè™‘æ²¡ä»˜å®Œçš„è´·æ¬¾ï¼Œb å¤§çš„é åä¹°æ›´ä¼˜ï¼Œæ‰€ä»¥å¯ä»¥å…ˆå°† b ä»å¤§åˆ°å°æ’åº</p><p>f[i, j] è¡¨ç¤ºåœ¨å‰ i ä¸ªä¸­é€‰ï¼Œj ä¸ªæ²¡ä»˜å®Œçš„ C æœ€å¤§å€¼</p><h2 id="CF687C"><a href="#CF687C" class="headerlink" title="CF687C"></a><a href="https://www.luogu.com.cn/problem/CF687C" target="_blank" rel="noopener">CF687C</a></h2><hr><p>é—®èƒ½æ‹¼å‡ºå“ªäº›ï¼Œå°±æƒ³åˆ°äº† bitsetï¼šf[i, j] è¡¨ç¤ºå‰ i ä¸ªå…± j å…ƒèƒ½æ‹¼å‡ºçš„é›†åˆï¼Œf[i, j] = f[i - 1, j] | f[i - 1, j - c[i]] | (f[i - 1, j - c[i]] &lt;&lt; c[i])</p><h2 id="LightOJ1422"><a href="#LightOJ1422" class="headerlink" title="LightOJ1422"></a><a href="https://vjudge.net/problem/LightOJ-1422" target="_blank" rel="noopener">LightOJ1422</a></h2><hr><p>åŒºé—´ dpï¼Œf[l, r] = min(f[l + 1, r] + 1, (f[l + 1, i - 1] + 1) + (f[i, r] - 1)(å…¶ä¸­ c[l] = c[i]))</p><p>å°ç»†èŠ‚æ˜¯ f[i, r] - 1ï¼Œç”±äº i å¯èƒ½å¯¹ [i + 1, r] åŒé¢œè‰²çš„è¡£æœæœ‰å½±å“ï¼Œæ‰€ä»¥ä¸æ˜¯ f[i + 1, r]; ä½†è¦å‡å»é‡å¤ä¹°çš„é’±ã€‚</p><h2 id="CF840C"><a href="#CF840C" class="headerlink" title="CF840C"></a><a href="https://www.luogu.com.cn/problem/CF840C" target="_blank" rel="noopener">CF840C</a></h2><hr><p><a href="https://blog.csdn.net/can919/article/details/80154917" target="_blank" rel="noopener">å¥½çš„é¢˜è§£</a></p><p>å°†ç›¸ä¹˜ä¸ºå®Œå…¨å¹³æ–¹æ•°çš„æ•°æ”¾åœ¨åŒä¸€ç»„é‡Œï¼Œé—®é¢˜è½¬åŒ–æˆäº†ç»å…¸é—®é¢˜ï¼šæœ‰å¤šå°‘ä¸ªæ’åˆ—ä½¿å¾—ç›¸é‚»ä¸¤æ•°ä¸åœ¨åŒä¸€ç»„é‡Œã€‚</p><p>å®¹æ–¥ + dpï¼Œans = (è‡³å°‘ 0 ç›¸é‚»ç›¸åŒçš„æ–¹æ¡ˆæ•°) - (è‡³å°‘ 1 ç›¸é‚»ç›¸åŒçš„æ–¹æ¡ˆæ•°) + (è‡³å°‘ 2 ç›¸é‚»ç›¸åŒçš„æ–¹æ¡ˆæ•°) â€¦</p><p>dp[i, j] è¡¨ç¤ºå‰ i ç§æ•°åˆ†ä¸º j å—çš„æ–¹æ¡ˆæ•°ï¼ˆæ— åºï¼‰ï¼Œç›¸åŒå—ä¸­çš„æ•°ç›¸åŒã€‚å³è‡³å¤š j - 1 ä¸ç›¸åŒï¼Œå³è‡³å°‘ (n - 1) - (j - 1) = n - j ç›¸åŒã€‚</p><p>$dp[i, k] = \sum{ dp[i - 1, k - j] \times C(ni - 1, j - 1) \times \frac{n_i!}{j!} }$</p><p>é™¤ä»¥ j! è¡¨ç¤ºä½¿å—æ— åºï¼Œä¹˜ä»¥ n_i! è¡¨ç¤ºæ€»æ’åˆ—æ•°ï¼ˆè¿·æƒ‘ï¼‰</p><hr><p>updï¼š<a href="https://blog.csdn.net/qq_31759205/article/details/77487920" target="_blank" rel="noopener">å¦ä¸€å¥½çš„é¢˜è§£</a></p><p>è¿˜æ˜¯è¿™ä¸ªå¥½æ‡‚ä¸”æ­£å¸¸ğŸ‘</p><p>è½¬ç§»çš„æ—¶å€™æšä¸¾æŠŠå½“å‰é›†åˆåˆ†æˆå¤šå°‘æ®µï¼Œæœ‰å¤šå°‘æ®µæ’åœ¨ä¹‹å‰ç›¸åŒçš„ç›¸é‚»å…ƒç´ é—´</p><p>æ³¨æ„ç”±äº size ä¹‹å’Œæ˜¯ nï¼Œå¤æ‚åº¦ä¸æ˜¯ O(n^4) æ˜¯ O(n^3)</p><h2 id="CF15E"><a href="#CF15E" class="headerlink" title="CF15E"></a><a href="https://www.luogu.com.cn/problem/CF15E" target="_blank" rel="noopener">CF15E</a></h2><hr><p><a href="https://www.cnblogs.com/yyf0309/p/8418287.html" target="_blank" rel="noopener">é¢˜è§£é¢˜++ qwq</a></p><p>æ‰¾è§„å¾‹å®¹æ˜“å‘ç°ï¼šè·¯çº¿æ˜¯ä» H ä¸€ç›´æ²¿ç€è¾¹æ²¿æ–œçº¿èµ°ï¼Œæ‹ä¸€åœˆèµ°åˆ° H æ­£ä¸‹æ–¹ç¬¬ä¸€ä¸ªç‚¹å†æ‹ä¸€åœˆèµ°åˆ°å¦ä¸€æ–œçº¿ï¼Œèµ°å› Hã€‚</p><p>ä½†åé¢å°±ä¸çŸ¥é“æ€ä¹ˆåšäº†qaqï¼Ÿçœ‹å¤§ä½¬åšå®¢å§ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> CF&amp;ATå¾€å±Š </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XJOI200731 é¢˜è§£</title>
      <link href="2020/07/31/XJOI200731%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/07/31/XJOI200731%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><hr><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">æˆ‘ä»¿ä½›æ™ºéšœäº†= =</span></span><br><span class="line"><span class="comment">è¿™ä¸€çœ‹å°±å¾ˆå¯ä»¥é€’æ¨çš„æ ·å­å•Šï¼Œæ•°ä½ dp çœŸçš„ä¸æ˜¯å¾ˆéš¾ï¼Œæ˜¯æˆ‘æ•°ä½ dp å¤ªå¼±äº†</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>, N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line">ll T, K, l, r, f[<span class="number">2</span>][<span class="number">3</span>][<span class="number">65</span>], bit2[<span class="number">65</span>];</span><br><span class="line"><span class="comment">// f[0, ,] æ˜¯å·²ç»æœ‰ä¸€ä½å–å°ã€åé¢å°±æ²¡æœ‰é™åˆ¶çš„æ–¹æ¡ˆæ•°</span></span><br><span class="line"><span class="comment">// f[1, ,] æ˜¯å—/ä¸å—åˆ°æ•°ä½é™åˆ¶çš„æ€»æ–¹æ¡ˆæ•°</span></span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">sub</span><span class="params">(ll a, ll b)</span> </span>&#123; <span class="keyword">return</span> (a - b + mod) % mod; &#125;</span><br><span class="line"><span class="function">ll <span class="title">add</span><span class="params">(ll a, ll b)</span> </span>&#123; <span class="keyword">return</span> (a + b + mod) % mod; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    bit2[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        bit2[i] = bit2[i - <span class="number">1</span>] * <span class="number">2</span> % mod;</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">3</span>;  <span class="comment">// è¿™é‡Œçš„ 0 æ˜¯ (1 &lt;&lt; 0)ï¼Œä¹Ÿå°±æ˜¯ 1ï¼1 æœ‰ 3 ç§æ–¹æ¡ˆï¼ï¼ï¼</span></span><br><span class="line">    f[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">2</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        f[<span class="number">0</span>][<span class="number">0</span>][i] = (f[<span class="number">0</span>][<span class="number">0</span>][i - <span class="number">1</span>] + <span class="number">2</span> * f[<span class="number">0</span>][<span class="number">0</span>][i - <span class="number">1</span>]) % mod;</span><br><span class="line">        f[<span class="number">0</span>][<span class="number">1</span>][i] = (f[<span class="number">0</span>][<span class="number">1</span>][i - <span class="number">1</span>] + <span class="number">2</span> * f[<span class="number">0</span>][<span class="number">1</span>][i - <span class="number">1</span>] % mod + bit2[i] * f[<span class="number">0</span>][<span class="number">0</span>][i - <span class="number">1</span>] % mod) % mod;</span><br><span class="line">        f[<span class="number">0</span>][<span class="number">2</span>][i] = (f[<span class="number">0</span>][<span class="number">2</span>][i - <span class="number">1</span>] + <span class="number">2</span> * f[<span class="number">0</span>][<span class="number">2</span>][i - <span class="number">1</span>] % mod + <span class="number">2</span> * f[<span class="number">0</span>][<span class="number">1</span>][i - <span class="number">1</span>] % mod * bit2[i] % mod + bit2[i] * bit2[i] % mod * f[<span class="number">0</span>][<span class="number">0</span>][i - <span class="number">1</span>] % mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">calc</span><span class="params">(ll n, <span class="keyword">int</span> K)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!n) <span class="keyword">return</span> <span class="number">0</span>;  <span class="comment">// !!!</span></span><br><span class="line">    ll cnt = <span class="number">0</span>, x = n;</span><br><span class="line">    <span class="keyword">while</span> (x) x &gt;&gt;= <span class="number">1</span>, ++cnt;</span><br><span class="line">    f[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>] = (n &amp; <span class="number">1</span>) ? <span class="number">3</span> : <span class="number">1</span>;</span><br><span class="line">    f[<span class="number">1</span>][<span class="number">1</span>][<span class="number">0</span>] = (n &amp; <span class="number">1</span>) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">    f[<span class="number">1</span>][<span class="number">2</span>][<span class="number">0</span>] = (n &amp; <span class="number">1</span>) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, cnt) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((n &gt;&gt; i) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">            f[<span class="number">1</span>][<span class="number">0</span>][i] = (f[<span class="number">0</span>][<span class="number">0</span>][i - <span class="number">1</span>] + <span class="number">2</span> * f[<span class="number">1</span>][<span class="number">0</span>][i - <span class="number">1</span>] % mod) % mod;</span><br><span class="line">            f[<span class="number">1</span>][<span class="number">1</span>][i] = (f[<span class="number">0</span>][<span class="number">1</span>][i - <span class="number">1</span>] + <span class="number">2</span> * f[<span class="number">1</span>][<span class="number">1</span>][i - <span class="number">1</span>] % mod + bit2[i] * f[<span class="number">1</span>][<span class="number">0</span>][i - <span class="number">1</span>] % mod) % mod;</span><br><span class="line">            f[<span class="number">1</span>][<span class="number">2</span>][i] = (f[<span class="number">0</span>][<span class="number">2</span>][i - <span class="number">1</span>] + <span class="number">2</span> * f[<span class="number">1</span>][<span class="number">2</span>][i - <span class="number">1</span>] % mod + <span class="number">2</span> * f[<span class="number">1</span>][<span class="number">1</span>][i - <span class="number">1</span>] % mod * bit2[i] % mod + bit2[i] * bit2[i] % mod * f[<span class="number">1</span>][<span class="number">0</span>][i - <span class="number">1</span>] % mod) % mod;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            rep(j, <span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">                f[<span class="number">1</span>][j][i] = f[<span class="number">1</span>][j][i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[<span class="number">1</span>][K][cnt];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T &gt;&gt; K;</span><br><span class="line">    init(<span class="number">60</span>);</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;l, &amp;r);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, sub(calc(r, K), calc(l - <span class="number">1</span>, K)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><hr><p>è€ƒè™‘è´ªå¿ƒï¼Œä¸æ–­åˆå¹¶å¹³å‡å€¼æœ€å¤§çš„å—å’Œå®ƒçš„çˆ¶äº²æ‰€åœ¨è¿é€šå—ã€‚</p><p>è¯æ˜çš„è¯ï¼Œsum1 * num2 &lt; sum2 * num1, sum1 / num1 &lt; sum2 / num2ï¼ŒæŒ‰å¹³å‡å€¼ä»å¤§åˆ°å°æ’åºï¼Œå †ç»´æŠ¤ã€‚</p><p>è¿›é˜¶ç‰ˆçš„ poj-2054ï¼Œå¾ˆåƒ AGC023f-01 on treeï¼Œç»å…¸è´ªå¿ƒäº†ã€‚</p><p><strong>æ³¨æ„ï¼ï¼ï¼æˆ‘è‡ªå·±å†™çš„æ—¶å€™ç”¨äº†priority_queueï¼Œä½†å¯¹ sum å’Œ num çš„æ“ä½œå´æ˜¯åœ¨å¤–é¢åšçš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹pqæ²¡æœ‰ä¿®æ”¹ï¼è€Œä¸”è¿™æ ·è¿˜ç ´åäº†pqçš„ç»“æ„ï¼ï¼ï¼æœ€å WA æˆäº† 15ptsï¼ï¼ï¼ç—›å¿ƒ</strong> </p><p><strong>æ­£ç¡®çš„åšæ³•æ˜¯æ¯æ¬¡å°† fa ä»å †é‡Œå¼¹å‡ºæ¥ï¼Œå¯¹ fa çš„æ“ä½œåšå®Œåå† push ä¸€ä¸ªæ–°çš„ fa è¿›å»ã€‚ä¸ºäº†æ–¹ä¾¿æ‰§è¡Œâ€œå¼¹å‡ºæ“ä½œâ€ï¼Œæˆ‘ä»¬ç”¨ set ç»´æŠ¤ä¼˜å…ˆé˜Ÿåˆ—ã€‚</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line">ll n, rt, c[N], fa[N], num[N], sum[N], ans, fat[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nxt[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node &amp;a) <span class="keyword">const</span> &#123;</span><br><span class="line">        ll t2 = sum[id] * num[a.id], t1 = sum[a.id] * num[id];</span><br><span class="line">        <span class="keyword">return</span> t1 &lt; t2 || (t1 == t2 &amp;&amp; id &gt; a.id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">set</span>&lt;node&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> f)</span> </span>&#123;</span><br><span class="line">    fat[x] = f;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nxt[x].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = nxt[x][i];</span><br><span class="line">        <span class="keyword">if</span> (y == f) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(y, x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fa[x] == x ? x : fa[x] = getfa(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; rt;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;sum[i]);</span><br><span class="line">        num[i] = <span class="number">1</span>;</span><br><span class="line">        fa[i] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        nxt[x].push_back(y), nxt[y].push_back(x);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(rt, rt);</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> (i != rt) q.insert((node)&#123;i&#125;);</span><br><span class="line">    <span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.begin()-&gt;id;</span><br><span class="line">        q.erase(q.begin());</span><br><span class="line">        <span class="keyword">int</span> f = getfa(fat[x]);</span><br><span class="line">        q.erase((node)&#123;f&#125;);</span><br><span class="line">        ans += sum[x] * num[f];</span><br><span class="line">        sum[f] += sum[x], num[f] += num[x];</span><br><span class="line">        fa[x] = f;</span><br><span class="line">        <span class="keyword">if</span> (f != rt) q.insert((node)&#123;f&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans + sum[rt]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¨¡æ‹Ÿèµ› </tag>
            
            <tag> æ•°ä½dp </tag>
            
            <tag> è´ªå¿ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ä¹ é¢˜é€‰è®²ã€‘zzdã€ŠFFTå…¥é—¨ã€‹</title>
      <link href="2020/07/30/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91zzd%E3%80%8AFFT%E5%85%A5%E9%97%A8%E3%80%8B/"/>
      <url>2020/07/30/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91zzd%E3%80%8AFFT%E5%85%A5%E9%97%A8%E3%80%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="å¥—è·¯1-å­—ç¬¦ä¸²åŒ¹é…"><a href="#å¥—è·¯1-å­—ç¬¦ä¸²åŒ¹é…" class="headerlink" title="å¥—è·¯1. å­—ç¬¦ä¸²åŒ¹é…"></a><strong>å¥—è·¯1. å­—ç¬¦ä¸²åŒ¹é…</strong></h1><hr><p>æˆ‘ä»¬å‘ç°åŒ¹é…çš„å­—ç¬¦å¯¹<strong>ä¸‹æ ‡ä¹‹å·®æ˜¯å®šå€¼</strong>ï¼Œç¿»è½¬å…¶ä¸­ä¸€ä¸ªä¸²ä»¥åå°±å˜æˆäº†ï¼ŒåŒ¹é…çš„å­—ç¬¦å¯¹<strong>ä¸‹æ ‡ä¹‹å’Œæ˜¯å®šå€¼</strong>ï¼Œè¿™æ˜¯æ»¡è¶³å·ç§¯å½¢å¼çš„ã€‚ï¼ˆå¥½å¦™å•ŠQAQï¼Œå·ç§¯å½¢å¼çœŸçš„ä¸‡èƒ½</p><h2 id="BZOJ4503"><a href="#BZOJ4503" class="headerlink" title="${[BZOJ4503]}$"></a>${[BZOJ4503]}$</h2><p>ä¸èƒ½ç›´æ¥ kmp å•Šï¼Œé€šé…ç¬¦çš„ fail æŒ‡é’ˆä¸å¥½å®šã€‚è€ƒè™‘å·ç§¯ã€‚</p><p>æˆ‘ä»¬å¸Œæœ›é€šè¿‡æŸä¸€ä½æ˜¯å¦ä¸º 0 æ¥åˆ¤æ–­èƒ½å¦åœ¨æŸä½åŒ¹é…ä¸Šã€‚å¯ä»¥è®©ç›¸åŒå­—ç¬¦å·®ä¸º 0ï¼Œåšä¸€ä¸ªå¹³æ–¹å°±ä¸ä¼šæœ‰â€œæ­£ + è´Ÿ = é›¶â€çš„æƒ…å†µå‘ç”Ÿã€‚</p><p>ä½†é€šé…ç¬¦æ€ä¹ˆæï¼Ÿå®ƒå¯ä»¥ä¸ä»»ä½•å­—ç¬¦é…å•Šã€‚æˆ‘ä»¬å¸Œæœ›æœ‰é€šé…ç¬¦å­˜åœ¨ å°±æ˜¯ 0ï¼Œé‚£ä¹ˆé€šé…ç¬¦å€¼ = 0ï¼Œä¹˜åˆ°æŸ¿å­é‡Œå»å°±å¥½äº†ã€‚</p><h3 id="sum-limits-i-1-n-sum-limits-j-1-m-S-i-T-j-2-S-i-T-j"><a href="#sum-limits-i-1-n-sum-limits-j-1-m-S-i-T-j-2-S-i-T-j" class="headerlink" title="$$\sum\limits_{i = 1}^n\sum\limits_{j = 1}^ m (S_i - T_j)^2 S_i T_j$$"></a>$$\sum\limits_{i = 1}^n\sum\limits_{j = 1}^ m (S_i - T_j)^2 S_i T_j$$</h3><p>è¿™ä¸ªä¸œè¥¿æ‹†å¼€æ¥ï¼Œåšä¸‰æ¬¡ FFTã€‚</p><h2 id="CF528D"><a href="#CF528D" class="headerlink" title="${[CF528D]}$"></a>${[CF528D]}$</h2><p>æŒ‰ç…§ä¸Šä¸€é¢˜çš„å¥—è·¯ï¼Œæˆ‘ä»¬è®¾ $f[i, c]$ è¡¨ç¤º $[A çš„ä½ç½® i åŒ¹é…å­—ç¬¦ c]$ï¼Œ$g[i, c]$ è¡¨ç¤º $[B çš„ä½ç½® i == c]$ã€‚ç›¸å‡ä¹‹ååšå¹³æ–¹ï¼Œè¿™ä¸ªä¸œè¥¿å±•å¼€å¤ªå›°éš¾äº†ï¼Œè€Œä¸”è¦åšå¾ˆå¤šæ¬¡ FFTï¼Œå¸¸æ•°çˆ†ç‚¸ï¼Œè€ƒè™‘åˆ«çš„æ–¹æ³•ã€‚</p><p>æ˜¾ç„¶ $f[i, c]$ å’Œ $g[i, c]$ åªæ˜¯ 0/1ï¼Œè‹¥ $A[i]$ èƒ½åŒ¹é…ä¸Š $B[j]$ï¼Œé‚£ä¹ˆå­˜åœ¨ä¸€ä¸ª $c$ï¼Œ$f[i, c] \times g[j, c] = 1$ã€‚</p><p>å‘ç°å­—ç¬¦é›†å¾ˆå°ï¼Œæˆ‘ä»¬åˆ†åˆ«å¯¹æ¯ç§å­—ç¬¦åšä¸€æ¬¡å·ç§¯ï¼Œè‹¥ä½ç½® i çš„å››ç§å€¼ä¹‹å’Œ == $|B|$ åˆ™ä½ç½® $i - |B| + 1$ å¯ä»¥åŒ¹é…ã€‚å¤æ‚åº¦$O(4nlogn)$.</p><h1 id="å¥—è·¯2-å·ç§¯å½¢å¼å˜å½¢"><a href="#å¥—è·¯2-å·ç§¯å½¢å¼å˜å½¢" class="headerlink" title="å¥—è·¯2. å·ç§¯å½¢å¼å˜å½¢"></a><strong>å¥—è·¯2. å·ç§¯å½¢å¼å˜å½¢</strong></h1><hr><p>å¸¸ç”¨æŠ€å·§æ˜¯ç¿»è½¬å’Œæ›´æ¢æ±‚å’ŒæŒ‡æ ‡ã€‚</p><h2 id="ZJOI2014-åŠ›"><a href="#ZJOI2014-åŠ›" class="headerlink" title="${[ZJOI2014]-åŠ›}$"></a>${[ZJOI2014]-åŠ›}$</h2><p>è‡ªå·±è¿˜æ¨äº†ä¸€éƒ¨åˆ†ï¼Œhh</p><p>è®¾ $F(i) = \frac{1}{i^2}$ï¼Œ$G(i) = q_i$ï¼Œä¸€äº›ä¸åˆæ³•çš„ä¸‹æ ‡ï¼Œå€¼ä¸º 0.</p><p>$$E(i) = (\sum\limits_{j = 0}^iF(j) \times G(i - j)) - (\sum\limits_{j = i}^m F(j - i) \times G(j))$$</p><p>ç¬¬ä¸€ä¸ªæ‹¬å·é‡Œæ˜¯è£¸çš„å·ç§¯å½¢å¼ï¼Œç¬¬äºŒä¸ªæ‹¬å·è¦å†åšä¸€åšã€‚</p><p>æ›´æ¢æ±‚å’ŒæŒ‡æ ‡ï¼š</p><p>$$\sum\limits_{j = 0}^{m - i} F(j) \times G(j + i)$$</p><p>ç¿»è½¬ï¼šï¼ˆå…¶ä¸­ $G^r(i)$ è¡¨ç¤º $G(m - i)$ï¼‰</p><p>$$\sum\limits_{j = 0}^{m - i} F(j) \times G^r(m - i - j)$$</p><h1 id="å¥—è·¯3-èƒŒåŒ…é—®é¢˜ç›¸å…³"><a href="#å¥—è·¯3-èƒŒåŒ…é—®é¢˜ç›¸å…³" class="headerlink" title="å¥—è·¯3. èƒŒåŒ…é—®é¢˜ç›¸å…³"></a><strong>å¥—è·¯3. èƒŒåŒ…é—®é¢˜ç›¸å…³</strong></h1><hr><h2 id="CF286E-Ladiesâ€™-Shop"><a href="#CF286E-Ladiesâ€™-Shop" class="headerlink" title="${[CF286E]-Ladiesâ€™\ Shop}$"></a>${[CF286E]-Ladiesâ€™\ Shop}$</h2><p>æ¯”è¾ƒè‡ªç„¶çš„æƒ³æ³•ï¼Œf[a[i]] = 1ï¼Œf[0] = 1ï¼Œf ä¸è‡ªå·±åšå·ç§¯ï¼Œåšæœ€å¤š m æ¬¡å°±å¾—åˆ°äº†æ‰€æœ‰èƒ½è¡¨ç¤ºçš„æ•°ã€‚ä½†è¿™æ ·æ˜¯ O(m log^2 m)çš„ã€‚</p><p>ä½†å…¶å®å¹¶ä¸ç”¨åš m æ¬¡ã€‚å®é™…ä¸Šä¸€æ¬¡å·ç§¯å°±èƒ½å¾—å‡ºç­”æ¡ˆã€‚</p><p>ä¸€æ¬¡å·ç§¯åï¼Œé‚£äº› f[i] &gt; 2 çš„ i å°±æ˜¯å¯ä»¥çœç•¥çš„ã€‚ä¸ºä»€ä¹ˆï¼Ÿåˆå§‹ä¸€æ¬¡ï¼Œf[i] ä¸ f[0] ç›¸ä¹˜ä¸€æ¬¡ï¼Œè¿˜æœ‰å…¶ä»–èƒ½ç»„æˆ i çš„æ•°å­—çš„è´¡çŒ®â€¦ åè¿‡æ¥è¯´ï¼Œf[i] = 2 çš„ i å°±æ˜¯å¿…é€‰çš„ã€‚</p><h1 id="å¥—è·¯4-åˆ†æ²»FFT"><a href="#å¥—è·¯4-åˆ†æ²»FFT" class="headerlink" title="å¥—è·¯4. åˆ†æ²»FFT"></a><strong>å¥—è·¯4. åˆ†æ²»FFT</strong></h1><hr><p>ï¼ˆå¥½éš¾å•Š QAQ æˆ‘æ²¡æœ‰è„‘å­ï¼‰</p><h2 id="Lydsy1704æœˆèµ›-äºŒå…ƒè¿ç®—"><a href="#Lydsy1704æœˆèµ›-äºŒå…ƒè¿ç®—" class="headerlink" title="${[Lydsy1704æœˆèµ›]-äºŒå…ƒè¿ç®—}$"></a>${[Lydsy1704æœˆèµ›]-äºŒå…ƒè¿ç®—}$</h2><p>å…ˆä¸è€ƒè™‘æ‹¬å·é‡Œçš„é™åˆ¶ã€‚åŠ æ³•å¯ä»¥ç›´æ¥ç®—ï¼Œå‡æ³•è¦å˜ä¸€ä¸‹ï¼š</p><p>$$ans_k = \sum\limits_{i = k}^n a_i \times b_{i - k}$$</p><p>$$ans_k = \sum\limits_{i = 0}^{n - k} a_{i + k} \times b_i$$</p><p>ç¿»è½¬ï¼Œå†å°† ans ä¸‹æ ‡åŠ  nï¼Œå‡‘ä¸€ä¸ªå·ç§¯å½¢å¼ï¼š</p><p>$$ans_{n + k} = \sum\limits_{i = 0}^{n - k}a_{i + k} \times b_{n - i}^r$$</p><p>è€ƒè™‘æ‹¬å·é‡Œçš„é™åˆ¶ï¼Œå®¹æ˜“å‘ç°åœ¨å€¼åŸŸä¸Šï¼Œå·¦åŒºé—´å¯¹å³åŒºé—´ä¸€å®šæœ‰è´¡çŒ®ï¼Œäºæ˜¯æƒ³åˆ°<strong>åˆ†æ²»å€¼åŸŸ</strong>ã€‚å…·ä½“æ¥è¯´ï¼Œå¯¹äºæ¯ä¸ªæ•°å€¼åŒºé—´ [l, r]ï¼š</p><ul><li>$x = y$: è´¡çŒ®ç»™ $0$</li><li>$x &lt; y$: $a[l, mid]$ å· $b[mid + 1, r]$</li><li>$x &gt; y$: $a[mid + 1, r]$ å· $b[l, mid]$</li></ul><p>ï¼ˆæˆ‘ä»Šå¤©æ‰çŸ¥é“åœ¨é€’å½’è¿‡ç¨‹ä¸­è®¡ç®—ä¸€ä¸ªå­é—®é¢˜å¯¹å¦ä¸€ä¸ªå­é—®é¢˜çš„è´¡çŒ®çš„åˆ†æ²»å°±å« CDQ åˆ†æ²»ï¼Ÿï¼Ÿï¼Ÿï¼‰</p><h2 id="CF553E-Kyoya-and-Train"><a href="#CF553E-Kyoya-and-Train" class="headerlink" title="${[CF553E]-Kyoya\ and\ Train}$"></a>${[CF553E]-Kyoya\ and\ Train}$</h2><p>ä¹ä¸€çœ‹æ›´åƒæ˜¯ dp é¢˜ï¼Œäºæ˜¯è€ƒè™‘ dpï¼š$f[i, j]$ è¡¨ç¤ºåˆ° $i$ ä½ç½®è€—æ—¶ $j$ çš„æœ€å°æœŸæœ›ä»£ä»·ï¼Œ$f[x, t] = min{c(x, y) + f[y, t + k] \times P_{e, k}}$ï¼Œå…¶ä¸­ P è¡¨ç¤ºç»è¿‡ e è¾¹è€—æ—¶ k çš„æ¦‚ç‡ã€‚</p><p>æ³¨æ„åˆ°åé¢é‚£å¨ä¸œè¥¿å¯ä»¥ç¿»è½¬å˜æˆå·ç§¯å½¢å¼ï¼Œç„¶åè¿™ç©æ„å°±æ˜¯åˆ†æ²» FFT å•¦ï¼Œåˆ†æ²»æ—¶é—´ï¼Œå¯¹äº $[l, r]$ å…ˆåš $[mid, r]$ å†åš $[l, mid)$ã€‚å¤æ‚åº¦ $O(mTlog^2T)$.</p><h1 id="æ‚é¢˜"><a href="#æ‚é¢˜" class="headerlink" title="æ‚é¢˜"></a><strong>æ‚é¢˜</strong></h1><hr><h2 id="BZOJ3160-ä¸‡å¾„äººè¸ªç­"><a href="#BZOJ3160-ä¸‡å¾„äººè¸ªç­" class="headerlink" title="${[BZOJ3160]-ä¸‡å¾„äººè¸ªç­}$"></a>${[BZOJ3160]-ä¸‡å¾„äººè¸ªç­}$</h2><p>æˆ‘ä»¬å…ˆå¿½ç•¥æ¡ä»¶ 2ï¼Œæœ€åå‡å»æ¡ä»¶ 2 çš„å°±å¥½äº†ï¼ˆç”¨ manacher ç®—ï¼‰</p><p>æŒ‰ç…§æœ´ç´ çš„è§£æ³•ï¼Œå±•å¼€åšå¤šæ¬¡ FFT ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œç„¶è€Œè¿˜æœ‰æ›´ç®€ä¾¿çš„æ–¹æ³•ã€‚è€ƒè™‘<strong>åªæœ‰ a å’Œ b</strong>ï¼Œåˆ†å¼€æ¥åšå†åŒä¸€ä½ç½®çš„ç›¸ä¹˜ï¼Œæ­£ç¡®æ€§æ˜¾ç„¶ã€‚</p><h2 id="Cerc2015-Frightful-Formula"><a href="#Cerc2015-Frightful-Formula" class="headerlink" title="${[Cerc2015]-Frightful\ Formula}$"></a>${[Cerc2015]-Frightful\ Formula}$</h2><p>é¦–å…ˆå‡è£…å·²ç»çŸ¥é“è¿™æ˜¯ FFT é¢˜ï¼ç„¶åå¿«ä¹æ¨æŸ¿å­ã€‚æ˜¾ç„¶ç­”æ¡ˆåªåˆ†ä¸º $(i, 1)/(1, i)$ åˆå§‹å€¼çš„è´¡çŒ® å’Œ $(i, j)$ é¢å¤–åŠ ä¸Šçš„ $c$ çš„è´¡çŒ®ã€‚</p><p>$(i, 1)/(1, i)$:</p><p>$$\sum\limits_{i = 1}^n C(n - i + n - 1, n - i)\times  a^{n - i} b^{n - 1}$$</p><p>$(i, j)$:</p><p>$$\sum\limits_{i = 2}^n \sum\limits_{j = 2}^n C(n - i + n - j, n - i) \times a^{n - i} b^{n - j} c$$</p><p>è®¾ $A_i = \frac{a^{n - i}}{(n - i)!}$, $B_i = \frac{b^{n - i}}{(n - i)!}$:</p><p>$$c\sum\limits_{i = 2}^n \sum\limits_{j = 2}^n (2n - i - j)! \times A_iB_j$$</p><p>æšä¸¾ i + j:</p><p>$$c\sum\limits_{i = 4}^{2n} (2n - i)! \sum\limits_{j = 2}^{i - 2} A_jB_{i - j}$$</p><p>è¿™å°±æ˜¯å·ç§¯å½¢å¼äº†ã€‚</p><h2 id="Hnoi2017-ç¤¼ç‰©"><a href="#Hnoi2017-ç¤¼ç‰©" class="headerlink" title="${[Hnoi2017]-ç¤¼ç‰©}$"></a>${[Hnoi2017]-ç¤¼ç‰©}$</h2><p>æˆ‘ä»¬è®¾å¾—åˆ°åºåˆ—ä¸º a å’Œ bï¼Œè®¾ç»™ a æ¯ä¸€ä½åŠ  c</p><p>$$ans = \sum (a_i + c - b_i)^2$$</p><p>$$ans = \sum a_i^2 + \sum b_i^2 + n \times c^2 + 2c \times (\sum a_i - \sum b_i) - 2 \sum a_ib_i$$</p><p>å’Œ c æœ‰å…³çš„é¡¹å¯ä»¥æšä¸¾æˆ–ç”¨äºŒæ¬¡å‡½æ•°æ±‚æå€¼ï¼Œæœ€åä¸€é¡¹ç”¨å·ç§¯æ±‚ï¼Œè€ƒè™‘æ€ä¹ˆæï¼Œæ˜¾ç„¶å°† a ç¿»è½¬åå¤åˆ¶ä¸€ä»½å°±å¥½å•¦ã€‚</p><h2 id="CF958F3-Lightsabers-hard"><a href="#CF958F3-Lightsabers-hard" class="headerlink" title="${[CF958F3]-Lightsabers(hard)}$"></a>${[CF958F3]-Lightsabers(hard)}$</h2><p>æŠŠæ¯ç§é¢œè‰²èƒ½é€‰çš„ 01 ç”Ÿæˆå‡½æ•°ä¹˜èµ·æ¥ï¼Œæœ´ç´ åšæ³•ä¼š TLEï¼Œè€ƒè™‘<strong>å¯å‘å¼åˆå¹¶</strong>ï¼Œå † + vector ç»´æŠ¤ã€‚$O(nlog^2n)$</p><p>ï¼ˆåˆ†æ²»ä¹Ÿèƒ½åšï¼</p><h2 id="CF623E-Transforming-Sequence"><a href="#CF623E-Transforming-Sequence" class="headerlink" title="${[CF623E]-Transforming\ Sequence}$"></a>${[CF623E]-Transforming\ Sequence}$</h2><p>æ˜¾ç„¶ $n &gt; k$ çš„æ—¶å€™æ— è§£ã€‚</p><p>å®¹æ˜“å‘ç°è·Ÿæ•°å€¼å…·ä½“å¤§å°æ²¡æœ‰å…³ç³»ï¼Œå…³é”®æ˜¯æ¯æ¬¡éƒ½æœ‰<strong>æ–°çš„äºŒè¿›åˆ¶ä½è¢«å¡«ä¸Š</strong>ã€‚</p><p>å°æ•°æ®çš„è¯å¯ä»¥ dpï¼Œ$f[i, j]$ è¡¨ç¤ºå‰ $i$ ä¸ªæ•°æœ‰ $j$ ä¸ªäºŒè¿›åˆ¶ä½ä¸º $1$ï¼Œè½¬ç§» $f[i, j] = \sum\limits_{k = 0}^{j - 1} f[i - 1, k] \times 2^k \times C(j, k)$ï¼Œå…¶ä¸­ $2^k$ è¡¨ç¤ºåŸæ¥å·²æœ‰çš„å¯æ”¾å¯ä¸æ”¾ã€‚</p><p>è€ƒè™‘ä¼˜åŒ–ï¼š</p><p>$$\frac{f[i, j]}{j!} = \sum\limits_k \frac{f[i - 1, k] \times 2^k}{k!} \times \frac{1}{(j - k)!}$$</p><p>è¿™æ ·æ˜¯ $O(n^2 log n)$ çš„ï¼Œç„¶åæˆ‘å°±æƒ³ä¸å‡ºäº†ã€‚ã€‚ä½†è¿˜èƒ½ä¼˜åŒ–ï¼ï¼è€ƒè™‘åˆ°è¿™æ ·ä¸€æ¬¡ä¸€æ¬¡è½¬ç§»å¤ªæ…¢äº†ï¼Œæˆ‘ä»¬<strong>åŠ å¤§è½¬ç§»çš„æ­¥é•¿</strong>ï¼Œå€å¢ï¼Œåˆå¹¶æ¯æ®µçš„ dp å€¼ï¼Œç›¸å½“äº dp[n &amp; (2 ^ 0)] å· dp[n &amp; (2 ^ 1)] â€¦ å·dp[n &amp; (2 ^ æœ€é«˜ä½)]ï¼Œè¿™æ ·å°±èƒ½åœ¨ $O(k log^2 k)$ çš„æ—¶é—´å¤æ‚åº¦å†…æ±‚å‡ºäº†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> FFT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Jcvbã€Šç»„åˆè®¡æ•°é—®é¢˜ã€‹é¢˜è§£</title>
      <link href="2020/07/30/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91Jcvb%E3%80%8A%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0%E9%97%AE%E9%A2%98%E3%80%8B/"/>
      <url>2020/07/30/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91Jcvb%E3%80%8A%E7%BB%84%E5%90%88%E8%AE%A1%E6%95%B0%E9%97%AE%E9%A2%98%E3%80%8B/</url>
      
        <content type="html"><![CDATA[<ul><li>ç»„åˆæ•°ã€stirlingæ•°</li><li>ç”Ÿæˆå‡½æ•° + FFT/NTT</li><li>ä¸€äº›ç‰¹å®šçš„ç»“è®ºï¼ˆçŸ©é˜µæ ‘ï¼Œburnsideï¼Œpruferâ€¦ï¼‰</li><li>ä¸€äº›æ€æƒ³ï¼ˆå®¹æ–¥ã€è¡¥é›†è½¬åŒ–ï¼‰</li></ul><p>éƒ½æ˜¯å¸¸ç”¨çš„æŠ€å·§ï¼</p><p>DP æ¯é“éƒ½æ˜¯å§ qvq å¤ªé‡è¦äº†ï¼Œæœ‰æ—¶ç”¨ FFT/NTT åŠ é€Ÿã€‚</p><h2 id="TC12004-SetAndSet"><a href="#TC12004-SetAndSet" class="headerlink" title="$[TC12004]-SetAndSet$"></a><a href="https://vjudge.net/problem/Topcoder-12004" target="_blank" rel="noopener">$[TC12004]-SetAndSet$</a></h2><hr><p>æŒ‰ä½è€ƒè™‘ã€‚</p><p>è‹¥å¯¹äºæŸä¸€ä½ï¼Œå­˜åœ¨ä¸€ä¸ªæ•°å½“å‰ä½ä¸º 0ï¼Œåˆ™è¿™ä¸€ä½ä¸º 0 çš„æ•°ä¸èƒ½å…¨åœ¨ä¸€è¾¹ã€‚</p><p>ä¸èƒ½å…¨åœ¨ä¸€è¾¹ å°±å¾ˆéš¾åšï¼Œè€ƒè™‘<strong>è¡¥é›†è½¬åŒ–</strong>ï¼Œè®¡ç®— å…¨åœ¨ä¸€è¾¹ çš„ã€‚æˆ‘ä»¬å‘ç°è¿™æ ·ä¼šç®—é‡ï¼Œå‡†ç¡®æ¥è¯´ç®—çš„æ˜¯â€œè‡³å°‘æœ‰å‡ ä½ä¸åŒâ€ã€‚</p><p>è€ƒè™‘<strong>å®¹æ–¥æ€æƒ³</strong>ï¼Œç­”æ¡ˆ = æ€»æ•° - è‡³å°‘ 1 ä½ä¸åŒ + è‡³å°‘ 2 ä½ä¸åŒ - â€¦</p><p>ç”¨ dfs æšä¸¾ï¼Œå¹¶æŸ¥é›†ç»´æŠ¤å³å¯ï¼Œå°†æšä¸¾ä½ä¸º 0 çš„å¹¶åˆ°ä¸€å—å„¿å»ã€‚</p><h2 id="BZOJ1471-ä¸ç›¸äº¤è·¯å¾„"><a href="#BZOJ1471-ä¸ç›¸äº¤è·¯å¾„" class="headerlink" title="$[BZOJ1471]-ä¸ç›¸äº¤è·¯å¾„$"></a>$[BZOJ1471]-ä¸ç›¸äº¤è·¯å¾„$</h2><hr><p>ä¸ç›¸äº¤éš¾åšï¼Œç›¸äº¤å¥½åšã€‚è€ƒè™‘<strong>å®¹æ–¥</strong>ç¬¬ä¸€ä¸ªç›¸äº¤çš„ç‚¹ã€‚è®¡ç®—æ€»æ–¹æ¡ˆæ•°çš„æ—¶å€™ç”¨åˆ°äº†æ‹“æ‰‘åºï¼ˆè·¯å¾„ä¸Šæ’åœ¨ x å‰é¢çš„ç‚¹ yï¼Œæ‹“æ‰‘åºä¸€å®šæ¯” x å°ï¼‰</p><h2 id="SHOI2009-èˆä¼š"><a href="#SHOI2009-èˆä¼š" class="headerlink" title="$[SHOI2009]-èˆä¼š$"></a>$[SHOI2009]-èˆä¼š$</h2><hr><p>å°±æ˜¯é‚£é“-å·²ç»æ²¡æœ‰ä»€ä¹ˆå¥½å®³æ€•çš„äº†ï¼Œdp è®¡ç®— g æ•°ç»„ï¼Œf[i, j] è¡¨ç¤ºå‰ i ä¸ªå¥³ç”Ÿæœ‰ j ä¸ªåŒ¹é…äº†ã€‚</p><h2 id="æŸCEOIé¢˜"><a href="#æŸCEOIé¢˜" class="headerlink" title="$[æŸCEOIé¢˜]$"></a>$[æŸCEOIé¢˜]$</h2><hr><p>ä»€ä¹ˆå®¹æ–¥å°äºå·æ”¹ä¸ºå¤§äºå·çš„ï¼Œå’•å’•</p><h2 id="TC14170-Divfree"><a href="#TC14170-Divfree" class="headerlink" title="$[TC14170]-Divfree$"></a>$[TC14170]-Divfree$</h2><hr><p>æƒ³ä¸åˆ°çš„å®¹æ–¥dpã€‚ã€‚</p><p>ä¸åˆæ³•çš„çŠ¶æ€ (A, B) æ˜¯ B æ˜¯ A çš„çœŸçº¦æ•°æ—¶ã€‚æ•°å­— k çš„çœŸçº¦æ•°åªæœ‰ log(k) ä¸ªï¼Œk æ˜¯ 50000ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸åˆæ³•çš„é“¾çš„é•¿åº¦æœ€å¤š 16ã€‚</p><p>è€ƒè™‘å®¹æ–¥ï¼Œf[i] è¡¨ç¤º<strong>åˆæ³•çš„</strong>é•¿åº¦ä¸º i çš„é“¾æ–¹æ¡ˆæ•°ï¼Œg[i] è¡¨ç¤º<strong>ä¸åˆæ³•çš„</strong>é•¿åº¦ä¸º i çš„é“¾æ–¹æ¡ˆæ•°ã€‚g å¯ä»¥é¢„å¤„ç†ã€‚</p><p>$f[n] = f[n - 1] * g[1] - f[n - 2] * g[2] + f[n - 3] * g[3]â€¦$ å¤ªå¦™äº†ã€‚</p><h2 id="ç¨³å®šå¤šç±³è¯ºè¦†ç›–"><a href="#ç¨³å®šå¤šç±³è¯ºè¦†ç›–" class="headerlink" title="$[ç¨³å®šå¤šç±³è¯ºè¦†ç›–]$"></a>$[ç¨³å®šå¤šç±³è¯ºè¦†ç›–]$</h2><hr><p><a href="https://imilyx.github.io/2020/07/30/[51nod1518]-%E7%A8%B3%E5%AE%9A%E5%A4%9A%E7%B1%B3%E8%AF%BA%E8%A6%86%E7%9B%96/" target="_blank" rel="noopener">é“¾æ¥</a></p><h2 id="TC13891-Gxor"><a href="#TC13891-Gxor" class="headerlink" title="$[TC13891]-Gxor$"></a>$[TC13891]-Gxor$</h2><hr><p>ä¸€é“æ–¯ç‰¹æ—æ•°ç›¸å…³çš„æ•°å­¦é¢˜</p><p>f[i] è¡¨ç¤ºè‡³å°‘ i ä¸ªè¿é€šå—ï¼Œg[i] è¡¨ç¤ºæ°å¥½ i ä¸ªè¿é€šå—ï¼Œæˆ‘ä»¬è¦æ±‚ g[1]</p><p>è€ƒè™‘ä¸€ä¸ªå®é™…è¿é€šå—æ•°é‡ä¸º p çš„å›¾ï¼Œå®ƒä¼šåœ¨æˆ‘ä»¬æšä¸¾ k ä¸ªè¿é€šå—çš„æ—¶å€™è¢«ç®— $S_2(p, k)$ æ¬¡</p><p>æœ‰ä¸ªæŸ¿å­ï¼š$\sum_i (-1)^{i - 1} S_2(n, i) * (i - 1)! = [n = 1]$</p><p><a href="https://blog.csdn.net/qq_35950004/article/details/106126524" target="_blank" rel="noopener">æ¯”è¾ƒæ¸…æ¥šçš„è¯æ˜</a></p><p>å¥½ç¥å¥‡å•Šï¼Œæ¶ˆåŒ–æ¶ˆåŒ–ã€‚ã€‚ã€‚</p><p>$g[1] = \sum\limits_{i = 1}^n f[i] * S_1(i, 1) * (-1)^{i - 1}$</p><p>f[k] å¾ˆéš¾ç®—çš„æ ·å­ï¼Œæ€ä¹ˆåŠï¼Ÿæ³¨æ„åˆ° n åªæœ‰ 9ï¼Œæš´æœï¼Œå¼ºåˆ¶å—ä¸å—ä¹‹é—´çš„è¾¹ä¸èƒ½è¿ï¼ˆè¿™ä¸ªé«˜æ–¯æ¶ˆå…ƒè§£å¼‚æˆ–æ–¹ç¨‹ç»„æ¥æï¼‰ã€‚C(17, 9) å·¦å³ï¼Œå—¯å¾ˆç¨³ï¼</p><p>ä»£ç æœ‰ä¸€äº›å°ç»†èŠ‚ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Gxor</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ll T, n, ans, len, tot;</span><br><span class="line">    ll fac[<span class="number">15</span>], a[N], b[N], col[N], lg[<span class="number">1</span> &lt;&lt; <span class="number">11</span>];</span><br><span class="line">    <span class="keyword">char</span> s[<span class="number">15</span>][N];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> d)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!x) &#123;</span><br><span class="line">            <span class="keyword">int</span> t = <span class="number">0</span>;</span><br><span class="line">            tot = <span class="number">0</span>;</span><br><span class="line">            rep(u, <span class="number">0</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">                rep(v, u + <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (col[u] != col[v]) a[tot++] = b[t];</span><br><span class="line">                    ++t;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            a[tot] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> cur = <span class="number">0</span>;</span><br><span class="line">            rep(i, <span class="number">0</span>, T - <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!((a[cur] &gt;&gt; i) &amp; <span class="number">1</span>)) &#123;</span><br><span class="line">                    rep(j, cur + <span class="number">1</span>, tot - <span class="number">1</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> ((a[j] &gt;&gt; i) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">                            swap(a[j], a[cur]); <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                rep(j, cur + <span class="number">1</span>, tot - <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> ((a[j] &gt;&gt; i) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">                        <span class="comment">// swap(a[j], a[cur]);</span></span><br><span class="line">                        a[j] ^= a[cur];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> ((a[cur] &gt;&gt; i) &amp; <span class="number">1</span>) ++cur;</span><br><span class="line">            &#125;</span><br><span class="line">            ans += fac[d] * (<span class="number">1l</span>l &lt;&lt; (T - cur));</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> t = x; t; t = (t - <span class="number">1</span>) &amp; x)</span><br><span class="line">            <span class="keyword">if</span> (t &amp; (x &amp; -x)) &#123;  <span class="comment">// åŒ…å« x çš„æœ«å°¾ 1 ä½ç½®ï¼Œè¿™æ ·ä¸ä¼šé‡å¤æšä¸¾</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> u = t; u; u = (u - <span class="number">1</span>) &amp; u)</span><br><span class="line">                    col[lg[u &amp; -u]] = lg[x &amp; -x];</span><br><span class="line">                dfs(x - t, d + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">ll <span class="title">countsubs</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; s)</span> </span>&#123;</span><br><span class="line">        T = s.size();</span><br><span class="line">        len = s[<span class="number">0</span>].length();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; ; i++) <span class="keyword">if</span> (i * (i - <span class="number">1</span>) / <span class="number">2</span> == len) &#123; n = i; <span class="keyword">break</span>; &#125;</span><br><span class="line">        rep(i, <span class="number">0</span>, T - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> t = <span class="number">0</span>;</span><br><span class="line">            rep(u, <span class="number">0</span>, n - <span class="number">1</span>)</span><br><span class="line">                rep(v, u + <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (s[i][t] == <span class="string">'1'</span>) b[t] |= (<span class="number">1l</span>l &lt;&lt; i);</span><br><span class="line">                    ++t;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        fac[<span class="number">0</span>] = fac[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        rep(i, <span class="number">0</span>, <span class="number">10</span>) lg[(<span class="number">1</span> &lt;&lt; i)] = i;</span><br><span class="line">        rep(i, <span class="number">2</span>, <span class="number">10</span>) fac[i] = fac[i - <span class="number">1</span>] * (i - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= <span class="number">10</span>; i += <span class="number">2</span>) fac[i] = -fac[i];</span><br><span class="line">        dfs((<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> è®¡æ•° </tag>
            
            <tag> å®¹æ–¥åŸç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[51nod1518]-ç¨³å®šå¤šç±³è¯ºè¦†ç›–</title>
      <link href="2020/07/30/%5B51nod1518%5D-%E7%A8%B3%E5%AE%9A%E5%A4%9A%E7%B1%B3%E8%AF%BA%E8%A6%86%E7%9B%96/"/>
      <url>2020/07/30/%5B51nod1518%5D-%E7%A8%B3%E5%AE%9A%E5%A4%9A%E7%B1%B3%E8%AF%BA%E8%A6%86%E7%9B%96/</url>
      
        <content type="html"><![CDATA[<p>æˆ‘ä»¬å‘ç°æ°å¥½ k æ¡çº¿ä¸è¢«è·¨è¿‡å¾ˆéš¾æï¼Œä½†æ˜¯è‡³å°‘ k æ¡çº¿ä¸è¢«è·¨è¿‡å°±å¯ä»¥ dpï¼Œæƒ³åˆ°å®¹æ–¥ï¼ˆäºŒé¡¹å¼åæ¼”ï¼‰ã€‚</p><p>åŒæ—¶æšä¸¾è¡Œå’Œåˆ—çš„å¤æ‚åº¦å¤ªé«˜ï¼Œä½†æ˜¯æšä¸¾ä¸€ç»´åï¼Œå¦ä¸€ç»´å°±å¯ä»¥ dp äº†ã€‚</p><p>æˆ‘ä»¬é€‰æ‹©æšä¸¾åˆ—ï¼Œè¡Œåš dpï¼š</p><ul><li>f[i, j] è¡¨ç¤º i è¡Œ j åˆ—æ°å¥½å¡«æ»¡çš„æ–¹æ¡ˆæ•°ï¼ˆæ’å¤´dpé¢„å¤„ç†ï¼‰ï¼Œ</li><li>g[k] è¡¨ç¤º<strong>è‡³å°‘</strong> k æ¡<strong>åˆ—çº¿</strong>ï¼Œ0 æ¡è¡Œçº¿çš„æ–¹æ¡ˆæ•°ï¼ˆ0 æ¡è¡Œçº¿ é€šè¿‡å®¹æ–¥å®ç°ï¼‰</li></ul><p><strong>æ³¨æ„ï¼šè¿™é‡Œæ’å¤´dp è½®å»“çº¿ å’Œå›è·¯è®¡æ•°çš„<a href="https://www.cnblogs.com/iiyiyi/p/5846864.html" target="_blank" rel="noopener">ä¸å¤ªä¸€æ ·</a></strong></p><p>ï¼ˆæ‰€ä»¥è¦å°±é¢˜è®ºé¢˜çš„è®¾è®¡è½®å»“çº¿å•Šï¼ï¼ï¼ï¼‰</p><p>é‡ç‚¹æ€»ç»“ï¼š1. æƒ³åˆ°å®¹æ–¥ 2. æƒ³åˆ°æšä¸¾ä¸€ç»´å dp å¦ä¸€ç»´</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line">ll dp[<span class="number">2</span>][<span class="number">1</span> &lt;&lt; <span class="number">16</span>], f[<span class="number">20</span>][<span class="number">20</span>], ans, g[<span class="number">20</span>], row[<span class="number">20</span>];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vec;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> lim)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="keyword">sizeof</span>(dp));</span><br><span class="line">    <span class="keyword">int</span> tot = (<span class="number">1</span> &lt;&lt; lim) - <span class="number">1</span>, p = <span class="number">1</span>;</span><br><span class="line">    dp[<span class="number">0</span>][tot] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">1</span>, lim) &#123;</span><br><span class="line">            <span class="built_in">memset</span>(dp[p], <span class="number">0</span>, <span class="keyword">sizeof</span>(dp[p]));</span><br><span class="line">            rep(s, <span class="number">0</span>, tot) &#123;</span><br><span class="line">                <span class="keyword">if</span> (!((s &gt;&gt; (lim - <span class="number">1</span>)) &amp; <span class="number">1</span>)) &#123;</span><br><span class="line">                    (dp[p][(s &lt;&lt; <span class="number">1</span> | <span class="number">1</span>) &amp; tot] += dp[p ^ <span class="number">1</span>][s]) %= mod;  <span class="comment">// ç«–æ”¾ä¸€å— </span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (!(s &amp; <span class="number">1</span>) &amp;&amp; j &gt; <span class="number">1</span>)</span><br><span class="line">                        (dp[p][(s &lt;&lt; <span class="number">1</span> | <span class="number">3</span>) &amp; tot] += dp[p ^ <span class="number">1</span>][s]) %= mod;  <span class="comment">// æ¨ªæ”¾ä¸€å—</span></span><br><span class="line">                    (dp[p][(s &lt;&lt; <span class="number">1</span>) &amp; tot] += dp[p ^ <span class="number">1</span>][s]) %= mod;  <span class="comment">// ä¸æ”¾</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            p ^= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        f[i][lim] = dp[p ^ <span class="number">1</span>][tot];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prework</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) calc(i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    n = m = <span class="number">16</span>;</span><br><span class="line">    prework();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m) &#123;</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        rep(s, <span class="number">1</span> &lt;&lt; (m - <span class="number">1</span>), (<span class="number">1</span> &lt;&lt; m) - <span class="number">1</span>) &#123;</span><br><span class="line">            vec.clear();</span><br><span class="line">            <span class="keyword">int</span> lst = <span class="number">0</span>;</span><br><span class="line">            rep(i, <span class="number">1</span>, m)</span><br><span class="line">                <span class="keyword">if</span> ((s &gt;&gt; (i - <span class="number">1</span>)) &amp; <span class="number">1</span>) vec.push_back(i - lst), lst = i;</span><br><span class="line">            rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">                row[i] = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; vec.size(); j++)</span><br><span class="line">                    (row[i] *= f[i][vec[j]]) %= mod;</span><br><span class="line">            &#125;</span><br><span class="line">            rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">                g[i] = row[i];</span><br><span class="line">                rep(j, <span class="number">1</span>, i - <span class="number">1</span>)</span><br><span class="line">                    (g[i] -= row[i - j] * g[j] % mod) %= mod;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> ((vec.size()) &amp; <span class="number">1</span>) (ans += g[n]) %= mod;</span><br><span class="line">            <span class="keyword">else</span> (ans -= g[n]) %= mod;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, (ans + mod) % mod);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å®¹æ–¥åŸç† </tag>
            
            <tag> æ’å¤´dp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XJOI200730 é¢˜è§£</title>
      <link href="2020/07/30/XJOI200730%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/07/30/XJOI200730%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><hr><p>æ±‚æœ€å°ç”Ÿæˆæ ‘è¾¹æƒæœŸæœ›ã€‚</p><p>â€œä¿è¯è·ç¦»å€¼ç›¸åŒçš„é“è·¯æ•°å°äº 30â€ï¼Œæ˜¾ç„¶å¯ä»¥ç”¨çŸ©é˜µæ ‘å®šç†ã€‚</p><p>æ ¹æ®æœŸæœ›çš„å¯åŠ æ€§ï¼Œæ•´æ£µæ ‘çš„æœŸæœ› = æ¯æ¡è¾¹çš„æœŸæœ› ä¹‹å’Œã€‚è€ƒè™‘æœ€å°ç”Ÿæˆæ ‘çš„æ€§è´¨ï¼ˆå…·ä½“å¯è§ JSOI2008-æœ€å°ç”Ÿæˆæ ‘è®¡æ•°ï¼‰ï¼Œæˆ‘ä»¬åˆ†åˆ«å¤„ç†ä¸åŒé•¿åº¦çš„è¾¹ã€‚è€Œæ¯æ¡è¾¹çš„æ¦‚ç‡æ˜¯ï¼šï¼ˆåŒ…å«è¿™æ¡è¾¹çš„ç”Ÿæˆæ ‘ä¸ªæ•°ï¼‰/ï¼ˆæ€»ç”Ÿæˆæ ‘ä¸ªæ•°ï¼‰ã€‚åˆ†å¼€åšå°±å¯ä»¥è¿‡äº†ï¼Œè™½ç„¶æ—¶é—´å¤æ‚åº¦æ˜¯ä¸å¯¹çš„ã€‚</p><p>ç„¶è€Œè¿˜æœ‰ä¸€ä¸ªç¥ä»™åšæ³•ï¼š<a href="https://www.cnblogs.com/Flying2018/p/13406278.html" target="_blank" rel="noopener">flying2018å¤§ä½¬åšå®¢</a></p><h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><hr><p>ä¸ºä»€ä¹ˆæ²¡å¾€æ•°æ®ç»“æ„æƒ³å‘¢ã€‚ã€‚ã€‚è¦åæ€ï¼Œè¿™ä¸€çœ‹å°±å¾ˆçº¿æ®µæ ‘å˜›</p><p>å¿½ç•¥ limit çš„é™åˆ¶â€”â€”æœ€å·¦çš„ä½ç½®å¯ä»¥äºŒåˆ†ã€‚</p><p>maxå€¼æ˜¯<strong>å•è°ƒä¸å¢</strong>çš„ã€‚</p><p>çº¿æ®µæ ‘ç»´æŠ¤æ¯ä¸€ä¸ª f[i] å’Œ max{â€¦}ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¨¡æ‹Ÿèµ› </tag>
            
            <tag> çŸ©é˜µæ ‘å®šç† </tag>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘æ’å¤´dp</title>
      <link href="2020/07/29/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%8F%92%E5%A4%B4dp/"/>
      <url>2020/07/29/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%8F%92%E5%A4%B4dp/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.cnblogs.com/zinthos/p/3897854.html" target="_blank" rel="noopener">è¿™ä¸ªè®²çš„è¿˜ä¸é”™</a></p><p>é‡ä¿®æ’å¤´dpï¼ä»Šæ—¥ä¸»é¢˜ï¼šè®²è®²é‚£äº›å¥‡æ€ªçš„æ’å¤´ä»¬</p><ul><li>åˆ’åˆ†é˜¶æ®µï¼ˆä»ä¸Šåˆ°ä¸‹ã€ä»å·¦åˆ°å³é€æ ¼é€’æ¨ï¼‰ï¼šqvqï¼Œè½®å»“çº¿ä»¥ä¸Šå°±æ˜¯å·²ç»å¤„ç†å¥½çš„çŠ¶æ€ï¼Œåªç­‰ç€æ ¹æ®å½“å‰æ ¼çš„æ’å¤´çŠ¶æ€å¾€ä¸‹æ¨äº†ã€‚</li><li>æ ¹æ®å½“å‰æ ¼æœ‰æ— å·¦ã€ä¸Šæ’å¤´ï¼Œæ¨å‘æœ‰æ— å³ã€ä¸‹æ’å¤´çš„çŠ¶æ€ã€‚</li><li>å…³äºæ¢è¡Œï¼Œæˆ‘ä»¬ç¼–å· m + 1 ä¸ªä½ç½® 0 ~ m, æ˜¾ç„¶å½“å‰è¡Œ 0 ~ m - 1 çš„ä¼šè½¬ç§»åˆ° 1 ~ mï¼Œå³ç§»ä¸€ä½å°±å¥½äº†ã€‚</li><li>æœ´ç´ çš„è½®å»“çº¿åªæœ‰ 0/1 è¡¨ç¤ºæœ‰æ— æ’å¤´ï¼Œä½†ä»¥æ´›è°·é‚£é“ä¾‹é¢˜ä¸ºä¾‹ï¼Œè¿™æ ·å¤„ç†æ˜¯ä¼šå‡ºç°å¤šä¸ªå›è·¯çš„æƒ…å†µçš„ã€‚è¿™æ—¶å€™éœ€è¦ç”¨æ‹¬å·è¡¨ç¤ºæ³• + Xè¿›åˆ¶ï¼ˆX &gt; 2, é€šå¸¸å–X = 4ä¸ºå®œå› ä¸ºä½è¿ç®—å¾ˆå¿«ä¸”å†™èµ·æ¥æ–¹ä¾¿ï¼‰æ¥ç»´æŠ¤æ’å¤´ä¹‹é—´çš„è”é€šæ€§ï¼ˆé™åˆ¶äº†ä¸€äº›éæ³•çŠ¶æ€çš„è½¬ç§»ï¼‰ï¼Œå½“ç„¶ï¼Œåˆ†ç±»æƒ…å†µä¹Ÿå¤šäº†ä¸å°‘ã€‚ã€‚ã€‚</li><li>Hashè¡¨å¯ä»¥é€šè¿‡å»é‡ä»¥åŠæ’é™¤æ— ç”¨çŠ¶æ€æå¤§çš„åŠ é€Ÿæ’å¤´dpçš„é€Ÿåº¦ã€‚</li><li>ç†è§£ä¸äº†çš„è¯ï¼Œå»ºè®®ç”»å›¾ qvqï¼</li></ul><h2 id="hdu1693"><a href="#hdu1693" class="headerlink" title="hdu1693"></a><a href="http://acm.hdu.edu.cn/showproblem.php?pid=1693" target="_blank" rel="noopener">hdu1693</a></h2><hr><p>å¯ä»¥æœ‰å¤šä¸ªå›è·¯ã€‚æœ´ç´ è½®å»“çº¿ï¼Œå¯ä»¥å¼€ f[i, j, s]ï¼Œä¹Ÿå¯ä»¥æ»šåŠ¨æ•°ç»„ï¼ˆç»†èŠ‚æ³¨æ„ï¼ï¼ï¼ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll T, n, m, cas;</span><br><span class="line">ll mp[<span class="number">15</span>][<span class="number">15</span>], f[<span class="number">2</span>][<span class="number">1</span> &lt;&lt; <span class="number">13</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">        <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">        rep(i, <span class="number">1</span>, n)</span><br><span class="line">            rep(j, <span class="number">1</span>, m)</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;mp[i][j]);</span><br><span class="line">        <span class="keyword">int</span> cur = <span class="number">1</span>, pre = <span class="number">0</span>, tot = (<span class="number">1</span> &lt;&lt; (m + <span class="number">1</span>)) - <span class="number">1</span>;</span><br><span class="line">        f[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">            swap(cur, pre);  <span class="comment">// !!!</span></span><br><span class="line">            <span class="built_in">memset</span>(f[cur], <span class="number">0</span>, <span class="keyword">sizeof</span>(f[cur]));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> s = (<span class="number">1</span> &lt;&lt; m) - <span class="number">1</span>; s &gt;= <span class="number">0</span>; --s)</span><br><span class="line">                f[cur][s &lt;&lt; <span class="number">1</span>] = f[pre][s];</span><br><span class="line">            rep(j, <span class="number">1</span>, m) &#123;</span><br><span class="line">                swap(pre, cur);</span><br><span class="line">                <span class="built_in">memset</span>(f[cur], <span class="number">0</span>, <span class="keyword">sizeof</span>(f[cur]));</span><br><span class="line">                rep(s, <span class="number">0</span>, tot) &#123;</span><br><span class="line">                    <span class="keyword">bool</span> is_r = (s &gt;&gt; (j - <span class="number">1</span>)) &amp; <span class="number">1</span>, is_d = (s &gt;&gt; j) &amp; <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">if</span> (!mp[i][j]) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (!is_r &amp;&amp; !is_d)</span><br><span class="line">                            f[cur][s] = f[pre][s];</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (is_r &amp;&amp; is_d) &#123;</span><br><span class="line">                            f[cur][s] = f[pre][s - (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>)) - (<span class="number">1</span> &lt;&lt; j)];</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (is_r ^ is_d) &#123;</span><br><span class="line">                            <span class="keyword">int</span> ss = s | (<span class="number">1</span> &lt;&lt; j) | (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>));</span><br><span class="line">                            f[cur][s] = f[pre][ss - (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>))] + f[pre][ss - (<span class="number">1</span> &lt;&lt; j)];</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            f[cur][s] = f[pre][s + (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>)) + (<span class="number">1</span> &lt;&lt; j)];</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Case %d: There are %lld ways to eat the trees.\n"</span>, ++cas, f[cur][<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ´›è°·æ¨¡æ¿"><a href="#æ´›è°·æ¨¡æ¿" class="headerlink" title="æ´›è°·æ¨¡æ¿"></a><a href="https://www.luogu.com.cn/problem/P5056" target="_blank" rel="noopener">æ´›è°·æ¨¡æ¿</a></h2><hr><p>åªèƒ½æœ‰ä¸€ä¸ªé—­åˆå›è·¯ã€‚</p><p>ï¼ˆä¸€äº›åºŸè¯ï¼šè¿™æ˜¯æˆ‘ä¸Šæ¥å¯¹ç€é¢˜è§£å†™çš„ç¬¬ä¸€é“æ’å¤´dpï¼Œhashä¼˜åŒ– + æ‹¬å·è¡¨ç¤ºä¸€ä¸ªæ²¡å°‘ã€‚ã€‚qwq è¢«æ¯’æ­»äº†å‘€</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">590027</span>, N = <span class="number">6e5</span> + <span class="number">10</span>;</span><br><span class="line">ll n, m, ans, ex, ey, pre, cur = <span class="number">1</span>;</span><br><span class="line">ll bits[<span class="number">30</span>], tots[<span class="number">2</span>], lnk[N], nxt[N], to[N], cnt, sta[<span class="number">2</span>][N], dp[<span class="number">2</span>][N];</span><br><span class="line"><span class="keyword">bool</span> mp[<span class="number">15</span>][<span class="number">15</span>];</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">15</span>][<span class="number">15</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">hsh</span><span class="params">(ll state, ll val)</span> </span>&#123;</span><br><span class="line">    ll x = state % mod;</span><br><span class="line">    <span class="keyword">for</span> (ll i = lnk[x]; i; i = nxt[i])</span><br><span class="line">        <span class="keyword">if</span> (sta[cur][to[i]] == state) &#123;</span><br><span class="line">            dp[cur][to[i]] += val; <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    tots[cur]++;</span><br><span class="line">    sta[cur][tots[cur]] = state;</span><br><span class="line">    dp[cur][tots[cur]] = val;</span><br><span class="line"></span><br><span class="line">    to[++cnt] = tots[cur], nxt[cnt] = lnk[x], lnk[x] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DP</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll cursta, curans;</span><br><span class="line">    <span class="keyword">int</span> is_d, is_r;</span><br><span class="line">    dp[cur][tots[cur] = <span class="number">1</span>] = <span class="number">1</span>, sta[cur][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">1</span>, tots[cur]) sta[cur][j] &lt;&lt;= <span class="number">2</span>;</span><br><span class="line">        rep(j, <span class="number">1</span>, m) &#123;</span><br><span class="line">            swap(pre, cur);</span><br><span class="line">            <span class="built_in">memset</span>(lnk, <span class="number">0</span>, <span class="keyword">sizeof</span>(lnk));</span><br><span class="line">            tots[cur] = cnt = <span class="number">0</span>;</span><br><span class="line">            rep(k, <span class="number">1</span>, tots[pre]) &#123;</span><br><span class="line">                cursta = sta[pre][k], curans = dp[pre][k];</span><br><span class="line">                is_r = (cursta &gt;&gt; bits[j - <span class="number">1</span>]) % <span class="number">4</span>, is_d = (cursta &gt;&gt; bits[j]) % <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (!mp[i][j]) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (!is_r &amp;&amp; !is_d)</span><br><span class="line">                        hsh(cursta, curans);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (!is_r &amp;&amp; !is_d) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (mp[i + <span class="number">1</span>][j] &amp;&amp; mp[i][j + <span class="number">1</span>])</span><br><span class="line">                        hsh(cursta + (<span class="number">1</span> &lt;&lt; bits[j - <span class="number">1</span>]) + <span class="number">2</span> * (<span class="number">1</span> &lt;&lt; bits[j]), curans);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (is_r &amp;&amp; !is_d) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (mp[i][j + <span class="number">1</span>])</span><br><span class="line">                        hsh(cursta - is_r * (<span class="number">1</span> &lt;&lt; bits[j - <span class="number">1</span>]) + is_r * (<span class="number">1</span> &lt;&lt; bits[j]), curans);</span><br><span class="line">                    <span class="keyword">if</span> (mp[i + <span class="number">1</span>][j])</span><br><span class="line">                        hsh(cursta, curans);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (!is_r &amp;&amp; is_d) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (mp[i][j + <span class="number">1</span>])</span><br><span class="line">                        hsh(cursta, curans);</span><br><span class="line">                    <span class="keyword">if</span> (mp[i + <span class="number">1</span>][j])</span><br><span class="line">                        hsh(cursta + is_d * (<span class="number">1</span> &lt;&lt; bits[j - <span class="number">1</span>]) - is_d * (<span class="number">1</span> &lt;&lt; bits[j]), curans);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (is_r == <span class="number">1</span> &amp;&amp; is_d == <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">int</span> cnt = <span class="number">1</span>;</span><br><span class="line">                    rep(l, j + <span class="number">1</span>, m) &#123;</span><br><span class="line">                        <span class="keyword">int</span> t = (cursta &gt;&gt; bits[l]) % <span class="number">4</span>;</span><br><span class="line">                        <span class="keyword">if</span> (t == <span class="number">1</span>) ++cnt;</span><br><span class="line">                        <span class="keyword">if</span> (t == <span class="number">2</span>) --cnt;</span><br><span class="line">                        <span class="keyword">if</span> (!cnt) &#123;</span><br><span class="line">                            hsh(cursta - (<span class="number">1</span> &lt;&lt; bits[j - <span class="number">1</span>]) - (<span class="number">1</span> &lt;&lt; bits[j]) - (<span class="number">1</span> &lt;&lt; bits[l]), curans);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (is_r == <span class="number">2</span> &amp;&amp; is_d == <span class="number">2</span>) &#123;</span><br><span class="line">                    <span class="keyword">int</span> cnt = <span class="number">-1</span>;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> l = j - <span class="number">2</span>; l; --l) &#123;</span><br><span class="line">                        <span class="keyword">int</span> t = (cursta &gt;&gt; bits[l]) % <span class="number">4</span>;</span><br><span class="line">                        <span class="keyword">if</span> (t == <span class="number">1</span>) ++cnt;</span><br><span class="line">                        <span class="keyword">if</span> (t == <span class="number">2</span>) --cnt;</span><br><span class="line">                        <span class="keyword">if</span> (!cnt) &#123;</span><br><span class="line">                            hsh(cursta - <span class="number">2</span> * (<span class="number">1</span> &lt;&lt; bits[j - <span class="number">1</span>]) - <span class="number">2</span> * (<span class="number">1</span> &lt;&lt; bits[j]) + (<span class="number">1</span> &lt;&lt; bits[l]), curans);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (is_r == <span class="number">2</span> &amp;&amp; is_d == <span class="number">1</span>) &#123;</span><br><span class="line">                    hsh(cursta - <span class="number">2</span> * (<span class="number">1</span> &lt;&lt; bits[j - <span class="number">1</span>]) - (<span class="number">1</span> &lt;&lt; bits[j]), curans);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (is_r == <span class="number">1</span> &amp;&amp; is_d == <span class="number">2</span>) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (i == ex &amp;&amp; j == ey)</span><br><span class="line">                        ans += curans;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s[i] + <span class="number">1</span>);</span><br><span class="line">        rep(j, <span class="number">1</span>, m)</span><br><span class="line">            <span class="keyword">if</span> (s[i][j] == <span class="string">'.'</span>) ex = i, ey = j, mp[i][j] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> mp[i][j] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, <span class="number">25</span>) bits[i] = (i &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    DP();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="51nod1518-ç¨³å®šå¤šç±³è¯ºè¦†ç›–"><a href="#51nod1518-ç¨³å®šå¤šç±³è¯ºè¦†ç›–" class="headerlink" title="51nod1518-ç¨³å®šå¤šç±³è¯ºè¦†ç›–"></a><a href="https://vjudge.net/problem/51Nod-1518" target="_blank" rel="noopener">51nod1518-ç¨³å®šå¤šç±³è¯ºè¦†ç›–</a></h2><hr><p>ç»ˆäºåˆ°ä½ äº†ï¼Œæ„ŸåŠ¨ä¸­å›½ï¼</p><p><a href="https://imilyx.github.io/2020/07/30/[51nod1518]-%E7%A8%B3%E5%AE%9A%E5%A4%9A%E7%B1%B3%E8%AF%BA%E8%A6%86%E7%9B%96/" target="_blank" rel="noopener">é“¾æ¥</a></p><p>æš‚æ—¶å°±æ›´è¿™ä¹ˆå¤šå§ï¼Œåç»­è¿˜ä¼šåšé¢˜ &amp; å†™å•ç¯‡åšï¼ˆå¯èƒ½</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ’å¤´dp </tag>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XJOI200728 é¢˜è§£</title>
      <link href="2020/07/28/XJOI200728%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/07/28/XJOI200728%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>ä¸¤é“æ•°æ®ç»“æ„é¢˜ç»™æˆ‘æåäº†ã€‚ã€‚ã€‚</p><h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><hr><p>åŸé¢˜æ˜¯ CF418E</p><p>å®¹æ˜“å‘ç°çŸ©é˜µçš„å¥‡æ•°è¡Œï¼ˆé™¤äº†1ï¼‰å’Œå¶æ•°è¡Œæ˜¯ç›¸åŒçš„. æ„Ÿæ€§ç†è§£å°±æ˜¯æŠŠå¾ˆå¤šä¸² 1ï¼Œ2ï¼Œ3 â€¦ ç©¿æ’åœ¨ä¸€èµ·ï¼Œæ¯æ¬¡è½¬æ¢ä¸€ä¸‹ã€‚</p><p>åˆ†å—åšï¼Œf[i, j] è¡¨ç¤ºç¬¬ä¸€è¡Œå‰ i å—ä¸­æ•°å­— j å‡ºç°çš„æ¬¡æ•°ï¼Œg[i, j] è¡¨ç¤ºç¬¬äºŒè¡Œå‰ i å—ä¸­æ•°å­— j å‡ºç°çš„æ¬¡æ•°</p><p>ç»´æŠ¤çš„æ—¶å€™æ³¨æ„ f å’Œ g çš„åŠ å‡é¡ºåºï¼ï¼ï¼</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>, M = <span class="number">110</span>;</span><br><span class="line"><span class="keyword">int</span> h, n, m, idx, unit = <span class="number">1000</span>, num;</span><br><span class="line"><span class="keyword">int</span> a[N], f[M][N], g[M][N], val[N];</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mp;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; h &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    num = n / unit + (n % unit &gt; <span class="number">0</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">        <span class="keyword">if</span> (!mp[a[i]]) &#123;</span><br><span class="line">            mp[a[i]] = ++idx;</span><br><span class="line">            val[idx] = a[i];</span><br><span class="line">        &#125;</span><br><span class="line">        a[i] = mp[a[i]];</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, num) &#123;</span><br><span class="line">        <span class="keyword">int</span> l = (i - <span class="number">1</span>) * unit + <span class="number">1</span>, r = min(i * unit, n);</span><br><span class="line">        rep(j, <span class="number">1</span>, n)  <span class="comment">// ä¸Šç•Œå– idx æ˜¯ä¸è¡Œçš„ï¼ï¼ï¼gæ•°ç»„æœ€å¤§å€¼ä¸º nï¼ï¼ï¼</span></span><br><span class="line">            f[i][j] = f[i - <span class="number">1</span>][j], g[i][j] = g[i - <span class="number">1</span>][j];</span><br><span class="line">        rep(j, l, r)</span><br><span class="line">            f[i][a[j]]++, g[i][f[i][a[j]]]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="keyword">int</span> op, x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;op, &amp;x, &amp;y);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!mp[y]) &#123;</span><br><span class="line">                mp[y] = ++idx;</span><br><span class="line">                val[idx] = y;</span><br><span class="line">            &#125;</span><br><span class="line">            y = mp[y];</span><br><span class="line">            rep(i, (x - <span class="number">1</span>) / unit + <span class="number">1</span>, num)</span><br><span class="line">                g[i][f[i][a[x]]]--, f[i][a[x]]--;</span><br><span class="line">            a[x] = y;</span><br><span class="line">            rep(i, (x - <span class="number">1</span>) / unit + <span class="number">1</span>, num)</span><br><span class="line">                f[i][a[x]]++, g[i][f[i][a[x]]]++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (x == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, val[a[y]]); <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            rep(i, y / unit * unit + <span class="number">1</span>, y) &#123;</span><br><span class="line">                f[y / unit][a[i]]++, g[y / unit][f[y / unit][a[i]]]++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, x &amp; <span class="number">1</span> ? g[y / unit][f[y / unit][a[y]]] : f[y / unit][a[y]]);</span><br><span class="line">            rep(i, y / unit * unit + <span class="number">1</span>, y) &#123;</span><br><span class="line">                g[y / unit][f[y / unit][a[i]]]--, f[y / unit][a[i]]--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><hr><p>ç»“è®ºé¢˜ï¼Œå°±æ˜¯åˆ æ‰å‰ n ä¸ª</p><p>è¿™ç§é¢˜åº”è¯¥è¦æ‰“è¡¨ + æ‰¾è§„å¾‹ + ç‰¹åˆ¤å•Šï¼Œåˆ«æ„£åœ¨é‚£é‡Œã€‚ã€‚ã€‚</p><h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><hr><p>è€ƒè™‘æ²¡æœ‰æ“ä½œ 2ï¼Œæ˜¾ç„¶ä¸€é dfs å°±èƒ½è§£å†³ï¼ˆè€ƒè™‘èŠ‚ç‚¹ xï¼Œå®ƒä½œä¸º lca çš„è´¡çŒ®å¯ä»¥ç”¨ è¯¢é—®çš„aåœ¨å­æ ‘ä¸­çš„ä¸ªæ•° å’Œ å­æ ‘ä¸­é»‘è‰²ç‚¹çš„idå’Œ æ¥ç®—ï¼‰</p><p>è€ƒè™‘æœ‰æ“ä½œ 2ï¼Œæœ¬è´¨ä¸Šå¤šäº†æ—¶é—´è¿™ä¸€ç»´åº¦ï¼ˆç»å…¸å¥—è·¯ï¼‰ï¼Œç”¨çº¿æ®µæ ‘åˆå¹¶ï¼ˆæ—¶é—´ä¸ºä¸‹æ ‡ï¼‰</p><p>ç‚¹ x ä½œä¸º lca çš„è´¡çŒ®å°±åœ¨åˆå¹¶çš„æ—¶å€™ç®—ã€‚æ˜¾ç„¶æ—¶é—´è¾ƒå°çš„idå’Œå¯¹æ—¶é—´è¾ƒå¤§çš„è¯¢é—®æœ‰å½±å“ã€‚å› æ­¤è¦è®¡ç®— å·¦åŠè¾¹çš„idå’Œ ä¸ å³åŠè¾¹çš„è¯¢é—®ä¸ªæ•° ä¹‹ç§¯ï¼ˆçº¿æ®µæ ‘ä¸Šåˆ†æ²»å¤„ç†ï¼‰</p><p>O(nlogn)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, m, idx;</span><br><span class="line"><span class="keyword">int</span> col[N], lst[N], rt[N];</span><br><span class="line">ll val[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nxt[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span> <span class="keyword">int</span> cnt, ls, rs; ll sum; &#125;tr[N * <span class="number">60</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ls = tr[x].ls, rs = tr[x].rs;</span><br><span class="line">    tr[x].cnt = tr[ls].cnt + tr[rs].cnt;</span><br><span class="line">    tr[x].sum = tr[ls].sum + tr[rs].sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> pos, <span class="keyword">int</span> v1, <span class="keyword">int</span> v2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x) x = ++idx;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        tr[x].cnt += v1;</span><br><span class="line">        tr[x].sum += v2;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (pos &lt;= mid) modify(tr[x].ls, l, mid, pos, v1, v2);</span><br><span class="line">    <span class="keyword">else</span> modify(tr[x].rs, mid + <span class="number">1</span>, r, pos, v1, v2);</span><br><span class="line">    upd(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x || !y) &#123;</span><br><span class="line">        x = (x | y); <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        tr[x].cnt += tr[y].cnt, tr[x].sum += tr[y].sum; <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    val[id] += <span class="number">1l</span>l * tr[tr[x].rs].cnt * tr[tr[y].ls].sum;</span><br><span class="line">    val[id] += <span class="number">1l</span>l * tr[tr[x].ls].sum * tr[tr[y].rs].cnt;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    merge(tr[x].ls, tr[y].ls, l, mid, id);</span><br><span class="line">    merge(tr[x].rs, tr[y].rs, mid + <span class="number">1</span>, r, id);</span><br><span class="line">    upd(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nxt[x].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = nxt[x][i];</span><br><span class="line">        <span class="keyword">if</span> (y == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(y, x);</span><br><span class="line">        merge(rt[x], rt[y], <span class="number">0</span>, m, x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;col[i]);</span><br><span class="line">        <span class="keyword">if</span> (col[i]) modify(rt[i], <span class="number">0</span>, m, <span class="number">0</span>, <span class="number">0</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        nxt[x].push_back(y), nxt[y].push_back(x);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="keyword">int</span> op, x; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;op, &amp;x);</span><br><span class="line">        <span class="keyword">if</span> (op == <span class="number">1</span>) &#123;</span><br><span class="line">            modify(rt[x], <span class="number">0</span>, m, i, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span> (col[x]) val[x] += x;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            col[x] ^= <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (col[x]) &#123;</span><br><span class="line">                modify(rt[x], <span class="number">0</span>, m, i, <span class="number">0</span>, x);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                modify(rt[x], <span class="number">0</span>, m, i, <span class="number">0</span>, -x);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, val[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¨¡æ‹Ÿèµ› </tag>
            
            <tag> çº¿æ®µæ ‘åˆå¹¶ </tag>
            
            <tag> åˆ†å— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>XJOI200727 é¢˜è§£</title>
      <link href="2020/07/28/XJOI200727%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/07/28/XJOI200727%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>åªè®¢äº† A Bï¼Œé¢˜çœŸå¥½ï¼ˆnÃ¡nï¼‰å•Š ~</p><h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><hr><p>ç­”æ¡ˆæ˜¯ $\sum (ai + k - a[i]\ mod\ k)$</p><p>è€ƒè™‘ a[i] &lt; k çš„æ—¶å€™ï¼Œè¿™æ®µé•¿åº¦å°±æ˜¯ k</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°† k ä»å°åˆ°å¤§æ’åºï¼Œå¯¹äºæ¯ä¸ª k åˆ æ‰ &lt; k çš„ a[i]ï¼Œå¯¹äºå‰©ä¸‹çš„ç‚¹åšå‰ç¼€å’Œã€äºŒåˆ†ï¼Œè¾¹ç•Œç‰¹æ®Šå¤„ç†</p><p>ä¸ºä»€ä¹ˆè¿™æ ·å¤æ‚åº¦æ˜¯å¯¹çš„å‘¢ï¼Ÿ<strong>æ¯ä¸ª a[i] è¢«è®¡ç®—å®ƒçš„å¤§å°æ¬¡</strong>ï¼Œæ‰€ä»¥æ˜¯ O(n + Qlogn) çš„ï¼ˆç“¶é¢ˆåœ¨äºäºŒåˆ†ï¼‰</p><p>å¤ªå¦™äº†ï¼</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e6</span> + <span class="number">10</span>, M = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, Q, tot;</span><br><span class="line">ll cur[N], a[N], b[N], pos[N], pre[N], ans[M];</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">que</span> &#123;</span> ll l, r, k, id; &#125;q[M];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(que a, que b)</span> </span>&#123; <span class="keyword">return</span> a.k &lt; b.k; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">    n = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (s[i] == <span class="string">'T'</span>) &#123;</span><br><span class="line">            pos[++tot] = i;</span><br><span class="line">            a[tot] = i - <span class="number">1</span> - pos[tot - <span class="number">1</span>];</span><br><span class="line">            b[tot] = tot;</span><br><span class="line">        &#125;</span><br><span class="line">        cur[i] = tot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; Q;</span><br><span class="line">    rep(i, <span class="number">1</span>, Q) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>, &amp;q[i].l, &amp;q[i].r, &amp;q[i].k);</span><br><span class="line">        q[i].id = i;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(q + <span class="number">1</span>, q + Q + <span class="number">1</span>, cmp);</span><br><span class="line">    rep(i, <span class="number">1</span>, Q) &#123;</span><br><span class="line">        ll l = q[i].l, r = q[i].r, k = q[i].k;</span><br><span class="line">        <span class="keyword">if</span> (k != q[i - <span class="number">1</span>].k) &#123;</span><br><span class="line">            <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">            rep(j, <span class="number">1</span>, tot)</span><br><span class="line">                <span class="keyword">if</span> (a[j] &gt;= k) a[++cnt] = a[j], b[cnt] = b[j];</span><br><span class="line">            tot = cnt;</span><br><span class="line">            rep(j, <span class="number">1</span>, tot) pre[j] = pre[j - <span class="number">1</span>] + a[j] / k;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (cur[l - <span class="number">1</span>] == cur[r]) &#123;</span><br><span class="line">            ans[q[i].id] = r - l + <span class="number">1</span>; <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> x = lower_bound(b + <span class="number">1</span>, b + tot + <span class="number">1</span>, cur[l - <span class="number">1</span>] + <span class="number">2</span>) - b;</span><br><span class="line">        <span class="keyword">int</span> y = upper_bound(b + <span class="number">1</span>, b + tot + <span class="number">1</span>, cur[r]) - b - <span class="number">1</span>;</span><br><span class="line">        ans[q[i].id] = (r - pos[cur[r]]) + k * (cur[r] - cur[l - <span class="number">1</span>] + (pre[y] - pre[x - <span class="number">1</span>]) + (pos[cur[l - <span class="number">1</span>] + <span class="number">1</span>] - l) / k);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, Q) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><hr><p>å®¹æ˜“åˆ—å‡º dp æŸ¿å­ $f[i, j] = \sum\limits_k f[i - 1, j - a_k]$ï¼Œç­”æ¡ˆå°±æ˜¯ $f[l, i](i\ mod\ n = 0)$</p><p>å®¹æ˜“æƒ³åˆ°çŸ©é˜µå¿«é€Ÿå¹‚ï¼Œä½†æ˜¯å¤æ‚åº¦å¤ªé«˜ä¼šçˆ†ç‚¸</p><p>ä»ç”Ÿæˆå‡½æ•°çš„è§†è§’å‡ºå‘ï¼Œè®¾ $g(x) = \sum\limits_i x^{a_i}$ï¼Œåˆ™ $[j + a_k] f^i = \sum [j]f^{i - 1} \times [a_k] g$ï¼Œè¿™æ˜¯<a href="https://www.cnblogs.com/birchtree/p/12287474.html" target="_blank" rel="noopener">å¾ªç¯å·ç§¯</a>çš„å½¢å¼ã€‚æ‰€ä»¥è¯´æˆ‘ä»¬å¹³æ—¶å†™çš„ fft/ntt å…¶å®å°±æ˜¯å¿½è§†äº† 2^? çš„å¾ªç¯å·ç§¯ï¼æœ¬é¢˜ n æ˜¯ 2^?ï¼Œè‹¥ä¸æ˜¯ï¼Œåˆ™éœ€è¦åšä»»æ„é•¿åº¦fftäº†ã€‚ï¼ˆæˆ‘ä¸ä¼š</p><p>å·ç§¯å¿«é€Ÿå¹‚å…¶å®å°±æ˜¯è½¬åŒ–æˆç‚¹å€¼å½¢å¼ï¼Œç‚¹å¯¹ç‚¹ç›´æ¥åšå¿«é€Ÿå¹‚ã€‚</p><p>m ä¸ªé™åˆ¶å¯ä»¥åˆ†æ®µåšå†ä¹˜èµ·æ¥ï¼Œæ¯åšå®Œä¸€ä¸ªé™åˆ¶å°±æŠŠä¸‹ä¸€ä¸ªé™åˆ¶ä½ç½®çš„æ–¹æ¡ˆæ•°ç½®ä¸º 0ï¼Œå¤æ‚åº¦æ˜¯ O(mnlog^2n)</p><p><a href="https://www.cnblogs.com/Flying2018/p/13387482.html" target="_blank" rel="noopener">æ®è¯´è¿˜èƒ½å®¹æ–¥ï¼Ÿï¼Ÿï¼Ÿå’•å’•</a></p><p>codeï¼ˆåˆ†æ®µåšï¼‰ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>, N = <span class="number">66000</span> * <span class="number">2</span>, G = <span class="number">3</span>, G1 = (mod + <span class="number">1</span>) / G;</span><br><span class="line">ll n, L, m, Q, lim = <span class="number">1</span>;</span><br><span class="line">ll r[N], f[N], g[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">limits</span> &#123;</span> ll x, y; &#125;li[<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(limits a, limits b)</span> </span>&#123; <span class="keyword">return</span> a.x &lt; b.x; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quick_pow</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ret = ret * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">    &#125; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ntt</span><span class="params">(ll a[], <span class="keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">0</span>, lim - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i]) swap(a[i], a[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; lim; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        ll W = quick_pow(op == <span class="number">1</span> ? G : G1, (mod - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; lim; j += (mid &lt;&lt; <span class="number">1</span>)) &#123;</span><br><span class="line">            ll w = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k++, w = w * W % mod) &#123;</span><br><span class="line">                ll x = a[j + k], y = w * a[j + k + mid] % mod;</span><br><span class="line">                a[j + k] = (x + y) % mod, a[j + k + mid] = (x - y + mod) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">-1</span>) &#123;</span><br><span class="line">        ll inv = quick_pow(lim, mod - <span class="number">2</span>);</span><br><span class="line">        rep(i, <span class="number">0</span>, lim - <span class="number">1</span>) a[i] = a[i] * inv % mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; L &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;li[i].x, &amp;li[i].y);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; Q;</span><br><span class="line">    rep(i, <span class="number">1</span>, Q) &#123;</span><br><span class="line">        <span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x); f[x]++;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    li[++m] = (limits)&#123;L, <span class="number">0</span>&#125;;</span><br><span class="line">    sort(li + <span class="number">1</span>, li + m + <span class="number">1</span>, cmp);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (lim &lt; n) lim &lt;&lt;= <span class="number">1</span>, ++l;  <span class="comment">// &lt; n å“¦ï¼Œæ˜¯å¾ªç¯å·ç§¯</span></span><br><span class="line">    rep(i, <span class="number">0</span>, lim - <span class="number">1</span>) r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>));</span><br><span class="line">    ntt(f, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    g[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        ntt(g, <span class="number">1</span>);</span><br><span class="line">        rep(j, <span class="number">0</span>, n - <span class="number">1</span>) g[j] = g[j] * quick_pow(f[j], li[i].x - li[i - <span class="number">1</span>].x) % mod;  <span class="comment">// ç‚¹å€¼ç›´æ¥åšå¿«é€Ÿå¹‚</span></span><br><span class="line">        ntt(g, <span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">if</span> (i &lt; m) g[li[i].x] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, g[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><hr><p>çœ‹äº† <a href="https://www.cnblogs.com/Flying2018/p/13399374.html" target="_blank" rel="noopener">Flying2018å¤§ä½¬åšå®¢</a> æ¥è®¢æ­£äº†ã€‚ã€‚ã€‚</p><p><strong>æœ¬é¢˜æ‰€æœ‰æ€è€ƒåŸºäºä¸€ä¸ªæ€§è´¨ï¼šå¯¹äº $gcd(a, b) = 1$ï¼Œ$l = a \times b$, $len(l) = lcm(len(a), len(b))$</strong></p><p>æ‰€ä»¥åªè¦è€ƒè™‘æ‰€æœ‰ = è´¨æ•°çš„ m å°±å¥½äº†ã€‚</p><p>è€ƒè™‘ f(n) æ€ä¹ˆç®—ï¼Œæ˜¾ç„¶ $f(n) = x \times a^n + \sum\limits_{i &lt; n} c \times a^i$</p><p>é‚£ä¹ˆå°±æ˜¯è¦æ±‚ $x \times a^n + \sum\limits_{i &lt; n} c \times a^i \equiv x (mod\ m)$ çš„æœ€å° n</p><p>å³ $\frac{a^n - 1}{a - 1} \equiv x(1 - a^n) (mod\ m)$ </p><p>ç„¶åå¼€å§‹åˆ†è®¨ï¼š</p><ul><li>a = 0ï¼šå¾ªç¯èŠ‚ä¸º 1</li><li>a = 1ï¼š</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
            <tag> æ¨¡æ‹Ÿèµ› </tag>
            
            <tag> NTTä¼˜åŒ– </tag>
            
            <tag> å®¹æ–¥åŸç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[UOJ455]-é›ªç¾ä¸å¤–å–</title>
      <link href="2020/07/27/%5BUOJ455%5D-%E9%9B%AA%E7%81%BE%E4%B8%8E%E5%A4%96%E5%8D%96/"/>
      <url>2020/07/27/%5BUOJ455%5D-%E9%9B%AA%E7%81%BE%E4%B8%8E%E5%A4%96%E5%8D%96/</url>
      
        <content type="html"><![CDATA[<p><a href="http://uoj.ac/problem/455" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>æ„Ÿè§‰è¿™é¢˜å¥½ç¥å•Šï¼Œå¯æ’¤é”€è´ªå¿ƒä»€ä¹ˆçš„å‚»å‚»æƒ³ä¸æ˜ç™½ï¼Œæ¨¡æ‹Ÿè´¹ç”¨æµä¹Ÿå¤ªé«˜çº§äº†å§</p><hr><p>å¤ä¹ ä¸€ä¸‹ç½‘ç»œæµ</p><p>æ³¨æ„åæ‚”è¾¹</p><p>å¦‚æœè£¸çš„è·‘ï¼Œå³ EKï¼Œä¼š Tï¼Œ$O(nm^2)$</p><p>ä¼˜åŒ–å°±æ˜¯åœ¨æœ€çŸ­è·¯ä¸Šè·‘ï¼Œï¼ˆæ›´å‡†ç¡®åœ°è¯´æ˜¯ä¿ç•™åœ¨åŸæ¥çš„æ®‹é‡ç½‘ç»œä¸­å¯ä»¥è¢«å¢å¹¿çš„è¾¹å³è¿çš„ç‚¹ï¼‰dinicï¼Œ$O(n^2m)$</p><hr><p>å›åˆ°æœ¬é¢˜</p><p>è£¸çš„è´¹ç”¨æµ æˆ–è€… æ ¹æ®è´ªå¿ƒç”¨å•è°ƒé˜Ÿåˆ—åš æ˜¯ 25 åˆ†</p><p>æ­£è§£æ˜¯ç”¨å¯æ’¤é”€è´ªå¿ƒæ¥æ¨¡æ‹Ÿè´¹ç”¨æµï¼ˆä»€ä¹ˆï¼‰</p><p><a href="https://www.cnblogs.com/yinwuxiao/p/10325138.html" target="_blank" rel="noopener">å­¦ä¹ äº†è¿™ç¯‡åšå®¢</a></p><p>é‡ç‚¹åœ¨äºæ¨¡æ‹Ÿé€€æµï¼Œå³åæ‚”æ“ä½œ</p><p>è€ƒè™‘å°†äººå’Œé¤å…æŒ‰åæ ‡æ’åºï¼Œä»å·¦å¾€å³åšï¼Œç»´æŠ¤ä¸¤ä¸ªå †åˆ†åˆ«å‚¨å­˜äººå’Œé¤å…çš„è´¡çŒ®ä»¬</p><p>å…ˆå¿½ç•¥ $c$ çš„é™åˆ¶ï¼Œå³å°†é¤å…æ‹†ç‚¹</p><p><strong>å¯¹äºäºº</strong>ï¼ŒæŠŠå®ƒä¸å·¦è¾¹æœ€ä¼˜çš„é¤å…åŒ¹é…ï¼Œè´¡çŒ®æ˜¯ $x_i + v_j$, å…¶ä¸­ $v_j$ æ˜¯å·¦è¾¹é¤å…çš„è´¡çŒ®</p><p>å¦‚æœäººè¦åæ‚”ï¼Œè´¡çŒ®å°±æ˜¯ $-2x_i - v_j$</p><p>æ³¨æ„è¿™é‡Œé¤å…æ²¡æœ‰åæ‚”çš„å¿…è¦ï¼Œå› ä¸ºé¤å…ä¸äººçš„åŒ¹é…ä¸ä¼šç›¸äº¤ï¼Œåªéœ€è¦ä¿è¯äººåæ‚”å†åæ‚”èƒ½åŒ¹é…ä¸ŠåŸé¤å…å°±å¥½äº†</p><p><strong>å¯¹äºé¤å…</strong>ï¼ŒæŠŠå®ƒä¸å·¦è¾¹æœ€ä¼˜çš„äººåŒ¹é…ï¼Œè´¡çŒ®æ˜¯ $y_i + w_i + v_j$ï¼Œå…¶ä¸­ $v_j$ æ˜¯å·¦è¾¹äººçš„è´¡çŒ®</p><p>å¦‚æœäººè¦åæ‚”ï¼Œè´¡çŒ®å°±æ˜¯ $-y - w$</p><p>å¦‚æœé¤å…è¦åæ‚”ï¼Œ$-v_j - 2y$</p><p>è¿™æ ·å¤æ‚åº¦æ˜¯ $O((n + \sum c)log(n + \sum c))$</p><p>è€ƒè™‘å»æ‰æ‹†ç‚¹ï¼Œå‘ç°å½“å‰æš‚æ—¶åŒ¹é…åŒä¸€ä¸ªé¤å…çš„äºº çš„åæ‚”è´¡çŒ®æ˜¯ç›¸åŒçš„ï¼Œäºæ˜¯å¯ä»¥æŠŠå®ƒä»¬å‹åœ¨ä¸€èµ·</p><p>$O((n + m)log(n + m))$</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll, ll&gt; pll;  <span class="comment">// ç¬¬äºŒä½æ˜¯ä¸ªæ•°</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> ll inf = <span class="number">1e18</span>;</span><br><span class="line">ll n, m, X[N], Y[N], W[N], C[N];</span><br><span class="line">ll ans, tot;</span><br><span class="line">priority_queue&lt;pll, <span class="built_in">vector</span>&lt;pll&gt;, greater&lt;pll&gt; &gt; A, B;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_x</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">    ll y;</span><br><span class="line">    <span class="keyword">if</span> (B.empty()) y = inf;</span><br><span class="line">    <span class="keyword">else</span> y = B.top().first;</span><br><span class="line">    ans += x + y;</span><br><span class="line">    A.push(make_pair(<span class="number">-2</span> * x - y, <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">if</span> (B.size()) &#123;</span><br><span class="line">        ll t = B.top().second;</span><br><span class="line">        B.pop();</span><br><span class="line">        <span class="keyword">if</span> (t &gt; <span class="number">1</span>) B.push(make_pair(y, t - <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_y</span><span class="params">(ll y, ll w, ll c)</span> </span>&#123;</span><br><span class="line">    ll m = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (c != m &amp;&amp; A.size() &amp;&amp; y + w + A.top().first &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        ll x = A.top().first;</span><br><span class="line">        ll t = A.top().second, tt = min(c - m, t);</span><br><span class="line">        ans += tt * (x + y + w);</span><br><span class="line">        A.pop();</span><br><span class="line">        <span class="keyword">if</span> (tt != t) A.push(make_pair(x, t - tt));</span><br><span class="line">        B.push(make_pair(-x - <span class="number">2</span> * y, tt));</span><br><span class="line">        m += tt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (m) A.push(make_pair(-y - w, m));</span><br><span class="line">    <span class="keyword">if</span> (c != m) B.push(make_pair(-y + w, c - m));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;X[i]);</span><br><span class="line">    rep(i, <span class="number">1</span>, m) <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>, &amp;Y[i], &amp;W[i], &amp;C[i]), tot += C[i];</span><br><span class="line">    <span class="keyword">if</span> (tot &lt; n) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>), <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">1</span>, j = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt;= n &amp;&amp; j &lt;= m) &#123;</span><br><span class="line">        <span class="keyword">if</span> (X[i] &lt; Y[j]) push_x(X[i]), ++i;</span><br><span class="line">        <span class="keyword">else</span> push_y(Y[j], W[j], C[j]), ++j;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (i &lt;= n) push_x(X[i]), ++i;</span><br><span class="line">    <span class="keyword">while</span> (j &lt;= m) push_y(Y[j], W[j], C[j]), ++j;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
            <tag> è´¹ç”¨æµ </tag>
            
            <tag> å¯æ’¤é”€è´ªå¿ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[UOJ513]-æ¸…æ‰«é“¶æ²³</title>
      <link href="2020/07/27/%5BUOJ513%5D-%E6%B8%85%E6%89%AB%E9%93%B6%E6%B2%B3/"/>
      <url>2020/07/27/%5BUOJ513%5D-%E6%B8%85%E6%89%AB%E9%93%B6%E6%B2%B3/</url>
      
        <content type="html"><![CDATA[<p><a href="http://peehs-moorhsum.blog.uoj.ac/blog/5486" target="_blank" rel="noopener">å®˜æ–¹é¢˜è§£</a> é€»è¾‘å¾ˆæ¸…æ™°ï¼</p><p>è‹¥æœ‰è§£åˆ™å¿…ç„¶å¯ä»¥åœ¨ m + 1 æ¬¡æ“ä½œé‡Œå‡ºè§£ã€‚</p><p><strong>è¯æ˜ï¼š</strong><br>é¦–å…ˆè¦çŸ¥é“ä¸€ä¸ªæ€§è´¨ï¼šæ— å‘å›¾çš„ä»»ä½•ç¯éƒ½å¯ä»¥ç”±è‹¥å¹²ä¸ªéæ ‘è¾¹è¦†ç›–çš„ç¯å¼‚æˆ–å¾—åˆ°ã€‚ä¹Ÿå°±æ˜¯è¯´æœ‰ç”¨çš„æ“ä½œä¸€åªæœ‰ m - n + 1 ä¸ªã€‚</p><p>è€Œæ“ä½œäºŒç­‰ä»·äºæ¯æ¬¡é€‰ä¸€ä¸ªç‚¹ï¼Œå°†ä¸è¿™ä¸ªç‚¹ç›¸é‚»çš„è¾¹å…¨éƒ¨åè½¬ï¼Œä¹Ÿå°±æ˜¯è¯´æœ‰ç”¨çš„æ“ä½œäºŒæœ‰ n ä¸ªã€‚</p><p>æ€»å…±æ“ä½œæ•°ä¸º m + 1 ä¸ªï¼Œè§£å¼‚æˆ–æ–¹ç¨‹ç»„ï¼Œå¿…ç„¶å¯ä»¥åœ¨ m + 1 æ¬¡æ“ä½œé‡Œå‡ºè§£ï¼Œå†µä¸”å¤šä¸ªæ“ä½œäºŒè¿˜å¯ä»¥åˆæˆä¸€ä¸ªå‘¢ã€‚</p><p>ä½†çœŸçš„è¿™æ ·åšå´æ˜¯ O(m^3 / 32) çš„ï¼Œè€ƒè™‘ä¼˜åŒ–ã€‚</p><p>å°†æ‰€æœ‰ 1 è¾¹å½¢æˆçš„å›¾ç§°ä¸ºç›®æ ‡å­å›¾ã€‚</p><p>æ ¹æ®<strong>æ¬§æ‹‰å›è·¯</strong>çš„çŸ¥è¯†ï¼Œè‹¥ç›®æ ‡å­å›¾ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„åº¦æ•°éƒ½æ˜¯å¶æ•°ï¼Œåˆ™å¿…ç„¶å¯ä»¥é€šè¿‡ä¸è¶…è¿‡ m - n + 1 æ¬¡æ“ä½œä¸€å°†è¾¹æƒéƒ½å˜æˆ 0.</p><p>å› æ­¤åªè¦è€ƒè™‘ï¼Œä»…ç”¨æ“ä½œäºŒèƒ½å¦è®©ç›®æ ‡å­å›¾ä¸­æ¯ä¸ªèŠ‚ç‚¹åº¦æ•°å˜æˆå¶æ•°ã€‚</p><p>è¿™æ ·æ˜¯ O(n^3 / 32) çš„ã€‚</p><p>å¼‚æˆ–ä»€ä¹ˆçš„æƒ³æƒ³æ–¹ç¨‹ç»„å•Šï¼Œï¼Œï¼Œè™½ç„¶æš´åŠ›ï¼Œä½†åˆ°åº•æ˜¯ä¸ªåˆ‡å…¥å£ã€‚ä¸è¿‡åç»­å°±éœ€è¦æ‰¾æ€§è´¨äº†ã€‚</p><p>æ­£å¼åšé¢˜æ—¶ï¼Œé€†æ¨å›å»æ¯”è¾ƒå¥½ï¼šç¯ä¸Šç‚¹çš„åº¦æ•°éƒ½æ˜¯å¶æ•°â€¦æ‰€ä»¥blabla</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">305</span>;</span><br><span class="line"><span class="keyword">int</span> T, n, m;</span><br><span class="line"><span class="built_in">bitset</span>&lt;N&gt; a[N], x;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Gauss</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!a[i][i]) &#123;</span><br><span class="line">            rep(j, i + <span class="number">1</span>, n) <span class="keyword">if</span> (a[j][i]) &#123; swap(a[i], a[j]); <span class="keyword">break</span>; &#125;</span><br><span class="line">            <span class="keyword">if</span> (!a[i][i]) <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rep(j, i + <span class="number">1</span>, n) <span class="keyword">if</span> (a[j][i]) a[j] ^= a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i; --i) &#123;</span><br><span class="line">        <span class="keyword">int</span> t = a[i][n + <span class="number">1</span>];</span><br><span class="line">        rep(j, i + <span class="number">1</span>, n) t ^= (a[i][j] * x[j]);</span><br><span class="line">        <span class="keyword">if</span> (!a[i][i] &amp;&amp; t) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        x[i] = t;</span><br><span class="line">    &#125; <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">        rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">            <span class="keyword">int</span> x, y, z; <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;x, &amp;y, &amp;z);</span><br><span class="line">            a[x][x].flip(), a[y][y].flip(), a[x][y] = <span class="number">1</span>, a[y][x] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (z) a[x][n + <span class="number">1</span>].flip(), a[y][n + <span class="number">1</span>].flip();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(Gauss() ? <span class="string">"yes"</span> : <span class="string">"no"</span>);</span><br><span class="line">        rep(i, <span class="number">1</span>, n) a[i].reset();</span><br><span class="line">        x.reset();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
            <tag> é«˜æ–¯æ¶ˆå…ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AGC 017 é¢˜è§£</title>
      <link href="2020/07/27/AGC%20017%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/07/27/AGC%20017%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>A dp ä¸€ä¸‹å°±å¥½äº†</p><h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><hr><p>æšä¸¾å‡äº†å¤šå°‘æ¬¡ï¼Œç®—å‡ºè¿™ä¸ª n - 1 é¡¹æ•°åˆ—æœ«é¡¹çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼Œæ˜¾ç„¶è¿™ä¸ªèŒƒå›´å†…ä»»ä½•ä¸€ä¸ªæ•°éƒ½æ˜¯å¯è¾¾çš„</p><p>check b æ˜¯å¦åœ¨èŒƒå›´å†…å°±å¥½äº†</p><h2 id="C"><a href="#C" class="headerlink" title="*C"></a>*C</h2><hr><p>è®¾ f[i] è¡¨ç¤ºæŒ‰ ai æ’åºçš„æŸä¸ªå‰ç¼€ i ä¸ªçƒï¼Œæ˜¯å¦åˆæ³•</p><p>æ˜¾ç„¶ f[i + num[j]] åœ¨ i + num[j] = j çš„æ—¶å€™ä¹Ÿæ˜¯åˆæ³•çš„</p><p>åˆ°è¿™é‡Œå°±ä¸ä¼šäº†ï¼Œï¼Œï¼Œ</p><p>é¢˜è§£å·§å¦™çš„è½¬åŒ–æˆäº†çº¿æ®µè¦†ç›–ï¼Œi å·çƒçš„æ˜¯ [i - num[i], i] è¿™ä¸€æ®µï¼Œç­”æ¡ˆå°±æ˜¯ [0, n] é—´æ²¡è¢«è¦†ç›–çš„çº¿æ®µæ•°</p><p>ä¸ºä»€ä¹ˆï¼Ÿé¦–å…ˆæ‰€æœ‰çº¿æ®µè¢«è¦†ç›–æ¬¡æ•°ä¹‹å’Œä¸º nï¼Œé‚£ä¹ˆæ²¡è¢«è¦†ç›–çš„çº¿æ®µéœ€è¦ä» é‡å¤è¦†ç›–çš„çº¿æ®µ ç§»è¿‡å»ï¼Œæ­£ç¡®æ€§æ˜¾ç„¶ã€‚</p><h2 id="D"><a href="#D" class="headerlink" title="*D"></a>*D</h2><hr><p>ç«Ÿç„¶æ˜¯ç»å…¸å¥—è·¯ã€‚ã€‚å­¦ä¹ ä¸€æ³¢</p><p>Hackenbushåˆ è¾¹æ¸¸æˆï¼Œ**sg[x] = XOR( sg[son] + 1 )**ï¼Œå¥½åƒå½’çº³æ³•å¯è¯</p><p>è¿™ç©æ„è¿˜æœ‰ä¸€äº›å¥‡å¥‡æ€ªæ€ªçš„æ‰©å±•ï¼Œæ¯”å¦‚æ— å‘è¿é€šå›¾ä¸Šç©æ¸¸æˆã€‚ã€‚ã€‚</p><p>è¿™å°±éœ€è¦ç”¨ç¯æäº‹æƒ…äº†ï¼ˆä¸ä¼š</p><h2 id="E"><a href="#E" class="headerlink" title="*E"></a>*E</h2><hr><p>å¤§æ¦‚æƒ³åˆ°è¦è½¬åŒ–æˆå›¾ä¸Šé—®é¢˜äº†ï¼Œä½†æš´åŠ›å»ºè¾¹ n^2 + å“ˆå¯†é¡¿è·¯å¾„æ˜¾ç„¶ä¸å¯åšã€‚ã€‚ã€‚</p><p>è€ƒè™‘æ¬§æ‹‰è·¯å¾„ï¼Œh åªæœ‰ 200ï¼Œæˆ‘ä»¬å°†å·¦è¾¹è´´åœ°é«˜åº¦ k çš„å½¢çŠ¶ å’Œå³è¾¹ç¦»åœ°é«˜åº¦ k çš„å½¢çŠ¶ æ ‡å· kï¼Œå·¦è¾¹ç¦»åœ°é«˜åº¦ k çš„å½¢çŠ¶ å’Œå³è¾¹è´´åœ°é«˜åº¦ k çš„å½¢çŠ¶ æ ‡å· -kï¼Œé‚£ä¹ˆæ¯ä¸ªç§¯æœ¨å°±æˆäº†è¿æ¥ä¸¤ä¸ªå½¢çŠ¶çš„æœ‰å‘è¾¹</p><p>é—®é¢˜å°±è½¬åŒ–æˆäº†ï¼šèƒ½å¦æ‰¾åˆ°è‹¥å¹²æ¡ s -&gt; t çš„è·¯å¾„ï¼ŒåŒ…å«æ‰€æœ‰è¾¹ä¸” s &gt; 0, t &lt; 0</p><p>è¿™éœ€è¦æ»¡è¶³æ¡ä»¶ï¼š</p><ul><li>x &gt; 0, in[x] &lt;= out[x]</li><li>x &lt; 0, in[x] &gt;= out[x]</li><li>åœ¨æ¯ä¸ªï¼ˆå¼±ï¼‰è¿é€šåˆ†é‡ä¸­ï¼Œå¿…é¡»æœ‰ä¸€ä¸ªç‚¹ x, in[x] != out[x]</li></ul><p>æ­£ç¡®æ€§è¿˜æ˜¯æ¯”è¾ƒæ˜¾ç„¶çš„ï¼Œè¯æ˜è€ƒè™‘ä¸æ–­æ‹¿ç¯å°±å¥½äº†ã€‚</p><p>upd: åˆ«å¿˜äº†è¿åŒå‘è¾¹ï¼ˆå¯ä»¥ä» t æœå› sï¼‰</p><h2 id="F"><a href="#F" class="headerlink" title="*F"></a>*F</h2><hr><p>å’•å’•</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AGC 015 é¢˜è§£</title>
      <link href="2020/07/27/AGC%20015%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/07/27/AGC%20015%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>ABå‡ä¸ºæ°´é¢˜</p><h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><hr><p>ç½‘æ ¼å›¾å¸¸è§å¥—è·¯ï¼šC = V - E + Fï¼Œå‰ç¼€å’Œï¼Œå¤„ç†ä¸€ä¸‹ä¸´ç•Œçš„è¡Œå’Œåˆ—</p><h2 id="D"><a href="#D" class="headerlink" title="D"></a>D</h2><hr><p>ä¸€èˆ¬çš„ä½è¿ç®—é¢˜éƒ½æ˜¯ä¸€ä½ä¸€ä½åˆ†å¼€æ¥æï¼Œä½†è¿™é¢˜æ²¡æ³•è¿™ä¹ˆåšã€‚</p><p>æ•´ä½“è€ƒè™‘ã€‚é¦–å…ˆ A å’Œ B å‰é¢ç›¸åŒçš„ä½å¯ä»¥å¿½ç•¥ã€‚</p><p>è®¾ç¬¬ä¸€ä¸ªä¸åŒçš„ä½ä¸º pï¼Œæˆ‘ä»¬å°†åŒºé—´åˆ’åˆ†ä¸º $[A, 2^p)$ å’Œ $[2^p, B]$ã€‚</p><p>å•å– $[A, 2^p)$ï¼Œå¯ä»¥ or å‡º $[A, 2^p)$</p><p>å•å– $[2^p, B]$ï¼Œè®¾ B ä¸­é™¤ p ä»¥å¤–çš„æœ€é«˜ä½ä¸º dï¼Œå¯ä»¥ or å‡º $[2^p, 2^{d + 1})$</p><p>ä¸¤ä¸ªåŒºé—´éƒ½å–ï¼Œå¯ä»¥ or å‡º $[2^p + A, 2^{p + 1})$</p><p>ç­”æ¡ˆå°±æ˜¯è¿™ä¸‰ä¸ªåŒºé—´çš„å¹¶é›†ã€‚</p><h2 id="E"><a href="#E" class="headerlink" title="E"></a>E</h2><hr><p>çœ‹æŸ“äº†ç‚¹ i èƒ½æŸ“å“ªäº›ç‚¹ jï¼š</p><ul><li>xi &gt; xj, vi &lt; vj</li><li>xi &lt; xj, vi &gt; vj</li></ul><p>å¯ä»¥å°† v å‡åºæ’åˆ—ï¼Œè®¾ li è¡¨ç¤ºæœ€å·¦çš„ xj &gt;= xi çš„ jï¼Œri è¡¨ç¤ºæœ€å³çš„ xj &lt;= xi çš„ jã€‚é‚£ä¹ˆ i èƒ½æŸ“åˆ°çš„åŒºé—´å°±æ˜¯ [li, ri]ï¼ˆè¿™ä¸ªåŒºé—´ä¸­æœ‰äº›ç‚¹æ˜¯è¢« li å’Œ ri æŸ“åˆ°çš„ï¼‰</p><p>é—®é¢˜å°±è½¬åŒ–æˆï¼šç»™ä½ è‹¥å¹²ä¸ªåŒºé—´ [li, ri] æ»¡è¶³ liã€ri é€’å¢ï¼Œæ±‚æœ‰å¤šå°‘ç§åŒºé—´é›†åˆèƒ½è¦†ç›–æ‰€æœ‰çš„ç‚¹ï¼Ÿ</p><p>dpï¼Œf[i] è¡¨ç¤ºé€‰ç¬¬ i åŒºé—´ï¼Œè¦†ç›– [1, ri] çš„æ–¹æ¡ˆæ•°ï¼Œæ˜¾ç„¶å½“ j &lt; i ä¸” Rj &gt;= li - 1 æ—¶ f[j] å¯ä»¥è½¬ç§»åˆ° f[i]</p><p>è‹¥ f[j] èƒ½è½¬ç§»åˆ° f[i]ï¼Œåˆ™ f[j + 1] ä¹Ÿèƒ½è½¬ç§»åˆ° f[i]ï¼Œæ‰€ä»¥è®¾ L ä¸ºæœ€å·¦è¾¹çš„ j, [L, i - 1] çš„éƒ½èƒ½è½¬ç§»åˆ° f[i]ã€‚å®¹æ˜“å‘ç° L æ˜¯å•è°ƒé€’å¢çš„ï¼Œç»´æŠ¤ L å’Œå‰ç¼€å’Œå°±å¯ä»¥åšäº†ï¼</p><h2 id="F"><a href="#F" class="headerlink" title="F"></a>F</h2><hr><p>ç»“è®ºé¢˜ï¼Œä¸æ˜¯å¾ˆæ‡‚ï¼ˆæ®è¯´å®˜æ–¹é¢˜è§£æŒ‚æ‰äº†ï¼Ÿ</p><p>é€†æ¨ä¸€æ³¢æƒ³åˆ°æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œè¿™å¾ˆä¼˜çš„æ ·å­</p><p>è¯æ˜çœ‹<a href="https://blog.csdn.net/corsica6/article/details/88579827" target="_blank" rel="noopener">è¿™ä¸ªåšå®¢</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Week4æµ‹è¯•é¢˜è§£</title>
      <link href="2020/07/26/Week4%E6%B5%8B%E8%AF%95%E9%A2%98%E8%A7%A3/"/>
      <url>2020/07/26/Week4%E6%B5%8B%E8%AF%95%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vjudge.net/contest/385165#overview" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p><a href="https://zybuluo.com/Cyani/note/1727491" target="_blank" rel="noopener">GHIKçš„é¢˜è§£</a></p><p>åæ§½ä¸€å¥ï¼Œæˆ‘æ˜¯ç½šæ—¶å·¨æ€ªæ— ç–‘äº†ï¼Œnoipå¯ä¸ä¼šç»™ä½ ç½šæ—¶çš„æœºä¼šå•Šï¼ï¼ï¼</p><p>æé«˜å‡†ç¡®åº¦ï¼ŒåŠ›æ±‚ä¸€éå†™å¯¹ï¼ï¼ï¼</p><h2 id="E"><a href="#E" class="headerlink" title="E"></a>E</h2><hr><p>double ä¼šçˆ†ç²¾åº¦ï¼Œå¯ä»¥ç”¨ hashï¼ˆå…¶å®å°±æ˜¯ä¸ºäº†ä¸çˆ† longlong è€ŒåŠ æ¨¡æ•°ç½¢äº†ï¼‰</p><h2 id="F"><a href="#F" class="headerlink" title="F"></a>F</h2><hr><p><strong>å¯ä»¥ä¸‰åˆ†å¥—ä¸‰åˆ†</strong>çš„é¢˜éƒ½æ˜¯å•è°·å‡½æ•°ã€‚æ®è¯´å¯ä»¥æ¨¡æ‹Ÿé€€ç«ï¼Œè€Œæˆ‘å¹¶ä¸ä¼šé‚£ä¸ªã€‚ã€‚</p><h2 id="G"><a href="#G" class="headerlink" title="G"></a>G</h2><hr><p>é¢˜ç›®çœ‹é”™äº†ã€‚ã€‚ã€‚n^2 åšå³å¯</p><h2 id="H"><a href="#H" class="headerlink" title="H"></a>H</h2><hr><p>éšç€è¡Œçš„æ•°å¢å¤§ï¼Œæ¯ä¸ªæ•°çš„ä½æ•°ä¹Ÿä¼šå¢å¤§ï¼Œä½†<strong>è‡³å¤š log æ¬¡</strong>ã€‚å› æ­¤è¡Œçš„ä½æ•°æ€»å˜åŒ–æ¬¡æ•°ä¸º O(n log10^9)ï¼Œå› æ­¤å¯ä»¥æ±‚å‡ºæ¯ä¸€è¡Œçš„ä½æ•°ï¼Œè¿™ä¸ªå¤§æ¦‚äºŒåˆ†ä»€ä¹ˆçš„çš†å¯å§ã€‚</p><p>ç„¶åå¯¹äºè¯¢é—®ï¼ŒäºŒåˆ†è¡Œï¼ŒäºŒåˆ†åˆ—ï¼Œå†ç”¨ä¸»å¸­æ ‘æˆ–è€…ç¦»çº¿æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ä¸€ä¸‹å§ï¼Œæˆ‘ä¹Ÿä¸ä¼šï¼Œå’•å’•ã€‚</p><h2 id="I"><a href="#I" class="headerlink" title="I"></a>I</h2><hr><p>æ²¡çœ‹æ‡‚ï¼Œå’•å’•</p><h2 id="J"><a href="#J" class="headerlink" title="J"></a>J</h2><hr><p>è€ƒè™‘æœ€ç»ˆæ£‹ç›˜æ¯è¡Œæ¯åˆ—ä¸ä¼šè¶…è¿‡ 1 ä¸ªæ£‹å­ï¼Œä¸”æ‰€æœ‰ç•™åˆ°æœ€åçš„æ£‹å­éƒ½æ˜¯åœ¨åˆå§‹ä½ç½®ä¸Š</p><p>æƒ³åˆ°äºŒåˆ†å›¾åŒ¹é…ã€‚æœ€å¤šç•™ä¸‹æ¥ï¼Œæ˜¯å¹³é¢æœ€å¤§ç‹¬ç«‹é›†é—®é¢˜ï¼Œè¡Œåˆ—å»ºç‚¹è¿è¾¹ï¼Œè·‘äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ã€‚</p><p>é‚£ä¹ˆæœ€å°‘ç•™ä¸‹æ¥å‘¢ï¼Ÿå¹¶æŸ¥é›†ï¼Œå°†æ‰€æœ‰èƒ½äº’ç›¸åƒçš„æ£‹å­è¿ä¸€æ¡è¾¹ï¼Œç­”æ¡ˆå°±æ˜¯è¿é€šå—æ•°ã€‚</p><h2 id="K"><a href="#K" class="headerlink" title="K"></a>K</h2><hr><p>äºŒç»´ FFTï¼Œå‘Šè¾ï¼Œå’•å’•</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ZJU-ACM 7.23 F ä»¥åŠç±»ä¼¼æ¨¡å‹æ€»ç»“</title>
      <link href="2020/07/26/ZJU-ACM%207.23%20F%20%E4%BB%A5%E5%8F%8A%E7%B1%BB%E4%BC%BC%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/"/>
      <url>2020/07/26/ZJU-ACM%207.23%20F%20%E4%BB%A5%E5%8F%8A%E7%B1%BB%E4%BC%BC%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>åœ¨è®²æ­¤é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li>n ä¸ªç‚¹çš„æœ‰æ ‡å·æ— å‘è¿é€šå›¾è®¡æ•°ï¼ˆpoj1737ï¼‰</li><li>å·¦è¾¹ n ä¸ªç‚¹ã€å³è¾¹ m ä¸ªç‚¹çš„æœ‰æ ‡å·è¿é€šäºŒåˆ†å›¾è®¡æ•°</li></ul><p>æˆ‘ä»¬é‡‡å– dp æ¥è§£å†³è¿™ä¸€ç±»å›¾çš„è®¡æ•°é—®é¢˜ã€‚</p><p>f[n] è¡¨ç¤º n ä¸ªç‚¹éƒ½å’Œç‚¹ 1 ç›¸è¿çš„è¿é€šå›¾æ•°ï¼Œg[n] è¡¨ç¤º n ä¸ªç‚¹çš„å›¾æ•°</p><p>æ˜¾ç„¶ $f[n] = g[n] - \sum\limits_{i = 1}^{n - 1} C(n - 1, i - 1) * f[i] * g[n - i]$</p><p>åé¢è¿™ä¸€å¨æ˜¯ä¸è¿é€šçš„å›¾æ•°ï¼Œä¸ºäº†é˜²æ­¢é‡å¤è®¡æ•°ï¼Œæˆ‘ä»¬æšä¸¾<strong>ä¸ç‚¹ 1 ç›¸è¿</strong>çš„å—ã€‚</p><p>é‚£ä¹ˆç¬¬äºŒä¸ªé—®é¢˜ä¹Ÿæ˜¯ä¸€æ ·çš„å¥—è·¯ï¼Œf[n, m] è¡¨ç¤ºå·¦è¾¹ n ä¸ªç‚¹ã€å³è¾¹ m ä¸ªç‚¹éƒ½å’Œå·¦è¾¹ç¬¬ 1 ä¸ªç‚¹ç›¸è¿çš„è¿é€šå›¾æ•°ï¼Œg[n, m] è¡¨ç¤ºå·¦ n å³ m çš„å›¾æ•°, $f[n, m] = g[n, m] - \sum\limits_{i = 1}^{n - 1} \sum\limits_{j = 1}^{m} C(n - 1, i - 1) * C(m, j) * f[i, j] * g[n - i, m - j]$</p><p>æ˜¾ç„¶ä¸Šé¢è¿™ä¸¤ä¸ªæŸ¿å­éƒ½æ˜¯å·ç§¯å½¢å¼ï¼Œå¯ä»¥ç”¨ FTT/NTT ä¼˜åŒ–ã€‚</p><hr><p>å›åˆ°æœ¬é¢˜ï¼</p><p>f[n, m] è¡¨ç¤º n ä¸ªç‚¹ m æ¡è¾¹çš„è¿é€šå›¾æ•°</p><p>$f[n, m] = g[n, m] - \sum\limits_{i = 1}^{n - 1} \sum\limits_{j = 1}^m C(n - 1, i - 1) * f[i, j] * g[n - i, m - j]$</p><p>è¿™ä¹Ÿæ˜¯å·ç§¯å½¢å¼ï¼Œä½†æ˜¯ NTT æ˜¯ O(n^4 logn) çš„ã€‚è€ƒè™‘æˆ‘ä»¬é‡å¤è®¡ç®—äº† DFT å’Œ IDFT å¾ˆå¤šæ¬¡ï¼Œä¿ç•™ f çš„ DFT å½¢å¼ï¼ˆç‚¹å€¼å½¢å¼ï¼‰ï¼Œå°±å¯ä»¥ä¼˜åŒ–åˆ° O(n^4 logn)ã€‚æ®è¯´å¡å¡å¸¸å°±èƒ½è¿‡ï¼Œä½†æ˜¯ TLE äº†= = å‡è£… AC</p><p>ï¼ˆæŒ‚ä¸€ä¸ª<a href="https://www.kdocs.cn/l/sfiEGXVVWPTR?f=201" target="_blank" rel="noopener">å®˜æ–¹é¢˜è§£</a>ï¼Œæˆ‘æ²¡çœ‹æ‡‚ F çš„å¤æ‚åº¦åˆ†æï¼Œï¼Œå’•å’•ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(2)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (register int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">110</span>, M = <span class="number">2e4</span> + <span class="number">10</span>, mod = <span class="number">998244353</span>, G = <span class="number">3</span>, G1 = (mod + <span class="number">1</span>) / G;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, m, lim = <span class="number">1</span>;</span><br><span class="line">ll fac[M], inv[M], r[M], h[M], f[N][M], g[N][M], c[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">quick_pow</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ret = ret * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">    &#125; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    fac[<span class="number">0</span>] = inv[<span class="number">0</span>] = inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) fac[i] = fac[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">    rep(i, <span class="number">2</span>, m) inv[i] = (mod - mod / i) * inv[mod % i] % mod;</span><br><span class="line">    rep(i, <span class="number">2</span>, m) inv[i] = inv[i - <span class="number">1</span>] * inv[i] % mod;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (lim &lt; m * <span class="number">2</span>) lim &lt;&lt;= <span class="number">1</span>, ++l;</span><br><span class="line">    rep(i, <span class="number">0</span>, lim - <span class="number">1</span>) r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">    c[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        c[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        rep(j, <span class="number">1</span>, n)</span><br><span class="line">            c[i][j] = (c[i - <span class="number">1</span>][j] + c[i - <span class="number">1</span>][j - <span class="number">1</span>]) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">C</span><span class="params">(ll n, ll m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fac[n] * inv[m] % mod * inv[n - m] % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">NTT</span><span class="params">(ll a[], <span class="keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">0</span>, lim - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> (i &lt; r[i]) swap(a[i], a[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; lim; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        ll W = quick_pow(op == <span class="number">1</span> ? G : G1, (mod - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; lim; j += (mid &lt;&lt; <span class="number">1</span>)) &#123;</span><br><span class="line">            ll w = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k++, w = w * W % mod) &#123;</span><br><span class="line">                ll x = a[j + k], y = w * a[j + k + mid] % mod;</span><br><span class="line">                a[j + k] = (x + y) % mod, a[j + k + mid] = (x - y + mod) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">-1</span>) &#123;</span><br><span class="line">        ll Inv = quick_pow(lim, mod - <span class="number">2</span>);</span><br><span class="line">        rep(i, <span class="number">0</span>, lim - <span class="number">1</span>) a[i] = a[i] * Inv % mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;n);</span><br><span class="line">    m = n * (n - <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">    init();</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">0</span>, i * (i - <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line">            g[i][j] = C(i * (i - <span class="number">1</span>) / <span class="number">2</span>, j);</span><br><span class="line">        NTT(g[i], <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">0</span>, lim - <span class="number">1</span>) &#123;</span><br><span class="line">            h[j] = <span class="number">0</span>;</span><br><span class="line">            rep(k, <span class="number">1</span>, i - <span class="number">1</span>)</span><br><span class="line">                h[j] = (h[j] + c[i - <span class="number">1</span>][k - <span class="number">1</span>] * f[k][j] % mod * g[i - k][j] % mod) % mod;  <span class="comment">// ä¿ç•™ DFT å½¢å¼ï¼Œçœä¸€ä¸ª log</span></span><br><span class="line">            f[i][j] = (g[i][j] - h[j] + mod) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    NTT(f[n], <span class="number">-1</span>);</span><br><span class="line">    rep(i, <span class="number">0</span>, m) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, f[n][i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> NTTä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 ç™¾åº¦ä¹‹æ˜Ÿç¨‹åºè®¾è®¡å¤§èµ› - åˆèµ›ï¼ˆBï¼‰</title>
      <link href="2020/07/26/2020%20%E7%99%BE%E5%BA%A6%E4%B9%8B%E6%98%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%A4%A7%E8%B5%9B%20-%20%E5%88%9D%E8%B5%9BB/"/>
      <url>2020/07/26/2020%20%E7%99%BE%E5%BA%A6%E4%B9%8B%E6%98%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%A4%A7%E8%B5%9B%20-%20%E5%88%9D%E8%B5%9BB/</url>
      
        <content type="html"><![CDATA[<p>A B C å‡ä¸ºæ°´é¢˜ï¼ˆAå®ƒå¡æˆ‘ç²¾åº¦ï¼å¿…é¡»æ•´å‹å¤„ç†ï¼Œåäº†</p><h2 id="D"><a href="#D" class="headerlink" title="D"></a>D</h2><hr><p>æˆ‘æ˜¯ 10^5 æšä¸¾ï¼Œå¯ä»¥è¿‡ï¼Œä½†æ˜¯æ›´æ­£ç»çš„è§£æ³•æ˜¯çŠ¶å‹ dp é˜¿ã€‚ã€‚</p><h2 id="E"><a href="#E" class="headerlink" title="E"></a>E</h2><hr><p>è¿™é¢˜ä¸å¯¹åŠ²ï¼è¿™ï¼Œè¿™ä¸æ˜¯ï¼ˆç®€åŒ–ç‰ˆçš„ï¼‰ç¬¬ä¸€åœºçš„ G å˜›ï¼è´¹ç”¨æµè£¸é¢˜</p><h2 id="F"><a href="#F" class="headerlink" title="F"></a>F</h2><hr><p>è¿™çœ‹ä¸Šå»åƒä¸€é“å‚»*é¢˜ï¼Œä¸æ˜¯å—ä¸æ˜¯å—ä¸æ˜¯å—ï¼ˆæœ‰è¯ˆ</p><p>å’•å’•</p><h2 id="G"><a href="#G" class="headerlink" title="G"></a>G</h2><hr><p>å¤§è§‚å¯Ÿé¢˜</p><p>é¦–å…ˆæˆ‘ä»¬çŸ¥é“ Alice å›¤é¢˜æ˜¯ä¸ºäº†è€½è¯¯ Bob çš„æ—¶é—´</p><p>è‹¥ Alice èƒ½åœ¨ \sum_{i = 1}^p {b_i} çš„æ—¶é—´å†…å†™å®Œç¬¬ p é¢˜ï¼Œå°±å¯ä»¥æ‹¿åˆ° 1 åˆ†ï¼Œå› ä¸ºå¥¹å¯ä»¥ç­‰ Bob åˆšå¥½å†™å®Œç¬¬ p é¢˜çš„æ—¶å€™æäº¤</p><ul><li>é‚£ä¹ˆ Bob æŒ‰é¡ºåºå†™äº†æ‰€æœ‰é¢˜ï¼ï¼ˆå¥½æƒ¨é˜¿</li></ul><p>è®¾ Alice èƒ½æ‹¿ 1 åˆ†çš„é¢˜çš„é›†åˆä¸º Sï¼Œæ˜¾ç„¶ Alice æŒ‰ç¼–å·ä»å°åˆ°å¤§åš S ä¸­çš„é¢˜æœ€ä¼˜ï¼Œå› ä¸ºå¯¹åé¢é¢˜çš„å½±å“æœ€å°‘</p><ul><li>é‚£ä¹ˆé¡ºåºè¿™ä¸ªéš¾æçš„ä¸œè¥¿å°±è¢«è§£å†³äº†ï¼</li></ul><p>ç„¶åå°±å¯ä»¥ dp äº†ï¼Œè€ƒè™‘åˆ° n åªæœ‰ 2000ï¼Œæˆ‘ä»¬è®¾è®¡ n^2 çš„ dp</p><p>æ˜¾ç„¶é‡è¦é‡å°±ä¸‰ä¸ªï¼šä½ç½®ï¼Œåˆ†æ•°ï¼Œæ—¶é—´ï¼Œå…¶ä¸­æ—¶é—´çš„èŒƒå›´å¾ˆå¤§</p><p>f[i, j] è¡¨ç¤ºå‰ i é“é¢˜ï¼ŒAlice æ‹¿äº† j åˆ†çš„æœ€å°æ—¶é—´ï¼Œè½¬ç§»è€ƒè™‘æ˜¯å¦é€‰å½“å‰çš„é¢˜</p><h2 id="H"><a href="#H" class="headerlink" title="H"></a>H</h2><hr><p>ç¥é¢˜ï¼Œéœ€è¦ä»”ç»†æ€è€ƒ hanoi æ¸¸æˆçš„è¿›ç¨‹</p><p>æ˜¾ç„¶æ˜¯ï¼Œä¸ºäº†ç§»åŠ¨ä¸€ä¸ªå¤§ç›˜å­ï¼Œè®©å…¶ä»–å°ç›˜å­èšæ‹¢åˆ°ä¸€æ ¹æŸ±å­çš„è¿‡ç¨‹çš„é‡å¤ç‰ˆæœ¬ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æœ‰äº†å­é—®é¢˜</p><p>ç„¶ååé¢å°±çœ‹ä¸æ‡‚äº†ï¼Œå’•å’•</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AGC 016 é¢˜è§£</title>
      <link href="2020/07/24/AGC%20016%20%E9%A2%98%E8%A7%A3/"/>
      <url>2020/07/24/AGC%20016%20%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>016 çš„éš¾åº¦æ¯” 015 é«˜ ~</p><p>æ™ºå•†è¢«å®Œè™äº†ã€‚ã€‚ã€å¤±å»æ¢¦æƒ³.jpgã€‘</p><h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><hr><p>æšä¸¾æœ€ç»ˆå˜æˆå“ªä¸ªå­—æ¯</p><h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><hr><p>å®¹æ˜“å‘ç° min ä¸ max ç›¸å·®ä¸è¶…è¿‡ 1</p><p>è‹¥ min = maxï¼Œåˆ™è¦ä¹ˆæ¯ç§é¢œè‰²éƒ½æ˜¯ 1 ä¸ªï¼Œè¦ä¹ˆæ¯ç§é¢œè‰²éƒ½æœ‰ 2 ä¸ªä»¥ä¸Š</p><p>è‹¥ min + 1 = maxï¼Œåˆ†ç±»è®¨è®ºå°±å¥½äº†ï¼Œæ ·ä¾‹å¤§è‰¯å¿ƒ qvq</p><h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><hr><p>é€è¿‡æ ·ä¾‹ 2 æˆ‘ä»¬çœ‹å‡ºï¼Œè‹¥ n æ˜¯ h çš„å€æ•°ä¸” m æ˜¯ w çš„å€æ•°ï¼Œä¸å¯èƒ½æ„é€ </p><p>é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥ä½¿å¾— n % hã€m % w çš„éƒ¨åˆ†çš„è´¡çŒ®å°½é‡å¤§ã€‚è¿™è¾¹æä¾›ä¸€ç§ä¹±ææ€è·¯ï¼šå®šä¸€ä¸ªè¾ƒå¤§çš„å€¼ä¸º dï¼Œå¯¹äº (h å€æ•°ï¼Œw å€æ•°) çš„ä½ç½®æ”¾ -(hw - 1)d - 1ï¼Œå…¶ä½™ä½ç½®æ”¾ d</p><h2 id="D"><a href="#D" class="headerlink" title="D"></a>D</h2><hr><p>ä¸é”™çš„æ€ç»´é¢˜</p><p>å®¹æ˜“å‘ç°ï¼Œè‹¥å°†å¼‚æˆ–å€¼è§†ä¸º n + 1 ä½çš„åºåˆ—å…ƒç´ ï¼Œæ•´ä¸ªæ“ä½œå°±ç­‰ä»·äºä¸æ–­å°† x (1 &lt;= x &lt;= n) ä½ç½®ä¸ n + 1 ä½ç½®çš„å…ƒç´ äº¤æ¢</p><p>é¢˜è§£æ–¹æ³•éå¸¸ç¥ä»™ï¼š</p><p>è‹¥ ai != biï¼Œåˆ™ä» ai å‘ bi è¿è¾¹</p><p>æœ€ç»ˆç­”æ¡ˆ = æ€»è¾¹æ•° + è¿é€šå—æ•° - 1</p><p>æ³¨æ„è¿™é‡Œçš„æ€»è¾¹æ•°æ˜¯ä¸è€ƒè™‘ n + 1 çš„</p><p>å¤§å°ä¸º x è¿é€šå—éœ€è¦ x - 1 æ¬¡ï¼Œå—ä¸å—ä¹‹é—´ n + 1 ä½ç½®çš„è½¬æ¢éœ€è¦ 1</p><p>å¯¹äºç¬¬ n + 1 ä¸ªä½ç½®å•ç‹¬è€ƒè™‘ï¼Œè‹¥å®ƒç‹¬ä¸€ä¸ªç‚¹åˆ™æ˜¯è¦è€ƒè™‘åˆ°è¿é€šå—é‡Œçš„</p><p>æ­£ç¡®æ€§å¯ä»¥åˆ†ç±»è®¨è®ºä¸€ä¸‹ï¼Œæ¯”è¾ƒæ˜¾ç„¶ã€‚</p><h2 id="E"><a href="#E" class="headerlink" title="E"></a>E</h2><hr><p>ä¼ªæ¦‚ç‡é¢˜ï¼Œè¶…çº§æ— æ•Œå¦™ï¼è§£æ³•å®¹æ˜“ç†è§£ï¼Œå´æƒ³ä¸åˆ°å“‡ã€‚ã€‚</p><p>è€ƒè™‘é’¦å®šä¸€åªæ´»åˆ°æœ€åçš„é¸¡ï¼Œè®¾å®ƒä¸º iã€‚</p><p>å®ƒèƒ½æ´»ç€ï¼Œå¿…ç„¶æœ‰å…¶ä»–çš„é¸¡ä¸ºå®ƒè€Œæ­»ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç»´æŠ¤ä¸€ä¸ªé›†åˆï¼Œè¡¨ç¤ºä¸º i æ­»çš„é¸¡æœ‰å“ªäº›ã€‚</p><p>è€ƒè™‘æ—¶é—´å€’æµã€‚æ¯å½“é›†åˆé‡Œçš„é¸¡å‡ºç°æ—¶ï¼Œæˆ‘ä»¬å°†å¦ä¸€åªé¸¡åŠ å…¥é›†åˆï¼›è‹¥å¦ä¸€åªé¸¡å·²ç»åœ¨é›†åˆä¸­ï¼Œé‚£ä¹ˆè¿™åªé’¦å®šçš„é¸¡æ´»ä¸åˆ°æœ€åã€‚</p><p>æšä¸¾ä¸¤åªæ´»åˆ°æœ€åçš„é¸¡ï¼Œåˆ¤ä»–ä»¬çš„é›†åˆæ˜¯å¦äº¤ï¼Œè‹¥äº¤åˆ™æ— è§£ï¼Œå› ä¸ºä¸€åªé¸¡ä¸èƒ½æ­»ä¸¤æ¬¡ã€‚</p><p>çœŸå°± ç•™ç€ä½ æ˜¯ä¸ºäº†ç‚–äº†ä½ å‘—ï¼ˆ</p><p>å…·ä½“å®ç°ç”¨ bitsetï¼ŒO(nm + n^3 / 32)ï¼Œæ³¨æ„ bitset &amp; æ“ä½œæ˜¯ O(n) çš„</p><h2 id="F"><a href="#F" class="headerlink" title="F"></a>F</h2><hr><p>sg(1) ^ sg(2) != 0 ä¸å¥½è€ƒè™‘ï¼Œæ­£éš¾åˆ™åï¼Œæˆ‘ä»¬ç”¨ 2^m - ( sg(1) = sg(2) çš„æ–¹æ¡ˆæ•° )</p><p>è€ƒè™‘è¾¹é›†æ˜¾ç„¶ä¸ç°å®ï¼Œæˆ‘ä»¬è€ƒè™‘ç‚¹é›†ã€‚</p><p>å°† DAG ä¸­çš„ç‚¹æŒ‰ç…§ sg å€¼åˆ†å±‚ï¼Œæ˜¾ç„¶ç‚¹ 1 å’Œç‚¹ 2 åœ¨åŒä¸€å±‚</p><p>æ ¹æ®åˆ†å±‚ï¼Œæƒ³åˆ°å­é›†dpï¼Œf[S] è¡¨ç¤ºåªè€ƒè™‘ S è¿™ä¸ªç‚¹é›†ä½¿å¾— sg(1) = sg(2) çš„æ–¹æ¡ˆæ•°ï¼ˆæ³¨æ„ S å¿…é¡»åŒæ—¶åŒ…å«æˆ–ä¸åŒ…å« 1 å’Œ 2ï¼‰</p><p>è½¬ç§»å°±æšä¸¾ S çš„å­é›† Tï¼Œè®¾ U ä¸ºè¡¥é›†ï¼Œå…¶ä¸­ T ä¸­ sg å€¼éƒ½ä¸ä¸º 0ï¼ŒU ä¸­ sg å€¼éƒ½ä¸º 0ï¼ˆU å…¶å®å°±æ˜¯åº•å±‚ç‚¹é›†ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ 1 å’Œ 2 å¿…é¡»åŒæ—¶åœ¨ T ä¸­æˆ–è€… U ä¸­</p><p>ç»Ÿè®¡æ–¹æ¡ˆçš„å››æ¡è§„åˆ™ï¼š</p><ul><li>U ä¸èƒ½å†…éƒ¨è¿è¾¹</li><li>T å†…éƒ¨å°±æ˜¯ f[T]</li><li>T ä¸­æ¯ä¸ªç‚¹éƒ½è‡³å°‘æœ‰ä¸€æ¡åˆ° U çš„è¾¹ï¼ˆT ä¸­ sg å€¼ += 1ï¼‰</li><li>U åˆ° T éšä¾¿è¿</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ™å¤§ACMç¬¬ä¸‰è½®é€‰è®²</title>
      <link href="2020/07/22/%E6%B5%99%E5%A4%A7ACM%E7%AC%AC%E4%B8%89%E8%BD%AE%E9%80%89%E8%AE%B2/"/>
      <url>2020/07/22/%E6%B5%99%E5%A4%A7ACM%E7%AC%AC%E4%B8%89%E8%BD%AE%E9%80%89%E8%AE%B2/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.kdocs.cn/l/srN6cUALrHvX?f=201" target="_blank" rel="noopener">7.21 é¢˜è§£</a></p><h2 id="7-21-A"><a href="#7-21-A" class="headerlink" title="[7.21 A]"></a>[7.21 A]</h2><hr><p>æ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—å•Šå•Šå•Šå•Šï¼æ‰€ä»¥å½“ç„¶ S(i, j) + S(i, j + 1) = S(i, j + 2)ï¼Œç²¾å¦™ã€‚</p><p>ä½†æ˜¯åé¢çš„çŸ©é˜µè®¾è®¡å°±ä¸çŸ¥é“äº†ï¼Œå’•å’•ã€‚</p><p>upd: è¿˜æœ‰å¦ä¸€ç§<a href="https://www.cnblogs.com/Flying2018/p/13356497.html" target="_blank" rel="noopener">ç¥ä»™åšæ³•</a></p><p>upd: è¿˜æœ‰ä¸€ç§ <a href="https://www.cnblogs.com/Wendigo/p/13357673.html" target="_blank" rel="noopener">çŸ©é˜µ + å€å¢</a></p><p><a href="https://www.kdocs.cn/l/shvH8qsctES4?f=201" target="_blank" rel="noopener">7.22 é¢˜è§£</a></p><h2 id="7-22-E"><a href="#7-22-E" class="headerlink" title="[7.22 E]"></a>[7.22 E]</h2><hr><p>å®åœ¨æ˜¯å¤ªå¦™äº†orzã€‚ã€‚å†è¯´ä¸€æ¬¡ï¼Œæšä¸¾é¡ºåºè¦æƒ³åˆ°çŠ¶å‹å•Š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line">ll n, pos[<span class="number">25</span>][<span class="number">30</span>], dp[<span class="number">1</span> &lt;&lt; <span class="number">21</span>][<span class="number">30</span>], ans;</span><br><span class="line"><span class="comment">// pos[i, j] è¡¨ç¤ºæ¥ä¸Š i ä¸²å‰ 1 åœ¨ä½ç½® jï¼Œæ¥ä¸Šåçš„ä½ç½®</span></span><br><span class="line"><span class="comment">// dp[s, i] è¡¨ç¤ºå·²æ¥ä¸Šçš„ä¸²çš„é›†åˆä¸º sï¼Œ1 åœ¨ä½ç½® i çš„æ–¹æ¡ˆæ•°</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> len = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">        rep(j, <span class="number">0</span>, <span class="number">26</span>) &#123;  <span class="comment">// æšä¸¾æ¥ä¸Š i ä¸²å‰çš„ 1 åœ¨å“ªï¼ˆ 0 è¡¨ç¤º sum</span></span><br><span class="line">            pos[i][j] = j;</span><br><span class="line">            rep(k, <span class="number">1</span>, len) &#123;</span><br><span class="line">                <span class="keyword">if</span> (s[k] - <span class="string">'a'</span> + <span class="number">1</span> == pos[i][j]) pos[i][j] = <span class="number">0</span>;  <span class="comment">// ä¸ sum äº¤æ¢äº†</span></span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (!pos[i][j]) pos[i][j] = s[k] - <span class="string">'a'</span> + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(s, <span class="number">0</span>, (<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>) &#123;</span><br><span class="line">        rep(j, <span class="number">0</span>, <span class="number">26</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dp[s][j]) &#123;</span><br><span class="line">                rep(i, <span class="number">1</span>, n)</span><br><span class="line">                    <span class="keyword">if</span> (!(s &amp; (<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>))))</span><br><span class="line">                        dp[s | (<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>))][pos[i][j]] += dp[s][j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, <span class="number">26</span>) ans += dp[(<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>][i];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="7-22-F"><a href="#7-22-F" class="headerlink" title="[7.22 F]"></a>[7.22 F]</h2><hr><p>cf453b çš„åŠ å¼ºç‰ˆ</p><p>bi å¤§äº 100 æ˜¾ç„¶ä¸ä¼˜ï¼Œæ‰€ä»¥è€ƒè™‘ 100 ä»¥å†…çš„æ•°ã€‚</p><p>100 ä»¥å†…è´¨æ•°æœ‰ 25 ä¸ªï¼Œä¸èƒ½ç›´æ¥çŠ¶å‹ã€‚è€ƒè™‘åˆ° 50 ä»¥å†…çš„è´¨æ•°æœ‰ 15 ä¸ªï¼Œè€Œ 50 ä»¥ä¸Šçš„è´¨æ•°å¿…ç„¶åªä¼šå•ç‹¬å‡ºç°ä¸”è¶Šå°è¶Šå¥½ã€‚é€‰ ai å»åŒ¹é…ï¼Œæ›´å¤§ä¸€äº›çš„ ai æ˜¾ç„¶ä¸ä¼šæ›´å·®ã€‚</p><p>æ‰€ä»¥è€ƒè™‘å°† a ä»å°åˆ°å¤§æ’åºï¼Œæšä¸¾ iï¼Œå…ˆç”¨ 50 ä»¥å†…çš„è´¨æ•°å¤„ç†å‡ºå‰ i ä¸ªæ•°çš„ç»“æœï¼Œå†è€ƒè™‘è´ªå¿ƒé€‰å–å¤§äº 50 çš„è´¨æ•°ã€ä¸å n - i ä¸ªæ•°ä¸€ä¸€åŒ¹é…çš„ç»“æœã€‚</p><hr><p><a href="https://www.kdocs.cn/l/sfiEGXVVWPTR?f=201" target="_blank" rel="noopener">7.23 é¢˜è§£</a></p><h2 id="7-23-C"><a href="#7-23-C" class="headerlink" title="[7.23 C]"></a>[7.23 C]</h2><hr><p>åŸé¢˜æ˜¯ <a href="http://uoj.ac/contest/51/problem/513" target="_blank" rel="noopener">æ¸…æ‰«é“¶æ²³</a> ï¼</p><p>æˆ‘çš„é¢˜è§£æ˜¯<a href="https://imilyx.github.io/2020/07/27/[UOJ513]-%E6%B8%85%E6%89%AB%E9%93%B6%E6%B2%B3/" target="_blank" rel="noopener">è¿™ä¸ª</a></p><h2 id="7-23-D"><a href="#7-23-D" class="headerlink" title="[7.23 D]"></a>[7.23 D]</h2><hr><p>æ•°è®ºé¢˜ï¼Œå’•å’•</p><h2 id="7-23-E"><a href="#7-23-E" class="headerlink" title="[7.23 E]"></a>[7.23 E]</h2><hr><p>æ¦‚ç‡ + ç”Ÿæˆå‡½æ•°ï¼Œå’•å’•</p><h2 id="7-23-F"><a href="#7-23-F" class="headerlink" title="[7.23 F]"></a>[7.23 F]</h2><hr><p>æˆ‘å†™çš„é¢˜è§£æ˜¯<a href="https://imilyx.github.io/2020/07/26/ZJU-ACM%207.23%20F%20%E4%BB%A5%E5%8F%8A%E7%B1%BB%E4%BC%BC%E6%A8%A1%E5%9E%8B%E6%80%BB%E7%BB%93/" target="_blank" rel="noopener">è¿™ä¸ª</a></p><p>æ®è¯´è¿˜èƒ½æ–¯ç‰¹æ—åæ¼”ï¼Ÿå’•å’•</p><h2 id="7-23-G"><a href="#7-23-G" class="headerlink" title="[7.23 G]"></a>[7.23 G]</h2><hr><p>burnsideå¼•ç† + ç”Ÿæˆå‡½æ•°ï¼Œç‰¹åˆ«ç¥ä»™çš„é¢˜ï¼Œå’•å’•</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SDOI2017é€‰è®²</title>
      <link href="2020/07/21/SDOI2017%E9%80%89%E8%AE%B2/"/>
      <url>2020/07/21/SDOI2017%E9%80%89%E8%AE%B2/</url>
      
        <content type="html"><![CDATA[<h2 id="åºåˆ—è®¡æ•°"><a href="#åºåˆ—è®¡æ•°" class="headerlink" title="åºåˆ—è®¡æ•°"></a>åºåˆ—è®¡æ•°</h2><hr><p>è‡³å°‘æœ‰ä¸€ä¸ªæ•°æ˜¯è´¨æ•°çš„æƒ…å†µ = å¿½ç•¥è´¨æ•°çš„æƒ…å†µ - æ— è´¨æ•°çš„æƒ…å†µï¼ŒçŸ©ä¹˜åŠ é€Ÿ</p><h2 id="æ–°ç”Ÿèˆä¼š"><a href="#æ–°ç”Ÿèˆä¼š" class="headerlink" title="æ–°ç”Ÿèˆä¼š"></a>æ–°ç”Ÿèˆä¼š</h2><hr><p>å¾ˆè£¸çš„åˆ†æ•°è§„åˆ’ + kmæˆ–è´¹ç”¨æµåˆ¤æ˜¯å¦åˆæ³•ï¼Œæˆ‘ä¸ä¼škm qwqã€‚ã€‚</p><p>ç½‘ç»œæµï¼Œè¦è®¡ç®—ç©ºé—´å•Šã€‚ã€‚ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e4</span> + <span class="number">5</span>, inf = <span class="number">1e9</span>;  <span class="comment">// ç©ºé—´è¦å¼€è¶³</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-9</span>;</span><br><span class="line"><span class="keyword">int</span> n, a[<span class="number">105</span>][<span class="number">105</span>], b[<span class="number">105</span>][<span class="number">105</span>], S, T;</span><br><span class="line"><span class="keyword">int</span> to[N], fr[N], lnk[N], cnt, nxt[N], cap[N], pre[N], rest[N];</span><br><span class="line"><span class="keyword">bool</span> inq[N];</span><br><span class="line"><span class="keyword">double</span> val[N], dis[N], ans;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> c, <span class="keyword">double</span> v)</span> </span>&#123;</span><br><span class="line">    ++cnt;</span><br><span class="line">    to[cnt] = y, fr[cnt] = x, nxt[cnt] = lnk[x], lnk[x] = cnt, cap[cnt] = c, val[cnt] = v;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> S, <span class="keyword">int</span> T, <span class="keyword">int</span> &amp;flow, <span class="keyword">double</span> &amp;cost)</span> </span>&#123;</span><br><span class="line">    rep(i, S, T) dis[i] = <span class="number">-1e18</span>, inq[i] = pre[i] = <span class="number">0</span>;</span><br><span class="line">    inq[S] = <span class="number">1</span>, rest[S] = inf, pre[S] = <span class="number">0</span>, dis[S] = <span class="number">0</span>;</span><br><span class="line">    q.push(S);</span><br><span class="line">    <span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front(); q.pop(); inq[x] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = to[i];</span><br><span class="line">            <span class="keyword">if</span> (cap[i] &gt; <span class="number">0</span> &amp;&amp; dis[y] &lt; dis[x] + val[i]) &#123;</span><br><span class="line">                dis[y] = dis[x] + val[i];</span><br><span class="line">                pre[y] = i;</span><br><span class="line">                rest[y] = min(rest[x], cap[i]);</span><br><span class="line">                <span class="keyword">if</span> (!inq[y]) &#123;</span><br><span class="line">                    inq[y] = <span class="number">1</span>, q.push(y);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (dis[T] == <span class="number">-1e18</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    flow += rest[T];</span><br><span class="line">    cost += dis[T] * rest[T];</span><br><span class="line">    <span class="keyword">int</span> x = T;</span><br><span class="line">    <span class="keyword">while</span> (x != S) &#123;</span><br><span class="line">        cap[pre[x]] -= rest[T], cap[pre[x] ^ <span class="number">1</span>] += rest[T];</span><br><span class="line">        x = fr[pre[x]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chk</span><span class="params">(<span class="keyword">double</span> mid)</span> </span>&#123;</span><br><span class="line">    cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">memset</span>(lnk, <span class="number">0</span>, <span class="keyword">sizeof</span>(lnk));</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        add(S, i, <span class="number">1</span>, <span class="number">0</span>), add(i, S, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        add(i + n, T, <span class="number">1</span>, <span class="number">0</span>), add(T, i + n, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">1</span>, n) &#123;</span><br><span class="line">            <span class="keyword">double</span> v = a[i][j] - b[i][j] * mid;</span><br><span class="line">            add(i, j + n, <span class="number">1</span>, v);</span><br><span class="line">            add(j + n, i, <span class="number">0</span>, -v);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> flow = <span class="number">0</span>; <span class="keyword">double</span> cost = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (spfa(S, T, flow, cost));</span><br><span class="line">    <span class="keyword">return</span> cost &gt;= <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    S = <span class="number">0</span>, T = <span class="number">2</span> * n + <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) rep(j, <span class="number">1</span>, n) <span class="built_in">cin</span> &gt;&gt; a[i][j];</span><br><span class="line">    rep(i, <span class="number">1</span>, n) rep(j, <span class="number">1</span>, n) <span class="built_in">cin</span> &gt;&gt; b[i][j];</span><br><span class="line">    <span class="keyword">double</span> l = <span class="number">0</span>, r = <span class="number">1e9</span>;</span><br><span class="line">    <span class="keyword">while</span> (r - l &gt; eps) &#123;</span><br><span class="line">        <span class="keyword">double</span> mid = (l + r) / <span class="number">2.0</span>;</span><br><span class="line">        <span class="keyword">if</span> (chk(mid)) ans = mid, l = mid;</span><br><span class="line">        <span class="keyword">else</span> r = mid;</span><br><span class="line">    &#125; <span class="built_in">printf</span>(<span class="string">"%.6lf\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¡¬å¸æ¸¸æˆ"><a href="#ç¡¬å¸æ¸¸æˆ" class="headerlink" title="ç¡¬å¸æ¸¸æˆ"></a>ç¡¬å¸æ¸¸æˆ</h2><hr><p>ç¥ä»™é¢˜ï¼Œæƒ³ä¸å‡ºæ¥orz</p><p>ç›´æ¥ AC è‡ªåŠ¨æœº + é«˜æ–¯æ¶ˆå…ƒæ˜¯ O((nm)^3) çš„ï¼Œå› ä¸ºæœ‰ nm ä¸ªæ–¹ç¨‹</p><p>æœ€ç»ˆå¤æ‚åº¦åº”è¯¥åœ¨ O(n^3) ä»¥å†…ï¼Œæ–¹ç¨‹æ•°åº”è¯¥æ˜¯ O(n) çº§åˆ«çš„</p><p>å…³é”®ç‚¹æ˜¯ç”¨ N æ¥è¡¨ç¤ºæ²¡æœ‰äººè·èƒœçš„çŠ¶æ€ï¼Œå°†æ–¹ç¨‹æ•°å‹ç¼©åˆ° n + 1 ä¸ªï¼Œç„¶åè§£æ–¹ç¨‹</p><p>ä¾‹å¦‚ï¼šA = TTH, B = HTT</p><p>N + TTH = Aèµ¢ + (Bèµ¢ + H) + (Bèµ¢ + TH)</p><p>0.125N = Aèµ¢ + 0.75Bèµ¢</p><p>n + 1 ä¸ªå˜é‡ï¼Œn + 1 ä¸ªæ–¹ç¨‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, x, y) for (int i = x; i &gt;= y; i--)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">305</span>;</span><br><span class="line"><span class="keyword">const</span> ull P = <span class="number">131</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-7</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">double</span> g[N][N], bit2[N], x[N];</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line">ull pre[N][N], sub[N][N], pw[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Gauss</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">int</span> id = i;</span><br><span class="line">        rep(j, i, n) <span class="keyword">if</span> (g[j][i] &gt; eps) id = j;</span><br><span class="line">        swap(g[i], g[id]);</span><br><span class="line">        rep(j, i + <span class="number">1</span>, n) &#123;</span><br><span class="line">            <span class="keyword">double</span> t = g[j][i] / g[i][i];</span><br><span class="line">            rep(k, i + <span class="number">1</span>, n + <span class="number">1</span>) g[j][k] -= g[i][k] * t;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    per(i, n, <span class="number">1</span>) &#123;</span><br><span class="line">        x[i] = g[i][n + <span class="number">1</span>] / g[i][i];</span><br><span class="line">        rep(j, <span class="number">1</span>, i - <span class="number">1</span>) g[j][n + <span class="number">1</span>] -= g[i][n + <span class="number">1</span>] * (g[j][i] / g[i][i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    bit2[<span class="number">0</span>] = pw[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) bit2[i] = bit2[i - <span class="number">1</span>] * <span class="number">0.5</span>, pw[i] = pw[i - <span class="number">1</span>] * P;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">        rep(j, <span class="number">1</span>, m) &#123;</span><br><span class="line">            pre[i][j] = pre[i][j - <span class="number">1</span>] + (s[j] == <span class="string">'H'</span> ? <span class="number">1</span> : <span class="number">0</span>) * pw[j];</span><br><span class="line">            sub[i][j] = sub[i][j - <span class="number">1</span>] * P + (s[m - j + <span class="number">1</span>] == <span class="string">'H'</span> ? <span class="number">1</span> : <span class="number">0</span>) * P;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        g[i][n + <span class="number">1</span>] = -bit2[m];</span><br><span class="line">        rep(j, <span class="number">1</span>, n) &#123;</span><br><span class="line">            rep(a, <span class="number">1</span>, m) &#123;</span><br><span class="line">                <span class="keyword">if</span> (pre[i][a] == sub[j][a]) &#123;</span><br><span class="line">                    g[i][j] += bit2[m - a];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) g[n + <span class="number">1</span>][i] = <span class="number">1</span>;</span><br><span class="line">    g[n + <span class="number">1</span>][n + <span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">    Gauss(n + <span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">printf</span>(<span class="string">"%.10lf\n"</span>, x[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€ä¹ é¢˜é€‰è®²ã€‘æ•°å­¦2</title>
      <link href="2020/07/20/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91%E6%95%B0%E5%AD%A62/"/>
      <url>2020/07/20/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91%E6%95%B0%E5%AD%A62/</url>
      
        <content type="html"><![CDATA[<h2 id="Flowers-and-Chocolate"><a href="#Flowers-and-Chocolate" class="headerlink" title="Flowers and Chocolate"></a><a href="https://vjudge.net/problem/CodeForces-865G" target="_blank" rel="noopener">Flowers and Chocolate</a></h2><hr><p>ç”Ÿæˆå‡½æ•°é¢˜ï¼Œå¥½æƒ³åšå‡ºæ¥å•Šï¼Œï¼Œæ äº†ä¸€å¤©åŠäº†ï¼Œåªèƒ½å’•å’•</p><h2 id="åŠ æƒçº¦æ•°å’Œ"><a href="#åŠ æƒçº¦æ•°å’Œ" class="headerlink" title="åŠ æƒçº¦æ•°å’Œ"></a><a href="https://vjudge.net/problem/51Nod-1584" target="_blank" rel="noopener">åŠ æƒçº¦æ•°å’Œ</a></h2><hr><p>å’•å’•<br><a href="https://zybuluo.com/mayiyang/note/1725968" target="_blank" rel="noopener">é¢˜è§£</a></p><h2 id="æ¦‚ç‡å¥½é¢˜"><a href="#æ¦‚ç‡å¥½é¢˜" class="headerlink" title="æ¦‚ç‡å¥½é¢˜"></a><a href="https://vjudge.net/problem/51Nod-1667" target="_blank" rel="noopener">æ¦‚ç‡å¥½é¢˜</a></h2><hr><p>æ±‚ sum{a_i} &lt; sum{b_i} çš„æ–¹æ¡ˆæ•°ï¼Œå…¶ä¸­ a_i å’Œ b_i æœ‰å–å€¼èŒƒå›´</p><p>è€ƒè™‘åˆ° a_i å’Œ b_i æœ‰ä¸€ä¸ªä¸‹é™ lï¼Œå°†æŸ¿å­åŒ–ä¸º sum{l_i + x_i} &lt; sum{l_i + x_i} çš„å½¢å¼ï¼Œå…¶ä¸­ 0 &lt;= x_i &lt;= r_i</p><p>éš”æ¿æ³• + å®¹æ–¥å³å¯</p><h2 id="å°Qçš„é›†åˆ"><a href="#å°Qçš„é›†åˆ" class="headerlink" title="å°Qçš„é›†åˆ"></a><a href="https://vjudge.net/problem/51Nod-1778" target="_blank" rel="noopener">å°Qçš„é›†åˆ</a></h2><hr><p>çœ‹åˆ° n è¿™ä¹ˆå¤§ï¼Œæ¨¡æ•°å´åªæœ‰ 1e6 åº”è¯¥æƒ³åˆ° lucas å®šç†å•Š</p><p>m åˆæ˜¯è´¨æ•°ï¼Œ(T^k - (S - T)^k) % m æˆä¸€ä¸ªå‘¨æœŸä¸º m çš„æ•°åˆ—</p><p>ç„¶åä¸€å‘ä¹±æå°±å¥½äº†ï¼ˆ</p><h2 id="BBQ-Hard"><a href="#BBQ-Hard" class="headerlink" title="BBQ Hard"></a><a href="https://vjudge.net/problem/AtCoder-agc001_e" target="_blank" rel="noopener">BBQ Hard</a></h2><hr><p>C(Ai + Aj + Bi + Bj, Ai + Aj) å°±æ˜¯æ±‚ä» (0, 0) èµ°åˆ° (Ai + Aj, Bi + Bj) çš„æ–¹æ¡ˆæ•°</p><p>ç§»ä½ï¼Œå˜æˆæ±‚ä» (-Ai, -Bi) èµ°åˆ° (Aj, Bj) çš„æ–¹æ¡ˆæ•°</p><p>é‚£ä¹ˆå¯¹äºæ¯ä¸ªç‚¹ï¼Œæˆ‘ä»¬è®¡ç®—ä»å®ƒå·¦ä¸‹åŒºåŸŸèµ°ä¸Šæ¥çš„æ–¹æ¡ˆæ•°ä¹‹å’Œ</p><p>æ˜¾ç„¶ dp[i, j] = dp[i - 1, j] + dp[i, j - 1]ã€‚åæ ‡å€¼éƒ½å¾ˆå°ï¼Œå¯ä»¥æšä¸¾ã€‚æœ€ååˆ«å¿˜äº†å‡å» (-Ai, -Bi) å¯¹ (Ai, Bi) çš„è´¡çŒ®ã€‚</p><h2 id="Leftmost-Ball"><a href="#Leftmost-Ball" class="headerlink" title="Leftmost Ball"></a><a href="https://vjudge.net/problem/AtCoder-agc002_f" target="_blank" rel="noopener">Leftmost Ball</a></h2><hr><p>è½¬åŒ–ä¸€ä¸‹å°±æ˜¯æ±‚å·²æ”¾ç™½çƒæ•° &gt;= å·²æ”¾å½©çƒç§ç±»çš„æ–¹æ¡ˆæ•°ï¼Œå®¹æ˜“æƒ³åˆ°æ¯æ”¾ä¸€ç§é¢œè‰²å°±æŠŠ K ä¸ªå…¨æ”¾å®Œçš„æƒ³æ³•ã€‚</p><p>å…¶å®çœŸæ­£é‡è¦çš„åªæœ‰é‚£ n ä¸ªç™½çƒå’Œé‚£ n ä¸ªç¬¬ä¸€æ¬¡æ”¾ä¸‹çš„å½©çƒã€‚dpï¼Œf[i, j] è¡¨ç¤ºå·²æ”¾ i ç™½çƒï¼Œj ç§å½©çƒçš„æ–¹æ¡ˆæ•°ã€‚</p><h2 id="Card-game-for-three"><a href="#Card-game-for-three" class="headerlink" title="Card game for three"></a><a href="https://vjudge.net/problem/AtCoder-arc061_d" target="_blank" rel="noopener">Card game for three</a></h2><hr><p>å¹¶ä¸æ˜¯å¾ˆéš¾çš„é¢˜ï¼Œç¬¬ä¸€æ­¥æƒ³æ‡‚äº†åé¢å°±å¥½åŠäº†ã€‚</p><p>å°† aã€bã€c çš„èµ¢çœ‹ä½œåˆæŠ½äº†ä¸€å¼ å¡ï¼Œå³ b æŠ½äº†ç¬¬ m + 1 å¼ ï¼Œc æŠ½äº†ç¬¬ k + 1 å¼ ï¼Œè€Œ a æŠ½äº†ç¬¬ n å¼ ï¼ˆa å…ˆæ‰‹ï¼‰æšä¸¾ a èµ¢ä¹‹å‰ b å’Œ c å„æŠ½äº†å‡ å¼ å¡ï¼ŒåŒ–æŸ¿å­ + åˆ†ç±»è®¨è®ºå³å¯ã€‚</p><h2 id="Unicyclic-Graph-Counting"><a href="#Unicyclic-Graph-Counting" class="headerlink" title="Unicyclic Graph Counting"></a><a href="https://vjudge.net/problem/AtCoder-asaporo2_f" target="_blank" rel="noopener">Unicyclic Graph Counting</a></h2><hr><p><a href="https://www.cnblogs.com/zwfymqz/p/8869956.html" target="_blank" rel="noopener">pruferåºåˆ—é‡ä¿®</a></p><p>åº¦æ•°å»ºå›¾ï¼Œå®¹æ˜“æƒ³åˆ° prufer åºåˆ—ï¼Œä½†è¿™æ˜¯åŸºç¯æ ‘ã€‚</p><p>å®šä¹‰æœ¬é¢˜çš„ prufer åºåˆ—ä¸ºå°†æ ‘åˆ å®Œåçš„ prufer åºåˆ—ï¼Œåªå‰©ä¸‹ä¸€ä¸ªç¯ å’Œè¿ç€ç¯çš„ç¼–å·æœ€å¤§çš„ç‚¹ã€‚</p><p>æƒ³åˆ°æ ‘ä¸ŠèŠ‚ç‚¹åœ¨ prufer åºåˆ—ä¸­å‡ºç°æ¬¡æ•°ä¸º deg - 1ï¼Œç¯ä¸Šåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹å‡ºç°æ¬¡æ•°ä¸º deg - 3ï¼Œå…¶ä»–éƒ½æ˜¯ deg - 2ï¼ˆç‰¹åˆ¤åªæœ‰ä¸€ä¸ªç¯çš„æƒ…å†µï¼‰ã€‚</p><p>ç¯å¤§å°ä¸º k æ—¶ï¼Œç¯æ’åˆ—æ•°ä¸º (k - 1)! / 2ï¼ˆç¯æœ‰æ—‹è½¬åŒæ„å’Œç¿»è½¬åŒæ„ï¼‰ï¼Œprufer åºåˆ—æ•°ä¸º (n - k + 1)! / prod{ (di - ?)! }</p><p>dpè®¡ç®—åˆ†æ¯é‚£ç©æ„ï¼Œf[i, j, k] è¡¨ç¤ºå‰ i ä¸ªç‚¹æœ‰ j ä¸ªç¯ä¸Šç‚¹ï¼Œk ä¸º 0/1 è¡¨ç¤ºæ˜¯å¦é€‰äº†å‡ºç°æ¬¡æ•° deg - 3 çš„ç‚¹ã€‚</p><p>æ‰€ä»¥æœ€åç­”æ¡ˆå°±æ˜¯ $\sum\limits_{i = 3}^{n - 1} f[n, i, 1] \times (n - i - 1)! \times \frac{(i - 1)!}{2}$</p><h2 id="Team-Work"><a href="#Team-Work" class="headerlink" title="Team Work"></a><a href="https://vjudge.net/problem/CodeForces-932E" target="_blank" rel="noopener">Team Work</a></h2><hr><p><a href="https://www.cnblogs.com/gzy-cjoier/p/8426987.html" target="_blank" rel="noopener">ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°</a></p><p>æŸ¿å­å¾ˆå¥½åˆ—å‡ºæ¥ï¼Œ<a href="https://www.cnblogs.com/cjyyb/p/9706019.html" target="_blank" rel="noopener">æ€ä¹ˆæ¨å‘¢ï¼Ÿ</a></p><ul><li>çœ‹åˆ° i^k çš„å½¢å¼æƒ³æƒ³æ–¯ç‰¹æ—æ•°</li><li>å¾ªç¯å¤æ‚åº¦é«˜æ—¶æƒ³æƒ³æ›¿æ¢æšä¸¾é¡ºåº</li><li>ç¢°åˆ°é˜¶ä¹˜å½¢å¼æƒ³æƒ³å‡‘ç»„åˆæ•°</li></ul><h2 id="æ’åˆ—ç»„åˆ"><a href="#æ’åˆ—ç»„åˆ" class="headerlink" title="æ’åˆ—ç»„åˆ"></a><a href="https://vjudge.net/problem/HDU-1521" target="_blank" rel="noopener">æ’åˆ—ç»„åˆ</a></h2><hr><p>æŒ‡æ•°å‹ç”Ÿæˆå‡½æ•°æ¨¡æ¿é¢˜ï¼Œå›å»å°±é‡ä¿®ç”Ÿæˆå‡½æ•°ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ•°å­¦ </tag>
            
            <tag> æ’åˆ—ç»„åˆ </tag>
            
            <tag> ç”Ÿæˆå‡½æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2020 ç™¾åº¦ä¹‹æ˜Ÿç¨‹åºè®¾è®¡å¤§èµ› - åˆèµ›ï¼ˆAï¼‰</title>
      <link href="2020/07/20/2020%20%E7%99%BE%E5%BA%A6%E4%B9%8B%E6%98%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%A4%A7%E8%B5%9B%20-%20%E5%88%9D%E8%B5%9BA/"/>
      <url>2020/07/20/2020%20%E7%99%BE%E5%BA%A6%E4%B9%8B%E6%98%9F%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%A4%A7%E8%B5%9B%20-%20%E5%88%9D%E8%B5%9BA/</url>
      
        <content type="html"><![CDATA[<p>A, B, C å‡ä¸ºæ°´é¢˜ã€‚ã€‚rk306ï¼Œè¿›å¤èµ›äº† ~</p><h2 id="D"><a href="#D" class="headerlink" title="D"></a>D</h2><p>D å…¶å®ä¹Ÿæ˜¯æ°´é¢˜ï¼Œè¿™é¢˜ç›®æ˜¯çœŸçš„éš¾æ‡‚ã€‚ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T, n, sx, sy, a[<span class="number">505</span>][<span class="number">505</span>], ans, tot;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; val;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; sx &gt;&gt; sy;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">            rep(j, <span class="number">1</span>, n) &#123;</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i][j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ans = <span class="number">1e9</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">            rep(j, <span class="number">1</span>, n) &#123;</span><br><span class="line">                <span class="keyword">int</span> ren = <span class="number">0</span>, rnd = <span class="number">0</span>;</span><br><span class="line">                rnd = (<span class="built_in">abs</span>(i - sx) + <span class="built_in">abs</span>(j - sy) + <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">                tot = <span class="number">0</span>;</span><br><span class="line">                val.clear();</span><br><span class="line">                rep(k, <span class="number">-3</span>, <span class="number">3</span>) &#123;</span><br><span class="line">                    rep(l, <span class="number">-3</span>, <span class="number">3</span>) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="built_in">abs</span>(k) + <span class="built_in">abs</span>(l) &gt; <span class="number">3</span>) <span class="keyword">continue</span>;</span><br><span class="line">                        <span class="keyword">if</span> (!k &amp;&amp; !l) <span class="keyword">continue</span>;  <span class="comment">// åŸå¸‚å»ºæˆåç¬¬ä¸€ä¸ªå·¥ä½œè€…ä¸ä¼šç§»åŠ¨åˆ°åˆ«çš„æ ¼å­å»ã€‚ã€‚ã€‚é”™å¤±AC</span></span><br><span class="line">                        <span class="keyword">if</span> (i + k &lt; <span class="number">1</span> || i + k &gt; n || j + l &lt; <span class="number">1</span> || j + l &gt; n) <span class="keyword">continue</span>;</span><br><span class="line">                        val.push_back(a[i + k][j + l]);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                sort(val.begin(), val.end());</span><br><span class="line"></span><br><span class="line">                ren = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">int</span> cur = <span class="number">0</span>, food = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">while</span> (ren &lt; <span class="number">9</span>) &#123;</span><br><span class="line">                    <span class="keyword">int</span> tt = <span class="number">8</span> * ren * ren;</span><br><span class="line">                    <span class="keyword">if</span> (food &lt; tt) &#123;</span><br><span class="line">                        tt -= food;</span><br><span class="line">                        <span class="keyword">int</span> k = tt / cur + (tt % cur &gt; <span class="number">0</span>);</span><br><span class="line">                        rnd += k, food += k * cur;</span><br><span class="line">                    &#125;</span><br><span class="line">                    ++ren;</span><br><span class="line">                    <span class="keyword">if</span> (!val.size()) <span class="keyword">continue</span>;</span><br><span class="line">                    cur += val.back(), val.pop_back();</span><br><span class="line">                &#125;</span><br><span class="line">                ans = min(ans, rnd);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="E"><a href="#E" class="headerlink" title="E"></a>E</h2><p>ä¸æ˜¯å¾ˆéš¾ä½†ç†è§£äº†å¾ˆä¹…çš„æœŸæœ›é¢˜</p><p>ç”±äº a ä»å¤–åˆ°å†…é€’å‡ï¼Œå¿…ç„¶ä¼šå½¢æˆå¾ˆå¤šä»å†…å‘å¤–çš„æ ‘ï¼Œæ‰€ä»¥è¿é€šå—æ•°çš„æœŸæœ›å…¶å®å°±æ˜¯æ ‘æ ¹æ•°çš„æœŸæœ›ã€‚</p><p>è€ƒè™‘æ¯ä¸ªæ®µä½œä¸ºæ ‘æ ¹çš„è´¡çŒ®ã€‚</p><p>ç¬¬ä¸€å±‚æ˜¯ a[i] / 2</p><p>ç¬¬ i å±‚æ¯ä¸ªæ®µæ˜¯ (1 / a[i - 1] - 1 / a[i]) * (a[i - 1] / 2) * (a[i] / 2) = (a[i] - a[i - 1]) / 4</p><p>å…¶ä¸­ï¼Œ1 / a[i - 1] æ˜¯ä¸Šä¸€å±‚ç™½å—æ¦‚ç‡ï¼Œä½†æ˜¯é»‘å—è¦å®Œå…¨å¾…åœ¨ç™½å—é‡Œå°±è¦å‡å» 1 / a[i]</p><p>é‚£ä¹ˆå¦‚æœå‡ºç°åªæœ‰ä¸€ä¸ªç‚¹ç›¸ç¢°çš„æƒ…å†µï¼Œè¿™æ¦‚ç‡æ€ä¹ˆç®—å‘¢ï¼Ÿ</p><p>å…¶å®ä¸ç”¨ç®—å®ƒï¼Œå®ƒçš„æ¦‚ç‡ä¸º 0ã€‚</p><p>å› ä¸ºåœ¨è¿ç»­ç©ºé—´ä¸‹ï¼Œè®¡ç®—ä¸€ä¸ªå­ç©ºé—´çš„æ¦‚ç‡å°±æ˜¯åœ¨ç®—è¿™ä¸ªç©ºé—´çš„æµ‹åº¦ (å¯ä»¥ç†è§£æˆä¸€ç»´æ˜¯é•¿åº¦, äºŒç»´æ˜¯é¢ç§¯, ä¸‰ç»´æ˜¯ä½“ç§¯)</p><p>åœ¨Lebesgueæµ‹åº¦(æ¬§æ°ç©ºé—´ä¸‹æœ€å¸¸ç”¨çš„æµ‹åº¦å®šä¹‰, æˆ‘ä»¬å­¦åˆ°çš„å¾®ç§¯åˆ†åŸºæœ¬éƒ½åŸºäºå®ƒ)ä¸‹ï¼Œä¸€ç»´ç©ºé—´ä¸­çš„ä¸€ä¸ªç‚¹æµ‹åº¦å°±æ˜¯ 0</p><h2 id="F"><a href="#F" class="headerlink" title="F"></a>F</h2><p>é€‰ç‚¹å¿…ç„¶æ˜¯ä»å°åˆ°å¤§é€‰ï¼Œæ‰€ä»¥å¯ä»¥äºŒåˆ†æœ€åé€‰çš„ç‚¹ï¼ˆæƒå€¼æœ€å¤§çš„ç‚¹ï¼‰ï¼Œå¯¹äºæ¯å—åŒºåŸŸè®¨è®ºä¸€ä¸‹ï¼ˆä¸æƒ³å†™ï¼Œä»£ç å°±è®©å®ƒå’•å’•å§ï¼ˆï¼‰</p><h2 id="G"><a href="#G" class="headerlink" title="G"></a>G</h2><p>æ—¶åˆ»å…·æœ‰å¯äºŒåˆ†æ€§ã€‚è®¾äºŒåˆ†çš„å€¼ä¸º tï¼Œå®¹æ˜“æƒ³åˆ°å¯¹äºæ¯ä¸ªæ ¼ç‚¹ï¼Œä¸æ¯ä¸ªåœ¨ t æ—¶åˆ»å†…èƒ½åˆ°è¾¾å®ƒçš„çª—æˆ·è¿è¾¹ï¼Œè·‘ç½‘ç»œæµï¼Œä½†æ˜¯è¿™æ ·èŠ‚ç‚¹ä¸ªæ•°æ˜¯ nm çº§åˆ«çš„ã€‚è€ƒè™‘ä¼˜åŒ–ï¼Œçª—æˆ·åªæœ‰ 6 ä¸ªï¼Œé‚£ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºçª—æˆ·åˆ°æ ¼ç‚¹çš„åˆ°è¾¾çŠ¶æ€ï¼Œå°†çŠ¶æ€ç›¸åŒçš„ç‚¹ä»¬ç¼©æˆä¸€ä¸ªç‚¹ï¼Œè·‘æœ€å¤§æµå°±å¥½äº†ã€‚</p><h2 id="H"><a href="#H" class="headerlink" title="H"></a>H</h2><p>å®˜æ–¹é¢˜è§£å¤ªæ¯’ç˜¤ï¼Œï¼Œæˆ‘çœ‹çš„<a href="https://blog.csdn.net/weixin_44282912/article/details/107454309" target="_blank" rel="noopener">è¿™ä¸ª</a></p><p>æ—¶é—´å¤æ‚åº¦åº”è¯¥æ˜¯è·‘ä¸æ»¡çš„ sqrt(n) * log(sqrt(n))</p><p>æ€è€ƒäº†ä¸€æ³¢æ¨æŸ¿å­çš„æ„ä¹‰ï¼ŒæŠŠ sigma åŒ–æ‰ã€å»æ‰æ— æ•ˆæšä¸¾çŠ¶æ€ï¼ˆæ¯”å¦‚ n / d^2ï¼Œd &gt; sqrt(n) å°±æ˜¯æ— æ•ˆçš„ï¼‰ï¼Œåˆ¤æ–­å½“å‰æŸ¿å­èƒ½å¦é¢„å¤„ç†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘çŸ©é˜µæ ‘å®šç†</title>
      <link href="2020/07/17/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E7%9F%A9%E9%98%B5%E6%A0%91%E5%AE%9A%E7%90%86/"/>
      <url>2020/07/17/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E7%9F%A9%E9%98%B5%E6%A0%91%E5%AE%9A%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p><a href="https://oi-wiki.org/graph/matrix-tree/" target="_blank" rel="noopener">OIWikiä¸Šçš„çŸ©é˜µæ ‘ç›¸å…³</a></p><hr><h1 id="è¡Œåˆ—å¼"><a href="#è¡Œåˆ—å¼" class="headerlink" title="è¡Œåˆ—å¼"></a><a href="https://blog.csdn.net/qq_36396104/article/details/89298227" target="_blank" rel="noopener">è¡Œåˆ—å¼</a></h1><p>$n \times n$ çš„çŸ©é˜µ A çš„è¡Œåˆ—å¼å¯ä»¥ç†è§£ä¸ºè¡Œæˆ–åˆ—å‘é‡æ‰€æ„æˆçš„è¶…å¹³è¡Œå¤šé¢ä½“çš„æœ‰å‘é¢ç§¯æˆ–æœ‰å‘ä½“ç§¯ï¼Œæ˜¯ä¸€ä¸ªæ ‡é‡ã€‚</p><p>çŸ©é˜µ A çš„è¡Œåˆ—å¼ç”¨ det(A) è¡¨ç¤ºã€‚</p><p><a href="https://baike.baidu.com/item/%E5%88%9D%E7%AD%89%E5%8F%98%E6%8D%A2/10648400?fr=aladdin#2" target="_blank" rel="noopener">è¡Œåˆ—å¼åˆç­‰å˜æ¢(æœ€ä¸‹é¢)</a></p><ul><li>è¡Œåˆ—äº’æ¢ï¼Œè¡Œåˆ—å¼å€¼ä¸å˜</li><li>è¡Œåˆ—å¼ä¸€è¡Œæˆ–ä¸€åˆ—çš„å…¬å› å­å¯ä»¥æå‡ºå»</li><li>è¡Œåˆ—å¼ä¸­è‹¥æœ‰æŸä¸€è¡Œæ˜¯ä¸¤ç»„æ•°çš„å’Œï¼Œåˆ™è¯¥è¡Œåˆ—å¼ç­‰äºä¸¤ä¸ªè¡Œåˆ—å¼çš„å’Œ</li><li>ä¸¤è¡Œæˆ–ä¸¤åˆ—äº¤æ¢ï¼Œè¡Œåˆ—å¼å˜å·ï¼ˆåŒºåˆ«äºç¬¬ä¸€æ¡ï¼‰</li><li>ä¸¤è¡Œæˆ–ä¸¤åˆ—ç›¸åŒï¼Œè¡Œåˆ—å¼ä¸º 0</li><li>ä¸¤è¡Œæˆ–ä¸¤åˆ—æˆæ¯”ä¾‹ï¼Œè¡Œåˆ—å¼ä¸º 0</li></ul><hr><h1 id="é«˜æ–¯æ¶ˆå…ƒåŒ–ä¸ºä¸Šä¸‰è§’çŸ©é˜µï¼š"><a href="#é«˜æ–¯æ¶ˆå…ƒåŒ–ä¸ºä¸Šä¸‰è§’çŸ©é˜µï¼š" class="headerlink" title="é«˜æ–¯æ¶ˆå…ƒåŒ–ä¸ºä¸Šä¸‰è§’çŸ©é˜µï¼š"></a>é«˜æ–¯æ¶ˆå…ƒåŒ–ä¸ºä¸Šä¸‰è§’çŸ©é˜µï¼š</h1><p>è¿ç”¨äº†è¡Œåˆ—å¼çš„åˆç­‰å˜æ¢ã€‚</p><ul><li>å®æ•°ï¼šç›´æ¥å¤„ç†</li><li>æ¨¡æ„ä¹‰ï¼š1. æ¨¡ä¸ºè´¨ å¯ç”¨é€†å…ƒ  2. æ¨¡ä¸ä¸ºè´¨ ç”¨è¾—è½¬ç›¸é™¤æ³•ï¼Œå¤æ‚åº¦ä¼šå¤šä¸€ä¸ª logï¼ˆè¯¦æƒ…è§ä¾‹é¢˜ä»£ç ï¼‰</li></ul><hr><h1 id="åŸºå°”éœå¤«çŸ©é˜µ"><a href="#åŸºå°”éœå¤«çŸ©é˜µ" class="headerlink" title="åŸºå°”éœå¤«çŸ©é˜µ"></a>åŸºå°”éœå¤«çŸ©é˜µ</h1><p>A ä¸ºé‚»æ¥çŸ©é˜µï¼ŒD ä¸ºåº¦æ•°çŸ©é˜µï¼ŒKirchhoffçŸ©é˜µä¸º K = D - A</p><p>è¡Œåˆ—å¼ a[i, i] è®°å½•ç‚¹ i åº¦æ•°ï¼Œa[i, j] è¡¨ç¤º i, j ä¹‹é—´è¾¹æ•°çš„ç›¸åæ•°ã€‚</p><p>å…·ä½“å®ç°çš„è¯ï¼Œè®¾ kirchhoff çŸ©é˜µä¸º aï¼Œè‹¥å­˜åœ¨è¾¹ (u, v) åˆ™ a[u, u]++, a[v, v]++, a[u, v]â€“, a[v, u]â€“</p><p>KirchhoffçŸ©é˜µæ¯è¡Œå†…æ•°çš„å’Œå’Œæ¯åˆ—å†…æ•°çš„å’Œéƒ½ä¸º 0ï¼Œæ‰€ä»¥è¡Œåˆ—å¼ä¸º 0</p><hr><h1 id="çŸ©é˜µæ ‘å®šç†"><a href="#çŸ©é˜µæ ‘å®šç†" class="headerlink" title="çŸ©é˜µæ ‘å®šç†"></a>çŸ©é˜µæ ‘å®šç†</h1><p>ç”¨äºæ±‚è§£å›¾ä¸Šçš„ç”Ÿæˆæ ‘ä¸ªæ•°ã€‚</p><p>æ— å‘å›¾ç”Ÿæˆæ ‘ä¸ªæ•° = Kirchhoff çŸ©é˜µä»»ä½•ä¸€ä¸ª N - 1 é˜¶<a href="https://baike.baidu.com/item/%E4%B8%BB%E5%AD%90%E5%BC%8F/2671796?fr=aladdin" target="_blank" rel="noopener">ä¸»å­å¼</a>çš„è¡Œåˆ—å¼çš„ç»å¯¹å€¼.</p><p>æœ‰å‘å›¾ç›¸å…³è§<a href="https://www.xht37.com/%E7%9F%A9%E9%98%B5%E6%A0%91%E5%AE%9A%E7%90%86-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener">è¿™é‡Œ</a> ï¼ˆç”±äºæœ¬äººè¿‡äºèœ è¿æœ‰å‘å›¾ç”Ÿæˆæ ‘æ˜¯å•¥éƒ½ä¸ä¼š å…ˆå’•å’• åç»­åšåˆ°é¢˜äº†å†æ¥å¡«å‘ï¼ï¼‰</p><p>æ— å‘å›¾ï¼Œè°æ˜¯æ ¹å¹¶ä¸é‡è¦æ‰€ä»¥éšä¾¿å»æ‰å“ªä¸€è¡Œ&amp;åˆ—éƒ½å¯ä»¥ï¼›</p><p>æœ‰å‘å›¾ï¼Œåˆ å»æŒ‡å®šçš„æ ¹æ‰€åœ¨çš„è¡Œå’Œåˆ—ï¼Œæ±‚å‰©ä¸‹çš„çŸ©é˜µè¡Œåˆ—å¼å³å¯ã€‚</p><p>å¦‚æœå›¾ä¸è¿é€šï¼Œé‚£ä¹ˆä»»æ„ N - 1 é˜¶ä¸»å­å¼ä¸º 0ã€‚è¯æ˜ï¼šå¦‚æœå›¾ä¸è¿é€šï¼Œé‚£ä¹ˆæ¯ä¸ªè¿é€šå—å†…çš„ç‚¹æ„æˆçš„çŸ©é˜µä»ç„¶æ˜¯ Kirchhoff çŸ©é˜µï¼Œè€Œè¿é€šå—ä¸æ­¢ä¸€ä¸ªï¼Œæ‰€ä»¥å»æ‰ç¬¬ i è¡Œç¬¬ i åˆ—ä¹‹åï¼Œä¸€å®šæœ‰ä¸€ä¸ªè¿é€šå—ä»ç„¶æ˜¯ Kirchhoff çŸ©é˜µï¼Œä¹Ÿå°±æ˜¯è¡Œåˆ—å¼ä¸º 0 ã€‚</p><hr><h1 id="å˜å…ƒçŸ©é˜µæ ‘å®šç†"><a href="#å˜å…ƒçŸ©é˜µæ ‘å®šç†" class="headerlink" title="å˜å…ƒçŸ©é˜µæ ‘å®šç†"></a>å˜å…ƒçŸ©é˜µæ ‘å®šç†</h1><p>æ±‚æ‰€æœ‰ç”Ÿæˆæ ‘æ€»è¾¹ç§¯çš„å’Œã€‚è¡Œåˆ—å¼ a[i, i] è®°å½•ç‚¹ i è¾¹æƒå’Œï¼Œa[i, j] è¡¨ç¤º i, j ä¹‹é—´è¾¹æƒçš„ç›¸åæ•°ã€‚</p><hr><h2 id="ä¾‹é¢˜1-HEOI2015-å°Zçš„æˆ¿é—´"><a href="#ä¾‹é¢˜1-HEOI2015-å°Zçš„æˆ¿é—´" class="headerlink" title="ä¾‹é¢˜1. [HEOI2015]-å°Zçš„æˆ¿é—´"></a>ä¾‹é¢˜1. <a href="https://www.luogu.com.cn/problem/P4111" target="_blank" rel="noopener">[HEOI2015]-å°Zçš„æˆ¿é—´</a></h2><p>æ¨¡æ¿é¢˜ï¼Œæ³¨æ„æ¨¡æ•°éè´¨</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> dir[][<span class="number">2</span>] = &#123;&#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, m, a[<span class="number">100</span>][<span class="number">100</span>], id[<span class="number">10</span>][<span class="number">10</span>], idx;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">10</span>][<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s[i] + <span class="number">1</span>);</span><br><span class="line">        rep(j, <span class="number">1</span>, m)</span><br><span class="line">            <span class="keyword">if</span> (s[i][j] == <span class="string">'.'</span>) id[i][j] = ++idx;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">1</span>, m) &#123;</span><br><span class="line">            <span class="keyword">if</span> (id[i][j]) &#123;</span><br><span class="line">                rep(k, <span class="number">0</span>, <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">int</span> tx = i + dir[k][<span class="number">0</span>], ty = j + dir[k][<span class="number">1</span>];</span><br><span class="line">                    <span class="keyword">if</span> (tx &gt; n || ty &gt; m || !id[tx][ty]) <span class="keyword">continue</span>;</span><br><span class="line">                    <span class="keyword">int</span> x = id[i][j], y = id[tx][ty];</span><br><span class="line">                    a[x][x]++, a[y][y]++, a[x][y]--, a[y][x]--;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, idx - <span class="number">1</span>) &#123;  <span class="comment">// n - 1 é˜¶ä¸»å­å¼</span></span><br><span class="line">        rep(j, i + <span class="number">1</span>, idx - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (a[j][i]) &#123;  <span class="comment">// åœ¨æ¨¡æ„ä¹‰ä¸‹ç”¨è¾—è½¬ç›¸é™¤æ³•ï¼Œç±»æ¯” gcd(a, b) = gcd(b, a % b) ç›´åˆ° b = 0ï¼Œç”¨ç¬¬ i è¡Œæ¶ˆç¬¬ j è¡Œ</span></span><br><span class="line">                ll d = a[i][i] / a[j][i];</span><br><span class="line">                rep(k, i, idx - <span class="number">1</span>)</span><br><span class="line">                    a[i][k] = (a[i][k] - d * a[j][k] % mod + mod) % mod;</span><br><span class="line">                swap(a[i], a[j]), ans = -ans;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ans = (ans * a[i][i] % mod + mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¾‹é¢˜2-SHOI2016-é»‘æš—å‰çš„å¹»æƒ³ä¹¡"><a href="#ä¾‹é¢˜2-SHOI2016-é»‘æš—å‰çš„å¹»æƒ³ä¹¡" class="headerlink" title="ä¾‹é¢˜2. [SHOI2016]-é»‘æš—å‰çš„å¹»æƒ³ä¹¡"></a>ä¾‹é¢˜2. <a href="https://www.luogu.com.cn/problem/P4336" target="_blank" rel="noopener">[SHOI2016]-é»‘æš—å‰çš„å¹»æƒ³ä¹¡</a></h2><p>å®¹æ–¥ + çŸ©é˜µæ ‘å®šç†</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line">ll n, a[<span class="number">20</span>][<span class="number">20</span>], res;</span><br><span class="line"><span class="built_in">vector</span>&lt;pii&gt; g[<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> m, x, y; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m);</span><br><span class="line">        <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">            g[i].push_back(make_pair(x, y));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(s, <span class="number">0</span>, (<span class="number">1</span> &lt;&lt; (n - <span class="number">1</span>)) - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span>(a));</span><br><span class="line">        rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s &amp; (<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>))) &#123;</span><br><span class="line">                ++cnt;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; g[i].size(); j++) &#123;</span><br><span class="line">                    <span class="keyword">int</span> x = g[i][j].first, y = g[i][j].second;</span><br><span class="line">                    a[x][x]++, a[y][y]++, a[x][y]--, a[y][x]--;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ll ans = <span class="number">1</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">            rep(j, i + <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">while</span> (a[j][i]) &#123;</span><br><span class="line">                    ll d = a[i][i] / a[j][i];</span><br><span class="line">                    rep(k, i, n - <span class="number">1</span>)</span><br><span class="line">                        a[i][k] = (a[i][k] - d * a[j][k] % mod + mod) % mod;</span><br><span class="line">                    swap(a[i], a[j]), ans = -ans;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ans = (ans * a[i][i] % mod + mod) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">        res = (res + ((n - <span class="number">1</span> - cnt) &amp; <span class="number">1</span> ? <span class="number">-1l</span>l : <span class="number">1l</span>l) * ans + mod) % mod;  <span class="comment">// !!!</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, res);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¾‹é¢˜3-SDOI2014-é‡å»º"><a href="#ä¾‹é¢˜3-SDOI2014-é‡å»º" class="headerlink" title="ä¾‹é¢˜3. [SDOI2014]-é‡å»º"></a>ä¾‹é¢˜3. <a href="https://www.luogu.com.cn/problem/P3317" target="_blank" rel="noopener">[SDOI2014]-é‡å»º</a></h2><p>æ¨æŸ¿å­ + å˜å…ƒçŸ©é˜µæ ‘å®šç†ï¼Œæ˜¾ç„¶è¾¹æƒè·Ÿæ¦‚ç‡æœ‰å…³</p><p>$\sum\limits_{T}(\prod\limits_{e \in T} P_e \prod\limits_{e \not\in T}(1-P_e))$</p><p>$\sum\limits_T( \prod\limits_{e \in T} P_e \frac{ \prod\limits_e (1 - P_e) }{ \prod\limits_{e \in T} (1 - P_e) } )$</p><p>$\prod\limits_e (1 - P_e) \sum \prod\limits_{e \in T} \frac{P_e}{1 - P_e}$</p><p>å°±å¯ä»¥åšå•¦</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">55</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-9</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">double</span> D[N][N], ans = <span class="number">1.0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> ff = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">double</span> ret = <span class="number">1.0</span>;</span><br><span class="line">    <span class="keyword">int</span> N = n - <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, N) &#123;</span><br><span class="line">        <span class="keyword">int</span> mx = i;</span><br><span class="line">        rep(j, i + <span class="number">1</span>, N)</span><br><span class="line">            <span class="keyword">if</span> (D[mx][i] &lt; D[j][i]) mx = j;</span><br><span class="line">        <span class="keyword">if</span> (mx != i) ff ^= <span class="number">1</span>, swap(D[mx], D[i]);</span><br><span class="line">        <span class="keyword">if</span> (D[i][i] &gt; -eps &amp;&amp; D[i][i] &lt; eps) <span class="keyword">return</span> <span class="number">0.0</span>;</span><br><span class="line">        rep(j, i + <span class="number">1</span>, N) &#123;</span><br><span class="line">            <span class="keyword">double</span> t = D[j][i] / D[i][i];</span><br><span class="line">            rep(k, i, N) D[j][k] -= t * D[i][k];</span><br><span class="line">        &#125;</span><br><span class="line">        ret *= D[i][i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ff) ret *= <span class="number">-1.0</span>;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) rep(j, <span class="number">1</span>, n) <span class="built_in">cin</span> &gt;&gt; D[i][j];</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        rep(j, <span class="number">1</span>, n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">fabs</span>(D[i][j]) &lt; eps) D[i][j] = eps;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">fabs</span>(<span class="number">1.0</span> - D[i][j]) &lt; eps) D[i][j] = <span class="number">1.0</span> - eps;</span><br><span class="line">            <span class="keyword">if</span> (j &gt; i) ans *= (<span class="number">1</span> - D[i][j]);</span><br><span class="line">            D[i][j] /= (<span class="number">1.0</span> - D[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        rep(j, <span class="number">1</span>, n)</span><br><span class="line">            <span class="keyword">if</span> (i != j)</span><br><span class="line">                D[i][i] += D[i][j], D[i][j] *= <span class="number">-1</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.5lf\n"</span>, ans * solve());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¾‹é¢˜4-JSOI2008-æœ€å°ç”Ÿæˆæ ‘è®¡æ•°"><a href="#ä¾‹é¢˜4-JSOI2008-æœ€å°ç”Ÿæˆæ ‘è®¡æ•°" class="headerlink" title="ä¾‹é¢˜4. [JSOI2008]-æœ€å°ç”Ÿæˆæ ‘è®¡æ•°"></a>ä¾‹é¢˜4. <a href="https://www.luogu.com.cn/problem/P4208" target="_blank" rel="noopener">[JSOI2008]-æœ€å°ç”Ÿæˆæ ‘è®¡æ•°</a></h2><p><strong>æœ€å°ç”Ÿæˆæ ‘æ€§è´¨ï¼šå¯¹äºæ‰€æœ‰æœ€å°ç”Ÿæˆæ ‘ï¼Œæ¯ç§è¾¹æƒçš„è¾¹æ•°ç›¸åŒï¼›ä¸”å¯¹äºæ‰€æœ‰ç”Ÿæˆæ ‘ï¼ŒæŸç§æƒå€¼çš„è¾¹è¿å®Œåå›¾çš„è”é€šæ€§ç›¸åŒ</strong></p><p>æ‰€ä»¥å¯ä»¥åˆ†åˆ«å¤„ç†æ¯ç§æƒå€¼ï¼Œä¹˜èµ·æ¥ã€‚</p><p>ç®—åŒç§è¾¹æƒçš„è¾¹çš„è´¡çŒ®ï¼Œç”±äºå…·æœ‰ç›¸åŒæƒå€¼çš„è¾¹ä¸è¶…è¿‡ 10 æ¡ï¼Œæš´æœä¹Ÿå¯ä»¥è¿‡ã€‚ã€‚ï¼ˆ2^10 å¾ˆç¨³çš„ï¼</p><p>æ­£è§£æ˜¯çŸ©é˜µæ ‘ã€‚æ³¨æ„ï¼ŒåŒç§è¾¹æƒçš„è¾¹è”é€šæ€§ç›¸åŒå¹¶ä¸ç­‰äºè¿é€šï¼Œå› æ­¤è¦è¿ä¸€äº›æ¡¥ï¼Œå¹¶ä¸å½±å“çŸ©é˜µæ ‘ç®—ç­”æ¡ˆã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">31011</span>, N = <span class="number">105</span>, M = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, m, ans = <span class="number">1</span>, num;</span><br><span class="line">ll fa[N], fat[N], id[M &lt;&lt; <span class="number">1</span>], a[N][N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    ll u, v, w;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node &amp;a) <span class="keyword">const</span> &#123; <span class="keyword">return</span> w &lt; a.w; &#125;</span><br><span class="line">&#125;e[M], t[M];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fa[x] == x ? x : fa[x] = getfa(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa2</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fat[x] == x ? x : fat[x] = getfa2(fat[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">Gauss</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        rep(j, i + <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (a[j][i]) &#123;</span><br><span class="line">                ll d = a[i][i] / a[j][i];</span><br><span class="line">                rep(k, i, n - <span class="number">1</span>)</span><br><span class="line">                    a[i][k] = (a[i][k] - d * a[j][k] % mod + mod) % mod;</span><br><span class="line">                swap(a[i], a[j]), ret = -ret;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ret = (ret * a[i][i] % mod + mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span>(a));</span><br><span class="line">    rep(i, l, r) &#123;</span><br><span class="line">        t[i] = e[i];</span><br><span class="line">        <span class="keyword">int</span> u = getfa(t[i].u), v = getfa(t[i].v);</span><br><span class="line">        t[i].u = u, t[i].v = v;  <span class="comment">// ç±»ä¼¼äºç¼©ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (u == v) <span class="keyword">continue</span>;</span><br><span class="line">        id[++cnt] = u, id[++cnt] = v;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(id + <span class="number">1</span>, id + cnt + <span class="number">1</span>);</span><br><span class="line">    cnt = unique(id + <span class="number">1</span>, id + cnt + <span class="number">1</span>) - id - <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, cnt) fat[i] = i;</span><br><span class="line">    rep(i, l, r) &#123;</span><br><span class="line">        <span class="keyword">if</span> (t[i].u == t[i].v) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> u = getfa(t[i].u), v = getfa(t[i].v);</span><br><span class="line">        <span class="keyword">if</span> (u != v) --num, fa[u] = v;</span><br><span class="line"></span><br><span class="line">        u = lower_bound(id + <span class="number">1</span>, id + cnt + <span class="number">1</span>, t[i].u) - id;</span><br><span class="line">        v = lower_bound(id + <span class="number">1</span>, id + cnt + <span class="number">1</span>, t[i].v) - id;</span><br><span class="line">        a[u][u]++, a[v][v]++, a[u][v]--, a[v][u]--;</span><br><span class="line"></span><br><span class="line">        u = getfa2(u), v = getfa2(v);</span><br><span class="line">        <span class="keyword">if</span> (u != v) fat[u] = v;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">2</span>, cnt) &#123;  <span class="comment">// æœ‰å¯èƒ½ä¸è¿é€šï¼Œé‚£ä¹ˆè¿ä¸€äº›æ¡¥ï¼Œå¹¶ä¸å½±å“çŸ©é˜µæ ‘ç®—ç­”æ¡ˆ</span></span><br><span class="line">        <span class="keyword">int</span> u = getfa2(i), v = getfa2(i - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (u == v) <span class="keyword">continue</span>;</span><br><span class="line">        a[u][u]++, a[v][v]++, a[u][v]--, a[v][u]--;</span><br><span class="line">        fat[u] = v;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = ans * Gauss(cnt) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, m)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>, &amp;e[i].u, &amp;e[i].v, &amp;e[i].w);</span><br><span class="line">    sort(e + <span class="number">1</span>, e + m + <span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) fa[i] = i;</span><br><span class="line">    num = n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = <span class="number">1</span>; i &lt;= m; i = j) &#123;</span><br><span class="line">        <span class="keyword">while</span> (j &lt;= m &amp;&amp; e[i].w == e[j].w) ++j;</span><br><span class="line">        <span class="keyword">for</span> (j = i; j &lt;= m; ++j) <span class="keyword">if</span> (e[i].w != e[j].w) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (i + <span class="number">1</span> &lt; j) &#123;</span><br><span class="line">            calc(i, j - <span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> u = getfa(e[i].u), v = getfa(e[i].v);</span><br><span class="line">            <span class="keyword">if</span> (u != v) fa[u] = v;</span><br><span class="line">            --num;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (num &gt; <span class="number">1</span>) <span class="built_in">puts</span>(<span class="string">"0"</span>);  <span class="comment">// åˆ¤å®šæœ€å°ç”Ÿæˆæ ‘çš„å­˜åœ¨</span></span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
            <tag> çŸ©é˜µæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµ™å¤§ACMç¬¬äºŒè½®é€‰è®²</title>
      <link href="2020/07/17/%E6%B5%99%E5%A4%A7ACM%E7%AC%AC%E4%BA%8C%E8%BD%AE%E9%80%89%E8%AE%B2/"/>
      <url>2020/07/17/%E6%B5%99%E5%A4%A7ACM%E7%AC%AC%E4%BA%8C%E8%BD%AE%E9%80%89%E8%AE%B2/</url>
      
        <content type="html"><![CDATA[<h2 id="7-17-A"><a href="#7-17-A" class="headerlink" title="7.17 A"></a><a href="https://zjusummer.contest.codeforces.com/group/clkkguw3vK/contest/102657/problem/A" target="_blank" rel="noopener">7.17 A</a></h2><hr><p>ç®—ç®€å•é¢˜é‡Œçš„åéš¾é¢˜å§ã€‚ã€‚</p><ul><li>æ“ä½œ 2 æ¬¡æ•°è‡³å°‘ä¸º max{a_i}</li><li>æ‰€æœ‰æ•°å¿…é¡»åŒæ—¶å‡åˆ° 0</li></ul><p>è¿›è¡Œå‡ä¸€åå†åŠ å€ä¸ä¼šä¼˜äºå…ˆåŠ å€å†å‡ä¸€ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥ï¼‰ï¼Œæ‰€ä»¥åœ¨æœ€å¤§å€¼ max æ²¡è¿›è¡Œä¸€æ¬¡å‡ä¸€æ“ä½œæ—¶è®©æ¯ä¸ªæ•°ç¿»å€ï¼Œå°½å¯èƒ½é è¿‘ maxï¼›ç„¶åä¸€èµ·å‡ä¸€ï¼Œæ¯” max å°çš„æ•°åœ¨é€”ä¸­å¿…ç„¶ä¼šæœ‰å‡åˆ° max çš„ä¸€åŠçš„æ—¶å€™ï¼Œè¿™æ—¶å€™å†ç¿»å€å°±å¥½äº†ã€‚</p><h2 id="7-17-D"><a href="#7-17-D" class="headerlink" title="7.17 D"></a><a href="https://zjusummer.contest.codeforces.com/group/clkkguw3vK/contest/102657/problem/D" target="_blank" rel="noopener">7.17 D</a></h2><hr><p><a href="https://www.luogu.com.cn/blog/zyxxs/post-717-d-ti-ti-xie" target="_blank" rel="noopener">æ•°å­¦å¤§ä½¬çš„åšå®¢</a></p><p>åå°„æ€§è´¨çš„è½¬åŒ–å¾ˆæœ‰æ„æ€ï¼ä»£ç å°±å…ˆå’•å’•</p><h2 id="7-17-E"><a href="#7-17-E" class="headerlink" title="7.17 E"></a><a href="https://zjusummer.contest.codeforces.com/group/clkkguw3vK/contest/102657/problem/E" target="_blank" rel="noopener">7.17 E</a></h2><hr><p><a href="https://www.kdocs.cn/l/sf6G7oaScGQm?f=201" target="_blank" rel="noopener">é¢˜è§£</a></p><p>å¾ˆå¦™çš„dpï¼æˆ‘ä¸ä¼šè®¾è®¡çŠ¶æ€ã€‚ã€‚ã€‚</p><h2 id="7-17-F"><a href="#7-17-F" class="headerlink" title="7.17 F"></a><a href="https://zjusummer.contest.codeforces.com/group/clkkguw3vK/contest/102657/problem/F" target="_blank" rel="noopener">7.17 F</a></h2><hr><p>1 &lt;= |B| &lt;= |A|</p><p>B ä¸²æ‹¼èµ·æ¥çš„ä¸œè¥¿åªè¦æ˜¯ A çš„æœ€å°å¾ªç¯èŠ‚å°±å¥½äº†ã€‚</p><p>æœ‰ä¸ªå¾ˆå¦™çš„è½¬åŒ–ï¼šå°†ä¸ A ä¸­ [i, j] åŒ¹é…çš„ B ä¸²çœ‹ä½œä» i æŒ‡å‘ j + 1 çš„<strong>æœ‰å‘è¾¹</strong>ï¼ˆæ³¨æ„å–æ¨¡ï¼‰</p><p>é‚£ä¹ˆé—®é¢˜å°±å˜æˆäº†æ±‚æœ€å°ç¯ï¼Œfloyd å¯ä»¥è·‘</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æµ™å¤§ACMç¬¬ä¸€è½®é€‰è®²</title>
      <link href="2020/07/15/%E6%B5%99%E5%A4%A7ACM%E7%AC%AC%E4%B8%80%E8%BD%AE%E9%80%89%E8%AE%B2/"/>
      <url>2020/07/15/%E6%B5%99%E5%A4%A7ACM%E7%AC%AC%E4%B8%80%E8%BD%AE%E9%80%89%E8%AE%B2/</url>
      
        <content type="html"><![CDATA[<h2 id="7-13-D"><a href="#7-13-D" class="headerlink" title="7.13 D"></a><a href="https://zjusummer.contest.codeforces.com/group/clkkguw3vK/contest/102643/problem/D" target="_blank" rel="noopener">7.13 D</a></h2><hr><p><a href="https://www.luogu.com.cn/blog/zyxxs/post-713-d-ti-ti-xie" target="_blank" rel="noopener">æŒ‚ä¸€ä¸ªå¤§ä½¬åšå®¢</a></p><p>ä¸ºå•¥ç¬¬ä¸€ä¸ªæŸ¿å­ç­‰äºç¬¬äºŒä¸ªæŸ¿å­ï¼š</p><p>å·¦è¾¹å¼å­ = </p><p>P(lca = L) * L +</p><p>P(lca = L - 1) * (L - 1) +</p><p>P(lca = L - 2) * (L - 2) + </p><p>â€¦ + </p><p>P(lca = 0) * 0</p><p>é‡æ–°æ•´ç†ä¸€ä¸‹å°±æ˜¯</p><p>P(lca = L) + </p><p>P(lca = L) + P(lca = L - 1) +</p><p>P(lca = L) + P(lca = L - 1) + P(lca = L - 2) +</p><p>P(lca = L) + P(lca = L - 1) + P(lca = L - 2) + P(lca = L - 3) +</p><p>â€¦ +</p><p> P(lca = L) + P(lca = L - 1) + P(lca = L - 2) + P(lca = L - 3) + â€¦ P(lca = 1)</p><p>é‚£ä¹ˆå·¦è¾¹å°±ç­‰äº sum{1 to L}{P(lca &gt;= i)}</p><p>ç”±äº P(lca &gt;= 0) = 1</p><p>é‚£ä¹ˆè¿›è€Œç­‰äº sum{0 to L}{P(lca &gt;= i)} - 1</p><p>å…³äºæœ¬é¢˜å·ç§¯ï¼š</p><p>g(n) = 1 / n! * (-1)^n * (1 - c^{-n * (l + 1)}) / (1 - c^n)</p><p>h(n) = 1 / n!</p><p>f(n) = \sum_{1 &lt;= j &lt;= n - 1} (n - 1)! * g(j) * h(n - j - 1)</p><p>å…¶å®å°±æ˜¯æŠŠç»„åˆæ•°æ‹†å¼€æ¥äº†</p><p>æœ€åæŸ¿å­çš„ l + 1 æ˜¯ c = 1 çš„è´¡çŒ®</p><p>ä¸å¾—ä¸è¯´å¤ªå¦™äº†ï¼Œæ äº†ä¸€æ™šä¸Šï¼Œæ•°å­¦æ˜¯çŸ­æ¿å•Š</p><h2 id="7-14-A"><a href="#7-14-A" class="headerlink" title="7.14 A"></a><a href="https://zjusummer.contest.codeforces.com/group/clkkguw3vK/contest/102647/problem/A" target="_blank" rel="noopener">7.14 A</a></h2><hr><p>å’Œ<a href="https://codeforces.com/contest/1230/problem/E" target="_blank" rel="noopener">è¿™é“</a>ä¸€æ ·éƒ½ç”¨åˆ°äº† gcd ä¸ªæ•°ä¸è¶…è¿‡ logn çš„æ€§è´¨</p><h2 id="7-14-B"><a href="#7-14-B" class="headerlink" title="7.14 B"></a><a href="https://zjusummer.contest.codeforces.com/group/clkkguw3vK/contest/102647/problem/B" target="_blank" rel="noopener">7.14 B</a></h2><hr><p>å¬è¯´æ˜¯å¹¿ä¹‰ sam + çº¿æ®µæ ‘åˆå¹¶ï¼Œå’•å’•ï¼ˆé¢˜è§£å·²å­˜</p><h2 id="7-14-C"><a href="#7-14-C" class="headerlink" title="7.14 C"></a><a href="https://zjusummer.contest.codeforces.com/group/clkkguw3vK/contest/102647/problem/C" target="_blank" rel="noopener">7.14 C</a></h2><hr><p>å¬è¯´æ˜¯ wqs äºŒåˆ†ï¼Œå’•å’•</p><h2 id="7-14-D"><a href="#7-14-D" class="headerlink" title="7.14 D"></a><a href="https://zjusummer.contest.codeforces.com/group/clkkguw3vK/contest/102647/problem/D" target="_blank" rel="noopener">7.14 D</a></h2><hr><p>æœ‰æ€è·¯çš„é¢˜ï¼Œå¯¹äºæ¯ä¸ªç¬¬ä¸€æ­¥èµ°åˆ°çš„ (x, y)ï¼Œå»¶é•¿ç›´çº¿ç»è¿‡çš„æ•´ç‚¹ä¸ªæ•°æ˜¯ n / max(x, y)</p><p>ä¹Ÿå°±æ˜¯è¯´ n / max(x, y) + 1 = m ä¸” gcd(x, y) = 1</p><p>æšä¸¾å·¦ä¸ŠåŠè¾¹ï¼Œx å¤§äº y çš„éƒ¨åˆ†ï¼Œå°±æ˜¯æ±‚ n / x(ä¸‹å–æ•´) = m - 1 çš„ x</p><p><strong>x_min = n / m + 1, x_max = n / (m - 1)</strong></p><p>æ±‚ä¸ª phi çš„å‰ç¼€å’Œå°±å¥½äº†</p><h2 id="7-14-E"><a href="#7-14-E" class="headerlink" title="[7.14 E]"></a>[7.14 E]</h2><hr><p><a href="https://www.cnblogs.com/Flying2018/p/13297095.html" target="_blank" rel="noopener">https://www.cnblogs.com/Flying2018/p/13297095.html</a></p><p><a href="https://www.luogu.com.cn/blog/zkdxlpro/post-713-acm-bu-fen-jian-yao-ti-xie" target="_blank" rel="noopener">https://www.luogu.com.cn/blog/zkdxlpro/post-713-acm-bu-fen-jian-yao-ti-xie</a></p><p>å’•å’•å’•</p><h2 id="7-15-A"><a href="#7-15-A" class="headerlink" title="[7.15 A]"></a>[7.15 A]</h2><hr><p>ç®—å‡ºæœ€å¤§ç”Ÿæˆæ ‘å’Œæœ€å°ç”Ÿæˆæ ‘ï¼Œåˆ¤æ–­ä¹‹é—´æ˜¯å¦æœ‰æ–æ³¢é‚£å¥‘æ•°å­˜åœ¨ï¼ˆå¿…ç„¶å¯ä»¥ç”¨ä¸€äº› 1 è¾¹æ›¿æ¢æ‰ 0 è¾¹</p><h2 id="7-15-B"><a href="#7-15-B" class="headerlink" title="[7.15 B]"></a>[7.15 B]</h2><hr><p>è€ƒè™‘ä¸€ä¸ªåºåˆ—è‡ªåŠ¨æœºï¼ˆå°±æ˜¯æ¯ä¸ªä½ç½®å‘ä¹‹åç¦»è‡ªå·±æœ€è¿‘çš„26ä¸ªå­—ç¬¦çš„ä½ç½®åˆ†åˆ«è¿ä¸€æ¡è¾¹ï¼‰</p><p>ç›¸å½“äºåœ¨åºåˆ—è‡ªåŠ¨æœºä¸Šé€‰ä¸€ä¸ªé»‘ç‚¹ï¼Œé€‰ä»»æ„ä¸ªåç»§æŸ“é»‘</p><p>$sg(x) = mex_{T \subset nxt(x)}(XOR_{k\in T}sg(k))$</p><p>è€Œ sg åªä¼šæ˜¯ 2^0, 2^1, 2^2â€¦</p><p>è¿™ä¹Ÿå¾ˆå¥½æƒ³ï¼Œå½’çº³å¯å¾—ï¼Œè‹¥å½“å‰èŠ‚ç‚¹çš„ sg æ˜¯ 2^i, åç»§çš„ sg åªä¼šæ˜¯ 2^0, 2^1 â€¦ 2^{i - 1}ï¼Œé€‰ä»»æ„ä¸ª sg å€¼å¼‚æˆ–èµ·æ¥å¾—åˆ°çš„æ˜¯ 0 ~ 2^i - 1ï¼Œå› æ­¤ mex å‡ºæ¥å°±æ˜¯ 2^iã€‚</p><p>è¿™å°±ç­‰ä»·äºå¯¹åç»§çš„é‡æ ‡å·å– mexï¼Œéå¸¸å–µå–µ</p><h2 id="7-15-E"><a href="#7-15-E" class="headerlink" title="[7.15 E]"></a>[7.15 E]</h2><hr><p>çœŸå°± O(nlogn) ç®—æ³•æ»¡åœ°çˆ¬å‘—ã€‚ã€‚ã€‚æ¯”èµ›æ—¶æ²¡æƒ³æœ‰ç‚¹å¯æƒœ</p><p>å¯ä»¥ dfs åºä¸Šå»ºä¸»å¸­æ ‘ï¼Œæˆ–è€… dsu on tree + æ ‘çŠ¶æ•°ç»„ï¼Œæˆ–è€…çº¿æ®µæ ‘åˆå¹¶ï¼Œetcã€‚ã€‚</p><h2 id="7-15-F"><a href="#7-15-F" class="headerlink" title="[7.15 F]"></a>[7.15 F]</h2><hr><p>å·§å¦™çš„æ„é€ ã€‚é¢˜æ„å…¶å®å°±æ˜¯æ„é€ ä¸€ä¸ªæ²¡æœ‰ç­‰å·®æ•°åˆ—çš„æ’åˆ—ã€‚æ¯æ¬¡æŒ‰å¥‡å¶ä½æ’åºï¼Œä¾‹å¦‚å¥‡æ•°ä½æ”¾å‰é¢ã€å¶æ•°ä½æ”¾åé¢ï¼Œè¿™æ ·å°±æ¶ˆé™¤äº†è·¨è¶Šå·¦å³çš„ç­‰å·®æ•°åˆ—ï¼Œåˆ†æ²»æ€æƒ³</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Week2æµ‹è¯•é¢˜è§£</title>
      <link href="2020/07/15/Week2%E6%B5%8B%E8%AF%95%E9%A2%98%E8%A7%A3/"/>
      <url>2020/07/15/Week2%E6%B5%8B%E8%AF%95%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h2 id="AIZU2989"><a href="#AIZU2989" class="headerlink" title="AIZU2989"></a><a href="https://vjudge.net/contest/381744#problem/B" target="_blank" rel="noopener">AIZU2989</a></h2><hr><p>giaoï¼Œå…¨æƒ³ç€ Lã€R é€†æ¨äº†ï¼Œä½†æ˜¯å†™æŒ‚äº†ï¼Œçˆ¬ã€‚ã€‚å®é™…ä¸Šæœ‰æ›´å¥½å†™çš„åšæ³•</p><p>å‘ç° ai ç›¸å¯¹é¡ºåºæ— å…³ï¼Œå¯ä»¥å…ˆä»å°åˆ°å¤§æ’åºã€‚å®¹æ˜“å‘ç°æ“ä½œéƒ½æ˜¯ å°äºæŸæ•°çš„å‘å·¦ å¤§äºæŸæ•°çš„å‘å³ï¼Œai ä¸€ç›´å…·æœ‰å•è°ƒæ€§ï¼ˆè¿™ä¸ªæˆ‘æƒ³åˆ°äº†ã€‚ã€‚ï¼‰  äºŒåˆ†å°±å¥½äº†</p><h2 id="AIZU2990"><a href="#AIZU2990" class="headerlink" title="AIZU2990"></a><a href="https://vjudge.net/contest/381744#problem/C" target="_blank" rel="noopener">AIZU2990</a></h2><hr><p>æ³¨æ„ï¼Œåˆå§‹åªèƒ½å¾€å³èµ°ã€‚å°±æ˜¯ä¸ª sb é¢˜ï¼ï¼é¢˜ç›®è¯»é”™äº†å“­</p><p>ä¸€ç›´åœ¨æƒ³ setï¼Œä½†è¿™é¢˜ç”¨ set ä¼šå¾ˆéº»çƒ¦ã€‚</p><p>åºåˆ—å·®åˆ†ï¼Œç®—å‡ºæ¯ä¸ªç‚¹ç»è¿‡çš„æ¬¡æ•° xï¼Œæ¥å›çš„æ¬¡æ•°å°±æ˜¯ max{x}ï¼Œå‡å»çš„å‰åç¼€ä¹Ÿå¿…å®šæ˜¯ ç»è¿‡ x æ¬¡ç‚¹çš„æœ€å·¦å’Œæœ€å³ã€‚ã€‚ã€‚</p><h2 id="AGC041B"><a href="#AGC041B" class="headerlink" title="AGC041B"></a><a href="https://atcoder.jp/contests/agc041/tasks/agc041_b" target="_blank" rel="noopener">AGC041B</a></h2><hr><p>ä¸é”™çš„é¢˜ï¼Œå®¹æ˜“æƒ³åˆ°ç­”æ¡ˆæ»¡è¶³å•è°ƒæ€§ï¼Œå¯ä»¥äºŒåˆ†ã€‚äºŒåˆ†çš„ä½ç½®åªè¦å¥‹åŠ›è¶…è¿‡æˆ–èµ¶ä¸Š p å³å¯ï¼Œé‚£ä¹ˆ m ä½è¯„å§”å°½é‡ä¸æŠ• p å°±å¥½äº†ã€‚</p><h2 id="AIZU2992"><a href="#AIZU2992" class="headerlink" title="AIZU2992"></a><a href="https://vjudge.net/contest/381744#problem/E" target="_blank" rel="noopener">AIZU2992</a></h2><hr><p>ä¸æ˜¯å¾ˆéš¾çš„dpï¼Œå¯æƒœé¢˜ç›®è¯»ä¸æ‡‚ã€‚ã€‚</p><p>æ˜¾ç„¶ aï¼Œrï¼Œb ä»å¤§åˆ°å°æ’åºæœ€ä¼˜ã€‚dpï¼Œçº¢è‰²æ€»æ•°ä¸èƒ½è¶…è¿‡ totrï¼Œé»‘è‰²æ€»æ•°ä¸èƒ½è¶…è¿‡ totbï¼Œæ‰€ä»¥ f[i, j, k] è¡¨ç¤ºå‰ i + j ä¸­æœ‰ i çº¢ï¼Œj é»‘ï¼Œçº¢è‰²æ€»æ•°ä¸º k çš„æœ€å¤§ä¸æ”¹å˜é¢œè‰²çš„æ°”çƒæ•°é‡</p><h2 id="AIZU2995"><a href="#AIZU2995" class="headerlink" title="AIZU2995"></a><a href="https://vjudge.net/contest/381744#problem/F" target="_blank" rel="noopener">AIZU2995</a></h2><hr><p>å¥½é¢˜ï¼</p><p>è€ƒè™‘æ•´æ£µæ ‘ï¼Œæ¯ä¸ªç‚¹é€‰ ci è¿˜æ˜¯ diï¼Œè¿™è·Ÿâ€œæ ‘â€è¿™ä¸ªç»“æ„æ²¡æœ‰å…³ç³»ï¼Œå°±æ˜¯ä¸€ä¸ªç»å…¸é—®é¢˜ï¼šä¸€ä¸ª n ä¸ªç‚¹ m æ¡è¾¹çš„å›¾ï¼Œæ¯æ¡è¾¹è¿æ¥ ci å’Œ diï¼Œå¯ä»¥æŸ“é»‘ ci æˆ– diï¼Œé—®æœ€å¤§é»‘ç‚¹æ•°</p><p>æ˜¾ç„¶æ˜¯ min{|V|, |E|}ï¼šé¦–å…ˆæœ€å¤šæœ‰ |V| ä¸ªï¼Œå…¶æ¬¡å¦‚æœè¾¹ä¸º V - 1ï¼ˆæ˜¯æ ‘ï¼‰é‚£å°±æ˜¯ V - 1</p><p>min{|V|, |E|} = |V| - 1 + [æ˜¯å¦å­˜åœ¨éæ ‘è¾¹]ï¼Œå¹¶æŸ¥é›†ç»´æŠ¤å°±å¥½äº†ã€‚</p><p>å¯¹äºæ¯ä¸ªå­æ ‘ï¼šdsu on treeã€‚è€ƒè™‘åˆ° æœ‰åˆ é™¤æ“ä½œï¼Œç”¨å¯æ’¤é”€å¹¶æŸ¥é›†ç»´æŠ¤ã€‚æ˜¯çœŸçš„éš¾å†™ï¼ˆ</p><h2 id="AIZU2991"><a href="#AIZU2991" class="headerlink" title="AIZU2991"></a><a href="https://vjudge.net/contest/381744#problem/G" target="_blank" rel="noopener">AIZU2991</a></h2><hr><p>2^{n+1} ä¸­é€‰ 2^n ä¸ªï¼Œä¹Ÿå°±æ˜¯é€‰ä¸€åŠ</p><p>v å’Œ v ^ X å¿…ç„¶é€‰ä¸€ä¸ªï¼Œ&amp;å€¼ä¸º A çš„å¯¹å¿…ç„¶ä¸é€‰ä¸€ä¸ªï¼Œ|å€¼ä¸º O çš„å¯¹å¿…ç„¶ä¸é€‰ä¸€ä¸ªï¼ˆæ‰¾è¿™æ ·çš„å¯¹ï¼Œæšä¸¾å­é›†å³å¯</p><p>2-satï¼Œè¾“å‡ºå¡è¡Œæœ«ç©ºæ ¼æ¶å¿ƒäº†æˆ‘åŠå¤©</p><h2 id="AIZU2994"><a href="#AIZU2994" class="headerlink" title="AIZU2994"></a><a href="https://vjudge.net/contest/381744#problem/H" target="_blank" rel="noopener">AIZU2994</a></h2><hr><p>C = V - E + F</p><p>Cï¼šè¿é€šå—æ•°   Vï¼šç‚¹æ•°   Eï¼šè¾¹æ•°   Fï¼šå†…éƒ¨åŒºåŸŸæ•°</p><p>ï¼ˆæ³¨æ„ç½‘æ ¼å›¾ç»å¸¸è€ƒè¿™ä¸ªï¼‰</p><p>ç”±æœŸæœ›çš„çº¿æ€§æ€§å¾—ï¼ŒE(C) = E(V) - E(E) + E(F)</p><p>è€Œæœ¬é¢˜æ˜¯æ ‘ï¼ŒF ä¸º 0</p><p>æ‰€ä»¥ E(c1c2) = E(v1v2) + E(e1e2) - E(v1e2) - E(v2e1)</p><ul><li><p>ç‚¹ç‚¹è´¡çŒ®ï¼šå¯ä»¥æ¨æŸ¿å­ï¼ˆåˆ«å¿˜äº†ç»„åˆæ•°ï¼‰ï¼Œä¹Ÿæœ‰æ›´çµæ´»çš„è§£æ³•ã€‚è€ƒè™‘ä¸€å¯¹ç‚¹ (a, b) çš„è´¡çŒ®ï¼ˆa åœ¨æ ‘ 1 ä¸­ï¼Œb åœ¨æ ‘ 2 ä¸­ï¼‰ï¼Œæ˜¯ 1 / 4, è€Œæ€»å…±æœ‰ n(n - 1) å¯¹ç‚¹ï¼Œæ‰€ä»¥å°±æ˜¯ n(n - 1) / 4</p></li><li><p>ç‚¹è¾¹è´¡çŒ®ï¼šæšä¸¾æ ‘ 2 ä¸­ä¸€æ¡è¾¹ (u, v)ï¼Œä¸æ ‘ 1 ä¸­ç‚¹ x çš„è´¡çŒ®æ˜¯ 1 / 8, æ€»å…±æ˜¯ (n - 1)(n - 2) / 8</p></li><li><p>è¾¹è¾¹è´¡çŒ®ï¼šè¿™ä¸ªå°±ä¸èƒ½ O(1) ç®—äº†ï¼Œæšä¸¾æ ‘ 2 ä¸­ä¸€æ¡è¾¹ (u, v)ï¼Œä¸æ ‘ 1 ä¸­è¾¹çš„æ€»è´¡çŒ®æ˜¯ (n - 1 - uå’Œvåœ¨æ ‘ 1 ä¸­è¿çš„è¾¹) / 16</p></li></ul><p>å¥—è·¯ï¼Œæ®æˆ‘å“¥è¯´åœ¨ä»–ä»¬é‚£ä¸ªæ—¶å€™ï¼Œä¹˜ç§¯æœŸæœ›ä¹Ÿæ˜¯å¥—è·¯é¢˜å“‡ï¼å¤šç»ƒå¤šç»ƒ</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ä¹ é¢˜é€‰è®²ã€‘æ ‘çš„è¿›é˜¶</title>
      <link href="2020/07/15/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91%E6%A0%91%E7%9A%84%E8%BF%9B%E9%98%B6/"/>
      <url>2020/07/15/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91%E6%A0%91%E7%9A%84%E8%BF%9B%E9%98%B6/</url>
      
        <content type="html"><![CDATA[<p>éš¾åº¦é€’å¢ï¼</p><h2 id="CF1305D"><a href="#CF1305D" class="headerlink" title="CF1305D"></a><a href="https://codeforces.com/problemset/problem/1305/D" target="_blank" rel="noopener">CF1305D</a></h2><hr><p>n / 2 æ¬¡è¯¢é—®ï¼Œæƒ³åˆ°æ¯æ¬¡åˆ è‡³å°‘ä¸¤ä¸ªèŠ‚ç‚¹ã€‚æœ€æš´åŠ›çš„æ€è·¯æ˜¯é€‰ä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œå°† lca ä¸ºæ ¹çš„ä¸¤ä¸ªèŠ‚ç‚¹æ‰€åœ¨çš„å­æ ‘åˆ æ‰ï¼Œä½†æ˜¯è¿™ä¼šè¢«ä¸€æ¡é“¾çš„æƒ…å†µå¡æˆè¯¢é—® n æ¬¡ã€‚è€ƒè™‘é€‰ä»»æ„ä¸¤ä¸ªå¶å­ï¼Œè‹¥ lca ç­‰äºå…¶ä¸­ä¹‹ä¸€é‚£ä¹ˆé‚£ä¸ªå¶å­å°±æ˜¯æ ¹ï¼Œå¦åˆ™åˆ é™¤ä¸¤ä¸ªå¶å­ã€‚</p><h2 id="CF1210C"><a href="#CF1210C" class="headerlink" title="CF1210C"></a><a href="https://codeforces.com/problemset/problem/1210/C" target="_blank" rel="noopener">CF1210C</a></h2><hr><p>è¯¢é—®æ¯æ¡é“¾çš„ gcd ä¹‹å’Œã€‚è€ƒè™‘ gcd ä¸€ä¸ªå¾ˆé‡è¦çš„æ€§è´¨ï¼šé•¿åº¦ä¸º n çš„åŒºé—´æ‰€æœ‰å­åŒºé—´çš„ gcd ä¸ä¼šè¶…è¿‡ logn ä¸ªã€‚log çº§åˆ«ï¼Œå¼€ vector æˆ–è€… map å­˜æ¯ä¸ªèŠ‚ç‚¹ä¸ºä¸‹ç«¯ç‚¹çš„é“¾gcdï¼Œæ¯æ¬¡æ›´æ–°åªæœ‰ logn å¤æ‚åº¦ã€‚</p><h2 id="CF980E"><a href="#CF980E" class="headerlink" title="CF980E"></a><a href="https://codeforces.com/problemset/problem/980/E" target="_blank" rel="noopener">CF980E</a></h2><hr><p>è€ƒè™‘åˆ° 2^i æ˜¯ä¸ªå¾ˆç‰¹æ®Šçš„ä¸œè¥¿ï¼Œå¿…ç„¶è´ªå¿ƒçš„é€‰ i å¤§çš„èŠ‚ç‚¹ã€‚æŒ‰ i ä»å¤§åˆ°å°æ’åºï¼Œi èŠ‚ç‚¹ä¿è¯è¢«é€‰çš„å‰ææ˜¯ i åˆ°æ ¹çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½ä¿ç•™ï¼Œæš´åŠ›åˆ¤ä¿ç•™èŠ‚ç‚¹åæ˜¯å¦è¶…è¿‡ n - K ä¼š TLEï¼Œå¯ä»¥ç”¨ dfs åºä¸Šæ ‘çŠ¶æ•°ç»„ã€‚åšæ ‡è®°æš´åŠ›è·³å°±å¥½äº†ï¼Œåæ­£æ˜¯ O(n).</p><h2 id="CF1098C"><a href="#CF1098C" class="headerlink" title="CF1098C"></a><a href="https://codeforces.com/problemset/problem/1098/C" target="_blank" rel="noopener">CF1098C</a></h2><hr><p>è€ƒè™‘ Kï¼ˆæœ€å¤§åˆ†æ”¯ï¼‰æ»¡è¶³äºŒåˆ†æ€§è´¨ï¼Œå…ˆäºŒåˆ†å‡ºæœ€ç»ˆç­”æ¡ˆ ansï¼Œåˆ¤èƒ½å¦æ„æˆæ ‘çš„æ¡ä»¶æ˜¯ï¼šä¸€æ¡é“¾å½¢å¼çš„å­æ ‘å’Œ &gt;= S, K å‰æ ‘å½¢å¼çš„å­æ ‘å’Œ &lt;= Sã€‚æ„é€ ä¹Ÿå¾ˆå®¹æ˜“ï¼Œæˆ‘çš„æ–¹æ³•æ˜¯å°†ä¸€æ¡é“¾çš„æœ«å°¾èŠ‚ç‚¹ä¸æ–­æŒ‚ä¸Šæ¥ï¼Œå¡«ä¸€æ£µ K å‰æ ‘ã€‚</p><h2 id="CF1149C"><a href="#CF1149C" class="headerlink" title="CF1149C"></a><a href="https://codeforces.com/contest/1149/problem/C" target="_blank" rel="noopener">CF1149C</a></h2><hr><p>æœ‰æ„æ€çš„é¢˜ï¼Œè€ƒè™‘ç›´å¾„çš„æ‹¬å·åºåˆ—ï¼Œå¿…ç„¶æ˜¯ )))())))â€¦(((((()(((( è¿™æ · â€˜)))))â€™ + åŒ¹é…æ‹¬å· + â€˜(((((â€˜ çš„å½¢å¼ã€‚ç»å…¸å¥—è·¯ï¼Œå°† ( è®¾ä¸º 1ï¼Œ) è®¾ä¸º -1ï¼Œç­”æ¡ˆå°±æ˜¯ç›¸é‚»çš„ä¸¤æ®µåºåˆ—ä¹‹å·®æœ€å¤§å€¼ï¼Œå¯ä»¥ç”¨çº¿æ®µæ ‘ç»´æŠ¤ï¼ˆå„ç§ç»†èŠ‚å•Šå•Šå•Šã€‚ã€‚</p><h2 id="CF1083C"><a href="#CF1083C" class="headerlink" title="CF1083C"></a><a href="https://codeforces.com/contest/1083/problem/C" target="_blank" rel="noopener">CF1083C</a></h2><hr><p>æœ‰æ„æ€çš„é¢˜+1ï¼Œè¯¢é—®æ¯æ¡é“¾æœ€å¤§çš„ mexã€‚ç¥ä»™åšæ³•ã€‚é¦–å…ˆï¼Œèƒ½çº¿æ®µæ ‘ç»´æŠ¤çš„ä¿¡æ¯éƒ½å…·æœ‰<strong>å¯åˆå¹¶æ€§</strong>ã€‚å®¹æ˜“æƒ³åˆ°äºŒåˆ† mexï¼Œåˆ¤èƒ½å¦æ„æˆé“¾ã€‚çº¿æ®µæ ‘ [l, r] èŠ‚ç‚¹è¡¨ç¤º æƒå€¼ä¸º l ~ r çš„èŠ‚ç‚¹èƒ½å¦æ„æˆé“¾ï¼Œåˆå¹¶æ—¶æšä¸¾ç«¯ç‚¹ç”¨ lca åˆ¤ç‚¹æ˜¯å¦åœ¨è·¯å¾„ä¸Šå³å¯ã€‚æœ€åå¤–é¢é‚£ä¸ªäºŒåˆ†ä¹Ÿå¯ä»¥çœæ‰ï¼Œç›´æ¥åœ¨çº¿æ®µæ ‘ä¸Šâ€œäºŒåˆ†â€ï¼Œç»Ÿè®¡ç­”æ¡ˆã€‚</p><h2 id="AGC023F"><a href="#AGC023F" class="headerlink" title="AGC023F"></a><a href="https://atcoder.jp/contests/agc023/tasks/agc023_f" target="_blank" rel="noopener">AGC023F</a></h2><hr><p>ç¥ä»™é¢˜++</p><p>å…ˆè€ƒè™‘å‰ç½®é—®é¢˜ï¼šä¸¤ä¸ª 01 åºåˆ—ç›¸æ¥ï¼Œé€†åºå¯¹å°½é‡å°</p><p>è®¾å®ƒä»¬ 01 ä¸ªæ•°åˆ†åˆ«ä¸º sx0, sx1, sy0, sy1, x &lt; y</p><p>æ˜¾ç„¶ sx1 * sy0 &lt;= sx0 * sy1 æ—¶ä¸å¿…äº¤æ¢ä¸¤è€…ã€‚</p><p>å˜å½¢ï¼šsx1 / sx0 &lt;= sy1 / sy0.</p><p>è€ƒè™‘æ­¤é¢˜ï¼Œåˆå§‹æ—¶å°†ç‚¹çœ‹ä½œè¿é€šå—ï¼Œå–å‡ºç›®å‰æ²¡æœ‰è¢«é€‰ä¸” s1 / s0 æœ€å°çš„è¿é€šå—ï¼ˆå †ç»´æŠ¤ï¼‰</p><p>è‹¥å®ƒçš„çˆ¶äº²å·²ç»è¢«é€‰ï¼Œå°±é€‰äº†å®ƒï¼›å¦åˆ™å®¹æ˜“è¯æ˜å®ƒä¸€å®šä¼šåœ¨å®ƒçš„æ ¹çš„çˆ¶äº²è¢«é€‰åç«‹åˆ»è¢«é€‰ï¼Œå°±å°†å®ƒå’Œæ ¹çš„çˆ¶äº²æ‰€åœ¨è¿é€šå—åˆå¹¶ï¼Œå¾—åˆ°æ–°çš„è¿é€šå—</p><p>ç±»ä¼¼çš„è¿˜æœ‰ POJ2054-Color a Treeï¼Œè´ªå¿ƒçš„æ¯æ¬¡å°†æœ€å¤§çš„ç‚¹å’Œå®ƒçˆ¶äº²åˆå¹¶</p><h2 id="CF1168D"><a href="#CF1168D" class="headerlink" title="CF1168D"></a><a href="https://codeforces.com/contest/1168/problem/d" target="_blank" rel="noopener">CF1168D</a></h2><hr><p>å……è¦æ¡ä»¶æ˜¯æ‰€æœ‰å¶å­çš„æ·±åº¦ç›¸åŒï¼Œè®¾ä¸º mxdep, è®¾ lenx = mxdep - depx</p><p>ä¸”å¯¹äºä»»ä½•èŠ‚ç‚¹ xï¼Œsum{f(x, c)} &lt;= lenxï¼Œå…¶ä¸­ f(x, c) è¡¨ç¤ºä»»ä½•ä¸€æ¡ x åˆ°å…¶å­æ ‘ä¸­å¶å­çš„é“¾ä¸Š c å‡ºç°æ¬¡æ•°çš„æœ€å¤§å€¼</p><p>è¯å¿…è¦æ€§ï¼šæ˜¾ç„¶       è¯å……åˆ†æ€§ï¼šæ®è¯´ç”¨å½’çº³æ³•è¯æ˜</p><p>æ€ä¹ˆå¤„ç†ä¿®æ”¹ï¼Ÿæ€»ä¸èƒ½æ¯æ¬¡æš´åŠ›å¾€ä¸Šè·³ä¿®æ”¹ f(x, c) å§ã€‚</p><p>æ³¨æ„åˆ°å½“èŠ‚ç‚¹åªæœ‰ä¸€ä¸ªå­©å­æ—¶ä¸éœ€è¦åˆ¤ä¸Šé¢é‚£ä¸ªä¸œè¥¿ï¼Œç›¸å½“äºå¯ä»¥å¿½è§†</p><p>å› æ­¤æƒ³åˆ°å°†çˆ¶äº²åªæœ‰è‡ªå·±ä¸€ä¸ªå­©å­çš„èŠ‚ç‚¹å‘ä¸Šå‹ç¼©ï¼Œä¿®æ”¹çš„å¤æ‚åº¦å°±æ˜¯æ·±åº¦</p><p>è€Œæ»¡è¶³æ¯ä¸€å±‚çš„èŠ‚ç‚¹ä¸ªæ•°éƒ½ä¸¥æ ¼å¤§äºä¸Šä¸€å±‚ï¼ˆä¸ç„¶å°±å‹ç¼©äº†ï¼‰ï¼Œæ·±åº¦åªæœ‰ sqrt(n)</p><p>æ€»å¤æ‚åº¦å°±æ˜¯ O(Qsqrt(n)), éå¸¸çš„å–µï¼</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€ä¹ é¢˜é€‰è®²ã€‘å­—ç¬¦ä¸²</title>
      <link href="2020/07/09/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
      <url>2020/07/09/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91%E5%AD%97%E7%AC%A6%E4%B8%B2/</url>
      
        <content type="html"><![CDATA[<h2 id="POJ3167"><a href="#POJ3167" class="headerlink" title="[POJ3167]"></a>[POJ3167]</h2><hr><p>KMP + æ ‘çŠ¶æ•°ç»„ï¼Œæ³¨æ„ç»†èŠ‚</p><h2 id="CF547E"><a href="#CF547E" class="headerlink" title="[CF547E]"></a>[CF547E]</h2><hr><p>å¥—è·¯å¥½é¢˜ï¼ˆ</p><p>é¦–å…ˆæœ‰ä¸ªæ€§è´¨ï¼šACè‡ªåŠ¨æœº fail æ ‘ä¸Šçš„çˆ¶äº²èŠ‚ç‚¹æ˜¯å­èŠ‚ç‚¹çš„å­ä¸²ã€‚</p><p>ç„¶åå°±æœ‰ä¸ªç»å…¸å¥—è·¯ï¼šACè‡ªåŠ¨æœºä¸Šæ‰¾ä¸€ä¸ªä¸²çš„å‡ºç°æ¬¡æ•°å¯ä»¥åœ¨ fail æ ‘ä¸Šè·‘ã€‚</p><p>å°†è¯¢é—®ç¦»çº¿ï¼Œä»å°åˆ°å¤§æ’å…¥ AC è‡ªåŠ¨æœºï¼ˆæ’å…¥æ–¹æ³•æ˜¯èŠ‚ç‚¹ val = 1ï¼‰ï¼Œæ ‘çŠ¶æ•°ç»„ç»´æŠ¤ dfs åºç®—è¯¢é—®ç‚¹å­æ ‘ä¸­ 1 çš„ä¸ªæ•°ã€‚</p><h2 id="965E"><a href="#965E" class="headerlink" title="[965E]"></a>[965E]</h2><hr><p>è€ƒè™‘åœ¨ Trie ä¸Šåšã€‚ç„¶åå°±å˜æˆä¸€æ£µæœ‰è®¸å¤šé»‘ç‚¹çš„ Trie æ ‘ï¼Œè¦å°†é»‘ç‚¹å°½å¯èƒ½åœ°æ”¾åˆ°ç¥–å…ˆèŠ‚ç‚¹å»ã€‚</p><p>ä¼˜å…ˆé˜Ÿåˆ—ç»´æŠ¤ï¼Œä¼˜å…ˆæ”¾åŸæœ¬æ·±åº¦å¤§çš„ç‚¹ã€‚</p><h2 id="HDU3336"><a href="#HDU3336" class="headerlink" title="[HDU3336]"></a>[HDU3336]</h2><hr><p>KMP æ€§è´¨é¢˜ã€‚AC è‡ªåŠ¨æœºä¸Šæ‰¾ä¸²å‡ºç°æ¬¡æ•°å¯ä»¥è·‘ fail æ ‘ï¼Œä½†æœ¬é¢˜è¦æ‰€æœ‰å‰ç¼€ï¼Œä¼šTLEã€‚</p><p>è€ƒè™‘ fail æŒ‡é’ˆæ„ä¹‰ï¼Œè®¾è®¡ DPï¼šf[i] è¡¨ç¤ºä»¥ i ç»“å°¾çš„æ‰€æœ‰å‰ç¼€ä¸ªæ•°ï¼Œf[i] = f[fail[i]] + 1.</p><h2 id="HDU5536"><a href="#HDU5536" class="headerlink" title="[HDU5536]"></a>[HDU5536]</h2><hr><p>å¥—è·¯é¢˜ç›´æ¥ä¸Š 01 trieï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼šæœ¬é¢˜ n^3 ä¼š TLEï¼Œå› ä¸ºé‡å¤æ’å…¥äº†å¾ˆå¤šä¸²ï¼› n^2 æšä¸¾ i å’Œ j å†å‡æ‰ Trie ä¸­ i å’Œ j ä¸²çš„è´¡çŒ®å°±å¯ä»¥è¿‡å•¦ã€‚</p><hr><p>æ€»ç»“ï¼š</p><ul><li><p>KMP å’Œ AC è‡ªåŠ¨æœºå¯è§£å†³å‡ºç°ä½ç½®ï¼ˆåˆ†åˆ«ç”¨ fail æŒ‡é’ˆå’Œ fail æ ‘ï¼‰ï¼›</p></li><li><p>æƒ³é™¤å» Trie æˆ– AC è‡ªåŠ¨æœºä¸­æŸä¸ªä¸²æ—¶åªè¦å°† ä¸²æ²¿é€”çš„ val -= 1 å°±å¥½äº†</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> ACè‡ªåŠ¨æœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[HDU4653]-æˆ‘çš„å¾®ç§¯åˆ†åˆæ¢</title>
      <link href="2020/07/08/%5BHDU4653%5D-%E6%88%91%E7%9A%84%E5%BE%AE%E7%A7%AF%E5%88%86%E5%88%9D%E6%8E%A2/"/>
      <url>2020/07/08/%5BHDU4653%5D-%E6%88%91%E7%9A%84%E5%BE%AE%E7%A7%AF%E5%88%86%E5%88%9D%E6%8E%A2/</url>
      
        <content type="html"><![CDATA[<p><a href="https://coderoj.gitee.io/2020/07/01/3880663/" target="_blank" rel="noopener">åŒç­å¤§ä½¬åˆšäº†ä¸€æ™šçš„åšå®¢</a></p><p>çœŸçš„å¾ˆç¥äº†ï¼Œä»ä»–çš„åšå®¢é‡Œä¹Ÿèƒ½å­¦åˆ°ç†è®ºçŸ¥è¯†ï¼Œæœ¬ç¯‡åšå®¢ä¸»è¦å¯¹ä¸Šæ–‡ä¸­éƒ¨åˆ†æ–‡å­—åšè§£é‡Š ~</p><ul><li><p>åŸå‡½æ•°ï¼šå¯¹äºä¸€ä¸ªå®šä¹‰åœ¨æŸåŒºé—´çš„å·²çŸ¥å‡½æ•° $f(x)$ï¼Œå¦‚æœå­˜åœ¨å¯å¯¼å‡½æ•° $F(x)$ï¼Œä½¿å¾—åœ¨è¯¥åŒºé—´å†…çš„ä»»ä¸€ç‚¹éƒ½å­˜åœ¨ $dF(x)=f(x)dx$ï¼Œåˆ™åœ¨è¯¥åŒºé—´å†…å°±ç§°å‡½æ•°$F(x)$ ä¸ºå‡½æ•° $f(x)$ çš„åŸå‡½æ•°ã€‚</p></li><li><p>ç‰›é¡¿-è±å¸ƒå°¼èŒ¨å…¬å¼ï¼ˆå¾®ç§¯åˆ†åŸºæœ¬å®šç†ï¼‰ï¼šä¸€ä¸ªè¿ç»­å‡½æ•°åœ¨åŒºé—´ $[aï¼Œb]$ ä¸Šçš„å®šç§¯åˆ†ç­‰äºå®ƒçš„ä»»æ„ä¸€ä¸ªåŸå‡½æ•°åœ¨åŒºé—´ $[aï¼Œb]$ ä¸Šçš„å¢é‡</p></li></ul><p>â€”â€”ç”¨<a href="https://www.shuxuele.com/calculus/integration-introduction.html" target="_blank" rel="noopener">ç‚¹è¿™é‡Œ</a> æ³¨æ°´é‚£ä¸ªä¾‹å­æ¥è§£é‡Šï¼Œè¿ç»­å‡½æ•°å°±æ˜¯ $f(x) = 2x$, åŸå‡½æ•°å°±æ˜¯ $F(x) = x^2 + C$</p><ul><li><p>æ ¹æ®<a href="https://www.shuxuele.com/calculus/integration-rules.html" target="_blank" rel="noopener">ç§¯åˆ†æ³•åˆ™</a>å¯ä»¥å¾—åˆ° $\int^1_0 y^{p-1}*dx = (\frac{1}{p}*y^p)|^1_0$ï¼Œå…¶ä¸­ç­‰å¼å³è¾¹è¡¨ç¤º å°† $1$ å’Œ $0$ ä»£å…¥ $\frac{1}{p}*y^p$ åç›¸å‡ï¼ŒåŸç†æ˜¯ğŸ‘†å¾®ç§¯åˆ†åŸºæœ¬å®šç†</p></li><li><p>å¯¹äºä¸¤ä¸ªä¸ç›¸å…³çš„äº‹ä»¶ï¼Œä¹˜ç§¯çš„æœŸæœ› = æœŸæœ›çš„ä¹˜ç§¯ï¼Œä¸”æœ¬é¢˜åœ¨å•ä½çƒä¸­ï¼ˆåŠå¾„ä¸º $1$ï¼‰ï¼Œå› æ­¤ $k$ æ‰©å±•é‚£é‡Œ $ans(p, n, k) = ans(p, n - 1, k - 1) * ans(p, n, 0)$ï¼Œç›¸å½“äºæŠŠç¬¬ $k$ ä¸ªçš„è·ç¦»ç¼©åˆ°ç¬¬ $0$ ä¸ªçš„è·ç¦»èŒƒå›´å†…ã€‚</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> æ¦‚ç‡ä¸æœŸæœ› </tag>
            
            <tag> å¾®ç§¯åˆ† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ä¹ é¢˜é€‰è®²ã€‘è´ªå¿ƒ</title>
      <link href="2020/07/07/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91%E8%B4%AA%E5%BF%83/"/>
      <url>2020/07/07/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91%E8%B4%AA%E5%BF%83/</url>
      
        <content type="html"><![CDATA[<p>ä¸“é¢˜åŠ©æˆ‘å‘ç°ï¼šæˆ‘è´ªå¿ƒå¼±çš„ä¸€ï¼ï¼ï¼å¤šç»ƒï¼ï¼ï¼</p><h2 id="CF1373F"><a href="#CF1373F" class="headerlink" title="CF1373F"></a><a href="https://codeforces.com/problemset/problem/1373/F" target="_blank" rel="noopener">CF1373F</a></h2><hr><p>åšæ³•ä¸€ï¼šäºŒåˆ† + è´ªå¿ƒ O(nlogn)ï¼ˆé¢˜è§£åšæ³•ï¼‰</p><p>æœ¬é¢˜å•è°ƒæ€§ä½“ç°åœ¨å“ªå‘¢ï¼Ÿï¼Ÿæ˜¾ç„¶å½“ç¬¬ä¸€ä¸ªç”µç«™ä¾›åº”é‡ç¡®å®šæ—¶ï¼Œæ‰€æœ‰ç”µç«™çš„ä¾›åº”é‡éƒ½ç¡®å®šäº†</p><p>è®¾ b[1] æµç»™ a[1] çš„é‡ä¸º x</p><p>æœ‰ä¸¤ç§æƒ…å†µï¼š<br>Â· â€œæ–­æµâ€ï¼Œå³ x å¤ªå¤§ï¼Œå¯¼è‡´ b[1] ç»™ a[2] ä¾›åº”å¤ªå°‘ï¼Œå¯¼è‡´åé¢æ–­æµ<br>Â· æµä¸€åœˆåä» b[n] æµå› a[1] çš„é‡åŠ ä¸Š x ä¸ &gt;= a[1]ï¼Œå› ä¸ºä¸­é€”å¯èƒ½æœ‰ç‚¹æ»¡æµ</p><p>ä¹Ÿå°±æ˜¯è¯´ x å¤ªå¤§å¤ªå°éƒ½ä¸è¡Œï¼ŒäºŒåˆ†ä¼ å›å€¼æ ‡è®°ä¸€ä¸‹å°±è¡Œäº†ã€‚</p><p>åšæ³•äºŒï¼šå·®åˆ†çº¦æŸ O(n)</p><p>è§‚å¯Ÿåˆ°æœ‰å¾ˆå¤šé™åˆ¶ï¼Œè®¾ x[i] è¡¨ç¤º b[i] ç»™ a[i] çš„é‡å°±å¯ä»¥å·®åˆ†çº¦æŸï¼Œä½†æ˜¯ spfa è·‘æ˜¯ n^2 çš„å¥½åƒä¼šè¢«å¡ï¼Œï¼Œè§‚å¯Ÿå»ºæˆçš„å›¾ï¼Œæ˜¯ä¸€æœµèŠèŠ±çš„æ ·å­ï¼Œè€Œæˆ‘ä»¬åªè¦åˆ¤æ˜¯å¦æœ‰æ­£æƒç¯å°±è¡Œï¼Œè¿™ä¸ªå¯ä»¥ O(n) åšã€‚</p><p>åšæ³•äºŒ Codeï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e6</span> + <span class="number">10</span>, inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll T, n, a[N], b[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">        ll tot = <span class="number">0</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]), tot -= a[i];</span><br><span class="line">        rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;b[i]), tot += b[i];</span><br><span class="line">        <span class="keyword">if</span> (tot &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"NO"</span>); <span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">bool</span> ff = <span class="number">1</span>;</span><br><span class="line">ll mn = b[<span class="number">1</span>], sum = <span class="number">0</span>;</span><br><span class="line">rep(i, <span class="number">1</span>, <span class="number">2</span> * n) &#123;</span><br><span class="line">sum += a[i % n + <span class="number">1</span>] - b[i % n + <span class="number">1</span>];</span><br><span class="line">mn = min(mn, sum + b[i % n + <span class="number">1</span>]);</span><br><span class="line"><span class="keyword">if</span> (sum - mn &gt; <span class="number">0</span>) &#123;</span><br><span class="line">ff = <span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">        <span class="built_in">puts</span>(ff ? <span class="string">"YES"</span> : <span class="string">"NO"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="NOIP2012å›½ç‹æ¸¸æˆ"><a href="#NOIP2012å›½ç‹æ¸¸æˆ" class="headerlink" title="NOIP2012å›½ç‹æ¸¸æˆ"></a><a href="https://www.luogu.com.cn/problem/P1080" target="_blank" rel="noopener">NOIP2012å›½ç‹æ¸¸æˆ</a></h2><hr><p>å¾ˆç»å…¸çš„é¢˜ï¼Œè´ªå¿ƒ + é«˜ç²¾åº¦</p><p>é‚»é¡¹äº¤æ¢ï¼Œå¾®æ‰°å¯ä»¥è¯æ˜è´ªå¿ƒæ­£ç¡®æ€§</p><h2 id="CF1251E2"><a href="#CF1251E2" class="headerlink" title="CF1251E2"></a><a href="https://codeforces.com/problemset/problem/1251/E2" target="_blank" rel="noopener">CF1251E2</a></h2><hr><p>è€ƒè™‘é€‰æ‹© x äººæ—¶ï¼Œæ‰€æœ‰ mi &lt; x çš„äººéƒ½ä¼šè‡ªåŠ¨æŠ•ç¥¨ï¼Œæ‰€ä»¥å°† m é™åºæ’åˆ—ä¸”é™åºå¤„ç†</p><h2 id="CF1329C"><a href="#CF1329C" class="headerlink" title="CF1329C"></a><a href="https://codeforces.com/problemset/problem/1329/C" target="_blank" rel="noopener">CF1329C</a></h2><hr><p>ä¸€å¥è¯é¢˜æ„ï¼šæ‹¿æ‰å…ƒç´ å’Œå°½å¯èƒ½å¤§çš„åŒæ—¶ç»´æŠ¤äºŒå‰å †æ€§è´¨</p><p>æˆ‘ä»¬è‚¯å®šè´ªå¿ƒçš„å–é è¿‘æ ¹ç»“ç‚¹çš„ä½ç½®ï¼Œæ¯ä¸ªä½ç½®å–åˆ°ä¸èƒ½å–ä¸ºæ­¢ã€‚</p><p>ä»€ä¹ˆå«ä¸èƒ½å–ï¼Ÿå®ƒæ‰¯ä¸Šæ¥é‚£æ¡é“¾çš„æœ«å°¾èŠ‚ç‚¹æ·±åº¦ä¸º g äº†ã€‚æ‰€ä»¥æˆ‘ä»¬å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤é“¾å°¾èŠ‚ç‚¹å°±å¥½äº†ï¼</p><h2 id="AtCoder-cf17-final-d"><a href="#AtCoder-cf17-final-d" class="headerlink" title="AtCoder-cf17_final_d"></a><a href="https://atcoder.jp/contests/cf17-final/tasks/cf17_final_d?lang=en" target="_blank" rel="noopener">AtCoder-cf17_final_d</a></h2><hr><p><a href="https://img.atcoder.jp/cf17-final/editorial.pdf" target="_blank" rel="noopener">https://img.atcoder.jp/cf17-final/editorial.pdf</a></p><p>Â· è´ªå¿ƒ + dp</p><p>å…³äºä¸ºä»€ä¹ˆæŒ‰ hi + pi å‡åºæ’åˆ—ï¼Œå®˜æ–¹é¢˜è§£è¯´çš„å¾ˆæœ‰é“ç†ï¼Œå¤§è‡´æ„æ€å°±æ˜¯ æ˜¾ç„¶å¯¹äºé«˜åº¦çš„é™åˆ¶<strong>è¶Šæ¾è¶Šå¥½</strong>ï¼Œé€šè¿‡é‚»é¡¹å¾®æ‰°æ¥è¯æ˜è´ªå¿ƒæ­£ç¡®æ€§ã€‚</p><p>è¿™è¾¹æä¾›å¦å¤–ä¸€ç§è¯æ˜ï¼šè€ƒè™‘ä¸€ä¸ªåˆæ³•çš„é€‰çš„åºåˆ—ï¼Œå¯¹äºæ¯ä¸€ä¸ª i å¿…é¡»æ»¡è¶³ sum_{j &lt;= i}{h_j} &lt;= h_i + p_i,<br>å› ä¸ºå‰ç¼€å’Œé€’å¢æ‰€ä»¥ hi + pi ä¹Ÿå¿…é¡»é€’å¢ã€‚</p><p>æ€»ä¹‹æ˜¯ä¸€é“å¾ˆå¦™çš„é¢˜ï¼</p><h2 id="HDU5380"><a href="#HDU5380" class="headerlink" title="HDU5380"></a><a href="https://vjudge.net/problem/HDU-5380" target="_blank" rel="noopener">HDU5380</a></h2><hr><p><a href="https://www.cnblogs.com/keximeiruguo/p/7684032.html" target="_blank" rel="noopener">https://www.cnblogs.com/keximeiruguo/p/7684032.html</a></p><p>æŠŠç³–æœè§†ä½œä»·æ ¼é«˜ä½ä¸åŒï¼Œå°±å¯ä»¥è´ªå¿ƒäº†ï¼ˆè¿™é¢˜å¥½hard</p><h2 id="luogu1484ç§æ ‘"><a href="#luogu1484ç§æ ‘" class="headerlink" title="luogu1484ç§æ ‘"></a><a href="https://www.luogu.com.cn/problem/P1484" target="_blank" rel="noopener">luogu1484ç§æ ‘</a></h2><hr><p>è¿™ç±»é—®é¢˜é€‰æ‹©å½“å‰æœ€ä¼˜è§£æ—¶å¯èƒ½ä¸æ˜¯å…¨å±€æœ€ä¼˜è§£ï¼Œé‚£æ€ä¹ˆåŠï¼Ÿ<strong>åæ‚”è´ªå¿ƒ</strong> å¯ä»¥ä½¿å¾—è´ªå¿ƒéšä¾¿é€‰æ‹©ï¼Œéƒ½èƒ½åˆ°è¾¾æ­£è§£ã€‚</p><p>å…·ä½“æ“ä½œç”¨ä¼˜å…ˆé˜Ÿåˆ—ã€‚å¯¹äºé™åˆ¶é‡‡ç”¨ç¼©ç‚¹ï¼ˆç”¨äº† i å°±å°† l[i]ã€iã€r[i] ç¼©åœ¨ä¸€èµ·ï¼Œåæ‚”äº†é€‰æ‹©äº† l[i] å’Œ r[i] å°±å°† l[l[i]]ã€l[i]ã€iã€r[i]ã€r[r[i]] ç¼©åœ¨ä¸€èµ·ï¼‰ï¼Œåæ‚”å°±å°†æƒå€¼ä¸º val[l[i]] + val[r[i]] - val[i] çš„ç‚¹å…¥é˜Ÿï¼Œæ¯æ¬¡å–é˜Ÿé¦–å°±å¥½äº†ã€‚</p><h2 id="SP27102"><a href="#SP27102" class="headerlink" title="SP27102"></a><a href="https://www.luogu.com.cn/problem/SP27102" target="_blank" rel="noopener">SP27102</a></h2><hr><p>æˆ‘ä»¬ä¼˜å…ˆæ ¼å¼åŒ– a &lt;= b çš„ç¡¬ç›˜ï¼ŒæŒ‰ a ä»å°åˆ°å¤§æ’åºï¼Œå¯ä»¥å°½é‡ç”¨å°‘çš„ç©ºé—´æ¥æ¢å¤šçš„ç©ºé—´ï¼Œè´ªå¿ƒï¼Œä½¿å¾—ç­–ç•¥æœ€å¯èƒ½æˆåŠŸã€‚</p><hr><p>æ€»ç»“ï¼šåšè´ªå¿ƒé¢˜ç›´è§‰å¾ˆé‡è¦ï¼Œé™åˆ¶è¶Šæ¾è¶Šå¥½ä¹‹ç±»çš„ è¦ä½“ä¼šåˆ°å•Šï¼Œå¤šç»ƒã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> è´ªå¿ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[AT2369]-Ants on a Circle</title>
      <link href="2020/07/04/%5BAT2369%5D-Ants%20on%20a%20Circle/"/>
      <url>2020/07/04/%5BAT2369%5D-Ants%20on%20a%20Circle/</url>
      
        <content type="html"><![CDATA[<p>ä¸¤äººç¢°é¢åæ–¹å‘ç›¸åé€Ÿåº¦ä¸å˜â€”â€”è¿™ç§é¢˜æœ‰ä¸ªåå­—ï¼šå¼¹æ€§ç¢°æ’ï¼ˆè¿˜æŒºå½¢è±¡</p><p>ç½‘ç»œä¸Šä¹Ÿæœ‰ç±»ä¼¼çš„ï¼š<a href="https://www.cnblogs.com/liuchanglc/p/12700770.html#_label6" target="_blank" rel="noopener">ç‚¹æˆ‘</a></p><p>å¼±åŒ–ç‰ˆ1ï¼šï¼ˆä¸Šé¢åšå®¢ $T1$ï¼‰è¦æ±‚æ‰€æœ‰æœ€ç»ˆçš„ä½ç½®ï¼Œä»å°åˆ°å¤§è¾“å‡ºï¼Œä¸è¦æ±‚ä¸€ä¸€å¯¹åº”</p><p>è§£æ³•ï¼šå¯ä»¥çœ‹ä½œç›¸é‡çš„èš‚èšä»¬ç©¿è¿‡äº†å½¼æ­¤ï¼Œå‘ç”Ÿç¢°æ’äº†</p><p>å¼±åŒ–ç‰ˆ2ï¼šï¼ˆä¸Šé¢åšå®¢ $T2$ï¼‰</p><p>è§£æ³•ï¼šç¢°æ’çš„è¿‡ç¨‹å¯ä»¥çœ‹ä½œäº¤æ¢ç¼–å·ï¼Œå› æ­¤å¯ä»¥å¾—å‡ºç»“è®ºï¼šç¼–å·ä¸º $i$ çš„èš‚èšç¢°åˆ° $x$ ä¸ªé€†å‘çš„èš‚èšåç¼–å·å˜ä¸º $i + x$ã€‚</p><p>æœ¬é¢˜ï¼šä¸€ä¸ªé“ç†ï¼Œå¯ä»¥çœ‹ä½œä¸€åªèš‚èšç©¿è¿‡ $0$ ~ $l - 1$ï¼Œæ‰€æœ‰ç¼–å·éƒ½ä¼šå·¦ç§»/å³ç§»ä¸€ä½</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, L, T, a[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; n &gt;&gt; L &gt;&gt; T;</span><br><span class="line">rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line"><span class="keyword">int</span> w; <span class="built_in">scanf</span>(<span class="string">"%lld%d"</span>, &amp;a[i], &amp;w);</span><br><span class="line">a[i] += (w == <span class="number">1</span> ? T : -T);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> pos = <span class="number">0</span>;</span><br><span class="line">rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">pos += a[i] / L - (a[i] % L &lt; <span class="number">0</span>);</span><br><span class="line">a[i] = (a[i] % L + L) % L;</span><br><span class="line">&#125;</span><br><span class="line">sort(a + <span class="number">1</span>, a + n + <span class="number">1</span>);</span><br><span class="line">pos = (pos % n + n) % n + <span class="number">1</span>;</span><br><span class="line">rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, a[pos]);</span><br><span class="line">pos = (pos == n ? <span class="number">1</span> : pos + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20Jun CF&amp;AT ç»ƒé¢˜æ±‡æ€»</title>
      <link href="2020/06/30/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%9120Jun%20AT&amp;CF%20%E7%BB%83%E9%A2%98%E6%B1%87%E6%80%BB/"/>
      <url>2020/06/30/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%9120Jun%20AT&amp;CF%20%E7%BB%83%E9%A2%98%E6%B1%87%E6%80%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="CF1076E-Vasya-and-a-Tree"><a href="#CF1076E-Vasya-and-a-Tree" class="headerlink" title="[CF1076E]-Vasya and a Tree"></a>[CF1076E]-Vasya and a Tree</h2><hr><p>Â· å·§å¦™çš„dfs</p><p>æ²¡æœ‰æ•°æ®ç»“æ„å¯ä»¥ç›´æ¥ç»´æŠ¤ï¼Œæ•°æ®èŒƒå›´æ˜¯3e5æ‰€ä»¥è€ƒè™‘dfsï¼ˆï¼Ÿï¼‰  åˆ°è¾¾èŠ‚ç‚¹ x æ—¶å°† x çš„æ“ä½œæ‰§è¡Œæ‰ï¼ˆæ–¹æ³•ï¼šæ ¹æ®æ·±åº¦ç»´æŠ¤ä¸€ä¸ªæ ‘çŠ¶æ•°ç»„ï¼Œå›æº¯æ—¶ç»Ÿè®¡ç­”æ¡ˆå¹¶æ¶ˆé™¤å½±å“ï¼‰</p><h2 id="CF731F-Video-Cards"><a href="#CF731F-Video-Cards" class="headerlink" title="[CF731F]-Video Cards"></a>[CF731F]-Video Cards</h2><hr><p>Â· åˆ©ç”¨â€œå€æ•°â€<br>Â· è§‚å¯Ÿæ•°æ®èŒƒå›´ï¼šai &lt;= 2e5!!!</p><p>y è¦å‡åˆ° x çš„ k å€æ—¶ï¼Œy åœ¨ xk ï½ x(k + 1) - 1 çš„åŒºé—´å†…ã€‚æ‰€ä»¥åªè¦è®°å½•æ¯ä¸ªåŒºé—´æœ‰å‡ ä¸ªæ•°å°±å¯ä»¥ç®—äº†ï¼Œå‰ç¼€å’Œæ­£è§£ï¼ï¼</p><p>å†æŠ½è±¡åŒ–ã€‚æ±‚çš„æ˜¯ sum{ ä¸‹å–æ•´(ai / x) * x }ï¼Œé‚£ä¹ˆæšä¸¾ ä¸‹å–æ•´(ai / x) å°±å¥½äº†ã€‚</p><p>æ‰€ä»¥æ˜¯.. nlogn?</p><p>P.S. æ³¨æ„é‡å¤çš„ a[i] åˆ«é‡å¤æšä¸¾qwqï¼Œ200000ä¸ª 1 å°±ç‚¸é£äº†å•Šå—·ï¼Ÿ</p><h2 id="CF1163C1-Power-Transmission-Easy-Edition"><a href="#CF1163C1-Power-Transmission-Easy-Edition" class="headerlink" title="[CF1163C1]-Power Transmission(Easy Edition)"></a>[CF1163C1]-Power Transmission(Easy Edition)</h2><hr><p>æ¶Â·å¿ƒçš„è®¡ç®—é¢˜</p><h2 id="CF981D-Bookshelves"><a href="#CF981D-Bookshelves" class="headerlink" title="[CF981D]-Bookshelves"></a>[CF981D]-Bookshelves</h2><hr><p>Â·ä½è¿ç®—+dp</p><p>ä»é«˜ä½åˆ°ä½ä½chkï¼šèƒ½å¦åœ¨å·²chkçš„é«˜ä½å– 1/0 çš„æƒ…å†µä¸‹ï¼Œè¯¥ä½å– 1ã€‚</p><h2 id="CF599D-Spongebob-and-Squares"><a href="#CF599D-Spongebob-and-Squares" class="headerlink" title="[CF599D]-Spongebob and Squares"></a>[CF599D]-Spongebob and Squares</h2><hr><p>æ¨å¼å­é¢˜ï¼Œç®—å‡º m å…³äº k å’Œ n çš„å…³ç³»å¼ã€‚æšä¸¾ nï¼Œç®—å‡º mã€‚æ ¹æ®å¼å­å¯å¾—ï¼Œn å¤§çº¦æ˜¯ 1e6 çº§åˆ«çš„ï¼Œæ‰€ä»¥ä¸ä¼š Tï¼</p><h2 id="CF148E-Porcelain"><a href="#CF148E-Porcelain" class="headerlink" title="[CF148E]-Porcelain"></a>[CF148E]-Porcelain</h2><hr><p>Â·åˆ†ç»„èƒŒåŒ…</p><p>å…ˆå¤„ç†ç¬¬ i ç»„å®¹é‡ä¸º j æ—¶çš„æœ€å¤§ä»·å€¼å’Œ val[i, j], å†æ³¨æ„åˆ°æ¯ç»„åªèƒ½å–ä¸€ä¸ª val[]ï¼Œæƒ³åˆ°åˆ†ç»„èƒŒåŒ…ã€‚</p><p>ã€æƒŠï¼1e8 ç«Ÿç„¶å¯ä»¥ ACï¼Ÿ</p><h2 id="CF1311F-Moving-Points"><a href="#CF1311F-Moving-Points" class="headerlink" title="[CF1311F]-Moving Points"></a>[CF1311F]-Moving Points</h2><hr><p>Â·æ ‘çŠ¶æ•°ç»„+ç¦»æ•£åŒ–</p><p>åˆ†ç±»è®¨è®ºï¼Œå¯å¾—å‡ºç»“è®ºï¼šxi &lt; xj ä¸” vi &lt; vjï¼Œi å’Œ j å°±ä¸èƒ½ç›¸é‡äº†ï¼ˆä»£ä»·ä¸º xj - xiï¼‰ã€‚</p><p>äºæ˜¯ç”¨æ ‘çŠ¶æ•°ç»„è®¡ç®— xj - xi ä¹‹å’Œã€‚</p><h2 id="CF1043E-Train-Hard-Win-Easy"><a href="#CF1043E-Train-Hard-Win-Easy" class="headerlink" title="[CF1043E]-Train Hard, Win Easy"></a>[CF1043E]-Train Hard, Win Easy</h2><hr><p>Â·å¦™é¢˜ï¼</p><p>min(xi + yj, xj + yi) è¿™æ ·å­æ¶‰åŠåˆ°ä¸åŒç»„çš„å°±å¾ˆä¸çˆ½ï¼Œæ²¡æ³•å¤„ç†</p><p>xi + yj - (xj + yi) = (xi - xj) - (yi - yj)</p><p>è®¨è®º (xi - xj) - (yi - yj) çš„æ­£è´Ÿå°±å¥½äº†</p><h2 id="CF1360H-Binary-Median"><a href="#CF1360H-Binary-Median" class="headerlink" title="[CF1360H]-Binary Median"></a>[CF1360H]-Binary Median</h2><hr><p>Â·äºŒåˆ†</p><p>m æ‰ 60ã€‚ã€‚è¦æ³¨æ„ç¼–å·è®¡ç®—ï¼Œå¾ˆæ¶å¿ƒ</p><h2 id="CF1157D-N-Problems-During-K-Days"><a href="#CF1157D-N-Problems-During-K-Days" class="headerlink" title="[CF1157D]-N Problems During K Days"></a>[CF1157D]-N Problems During K Days</h2><hr><p>Â·æ„é€ </p><p>åªè¦æƒ³åˆ°â€œåœ¨ 1 2 .. k çš„åŸºç¡€ä¸Šä¿®æ”¹â€å°±å¥½äº†ï¼Œæ³¨æ„â€œ2å€å…³ç³»â€çš„é™åˆ¶</p><h2 id="CF1015E2-Stars-Drawing-Hard-Edition"><a href="#CF1015E2-Stars-Drawing-Hard-Edition" class="headerlink" title="[CF1015E2]-Stars Drawing (Hard Edition)"></a>[CF1015E2]-Stars Drawing (Hard Edition)</h2><hr><p>Â·å¥—è·¯é¢˜</p><p>å¹¶æ²¡æœ‰æ•°é‡é™åˆ¶å•Šï¼Œå‡¡æ˜¯ä¸Šä¸‹å·¦å³éƒ½æœ‰â€™<em>â€˜çš„ä½ç½®éƒ½å¯ä»¥ç”»åå­—å•Šï¼Œsizeæ ¹æ®ä¸Šä¸‹å·¦å³â€™</em>â€˜çš„é•¿åº¦æ¥å®šï¼Œåˆ«å¿˜äº†checkæ˜¯å¦å®Œå…¨è¦†ç›–ï¼Œï¼Œï¼Œ</p><h2 id="CF792D-Paths-in-a-Complete-Binary-Tree"><a href="#CF792D-Paths-in-a-Complete-Binary-Tree" class="headerlink" title="[CF792D]-Paths in a Complete Binary Tree"></a>[CF792D]-Paths in a Complete Binary Tree</h2><hr><p>Â·æ‰¾è§„å¾‹</p><p>æŠŠæ¯ä¸ªæ•°åˆ†è§£æˆ 2 çš„å¹‚æ¬¡ä¹˜å¥‡æ•°çš„å½¢å¼</p><h2 id="CF1012C-Hills"><a href="#CF1012C-Hills" class="headerlink" title="[CF1012C]-Hills"></a>[CF1012C]-Hills</h2><hr><p>Â·DP</p><p>è®¾ç½®çš„çŠ¶æ€åŒ…æ‹¬ä½ç½®ï¼ˆç¬¬ i ä¸ªå±±å¡ï¼‰ã€å·²ä¿®å»ºæˆ¿å±‹æ•°é‡ï¼ˆjï¼‰ã€å½“å‰ä½ç½®æ˜¯å¦å—ä¸Šä¸€åº§æˆ¿å±‹å½±å“ï¼ˆkï¼‰</p><h2 id="CF19B-Checkout-Assistant"><a href="#CF19B-Checkout-Assistant" class="headerlink" title="[CF19B]-Checkout Assistant"></a>[CF19B]-Checkout Assistant</h2><hr><p>Â·èƒŒåŒ…</p><p>é€‰äº† k ä¸ª, æ—¶é—´ä¸º T,  T = t1 + t2 + â€¦ + tk,</p><p>T &gt;= n - k, T + k &gt;= n</p><p>æ‰€ä»¥ (t1 + 1) + (t2 + 2) + â€¦ + (tk + k) &gt;= n.</p><p>ç”±æ­¤æƒ³åˆ°å°† ti ++ã€‚</p><p>é—®é¢˜è½¬åŒ–ä¸ºï¼šé€‰æ‹©æ€»ä½“ç§¯ &gt;= n çš„ç‰©å“ä½¿å¾—æ€»è´¹ç”¨æœ€å°ï¼Œ01èƒŒåŒ…</p><h2 id="CF9D-How-many-trees"><a href="#CF9D-How-many-trees" class="headerlink" title="[CF9D]-How many trees?"></a>[CF9D]-How many trees?</h2><hr><p>Â·DP</p><p>è®¾è®¡çŠ¶æ€åº”åŒ…å«èŠ‚ç‚¹æ•°(i), é«˜åº¦(j)</p><p>å¥½å†™å¥½è°ƒOvO</p><h2 id="CF730J-Bottles"><a href="#CF730J-Bottles" class="headerlink" title="[CF730J]-Bottles"></a>[CF730J]-Bottles</h2><hr><p>Â·èƒŒåŒ…</p><p>ç¬¬ä¸€é—®æ¯”è¾ƒå¥½æƒ³ï¼Œè´ªå¿ƒï¼Œä¼˜å…ˆç”¨ b[i] å¤§çš„æ¯å­ï¼Œç®—å‡ºç­”æ¡ˆä¸º kï¼›</p><p>ç¬¬äºŒé—®<strong>æ˜¯åœ¨ç¬¬ä¸€é—®åŸºç¡€ä¸Šçš„</strong>ï¼Œè®¾ tot = sigma(a[i]), é€‰ä¸­çš„æ¯å­ a[i] ä¹‹å’Œä¸º Aï¼Œb[i] ä¹‹å’Œä¸º B</p><p>é‚£ä¹ˆå¿…é¡»æ»¡è¶³ tot - A &lt;= B - A, å³ tot &lt;= B</p><p>ç°åœ¨æœ‰ä¸‰æ¡ï¼š</p><ol><li>é€‰ k ä¸ªæ¯å­ï¼›</li><li>B &gt;= totï¼›</li><li>A æœ€å¤§ã€‚</li></ol><p>èƒŒåŒ…ï¼å†™çš„æ—¶å€™æ•°ç»„å¼€é”™äº†ï¼Œè¶Šç•Œï¼Œå„ç§çµå¼‚äº‹ä»¶ à²¥_à²¥ æ—¶é—´å¤æ‚åº¦å…¶å®æ˜¯ 1e8 çš„ï¼Œä½† 93ms å°±è¿‡äº†ï¼Œemmï¼Ÿ</p><h2 id="CF946G-Almost-Increasing-Array"><a href="#CF946G-Almost-Increasing-Array" class="headerlink" title="[CF946G]-Almost Increasing Array"></a>[CF946G]-Almost Increasing Array</h2><hr><p>Â·æ ‘çŠ¶æ•°ç»„ç»´æŠ¤dp</p><p>ç»å…¸é¢˜ï¼Œæ’‡å¼€â€œå»æ‰ä¸€ä¸ªâ€çš„é™åˆ¶ï¼Œä¸¥æ ¼å¢åŠ å°±æ˜¯ j &gt; i, a[j] &gt; a[i], a[j] - a[i] &gt;= j - i å³ a[j] - j &gt;= a[i] - i; é‚£ä¹ˆç»´æŠ¤ä¸€ä¸ª LIS å°±å¥½äº†</p><p>æšä¸¾å»æ‰çš„ä½ç½®ï¼Œè¯¥ä½ç½®åé¢çš„ è¦ä» a[i] - i å˜æˆ a[i] - i + 1ï¼ˆå“å‘€å°±è¿™æ„æ€ä½ æ‡‚çš„å§</p><p>å€’è…¾å€’è…¾å°±å‡ºæ¥äº†</p><h2 id="CF478D-Red-Green-Towers"><a href="#CF478D-Red-Green-Towers" class="headerlink" title="[CF478D]-Red-Green Towers"></a>[CF478D]-Red-Green Towers</h2><hr><p>Â·çº¿æ€§DP</p><p>æœ€å¤§é«˜åº¦è¦å…ˆç®—qwqï¼Œf[i, j] è¡¨ç¤ºä»ä¸Šå¾€ä¸‹æ•°ç¬¬ i å±‚ï¼Œç”¨äº† j ä¸ªçº¢è‰²çš„æ–¹æ¡ˆæ•°ï¼Œç„¶åæ»šåŠ¨æ•°ç»„ä¼˜åŒ–ç©ºé—´</p><h2 id="CF1132F-Clear-the-String"><a href="#CF1132F-Clear-the-String" class="headerlink" title="[CF1132F]-Clear the String"></a>[CF1132F]-Clear the String</h2><hr><p>Â·åŒºé—´DP</p><p>ï¼ˆå®Œäº†æˆ‘æ€ä¹ˆç®€å•é¢˜ä¹Ÿä¸ä¼š</p><p>è€ƒè™‘å½“å‰å­—ç¬¦ï¼Œä¸¤ç§åˆ é™¤æ–¹æ³•ï¼š1. ç›´æ¥å•ä¸ªåˆ é™¤ 2. å’Œåé¢åŒè‰²çš„ä¸€èµ·åˆ é™¤</p><p>æ‰€ä»¥å°±æ˜¯ f[l, r] = min(f[l + 1, r] + 1, f[l + 1, i - 1] + f[i, r](i ä¸ l åŒè‰²))</p><h2 id="CF1344A-Hilbertâ€™s-Hotel"><a href="#CF1344A-Hilbertâ€™s-Hotel" class="headerlink" title="[CF1344A]-Hilbertâ€™s Hotel"></a>[CF1344A]-Hilbertâ€™s Hotel</h2><hr><p>Â·å–µé¢˜ï¼</p><p>è§‚å¯Ÿæ ·ä¾‹ç¬¬ä¸‰ç»„ï¼Œæ‰¾è§„å¾‹ï¼š</p><p>åŒºé—´ [0, 1, 2, 3] å˜ä¸º [5, 6, 7, 4]</p><p>åŒºé—´ [4, 5, 6, 7] å˜ä¸º [9, 10, 11, 8]</p><p>â€¦</p><p>åŒºé—´ [0 + nk, 1 + nk, 2 + nk, 3 + nk] å˜ä¸º [5 + nk, 6 + nk, 7 + nk, 4 + nk]</p><p>å¦‚æœé›†åˆ [5 + nk, 6 + nk, 7 + nk, 4 + nk] å«æœ‰ç›¸åŒçš„æ•°å­—é‚£å°±æ˜¯ NO å•¦</p><p>è‹¥ k ç›¸åŒæ—¶ï¼Œè¿™å››ä¸ªæ•°æœ‰ % n åŒä½™çš„ï¼Œé‚£å°±æ˜¯ NO</p><p>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿa + nk = b + nk (% n)   =&gt;   a + nkâ€™ = b</p><h2 id="CF140A-New-Year-Table"><a href="#CF140A-New-Year-Table" class="headerlink" title="[CF140A]-New Year Table"></a>[CF140A]-New Year Table</h2><hr><p>å‡ ä½•é¢˜ï¼Œæœ€è¿‘ä¹Ÿçœ‹äº†é«˜ä¸­æ•°å­¦å¿…ä¿®å››çš„ä¸‰è§’å‡½æ•°ï¼Œæ­£å¥½ç”¨åˆ°ï¼å¸å¸ã€‚æ³¨æ„ï¼Œc++å‡½æ•°éƒ½æ˜¯å¼§åº¦åˆ¶ï¼Œpi = acos(-1)ã€‚</p><h2 id="CF141C-Queue"><a href="#CF141C-Queue" class="headerlink" title="[CF141C]-Queue"></a>[CF141C]-Queue</h2><hr><p>è€ƒè™‘æŠŠ 1 ~ n ä½œä¸ºèº«é«˜åˆ†ç»™ n ä¸ªäººã€‚æ¯ä¸ªäººçš„æ’ååªå—å‰é¢äººçš„å½±å“ï¼Œæ‰€ä»¥æˆ‘ä»¬å€’ç€æ¥åˆ†ã€‚</p><h2 id="CF141D-Take-off-Ramps"><a href="#CF141D-Take-off-Ramps" class="headerlink" title="[CF141D]-Take-off Ramps"></a>[CF141D]-Take-off Ramps</h2><hr><p>ä¸€çœ¼æœ€çŸ­è·¯ã€‚æ³¨æ„ï¼šèµ·ç‚¹ x - p, ç»ˆç‚¹ x + d, è´¹ç”¨ p + t</p><p>å®¹æ˜“æƒ³åˆ°èµ·ç‚¹å‘ç»ˆç‚¹è¿è¾¹ï¼Œä½†æ˜¯é¢˜ç›®è¿˜å¯ä»¥ä¸é€‰è·³æ¿ï¼Œç”šè‡³é€†è¡Œã€‚ä¸ç”¨ä»ä¸€ä¸ªä½ç½®å‘å…¶ä»–æ¯ä¸ªä½ç½®è¿è¾¹ï¼Œé‚£æ ·æ—¶ç©ºéƒ½æ˜¯ n^2 çš„ï¼è€ƒè™‘åˆ°æ¯æ¬¡å¾’æ­¥èµ°éƒ½æ˜¯æœ‰ç›®æ ‡çš„ï¼Œæ²¡æœ‰æ— ç¼˜æ— æ•…çš„é€†è¡Œï¼Œåªè¦åœ¨å‡ºå‘ç‚¹å’Œç›®æ ‡ä¹‹é—´è¿è¾¹å°±å¥½äº†ã€‚</p><h2 id="CF145B-Lucky-Number-2"><a href="#CF145B-Lucky-Number-2" class="headerlink" title="[CF145B]-Lucky Number 2"></a>[CF145B]-Lucky Number 2</h2><hr><p>Â·æ‰¾è§„å¾‹</p><p>æœ€åŸºæœ¬çš„æ€§è´¨ï¼š4å¼€å¤´7ç»“å°¾ï¼š47æ¯”74å¤š1ï¼›  7å¼€å¤´4ç»“å°¾ï¼š74æ¯”47å¤š1ï¼›  4å¼€å¤´4ç»“å°¾ / 7å¼€å¤´7ç»“å°¾ï¼šç›¸åŒ</p><p>å› æ­¤ |num(47) - num(74)| &gt; 1 çš„æƒ…å†µéƒ½æ˜¯æ— è§£ã€‚å†æ ¹æ® num(47) å’Œ num(74) çš„å¤§å°å…³ç³»è¿›è¡Œåˆ†è®¨ï¼ˆå‘•</p><h2 id="CF242E-XOR-on-Segment"><a href="#CF242E-XOR-on-Segment" class="headerlink" title="[CF242E]-XOR on Segment"></a>[CF242E]-XOR on Segment</h2><hr><p>Â·æ•°æ®ç»“æ„åº·å¤è®­ç»ƒï¼ˆ</p><p>ç»´æŠ¤åŒºé—´å¼‚æˆ–å’Œã€‚å› ä¸ºåŒºé—´å’Œæ— æ³•ç›´æ¥å¼‚æˆ–ï¼Œæˆ‘ä»¬æƒ³åˆ°å¯¹äºŒè¿›åˆ¶æ¯ä¸€ä½åˆ†åˆ«å¼€çº¿æ®µæ ‘ï¼å¼‚æˆ–å˜æˆ 0/1 ä¸ªæ•°çš„è½¬æ¢äº†ã€‚</p><h2 id="CF380C-Sereja-and-Brackets"><a href="#CF380C-Sereja-and-Brackets" class="headerlink" title="[CF380C]-Sereja and Brackets"></a>[CF380C]-Sereja and Brackets</h2><hr><p>åˆšå¼€å§‹æƒ³åˆ°æ˜¯ r å‰çš„å¯¹æ•° - l å‰çš„å¯¹æ•° - è¿‡äº¤ç•Œå¤„çš„å¯¹æ•°ï¼Œä½†æ˜¯æœ€åä¸€é¡¹ä¸ä¼šç»´æŠ¤T T</p><p>åŒºé—´æ‹¬å·é…å¯¹æ•°ç›´æ¥çº¿æ®µæ ‘ç»´æŠ¤å°±å¥½äº†å˜›ï¼Œè®°å½•æ¯ä¸ªåŒºé—´å¤šä½™çš„ â€˜(â€˜â€™)â€™ ä¸ªæ•°å’Œå·²é…å¯¹çš„ä¸ªæ•°</p><h2 id="CF1244C-The-Football-Season"><a href="#CF1244C-The-Football-Season" class="headerlink" title="[CF1244C]-The Football Season"></a>[CF1244C]-The Football Season</h2><hr><p>x = (p - yd) / w.</p><p>å› æ­¤è¦æ»¡è¶³ä¸¤ä¸ªé™åˆ¶ï¼š1. xä¸ºæ•´æ•° 2. x + y &lt;= n</p><p>ç¬¬ä¸€ä¸ªç”¨ exgcd åº”è¯¥ä¹Ÿèƒ½åšã€‚ã€‚ä½† w å¾ˆå°å‘€ï¼Œæšä¸¾ y = 0 ~ w - 1 ä¹Ÿèƒ½è¿‡</p><h2 id="CF1359D"><a href="#CF1359D" class="headerlink" title="[CF1359D]"></a>[CF1359D]</h2><hr><p>æšä¸¾æœ€å¤§å€¼ï¼Œç»Ÿè®¡æ¯ä¸ªè¿ç»­è‡ªåºåˆ—çš„æœ€å¤§å€¼</p><h2 id="CF181D-Word-Cut"><a href="#CF181D-Word-Cut" class="headerlink" title="[CF181D]-Word Cut"></a>[CF181D]-Word Cut</h2><hr><p>å¯ä»¥å‘ç°å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ä¸æ–­å¾ªç¯ã€‚n^2 æ‰¾å‡º s ä¸ t ç›¸é…çš„æ‰€æœ‰ä½ç½®ï¼Œdpå°±å¯ä»¥äº†</p><h2 id="CF176C-Playing-with-Superglue"><a href="#CF176C-Playing-with-Superglue" class="headerlink" title="[CF176C]-Playing with Superglue"></a>[CF176C]-Playing with Superglue</h2><hr><p>éœ€è¦æ‰‹ç©çš„ä¸€é“é¢˜ã€‚å®¹æ˜“å‘ç° max(abs(x1 - x2), abs(y1 - y2)) &gt; 4 çš„æ—¶å€™æ˜¯åæ‰‹èµ¢ï¼Œ= 4 ä¸” min = 3 æˆ– 4 çš„æ—¶å€™æ˜¯åæ‰‹èµ¢ï¼Œå…¶ä½™æ—¶é—´éƒ½æ˜¯å…ˆæ‰‹ï¼Œè‡³äºä¸ºä»€ä¹ˆã€‚ã€‚è¿™è·Ÿè¿™ä¸ªæ¸¸æˆçš„è§„åˆ™æœ‰å…³ç³»ã€‚</p><h2 id="CF180E"><a href="#CF180E" class="headerlink" title="[CF180E]"></a>[CF180E]</h2><hr><p>å¥—è·¯â€”â€”ç”¨vectorç»´æŠ¤åŒä¸€é¢œè‰²çš„ä½ç½®ï¼ŒæŸ¥æ‰¾å°±å¾ˆæ–¹ä¾¿</p><h2 id="CF148D"><a href="#CF148D" class="headerlink" title="[CF148D]"></a>[CF148D]</h2><hr><p>æœŸæœ›æ¦‚ç‡ä»€ä¹ˆçš„ Qaq dpç®—æ˜¯æœ€å–„è‰¯çš„äº†ã€‚ã€‚</p><p>f[i, j] è¡¨ç¤ºè¢‹å­é‡Œè¿˜æœ‰ i ä¸ªç™½çš„ã€j ä¸ªé»‘çš„ï¼Œå…¬ä¸»èµ¢çš„æ¦‚ç‡ï¼Œè½¬ç§»æ–¹ç¨‹ä¸éš¾ï¼Œå› ä¸ºåœ¨ä¸€è½®è½¬ç§»ä¸­é¾™çš„æƒ…å†µä¸€å¹¶è€ƒè™‘æ‰äº†ã€‚</p><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼Œå› ä¸ºæœ‰ç²¾åº¦é™åˆ¶ï¼Œæšä¸¾å‡ åƒè½®æ¨¡æ‹Ÿæ“ä½œä¹Ÿæ˜¯å¯ä»¥è¿‡çš„ï¼Œï¼Œ</p><h2 id="CF453B"><a href="#CF453B" class="headerlink" title="[CF453B]"></a>[CF453B]</h2><hr><p>bä¸ä¼š &gt;= 59, å› ä¸ºé€‰ 1 å¿…ç„¶ä¸ä¼šæ›´å·®ï¼</p><p>58 ä»¥å†…æœ‰ 16 ä¸ªè´¨æ•°ï¼Œæ¯ä¸ªåªèƒ½ç”¨ä¸€æ¬¡ã€‚æƒ³åˆ°ä»€ä¹ˆäº†ï¼ŸçŠ¶å‹dp. ï¼ˆ3e8 2000msä¸æ¯«ä¸æ…Œ</p><h2 id="CF453C"><a href="#CF453C" class="headerlink" title="[CF453C]"></a>[CF453C]</h2><hr><p>æ€è·¯ä¸éš¾æƒ³ï¼Œæ¥å›éœ‡è¡ç€èµ°ã€‚é€‰ä¸€ä¸ªèµ°å¥‡æ•°æ¬¡çš„ç‚¹ä½œä¸ºæ ¹ç»“ç‚¹ï¼Œdfsï¼Œæ¯æ¬¡èµ°å‡ºå­æ ‘æ—¶ä¿è¯å­æ ‘çš„ç‚¹éƒ½æ»¡è¶³è¦æ±‚äº†ï¼Œå­æ ‘çš„æ ¹ç»“ç‚¹å°±å’Œå®ƒçš„çˆ¶äº²éœ‡è¡ï¼Œæ ¹ç»“ç‚¹å’Œå„¿å­éœ‡è¡ï¼Œå¯ä»¥è¯æ˜è¿™æ ·ä¸€ä¸ªèŠ‚ç‚¹æœ€å¤šèµ° 4 æ¬¡ï¼ˆ</p><h2 id="CF182C"><a href="#CF182C" class="headerlink" title="[CF182C]"></a>[CF182C]</h2><hr><p>æ­£ç€å€’ç€å„åšä¸€éï¼Œå¯¹äºæ¯ä¸ªåŒºé—´ï¼Œç»´æŠ¤æ­£è´Ÿæ€§ç›¸åçš„æ•°ä¸­ç»å¯¹å€¼ K å¤§çš„ã€‚è¯´ç™½äº†å°±æ˜¯åŠ¨æ€ç»´æŠ¤ K å¤§å’Œï¼Œæˆ‘ä»¬ç”¨å°æ ¹å †ç»´æŠ¤ï¼ˆæ³¨æ„å®ç°çš„æ—¶å€™ç”¨ä¸¤ä¸ª multisetï¼Œç»†èŠ‚å¤š</p><h2 id="CF187B"><a href="#CF187B" class="headerlink" title="[CF187B]"></a>[CF187B]</h2><hr><p>æƒ³æ³•æ˜¯ f[i, j, T] è¡¨ç¤º i åˆ° j è½¬æ¢äº† T æ¬¡ï¼Œf[i, j, T] = min(f[i, k, T - 1] + f[k, j, 0])</p><p>floyd å¤§æœ‰å­¦é—®å•Šï¼ˆ</p><h2 id="CF198E"><a href="#CF198E" class="headerlink" title="[CF198E]"></a>[CF198E]</h2><hr><p>xå’Œyçš„é™åˆ¶å¯ä»¥ç¼©ä¸ºè·ç¦»åˆå§‹ç‚¹(x, y)çš„è·ç¦»çš„é™åˆ¶</p><p>æ‰€ä»¥å°±æ˜¯å¯¹äºé˜Ÿåˆ—ä¸­æ¯ä¸ª(r, p) æ‰¾åˆ°è¿˜æ²¡è¢«åˆ é™¤çš„ç‚¹é›†ä¸­ dis &lt;= r ä¸” m &lt;= p çš„ç‚¹ï¼Œåˆ é™¤å¹¶åŠ å…¥é˜Ÿåˆ—</p><p>å¯ä»¥çº¿æ®µæ ‘ + set ç»´æŠ¤ï¼Œæ¯ä¸ª dis å¤„éƒ½æœ‰ä¸ª setï¼Œè¿·æƒ‘æ“ä½œä½†æ˜¯å¾ˆå¥½å†™ï¼ˆ</p><p>è¿™æ˜¯é¢˜è§£åšæ³•ï¼Œè¦æ˜¯çœŸæ¯”èµ›ç¢°åˆ°æˆ‘å…«æˆä¼šæ äºŒç»´æ•°ç‚¹ï¼Œç•™å‘å¾…å¡«</p>]]></content>
      
      
      
        <tags>
            
            <tag> CF&amp;ATå¾€å±Š </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20Mar CF&amp;AT ç»ƒé¢˜æ±‡æ€»</title>
      <link href="2020/03/31/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%9120Mar%20AT&amp;CF%20%E7%BB%83%E9%A2%98%E6%B1%87%E6%80%BB/"/>
      <url>2020/03/31/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%9120Mar%20AT&amp;CF%20%E7%BB%83%E9%A2%98%E6%B1%87%E6%80%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="AT2164"><a href="#AT2164" class="headerlink" title="[AT2164]-"></a>[AT2164]-</h2><hr><h2 id="AT2167-Blackout"><a href="#AT2167-Blackout" class="headerlink" title="[AT2167]-Blackout"></a>[AT2167]-Blackout</h2><hr>]]></content>
      
      
      
        <tags>
            
            <tag> CF&amp;ATå¾€å±Š </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Atcoder Beginner Contest 156</title>
      <link href="2020/03/01/Atcoder%20Beginner%20Contest%20156/"/>
      <url>2020/03/01/Atcoder%20Beginner%20Contest%20156/</url>
      
        <content type="html"><![CDATA[<p>ABCè‡ªåŠ¨æ°´è¿‡â€¦</p><h3 id="D"><a href="#D" class="headerlink" title="D"></a>D</h3><hr><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">æ‰€ä»¥æ‰çŸ¥é“å•ç®— C(n, m) æ˜¯ O(m) å¤æ‚åº¦çš„ï¼Ÿï¼Ÿï¼Ÿ</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>, N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, a, b, fac[N];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quick_pow</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ret = ret * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">    &#125; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">C</span><span class="params">(ll n, ll m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n &lt; m) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll res = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        ll a = (n + i - m) % mod;</span><br><span class="line">        ll b = i % mod;</span><br><span class="line">        res = res * (a * quick_pow(b, mod - <span class="number">2</span>) % mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    ll ans = (quick_pow(<span class="number">2</span>, n) - <span class="number">1</span> + mod) % mod;</span><br><span class="line">    ans = (ans - C(n, a) + mod) % mod;</span><br><span class="line">    ans = (ans - C(n, b) + mod) % mod;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="E"><a href="#E" class="headerlink" title="E"></a>E</h3><hr><p>é¦–å…ˆ k &gt;= n çš„æ—¶å€™ç­”æ¡ˆæ˜¯ C(2 * n - 1, n - 1)</p><p>ç„¶å k &lt; n çš„æ—¶å€™å°±å¯ä»¥æšä¸¾ ä½ç½®ç©ºç€çš„äººæ•° äº†ï¼å°±å¥½äº†ï¼æˆ‘ä¹Ÿå¥½å¥‡æˆ‘å½“æ—¶åœ¨æƒ³å•¥å‘€</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">10</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, K, fac[N], inv[N];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quick_pow</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ret = ret * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">    &#125; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">C</span><span class="params">(ll n, ll m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fac[n] * inv[m] % mod * inv[n - m] % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; K;</span><br><span class="line"></span><br><span class="line">    fac[<span class="number">0</span>] = inv[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, <span class="number">2</span> * n) fac[i] = fac[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">    inv[<span class="number">2</span> * n] = quick_pow(fac[<span class="number">2</span> * n], mod - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span> * n; i &gt;= <span class="number">1</span>; i--) inv[i - <span class="number">1</span>] = inv[i] * i % mod;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (K &gt;= n) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, C(<span class="number">2</span> * n - <span class="number">1</span>, n - <span class="number">1</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ll tot = <span class="number">0</span>;</span><br><span class="line">        rep(k, <span class="number">0</span>, K)</span><br><span class="line">            tot = (tot + C(n, k) * C(n - (n - k) + (n - k - <span class="number">1</span>), n - k - <span class="number">1</span>) % mod) % mod;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, tot);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="F"><a href="#F" class="headerlink" title="F"></a>F</h3><hr><p>è¿™é¢˜æŒºå¥½</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Usaco20Feb (Gold)</title>
      <link href="2020/03/01/Usaco20Feb%20(Gold)/"/>
      <url>2020/03/01/Usaco20Feb%20(Gold)/</url>
      
        <content type="html"><![CDATA[<p>è¿™æ¬¡çš„ gold æ¯”å‰ä¸¤åœºéƒ½æ°´ï¼Ÿï¼ï¼ŸT2å·²ç»ç¦»æ­£è§£å¾ˆè¿‘äº†å”‰ã€‚ã€‚T3å°±æ˜¯ä¸ªå¤§æš´åŠ›å”‰ã€‚ã€‚ã€‚ã€‚</p><h3 id="A"><a href="#A" class="headerlink" title="A"></a>A</h3><hr><p>å·®åˆ†çº¦æŸï¼Œå¤§äºå°äºææ¸…æ¥šå°±å¯ä»¥</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>, inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, C, s[N], dis[N], inq[N];</span><br><span class="line"><span class="keyword">int</span> to[N &lt;&lt; <span class="number">1</span>], nxt[N &lt;&lt; <span class="number">1</span>], lnk[N], val[N &lt;&lt; <span class="number">1</span>], cnt;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span> </span>&#123;</span><br><span class="line">    to[++cnt] = y, nxt[cnt] = lnk[x], lnk[x] = cnt, val[cnt] = z;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spfa</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(dis));</span><br><span class="line">    dis[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    q.push(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front(); q.pop(); inq[x] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = to[i];</span><br><span class="line">            <span class="keyword">if</span> (dis[y] &gt; dis[x] + val[i]) &#123;</span><br><span class="line">                dis[y] = dis[x] + val[i];</span><br><span class="line">                <span class="keyword">if</span> (!inq[y]) inq[y] = <span class="number">1</span>, q.push(y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    freopen(<span class="string">"timeline.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>); freopen(<span class="string">"timeline.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; C;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;s[i]), add(<span class="number">0</span>, i, -s[i]);</span><br><span class="line">    rep(i, <span class="number">1</span>, C) &#123;</span><br><span class="line">        <span class="keyword">int</span> a, b, x; <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;a, &amp;b, &amp;x);</span><br><span class="line">        add(a, b, -x);</span><br><span class="line">    &#125;</span><br><span class="line">    spfa();</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, -dis[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B"><a href="#B" class="headerlink" title="B"></a>B</h3><hr><p>èµ›æ—¶æƒ³äº†ä¸ª DPï¼Œæœ€åå‘ç°å°‘è€ƒè™‘ä¸€ç§æƒ…å†µã€‚ã€‚</p><p>ä½†èµ›åæ‰çŸ¥é“åŠ ä¸Šé‚£ä¸ªæƒ…å†µå°±å¯ä»¥ä¸ç”¨ DP è¿™ä¹ˆéº»çƒ¦äº†ï¼ï¼ï¼</p><p>ä¸è¿‡å£èƒ¡äº†ä¸€ä¸ªä¸æ­¤é¢˜æ— å…³çš„ã€ç®—åŒºé—´å†…åŒºé—´çš„ O(nlogn) ç®—æ³•ã€‚ã€‚ä¹Ÿç®—å°å°å°æœ‰æ”¶è·äº†ï¼ï¼ï¼</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">å•ç‹¬ç®—æ¯ä¸ªåŒºé—´ [l, r] çš„è´¡çŒ®ï¼ˆå°±æ˜¯ 2^&#123;n - 1 - ä¸åŒ…å«[l - 1, l]çš„åŒºé—´æ•°&#125;ï¼‰</span></span><br><span class="line"><span class="comment">èµ›æ—¶é™æ™ºã€‚ã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> n, cnt[N], mi[N] = &#123;<span class="number">1</span>&#125;, ans;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">line</span> &#123;</span> <span class="keyword">int</span> l, r; &#125;e[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    freopen(<span class="string">"help.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>); freopen(<span class="string">"help.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">cin</span> &gt;&gt; e[i].l &gt;&gt; e[i].r, cnt[e[i].l]++, cnt[e[i].r]--;</span><br><span class="line">    rep(i, <span class="number">1</span>, <span class="number">2</span> * n) cnt[i] += cnt[i - <span class="number">1</span>], mi[i] = mi[i - <span class="number">1</span>] * <span class="number">2</span> % mod;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) ans = (ans + mi[n - <span class="number">1</span> - cnt[e[i].l - <span class="number">1</span>]]) % mod;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C"><a href="#C" class="headerlink" title="C"></a>C</h3><hr><p>ä¸€ä¸ªå¤§æš´åŠ›ï¼Œæ²¡å•¥å¥½è¯´<em>(Â´à½€`ã€ âˆ )</em> æ€ªæˆ‘å¤ªèœã€‚ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">æ­£å¸¸æ¯æ¬¡dfsï¼Œé€’å½’å¸¸æ•°å¤§ã€‚ã€‚å†™checkerâ¬‡ï¸å°±å¯ä»¥</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, sz[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nxt[N], num[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    sz[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nxt[x].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = nxt[x][i];</span><br><span class="line">        <span class="keyword">if</span> (y == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(y, x);</span><br><span class="line">        sz[x] += sz[y];</span><br><span class="line">        num[x].push_back(sz[y]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x != <span class="number">1</span>) num[x].push_back(n - sz[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> bin[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">chk</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> ((n - <span class="number">1</span>) % k) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, k - <span class="number">1</span>) bin[i] = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; num[i].size(); j++) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = num[i][j] % k;</span><br><span class="line">            <span class="keyword">if</span> (!x) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (bin[k - x]) bin[k - x]--, cnt--;</span><br><span class="line">            <span class="keyword">else</span> bin[x]++, cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (cnt) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    freopen(<span class="string">"deleg.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>); freopen(<span class="string">"deleg.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        nxt[x].push_back(y), nxt[y].push_back(x);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">"%d"</span>, chk(i)); <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>20Feb CF&amp;AT ç»ƒé¢˜æ±‡æ€»</title>
      <link href="2020/02/29/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%9120Feb%20CF&amp;AT%20%E7%BB%83%E9%A2%98%E6%B1%87%E6%80%BB/"/>
      <url>2020/02/29/%E3%80%90%E8%AE%A1%E5%88%92%E3%80%9120Feb%20CF&amp;AT%20%E7%BB%83%E9%A2%98%E6%B1%87%E6%80%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="AT1984-Wide-Swap"><a href="#AT1984-Wide-Swap" class="headerlink" title="[AT1984]-Wide Swap"></a>[AT1984]-Wide Swap</h2><hr><p><a href="https://imilyx.github.io/2020/02/09/%5BAT1984%5D-Wide%20Swap/" target="_blank" rel="noopener">è§æ­¤ç¯‡</a></p><h2 id="AT2004-Anticube"><a href="#AT2004-Anticube" class="headerlink" title="[AT2004]-Anticube"></a>[AT2004]-Anticube</h2><hr><p><a href="https://imilyx.github.io/2020/02/10/%5BAT2004%5D-Anticube/" target="_blank" rel="noopener">è§æ­¤ç¯‡</a></p><h2 id="CF17C-Balance"><a href="#CF17C-Balance" class="headerlink" title="[CF17C]-Balance"></a>[CF17C]-Balance</h2><hr><ul><li>æ‰¾æ€§è´¨ï¼šå®šä¹‰ä¸€ä¸ªå­—ç¬¦ä¸²çš„æœ€ç®€åŒ–ä¸ºåˆ é™¤ç›¸é‚»åŒç±»å­—ç¬¦åçš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼šaabbbc æœ€ç®€åŒ–ä¸º abcã€‚å˜åŒ–åçš„ B çš„æœ€ç®€åŒ–æ˜¯å˜åŒ–å‰ A çš„æœ€ç®€åŒ–çš„å­åºåˆ—ã€‚ä¸éš¾æ‡‚ï¼Œä½†æ˜¯å¾ˆéš¾æƒ³ã€‚ã€‚ã€‚</li></ul><p>æˆ‘è§‰å¾—è¿™ä¸ªæ€§è´¨åº”è¯¥åˆ‡å…¥ç‚¹æ˜¯ï¼šå­—ç¬¦ä¸² S ä¸­ l çš„ä½ç½®è¦åŒåŒ– [l, r] è¿™ä¸ªåŒºé—´ï¼Œæ˜¾ç„¶æ˜¯åƒæ¨åœŸæœºä¸€æ ·æ¨è¿‡å»çš„ï¼Œå®ƒä»¥è‡ªå·±æ›¿æ¢äº† [l, r] çš„æœ€ç®€åŒ–ã€‚</p><p>ç®€å• DP å³å¯ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">51123987</span>, N = <span class="number">160</span>;</span><br><span class="line"><span class="keyword">int</span> n, nxt[N][<span class="number">3</span>], f[N][<span class="number">55</span>][<span class="number">55</span>][<span class="number">55</span>], ans;</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y)</span> </span>&#123; x = (x + y) % mod; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    rep(i, <span class="number">0</span>, <span class="number">2</span>) nxt[n + <span class="number">1</span>][i] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; i--) &#123;</span><br><span class="line">        rep(j, <span class="number">0</span>, <span class="number">2</span>) nxt[i][j] = nxt[i + <span class="number">1</span>][j];</span><br><span class="line">        nxt[i][s[i] - <span class="string">'a'</span>] = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    f[<span class="number">1</span>][<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> lim = (n + <span class="number">2</span>) / <span class="number">3</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        rep(a, <span class="number">0</span>, lim)</span><br><span class="line">            rep(b, <span class="number">0</span>, lim)</span><br><span class="line">                rep(c, <span class="number">0</span>, lim) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (a + b + c == n) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (<span class="built_in">abs</span>(a - b) &lt;= <span class="number">1</span> &amp;&amp; <span class="built_in">abs</span>(a - c) &lt;= <span class="number">1</span> &amp;&amp; <span class="built_in">abs</span>(b - c) &lt;= <span class="number">1</span>)</span><br><span class="line">                            upd(ans, f[i][a][b][c]);</span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (nxt[i][<span class="number">0</span>] != <span class="number">-1</span>)  <span class="comment">// ç”¨ nxt æ¥ å’Œç”¨ s æœ€ç®€åŒ–åçš„å­—ç¬¦ä¸²æ¥æ˜¯ä¸€ä¸ªé“ç†</span></span><br><span class="line">                        upd(f[nxt[i][<span class="number">0</span>]][a + <span class="number">1</span>][b][c], f[i][a][b][c]);  <span class="comment">// æœ‰å¯èƒ½ä¼šæ— é™åœç•™åœ¨å½“å‰ä½ç½®ï¼Œä¸è¿‡æ²¡æœ‰å…³ç³»ï¼Œa + b + c = n çš„æ—¶å€™å°±ä¼šåœæ­¢</span></span><br><span class="line">                    <span class="keyword">if</span> (nxt[i][<span class="number">1</span>] != <span class="number">-1</span>)</span><br><span class="line">                        upd(f[nxt[i][<span class="number">1</span>]][a][b + <span class="number">1</span>][c], f[i][a][b][c]);</span><br><span class="line">                    <span class="keyword">if</span> (nxt[i][<span class="number">2</span>] != <span class="number">-1</span>)</span><br><span class="line">                        upd(f[nxt[i][<span class="number">2</span>]][a][b][c + <span class="number">1</span>], f[i][a][b][c]);</span><br><span class="line">                &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="CF17D-Notepad"><a href="#CF17D-Notepad" class="headerlink" title="[CF17D]-Notepad"></a>[CF17D]-Notepad</h2><hr><p>æ²¡æœ‰ä»€ä¹ˆå¥½è¯´çš„ï¼Œä¸€çœ¼ä¸æ˜¯é«˜ç²¾åº¦ï¼ã€‚æ²¡é”™å°±æ˜¯â€“</p><ul><li>æ‰©å±•æ¬§æ‹‰å‡½æ•°æ¿å­é¢˜ï¼ã€å•Šæ€ä¹ˆåˆæ˜¯æ¬§æ‹‰</li></ul><p><a href="https://www.cnblogs.com/ywwyww/p/8510981.html" target="_blank" rel="noopener">è¿™ä¸ªå¤§ä½¬ç²¾è¾Ÿæ€»ç»“äº†</a></p><p>é¢˜ç›®æ²¡æœ‰ä¿è¯åº•æ•°(b)å’Œæ¨¡æ•°(c)äº’è´¨æ‰€ä»¥ä¸èƒ½ç”¨æ•°è®ºä¸­çš„æ¬§æ‹‰å®šç†ï¼Œè¦ç”¨æ‰©å±•ç‰ˆæœ¬ã€‚<strong>è¿˜æœ‰ä¸€ç‚¹ï¼Œæ³¨æ„æŒ‡æ•°å°äº phi(æ¨¡æ•°) çš„æ—¶å€™å®šç†ä¸æˆç«‹ï¼</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ‰©å±•æ¬§æ‹‰å‡½æ•° é™å¹‚</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll b, b2, n, c, phi;</span><br><span class="line"><span class="keyword">char</span> s1[N], s2[N];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">getphi</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">    ll ans = n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n % i == <span class="number">0</span>) ans = ans / i * (i - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">while</span> (n % i == <span class="number">0</span>) n /= i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>) ans = ans / n * (n - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quick_pow</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ret = ret * a % c;</span><br><span class="line">        a = a * a % c;</span><br><span class="line">    &#125; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s%s%lld"</span>, s1 + <span class="number">1</span>, s2 + <span class="number">1</span>, &amp;c);</span><br><span class="line">    phi = getphi(c);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(s1 + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// b</span></span><br><span class="line">    rep(i, <span class="number">1</span>, len) b = (b * <span class="number">10</span> + (s1[i] - <span class="string">'0'</span>)) % c;</span><br><span class="line">    <span class="comment">// b - 1</span></span><br><span class="line">    b2 = (b - <span class="number">1l</span>l + c) % c;</span><br><span class="line"></span><br><span class="line">    len = <span class="built_in">strlen</span>(s2 + <span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, len) n = (n * <span class="number">10</span> + (s2[i] - <span class="string">'0'</span>)) % phi;</span><br><span class="line">    <span class="comment">// n - 1</span></span><br><span class="line">    n = (n - <span class="number">1l</span>l + phi) % phi + phi;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (len &lt; <span class="number">10</span>) &#123;</span><br><span class="line">        ll realN = <span class="number">0</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, len) realN = realN * <span class="number">10</span> + (s2[i] - <span class="string">'0'</span>);</span><br><span class="line">        realN -= <span class="number">1l</span>l;</span><br><span class="line">        <span class="keyword">if</span> (realN &lt; phi) n -= phi;  <span class="comment">// !!!</span></span><br><span class="line">    &#125;</span><br><span class="line">    ll ans = b2 * quick_pow(b, n) % c;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans ? ans : c);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="CF17E-Palisection"><a href="#CF17E-Palisection" class="headerlink" title="[CF17E]-Palisection"></a>[CF17E]-Palisection</h2><hr><p>æœ‰ç‚¹æ„æ€å•Šï¼</p><p>é¢˜ç›®è¦æ±‚ç›¸äº¤å›æ–‡ä¸²å¯¹æ•°ï¼Œè€ƒè™‘åˆ°å­˜åœ¨åŒ…å«å…³ç³»ï¼Œç›´æ¥å¤„ç†ç»†èŠ‚ä¼šå¾ˆå¤šå¾ˆä¸å¥½å†™ã€‚</p><p>ä¿—è¯è¯´å¾—å¥½ï¼Œ<strong>æ­£éš¾åˆ™åï¼</strong></p><ul><li>ç›¸äº¤å¯¹æ•° = æ€»æ•° - ä¸ç›¸äº¤å¯¹æ•°ã€‚manacher + å‰ç¼€å’Œç»´æŠ¤</li></ul><p>è®¡ç®—ä¸€ä¸ªä½ç½®å·¦è¾¹çš„å›æ–‡ä¸²å³ç«¯ç‚¹ä¸ªæ•°ï¼Œä¸è¯¥ä½ç½®å³è¾¹çš„å›æ–‡ä¸²å·¦ç«¯ç‚¹ä¸ªæ•°ç›¸ä¹˜ï¼Œè¿™æ ·æ˜¯ä¼š<strong>ç®—é‡</strong>çš„ï¼ï¼</p><p>æ‰€ä»¥æˆ‘ä»¬å›ºå®šä¸€ä¸ªä½ç½®ï¼Œè¯¥ä½ç½®ä½œä¸ºå·¦ç«¯ç‚¹çš„ä¸²ä¸ªæ•° ä¸è¯¥ä½ç½®å·¦è¾¹çš„å›æ–‡ä¸²å³ç«¯ç‚¹ç›¸ä¹˜ï¼Œè¿™æ ·æ˜¾ç„¶ä¸ä¼šé‡ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">8e6</span> + <span class="number">10</span>, mod = <span class="number">51123987</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, len, p[N], pos, mx, l[N], r[N];  <span class="comment">// l[x]/r[x]: x ä½ç½®ä½œä¸ºå·¦/å³ç«¯ç‚¹çš„å­—ç¬¦ä¸²ä¸ªæ•°</span></span><br><span class="line">ll ans, sum;</span><br><span class="line"><span class="keyword">char</span> a[N], s[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">manacher</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &lt; mx)</span><br><span class="line">            p[i] = min(p[pos * <span class="number">2</span> - i], mx - i);</span><br><span class="line">        <span class="keyword">else</span> p[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (s[i + p[i]] == s[i - p[i]]) p[i]++;</span><br><span class="line">        <span class="keyword">if</span> (mx &lt; i + p[i]) mx = i + p[i], pos = i;</span><br><span class="line"></span><br><span class="line">        ++l[i - p[i] + <span class="number">1</span>], --l[i + <span class="number">1</span>];  <span class="comment">// ä¸­å¿ƒåˆ°æ¯ä¸€ä¸ª [å·¦ç«¯ç‚¹ï¼Œä¸­å¿ƒ] çš„ç‚¹ éƒ½æœ‰ä¸€ä¸ªå›æ–‡ä¸²</span></span><br><span class="line">        ++r[i], --r[i + p[i]];</span><br><span class="line"></span><br><span class="line">        ans = (ans + (p[i] &gt;&gt; <span class="number">1</span>)) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = (ans * (ans - <span class="number">1</span>) / <span class="number">2</span>) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%s"</span>, &amp;n, a + <span class="number">1</span>);</span><br><span class="line">    len = n;</span><br><span class="line">    s[n = <span class="number">1</span>] = <span class="string">'#'</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, len) s[++n] = a[i], s[++n] = <span class="string">'#'</span>;</span><br><span class="line">    s[<span class="number">0</span>] = <span class="string">'['</span>, s[n + <span class="number">1</span>] = <span class="string">']'</span>;</span><br><span class="line"></span><br><span class="line">    manacher();</span><br><span class="line"></span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        l[i] += l[i - <span class="number">1</span>], r[i] += r[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">            ans = (ans - (ll)l[i] * sum % mod + mod) % mod;  <span class="comment">// æ­£éš¾åˆ™å</span></span><br><span class="line">            sum = (sum + r[i]) % mod;  <span class="comment">// ç›¸å½“äºäºŒé˜¶å·®åˆ†</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="AT2301-Solitaire"><a href="#AT2301-Solitaire" class="headerlink" title="[AT2301]-Solitaire"></a>[AT2301]-Solitaire</h2><hr><p>å–æ•°å‰è‚¯å®šæ˜¯ V å­—å½¢çš„ï¼ˆ1 æ˜¯è°·åº•ï¼‰</p><ul><li>ä¸€ä¸ªå–æ•°åºåˆ—ï¼Œåªè¦å­˜åœ¨ä¸€ç§ V å­—å½¢çš„å®‰æ’ï¼Œå°±æ˜¯åˆæ³•çš„</li></ul><p><a href="https://blog.csdn.net/weixin_30820077/article/details/96464019" target="_blank" rel="noopener">è¿™ä¸ªå¤§ä½¬è®²çš„æ¯”æˆ‘æ¸…æ¥š</a></p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, x, y) for (int i = x; i &gt;= y; i--)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>, N = <span class="number">2e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, K, f[N][N], sum, ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; K;</span><br><span class="line">    per(i, n, <span class="number">2</span>) f[<span class="number">1</span>][i] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, K - <span class="number">2</span>) &#123;</span><br><span class="line">        sum = f[i][n - i + <span class="number">1</span>];</span><br><span class="line">        per(j, n - i, <span class="number">2</span>) &#123;</span><br><span class="line">            sum = (sum + f[i][j]) % mod;</span><br><span class="line">            f[i + <span class="number">1</span>][j] = (f[i + <span class="number">1</span>][j] + sum) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">2</span>, n - (K - <span class="number">1</span>) + <span class="number">1</span>) ans = (ans + f[K - <span class="number">1</span>][i]) % mod;</span><br><span class="line">    <span class="keyword">if</span> (K == <span class="number">1</span>) ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (n - K - <span class="number">1</span> &gt; <span class="number">0</span>)</span><br><span class="line">        rep(i, <span class="number">1</span>, n - K - <span class="number">1</span>) ans = (ans &lt;&lt; <span class="number">1</span>) % mod;</span><br><span class="line">        </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="AT2005-Sequential-operations-on-Sequence"><a href="#AT2005-Sequential-operations-on-Sequence" class="headerlink" title="[AT2005]-Sequential operations on Sequence"></a>[AT2005]-Sequential operations on Sequence</h2><hr><p><a href="https://imilyx.github.io/2020/02/11/[AT2005]-Sequential%20operations%20on%20Sequence/" target="_blank" rel="noopener">è§æ­¤ç¯‡</a></p><h2 id="AT2043-AND-Grid"><a href="#AT2043-AND-Grid" class="headerlink" title="[AT2043]-AND Grid"></a>[AT2043]-AND Grid</h2><hr><p>æ„é€ é¢˜ï¼Œä»¥å‰åšåˆ°è¿‡ï¼å¾ˆç¥ä»™çš„æ€è·¯ï¼Œæƒ³ä¸åˆ°qwq æ„é€ å½¢çŠ¶å¦‚åµŒåœ¨ä¸€èµ·çš„æ‰‹æŒ‡ä¸€èˆ¬</p><h2 id="AT2046-Namori"><a href="#AT2046-Namori" class="headerlink" title="[AT2046]-Namori"></a>[AT2046]-Namori</h2><hr><p>ç®€ä»‹ï¼ˆé›¾ï¼‰ï¼šä¸€é“ç»å¦™çš„è½¬åŒ–å¥½é¢˜</p><p><strong>æ ‘ æ˜¯ äºŒ åˆ† å›¾ï¼ï¼ï¼</strong></p><p><a href="https://www.luogu.com.cn/blog/flashblog/solution-at2046" target="_blank" rel="noopener">è¿™ä¸ªå¤§ä½¬å°±å†™çš„åˆ°ä½ï¼Œå¶ç¯éƒ¨åˆ†å†™å¾—ç‰¹åˆ«å¥½</a></p><p>ç„¶åæ¥è°ˆè°ˆè‡ªå·±çš„ç†è§£ï¼š</p><ol><li><p>è¿™ç§è½¬åŒ–ä¸‹ï¼Œå°†ç›¸é‚»ä¸¤ä¸ªåŒè‰²åŒæ—¶åè½¬ ç­‰ä»·äº å°†ç›¸é‚»ä¸¤ä¸ªæ˜¯å¦æœ‰ç¡¬å¸æƒ…å†µäº¤æ¢ä¸€ä¸‹</p></li><li><p>ä¹Ÿè®¸çœ‹åˆ°è¿™ç§åè½¬é¢˜ç¬¬ä¸€æ­¥å°±åº”è¯¥æŒ‰ç…§æ·±åº¦ä»€ä¹ˆçš„æ¥ä¸ªé»‘ç™½åè½¬ã€‚ã€‚ï¼Ÿè¿™æ ·æ‰èƒ½è¿›å±•qwqã€‚ã€‚<strong>æ¨¡å‹è½¬åŒ–é åšé¢˜ç»ƒ</strong></p></li><li><p>å¥‡ç¯å’Œå¶ç¯è¦åˆ†å¼€è€ƒè™‘ï¼ˆå¶ç¯æ˜¯äºŒåˆ†å›¾ï¼Œå¥‡ç¯ä¸æ˜¯ï¼‰<strong>å¥‡ç¯ä¸­æ–­æ‰çš„è¾¹åªæœ‰åˆ†æ‘Šéƒ¨åˆ†è½¬ç§»ã€åŠ å¿«è¿è¾“çš„ä½œç”¨</strong></p></li></ol><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, ans, stx, sty, fx, fy;</span><br><span class="line"><span class="keyword">int</span> to[N &lt;&lt; <span class="number">1</span>], nxt[N &lt;&lt; <span class="number">1</span>], lnk[N], cnt;</span><br><span class="line"><span class="keyword">int</span> dep[N], fa[N], s[N], a[N], top;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    to[++cnt] = y, nxt[cnt] = lnk[x], lnk[x] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fa[x] == x ? x : fa[x] = getfa(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> f, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    dep[x] = dep[f] + <span class="number">1</span>;</span><br><span class="line">    fa[x] = f;</span><br><span class="line">    s[x] = val;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x], y; i; i = nxt[i])</span><br><span class="line">        <span class="keyword">if</span> ((y = to[i]) != f)</span><br><span class="line">            dfs(y, x, -val), s[x] += s[y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) fa[i] = i;</span><br><span class="line">    stx = sty = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        <span class="keyword">if</span> ((fx = getfa(x)) != (fy = getfa(y))) fa[fx] = fy;</span><br><span class="line">        <span class="keyword">else</span> &#123; stx = x, sty = y; <span class="keyword">continue</span>; &#125;  <span class="comment">// ç¯ä¸Šè¾¹ï¼Œç»™å®ƒæ–­æ‰ï¼</span></span><br><span class="line">        add(x, y), add(y, x);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(stx, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (n == m) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = sty; i; i = fa[i]) a[++top] = s[i];</span><br><span class="line">        <span class="keyword">if</span> ((dep[stx] - dep[sty]) &amp; <span class="number">1</span>) &#123;  <span class="comment">// å¶ç¯</span></span><br><span class="line">            <span class="keyword">if</span> (s[stx]) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>), <span class="number">0</span>;</span><br><span class="line">            sort(a + <span class="number">1</span>, a + top + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = sty; i; i = fa[i]) s[i] -= a[top &gt;&gt; <span class="number">1</span>];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;  <span class="comment">// å¥‡ç¯</span></span><br><span class="line">            <span class="keyword">if</span> (s[stx] &amp; <span class="number">1</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>), <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = sty; i; i = fa[i]) s[i] -= s[stx] &gt;&gt; <span class="number">1</span>;  <span class="comment">// ç¯ä¸Šçš„æ ‘ä»¬åªç®¡æŠŠå¤šä½™çš„å¾€å¤–è¾“é€å°±å¥½äº†ï¼Œä¸»è¦æ˜¯ç¯ä¸Šè¾¹å†³å®šè¿è¾“æ–¹å‘ï¼</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (s[stx]) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">"-1"</span>), <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) ans += <span class="built_in">abs</span>(s[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="AT2063-Sugigma-The-Showdown"><a href="#AT2063-Sugigma-The-Showdown" class="headerlink" title="[AT2063]-Sugigma: The Showdown"></a>[AT2063]-Sugigma: The Showdown</h2><hr><p>æˆ‘å“¥è§£è¯´å¤ªèµäº†ï¼ï¼ï¼è¶…å¥½è¯„</p><p>åœ¨ä¸€æ£µæ ‘ä¸Šï¼Œå…ˆæ‰‹ä¸è¢«æŠ“åˆ°çš„å”¯ä¸€æƒ…å†µæ˜¯ï¼šçº¢æ ‘ä¸Šå­˜åœ¨ä¸€æ¡è¾¹ x-&gt;y, è“æ ‘ä¸Š x åˆ° y çš„è·ç¦» &gt; 2ã€‚</p><p>æ¥ä¸‹æ¥è¯´æ˜ä¸ºä»€ä¹ˆé™¤æ­¤ä¹‹å¤–éƒ½ä¼šè¢«æŠ“åˆ°ã€‚</p><p>é¦–å…ˆï¼Œåœ¨ä¸€æ£µ<strong>æ™®é€š</strong>æ ‘ä¸Šï¼Œåæ‰‹å¯ä»¥æŠŠå…ˆæ‰‹å¾€è§’è½é‡Œé€¼ï¼ˆå› ä¸ºæ²¡æœ‰ç¯ï¼‰ï¼Œå…ˆæ‰‹æŒ‚äº†ã€‚</p><p>å›åˆ°è¿™é¢˜ï¼Œâ€œè“æ ‘ä¸Š x åˆ° y çš„è·ç¦» &lt;= 2â€ï¼Œé¦–å…ˆä¸ç”¨è€ƒè™‘è·ç¦» = 1 çš„æƒ…å†µï¼ˆè¿™å°±æ˜¯æ™®é€šæ ‘çš„æƒ…å†µï¼‰</p><p>ç°åœ¨è·ç¦» = 2ï¼Œåæ‰‹ç«™åœ¨ä¸¤æ¡è“è¾¹çš„ä¸­é—´èŠ‚ç‚¹ä¸Šï¼Œå…ˆæ‰‹åœ¨ x æˆ– y ä¸Šï¼Œæ˜¾ç„¶å¦‚ç“®ä¸­æ‰é³–ï¼Œå…ˆæ‰‹æŒ‚äº†ã€‚</p><p>å› æ­¤å…ˆæ‰‹è¦é€ƒç¦»è¿™ä¸ªç»“æ„ï¼Œä½†ä¸€é€ƒç¦»å°±æ˜¯è·ç¦» = 1 çš„æƒ…å†µï¼Œè¿˜æ˜¯ä¼šæŒ‚ã€‚ã€‚</p><p>æˆ‘å“¥è®²çš„çœŸå¥½ï¼Œå°±è¿™ä¸ªé“ç†ï¼</p><p>æ‰€ä»¥æ—¶é—´å°±æ˜¯ä¸¤å€çš„åæ‰‹æ­¥æ•°ï¼Œå…ˆæ‰‹åªè¦æ‰¾åˆ°ç¦»åæ‰‹æœ€è¿œä¸”ä»–èƒ½æ¯”åæ‰‹æŠ¢å…ˆåˆ°è¾¾çš„ç‚¹å‘†ç€å°±å¥½ã€‚ã€‚ã€‚</p><h2 id="AT2064-Many-Easy-Problems"><a href="#AT2064-Many-Easy-Problems" class="headerlink" title="[AT2064]-Many Easy Problems"></a>[AT2064]-Many Easy Problems</h2><hr><p>ä¸€é“éæ¨¡æ¿çš„ NTT~ å¯ä»¥æƒ³åˆ°ç®—æ¯ä¸ªç‚¹åœ¨å¤šå°‘è”é€šå—é‡Œå‡ºç°ï¼Œä½†è¿™æ˜¾ç„¶ä¸å¥½ç®—ï¼Œæ­£éš¾åˆ™åï¼Œç»§è€Œè½¬ä¸ºç®—æ¯ä¸ªç‚¹åœ¨å¤šå°‘è”é€šå—é‡Œä¸å‡ºç°</p><p><a href="https://m-sea-blog.com/archives/4576/" target="_blank" rel="noopener">æŒ‚ä¸€ä¸ªå¤§ä½¬åšå®¢ï¼Œæ¨çš„å¼å­å°±æ˜¯è¿™ä¸ªäºšå­</a></p><p>ç„¶åæ„Ÿè§¦æ¯”è¾ƒæ·±çš„å°±æ˜¯ï¼šè®¾ F = f âœ–ï¸ gï¼Œ {\sum_{i, 0, n} f(n - i)Â·g(i)} = F(n) ï¼</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">æ„Ÿæ…¨ï¼šå·ç§¯åŸæ¥æ˜¯è¿™ä¹ˆç”¨çš„å•Š..</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">924844033</span>, N = <span class="number">4e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, lim = <span class="number">1</span>, l;</span><br><span class="line"><span class="keyword">int</span> to[N &lt;&lt; <span class="number">1</span>], nxt[N &lt;&lt; <span class="number">1</span>], lnk[N], ecnt;</span><br><span class="line"><span class="keyword">int</span> sz[N], cnt[N], r[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line">ll f[N], g[N], fac[N], inv[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    to[++ecnt] = y, nxt[ecnt] = lnk[x], lnk[x] = ecnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quick_pow</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ret = ret * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">    &#125; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">C</span><span class="params">(ll n, ll m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1l</span>l * fac[n] * inv[m] % mod * inv[n - m] % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    fac[<span class="number">0</span>] = inv[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) fac[i] = fac[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">    inv[n] = quick_pow(fac[n], mod - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; i--) inv[i - <span class="number">1</span>] = inv[i] * i % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    sz[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x], y; i; i = nxt[i])</span><br><span class="line">        <span class="keyword">if</span> ((y = to[i]) != fa)</span><br><span class="line">            dfs(y, x), sz[x] += sz[y], cnt[sz[y]]++;</span><br><span class="line">    cnt[n - sz[x]]++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">NTT</span><span class="params">(ll *a, <span class="keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">0</span>, lim - <span class="number">1</span>) <span class="keyword">if</span> (i &lt; r[i]) swap(a[i], a[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> mid = <span class="number">1</span>; mid &lt; lim; mid &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        ll W = quick_pow(op == <span class="number">1</span> ? <span class="number">5</span> : <span class="number">554906420</span>, (mod - <span class="number">1</span>) / (mid &lt;&lt; <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; lim; j += (mid &lt;&lt; <span class="number">1</span>)) &#123;</span><br><span class="line">            ll w = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; mid; k++, w = w * W % mod) &#123;</span><br><span class="line">                ll x = a[j + k], y = w * a[j + k + mid] % mod;</span><br><span class="line">                a[j + k] = (x + y) % mod, a[j + k + mid] = (x - y + mod) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (op == <span class="number">-1</span>) &#123;</span><br><span class="line">        ll x = quick_pow(lim, mod - <span class="number">2</span>);</span><br><span class="line">        rep(i, <span class="number">0</span>, lim - <span class="number">1</span>) a[i] = a[i] * x % mod;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    pre();</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        add(x, y), add(y, x);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) f[i] = <span class="number">1l</span>l * cnt[i] * fac[i] % mod;</span><br><span class="line">    reverse(f, f + n + <span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">0</span>, n) g[i] = inv[i];</span><br><span class="line">    <span class="keyword">while</span> (lim &lt;= n * <span class="number">2</span>) lim &lt;&lt;= <span class="number">1</span>, l++;</span><br><span class="line">    rep(i, <span class="number">0</span>, lim - <span class="number">1</span>) r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (l - <span class="number">1</span>));</span><br><span class="line">    NTT(f, <span class="number">1</span>), NTT(g, <span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">0</span>, lim) f[i] = (f[i] * g[i]) % mod;</span><br><span class="line">    NTT(f, <span class="number">-1</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, (n * C(n, i) % mod - inv[i] * f[n - i] % mod + mod) % mod);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> CF&amp;ATå¾€å±Š </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 618 Div1</title>
      <link href="2020/02/29/Codeforces%20Round%20618%20Div1/"/>
      <url>2020/02/29/Codeforces%20Round%20618%20Div1/</url>
      
        <content type="html"><![CDATA[<p>ç¬¬ä¸€æ¬¡ vp Div1 ~</p><h3 id="A-Anu-Has-a-Function"><a href="#A-Anu-Has-a-Function" class="headerlink" title="A. Anu Has a Function"></a>A. Anu Has a Function</h3><hr><p>è€ƒè™‘ (x | y) - y çš„æ„ä¹‰ï¼šç­‰åŒäºä¿ç•™æ‰€æœ‰<strong>åªæœ‰ x ä¸º 1</strong>çš„äºŒè¿›åˆ¶ä½</p><p>é‚£ä¹ˆå°±å¾ˆå¥½åŠï¼šé€‰æ‹©ä¸å’Œå…¶ä»–æ•°æ’ä½çš„ã€æœ‰æœ€é«˜ä½çš„æ•°æ”¾ç¬¬ä¸€ä¸ª</p><ul><li>äºŒè¿›åˆ¶é¢˜è¦è€ƒè™‘æ„ä¹‰</li></ul><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line">ll n, a[N], id[<span class="number">40</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        ll x = a[i];</span><br><span class="line">        rep(j, <span class="number">0</span>, <span class="number">32</span>)</span><br><span class="line">            <span class="keyword">if</span> ((x &gt;&gt; j) &amp; <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (id[j] &gt; <span class="number">0</span>) id[j] = <span class="number">-1</span>;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (!id[j]) id[j] = i;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">32</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">if</span> (id[i] &gt; <span class="number">0</span>) &#123; swap(a[<span class="number">1</span>], a[id[i]]); <span class="keyword">break</span>; &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">printf</span>(<span class="string">"%lld "</span>, a[i]); <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-Water-Balance"><a href="#C-Water-Balance" class="headerlink" title="C. Water Balance"></a>C. Water Balance</h3><hr><p>æœ‰ç‚¹æ„æ€ã€‚æœ€ç»ˆï¼Œè‹¥å°†ç›¸é‚»ã€å€¼ç›¸ç­‰çš„ä½ç½®å½’ä¸ºä¸€å—ï¼Œå¿…ä¸å­˜åœ¨ç¬¬ i å—çš„å€¼å¤§äºç¬¬ i + 1 å—çš„æƒ…å†µã€‚ç¬¬ i å—å¦‚æœå¾ˆå°ï¼Œå®ƒè‚¯å®šä¼šä¼˜å…ˆä¸ i - 1 åˆå¹¶è€Œä¸æ˜¯å’Œ i + 1ï¼ˆå­—å…¸åºå˜›ã€‚ã€‚ï¼‰å•è°ƒæ ˆç»´æŠ¤ï¼ï¼</p><p>è¿˜æœ‰ä¸€ç§æ€è·¯ï¼šç»´æŠ¤ä¸‹å‡¸å£³ï¼Œä¹Ÿä¸€æ ·å¯ä»¥åš</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">double</span> a[N], s[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span> <span class="keyword">int</span> l, r; <span class="keyword">double</span> ave; &#125;stk[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;a[i]), s[i] = s[i - <span class="number">1</span>] + a[i];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        stk[++top] = (node)&#123;i, i, a[i]&#125;;</span><br><span class="line">        <span class="keyword">while</span> (top &gt; <span class="number">1</span> &amp;&amp; stk[top].ave &lt; stk[top - <span class="number">1</span>].ave) &#123;</span><br><span class="line">            top--, stk[top].r = stk[top + <span class="number">1</span>].r;</span><br><span class="line">            stk[top].ave = (s[stk[top].r] - s[stk[top].l - <span class="number">1</span>]) / (stk[top].r - stk[top].l + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, top) rep(j, stk[i].l, stk[i].r) <span class="built_in">printf</span>(<span class="string">"%.9lf\n"</span>, stk[i].ave);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[AT2005]-Sequential operations on Sequence</title>
      <link href="2020/02/11/%5BAT2005%5D-Sequential%20operations%20on%20Sequence/"/>
      <url>2020/02/11/%5BAT2005%5D-Sequential%20operations%20on%20Sequence/</url>
      
        <content type="html"><![CDATA[<p>åˆæ˜¯é“å¤§å¥½é¢˜ï¼Œï¼Œ</p><ul><li>æ€ç»´é¢˜ï¼Œæ¦‚æ‹¬ä¸äº†</li></ul><ol><li>è¿™æ­¥å¿…é¡»æƒ³åˆ°ï¼Œæ˜¯æ ¹åŸºã€‚å¯¹ç…§æ ·ä¾‹åº”è¯¥ä¹Ÿèƒ½å‘ç°è¿™ä¸ªæ€§è´¨ï¼šç”¨å•è°ƒæ ˆå°† $q$ å˜æˆä¸Šå‡çš„åºåˆ—ï¼Œ<strong>ç¬¬ $i$ æ­¥æ“ä½œåå¾—åˆ°çš„åºåˆ—å°±æ˜¯ç¬¬ $i - 1$ æ­¥æ“ä½œå¾—åˆ°åºåˆ—çš„å‡ å€ + å‰ç¼€</strong></li><li>è§è¿‡æ¨åœŸæœºå—ï¼Ÿè¿™é¢˜å®ç°èµ·æ¥å°±æ˜¯è¿™æ ·ã€‚è®¾ $f[i]$ è¡¨ç¤ºç¬¬ $i$ æ­¥æ“ä½œåçš„åºåˆ—åœ¨æœ€ç»ˆåºåˆ—ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œæ˜¾ç„¶ $f[i] = f[i + 1] * (len[i + 1] / len[i])$ï¼Œä½™æ•°éƒ¨åˆ†æ‰¾å¾ªç¯èŠ‚ï¼Œè¯¸å¦‚æ­¤ç±»ï¼Œé€’è§„å¤„ç†ã€‚ä¸æ–­è¢«è‚¢è§£ï¼Œæœ€åå‰©ä¸‹çš„ä¸€å°æ’®æ²¡æœ‰å¾ªç¯èŠ‚äº†ï¼Œé‚£ä¸€å°æ’®é•¿è¿™æ ·ï¼š1 2 3 4 â€¦ ä¹Ÿå°±æ˜¯åˆå§‹åºåˆ—çš„å‰ç¼€ï¼Œæå‰ç´¯è®¡åˆ° ans[] é‡Œ</li><li>å¤æ‚åº¦åˆ†æï¼šä½™æ•°éƒ¨åˆ†å¤„ç†ï¼Œæ¯æ¬¡å¯¹ä¸€ä¸ªæ¯”è‡ªå·±å°çš„å¾ªç¯èŠ‚é•¿åº¦å–æ¨¡ï¼Œè‡³å°‘å‡å°ä¸€åŠï¼Œå³ $logn$; äºŒåˆ†æ‰¾å°äºä½™æ•°éƒ¨åˆ†é•¿åº¦çš„æœ€å¤§å¾ªç¯èŠ‚ï¼Œ$logn$ï¼Œæ‰€ä»¥æœ€åæ˜¯ $O(n log^2 n)$</li></ol><p>å…¶å®æƒ³æƒ³ï¼Œå°±å¥½åƒä¸€ä¸ªåºåˆ—ä¸æ–­è¢«æ‰“ä¹±ï¼ŒæŠŠå®ƒå¤åŸå°±å¯ä»¥äº†ã€‚ã€‚å¾ˆæŠ½è±¡äº†</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ‰æ²¡æœ‰æ€è·¯éƒ½å…ˆåˆ†æå®Œæ ·ä¾‹ï¼ï¼ï¼è¯´ä¸å®šä¼šæœ‰å¯å‘ï¼ï¼ï¼</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line">ll n, Q, m, q[N], x, f[N], ans[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(ll x, ll v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k = upper_bound(q + <span class="number">1</span>, q + m + <span class="number">1</span>, x) - q - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (!k) &#123;</span><br><span class="line">        ans[<span class="number">1</span>] += v, ans[x + <span class="number">1</span>] -= v;  <span class="comment">// æå‰ç´¯è®¡</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    f[k] += v * (x / q[k]), solve(x % q[k], v);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; Q;</span><br><span class="line">    q[++m] = n;</span><br><span class="line">    rep(i, <span class="number">1</span>, Q) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;x);</span><br><span class="line">        <span class="keyword">while</span> (m &amp;&amp; q[m] &gt;= x) --m;</span><br><span class="line">        q[++m] = x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    f[m] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = m; i &gt;= <span class="number">2</span>; i--)</span><br><span class="line">        f[i - <span class="number">1</span>] += f[i] * (q[i] / q[i - <span class="number">1</span>]), solve(q[i] % q[i - <span class="number">1</span>], f[i]);</span><br><span class="line"></span><br><span class="line">    ans[<span class="number">1</span>] += f[<span class="number">1</span>], ans[q[<span class="number">1</span>] + <span class="number">1</span>] -= f[<span class="number">1</span>];</span><br><span class="line">    rep(i, <span class="number">1</span>, n) ans[i] += ans[i - <span class="number">1</span>], <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[AT2004]-Anticube</title>
      <link href="2020/02/10/%5BAT2004%5D-Anticube/"/>
      <url>2020/02/10/%5BAT2004%5D-Anticube/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vjudge.net/problem/AtCoder-2004" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>é¢˜æ„ï¼šä» n ä¸ªæ•°ä¸­é€‰æœ€å¤šçš„æ•°ä½¿å¾—å®ƒä»¬ä¸¤ä¸¤ç›¸ä¹˜ä¸æ˜¯ç«‹æ–¹æ•°ã€‚</p><p><a href="https://blog.csdn.net/WerKeyTom_FTD/article/details/78361615" target="_blank" rel="noopener">å¤§ä½¬åšå®¢</a></p><p>å¤§è‡´æ€è·¯å°±æ˜¯ <strong>è´¨å› æ•°åˆ†è§£ + è´ªå¿ƒ</strong> äº†ï¼Œæœ¬é¢˜é‡ç‚¹åœ¨è´¨å› æ•°åˆ†è§£ï¼ï¼</p><p>é¦–å…ˆï¼Œå°†æ¯ä¸ª $s_i$ çœ‹ä½œ $prod{p_i ^ {a_i}}$. ç«‹æ–¹æ•° âœ–ï¸ ç«‹æ–¹æ•° = ç«‹æ–¹æ•°ï¼Œè¿™å¯å‘æˆ‘ä»¬ç®€åŒ–æŒ‡æ•°ï¼Œå³ $a_i$ å¯¹ $3$ å–æ¨¡</p><p>ä½†æ˜¯è´¨å› æ•°åˆ†è§£ç†è®ºä¸Šæ—¶é—´å¤æ‚åº¦å¤ªå¤§äº†ï¼ï¼æ€ä¹ˆåŠï¼ï¼ï¼</p><p>è®¾ $s_i * s_j = x^3$, $s_i * s_j \leq 10^{20}$, $x \leq 10^{20/3}$ã€‚$x$ å¯èƒ½æœ‰ä¸€ä¸ª $[10^{10/3}, 10^{20/3}]$ çš„è´¨å› å­ï¼Œä½†æ˜¯å¦‚æœè¿™ä¸ªè´¨å› å­å¤§äº $10^5$, $s_i$ å’Œ $s_j$ æ€»å…±ä¹Ÿä¸å¯èƒ½æœ‰ $3$ ä¸ªï¼Œ<strong>æ‰€ä»¥ $x$ çš„æ¯ä¸ªè´¨å› å­éƒ½æ˜¯ $[2, 10^5]$ èŒƒå›´å†…çš„ï¼Œå…¶ä¸­ $[10^{10/3}, 10^5]$ ä»¥å†…çš„æ•°æœ€å¤šåªæœ‰ä¸€ä¸ªã€‚</strong></p><p>å¯¹äºå¤§ä½¬æœ€åä¸€è¡Œï¼Œæˆ‘çš„ç†è§£æ˜¯ï¼Œ$s_i$ ä¸­ $&gt; 10^{10/3}$ çš„è´¨å› å­ï¼Œåœ¨ $[10^{10/3}, 10^5]$ èŒƒå›´å†…çš„éƒ¨åˆ† æŒ‡æ•°åªä¼šæ˜¯ $1$ æˆ– $2$ï¼Œè€Œ $&gt; 10^5$ çš„éƒ¨åˆ†æœ€å¤šåªæœ‰ $1$ ä¸ªï¼Œä¸å½±å“å¤§å±€ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line">ll n, s[N], a[N], b[N], ans;  <span class="comment">// a[i] å­˜çš„æ˜¯ s[i] çš„æœ€ç®€æ•°ï¼Œb[i] æ˜¯ a[i] çš„è¡¥æ•°</span></span><br><span class="line"><span class="built_in">map</span>&lt;ll, <span class="keyword">int</span>&gt; num;</span><br><span class="line"><span class="built_in">map</span>&lt;ll, <span class="keyword">bool</span>&gt; vis;</span><br><span class="line"><span class="keyword">int</span> mark[N], p[N], tot;</span><br><span class="line"><span class="comment">// æ‹“å±•ï¼š10^&#123;10/3&#125; ä»¥å†…è´¨æ•°æœ‰ 326 ä¸ªï¼Œ10^&#123;10/3&#125;~10^5 ä»¥å†…è´¨æ•°æœ‰ 9267 ä¸ª</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">euler</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">2</span>, n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!mark[i]) p[++tot] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; p[j] * i &lt;= n; j++) &#123;</span><br><span class="line">            mark[p[j] * i] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % p[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    euler(<span class="number">100000</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;s[i]);</span><br><span class="line"></span><br><span class="line">    ll k, tmp;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        k = s[i]; a[i] = b[i] = <span class="number">1</span>;</span><br><span class="line">        rep(o, <span class="number">1</span>, tot) &#123;</span><br><span class="line">            <span class="keyword">if</span> (k == <span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">            ll j = p[o];</span><br><span class="line">            <span class="keyword">if</span> (j * j * j &gt;= <span class="number">1e10</span>) <span class="keyword">break</span>;  <span class="comment">// 10^&#123;10/3&#125; ä»¥å†…</span></span><br><span class="line">            <span class="keyword">if</span> (mark[j]) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            tmp = <span class="number">1l</span>l * j * j * j;</span><br><span class="line">            <span class="keyword">while</span> (k % tmp == <span class="number">0</span>) k /= tmp;  <span class="comment">// ç®€åŒ–</span></span><br><span class="line">            tmp = <span class="number">1l</span>l * j * j;</span><br><span class="line">            <span class="keyword">if</span> (k % tmp == <span class="number">0</span>) a[i] *= tmp, b[i] *= j;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (k % j == <span class="number">0</span>) a[i] *= j, b[i] *= tmp;</span><br><span class="line">            <span class="keyword">while</span> (k % j == <span class="number">0</span>) k /= j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (k &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            tmp = (ll)<span class="built_in">sqrt</span>(k);</span><br><span class="line">            <span class="keyword">if</span> (tmp * tmp == k) a[i] *= k, b[i] *= tmp;</span><br><span class="line">            <span class="keyword">else</span> a[i] *= k, b[i] *= k * k;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) num[a[i]]++;  <span class="comment">// a[i] æ˜¯ s[i] å»æ‰æŒ‡æ•°æ˜¯ 3 å€æ•°è´¨å› å­çš„ç»“æœ</span></span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[a[i]]) <span class="keyword">continue</span>;</span><br><span class="line">        vis[a[i]] = vis[b[i]] = <span class="number">1</span>;</span><br><span class="line">        ans += (a[i] == b[i] ? <span class="number">1</span> : max(num[a[i]], num[b[i]]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> è´ªå¿ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[AT1984]-Wide Swap</title>
      <link href="2020/02/09/%5BAT1984%5D-Wide%20Swap/"/>
      <url>2020/02/09/%5BAT1984%5D-Wide%20Swap/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vjudge.net/problem/AtCoder-1984" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>è¿™é¢˜å¤ªç¥äº†ï¼ï¼ï¼æˆ‘çˆ±æ­» atcoder äº†ï¼ï¼ï¼ï¼ï¼</p><p><a href="https://www.cnblogs.com/cjoierShiina-Mashiro/p/12233486.html" target="_blank" rel="noopener">è¿™ä½å¤§ä½¬è®²çš„å¥½ï¼Œæˆ‘å†è¡¥å……äº›è‡ªå·±çš„ç†è§£</a></p><p>æ€»ç»“å‡ºæ¥è§£é¢˜çš„å¸¸ç”¨æ­¥éª¤ï¼Œä¹Ÿå°±æ˜¯æœ€é‡è¦çš„æŠ€èƒ½æ˜¯ <strong>è½¬åŒ–</strong> å’Œ <strong>æ‰¾æ€§è´¨</strong>ã€‚</p><p>å¥½ï¼æœ¬é¢˜å¿…é¡»è½¬åŒ–ã€‚æœ¬æ¥å¿…é¡»æ»¡è¶³ä¸¤æ¡é™åˆ¶ï¼ˆè§é¢˜ç›®ï¼‰ï¼Œä½†å¤§ä½¬è¿™ä¹ˆä¸€è½¬åŒ–å°±é™å®šå¥½åªèƒ½äº¤æ¢ç›¸é‚»ä½ç½®ï¼Œä¸¤æ¡é™åˆ¶ä¸€ä¸‹å˜æˆä¸€æ¡äº†ï¼</p><p>æ±‚ $p$ æœ€å°å­—å…¸åºç­‰åŒäºæ±‚ $q$ æœ€å°å­—å…¸åºï¼Œä¸ºä»€ä¹ˆï¼Ÿ$q_{p_i}$ è¡¨è¾¾çš„æ˜¯ä»€ä¹ˆï¼Ÿ$q_{p_i}$ è¡¨ç¤º $p_i$ ç›®å‰æ”¾çš„ä½ç½®ã€‚</p><p>$q$ çš„ä¸‹æ ‡ä»å°åˆ°å¤§é€’å¢ã€‚å¯¹äº $p_i &lt; p_j$, $q_{p_i} &lt; q_{p_j}$ï¼ˆå³æ›´å°çš„å€¼ä½ç½®æ›´å‰ï¼‰æ˜¾ç„¶æ˜¯æ¯”è¾ƒä¼˜çš„ã€‚æ‰€ä»¥æ±‚ $p$ æœ€å°å­—å…¸åºç­‰åŒäºæ±‚ $q$ æœ€å°å­—å…¸åºã€‚</p><p>$q$ ä¸­ï¼Œå¦‚æœ $1 \leq i, j \leq n$, $|qi - qj| &lt; K$, æ˜¾ç„¶ $q_i$ å’Œ $q_j$ çš„ç›¸å¯¹ä½ç½®ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚å­˜åœ¨ç€å¾ˆå¤šè¯¸å¦‚æ­¤ç±»çš„é™åˆ¶ï¼Œæˆ‘ä»¬åˆæƒ³è¦ $q$ å­—å…¸åºæœ€å°ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>æœ€å°æ‹“æ‰‘åºã€‚å¯¹äº $1 \leq i &lt; j \leq n$, $|qi - qj| &lt; K$, ä» $q_i$ å‘ $q_j$ è¿ä¸€æ¡è¾¹ï¼Œè¿™æ ·ä¸ä»…æ»¡è¶³äº†æ‰€æœ‰é™åˆ¶ï¼Œä¹Ÿä½¿ $q$ çš„å­—å…¸åºæœ€å°äº†ã€‚<strong>è¿™æ˜¯å¥—è·¯ï¼Œä¸€å®šè¦æŒæ¡ï¼ï¼ï¼</strong></p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è§£é¢˜å¸¸ç”¨æ­¥éª¤ï¼šè½¬åŒ– æ‰¾æ€§è´¨</span></span><br><span class="line"><span class="comment">// æœ¬é¢˜ç¬¬ä¸€æ­¥è½¬åŒ–èµ·åˆ°äº†ç®€åŒ–çš„ä½œç”¨</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span> + <span class="number">10</span>, inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n, K, a[N], x, ans[N];</span><br><span class="line"><span class="keyword">int</span> mn[N &lt;&lt; <span class="number">2</span>], deg[N];</span><br><span class="line">priority_queue&lt;<span class="keyword">int</span>, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;, greater&lt;<span class="keyword">int</span>&gt; &gt;q;  <span class="comment">// ç”¨ pq æ¥æ±‚æœ€å°æ‹“æ‰‘åº</span></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; e[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; mn[x] = min(mn[x &lt;&lt; <span class="number">1</span>], mn[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> pos, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123; mn[x] = v; <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (pos &lt;= mid) modify(x &lt;&lt; <span class="number">1</span>, l, mid, pos, v);</span><br><span class="line">    <span class="keyword">else</span> modify(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, pos, v);</span><br><span class="line">    upd(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> lx, <span class="keyword">int</span> rx)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (rx &lt; l || lx &gt; r) <span class="keyword">return</span> inf;</span><br><span class="line">    <span class="keyword">if</span> (lx &lt;= l &amp;&amp; r &lt;= rx) <span class="keyword">return</span> mn[x];</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> min(query(x &lt;&lt; <span class="number">1</span>, l, mid, lx, rx), query(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, lx, rx));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; K;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x), a[x] = i;</span><br><span class="line">    <span class="built_in">memset</span>(mn, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(mn));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n, j; i &gt;= <span class="number">1</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((j = query(<span class="number">1</span>, <span class="number">1</span>, n, a[i] + <span class="number">1</span>, a[i] + K - <span class="number">1</span>)) != inf)</span><br><span class="line">            ++deg[a[j]], e[a[i]].push_back(a[j]);</span><br><span class="line">        <span class="keyword">if</span> ((j = query(<span class="number">1</span>, <span class="number">1</span>, n, a[i] - K + <span class="number">1</span>, a[i] - <span class="number">1</span>)) != inf)</span><br><span class="line">            ++deg[a[j]], e[a[i]].push_back(a[j]);</span><br><span class="line">        modify(<span class="number">1</span>, <span class="number">1</span>, n, a[i], i);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="keyword">if</span> (!deg[i]) q.push(i);</span><br><span class="line">    <span class="keyword">int</span> tot = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.top(); q.pop();</span><br><span class="line">        a[++tot] = x;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; e[x].size(); i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = e[x][i];</span><br><span class="line">            <span class="keyword">if</span> (!(--deg[y])) q.push(y); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) ans[a[i]] = i;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
            <tag> æ‹“æ‰‘æ’åº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Usaco20Jan (Gold)</title>
      <link href="2020/02/02/Usaco20Jan%20(Gold)/"/>
      <url>2020/02/02/Usaco20Jan%20(Gold)/</url>
      
        <content type="html"><![CDATA[<p><a href="http://www.usaco.org/index.php?page=jan20results" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>é¢˜éƒ½å¾ˆå¥½ï¼Œæˆ‘å¤ªèœäº†ï¼ŒåŠ æ²¹ï¼å†²å†²å†²</p><h3 id="A-Time-is-Mooney"><a href="#A-Time-is-Mooney" class="headerlink" title="A. Time is Mooney"></a>A. Time is Mooney</h3><hr><p>å¯ä»¥å‘ç°ï¼Œç‚¹æƒæœ€å¤§æ˜¯ 1000ï¼ŒC æœ€å°æ˜¯ 1ï¼Œä¹Ÿå°±æ„å‘³ç€ 1000t - t^2 &gt;= 0, t &lt;= 1000!!</p><p>é‚£ä¹ˆæšä¸¾ t å°±å¯ä»¥å•¦ï¼Œans = max(ä» 1 å‡ºå‘ï¼Œç»è¿‡ t æ­¥èµ°å› 1 çš„ maxval)</p><p>è®¾ dp[t, i] è¡¨ç¤ºèµ° t æ­¥åˆ° i èŠ‚ç‚¹çš„æœ€å¤§ç‚¹æƒå’Œï¼Œè¿™æ ·å°±èƒ½æ±‚æ‹¬å·é‡Œçš„é‚£ä¸ªä¸œè¥¿å•¦ã€‚ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line">ll dp[<span class="number">2</span>][N], n, m, C, a[N], ans;  <span class="comment">// æ»šåŠ¨</span></span><br><span class="line"><span class="built_in">vector</span>&lt;pii&gt; edges;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    freopen(<span class="string">"time.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    freopen(<span class="string">"time.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; C;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]);</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="keyword">int</span> a, b; <span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b;</span><br><span class="line">        edges.push_back(make_pair(a, b));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">-1</span>, <span class="keyword">sizeof</span>(dp));</span><br><span class="line">    ans = <span class="number">-1e18</span>;</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    rep(t, <span class="number">1</span>, <span class="number">1000</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> p = t % <span class="number">2</span>;</span><br><span class="line">        <span class="built_in">memset</span>(dp[p], <span class="number">-1</span>, <span class="keyword">sizeof</span>(dp[p]));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; edges.size(); i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = edges[i].first, y = edges[i].second;</span><br><span class="line">            <span class="keyword">if</span> (dp[p ^ <span class="number">1</span>][x] != <span class="number">-1</span>)</span><br><span class="line">                dp[p][y] = max(dp[p][y], dp[p ^ <span class="number">1</span>][x] + a[y]);</span><br><span class="line">        &#125;</span><br><span class="line">        ans = max(ans, dp[p][<span class="number">1</span>] - C * t * t);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-Farmer-John-Solves-3SUM"><a href="#B-Farmer-John-Solves-3SUM" class="headerlink" title="B. Farmer John Solves 3SUM"></a>B. Farmer John Solves 3SUM</h3><hr><p>n = 5000ï¼Œå¦¥å¦¥ n^2ã€‚å¦‚æœèƒ½åšåˆ° n^2 é¢„å¤„ç†å°±å¥½å•¦ï¼</p><p>æ»´â€“ï¼ç”¨ pbds åº“é‡Œçš„ hashï¼ŒO(1) è¶…å¿«ï¼Œç”¨ set æˆ– map ä¼šè¶…æ—¶derã€‚ã€‚ã€‚</p><p>å…·ä½“ç”¨æ³•ä¸‹é¢æœ‰ğŸ‘‡</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// map, set, multimap, and multiset: log(n)</span></span><br><span class="line"><span class="comment">// hash_map, hash_set, hash_multimap, and hash_multiset: best O(1), worst O(n)</span></span><br><span class="line"><span class="comment">// pb_dsåº“é‡Œçš„hash: 1. éœ€è¦å¤´æ–‡ä»¶(line 5,6,8) 2. å‡½æ•°å£°æ˜(line 23) 3. ä½¿ç”¨æ–¹å¼(line 25~28)</span></span><br><span class="line"><span class="comment">// C++11!</span></span><br><span class="line"><span class="comment">// C++11!!</span></span><br><span class="line"><span class="comment">// C++11!!!</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ext/pb_ds/assoc_container.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ext/pb_ds/hash_policy.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_pbds;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e3</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, Q, a[N];</span><br><span class="line">ll ans[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    freopen(<span class="string">"threesum.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    freopen(<span class="string">"threesum.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; Q;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        gp_hash_table&lt;int, int&gt; g(&#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;1 &lt;&lt; 13&#125;);</span><br><span class="line">        rep(j, i + <span class="number">1</span>, n) &#123;</span><br><span class="line">            <span class="keyword">auto</span> it = g.find(-a[i] - a[j]);</span><br><span class="line">            <span class="keyword">if</span> (it != end(g)) ans[i][j] = it-&gt;second;</span><br><span class="line">            g[a[j]]++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">        rep(j, i, n)</span><br><span class="line">            ans[i][j] += ans[i + <span class="number">1</span>][j] + ans[i][j - <span class="number">1</span>] - ans[i + <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line">            </span><br><span class="line">    <span class="keyword">while</span> (Q--) &#123;</span><br><span class="line">        <span class="keyword">int</span> l, r; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;l, &amp;r);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[l][r]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-Springboards"><a href="#C-Springboards" class="headerlink" title="C. Springboards"></a>C. Springboards</h3><hr><p>å°†ç‰¹æ®Šç‚¹æŒ‰ xã€y åæ ‡æ’åºã€‚è®¾ ans[i] è¡¨ç¤ºåˆ°ç¬¬ i ä¸ªè½åœ°ç‚¹çš„æœ€çŸ­è·ç¦»ã€‚</p><p>ç¬¬ i ä¸ªç‚¹ä¹‹å‰çš„ç‚¹æ˜¯ç¬¬ j ä¸ªçš„è¯ï¼Œans[i] = xi + yi - xj - yj + ans[j]</p><p>æ‰€ä»¥æˆ‘ä»¬ç¢°åˆ°è½åœ°ç‚¹å°±è®¡ç®— ans[i], ç¢°åˆ°èµ·è·³ç‚¹å°±å°† ans[i] - xi - yi åŠ å…¥ mapï¼Œmap ç»´æŠ¤ä¹‹å‰ç»è¿‡çš„æ‰€æœ‰ç‚¹çš„ç­”æ¡ˆã€‚map ç¬¬ä¸€ç»´æ˜¯ y åæ ‡ï¼Œç¬¬äºŒç»´æ˜¯ valã€‚</p><p>æ˜¾ç„¶ï¼Œå¯¹äºä¸¤ä¸ªå…¥ map é¡ºåº i &lt; j çš„ç‚¹ï¼Œè‹¥ yi &lt; yj ä¸” vali &lt; valjï¼Œé‚£ä¹ˆ j æ˜¾ç„¶æ²¡æœ‰å¿…è¦å…¥ mapã€‚æœ¬ç€è¿™ä¸ªåŸåˆ™ã€‚æ˜¾ç„¶ map æœ€åæ˜¯ y è¶Šå¤§ï¼Œval è¶Šå°çš„ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">int</span> n, p, ans[N];</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mp;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> y, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> it = prev(mp.upper_bound(y));</span><br><span class="line">    <span class="keyword">if</span> ((*it).se &lt;= v) <span class="keyword">return</span>;  <span class="comment">// (*it).se = it-&gt;se</span></span><br><span class="line">    it++;</span><br><span class="line">    <span class="keyword">while</span> (it != mp.end() &amp;&amp; it-&gt;se &gt; v) mp.erase(it++);</span><br><span class="line">    mp[y] = v;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    freopen(<span class="string">"boards.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    freopen(<span class="string">"boards.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; p;</span><br><span class="line">    mp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">vector</span>&lt;pair&lt;pii, pii&gt;&gt; v;</span><br><span class="line">    rep(i, <span class="number">1</span>, p) &#123;</span><br><span class="line">        pii a, b;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; a.fi &gt;&gt; a.se &gt;&gt; b.fi &gt;&gt; b.se;</span><br><span class="line">        v.push_back(&#123;a, &#123;i, <span class="number">-1</span>&#125;&#125;);</span><br><span class="line">        v.push_back(&#123;b, &#123;i, <span class="number">1</span>&#125;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    sort(v.begin(), v.end());</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; v.size(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v[i].se.se == <span class="number">-1</span>) &#123;</span><br><span class="line">            ans[v[i].se.fi] = v[i].fi.fi + v[i].fi.se + prev(mp.upper_bound(v[i].fi.se))-&gt;se;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            insert(v[i].fi.se, ans[v[i].se.fi] - v[i].fi.fi - v[i].fi.se);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, mp.rbegin()-&gt;se + <span class="number">2</span> * n);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ä¹ é¢˜é€‰è®²ã€‘è™šæ ‘</title>
      <link href="2020/02/01/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91%E8%99%9A%E6%A0%91/"/>
      <url>2020/02/01/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91%E8%99%9A%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<p>è™šæ ‘ï¼Œæ²¡é‚£ä¹ˆç„ä¹ï¼Œé’ˆå¯¹çš„æ˜¯â€œå¤šæ¬¡æ ‘ä¸Šè¯¢é—®ä¸€äº›ç‚¹â€çš„é¢˜ç›®ã€‚æ¯”å¦‚ä¸‹é¢è¿™é“é¢˜ï¼Œé¢˜é¢ä¸­å°±æœ‰è¿™æ ·çš„è¡¨è¿°ï¼šsigma(ki)&lt;=500000 é‚£ä¹ˆæˆ‘ä»¬çš„ç®—æ³•ä¸€å®šä¸å’Œ n æœ‰å…³ï¼Œè€Œæ˜¯å’Œ k æœ‰å…³å•¦ï¼</p><p>è™šæ ‘çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯ O(sigma(ki))ï¼ä¸‹é¢æ˜¯ç»ƒä¹ æ—¶é—´~</p><h3 id="SDOI2011-æ¶ˆè€—æˆ˜"><a href="#SDOI2011-æ¶ˆè€—æˆ˜" class="headerlink" title="[SDOI2011]-æ¶ˆè€—æˆ˜"></a>[SDOI2011]-æ¶ˆè€—æˆ˜</h3><hr><p><a href="https://www.lydsy.com/JudgeOnline/problem.php?id=2286" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>å¾ˆå®¹æ˜“æƒ³åˆ°æ ‘å½¢DPï¼Œä½†é‚£æ ·å°±æ˜¯ O(nm)ï¼Œå¤ªå¤§äº†ï¼è‚¿ä¹ˆåŠ à² _à²  ä¸Šè™šæ ‘ï¼</p><p>æ¯æ¬¡æŠŠè¯¢é—®ç‚¹åŠå®ƒä»¬çš„ LCA æ‘˜å‡ºæ¥é‡æ–°å»ºä¸€æ£µæ ‘ï¼Œä¹Ÿå°±æ˜¯è™šæ ‘ï¼Œè™šæ ‘ä¸Šæ ‘å½¢ DPï¼Œå•æ¬¡ O(ki)ã€‚</p><p>æ³¨æ„ï¼Œæœ¬é¢˜ç‰¹æ®Šæ€§åœ¨äºï¼Œä¸€æ¡é“¾è‹¥æ˜¯ æ ¹-&gt;a-&gt;b-&gt;cï¼Œé‚£ä¹ˆåªè¦ä¿ç•™ æ ¹-&gt;a è¿™æ®µè·¯å¾„å°±å¯ä»¥äº†ï¼è¿™ä¸ªå¾ˆæ˜æ˜¾å§</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, m, a[N], idx;</span><br><span class="line"><span class="keyword">int</span> dep[N], son[N], fa[N], tp[N], sz[N], dfn[N];</span><br><span class="line"><span class="keyword">int</span> lnk[N], nxt[N &lt;&lt; <span class="number">1</span>], to[N &lt;&lt; <span class="number">1</span>], val[N &lt;&lt; <span class="number">1</span>], cnt;</span><br><span class="line"><span class="keyword">int</span> stk[N], top;</span><br><span class="line">ll mn[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; v[N];</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; <span class="keyword">return</span> dfn[x] &lt; dfn[y]; &#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span> </span>&#123;</span><br><span class="line">    to[++cnt] = y, nxt[cnt] = lnk[x], lnk[x] = cnt, val[cnt] = z;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123; v[x].push_back(y); &#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> father)</span> </span>&#123;</span><br><span class="line">    fa[x] = father;</span><br><span class="line">    dfn[x] = ++idx;</span><br><span class="line">    dep[x] = dep[father] + <span class="number">1</span>;</span><br><span class="line">    sz[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (y == father) <span class="keyword">continue</span>;</span><br><span class="line">        mn[y] = min(mn[x], (ll)val[i]);</span><br><span class="line">        dfs1(y, x);</span><br><span class="line">        sz[x] += sz[y];</span><br><span class="line">        <span class="keyword">if</span> (sz[y] &gt; sz[son[x]]) son[x] = y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> top)</span> </span>&#123;</span><br><span class="line">    tp[x] = top;</span><br><span class="line">    <span class="keyword">if</span> (!son[x]) <span class="keyword">return</span>;</span><br><span class="line">    dfs2(son[x], top);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (y != fa[x] &amp;&amp; y != son[x]) dfs2(y, y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LCA</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (tp[x] != tp[y]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dep[tp[x]] &lt; dep[tp[y]]) swap(x, y);</span><br><span class="line">        x = fa[tp[x]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (dep[x] &gt; dep[y]) swap(x, y);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (top == <span class="number">1</span>) &#123; stk[++top] = x; <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="keyword">int</span> lca = LCA(x, stk[top]);</span><br><span class="line">    <span class="keyword">if</span> (lca == stk[top]) <span class="keyword">return</span>;  <span class="comment">// ç›´æ¥ return çš„åŸå› æ˜¯ ä¸€æ¡é“¾ä¸Šåªè¦å­˜é™¤æ ¹ç»“ç‚¹ä»¥å¤–æœ€ä¸Šé¢çš„é‚£ä¸ªç‚¹ï¼ï¼ï¼</span></span><br><span class="line">    <span class="keyword">while</span> (top &gt; <span class="number">1</span> &amp;&amp; dfn[stk[top - <span class="number">1</span>]] &gt;= dfn[lca])</span><br><span class="line">        addedge(stk[top - <span class="number">1</span>], stk[top]), --top;</span><br><span class="line">    <span class="keyword">if</span> (lca != stk[top])</span><br><span class="line">        addedge(lca, stk[top]), stk[top] = lca;</span><br><span class="line">    stk[++top] = x;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function">ll <span class="title">DP</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (v[x].size() == <span class="number">0</span>) <span class="keyword">return</span> mn[x];</span><br><span class="line">    ll sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; v[x].size(); i++)</span><br><span class="line">        sum += DP(v[x][i]);</span><br><span class="line">    v[x].clear();</span><br><span class="line">    <span class="keyword">return</span> min(mn[x], sum);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y, z; <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;x, &amp;y, &amp;z);</span><br><span class="line">        add(x, y, z), add(y, x, z);</span><br><span class="line">    &#125;</span><br><span class="line">    mn[<span class="number">1</span>] = (<span class="number">1l</span>l &lt;&lt; <span class="number">60</span>);</span><br><span class="line">    dfs1(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    dfs2(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; m;</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="keyword">int</span> k; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;k);</span><br><span class="line">        rep(i, <span class="number">1</span>, k) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">        sort(a + <span class="number">1</span>, a + k + <span class="number">1</span>, cmp);</span><br><span class="line">        stk[top = <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, k) insert(a[i]);</span><br><span class="line">        <span class="keyword">while</span> (top &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            addedge(stk[top - <span class="number">1</span>], stk[top]);</span><br><span class="line">            --top;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, DP(<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="HEOI2014-å¤§å·¥ç¨‹"><a href="#HEOI2014-å¤§å·¥ç¨‹" class="headerlink" title="[HEOI2014]-å¤§å·¥ç¨‹"></a>[HEOI2014]-å¤§å·¥ç¨‹</h3><hr><p><a href="https://www.lydsy.com/JudgeOnline/problem.php?id=3611" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>æ ‘å½¢DPã€‚ä¸€å¼€å§‹çš„æ€è·¯æ˜¯ æ±‚ä»£ä»· sigma(è¾¹abçš„val âœ–ï¸ aå­æ ‘ä¸­é€‰ä¸­èŠ‚ç‚¹æ•° âœ–ï¸ bå­æ ‘ä¸­é€‰ä¸­èŠ‚ç‚¹æ•°)ï¼Œè¿™æ ·åº”è¯¥ä¹Ÿå¯ä»¥ï¼Ÿã€‚çœ‹ hzwer æ±‚ä»£ä»·å’Œçš„æ–¹æ³•æ˜¯ä¸æ–­åˆå¹¶ï¼Œè®¾ f[x] è¡¨ç¤ºåœ¨éå† y å­æ ‘å‰éå†çš„é€‰ä¸­èŠ‚ç‚¹åˆ° x çš„è·ç¦»å’Œï¼Œåæ­£æä¸€æå°±å‡ºæ¥äº†ã€‚æœ€å¤§æœ€å°ä»£ä»·ä¹ŸæŒºå¥½æ±‚çš„ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bzoj_3611</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e6</span> + <span class="number">10</span>, inf = <span class="number">0x7fffffff</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, Q, idx, top;</span><br><span class="line">ll sz[N], son[N], fa[N], tp[N], id[N], dep[N];</span><br><span class="line">ll h[N], v[N], stk[N], siz[N], f[N], mn[N], mx[N];</span><br><span class="line"><span class="keyword">int</span> to[N &lt;&lt; <span class="number">1</span>], nxt[N &lt;&lt; <span class="number">1</span>], lnk[N], cnt;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[N], val[N];</span><br><span class="line">ll tot, ans1, ans2;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    to[++cnt] = y, nxt[cnt] = lnk[x], lnk[x] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fat)</span> </span>&#123;</span><br><span class="line">    sz[x] = <span class="number">1</span>;</span><br><span class="line">    fa[x] = fat;</span><br><span class="line">    dep[x] = dep[fat] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> mx = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (y == fat) <span class="keyword">continue</span>;</span><br><span class="line">        dfs1(y, x);</span><br><span class="line">        sz[x] += sz[y];</span><br><span class="line">        <span class="keyword">if</span> (mx &lt; sz[y])</span><br><span class="line">            mx = sz[y], son[x] = y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> rt)</span> </span>&#123;</span><br><span class="line">    id[x] = ++idx;</span><br><span class="line">    tp[x] = rt;</span><br><span class="line">    <span class="keyword">if</span> (son[x]) dfs2(son[x], rt);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (y != fa[x] &amp;&amp; y != son[x]) dfs2(y, y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123; <span class="keyword">return</span> id[a] &lt; id[b]; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    g[x].push_back(y);</span><br><span class="line">    val[x].push_back(dep[y] - dep[x]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LCA</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (tp[x] != tp[y]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dep[tp[x]] &lt; dep[tp[y]]) swap(x, y);</span><br><span class="line">        x = fa[tp[x]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (dep[x] &gt; dep[y]) swap(x, y);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> lca = LCA(x, stk[top]);</span><br><span class="line">    <span class="keyword">if</span> (lca == stk[top]) &#123; stk[++top] = x; <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="keyword">while</span> (top &gt; <span class="number">1</span> &amp;&amp; id[stk[top - <span class="number">1</span>]] &gt;= id[lca])</span><br><span class="line">        addedge(stk[top - <span class="number">1</span>], stk[top]), --top;</span><br><span class="line">    <span class="keyword">if</span> (lca != stk[top])</span><br><span class="line">        addedge(lca, stk[top]), stk[top] = lca;</span><br><span class="line">    stk[++top] = x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    f[x] = <span class="number">0</span>;</span><br><span class="line">    siz[x] = v[x];</span><br><span class="line">    mn[x] = v[x] ? <span class="number">0</span> : inf;</span><br><span class="line">    mx[x] = v[x] ? <span class="number">0</span> : -inf;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[x].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = g[x][i], z = val[x][i];</span><br><span class="line">        dfs(y);</span><br><span class="line">        tot += (f[x] + siz[x] * z) * siz[y] + f[y] * siz[x];</span><br><span class="line">        siz[x] += siz[y];</span><br><span class="line">        f[x] += f[y] + siz[y] * z;</span><br><span class="line">        ans1 = min(ans1, mn[x] + mn[y] + z);</span><br><span class="line">        ans2 = max(ans2, mx[x] + mx[y] + z);</span><br><span class="line">        mn[x] = min(mn[x], mn[y] + z);</span><br><span class="line">        mx[x] = max(mx[x], mx[y] + z);</span><br><span class="line">    &#125;</span><br><span class="line">    g[x].clear(), val[x].clear();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y;</span><br><span class="line">        add(x, y), add(y, x);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs1(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    dfs2(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; Q;</span><br><span class="line">    <span class="keyword">while</span> (Q--) &#123;</span><br><span class="line">        <span class="keyword">int</span> k; <span class="built_in">cin</span> &gt;&gt; k;</span><br><span class="line">        rep(i, <span class="number">1</span>, k) <span class="built_in">cin</span> &gt;&gt; h[i], v[h[i]] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (k == <span class="number">1</span>) &#123; <span class="built_in">puts</span>(<span class="string">"0 0 0"</span>); <span class="keyword">continue</span>; &#125;</span><br><span class="line">        sort(h + <span class="number">1</span>, h + k + <span class="number">1</span>, cmp);</span><br><span class="line">        top = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (!v[<span class="number">1</span>]) stk[++top] = <span class="number">1</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, k) insert(h[i]);</span><br><span class="line">        <span class="keyword">while</span> (top &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            addedge(stk[top - <span class="number">1</span>], stk[top]);</span><br><span class="line">            --top;</span><br><span class="line">        &#125;</span><br><span class="line">        tot = <span class="number">0</span>, ans1 = inf, ans2 = -inf;</span><br><span class="line">        dfs(<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld %lld %lld\n"</span>, tot, ans1, ans2);</span><br><span class="line">        rep(i, <span class="number">1</span>, k) v[h[i]] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="HNOI2014-ä¸–ç•Œæ ‘"><a href="#HNOI2014-ä¸–ç•Œæ ‘" class="headerlink" title="[HNOI2014]-ä¸–ç•Œæ ‘"></a>[HNOI2014]-ä¸–ç•Œæ ‘</h3><hr><p><a href="https://www.luogu.com.cn/problem/P3233" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p><a href="http://hzwer.com/6804.html" target="_blank" rel="noopener">hzwerå¤§ç¥å†™å¾—å¥½</a></p><p>çœŸçš„ï¼Œå¤ªéš¾è°ƒäº†orzã€‚ã€‚ã€‚ä¸¤é dfs æ±‚å‡ºæ¯ä¸ªè™šæ ‘ä¸Šçš„ç‚¹å¯¹åº”çš„ç®¡ç†ç‚¹ï¼Œè™šæ ‘ä¸Šæ¯æ¡è¾¹ ab å¯¹åº”åœ¨æ ‘ä¸Šçš„åŒºåŸŸæ¶µç›–çš„ç‚¹ï¼Œå®ƒä»¬çš„ç®¡ç†ç‚¹ä¸æ˜¯ a çš„ç®¡ç†ç‚¹å°±æ˜¯ b çš„ç®¡ç†ç‚¹ã€‚ç¡®å®šèŒƒå›´ï¼Œå…¶å®å¯ä»¥å€å¢è·³åˆ° ab çš„ä¸­ç‚¹ã€‚size çš„åŠ åŠ å‡å‡è¦æ³¨æ„ï¼Œå¾ˆå®¹æ˜“å‡ºé”™ à²¥_à²¥</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, a[N], Q, k, m[N], b[N];</span><br><span class="line"><span class="keyword">int</span> to[N &lt;&lt; <span class="number">1</span>], nxt[N &lt;&lt; <span class="number">1</span>], lnk[N], cnt;</span><br><span class="line"><span class="keyword">int</span> f[N][<span class="number">22</span>], dfn[N], idx, dep[N], sz[N];</span><br><span class="line"><span class="keyword">int</span> stk[N], top, q[N], id, ans[N], bel[N], siz[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    to[++cnt] = y, nxt[cnt] = lnk[x], lnk[x] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123; <span class="keyword">return</span> dfn[a] &lt; dfn[b]; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    dfn[x] = ++idx;</span><br><span class="line">    dep[x] = dep[fa] + <span class="number">1</span>;</span><br><span class="line">    sz[x] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, <span class="number">19</span>)</span><br><span class="line">        f[x][i] = f[f[x][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (y == fa) <span class="keyword">continue</span>;</span><br><span class="line">        f[y][<span class="number">0</span>] = x;</span><br><span class="line">        dfs(y, x);</span><br><span class="line">        sz[x] += sz[y];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LCA</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (dep[x] &lt; dep[y]) swap(x, y);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">19</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">if</span> (dep[f[x][i]] &gt;= dep[y]) x = f[x][i];</span><br><span class="line">    <span class="keyword">if</span> (x == y) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">19</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">if</span> (f[x][i] != f[y][i]) x = f[x][i], y = f[y][i];</span><br><span class="line">    <span class="keyword">return</span> f[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dis</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> dep[x] + dep[y] - <span class="number">2</span> * dep[LCA(x, y)];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = b, mid = b;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">19</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">if</span> (dep[f[x][i]] &gt; dep[a]) x = f[x][i];</span><br><span class="line">    siz[a] -= sz[x];</span><br><span class="line">    <span class="keyword">if</span> (bel[a] == bel[b]) &#123; ans[bel[a]] += sz[x] - sz[b]; <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">19</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">int</span> tmp = f[mid][i];</span><br><span class="line">        <span class="keyword">if</span> (dep[tmp] &lt;= dep[a]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">int</span> t1 = dis(bel[a], tmp), t2 = dis(bel[b], tmp);</span><br><span class="line">        <span class="keyword">if</span> (t1 &gt; t2 || (t1 == t2 &amp;&amp; bel[b] &lt; bel[a])) mid = tmp;</span><br><span class="line">    &#125;</span><br><span class="line">    ans[bel[a]] += sz[x] - sz[mid];</span><br><span class="line">    ans[bel[b]] += sz[mid] - sz[b];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    q[++id] = x;</span><br><span class="line">    siz[x] = sz[x];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        dfs1(y);</span><br><span class="line">        <span class="keyword">if</span> (!bel[y]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">int</span> t1 = dis(bel[y], x), t2 = dis(bel[x], x);</span><br><span class="line">        <span class="keyword">if</span> ((t1 == t2 &amp;&amp; bel[y] &lt; bel[x]) || t1 &lt; t2 || !bel[x])</span><br><span class="line">            bel[x] = bel[y];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">int</span> t1 = dis(bel[x], y), t2 = dis(bel[y], y);</span><br><span class="line">        <span class="keyword">if</span> ((t1 == t2 &amp;&amp; bel[y] &gt; bel[x]) || t1 &lt; t2 || !bel[y])</span><br><span class="line">            bel[y] = bel[x];</span><br><span class="line">        dfs2(y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    sort(m + <span class="number">1</span>, m + k + <span class="number">1</span>, cmp);</span><br><span class="line">    <span class="keyword">if</span> (bel[<span class="number">1</span>] != <span class="number">1</span>) stk[++top] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, k) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = m[i], lca = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (!top) &#123; stk[++top] = x; <span class="keyword">continue</span>; &#125;</span><br><span class="line">        lca = LCA(stk[top], x);</span><br><span class="line">        <span class="keyword">if</span> (lca == stk[top]) &#123; stk[++top] = x; <span class="keyword">continue</span>; &#125;</span><br><span class="line">        <span class="keyword">while</span> (top &gt; <span class="number">1</span> &amp;&amp; dfn[stk[top - <span class="number">1</span>]] &gt;= dfn[lca]) &#123;</span><br><span class="line">            add(stk[top - <span class="number">1</span>], stk[top]); top--;  <span class="comment">// ä¸èƒ½å†™ stk[top--], ä¸ç„¶ä¼š WAã€‚ã€‚ã€‚ä¸çŸ¥é“ä¸ºå•¥</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (lca != stk[top]) &#123;</span><br><span class="line">            add(lca, stk[top]); stk[top] = lca;</span><br><span class="line">        &#125;</span><br><span class="line">        stk[++top] = x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (top &gt; <span class="number">1</span>) add(stk[top - <span class="number">1</span>], stk[top]), top--;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        add(x, y), add(y, x);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">memset</span>(lnk, <span class="number">0</span>, <span class="keyword">sizeof</span>(lnk));</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; Q;</span><br><span class="line">    <span class="keyword">while</span> (Q--) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; k;</span><br><span class="line">        top = id = cnt = <span class="number">0</span>;</span><br><span class="line">        rep(i, <span class="number">1</span>, k) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m[i]), b[i] = m[i], bel[m[i]] = m[i];</span><br><span class="line">        build();</span><br><span class="line"></span><br><span class="line">        dfs1(<span class="number">1</span>), dfs2(<span class="number">1</span>);</span><br><span class="line">        rep(o, <span class="number">1</span>, id)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[q[o]]; i; i = nxt[i])</span><br><span class="line">                solve(q[o], to[i]);</span><br><span class="line"></span><br><span class="line">        rep(i, <span class="number">1</span>, id)</span><br><span class="line">            ans[bel[q[i]]] += siz[q[i]];</span><br><span class="line"></span><br><span class="line">        rep(i, <span class="number">1</span>, k) <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans[b[i]]); <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">        rep(i, <span class="number">1</span>, id)</span><br><span class="line">            ans[q[i]] = bel[q[i]] = siz[q[i]] = lnk[q[i]] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> è™šæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[AT2149]-Snuke&#39;s Coloring 2</title>
      <link href="2020/01/13/%5BAT2149%5D-Snuke&#39;s%20Coloring%202/"/>
      <url>2020/01/13/%5BAT2149%5D-Snuke&#39;s%20Coloring%202/</url>
      
        <content type="html"><![CDATA[<p>ARC çš„ D å•Šè¿™æ˜¯ï¼ï¼ï¼æ¯’ç˜¤ qwqã€‚ã€‚ä¸è¿‡æŒºæœ‰æ„æ€çš„</p><p><a href="https://vjudge.net/problem/AtCoder-2149" target="_blank" rel="noopener">ä¼ é€é—¨ï¼é£</a></p><p><a href="https://www.cnblogs.com/coco-night/p/9677691.html" target="_blank" rel="noopener">è¿™ä½dalaoè¯´å¾—å¥½ï¼Œæˆ‘è‹¥è®²ä¸æ¸…æ¥šå¯çœ‹taçš„ï¼</a></p><p>é¦–å…ˆï¼Œä¸€åˆ‡çš„ä¸€åˆ‡ä¹‹å‰ï¼è¦å…ˆå…¬å¸ƒä¸€ä¸ªæ€§è´¨ã€‚ã€‚ï¼ˆä»€ä¹ˆæ—¶å€™æ‰èƒ½è‡ªå·±æ‰¾å•Šqwqï¼‰ï¼Œå°±æ˜¯è¿™ä¸ªçŸ©å½¢å‘¨é•¿ä¸€å®šå¤§äºç­‰äº $2 * max(w, h) + 2$, é‚£ä¹ˆè¿™ä¸ªçŸ©å½¢<strong>ä¸€å®š</strong>è¿‡ $x = \frac{w}{2}$ æˆ– $y = \frac{h}{2}$ ä¸­çš„ä¸€æ¡ï¼Œæ¥ä¸‹æ¥ä»¥åè€…ä¸ºä¾‹ã€‚ï¼ˆåˆ«å¿˜è®°åšå®Œåå°†å›¾ç¿»è½¬å†åšä¸€æ¬¡å‰è€…ï¼‰</p><p>æœ‰äº†<strong>è¿‡ä¸­çº¿</strong>çš„ä¿è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠç‚¹åˆ†æˆä¸­çº¿ä¸Šä¸‹ä¸¤éƒ¨åˆ†å¤„ç†ã€‚</p><p>æ‰¾ï¼å®šï¼é‡ï¼è¿™ä¸ªå®šé‡å°±æ˜¯ä¸€æ¡ç«–ç€çš„æ‰«æçº¿ï¼Œèº«ä»½æ˜¯çŸ©å½¢çš„å³è¾¹ç•Œã€‚ã€‚$O(n ^ 2)$çš„æœ´ç´ ç®—æ³•å°±æ˜¯ä»å³è¾¹ç•Œå¾€å·¦æ‰«ï¼Œå•è°ƒæ ˆç»´æŠ¤<strong>æœ€</strong>å€¼ã€‚è€ƒè™‘å¦‚ä½•ä¼˜åŒ–ã€‚</p><p>ç”¨çº¿æ®µæ ‘<strong>å¸®åŠ©</strong>ç»´æŠ¤æ‰«æçº¿å·¦è¾¹ï¼ˆå³æ‰«è¿‡åŒºåŸŸï¼‰æ¯ä¸ªç‚¹æ‰€åœ¨ç›´çº¿ä¸ºå·¦è¾¹ç•Œæ—¶çš„æœ€å¤§çŸ©å½¢å‘¨é•¿ï¼ŒåŠ åŠ å‡å‡å…·ä½“å¯çœ‹ dalao åšå®¢é“¾æ¥ï¼Œå…¶æ ¸å¿ƒå°±æ˜¯çº¿æ®µçš„å’Œå·®ã€‚ã€‚æ˜¾ç„¶æ˜¯å¯ä»¥ç»´æŠ¤çš„ï¼ï¼</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (long long i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> x first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> y second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">int</span> w, h, n, ans;</span><br><span class="line"><span class="keyword">int</span> tag[N &lt;&lt; <span class="number">2</span>], mx[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line">pii p[N], a[N], b[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">psd</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (tag[x]) &#123;</span><br><span class="line">        tag[x &lt;&lt; <span class="number">1</span>] += tag[x];</span><br><span class="line">        tag[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] += tag[x];</span><br><span class="line">        mx[x &lt;&lt; <span class="number">1</span>] += tag[x];</span><br><span class="line">        mx[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] += tag[x];</span><br><span class="line">        tag[x] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> lx, <span class="keyword">int</span> rx, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (rx &lt; l || r &lt; lx) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span> (lx &lt;= l &amp;&amp; r &lt;= rx) &#123;</span><br><span class="line">        tag[x] += val, mx[x] += val; <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    psd(x);</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    update(x &lt;&lt; <span class="number">1</span>, l, mid, lx, rx, val);</span><br><span class="line">    update(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, lx, rx, val);</span><br><span class="line">    mx[x] = max(mx[x &lt;&lt; <span class="number">1</span>], mx[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(mx, <span class="number">0</span>, <span class="keyword">sizeof</span>(mx));</span><br><span class="line">    <span class="built_in">memset</span>(tag, <span class="number">0</span>, <span class="keyword">sizeof</span>(tag));</span><br><span class="line"></span><br><span class="line">    sort(p + <span class="number">1</span>, p + n + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>, r = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p[i].y &lt;= h / <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> nxt = i - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (l &amp;&amp; p[i].y &gt; a[l].y) &#123;</span><br><span class="line">                update(<span class="number">1</span>, <span class="number">1</span>, n, a[l].x, nxt, a[l].y - p[i].y);</span><br><span class="line">                nxt = a[l].x - <span class="number">1</span>;</span><br><span class="line">                --l;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (nxt != i - <span class="number">1</span>) a[++l] = make_pair(nxt + <span class="number">1</span>, p[i].y);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> nxt = i - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (r &amp;&amp; p[i].y &lt; b[r].y) &#123;</span><br><span class="line">                update(<span class="number">1</span>, <span class="number">1</span>, n, b[r].x, nxt, p[i].y - b[r].y);</span><br><span class="line">                nxt = b[r].x - <span class="number">1</span>;</span><br><span class="line">                --r;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (nxt != i - <span class="number">1</span>) b[++r] = make_pair(nxt + <span class="number">1</span>, p[i].y);</span><br><span class="line">        &#125;</span><br><span class="line">        a[++l] = make_pair(i, <span class="number">0</span>);</span><br><span class="line">        b[++r] = make_pair(i, h);</span><br><span class="line">        update(<span class="number">1</span>, <span class="number">1</span>, n, i, i, h - p[i].x);</span><br><span class="line">        ans = max(ans, p[i + <span class="number">1</span>].x + mx[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; w &gt;&gt; h &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;p[i].x, &amp;p[i].y);</span><br><span class="line">    p[++n] = make_pair(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    p[++n] = make_pair(w, h);</span><br><span class="line"></span><br><span class="line">    solve();</span><br><span class="line"></span><br><span class="line">    rep(i, <span class="number">1</span>, n) swap(p[i].x, p[i].y);  <span class="comment">// ç¿»è½¬</span></span><br><span class="line">    swap(w, h);</span><br><span class="line">    solve();</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘å‘ç°åšé¢˜æ‰¾å®šé‡æ˜¯éå¸¸é‡è¦çš„ï¼æœ¬é¢˜çš„ç²¾é«“å°±åœ¨äºæ‰¾å®šé‡ã€‚ä¸Šæ¬¡ usaco 12æœˆæœˆèµ› T1 ä¹Ÿæ˜¯æ‰¾å®šé‡ï¼Œè¿™ä¸ªçœŸçš„å¾ˆæœ‰ç”¨å“‡ï¼</p><p>ï¼ˆä¸€ä¸Šæ¥çœ‹åˆ°çŸ©å½¢è‚¯å®šå¤´éƒ½å¤§å•¦ï¼Œå“ªçŸ¥é“å®šé‡æ˜¯å•¥å•Šã€‚ã€‚</p><p>åæ­£è¿™é¢˜ <strong>æ€§è´¨</strong> å’Œ <strong>å®šé‡æ€æƒ³</strong> ç¼ºä¸€ä¸å¯å•Šã€‚ã€‚ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
            <tag> å•è°ƒæ ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Usaco19Dec (Gold)</title>
      <link href="2019/12/21/Usaco19Dec%20(Gold)/"/>
      <url>2019/12/21/Usaco19Dec%20(Gold)/</url>
      
        <content type="html"><![CDATA[<p><a href="http://www.usaco.org/index.php?page=dec19results" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>Usaco Gold round ç¬¬ä¸€æ¬¡ï¼ï¼åšå‡ºäº† T1ï¼Œä¸ªäººæ„Ÿè§‰ usaco é¢˜ç›®è´¨é‡ååˆ†çš„é«˜å•Š~ éƒ½ä¸æ˜¯æ¯’ç˜¤é¢˜ï¼Œä½†æœ¬äººè¿‡äºèœé¸¡äº† qaq</p><h3 id="A-Milk-Pumping"><a href="#A-Milk-Pumping" class="headerlink" title="A. Milk Pumping"></a>A. Milk Pumping</h3><hr><p>ä¸€å¥è¯é¢˜è§£ï¼šæœ€çŸ­è·¯å˜å½¢ã€‚</p><p>ä»¥å‰å¥½åƒåšè¿‡ç±»ä¼¼çš„ã€‚åªè¦æŒ‰ç…§è¾¹çš„æµé‡ä»å¤§åˆ°å°æ’åºï¼Œä¸€ä¸€åŠ è¾¹ï¼Œæ¯åŠ ä¸€æ¬¡è·‘ä¸€éæœ€çŸ­è·¯å³å¯ï¼</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e3</span> + <span class="number">10</span>, inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, dis[N], inq[N], ansx, ansy;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span> <span class="keyword">int</span> x, y, c, f; &#125;e[N];</span><br><span class="line">ll cur;</span><br><span class="line"><span class="built_in">vector</span>&lt;edge&gt; nxt[N];</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(edge a, edge b)</span> </span>&#123; <span class="keyword">return</span> a.f &gt; b.f; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spfa</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) dis[i] = inf;</span><br><span class="line">    dis[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    q.push(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.front(); q.pop(); inq[x] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nxt[x].size(); i++) &#123;</span><br><span class="line">            edge now = nxt[x][i];</span><br><span class="line">            <span class="keyword">if</span> (dis[now.y] &gt; dis[x] + now.c) &#123;</span><br><span class="line">                dis[now.y] = dis[x] + now.c;</span><br><span class="line">                <span class="keyword">if</span> (!inq[now.y]) inq[now.y] = <span class="number">1</span>, q.push(now.y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    freopen(<span class="string">"pump.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    freopen(<span class="string">"pump.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, m)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;e[i].x, &amp;e[i].y, &amp;e[i].c, &amp;e[i].f);</span><br><span class="line">    sort(e + <span class="number">1</span>, e + m + <span class="number">1</span>, cmp);</span><br><span class="line"></span><br><span class="line">    cur = <span class="number">-1e18</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        nxt[e[i].x].push_back(e[i]);</span><br><span class="line">        swap(e[i].x, e[i].y);</span><br><span class="line">        nxt[e[i].x].push_back(e[i]);</span><br><span class="line">        spfa();</span><br><span class="line">        <span class="keyword">if</span> (dis[n] != inf)</span><br><span class="line">            cur = max(cur, (<span class="number">1l</span>l * <span class="number">1000000</span> * e[i].f / dis[n]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, cur);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-Milk-Visits"><a href="#B-Milk-Visits" class="headerlink" title="B. Milk Visits"></a>B. Milk Visits</h3><hr><p>å¾ˆå¦™çš„é¢˜ï¼é¦–å…ˆæŠŠè¯¢é—®ç¦»çº¿ã€‚å¯¹äº (x, y, c) è¿™ç»„è¯¢é—®ï¼ˆè®¾ lca(x, y) = Lï¼‰æ˜¾ç„¶å¯ä»¥åˆ†è§£ä¸º x ~ L è¿™æ®µå’Œ y ~ L è¿™æ®µã€‚</p><p>dfsã€‚ç”¨æ ˆ (å®é™…æ“ä½œå¯ç”¨vector) å‚¨å­˜ç»è¿‡çš„ç‚¹çš„é¢œè‰²å’Œç‚¹çš„ä½ç½®ï¼ˆå®é™…æ“ä½œå‚¨å­˜æ·±åº¦ï¼‰ï¼Œåˆ°è¾¾ç‚¹ x æ—¶çœ‹çœ‹æ ˆä¸­æ˜¯å¦æœ‰ c é¢œè‰²çš„ï¼Œä»¥åŠç¦» x æœ€è¿‘çš„ï¼ˆæ·±åº¦æœ€å¤§çš„ï¼‰ç‚¹æ˜¯ä¸æ˜¯ L çš„ç¥–å…ˆï¼Œå¦‚æœä¸æ˜¯ï¼Œ(x, y, c) è¿™ä¸ªè¯¢é—®çš„ç­”æ¡ˆå°±æ˜¯ 1.</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, col[N], id[N][<span class="number">2</span>], c[N], cur, ok[N];</span><br><span class="line">pii range[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;pii&gt; stor[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; todo[N], v[N], ord;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pre</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    range[x].fi = ++cur;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; v[x].size(); i++)</span><br><span class="line">        <span class="keyword">if</span> (v[x][i] != fa) pre(v[x][i], x);</span><br><span class="line">    range[x].se = cur;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">anc</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;  <span class="comment">// is_ancestor ?</span></span><br><span class="line">    <span class="keyword">return</span> (range[x].fi &lt;= range[y].fi &amp;&amp; range[y].se &lt;= range[x].se);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    stor[col[x]].push_back(make_pair(x, ord.size()));</span><br><span class="line">    ord.push_back(x);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> o = <span class="number">0</span>; o &lt; todo[x].size(); o++) &#123;</span><br><span class="line">        <span class="keyword">int</span> i = todo[x][o];</span><br><span class="line">        <span class="keyword">if</span> (stor[c[i]].size()) &#123;</span><br><span class="line">            pii y = stor[c[i]].back();</span><br><span class="line">            <span class="keyword">if</span> (y.fi == x) ok[i] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> son = ord[y.se + <span class="number">1</span>];  <span class="comment">// ä¸‹ä¸€ä¸ª (æƒ³æƒ³ä¸ºä»€ä¹ˆ)</span></span><br><span class="line">    <span class="comment">// x is one of endpoints for query t</span></span><br><span class="line">                <span class="keyword">if</span> (!anc(son, id[i][<span class="number">0</span>] + id[i][<span class="number">1</span>] - x)) ok[i] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; v[x].size(); i++)</span><br><span class="line">        <span class="keyword">if</span> (v[x][i] != fa) dfs(v[x][i], x);</span><br><span class="line">    stor[col[x]].pop_back();</span><br><span class="line">    ord.pop_back();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    freopen(<span class="string">"milkvisits.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    freopen(<span class="string">"milkvisits.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;col[i]);</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        v[x].push_back(y), v[y].push_back(x);</span><br><span class="line">    &#125;</span><br><span class="line">    pre(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;id[i][<span class="number">0</span>], &amp;id[i][<span class="number">1</span>], &amp;c[i]);</span><br><span class="line">        rep(j, <span class="number">0</span>, <span class="number">1</span>) todo[id[i][j]].push_back(i);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, m) <span class="built_in">printf</span>(<span class="string">"%d"</span>, ok[i] ? <span class="number">1</span> : <span class="number">0</span>); <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-Moortal-Cowmbat"><a href="#C-Moortal-Cowmbat" class="headerlink" title="C. Moortal Cowmbat"></a>C. Moortal Cowmbat</h3><hr><p>DP å¤§æ³•å¥½â€¦.</p><p>DP è¿˜æ˜¯å¼±å•Šã€‚ã€‚å…¶å®ä¸æ˜¯å¾ˆéš¾</p><p>é¦–å…ˆè·‘ä¸€é Floydï¼ã€‚è®¾ f[i] è¡¨ç¤ºå‰ i ä¸ªåˆæ³•çš„æœ€å°å€¼ã€‚</p><p>f[i] = min(f[j] + calc(j + 1, i, c)) (j &lt;= i - k)ï¼Œå…¶ä¸­ calc(l, r, c) è¡¨ç¤ºåŒºé—´ [l, r] å…¨å˜ä¸º c çš„ä»·å€¼å’Œã€‚</p><p>å‘ç°æ¯æ¬¡åªåŠ è¿›å» i - k çš„è´¡çŒ®ã€‚ç”¨ mn[j] æ•°ç»„ç»´æŠ¤å½“å‰å– j é¢œè‰²ä¸”åˆæ³•çš„æœ€å°å€¼ï¼ŒO(1)ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, K;</span><br><span class="line"><span class="keyword">int</span> c[<span class="number">30</span>][<span class="number">30</span>], cost[N][<span class="number">30</span>], mn[N], f[N];</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> c)</span> </span>&#123; <span class="keyword">return</span> cost[r][c] - cost[l - <span class="number">1</span>][c]; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    freopen(<span class="string">"cowmbat.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    freopen(<span class="string">"cowmbat.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; K;</span><br><span class="line">    --m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">0</span>, m)</span><br><span class="line">        rep(j, <span class="number">0</span>, m)</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; c[i][j];</span><br><span class="line">    rep(k, <span class="number">0</span>, m)</span><br><span class="line">        rep(i, <span class="number">0</span>, m)</span><br><span class="line">            rep(j, <span class="number">0</span>, m)</span><br><span class="line">                c[i][j] = min(c[i][j], c[i][k] + c[k][j]);</span><br><span class="line">    rep(i, <span class="number">0</span>, m)</span><br><span class="line">        rep(j, <span class="number">1</span>, n)</span><br><span class="line">            cost[j][i] = cost[j - <span class="number">1</span>][i] + c[s[j] - <span class="string">'a'</span>][i];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(mn, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(mn));</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    rep(i, K, n)</span><br><span class="line">        rep(j, <span class="number">0</span>, m) &#123;</span><br><span class="line">            mn[j] = min(mn[j] + c[s[i] - <span class="string">'a'</span>][j], f[i - K] + calc(i - K + <span class="number">1</span>, i, j));  <span class="comment">// mn[j] è¡¨ç¤ºå½“å‰ i ä½ç½®ä¸º j æ—¶çš„æœ€å°èŠ±è´¹</span></span><br><span class="line">            f[i] = min(f[i], mn[j]);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, f[n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦å¤šæ‰“æ¯”èµ›ï¼ç­‰è€ƒå®Œ çœ‹æˆ‘ä¸å± å®ƒä¸ªç™¾æ¥é“é¢˜ (â™¯ï½€âˆ§Â´) å“¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSP2019å‰çš„åšé¢˜è®°å½• &amp; æ¯æ—¥å°ç»“</title>
      <link href="2019/11/16/CSP2019%E5%89%8D%E7%9A%84%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95&amp;%E6%AF%8F%E6%97%A5%E5%B0%8F%E7%BB%93/"/>
      <url>2019/11/16/CSP2019%E5%89%8D%E7%9A%84%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95&amp;%E6%AF%8F%E6%97%A5%E5%B0%8F%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p>è¿™é‡Œæ˜¯ CSP2019 å‰çš„åšé¢˜è®°å½• &amp; æ¯æ—¥å°ç»“ï¼</p><p>æ¯å¤©è®¡åˆ’å¦‚ä¸‹ï¼š</p><ol start="0"><li>è®¢æ­£monisaiï¼</li><li>ATCä¸€å¥—ï¼ˆ2 ~ 3é“ï¼‰</li><li>éšå³å¼€é¢˜ &gt;= 3 é“</li><li>ç®—æ³•é’ˆå¯¹ &gt;= 3 é“</li><li>åšå®¢æ€»ç»“</li><li>åšå®¢å›é¡¾ &gt;= 10 ç¯‡</li><li>åæœŸå®‰æ’ NOIp çœŸé¢˜ä½“éªŒ</li></ol><p>æ—¥æ‹±ä¸€å’æ— æœ‰å°½ï¼ŒåŠŸä¸å”æç»ˆå…¥æµ·ï¼åŠ æ²¹åŠ æ²¹~</p><hr><hr><hr><h3 id="10-29"><a href="#10-29" class="headerlink" title="10.29"></a>10.29</h3><ul><li>âš ï¸monisai T2 æ¨¡æ•°æœ‰ä¸€é‡æ²¡åŠ ï¼Œå…¨waä¸¢40+ã€‚ã€‚</li></ul><p>luogu3586, agc037C, abc144D+E+F, bzoj1016</p><h3 id="10-30"><a href="#10-30" class="headerlink" title="10.30"></a>10.30</h3><ul><li>âš ï¸monisai T1 æ— å‘è¾¹å»ºæˆæœ‰å‘çš„äº†å‡‰å‡‰ã€‚ã€‚ï¼ˆå¥‡æ€ªï¼Œä»¥å‰ä»æ¥ä¸çŠ¯çš„é”™è¯¯å•Š o(â•¥ï¹â•¥)o</li></ul><p>luogu3317, luogu1131, luogu1879</p><h3 id="10-31"><a href="#10-31" class="headerlink" title="10.31"></a>10.31</h3><p>abc137E, bzoj4805, bzoj2005, bzoj2671, luogu2219, luogu2569, luogu2709</p><h3 id="11-1"><a href="#11-1" class="headerlink" title="11.1"></a>11.1</h3><ul><li>âš ï¸ç”¨ç€å¯ä»¥ O(n^2 + Q) çš„éƒ¨åˆ†åˆ†å†™æ³•ï¼Œå†™äº† O(n^2 + Qn) çš„ã€‚ã€‚è™½ç„¶ä¹Ÿä¸ä¼šå¤ªå‡‰ï¼Œä½†æ˜¯æ­£å¼æ¯”èµ›ä¸€å®šè¦å°å¿ƒå•Šï¼ï¼ˆåˆ«æƒ³å‡ºæ­£è§£å†™äº†æš´åŠ›å°±æ˜¯äº†qwq</li></ul><p>luogu3172, luogu3830, luogu2613, bzoj1531</p><h3 id="11-2"><a href="#11-2" class="headerlink" title="11.2"></a>11.2</h3><ul><li>ä»Šæ—¥ä»½å¿«ä¹ï¼šmonisaiçƒ¤äº†10.17æ—¥çš„æ¨¡æ‹Ÿèµ›T3ï¼Œç„¶é¹…æˆ‘å¹¶æ²¡è®¢æ­£è¿‡è¿™é“æ¸…çœŸçš„æ–œç‡ä¼˜åŒ–ã€‚ã€‚ç„¶åæˆ‘è°ƒå‡ºæ¥äº†ï¼Œè€¶ã€‚</li><li>å½¢å¦‚ a = b çš„ä¸œè¥¿å¯ä»¥åŒ–æˆ a - b = 0, ä¹Ÿè®¸å¯ä»¥ç”¨æ•°æ®ç»“æ„ç»´æŠ¤å‘¢ã€‚</li><li>âš ï¸monisai T1 çŸ©é˜µåŠ é€Ÿä¸¢ 30 ptsï¼ŒåŸæ¥æ˜¯ ll ç±»å‹çš„ n è¢«æˆ‘ç”¨ %d è¾“å…¥äº†ã€‚ã€‚ã€‚æ£€æŸ¥ long long ğŸˆ¶ï¸ğŸˆšï¸å¼€ä¸åªæ˜¯æ£€æŸ¥å®šä¹‰å¤„ï¼Œè¿˜æœ‰è¾“å…¥è¾“å‡ºå¤„å“‡ã€‚ã€‚ã€‚ä¸¤ä¸ªå­—æ¯ä¸‰ååˆ† o(â•¥ï¹â•¥)o è¶…è´µ</li></ul><p>luogu2915, luogu2150</p><h3 id="11-3"><a href="#11-3" class="headerlink" title="11.3"></a>11.3</h3><ul><li>ä»Šæ—¥ä»½å¿«ä¹ï¼šåœ¨å®¶ä¼‘æ¯å“¦ï¼è¡¥è§‰å•¦ã€å¿«å¿«ä¹ä¹ã€‘ç„¶åå¤ä¹ äº†dpï¼</li></ul><p>bzoj1037, bzoj1042, bzoj1084, bzoj2431, bzoj1190</p><h3 id="11-4"><a href="#11-4" class="headerlink" title="11.4"></a>11.4</h3><ul><li>ä»Šå¤©æ—©ä¸ŠéŸ³ä¹æŠ½åˆ°æˆ‘äº†ï¼Œï¼Œäºæ˜¯å°±æ²¡æœ‰å»è®­ç»ƒï¼Œåœ¨å®¶ vp äº† CF round 597 (Div2)</li></ul><p>bzoj1833</p><h3 id="11-5"><a href="#11-5" class="headerlink" title="11.5"></a>11.5</h3><ul><li>âš ï¸ä»Šï¼å¤©ï¼åˆï¼çˆ†ï¼intï¼äº†ï¼ä¸‹æ¬¡ç”¨ <code>#define ing long long</code> å§</li><li>T2 å¯ä»¥ AC çš„ã€‚ã€‚vector å®šä¹‰æˆ int ç±»å‹äº†ï¼Œçˆ†äº†ï¼Œä»€ä¹ˆéƒ½ä¸æƒ³è¯´äº†ï¼ŒT2 æ²¡æœ‰äº†è¿˜æ´»ä¸ªä»€ä¹ˆåŠ²å•Š</li><li>ä»¥ä¸‹æ˜¯ä¸€äº›ç‰¢éªšï¼šè¯¶ä¸ºä»€ä¹ˆäººå®¶ fst éƒ½æ˜¯å° f å•Šï¼Œå°±æˆ‘æ˜¯å¤§ f ï¼Ÿä¸€æ¬¡ f 100 çš„é‚£ç§ï¼Ÿæ°´é€†ç‰¹åˆ«çœ·é¡¾æˆ‘å— qaqâ€¦ è¦ä¹ˆè„‘å­å°‘ä¸€å—äº†ğŸ§ </li></ul><p>cf997e, bzoj3209, luogu4999</p><h3 id="11-6"><a href="#11-6" class="headerlink" title="11.6"></a>11.6</h3><p>å¯¹äºäºŒåˆ†å›¾ï¼š</p><ul><li>æœ€å°ç‚¹è¦†ç›– = æœ€å¤§åŒ¹é…</li><li>æœ€å¤§ç‹¬ç«‹é›† = æœ€å°è¾¹è¦†ç›– = é¡¶ç‚¹æ•° - æœ€å°ç‚¹è¦†ç›–ï¼ˆæœ€å¤§åŒ¹é…ï¼‰</li></ul><p>å¯¹äºDAGï¼š</p><ul><li>æœ€å°ä¸ç›¸äº¤è·¯å¾„è¦†ç›– = åŸå›¾é¡¶ç‚¹æ•° - è½¬ä¸ºäºŒåˆ†å›¾åçš„æœ€å¤§åŒ¹é…æ•°</li><li>æœ€å°å¯ç›¸äº¤è·¯å¾„è¦†ç›– è½¬åŒ–è½¬åŒ–èƒ½å˜æˆä¸Šé¢é‚£ä¸ªã€‚è½¬åŒ–æ–¹æ³•ï¼šç”¨ floyd æ±‚å‡ºåŸå›¾ä¼ é€’é—­åŒ…ï¼Œå¦‚æœ a åˆ° b æœ‰è·¯å¾„ï¼Œå°±åŠ è¾¹ a-&gt; b, å°±è¡Œäº†ã€‚ï¼ˆè¿™æ ·å°±ä¸ç”¨ç»è¿‡ä¸­é—´ç‚¹äº†ï¼Œå¦‚æœç»è¿‡ä¸­é—´ç‚¹æœ‰å¯èƒ½ä¼šä¸å…¶å®ƒè·¯å¾„ç›¸äº¤ã€‚ï¼‰</li></ul><p>æ¦‚å¿µï¼š</p><ul><li>æœ€å¤§åŒ¹é…ï¼šäºŒåˆ†å›¾ä¸­è¾¹é›†çš„æ•°ç›®æœ€å¤§çš„é‚£ä¸ªåŒ¹é…ï¼›</li><li>æœ€å°ç‚¹è¦†ç›–ï¼šç”¨æœ€å°‘çš„ç‚¹ï¼Œè®©æ¯æ¡è¾¹éƒ½è‡³å°‘å’Œå…¶ä¸­ä¸€ä¸ªç‚¹å…³è”ï¼›</li><li>æœ€å°è¾¹è¦†ç›–ï¼šç”¨å°½é‡å°‘çš„ä¸ç›¸äº¤ç®€å•è·¯å¾„è¦†ç›–æœ‰å‘æ— ç¯å›¾(DAG)Gçš„æ‰€æœ‰é¡¶ç‚¹ï¼›</li><li>æœ€å¤§ç‹¬ç«‹é›†ï¼šåœ¨ï¼®ä¸ªç‚¹çš„å›¾Gä¸­é€‰å‡ºmä¸ªç‚¹ï¼Œä½¿è¿™mä¸ªç‚¹ä¸¤ä¸¤ä¹‹é—´æ²¡æœ‰è¾¹çš„ç‚¹ä¸­ï¼Œmçš„æœ€å¤§å€¼ã€‚</li></ul><p>bzoj1082, bzoj1179</p><h3 id="11-7"><a href="#11-7" class="headerlink" title="11.7"></a>11.7</h3><p>bzoj1143, bzoj3175, bzoj2783, bzoj3190</p><h3 id="11-8"><a href="#11-8" class="headerlink" title="11.8"></a>11.8</h3><ul><li>âš ï¸ç»™ trick å‘äº†ï¼ï¼ˆè¿™ç®— trick å—ï¼‰ï¼šå¯¹äºæ¯ä¸ªè´¨å› æ•° pï¼Œå°†æ‰€æœ‰èƒ½è¢«å®ƒåˆ†è§£çš„ a[i] æåˆ° vector é‡Œã€‚è¿™æ ·å¤„ç†æ¯ä¸ª p å°±åªä¼šç”¨åˆ° vector é‡Œçš„ a[i] äº†ã€‚æ¯ä¸ª a[i] æœ€å¤šè¢«æ sqrt(a[i]) æ¬¡ï¼ˆå…¶å®è¿œè¿œè¾¾ä¸åˆ°ï¼‰ï¼Œå¤æ‚åº¦å°±ç”± O(è´¨æ•°ä¸ªæ•° âœ–ï¸n) å˜ä¸º O(n âœ–ï¸æ ¹å·n) äº†ï¼ˆå“­å€’ã€‚ã€‚ã€‚</li></ul><p>agc036A</p><h3 id="11-9"><a href="#11-9" class="headerlink" title="11.9"></a>11.9</h3><ul><li>âš ï¸T2 æƒ³æ‰“çš„éƒ¨åˆ†åˆ†æ²¡å†™å‡ºæ¥ï¼Œæäº¤æ—¶è¿˜æ²¡åˆ æ‰é‚£éƒ¨åˆ†ç¨‹åºï¼Œå±…ç„¶ CE äº†ã€‚ã€‚30 åˆ†å•Šã€‚ã€‚å”¯ä¸€ä¸€æ¬¡èƒ½æ¯” xyr é«˜çš„æœºä¼šã€‚ã€‚ã€‚è¢«æˆ‘è‡ªå·±ä½œæ²¡äº†ã€‚ã€‚ã€‚ã€‚ </li></ul><p>agc036B, bzoj1027, </p><h3 id="11-10"><a href="#11-10" class="headerlink" title="11.10"></a>11.10</h3><ul><li>æ‰“äº† xj çš„ä¸€åœºæ¨¡æ‹Ÿèµ› + ez dalao å‡ºçš„ä¸€åœº cometã€‚æ„Ÿæƒ³ï¼šbitset çœŸæ˜¯ä¸ªå¥½ä¸œè¥¿ + æˆ‘å¥½èœå•Šqwq</li></ul><h3 id="11-11"><a href="#11-11" class="headerlink" title="11.11"></a>11.11</h3><ul><li>åŒåä¸€å—ä¹ï¼</li></ul><p>bzoj1027, luogu2680, ç„¶ååˆ‡äº†ä¸€äº›å†å¹´çœŸé¢˜çš„æ°´é¢˜å•¦</p><h3 id="11-12"><a href="#11-12" class="headerlink" title="11.12"></a>11.12</h3><ul><li>âš ï¸æ¯æ—¥ä¸€fstï¼šäºŒåˆ†è¦æ³¨æ„ç­”æ¡ˆæ˜¯å¦æœ‰æœºä¼šä¸º 0 æˆ–æœ‰å¯èƒ½è¶…è¿‡ int èŒƒå›´ï¼</li><li>ä»Šæ—¥ä»½å—ä¹ï¼šæœ‰ç”Ÿä¹‹å¹´è®¢å®Œäº†monisaiï¼ˆå…¶å®ä¸æ˜¯ç¬¬ä¸€å›qwqï¼‰220ptsä¿¡å¿ƒèµ›å¯ ğŸŒŠğŸŒŸ</li></ul><p>bzoj1295, luogu3960</p><h3 id="11-13"><a href="#11-13" class="headerlink" title="11.13"></a>11.13</h3><ul><li>è°ƒä»£ç çš„æ—¶å€™è¢«ä¸€äº› å‚»ã€æ•°æ®åˆ é™¤ã€‘æ‰‹è¯¯ç»™å‘äº†ä¸€ä¸ªå¤šå°æ—¶ã€‚ã€‚ã†á´—ã†ç»äº†</li><li>åˆ¤æ–­ä¸€äº›ä¸œè¥¿çš„æ—¶å€™å¯ä»¥å€Ÿç”¨å¦ä¸€äº›æ¯”è¾ƒæœ‰ç”¨çš„æœ‰ç‰¹å¾çš„ä¸œè¥¿ï¼ˆæˆ‘åœ¨è¯´ä»€ä¹ˆå•Šï¼‰ï¼Œæ¯”å¦‚ tarjan é¢˜å°±ç¦»ä¸å¼€ dfn å’Œ lowã€‚</li></ul><p>luogu1600, loj114, luogu2827, </p><h3 id="11-14"><a href="#11-14" class="headerlink" title="11.14"></a>11.14</h3><ul><li>ä»Šæ—¥ä»½åŠ å€å¿«ä¹ï¼šmonisaiç™»é¡¶ï¼Œæœ‰ç”Ÿä¹‹å¹´ç³»åˆ—ï¼ˆå…¶å®åªæ˜¯ 1 pts éƒ½æ²¡ fst è€Œå·² qwq</li><li>åå¤©çš„ CSP ä¿¡å¿ƒç¬é—´åŠ æ»¡ï¼CSP 2019 RP += (inf) ^ {inf} !!!</li><li>CSP æ—¶è¦ä»”ç»†å•Šï¼Œåˆ« fst äº†ï¼</li><li>è¯»å®Œé¢˜åä¸€å®šä¼šæ‡µçš„ï¼Œæ­¤æ—¶ä¸å¦¨å†™å†™ç”»ç”»ï¼Œæ¨¡æ‹Ÿä¸€äº›å°æ ·ä¾‹ï¼Œè¯´ä¸å®šå°±çœ‹ç ´å‡ºé¢˜äººçš„æ„æ€äº†ã€‚</li></ul><p>luogu2679, luogu1155, bzoj1823, bzoj1718</p><h3 id="11-15"><a href="#11-15" class="headerlink" title="11.15"></a>11.15</h3><p>bzoj1305, bzoj2424, bzoj1923, </p>]]></content>
      
      
      
        <tags>
            
            <tag> å…¶ä»– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[CF997E]-Good Subsegments</title>
      <link href="2019/11/05/%5BCF997E%5D-Good%20Subsegments/"/>
      <url>2019/11/05/%5BCF997E%5D-Good%20Subsegments/</url>
      
        <content type="html"><![CDATA[<p><a href="https://codeforces.com/contest/997/problem/E" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>è¿™é¢˜å¤ªç¥äº†ï¼ï¼çœŸæ˜¯å¥½é¢˜ï¼ï¼ï¼</p><p>æ˜¾ç„¶ï¼šåŒºé—´ $[l, r]$ æ˜¯å¥½çš„ï¼Œå½“ä¸”ä»…å½“ $(Max - Min) - (r - l) = 0$.</p><p>æˆ‘ä»¬å¯ä»¥å°†è¯¢é—®åŒºé—´æŒ‰å³ç«¯ç‚¹ä»å°åˆ°å¤§æ’åºï¼Œä¾æ¬¡ä½œä¸ºâ€œå½“å‰çš„å³ç«¯ç‚¹â€ã€‚</p><p>äºæ˜¯æˆ‘ä»¬ç»´æŠ¤æ¯ä¸ªä½ç½®åˆ°â€œå½“å‰å³ç«¯ç‚¹â€çš„ $(Max - Min) - (r - l)$ï¼Œç»´æŠ¤å®ƒä»¬çš„æœ€å°å€¼å’Œæœ€å°å€¼ä¸ªæ•°ã€‚</p><p>é‡è¦çš„ trickï¼šä¸€ä¸ªåŒºé—´ $[l, r]$ æ‰€æœ‰å­åŒºé—´çš„ç­”æ¡ˆå¯ä»¥éšç€â€œå½“å‰å³ç«¯ç‚¹â€ $r0$ çš„å¢åŠ è€Œå®æ—¶ç»Ÿè®¡ï¼Œç´¯åŠ  $query(l, r0)$.</p><p>ä»…ä»…è¿™æ ·åšï¼Œçº¿æ®µæ ‘æ“ä½œåå­˜å‚¨çš„å°±åªæ˜¯å½“å‰çš„ç­”æ¡ˆï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ç”¨æ ‡è®°ï¼Œæ¯æ¬¡ $psd$ çš„æ—¶å€™ä¸ºçº¿æ®µæ ‘ç´¯åŠ ä¸Šå‰ä¸€æ¬¡çš„ç­”æ¡ˆã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ls (x &lt;&lt; 1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rs (x &lt;&lt; 1 | 1)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">120010</span>;</span><br><span class="line"><span class="keyword">int</span> n, Q, a[N], s1[N], s2[N], top1, top2;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, id;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node &amp;x) <span class="keyword">const</span> &#123; <span class="keyword">return</span> r &lt; x.r; &#125;</span><br><span class="line">&#125;q[N];</span><br><span class="line"><span class="keyword">int</span> tag[N &lt;&lt; <span class="number">2</span>], tg[N &lt;&lt; <span class="number">2</span>], mn[N &lt;&lt; <span class="number">2</span>], t[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line">ll sum[N &lt;&lt; <span class="number">2</span>], ans[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    mn[x] = l;  <span class="comment">// at first: (mx - mn) - (r - l) = 0 - (0 - l) = l</span></span><br><span class="line">    t[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    build(ls, l, mid), build(rs, mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    mn[x] = min(mn[ls], mn[rs]);</span><br><span class="line">    t[x] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    t[x] = (mn[x] == mn[ls] ? t[x] + t[ls] : t[x]);</span><br><span class="line">    t[x] = (mn[x] == mn[rs] ? t[x] + t[rs] : t[x]);</span><br><span class="line"></span><br><span class="line">    sum[x] = sum[ls] + sum[rs];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">psd</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (tag[x]) &#123;</span><br><span class="line">        mn[ls] += tag[x], mn[rs] += tag[x];</span><br><span class="line">        tag[ls] += tag[x], tag[rs] += tag[x];</span><br><span class="line">        tag[x] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (tg[x]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mn[x] == mn[ls])</span><br><span class="line">            sum[ls] += <span class="number">1l</span>l * t[ls] * tg[x], tg[ls] += tg[x];</span><br><span class="line">        <span class="keyword">if</span> (mn[x] == mn[rs])</span><br><span class="line">            sum[rs] += <span class="number">1l</span>l * t[rs] * tg[x], tg[rs] += tg[x];</span><br><span class="line">        tg[x] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> lx, <span class="keyword">int</span> rx, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (lx &lt;= l &amp;&amp; r &lt;= rx) &#123;</span><br><span class="line">        mn[x] += val; tag[x] += val; <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    psd(x);</span><br><span class="line">    <span class="keyword">if</span> (lx &lt;= mid) modify(ls, l, mid, lx, rx, val);</span><br><span class="line">    <span class="keyword">if</span> (rx &gt; mid) modify(rs, mid + <span class="number">1</span>, r, lx, rx, val);</span><br><span class="line">    pushup(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> lx, <span class="keyword">int</span> rx)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (lx &lt;= l &amp;&amp; r &lt;= rx) <span class="keyword">return</span> sum[x];</span><br><span class="line">    psd(x);</span><br><span class="line">    ll mid = (l + r) &gt;&gt; <span class="number">1</span>, ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (lx &lt;= mid) ret = query(ls, l, mid, lx, rx);</span><br><span class="line">    <span class="keyword">if</span> (rx &gt; mid) ret += query(rs, mid + <span class="number">1</span>, r, lx, rx);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; Q;</span><br><span class="line">    rep(i, <span class="number">1</span>, Q) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;q[i].l, &amp;q[i].r), q[i].id = i;</span><br><span class="line">    sort(q + <span class="number">1</span>, q + Q + <span class="number">1</span>);</span><br><span class="line">    build(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> pos = <span class="number">1</span>;</span><br><span class="line">    rep(tr, <span class="number">1</span>, n) &#123;</span><br><span class="line">        mn[<span class="number">1</span>]--, tag[<span class="number">1</span>]--;  <span class="comment">// éšç€ r çš„å¢åŠ ï¼Œæœ€å°å€¼å‡å°</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (top1 &amp;&amp; a[s1[top1]] &gt; a[tr])</span><br><span class="line">            modify(<span class="number">1</span>, <span class="number">1</span>, n, s1[top1 - <span class="number">1</span>] + <span class="number">1</span>, s1[top1], a[s1[top1]] - a[tr]), --top1;</span><br><span class="line">        s1[++top1] = tr;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (top2 &amp;&amp; a[s2[top2]] &lt; a[tr])</span><br><span class="line">            modify(<span class="number">1</span>, <span class="number">1</span>, n, s2[top2 - <span class="number">1</span>] + <span class="number">1</span>, s2[top2], a[tr] - a[s2[top2]]), --top2;</span><br><span class="line">        s2[++top2] = tr;</span><br><span class="line"></span><br><span class="line">        sum[<span class="number">1</span>] += t[<span class="number">1</span>], tg[<span class="number">1</span>]++;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (pos &lt;= Q &amp;&amp; q[pos].r == tr) &#123;</span><br><span class="line">            ans[q[pos].id] = query(<span class="number">1</span>, <span class="number">1</span>, n, q[pos].l, tr);</span><br><span class="line">            ++pos;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, Q) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Atcoder Beginner Contest 144</title>
      <link href="2019/10/30/Atcoder%20Beginner%20Contest%20144/"/>
      <url>2019/10/30/Atcoder%20Beginner%20Contest%20144/</url>
      
        <content type="html"><![CDATA[<p><a href="https://atcoder.jp/contests/abc144" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><h3 id="D-Water-Bottle"><a href="#D-Water-Bottle" class="headerlink" title="D - Water Bottle"></a>D - Water Bottle</h3><hr><p>åˆ†ç±»è®¨è®º + ä¸‰è§’å‡½æ•°</p><p>æ­£åˆ‡æ˜¯æˆ‘ä»¬å¹³æ—¶è¯´çš„ç›´çº¿çš„æ–œç‡ï¼Œåæ­£åˆ‡ï¼ˆc++ä¸­çš„atanå‡½æ•°ï¼‰çš„æ„ä¹‰å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼šè‹¥ A ä¸ºè§’ï¼ŒtanA = x / y, åˆ™ A = arctan x / y. è€Œ c++ ä¸­è®¡ç®—ä½¿ç”¨çš„æ˜¯å¼§åº¦åˆ¶ï¼Œæ‰€å¾—çš„è¦è½¬åŒ–ä¸ºè§’åº¦ï¼Œè¿˜éœ€ä¹˜ä»¥ 180 / PI.</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="number">3.1415926535897923</span>;</span><br><span class="line"><span class="keyword">double</span> a, b, x, v, t;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b &gt;&gt; x;</span><br><span class="line">    v = a * a * b;</span><br><span class="line">    <span class="keyword">if</span> (x &gt;= v / <span class="number">2</span>) &#123;</span><br><span class="line">        t = <span class="number">2</span> * (v - x) / (a * a);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%.7lf\n"</span>, <span class="built_in">atan</span>(t / a) * <span class="number">180</span> / PI);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        t = <span class="number">2</span> * x / a / b;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%.7lf\n"</span>, <span class="number">90</span> - <span class="built_in">atan</span>(t / b) * <span class="number">180</span> / PI);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="E-Gluttony"><a href="#E-Gluttony" class="headerlink" title="E - Gluttony"></a>E - Gluttony</h3><hr><p>è´ªå¿ƒ + äºŒåˆ†</p><p>æ ¹æ®è´ªå¿ƒç­–ç•¥å¾ˆå®¹æ˜“æƒ³åˆ°ï¼šå°† A ä»å°åˆ°å¤§æ’ï¼ŒF ä»å¤§åˆ°å°æ’ï¼ŒAi ä¸ Fi é…ã€‚ç„¶åæœ¬é¢˜çš„å®è´¨å°±å˜æˆäº†â€œæœ€å¤§å€¼æœ€å°â€ï¼ŒäºŒåˆ†å¦¥å¦¥çš„ï¼</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line">ll n, K, a[N], f[N], l, r, ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a &gt; b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chk</span><span class="params">(ll lim)</span> </span>&#123;</span><br><span class="line">    ll cnt = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        cnt += max(<span class="number">0l</span>l, a[i] - lim / f[i]);</span><br><span class="line">    <span class="keyword">return</span> cnt &lt;= K;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; K;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;f[i]);</span><br><span class="line">    sort(a + <span class="number">1</span>, a + n + <span class="number">1</span>);</span><br><span class="line">    sort(f + <span class="number">1</span>, f + n + <span class="number">1</span>, cmp);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) r = max(r, a[i] * f[i]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">        ll mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (chk(mid)) r = mid - <span class="number">1</span>, ans = mid;</span><br><span class="line">        <span class="keyword">else</span> l = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// æœ€å¤§å€¼æœ€å°ï¼æœ€å¤§å€¼æœ€å°ï¼æœ€å¤§å€¼æœ€å°ï¼é‡è¦çš„äº‹æƒ…æ±ªä¸‰é</span></span><br></pre></td></tr></table></figure><h3 id="F-Fork-in-the-Road"><a href="#F-Fork-in-the-Road" class="headerlink" title="F - Fork in the Road"></a>F - Fork in the Road</h3><hr><p>ä¸€å¼€å§‹æ€è·¯æ˜¯æšä¸¾æ–­è¾¹ï¼Œæ¯æ¬¡æ‹“æ‰‘ä¸€éè®¡ç®— f[x] è¡¨ç¤º x åˆ° n çš„æœŸæœ›æ­¥æ•°ï¼Œè¿™æ ·å¤æ‚åº¦æ˜¯ $O(m(n + m))$ çš„ï¼Œä¸å¤ªokã€‚</p><p>æ³¨æ„åˆ° m æŒºå¤§ï¼Œn æ¯”è¾ƒå°ï¼Œæˆ‘ä»¬å¯ä»¥æšä¸¾æ–­å“ªä¸ªç‚¹ x å‘¨å›´çš„è¾¹ï¼ˆå‡è®¾è¯¥è¾¹è¿æ¥ x å’Œ yï¼Œå¿…ç„¶æ–­çš„æ˜¯ f[y] æœ€å¤§çš„è¾¹ï¼‰ï¼Œå¤æ‚åº¦æ˜¯ $O(n(n+m))$ çš„ï¼Œå¯ä»¥åˆ‡äº†æ­¤é¢˜ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// si &lt; ti !!! si &lt; ti !!! si &lt; ti !!! æ¡ä»¶è¿˜èƒ½æ¼çš„å•Šï¼Ÿä½ çœ¼ç›å‘¢ï¼Ÿï¼Ÿï¼</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">605</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> inf = (<span class="keyword">double</span>)<span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, sons;</span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line"><span class="keyword">double</span> ans, f[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span> <span class="keyword">int</span> s, t; &#125;e[N * N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nxt[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> pos)</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) f[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x = n - <span class="number">1</span>; x &gt;= <span class="number">1</span>; x--) &#123;</span><br><span class="line">        <span class="keyword">int</span> num = nxt[x].size();</span><br><span class="line">        <span class="keyword">if</span> (pos == x &amp;&amp; num == <span class="number">1</span>) &#123; f[x] = inf; <span class="keyword">continue</span>; &#125;</span><br><span class="line">        <span class="keyword">double</span> t = <span class="number">1.0</span> / (num - (pos == x)), mx = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; num; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = nxt[x][i];</span><br><span class="line">            f[x] += (f[y] + <span class="number">1</span>) * t;</span><br><span class="line">            mx = max(mx, (f[y] + <span class="number">1</span>) * t);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (pos == x) f[x] -= mx;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;e[i].s, &amp;e[i].t);</span><br><span class="line">        nxt[e[i].s].push_back(e[i].t);</span><br><span class="line">        <span class="keyword">if</span> (e[i].s == <span class="number">1</span>) sons++;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = calc(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    rep(i, <span class="number">1</span>, n) ans = min(ans, calc(i));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.7lf\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[POI2015]-LOG</title>
      <link href="2019/10/29/%5BPOI2015%5D-LOG/"/>
      <url>2019/10/29/%5BPOI2015%5D-LOG/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.luogu.org/problem/P3586" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>â€œæ¯æ¬¡é€‰ $a$ ä¸ªæ­£æ•°å¹¶å°†å®ƒä»¬éƒ½å‡å» $1$ï¼Œåˆ¤æ–­èƒ½å¦è¿›è¡Œ $s$ æ¬¡æ“ä½œâ€ è¿™ä¸€ç±»é¢˜æœ‰ä¸ªå°æŠ€å·§ï¼š</p><blockquote><p>è®¾å¤§äºç­‰äº $s$ æœ‰ $x$ ä¸ªï¼Œåˆ¤å®šå°±è½¬åŒ–ä¸º $[ x * s + (å°äº s çš„æ•°å­—ä¹‹å’Œ) &gt;= a * s ]$</p></blockquote><p>ç”¨æ ‘çŠ¶æ•°ç»„è¦å¯¹ $s$ ç¦»æ•£åŒ–å³å¯ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lowbit(x) ((x) &amp; (-(x)))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, m, C[N], cnt[N], a[N], h[N &lt;&lt; <span class="number">1</span>], num;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span> <span class="keyword">char</span> opt; ll x, y; &#125;q[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add1</span><span class="params">(ll x, ll v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">for</span> (; x &lt; N; x += lowbit(x)) C[x] += v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask1</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (; x; x -= lowbit(x)) ret += C[x];</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add2</span><span class="params">(ll x, ll v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">for</span> (; x &lt; N; x += lowbit(x)) cnt[x] += v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">ask2</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (; x; x -= lowbit(x)) ret += cnt[x];</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> c, <span class="keyword">int</span> s)</span> </span>&#123;</span><br><span class="line">    ll x = ask1(num) - ask1(s - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> x * h[s] + ask2(s - <span class="number">1</span>) &gt;= <span class="number">1l</span>l * c * h[s];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; q[i].opt;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;q[i].x, &amp;q[i].y);</span><br><span class="line">        h[++num] = q[i].y;</span><br><span class="line">    &#125;</span><br><span class="line">    h[++num] = <span class="number">0</span>;</span><br><span class="line">    sort(h + <span class="number">1</span>, h + num + <span class="number">1</span>);</span><br><span class="line">    num = unique(h + <span class="number">1</span>, h + num + <span class="number">1</span>) - h - <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, m)</span><br><span class="line">        q[i].y = lower_bound(h + <span class="number">1</span>, h + num + <span class="number">1</span>, q[i].y) - h;</span><br><span class="line">    </span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="keyword">char</span> ch; <span class="keyword">int</span> x, y;</span><br><span class="line">        ch = q[i].opt, x = q[i].x, y = q[i].y;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">'U'</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[x])</span><br><span class="line">                add1(a[x], <span class="number">-1</span>), add2(a[x], -h[a[x]]);</span><br><span class="line">            a[x] = y;</span><br><span class="line">            add1(a[x], <span class="number">1</span>);</span><br><span class="line">            add2(a[x], h[a[x]]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">puts</span>(calc(x, y) ? <span class="string">"TAK"</span> : <span class="string">"NIE"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼çš„é¢˜ç›®è¿˜æœ‰ <a href="https://atcoder.jp/contests/abc143/tasks/abc143_f" target="_blank" rel="noopener">ATC143F - Distinct Numbers</a>, åªæ˜¯å°† $s$ æ›¿æ¢ä¸ºäºŒåˆ†å€¼ $mid$ äº†ã€‚äºŒåˆ†åšæ³•å¤æ‚åº¦æ˜¯ $O(nlog^2n)$, ä½†è¿™é‡Œæ˜¯åˆ©ç”¨ç­”æ¡ˆå•è°ƒæ€§çš„ $O(n)$ åšæ³•ï¼ˆå®¹æ˜“å‘ç°ï¼Œéšç€ $K$ çš„å‡å°ï¼Œç­”æ¡ˆåªä¼šå¢åŠ ä¸ä¼šå‡å°‘ï¼‰ï¼Œç„¶åå‰ç¼€çš„é¢„å¤„ç†è¿˜æ˜¯éå¸¸ç¥ä»™çš„ï¼ˆä»ç½‘ä¸Šè´ºæ¥çš„qwqï¼‰ï¼Œå®åœ¨ä¸æ‡‚å¯ä»¥æ¨¡æ‹Ÿè¾“å‡ºä¸­é—´è¿‡ç¨‹ï¼ˆå…¶å®ä¹Ÿä¸éš¾ç†è§£ï¼‰</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, x, a[N], K, cnt[N], sum[N], ans[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chk</span><span class="params">(ll k, ll x)</span> </span>&#123; <span class="keyword">return</span> sum[x] &gt;= k * x; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">cin</span> &gt;&gt; x, ++sum[++cnt[x]];</span><br><span class="line">    rep(i, <span class="number">1</span>, n) sum[i] += sum[i - <span class="number">1</span>];</span><br><span class="line">    ll now = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = n; k &gt;= <span class="number">1</span>; k--) &#123;</span><br><span class="line">        <span class="keyword">while</span> (now &lt; n &amp;&amp; chk(k, now + <span class="number">1</span>)) ++now;</span><br><span class="line">        ans[k] = now;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>[LG4551]-æœ€é•¿å¼‚æˆ–è·¯å¾„</title>
      <link href="2019/10/12/%5Bluogu4551%5D-%E6%9C%80%E9%95%BF%E5%BC%82%E6%88%96%E8%B7%AF%E5%BE%84/"/>
      <url>2019/10/12/%5Bluogu4551%5D-%E6%9C%80%E9%95%BF%E5%BC%82%E6%88%96%E8%B7%AF%E5%BE%84/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.luogu.org/problem/P4551" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>ã€ æ–°æŠ€èƒ½getâˆšï¿£ ã€‘</p><p>é¦–å…ˆæœ‰ä¸ªå¾ˆé‡è¦çš„å¸¸è¯†ï¼š$x$ åˆ° $y$ çš„å¼‚æˆ–å€¼ä¸º $x$ åˆ°æ ¹çš„å¼‚æˆ–å€¼å¼‚æˆ–ä¸Š $y$ åˆ°æ ¹çš„å¼‚æˆ–å€¼ã€‚å…¶æ­£ç¡®æ€§æ˜¾ç„¶ã€‚</p><p>é‚£ä¹ˆé¢˜ç›®å°±å˜ä¸ºï¼šé€‰ä¸¤ä¸ªç‚¹ï¼Œä½¿å¾—å®ƒä»¬çš„å¼‚æˆ–å€¼å¼‚æˆ–èµ·æ¥æœ€å¤§ã€‚</p><p>ï¼ˆæˆ‘å±…ç„¶è¿˜æƒ³åˆ°çº¿æ€§åŸºäº†ã€‚ã€‚æ™ºå•†ä¸è¡Œå‘€ï¼Œä¸æ˜¯ä»€ä¹ˆå¼‚æˆ–éƒ½æ˜¯çº¿æ€§åŸºçš„ï¼Œçº¿æ€§åŸºæ˜¯å¤šä¸ªå¼‚æˆ–ï¼Œä¸æ˜¯ä¸¤ä¸ªå¼‚æˆ–ã€‚ã€‚</p><p>é‡ç‚¹æ¥äº†ï¼š$01$ å­—å…¸æ ‘æ˜¯å¤„ç†å¼‚æˆ–é—®é¢˜çš„åˆ©å™¨ï¼Œå¯¹äºä¸€ä¸ªå€¼ $x$ï¼Œä¸ºäº†ä½¿å®ƒä¸å¦ä¸€ä¸ªå€¼ $y$ å¼‚æˆ–åæœ€å¤§ï¼Œæ ¹æ®è´ªå¿ƒçš„æ€æƒ³ï¼Œæ˜¾ç„¶å°½é‡ä½¿å®ƒä»¬çš„äºŒè¿›åˆ¶æœ€é«˜ä½ä¸åŒï¼Œç„¶åæ¬¡é«˜ä½ä¸åŒâ€¦blabla</p><p>é‚£ä¹ˆæŠŠæ‰€æœ‰èŠ‚ç‚¹åˆ°æ ¹ç»“ç‚¹çš„å¼‚æˆ–å€¼å»ºæˆä¸€æ£µ $01$ å­—å…¸æ ‘å°±è¡Œå•¦ã€‚å¤æ‚åº¦ $O(NlogV)$</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, dis[N], ch[<span class="number">31</span> * N][<span class="number">2</span>], idx, mark[<span class="number">31</span> * N], ans;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nxt[N], val[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span> </span>&#123;</span><br><span class="line">    nxt[x].push_back(y), val[x].push_back(z);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nxt[x].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = nxt[x][i];</span><br><span class="line">        <span class="keyword">if</span> (y == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dis[y] = dis[x] ^ val[x][i];</span><br><span class="line">        dfs(y, x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> u = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">30</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">int</span> c = ((x &gt;&gt; i) &amp; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (!ch[u][c]) ch[u][c] = ++idx;</span><br><span class="line">        u = ch[u][c];</span><br><span class="line">    &#125;</span><br><span class="line">    mark[u] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> u = <span class="number">0</span>, ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">30</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">int</span> c = (((x &gt;&gt; i) &amp; <span class="number">1</span>) ^ <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (ch[u][c]) u = ch[u][c], ret += (<span class="number">1</span> &lt;&lt; i);</span><br><span class="line">        <span class="keyword">else</span> u = ch[u][c ^ <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y, z; <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;x, &amp;y, &amp;z);</span><br><span class="line">        add(x, y, z), add(y, x, z);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) insert(dis[i]);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) ans = max(ans, query(dis[i]));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Trieæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Atcoder Grand Contest 038</title>
      <link href="2019/10/09/Atcoder%20Grand%20Contest%20038/"/>
      <url>2019/10/09/Atcoder%20Grand%20Contest%20038/</url>
      
        <content type="html"><![CDATA[<h3 id="A-01-Matrix"><a href="#A-01-Matrix" class="headerlink" title="A - 01 Matrix"></a>A - 01 Matrix</h3><hr><p>æƒ³äº†ä¸€ä¼šå„¿ã€‚ã€‚qwq</p><p>æ˜¾ç„¶ï¼Œä»¤ mp[1 ~ b, 1 ~ a] = 1, mp[b + 1 ~ n, a + 1 ~ m] = 1 å³å¯ã€‚</p><h3 id="B-Sorting-a-Segment"><a href="#B-Sorting-a-Segment" class="headerlink" title="B - Sorting a Segment"></a>B - Sorting a Segment</h3><hr><p>æˆ‘ä»¬å‘ç°ï¼Œè‹¥æ’åº (l1, r1) å¾—åˆ°çš„åºåˆ—ä¸æ’åº (l2, r2) å¾—åˆ°çš„åºåˆ—ç›¸åŒ(r1 &lt; l2)ï¼Œé‚£ä¹ˆæ’åº (l1, r1), (l1 + 1, r1 + 1), (l1 + 2, r1 + 2) â€¦ (l2 - 1, r2 - 1), (l2, r2) å¾—åˆ°çš„åºåˆ—ä¹Ÿæ˜¯ç›¸åŒçš„ã€‚</p><p>æ’åº (l, r) ä¸ (l + 1, r + 1) å¾—åˆ°çš„åºåˆ—ç›¸åŒå½“ä¸”ä»…å½“åœ¨ [l, r + 1] ä¸­ï¼Œa[l] æ˜¯æœ€å°å€¼ï¼Œa[r + 1] æ˜¯æœ€å¤§å€¼ã€‚è¿™ä¸ªç”¨å•è°ƒé˜Ÿåˆ—åˆ¤æ–­å³å¯ï¼Œæœ€åç”¨æ–¹æ¡ˆæ€»æ•°å‡å»ç›¸åŒçš„æ–¹æ¡ˆæ•°å¾—å‡ºç­”æ¡ˆï¼</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, K, a[N], q[N], ans, mark[N], b[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; K;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">    ans = n - K + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>, tot = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[i] &gt; a[i - <span class="number">1</span>]) b[i] = b[i - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> b[i] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">1</span>, r = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= K) &#123;</span><br><span class="line">            <span class="keyword">while</span> (l &lt;= r &amp;&amp; q[l] &lt; i - K) ++l;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (q[l] == i - K) mark[i]++;</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r &amp;&amp; a[q[r]] &gt; a[i]) --r;</span><br><span class="line">        q[++r] = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    l = <span class="number">1</span>, r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &lt;= n - K + <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (l &lt;= r &amp;&amp; q[l] &gt; i + K) ++l;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (q[l] == i + K) mark[i + K]++;</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r &amp;&amp; a[q[r]] &lt; a[i]) --r;</span><br><span class="line">        q[++r] = i;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> ff = <span class="number">0</span>;</span><br><span class="line">    rep(i, K, n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b[i] &gt;= K) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!ff) ff = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> tot++;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mark[i] == <span class="number">2</span>) tot++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans - tot);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-LCMs"><a href="#C-LCMs" class="headerlink" title="C - LCMs"></a>C - LCMs</h3><hr><p>æ•°è®ºé¢˜ï¼AtcoderçœŸå…¨</p><p>$\sum\limits_{i=1}^{n}\sum\limits_{j=i + 1}^n\frac{A_iA_j}{gcd(A_i,A_j)}$</p><p>= $\sum\limits_{d=1}^N\frac{1}{d}\sum\limits_{i=1}^n\sum\limits_{j=i+1}^nA_iA_j\sum\limits_{kd|A_i,kd|A_j}\mu(k)$</p><p>= $\sum\limits_{d=1}^N\frac{1}{d}\sum\limits_{k=1}^{N/d}\mu(k)(\sum\limits_{kd|A_i}\sum\limits_{kd|A_j}A_iA_j)$</p><p>å³è¾¹è¿™ä¸ª â€œ()â€ é‡Œçš„éƒ¨åˆ†å¯ä»¥è°ƒå’Œçº§æ•°å¤æ‚åº¦é¢„å¤„ç†</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (long long i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span>, mod = <span class="number">998244353</span>, M = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, a[M], inv[N + <span class="number">5</span>], bin[N + <span class="number">5</span>], ans, f[N + <span class="number">5</span>];</span><br><span class="line"><span class="keyword">int</span> mu[N + <span class="number">5</span>], prime[N + <span class="number">5</span>], tot, mark[N + <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prework</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">2</span>, N) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!mark[i]) prime[++tot] = i, mu[i] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; i * prime[j] &lt;= N; j++) &#123;</span><br><span class="line">            mark[i * prime[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % prime[j] == <span class="number">0</span>) &#123;</span><br><span class="line">                mu[i * prime[j]] = <span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            mu[i * prime[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">2</span>, N) inv[i] = inv[mod % i] * (mod - mod / i) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    prework();</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">cin</span> &gt;&gt; a[i], bin[a[i]]++;  <span class="comment">// å°æŠ€å·§</span></span><br><span class="line">    rep(i, <span class="number">1</span>, N) &#123;</span><br><span class="line">        ll sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (ll j = i; j &lt;= N; j += i) &#123;</span><br><span class="line">            sum = (sum + bin[j] * j % mod) % mod;</span><br><span class="line">            f[i] = (f[i] + j * j * bin[j] % mod) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">        f[i] = (sum * sum % mod - f[i] + mod) * inv[<span class="number">2</span>] % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(k, <span class="number">1</span>, N)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = k; i &lt;= N; i += k) <span class="comment">// i = k * d</span></span><br><span class="line">            ans = (ans + inv[k] * mu[i / k] % mod * f[i] % mod) % mod;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id><a href="#" class="headerlink" title></a></h3>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[HAOI2007]-ä¸Šå‡åºåˆ—</title>
      <link href="2019/10/08/%5BHAOI2007%5D-%E4%B8%8A%E5%8D%87%E5%BA%8F%E5%88%97/"/>
      <url>2019/10/08/%5BHAOI2007%5D-%E4%B8%8A%E5%8D%87%E5%BA%8F%E5%88%97/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.luogu.org/problem/P2215" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>aaaaaaaaæˆ‘å±…ç„¶ä¸ä¼šäºŒåˆ†æ±‚æœ€é•¿ä¸Šå‡/ä¸‹é™å­åºåˆ—ï¼ï¼ï¼</p><p>æ‰€ä»¥ä»Šå¤©æ¶¨å§¿åŠ¿äº† qaq</p><ul><li>é¢˜æ„åˆ’é‡ç‚¹ï¼šå­—å…¸åºæœ€å°æŒ‡ $x_i$ æœ€å°ã€‚</li></ul><p>å…ˆåˆ¤æ–­ä¸‹æœ€é•¿ä¸Šå‡å­åºåˆ—é•¿åº¦æ˜¯å¦ $\geq$ è¯¢é—®çš„ $L$ã€‚</p><p>$O(nm)$ çš„å¤æ‚åº¦å®Œå…¨å¯ä»¥è¿‡ï¼Œæ‰€ä»¥æˆ‘ä»¬æšä¸¾ $x_i$ çœ‹æ˜¯å¦ç¬¦åˆæ¡ä»¶ï¼Œè‹¥ç¬¦åˆåˆ™ç«‹åˆ»è¾“å‡º $a_{x_i}$ï¼Œä¿è¯å­—å…¸åºæœ€å°ã€‚</p><p>ç¬¦åˆæ¡ä»¶æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå‡è®¾è¿˜å‰©ä¸‹ $x$ çš„é•¿åº¦æ²¡æœ‰åˆ†é…ï¼Œè‹¥ $x_i$ ç¬¦åˆè¦æ±‚ï¼Œåˆ™ $x_i$ ~ $n$ è¿™æ®µä¸­æœ‰ $\geq x$ ä¸ªåç»­ä½ç½®ã€‚ç”±äºæ˜¯ $x_i$ ~ $n$ ï¼Œæˆ‘ä»¬é¢„å¤„ç†çš„æ˜¯ä¸‹é™è€Œä¸æ˜¯ä¸Šå‡å­åºåˆ—ã€‚</p><p>å¤§æ¦‚æ˜¯è¿™æ ·ï¼šç»´æŠ¤æœ€é•¿ä¸‹é™å­åºåˆ— $b$ æ•°ç»„ï¼Œå¯¹äºæ¯ä¸ª $a_i$ äºŒåˆ†æ±‚å‡º $b$ ä¸­ç¬¬ä¸€ä¸ª &gt; $a_i$ çš„ $b_j$ï¼Œä»¤ $i$ ä½ç½®çš„åç»­é•¿åº¦ä¸º $j + 1$.<br>åŒæ—¶ï¼Œè‹¥ $b[j + 1] &lt; a[i]$, åˆ™ä»¤ $b[j + 1] = a[i]$ï¼ˆå¹¶ä¸ä¼šä½¿å­åºåˆ—æ›´åŠ£ï¼Œåè€Œæœ‰å¯èƒ½æ›´ä¼˜ï¼Œå› ä¸ºä¸‹é™çš„å¹…åº¦å‡å°äº†å˜›ï¼‰</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, a[N], x, b[N], f[N], tot;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">1</span>, r = tot, ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (b[mid] &gt; x) ret = max(ret, mid), l = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">int</span> tmp = query(a[i]);</span><br><span class="line">        f[i] = tmp + <span class="number">1</span>;</span><br><span class="line">        tot = max(tot, tmp + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (b[tmp + <span class="number">1</span>] &lt; a[i]) b[tmp + <span class="number">1</span>] = a[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; m;</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">        <span class="keyword">if</span> (x &gt; tot) <span class="built_in">puts</span>(<span class="string">"Impossible"</span>);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> lst = <span class="number">0</span>;</span><br><span class="line">            rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">                <span class="keyword">if</span> (a[i] &gt; lst &amp;&amp; f[i] &gt;= x) &#123;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">"%d "</span>, a[i]);</span><br><span class="line">                    x--;</span><br><span class="line">                    lst = a[i];</span><br><span class="line">                    <span class="keyword">if</span> (!x) <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿æ€§dp </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[USACO2009open]-å¹²è‰å †tower</title>
      <link href="2019/09/25/%5BUSACO2009open%5D-%E5%B9%B2%E8%8D%89%E5%A0%86tower/"/>
      <url>2019/09/25/%5BUSACO2009open%5D-%E5%B9%B2%E8%8D%89%E5%A0%86tower/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.lydsy.com/JudgeOnline/problem.php?id=1233" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>æ˜¯ä¸€é“éå¸¸ç¥å¥‡çš„å•è°ƒé˜Ÿåˆ—ä¼˜åŒ– DPï¼</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å‘ç°è¿™é¢˜éå¸¸ä¸å¥½åšï¼ˆæ²¡æœ‰å…¥æ‰‹ç‚¹ï¼Œä½†å‘ç°å¯ä»¥ç”¨äºŒç»´ $n^3$ DPï¼š$f[i, j]$ è¡¨ç¤º $i$ ~ $j - 1$ æ˜¯ $j$ å·¦è¾¹çš„ä¸€æ®µçš„æœ€å¤§é«˜åº¦ã€‚æˆ‘ä»¬æƒ³æƒ³æ€ä¹ˆä¼˜åŒ–ã€‚</p><p>zkw å¤§ç¥è¯å‡ºï¼Œæœ€ä¼˜çš„æ–¹æ¡ˆå¿…å®šåº•å±‚å®½åº¦æœ€å°ã€‚å¤§æ¦‚æ˜¯è¿™æ ·è¯çš„ï¼šæœ‰ $A$ å’Œ $B$ ä¸¤ä¸ªå¡”ï¼Œ$A$ çš„é«˜åº¦æœ€å¤§ï¼Œ$B$ æŒ‰ä»ä½åˆ°é«˜çš„é¡ºåºçš„æ¯å±‚å®½åº¦æœ€å°ã€‚é‚£ä¹ˆ $A$ çš„åº•å±‚å®½åº¦å¿…ç„¶å¤§äºç­‰äº $B$ï¼Œ$B$ çš„é«˜åº¦å¿…ç„¶å°äºç­‰äº $A$ã€‚å¿…å®šå­˜åœ¨ä¸€ä¸ªä½ç½® $pos$ï¼Œè¯¥ä½ç½® $A$ çš„å®½åº¦å°äº $B$ï¼ˆå› ä¸º $A$ ä¸å¯èƒ½å±‚å±‚éƒ½æ¯” $B$ å®½ï¼‰ï¼Œé‚£ä¹ˆå¯¹äº $B$ æ¥è¯´ï¼Œåªè¦æŠŠ $pos$ ä»¥ä¸Šçš„éƒ¨åˆ†æ¢æˆ $A$ å¡”ä¸­ $pos$ ä»¥ä¸Šçš„éƒ¨åˆ†ï¼Œå°±èƒ½å˜æˆæ›´ä¼˜çš„æ–¹æ¡ˆã€‚</p><p>å¦‚æœä»åº•å±‚åˆ°é¡¶å±‚ DPï¼Œä¼šå‘ç°çŠ¶æ€ä¸å¥½è®¾è®¡ï¼ˆåæ­£æˆ‘æ²¡æƒ³å‡ºæ¥qvqï¼‰ï¼Œè€Œä¸”æ²¡æœ‰å•è°ƒæ€§ï¼ˆæ¯”å¦‚ $n = 3$ï¼Œ$w = {2, 1, 4}$ï¼Œå‰ä¸¤ä¸ªæœ€å¤§é«˜åº¦æ˜¯ $2$ï¼ŒåŠ å…¥ç¬¬ä¸‰ä¸ªå°±å˜æˆ $1$ äº†ã€‚ã€‚ï¼‰ï¼Œè€Œä»é¡¶å±‚åˆ°åº•å±‚ DP æ˜¯æœ‰å•è°ƒæ€§çš„ï¼ˆè‡ªå·±æƒ³ä¸€æƒ³ï¼‰ã€‚</p><p>è®¾ $f[i]$ è¡¨ç¤ºè¯¥å±‚ç¼–å·æœ€å°ä¸º $i$ æ—¶çš„å®½åº¦ã€‚ $f[i] = \min\limits_{sum[j - 1] - sum[i - 1] &gt;= f[j]}{sum[j - 1] - sum[i - 1]}$</p><p>å³ $sum[j - 1] - f[j] &gt;= sum[i - 1]$</p><p>æ˜¾ç„¶åªæœ‰ $sum[j - 1] - f[j] &gt;= sum[i - 1]$ ä¸”ç¦» $i$ æœ€è¿‘çš„ $j$ æ‰èƒ½è½¬ç§»ç»™ $i$ã€‚ç»´æŠ¤ä¸€ä¸ª $sum[j - 1] - f[j]$ å•è°ƒé€’å‡ï¼ˆå› ä¸º $i$ ä» $n$ åˆ° $1$ï¼Œ$sum[i - 1]$ æ˜¯é€’å‡çš„ï¼‰çš„å•è°ƒé˜Ÿåˆ—å°±å¯ä»¥äº†ã€‚</p><p>å±±è·¯åå…«å¼¯ ~ æ€ç»´éš¾åº¦è¿˜æ˜¯å¾ˆå¤§çš„ï¼ã€å•è°ƒé˜Ÿåˆ—éš¾.jpgã€‘</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, a[N], q[N], f[N], g[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]), a[i] += a[i - <span class="number">1</span>];</span><br><span class="line">    a[n + <span class="number">1</span>] = a[n];</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">1</span>, r = <span class="number">1</span>;</span><br><span class="line">    q[l] = n + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">while</span> (l &lt; r &amp;&amp; a[q[l + <span class="number">1</span>] - <span class="number">1</span>] - f[q[l + <span class="number">1</span>]] &gt;= a[i - <span class="number">1</span>]) ++l;</span><br><span class="line">        f[i] = a[q[l] - <span class="number">1</span>] - a[i - <span class="number">1</span>];</span><br><span class="line">        g[i] = g[q[l]] + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r &amp;&amp; a[q[r] - <span class="number">1</span>] - f[q[r]] &lt;= a[i - <span class="number">1</span>] - f[i]) --r;</span><br><span class="line">        q[++r] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, g[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å•è°ƒé˜Ÿåˆ— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Atcoder Beginner Contest 141</title>
      <link href="2019/09/17/Atcoder%20Beginner%20Contest%20141/"/>
      <url>2019/09/17/Atcoder%20Beginner%20Contest%20141/</url>
      
        <content type="html"><![CDATA[<p><a href="https://atcoder.jp/contests/abc141/tasks" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>ABCçš†ä¸ºæ°´é¢˜ã€‚ã€‚ã€‚ç•¥è¿‡</p><h3 id="D-Powerful-Discount-Tickets"><a href="#D-Powerful-Discount-Tickets" class="headerlink" title="D - Powerful Discount Tickets"></a>D - Powerful Discount Tickets</h3><hr><p>a/b/c(ä¸‹å–æ•´) ç«Ÿç„¶ç­‰äº a/(bc)(ä¸‹å–æ•´)ã€‚ã€‚ã€‚æ¯”èµ›æ—¶æƒ³åˆ°æ­£è§£åšæ³•ï¼Œä½†ç”±äºæ— æ³•è¯æ˜å‰é¢é‚£å¥ä¹Ÿä¸¾ä¸å‡ºåä¾‹è€Œä¸äº†äº†ä¹‹äº†ã€‚ã€‚ã€‚</p><p>æ­£è§£å°±æ˜¯å †ä¼˜åŒ–å•¦</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, m, a[N], f[N][<span class="number">2</span>];</span><br><span class="line">priority_queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">ll ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">        q.push(a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.top(); q.pop();</span><br><span class="line">        x /= <span class="number">2</span>;</span><br><span class="line">        q.push(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = q.top(); q.pop();</span><br><span class="line">        ans += x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="E-Who-Says-a-Pun"><a href="#E-Who-Says-a-Pun" class="headerlink" title="E - Who Says a Pun?"></a>E - Who Says a Pun?</h3><hr><p>åç¼€æ•°ç»„ + äºŒåˆ†ç»å…¸å¥½é¢˜ï¼ˆå¥—è·¯é¢˜ï¼‰ï¼Œå¯è§ POJ1743</p><h3 id="F-Xor-Sum-3"><a href="#F-Xor-Sum-3" class="headerlink" title="F - Xor Sum 3"></a>F - Xor Sum 3</h3><hr><p>ä¸€å¥è¯é¢˜æ„ï¼šè®¾åºåˆ—çš„å¼‚æˆ–å€¼ä¸º sumï¼Œæ±‚åˆ†ä¸¤å †ï¼Œä¸€å †å¼‚æˆ–å€¼ä¸º resï¼Œä½¿å¾— res + (sum ^ res) æœ€å¤§ã€‚</p><p>ä¸€çœ‹åˆ°å°±è§‰å¾—æ˜¯çº¿æ€§åŸºã€‚ã€‚ã€‚ç„¶é¹…å¹¶ä¸ä¼šåšï¼Œæœç„¶è¿˜æ˜¯å¤ªå¼±äº†ã€‚ã€‚ã€‚</p><p>ä½è¿ç®—çš„é¢˜åæœ‰å…«ä¹è¦æŒ‰ä½è®¨è®ºï¼æ¥ä¸€èµ·æƒ³æƒ³ï¼Œè‹¥ sum çš„ç¬¬ i ä½ä¸º 1ï¼Œé‚£ä¹ˆåˆ†çš„ä¸¤å †ä¸­å¿…ä¸€å †ä¸º 1 ä¸€å †ä¸º 0ï¼Œä¹Ÿå°±æ˜¯è¯´åº”å¿½ç•¥ i ä½ä¸º 1 çš„ä½ï¼›è‹¥ i ä½ä¸º 0ï¼Œé‚£ä¹ˆä¸¤å †ä¸­è¿™ä¸€ä½çš„è´¡çŒ®æ˜¯ç›¸åŒçš„ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªè¦æ‰¾ i ä½ä¸º 0 çš„æ•°çš„æœ€å¤§å¼‚æˆ–å€¼å°±å¥½å•¦ã€‚çº¿æ€§åŸºå¯ä»¥èƒœä»»ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, q[<span class="number">65</span>];</span><br><span class="line">ll a[N], sum, tot, p[<span class="number">65</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">1</span>, tot) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!(x &amp; (<span class="number">1l</span>l &lt;&lt; q[i]))) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (!p[i]) &#123; p[i] = x; <span class="keyword">break</span>; &#125;</span><br><span class="line">        x ^= p[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]), sum ^= a[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">60</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">if</span> (!((<span class="number">1l</span>l &lt;&lt; i) &amp; sum)) q[++tot] = i;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) insert(a[i]);</span><br><span class="line">    ll res = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, tot)</span><br><span class="line">        <span class="keyword">if</span> (!(res &amp; (<span class="number">1l</span>l &lt;&lt; q[i]))) res ^= p[i];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, res + (sum ^ res));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[WC2011]-æœ€å¤§XORå’Œè·¯å¾„</title>
      <link href="2019/08/18/%5BWC2011%5D-%E6%9C%80%E5%A4%A7XOR%E5%92%8C%E8%B7%AF%E5%BE%84/"/>
      <url>2019/08/18/%5BWC2011%5D-%E6%9C%80%E5%A4%A7XOR%E5%92%8C%E8%B7%AF%E5%BE%84/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.luogu.org/problem/P4151" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>å­¦äº†çº¿æ€§åŸºã€ã€æŒºå‹å¥½çš„ã€ã€ã€</p><p>é¦–å…ˆå¾ˆå®¹æ˜“å¾—å‡ºï¼Œä¸€ä¸ªç¯èµ°ä¸¤éæ²¡æœ‰æ„ä¹‰ï¼Œèµ°è¿‡ä¸€ä¸ªå­æ ‘ä¹Ÿæ²¡æœ‰æ„ä¹‰ï¼ˆå› ä¸ºä»»æ„ä¸€æ¡è¾¹éƒ½ä¼šèµ°è¿‡å»å†èµ°å›æ¥ï¼‰ï¼Œæ‰€ä»¥è·¯å¾„å¯ä»¥è¡¨ç¤ºä¸ºä¸€æ¡é“¾ + ä¸€äº›ç¯ã€‚</p><p>æˆ‘ä»¬æŠŠæ¯ä¸€ä¸ªç¯çš„ XOR å’Œä¸¢è¿›ä¸€ä¸ªçº¿æ€§åŸºé‡Œï¼Œç­”æ¡ˆå°±æ˜¯é“¾ä¸çº¿æ€§åŸºçš„æœ€å¤§å¼‚æˆ–å’Œã€‚</p><p>psï¼šé“¾ä¸ä¸€å®šè¦æ˜¯æœ€é•¿é“¾ã€‚å‡è®¾æœ‰é“¾ A å’Œé“¾ Bï¼Œä¸¤è€…æ„æˆäº† 1 ~ n ~ 1 çš„ä¸€ä¸ªç¯ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªç¯å¼‚æˆ–é“¾ A å°±èƒ½å¾—åˆ°é“¾ Bã€‚</p><p>æœ€è¿‘æœ‰è¿›æ­¥å‘€ï¼è‡ªå·±éƒ½èƒ½æƒ³æƒ³äº†ï¼ˆã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line">ll n, m, vis[N], mark[N];</span><br><span class="line">ll to[N &lt;&lt; <span class="number">1</span>], nxt[N &lt;&lt; <span class="number">1</span>], lnk[N], cnt;</span><br><span class="line">ll val[N &lt;&lt; <span class="number">1</span>], p[<span class="number">65</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, ll z)</span> </span>&#123;</span><br><span class="line">to[++cnt] = y, nxt[cnt] = lnk[x], lnk[x] = cnt, val[cnt] = z;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">63</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line"><span class="keyword">if</span> (!(x &amp; (<span class="number">1l</span>l &lt;&lt; i))) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span> (!p[i]) &#123; p[i] = x; <span class="keyword">break</span>; &#125;</span><br><span class="line">x ^= p[i];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">ll ret = x;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">63</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line"><span class="keyword">if</span> ((ret ^ p[i]) &gt; ret) ret ^= p[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, ll res)</span> </span>&#123;</span><br><span class="line">mark[x] = res, vis[x] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line"><span class="keyword">int</span> y = to[i];</span><br><span class="line"><span class="keyword">if</span> (!vis[y]) dfs(y, res ^ val[i]);</span><br><span class="line"><span class="keyword">else</span> insert(res ^ mark[y] ^ val[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// freopen("in.txt", "r", stdin);</span></span><br><span class="line"><span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line"><span class="keyword">int</span> x, y; ll z; <span class="built_in">scanf</span>(<span class="string">"%d%d%lld"</span>, &amp;x, &amp;y, &amp;z);</span><br><span class="line">addedge(x, y, z), addedge(y, x, z);</span><br><span class="line">&#125;</span><br><span class="line">dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, query(mark[n]));</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿æ€§åŸº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[ARC087]-E. Prefix-free game</title>
      <link href="2019/08/10/%5BARC087%5D-E.%20Prefix-free%20game/"/>
      <url>2019/08/10/%5BARC087%5D-E.%20Prefix-free%20game/</url>
      
        <content type="html"><![CDATA[<p><a href="https://atcoder.jp/contests/arc087/tasks/arc087_c" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>å¾ˆå¦™å•Šï¼æ—©çŸ¥é“ ARC è¿™ä¹ˆå¯å‘æ€ç»´çš„è¯å°±å»åšäº†å•Š qaqaq</p><p>å¯¹å­—ç¬¦ä¸²ç©åšå¼ˆå¥½åƒçš„ç¡®ä¸å¤ªå¯èƒ½ï¼Œä½†ç§»åˆ°å­—å…¸æ ‘ä¸Šå°±ä¸ä¸€æ ·äº†ã€‚æˆ‘ä»¬å‘ç°ï¼Œ</p>]]></content>
      
      
      
        <tags>
            
            <tag> åšå¼ˆ </tag>
            
            <tag> Trieæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Educational Codeforces Round 65</title>
      <link href="2019/07/30/Educational%20Codeforces%20Round%2065/"/>
      <url>2019/07/30/Educational%20Codeforces%20Round%2065/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/1167" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><h3 id="A-Telephone-Number"><a href="#A-Telephone-Number" class="headerlink" title="A. Telephone Number"></a>A. Telephone Number</h3><hr><p>ç­¾åˆ°é¢˜</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T, n;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">105</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (n &gt; <span class="number">11</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> pos = <span class="number">0</span>;</span><br><span class="line">            rep(i, <span class="number">1</span>, n)</span><br><span class="line">                <span class="keyword">if</span> (s[i] == <span class="string">'8'</span>) &#123; pos = i; <span class="keyword">break</span>; &#125;</span><br><span class="line">            <span class="keyword">if</span> (n - (pos - <span class="number">1</span>) &lt; <span class="number">11</span> || !pos) <span class="built_in">puts</span>(<span class="string">"NO"</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"YES"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (n == <span class="number">11</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[<span class="number">1</span>] != <span class="string">'8'</span>) <span class="built_in">puts</span>(<span class="string">"NO"</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"YES"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"NO"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-Lost-Numbers"><a href="#B-Lost-Numbers" class="headerlink" title="B. Lost Numbers"></a>B. Lost Numbers</h3><hr><p>ç¬¬ä¸€æ¬¡ B é¢˜æ˜¯äº¤äº’è¯¶ã€‚ã€‚</p><p>å¾ˆæš´åŠ›</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> a[<span class="number">10</span>] = &#123;<span class="number">0</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">23</span>, <span class="number">42</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> x, y, z, w, ans[<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">1</span>, <span class="number">6</span>) <span class="keyword">if</span> (a[i] == x) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"? 1 2\n"</span>); fflush(<span class="built_in">stdout</span>); <span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"? 3 4\n"</span>); fflush(<span class="built_in">stdout</span>); <span class="built_in">cin</span> &gt;&gt; y;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"? 1 3\n"</span>); fflush(<span class="built_in">stdout</span>); <span class="built_in">cin</span> &gt;&gt; z;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"? 1 5\n"</span>); fflush(<span class="built_in">stdout</span>); <span class="built_in">cin</span> &gt;&gt; w;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> tot = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, <span class="number">6</span>) tot *= a[i];</span><br><span class="line"></span><br><span class="line">    rep(i, <span class="number">1</span>, <span class="number">6</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x % a[i] == <span class="number">0</span> &amp;&amp; z % a[i] == <span class="number">0</span> &amp;&amp; w % a[i] == <span class="number">0</span> &amp;&amp; find(x / a[i]) &amp;&amp; find(z / a[i]) &amp;&amp; find(w / a[i])) &#123;</span><br><span class="line">            ans[<span class="number">1</span>] = a[i];</span><br><span class="line">            ans[<span class="number">2</span>] = x / a[i];</span><br><span class="line">            ans[<span class="number">3</span>] = z / a[i];</span><br><span class="line">            ans[<span class="number">4</span>] = y / ans[<span class="number">3</span>];</span><br><span class="line">            ans[<span class="number">5</span>] = w / a[i];</span><br><span class="line">            ans[<span class="number">6</span>] = tot / x / y / ans[<span class="number">5</span>];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"! %d %d %d %d %d %d\n"</span>, ans[<span class="number">1</span>], ans[<span class="number">2</span>], ans[<span class="number">3</span>], ans[<span class="number">4</span>], ans[<span class="number">5</span>], ans[<span class="number">6</span>]);</span><br><span class="line">    fflush(<span class="built_in">stdout</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-News-Distribution"><a href="#C-News-Distribution" class="headerlink" title="C. News Distribution"></a>C. News Distribution</h3><hr><p>é¢˜ç›®çœ‹åˆ°ä¸€åŠã€‚ã€‚å—¯ï¼Ÿï¼Ÿå†°èŒ¶å§¬ï¼Ÿï¼Ÿï¼Ÿ</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, a[N], fa[N], sum[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fa[w] == w ? w : fa[w] = getfa(fa[w]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    x = getfa(x), y = getfa(y);</span><br><span class="line">    <span class="keyword">if</span> (x != y)</span><br><span class="line">        fa[x] = y, sum[y] += sum[x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) fa[i] = i, sum[i] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">        <span class="keyword">int</span> lst = <span class="number">0</span>;</span><br><span class="line">        rep(j, <span class="number">1</span>, a[i]) &#123;</span><br><span class="line">            <span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">            <span class="keyword">if</span> (lst) merge(x, lst);</span><br><span class="line">            lst = x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">printf</span>(<span class="string">"%d "</span>, sum[getfa(i)]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D-Bicolored-RBS"><a href="#D-Bicolored-RBS" class="headerlink" title="D. Bicolored RBS"></a>D. Bicolored RBS</h3><hr><p>æ¯”è¾ƒæš´åŠ›çš„æ€æƒ³ï¼šç»´æŠ¤çº¢è‰²å’Œè“è‰²æ‹¬å·åºåˆ—çš„å‰ç¼€å’Œï¼Œç„¶å â€˜(â€˜ ä¼˜å…ˆç»™å‰ç¼€å’Œå°çš„ï¼Œâ€™)â€™ ä¼˜å…ˆç»™å‰ç¼€å’Œå¤§çš„</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, a[N], ans[N];</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>, y = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (s[i] == <span class="string">'('</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (x &lt; y) x++, ans[i] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">else</span> y++, ans[i] = <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (x &gt; y) x--, ans[i] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">else</span> y--, ans[i] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">printf</span>(<span class="string">"%d"</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="E-Range-Deleting"><a href="#E-Range-Deleting" class="headerlink" title="E. Range Deleting"></a>E. Range Deleting</h3><hr><p>èµ›åè¡¥é¢˜ï¼æŒºå¦™æ»´</p><p>å‘ç°ï¼Œåˆ é™¤çš„åŒºé—´è‹¥å·¦åŒºé—´å›ºå®šï¼Œå³åŒºé—´å‘ˆå•è°ƒæ€§ã€‚è®¾å¯¹äºä¸åŒçš„å·¦åŒºé—´ l_i, éƒ½æœ‰å³åŒºé—´ r_i, åˆ™ r_1 &lt;= r_2 &lt;= â€¦ &lt;= r_n, æ‰€ä»¥å¯ä»¥ç”¨äºŒåˆ†æˆ– two-pointers æ‰¾ r_i.</p><p>å¯ä»¥é¢„å¤„ç†æ¯ä¸ª a_i æœ€å·¦å’Œæœ€å³çš„ä½ç½®ï¼Œé¢„å¤„ç† 1 ~ i æœ€å³çš„ä½ç½® å’Œ i ~ x æœ€å·¦çš„ä½ç½®ï¼Œç”¨äºåœ¨æŸ¥æ‰¾ r_i æ—¶åˆ¤æ–­æŸéƒ¨åˆ†æ•°æ˜¯å¦å‘ˆéé€’å‡ã€‚</p><p>è‹¥åŒºé—´ [l, r] éƒ½å¯ä»¥åˆ é™¤ï¼Œé‚£ä¹ˆ [l, r + 1] ä¹Ÿå¯ä»¥åˆ é™¤ï¼Œæ‰€ä»¥æ­¤æ—¶å¯¹ç­”æ¡ˆäº§ç”Ÿè´¡çŒ® (n - r + 1).</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, x, a[N], l[N], r[N], L[N], R[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; x;</span><br><span class="line">    <span class="built_in">memset</span>(l, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(l));</span><br><span class="line">    <span class="built_in">memset</span>(L, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(L));</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">        l[a[i]] = min(l[a[i]], i);</span><br><span class="line">        r[a[i]] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = x; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">        L[i] = min(L[i + <span class="number">1</span>], l[i]);</span><br><span class="line">    rep(i, <span class="number">1</span>, x)</span><br><span class="line">        R[i] = max(R[i - <span class="number">1</span>], r[i]);</span><br><span class="line">    <span class="keyword">int</span> k = x;</span><br><span class="line">    <span class="keyword">for</span> (; k &gt; <span class="number">1</span> &amp;&amp; r[k] &lt;= L[k + <span class="number">1</span>]; --k);  <span class="comment">// è¦åˆ é™¤çš„åŒºé—´æ˜¯ [1, k]</span></span><br><span class="line">    ll ans = x - k + <span class="number">1</span>;  <span class="comment">// äº§ç”Ÿè´¡çŒ®</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= x &amp;&amp; R[i - <span class="number">2</span>] &lt;= l[i - <span class="number">1</span>]; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (; k &lt; i || R[i - <span class="number">1</span>] &gt; L[k + <span class="number">1</span>]; ++k);  <span class="comment">// è¦åˆ é™¤çš„åŒºé—´æ˜¯ [i, k]</span></span><br><span class="line">        ans += x - k + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="F-Scalar-Queries"><a href="#F-Scalar-Queries" class="headerlink" title="F. Scalar Queries"></a>F. Scalar Queries</h3><hr><p>å› ä¸ºæ˜¯ vp çš„ï¼Œï¼Œåˆ°ç‚¹å„¿äº†å°±è¦åƒé¥­å»ï¼Œï¼ŒæŠµä¸ä½åä¸‰é¦™å¤§è™¾ğŸ¤çš„è¯±æƒ‘ [æ‚è„¸] F é¢˜åªæ˜¯æœ‰äº†åˆæ­¥æ€è·¯ï¼Œï¼Œï¼Œï¼Œï¼Œ</p><p>åæ¥æ˜¯çœ‹é¢˜è§£çš„ã€‚ã€‚å¥½é¢˜ã€‚ã€‚ã€‚</p><p>å˜ç›¸ç†è§£é¢˜æ„å°±æ˜¯ï¼šå¦‚æœ a å’Œ b åœ¨ä¸€ä¸ªåŒºé—´ [l, r] é‡Œä¸” a &lt; b, é‚£ä¹ˆå°±ä¼šå¯¹ f(l, r) äº§ç”Ÿ b çš„è´¡çŒ®ï¼ˆa å’Œ b å¯¹ f(l, r) çš„åˆå§‹è´¡çŒ®åˆ†åˆ«æ˜¯ a å’Œ b</p><ul><li>a[i] å’Œ a[j] åœ¨ä¸€ä¸ªåŒºé—´çš„æƒ…å†µæ•° å…±æœ‰ $i * (n - j + 1)$ ç§</li></ul><p>å¦‚æœåœ¨ a[i] çš„å‰é¢æœ‰ä¸ªæ¯” a[i] å°çš„æ•° a[j]ï¼Œé‚£ä¹ˆ a[j] å¯¹ a[i] ç³»æ•°çš„è´¡çŒ®åº”è¯¥ç­‰äºåŒ…å« a[i] å’Œ a[j] çš„åŒºé—´æ•°é‡ï¼Œå³ $j*(n-i+1)$</p><p>å¦‚æœåœ¨ a[i] çš„å‰é¢æœ‰ä¸ªæ¯” a[i] å°çš„æ•° a[j]ï¼ŒåŒä¸Šï¼Œè´¡çŒ®ç­‰äº $i*(n-j+1)$</p><p>æ‰€ä»¥æˆ‘ä»¬ç°åœ¨éœ€è¦ç»´æŠ¤æ¯” a[i] å°çš„æ•°çš„ä¿¡æ¯ï¼Œé‚£ä¹ˆå¯¹ a[i] æƒå€¼æ’åºï¼Œå¯ä»¥ç”¨ä¸¤ä¸ªæ ‘çŠ¶æ•°ç»„å®ç°ï¼Œåˆ†åˆ«ç»´æŠ¤ä¸Šè¿°ä¸¤ç§æƒ…å†µã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¸€ç‚¹å„¿æ”¶è·ï¼šå¯¹äºè¿™æ ·çš„é¢˜ï¼Œè‚¯å®šè¦ O(n) æˆ– O(n <span class="built_in">log</span> n) è§£å†³ï¼Œåªèƒ½æ•°æ®ç»“æ„å‡ºåœºï¼Œæ¯”å¦‚æ ‘çŠ¶æ•°ç»„ã€‚ä¸ºäº†ä¿æŒ â€œå€¼å°çš„ä¼˜å…ˆå¤„ç†â€ çš„é¡ºåºï¼Œæˆ‘ä»¬éœ€è¦æŒ‰ç…§å€¼çš„å¤§å°æ’åºã€‚</span><br></pre></td></tr></table></figure><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lowbit(x) ((x) &amp; (-(x)))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span> + <span class="number">10</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    ll w, id;</span><br><span class="line">&#125;a[N];</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node a, node b)</span> </span>&#123; <span class="keyword">return</span> a.w &lt; b.w; &#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BIT</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> C[N];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, ll val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (; x &lt;= n; x += lowbit(x)) &#123;</span><br><span class="line">            C[x] += val;</span><br><span class="line">            <span class="keyword">if</span> (C[x] &gt;= mod) C[x] -= mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        ll ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (; x; x -= lowbit(x)) &#123;</span><br><span class="line">            ret += C[x];</span><br><span class="line">            <span class="keyword">if</span> (ret &gt;= mod) ret -= mod;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;l, r;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i].w);</span><br><span class="line">        a[i].id = i;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(a + <span class="number">1</span>, a + n + <span class="number">1</span>, cmp);</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        ll sum = a[i].id * (n - a[i].id + <span class="number">1</span>) % mod;</span><br><span class="line">        sum = (sum + l.query(a[i].id) * (n - a[i].id + <span class="number">1</span>) % mod) % mod;</span><br><span class="line">        sum = (sum + (r.query(n) - r.query(a[i].id) + mod) % mod * a[i].id % mod) % mod;</span><br><span class="line">        l.add(a[i].id, a[i].id);</span><br><span class="line">        r.add(a[i].id, n - a[i].id + <span class="number">1</span>);</span><br><span class="line">        ans = (ans + a[i].w * sum % mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 561 Div2</title>
      <link href="2019/07/28/Codeforces%20Round%20561%20Div2/"/>
      <url>2019/07/28/Codeforces%20Round%20561%20Div2/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/1166" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><h3 id="A-Silent-Classroom"><a href="#A-Silent-Classroom" class="headerlink" title="A. Silent Classroom"></a>A. Silent Classroom</h3><hr><p>ç­¾åˆ°é¢˜</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, num[<span class="number">30</span>], ans;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">30</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>), num[s[<span class="number">1</span>] - <span class="string">'a'</span>]++;</span><br><span class="line">    rep(i, <span class="number">0</span>, <span class="number">25</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = num[i] / <span class="number">2</span>, y = num[i] - x;</span><br><span class="line">        ans += (x * (x - <span class="number">1</span>) / <span class="number">2</span>) + (y * (y - <span class="number">1</span>) / <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-All-the-Vowels-Please"><a href="#B-All-the-Vowels-Please" class="headerlink" title="B. All the Vowels Please"></a>B. All the Vowels Please</h3><hr><p>é¢˜æ„ï¼šæ¯è¡Œæ¯åˆ—éƒ½å¾—æœ‰ a e i o u</p><p>ç¨å¾®æ„é€ ä¸‹å°±å¥½å•¦</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, x, y;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= n; i++) <span class="keyword">if</span> (n % i == <span class="number">0</span>) x = i, y = n / i;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">5</span> || y &lt; <span class="number">5</span>) &#123; <span class="built_in">puts</span>(<span class="string">"-1"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line"></span><br><span class="line">    rep(i, <span class="number">1</span>, x) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">5</span> == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"aeiou"</span>);</span><br><span class="line">            rep(j, <span class="number">1</span>, y - <span class="number">5</span>) <span class="built_in">printf</span>(<span class="string">"a"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i % <span class="number">5</span> == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"eioua"</span>);</span><br><span class="line">            rep(j, <span class="number">1</span>, y - <span class="number">5</span>) <span class="built_in">printf</span>(<span class="string">"e"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i % <span class="number">5</span> == <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"iouae"</span>);</span><br><span class="line">            rep(j, <span class="number">1</span>, y - <span class="number">5</span>) <span class="built_in">printf</span>(<span class="string">"i"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i % <span class="number">5</span> == <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"ouaei"</span>);</span><br><span class="line">            rep(j, <span class="number">1</span>, y - <span class="number">5</span>) <span class="built_in">printf</span>(<span class="string">"o"</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i % <span class="number">5</span> == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"uaeio"</span>);</span><br><span class="line">            rep(j, <span class="number">1</span>, y - <span class="number">5</span>) <span class="built_in">printf</span>(<span class="string">"u"</span>);</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-A-Tale-of-Two-Lands"><a href="#C-A-Tale-of-Two-Lands" class="headerlink" title="C. A Tale of Two Lands"></a>C. A Tale of Two Lands</h3><hr><p>æ¨ä¸ç­‰å¼</p><p>(x2 = x^2)</p><p>min(|x - y|, |x + y|) &lt;= |x|, |y| &lt;= max(|x - y|, |x + y|)</p><p>|x|2 + |y|2 - 2|x||y| &lt;= |x|2, |y|2 &lt;= |x|2 + |y|2 + 2|x||y|</p><p>2|x| &gt;= |y|, |x| &gt;= -2|y|</p><p>æ€»è€Œè¨€ä¹‹å°±æ˜¯ 2|x| &gt;= |y|, upper_bound() æä¸€æå°± ACï¼Œï¼Œ</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, a[N];</span><br><span class="line">ll ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]), a[i] = <span class="built_in">fabs</span>(a[i]);</span><br><span class="line">    sort(a + <span class="number">1</span>, a + n + <span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">int</span> tmp = upper_bound(a + <span class="number">1</span>, a + n + <span class="number">1</span>, <span class="number">2</span> * a[i]) - a;</span><br><span class="line">        <span class="keyword">if</span> (tmp &gt; n) tmp = n;</span><br><span class="line">        <span class="keyword">if</span> (a[tmp] &gt; <span class="number">2</span> * a[i]) tmp--;</span><br><span class="line">        ans += tmp - i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D-Cute-Sequences"><a href="#D-Cute-Sequences" class="headerlink" title="D. Cute Sequences"></a>D. Cute Sequences</h3><hr><p>æœ‰è¶£åˆæ¶å¿ƒçš„æ„é€ ï¼æ˜¯èµ›åè¡¥çš„</p><p>ä¸»è¦çœ‹ <a href="https://www.cnblogs.com/megalovania/p/10888493.html" target="_blank" rel="noopener">è¿™ä½å¤§ä½¬</a> çš„ï¼Œè¿™è¾¹è¡¥å……è¯´æ˜ä¸‹ï¼š</p><ul><li><p>r_i å¯¹ x_j (j &gt;= i) çš„è´¡çŒ®æˆ‘ä»¬å‘ç°æ˜¯ 1ï¼Œ2ï¼Œ4ï¼Œ8ï¼Œâ€¦ è¿™æ ·çš„</p></li><li><p>æ­¤å¤„çš„è´¡çŒ®å¯ä»¥ç†è§£ä¸ºï¼šåœ¨ä½ç½® i åŠ ä¸€ï¼Œä½ç½® j (j &gt;= i) ä¼šåŠ ä¸Šå¤šå°‘ï¼Ÿ</p></li><li><p>åœ¨ â€œå‡å›æ¥â€ çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä»æ•°åˆ—ä¸­é å‰çš„ä½ç½®å¼€å§‹ï¼Œå› ä¸ºè¶Šé å‰ï¼Œå¯¹åé¢çš„å½±å“åŠ›è¶Šå¤§</p></li></ul><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">55</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, q;</span><br><span class="line">ll l[N], r[N], prel[N], prer[N], pre[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    pre[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, <span class="number">50</span>) rep(j, <span class="number">0</span>, i - <span class="number">1</span>) pre[i] += pre[j];  <span class="comment">// é¢„å¤„ç†å½±å“</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; q;</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        ll a, b, m;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b &gt;&gt; m;</span><br><span class="line">        prel[<span class="number">1</span>] = l[<span class="number">1</span>] = prer[<span class="number">1</span>] = r[<span class="number">1</span>] = a;</span><br><span class="line">        <span class="keyword">if</span> (a == b) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"1 %lld\n"</span>, a); <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; ; i++) &#123;</span><br><span class="line">            l[i] = prel[i - <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">            r[i] = prer[i - <span class="number">1</span>] + m;</span><br><span class="line">            prel[i] = prel[i - <span class="number">1</span>] + l[i];</span><br><span class="line">            prer[i] = prer[i - <span class="number">1</span>] + r[i];</span><br><span class="line">            <span class="keyword">if</span> (r[i] &gt;= b) &#123; n = i; <span class="keyword">break</span>; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (l[n] &gt; b) &#123; <span class="built_in">puts</span>(<span class="string">"-1"</span>); <span class="keyword">continue</span>; &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, n);</span><br><span class="line">        rep(i, <span class="number">2</span>, n)</span><br><span class="line">            <span class="keyword">if</span> (r[n] &gt; b) &#123;</span><br><span class="line">                ll d = min(m - <span class="number">1</span>, (r[n] - b) / pre[n - i]);</span><br><span class="line">                rep(j, i, n) r[j] -= d * pre[j - i];</span><br><span class="line">            &#125;</span><br><span class="line">        rep(i, <span class="number">1</span>, n) <span class="built_in">printf</span>(<span class="string">"%lld "</span>, r[i]); <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="E-The-LCMs-Must-be-Large"><a href="#E-The-LCMs-Must-be-Large" class="headerlink" title="E. The LCMs Must be Large"></a>E. The LCMs Must be Large</h3><hr><p>ç»“è®ºé¢˜å¥½å“‡ï¼</p><p>å¾ˆå®¹æ˜“è¯æ˜ï¼Œå¦‚æœæœ‰ä¸¤å¤©çš„è´­ä¹°ç‰©å“çš„é›†åˆå®Œå…¨ä¸åŒï¼Œç­”æ¡ˆä¸å­˜åœ¨ï¼šlcm(Si) &gt; lcm(U - Si) &gt;= lcm(Sj) &gt; lcm(U - Sj) &gt;= lcm(Si) ï¼ˆå…¶ä¸­ Sx è¡¨ç¤ºä¸€ä¸ªé›†åˆï¼‰ è¿™æ˜¯ä¸å¯èƒ½æ»´ï¼</p><p>å¦‚ä½•è¯æ˜è‹¥ä»»æ„ä¸¤å¤©è´­ä¹°é›†åˆéƒ½æœ‰äº¤é›†ï¼Œåˆ™å¿…ç„¶å­˜åœ¨ç­”æ¡ˆå‘¢ï¼Ÿå¯ä»¥è¿™æ ·ï¼šå…ˆæŠŠæ•°ç»„ a ç½®ä¸º 1ï¼ŒæŠŠ a ä¸­ç¬¬ä¸€å¤©è´­ä¹°é›†åˆä¹˜ä»¥è´¨æ•° p1ï¼ŒæŠŠ a ä¸­ç¬¬äºŒå¤©è´­ä¹°é›†åˆä¹˜ä»¥è´¨æ•° p2ï¼Œå°±æ˜¯ä¸€ç»„ç¬¦åˆè¦æ±‚çš„æ•°å­—ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, s[<span class="number">55</span>], mark[<span class="number">55</span>][<span class="number">10010</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; s[i];</span><br><span class="line">        rep(j, <span class="number">1</span>, s[i]) &#123;</span><br><span class="line">            <span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">            mark[i][x] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rep(j, <span class="number">1</span>, i - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">            rep(k, <span class="number">1</span>, m) <span class="keyword">if</span> (mark[i][k] &amp;&amp; mark[j][k]) cnt++;</span><br><span class="line">            <span class="keyword">if</span> (!cnt) &#123; <span class="built_in">puts</span>(<span class="string">"impossible"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"possible"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 574 Div2</title>
      <link href="2019/07/25/Codeforces%20Round%20574%20Div2/"/>
      <url>2019/07/25/Codeforces%20Round%20574%20Div2/</url>
      
        <content type="html"><![CDATA[<h3 id="A-Drinks-Choosing"><a href="#A-Drinks-Choosing" class="headerlink" title="A. Drinks Choosing"></a>A. Drinks Choosing</h3><hr><p>å°±æ˜¯æœ¬ç€å°½é‡åˆ«æµªè´¹çš„åŸåˆ™ã€‚ã€‚</p><p>ç­¾åˆ°é¢˜ç¡¬æ˜¯è¯»äº† N éé¢˜æ„ã€‚ã€‚è‹±è¯­ä¸è¡Œå•Š</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, k, num[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">int</span> x; <span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">        num[x]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> tot = (n + <span class="number">1</span>) / <span class="number">2</span>, ans = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, k) &#123;</span><br><span class="line">        ans += num[i] / <span class="number">2</span> * <span class="number">2</span>;</span><br><span class="line">        tot -= num[i] / <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ans += tot;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-Sport-Mafia"><a href="#B-Sport-Mafia" class="headerlink" title="B. Sport Mafia"></a>B. Sport Mafia</h3><hr><p>è§£äº†ä¸ªäºŒå…ƒä¸€æ¬¡æ–¹ç¨‹ï¼ˆå™—</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, k;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    ll a = <span class="number">1</span>, b = -(n + <span class="number">1</span> + n) - <span class="number">2</span>, c = (n + <span class="number">1</span>) * n - <span class="number">2</span> * k;</span><br><span class="line">    ll tmp = b * b - <span class="number">4</span> * a * c;</span><br><span class="line">    tmp = (ll)<span class="built_in">sqrt</span>(tmp);</span><br><span class="line">    ll ans1 = (-b + tmp) / (<span class="number">2</span> * a), ans2 = (-b - tmp) / (<span class="number">2</span> * a);</span><br><span class="line">    <span class="keyword">if</span> (ans2 &gt;= <span class="number">0</span>) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans2);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans1);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-Basketball-Exercise"><a href="#C-Basketball-Exercise" class="headerlink" title="C. Basketball Exercise"></a>C. Basketball Exercise</h3><hr><p>DP? å¾ˆç®€å•</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, a[N], b[N], dp[N][<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;b[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        dp[i][<span class="number">0</span>] = max(dp[i - <span class="number">1</span>][<span class="number">1</span>], dp[i - <span class="number">1</span>][<span class="number">2</span>]) + a[i];</span><br><span class="line">        dp[i][<span class="number">1</span>] = max(dp[i - <span class="number">1</span>][<span class="number">0</span>], dp[i - <span class="number">1</span>][<span class="number">2</span>]) + b[i];</span><br><span class="line">        dp[i][<span class="number">2</span>] = max(dp[i - <span class="number">1</span>][<span class="number">0</span>], max(dp[i - <span class="number">1</span>][<span class="number">1</span>], dp[i - <span class="number">1</span>][<span class="number">2</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, max(dp[n][<span class="number">0</span>], max(dp[n][<span class="number">1</span>], dp[n][<span class="number">2</span>])));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D1-Submarine-in-the-Rybinsk-Sea-easy-edition"><a href="#D1-Submarine-in-the-Rybinsk-Sea-easy-edition" class="headerlink" title="D1. Submarine in the Rybinsk Sea (easy edition)"></a>D1. Submarine in the Rybinsk Sea (easy edition)</h3><hr><p>è€ƒè™‘æŒ‰ä½å¤„ç†</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>, N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, a[N], num[<span class="number">30</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]);</span><br><span class="line">        ll x = a[i];</span><br><span class="line">        <span class="keyword">int</span> pos = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (x) &#123;</span><br><span class="line">            num[pos * <span class="number">2</span> - <span class="number">1</span>] = (num[pos * <span class="number">2</span> - <span class="number">1</span>] + (x % <span class="number">10</span>) * n) % mod;</span><br><span class="line">            num[pos * <span class="number">2</span>] = (num[pos * <span class="number">2</span>] + (x % <span class="number">10</span>) * n) % mod;</span><br><span class="line">            x /= <span class="number">10</span>;</span><br><span class="line">            pos++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, <span class="number">20</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (num[i]) len = i;</span><br><span class="line">        num[i + <span class="number">1</span>] += num[i] / <span class="number">10</span>;</span><br><span class="line">        num[i] %= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (num[len + <span class="number">1</span>]) ++len;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &gt;= <span class="number">1</span>; i--) &#123;</span><br><span class="line">        ans = (ans * <span class="number">10</span> + num[i]) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D2-Submarine-in-the-Rybinsk-Sea-hard-edition"><a href="#D2-Submarine-in-the-Rybinsk-Sea-hard-edition" class="headerlink" title="D2. Submarine in the Rybinsk Sea (hard edition)"></a>D2. Submarine in the Rybinsk Sea (hard edition)</h3><hr><p>é¢„å¤„ç†ç¬¬ i ä¸ªæ•°å’Œé•¿åº¦ä¸º j çš„ä¸²åœ¨ä¸€èµ·çš„è´¡çŒ®ï¼Œè¿˜æ˜¯æŒ‰ä½å¤„ç†</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>, N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, a[N], num[<span class="number">30</span>], len[<span class="number">15</span>], pw[<span class="number">35</span>], f[N][<span class="number">12</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line"></span><br><span class="line">    pw[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, <span class="number">30</span>) pw[i] = pw[i - <span class="number">1</span>] * <span class="number">10</span> % mod;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) </span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        ll x = a[i];</span><br><span class="line">        <span class="keyword">int</span> pos = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (x) &#123;</span><br><span class="line">            x /= <span class="number">10</span>; pos++;</span><br><span class="line">        &#125;</span><br><span class="line">        len[pos]++;</span><br><span class="line">        rep(j, <span class="number">1</span>, <span class="number">10</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (pos &gt;= j) &#123;</span><br><span class="line">                ll tmp = a[i];</span><br><span class="line">                rep(k, <span class="number">0</span>, j - <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">int</span> x = tmp % <span class="number">10</span>; tmp /= <span class="number">10</span>;</span><br><span class="line">                    f[i][j] = (((f[i][j] + <span class="number">1l</span>l * x * pw[k * <span class="number">2</span>] % mod) % mod) + <span class="number">1l</span>l * x * pw[k * <span class="number">2</span> + <span class="number">1</span>] % mod) % mod;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">int</span> p = <span class="number">2</span> * j;</span><br><span class="line">                rep(k, j, pos - <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">int</span> x = tmp % <span class="number">10</span>; tmp /= <span class="number">10</span>;</span><br><span class="line">                    f[i][j] = (f[i][j] + <span class="number">2l</span>l * x * pw[p] % mod) % mod;</span><br><span class="line">                    ++p;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> tmp = a[i];</span><br><span class="line">                rep(k, <span class="number">0</span>, pos - <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">int</span> x = tmp % <span class="number">10</span>; tmp /= <span class="number">10</span>;</span><br><span class="line">                    f[i][j] = (((f[i][j] + <span class="number">1l</span>l * x * pw[k * <span class="number">2</span>] % mod) % mod) + <span class="number">1l</span>l * x * pw[k * <span class="number">2</span> + <span class="number">1</span>] % mod) % mod;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        rep(j, <span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line">            ans = (ans + <span class="number">1l</span>l * f[i][j] * len[j] % mod) % mod;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="E-OpenStreetMap"><a href="#E-OpenStreetMap" class="headerlink" title="E. OpenStreetMap"></a>E. OpenStreetMap</h3><hr><p>åŸºç¡€å¥—è·¯é¢˜ï¼å•è°ƒé˜Ÿåˆ—å°±å¯ä»¥</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;ll, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">int</span> n, m, a, b;</span><br><span class="line">ll g, x, y, z, mp[N][N], f[N][N];</span><br><span class="line"><span class="built_in">deque</span>&lt;pii&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; g &gt;&gt; x &gt;&gt; y &gt;&gt; z;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) rep(j, <span class="number">1</span>, m) &#123;</span><br><span class="line">        mp[i][j] = g; g = (<span class="number">1l</span>l * g * x % z + y) % z;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">while</span> (!q.empty()) q.pop_back();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = m; j &gt;= <span class="number">1</span>; j--) &#123;</span><br><span class="line">            <span class="keyword">while</span> (q.size() &amp;&amp; mp[i][j] &lt; q.front().first) q.pop_front();</span><br><span class="line">            q.push_front(make_pair(mp[i][j], j));</span><br><span class="line">            f[i][j] = q.back().first;</span><br><span class="line">            <span class="keyword">while</span> (!q.empty() &amp;&amp; q.back().second &gt;= j + b - <span class="number">1</span>) q.pop_back();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">1</span>, m) mp[i][j] = f[i][j];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    rep(j, <span class="number">1</span>, m) &#123;</span><br><span class="line">        <span class="keyword">while</span> (q.size()) q.pop_back();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; i--) &#123;</span><br><span class="line">            <span class="keyword">while</span> (q.size() &amp;&amp; mp[i][j] &lt; q.front().first) q.pop_front();</span><br><span class="line">            q.push_front(make_pair(mp[i][j], i));</span><br><span class="line">            f[i][j] = q.back().first;</span><br><span class="line">            <span class="keyword">while</span> (q.size() &amp;&amp; q.back().second &gt;= i + a - <span class="number">1</span>) q.pop_back();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n - a + <span class="number">1</span>) rep(j, <span class="number">1</span>, m - b + <span class="number">1</span>) ans += f[i][j];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="F-Geometers-Anonymous-Club"><a href="#F-Geometers-Anonymous-Club" class="headerlink" title="F. Geometers Anonymous Club"></a>F. Geometers Anonymous Club</h3><hr><p>è¡¥äº† Fï¼</p><p>é¢˜æ„å°±æ˜¯è®©ä½ å¯¹ä¸€ä¸ªåŒºé—´å†…çš„å‡¸åŒ…è¿›è¡Œé—µå¯å¤«æ–¯åŸºæ±‚å’Œã€‚</p><p>æœ‰ä¸€ä¸ªé—µå¯å¤«æ–¯åŸºæ±‚å’Œçš„å®šç†ï¼Œå°±æ˜¯ n ä¸ªæ–¹å‘ä¸åŒçš„å‘é‡å½¢æˆçš„å‡¸åŒ…æœ‰ n ä¸ªé¡¶ç‚¹ã€‚</p><p>ç¦»çº¿å¤„ç†ï¼Œç”¨æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ã€‚æ³¨æ„ï¼Œå¤šç‚¹ä¸€çº¿è¿™ç§æƒ…å†µè¦å¤„ç†ï¼è§ä»£ç ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lowbit(x) ((x) &amp; (-(x)))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span> + <span class="number">10</span>, inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">int</span> n, q, l[N], r[N], C[N], ans[N];</span><br><span class="line"><span class="built_in">map</span>&lt;pii, <span class="keyword">int</span>&gt; mp;</span><br><span class="line"><span class="built_in">vector</span>&lt;pii&gt; ve, tmp, query;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; t[N];</span><br><span class="line"></span><br><span class="line"><span class="function">pii <span class="title">get_dir</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;  <span class="comment">// å¤„ç†å¤šç‚¹ä¸€çº¿çš„æƒ…å†µ</span></span><br><span class="line">    <span class="keyword">int</span> gcd = __gcd(<span class="built_in">abs</span>(x), <span class="built_in">abs</span>(y));</span><br><span class="line">    <span class="keyword">if</span> (gcd) x /= gcd, y /= gcd;</span><br><span class="line">    <span class="keyword">return</span> make_pair(x, y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (; x &lt;= N; x += lowbit(x)) C[x] += val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_sum</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (; x; x -= lowbit(x)) ret += C[x];</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    ve.push_back(make_pair(<span class="number">-1</span>, <span class="number">-1</span>));</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        <span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">        rep(j, <span class="number">1</span>, x) &#123;</span><br><span class="line">            <span class="keyword">int</span> a, b; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;a, &amp;b);</span><br><span class="line">            tmp.push_back(make_pair(a, b));</span><br><span class="line">        &#125;</span><br><span class="line">        l[i] = ve.size();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; tmp.size(); j++)</span><br><span class="line">            ve.push_back(get_dir(tmp[j].first - tmp[(j + <span class="number">1</span>) % tmp.size()].first, tmp[j].second - tmp[(j + <span class="number">1</span>) % tmp.size()].second));</span><br><span class="line">        tmp.clear();</span><br><span class="line">        r[i] = ve.size() - <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;q);</span><br><span class="line">    rep(i, <span class="number">1</span>, q) &#123;</span><br><span class="line">        <span class="keyword">int</span> a, b; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;a, &amp;b);</span><br><span class="line">        pii temp = make_pair(l[a], r[b]);</span><br><span class="line">        query.push_back(temp);</span><br><span class="line">        t[temp.second].push_back(i - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; ve.size(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mp.count(ve[i])) add(mp[ve[i]], <span class="number">-1</span>);</span><br><span class="line">        add(i, <span class="number">1</span>);</span><br><span class="line">        mp[ve[i]] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; t[i].size(); j++)</span><br><span class="line">            ans[t[i][j]] = get_sum(query[t[i][j]].second) - get_sum(query[t[i][j]].first - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    rep(i, <span class="number">0</span>, q - <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NOI2019åŒæ­¥èµ›ä½“éªŒ&amp;æ„Ÿæƒ³</title>
      <link href="2019/07/24/NOI2019%E5%90%8C%E6%AD%A5%E8%B5%9B%E4%BD%93%E9%AA%8C&amp;%E6%84%9F%E6%83%B3/"/>
      <url>2019/07/24/NOI2019%E5%90%8C%E6%AD%A5%E8%B5%9B%E4%BD%93%E9%AA%8C&amp;%E6%84%9F%E6%83%B3/</url>
      
        <content type="html"><![CDATA[<p>(&gt;ï¹&lt;) ä»Šå¹´æš´åŠ›åˆ†æ¯”å»å¹´è¶³è¯¶ï¼ï¼ï¼ˆæš´åŠ›é€‰æ‰‹çœŸå¿ƒè¯</p><hr><p>æ¥è¡¥é¢˜è§£å•¦ï¼Œç”±äºå’•å’•äº†å¾ˆä¹…æ‰€ä»¥å·²ç»å¿˜è®°é¢˜ç›®é¡ºåºå•¦</p><h2 id="å›å®¶è·¯çº¿"><a href="#å›å®¶è·¯çº¿" class="headerlink" title="$å›å®¶è·¯çº¿$"></a>$å›å®¶è·¯çº¿$</h2><p>åŒæ­¥èµ›æ—¶å†™äº†ä»¥è¾¹ä¸ºç‚¹çš„ $O(m^2)$ æœ€çŸ­è·¯ã€‚å¬è¯´æ•°æ®å¾ˆæ°´ï¼Œemm</p><p>$p &lt; q$ï¼Œæ˜¾ç„¶ä¸ä¼šæ„æˆç¯ï¼Œdp å°±è¡Œäº†</p><p>æ­£è§£æ˜¯æ–œç‡ä¼˜åŒ– dpï¼Œ$f[i]$ è¡¨ç¤ºèµ°äº†ç¬¬ $i$ æ¡è¾¹çš„æœ€å°çƒ¦èºå€¼ã€‚$f[i] = min(f[j] + calc(p_i - q_j)(y_j = x_i, q_j \leq p_i))$</p><p>å¯¹äºæœ€ä¼˜è§£ $j$, $f[j] + Ap_j^2 - Bq_j = 2Ap_iq_j + f[i] - Ap_i^2 - Bp_i - C$</p><p>å…¶ä¸­ $y = f[j] + Ap_j^2 - Bq_j$, </p><p>$k = 2Ap_i$, </p><p>$x = q_j$, </p><p>$b = f_i - Ap_i^2 - Bp_i - C$</p><p>è¦ $f_i$ å°å°±æ˜¯è¦æˆªè·å°ï¼Œå› æ­¤ç»´æŠ¤ä¸€ä¸ªä¸‹å‡¸åŒ…</p><p>ä»¥æ—¶é—´ä¸ºé˜¶æ®µï¼Œç»´æŠ¤ $t$ æ—¶é—´å†…çš„å‡¸åŒ…é›†åˆï¼Œå³é›†åˆå†…å†³ç­–ç‚¹æ»¡è¶³ $q_i \leq t$. æ¡¶æ’ï¼Œå°†å†³ç­–ç‚¹ $j$ åœ¨æ—¶åˆ» $q_j$ åŠ å…¥å‡¸åŒ… $y_j$ ä¸­ã€‚æ¯ä¸ªå‡¸åŒ…æ»¡è¶³ $q$ é€’å¢ã€‚</p><p>RE è°ƒåŠå¤©ï¼Œå‘ç°æ•°ç»„æ²¡å¼€è¶³ã€‚ã€‚ã€‚</p><h2 id="åºåˆ—"><a href="#åºåˆ—" class="headerlink" title="$åºåˆ—$"></a>$åºåˆ—$</h2>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€ä¹ é¢˜é€‰è®²ã€‘ä¸€äº›ã€Œæœ‰è¶£ã€çš„è®¡æ•°é¢˜</title>
      <link href="2019/07/12/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91%E4%B8%80%E4%BA%9B%E3%80%8C%E6%9C%89%E8%B6%A3%E3%80%8D%E7%9A%84%E8%AE%A1%E6%95%B0%E9%A2%98/"/>
      <url>2019/07/12/%E3%80%90%E4%B9%A0%E9%A2%98%E9%80%89%E8%AE%B2%E3%80%91%E4%B8%80%E4%BA%9B%E3%80%8C%E6%9C%89%E8%B6%A3%E3%80%8D%E7%9A%84%E8%AE%A1%E6%95%B0%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>éƒ½æ˜¯ 2019 æš‘æœŸè®­ç»ƒé¢˜ï½</p><h2 id="ç‡•å½’å·¢-swalllow"><a href="#ç‡•å½’å·¢-swalllow" class="headerlink" title="ç‡•å½’å·¢(swalllow)"></a>ç‡•å½’å·¢(swalllow)</h2><hr><p>æšä¸¾ä¸åŒå½¢æ€çš„æ ‘æ˜¾ç„¶ä¸å¯èƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä¸€æ¡è¾¹çš„è´¡çŒ®ï¼ˆè¿™åœ¨ä¹‹åçš„è®¡æ•°é¢˜æ˜¯å¾ˆå¸¸ç”¨çš„æŠ€å·§ï¼Œå¯ä»¥è¯´æ˜¯å¥—è·¯äº†ï¼Œä¸€å®šè¦æŒæ¡ï¼</p><p>å…ˆå°†ç»“ç‚¹åˆ†ä¸ºå·¦å³ä¸¤ä¸ªé›†åˆï¼Œæšä¸¾å·¦è¾¹é›†åˆç‚¹æ•° iï¼Œé‚£ä¹ˆå³è¾¹é›†åˆç‚¹æ•°åˆ™ä¸º n - iï¼›</p><p>é€‰æ‹©å·¦è¾¹ç‚¹é›†å…±æœ‰ C(n - 1, i - 1) ç§æ–¹æ³•ï¼ˆæ³¨æ„è¦å‡ä¸€ï¼å› ä¸ºè¿æ¥ä¸¤ä¸ªé›†åˆçš„è¾¹ï¼Œä¹Ÿå°±æ˜¯è¢«è€ƒè™‘è´¡çŒ®çš„è¾¹ï¼Œå®ƒçš„ä¸€ç«¯æ˜¯ä¸è¢«è®¡å…¥çš„ï¼‰ï¼›</p><p>å·¦è¾¹å½¢æˆçš„æ ‘æœ‰ i ^ {i - 2} ç§å½¢æ€ï¼Œå³è¾¹å½¢æˆçš„æ ‘æœ‰ (n - i) ^ {n - i - 2} ç§å½¢æ€ï¼›</p><p>é€‰æ‹©è¿æ¥å·¦é›†åˆå’Œå³é›†åˆçš„è¾¹ å…±æœ‰ i(n - i) ç§æ–¹æ³•ï¼›</p><p>é€‰æ‹©åŒ…å«è¿™æ¡è¾¹çš„è·¯å¾„ å…±æœ‰ i(n - i) ç§æ–¹æ³•ã€‚</p><p>æ‰€ä»¥å°±æ˜¯: </p><h2 id="sum-limits-i-1-nC-n-1-i-1-i-i-2-n-i-n-i-2-i-n-i-i-n-i"><a href="#sum-limits-i-1-nC-n-1-i-1-i-i-2-n-i-n-i-2-i-n-i-i-n-i" class="headerlink" title="$\sum\limits_{i = 1}^nC(n - 1, i - 1) * i^{i - 2} * (n - i)^{n - i - 2} * i * (n - i) * i * (n - i)$"></a>$\sum\limits_{i = 1}^nC(n - 1, i - 1) * i^{i - 2} * (n - i)^{n - i - 2} * i * (n - i) * i * (n - i)$</h2><h2 id="å¤´çš®å±‘-Venus"><a href="#å¤´çš®å±‘-Venus" class="headerlink" title="å¤´çš®å±‘(Venus)"></a>å¤´çš®å±‘(Venus)</h2><hr><p>ï¼ˆæœ‰è¶£çš„æ ‡é¢˜</p><p>å®è´¨æ˜¯æ•°è®ºé¢˜ã€‚è€ƒè¯•æ—¶æ‰¾åˆ°äº†æ€§è´¨ï¼š</p><ol><li>è‡³å°‘ä¸€ä¸ªæ˜¯è´¨æ•°ä¸”è‡³å°‘ä¸€ä¸ªæ•° &gt; n / 2ï¼Œæ— è¾¹ç›¸è¿ï¼Œä¸º 0</li><li>gcd &gt; 1ï¼Œæœ‰ç›´æ¥è¾¹ï¼Œä¸º 1</li><li>äº’è´¨ï¼Œæœ€å°è´¨å› æ•°ä¹‹å’Œ &lt;= nï¼Œä¸º 2</li><li>äº’è´¨ï¼Œä¸¤ä¸ªæ•°éƒ½ &lt;= n / 2ï¼Œä¸º 3</li></ol><p>æˆ‘ä»¬åœ¨è®¨è®ºä¸­å¿½ç•¥æ•°å­— 1ã€‚</p><p>4ï¼‰ç›´æ¥ç”¨æ€»è¾¹æ•°å‡å» 0ï¼‰1ï¼‰2ï¼‰å°±å¥½äº†ã€‚</p><p>å»ºè®®çœ‹ CF åŸé¢˜è§£ï¼š<a href="http://codeforces.com/blog/entry/55200" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><h2 id="åç­‰memset0-memset"><a href="#åç­‰memset0-memset" class="headerlink" title="åç­‰memset0(memset)"></a>åç­‰memset0(memset)</h2><hr><p>éå¸¸å¦™çš„ CF é¢˜ï¼</p><p>æˆ‘ä»¬å‘ç°ï¼Œf(l, r) = l ~ r çš„ç‚¹æ•° - l ~ r çš„è¾¹æ•°ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ‹†å¼€ sigmaï¼Œè®¡ç®—æ¯ä¸€ä¸ªç‚¹çš„è´¡çŒ®å’Œæ¯ä¸€æ¡è¾¹çš„è´¡çŒ®ï¼Œå°±å¯ä»¥ ACã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å…¶ä»– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[APIO2014]-åºåˆ—åˆ†å‰²</title>
      <link href="2019/07/06/%5BAPIO2014%5D-%E5%BA%8F%E5%88%97%E5%88%86%E5%89%B2/"/>
      <url>2019/07/06/%5BAPIO2014%5D-%E5%BA%8F%E5%88%97%E5%88%86%E5%89%B2/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.lydsy.com/JudgeOnline/problem.php?id=3675" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>å•Šã€‚ã€‚ã€‚å¥½æ¶å¿ƒã€‚ã€‚æœ€åé€¼ç€æˆ‘å»å¯¹æ‹ã€é¢å­”æ‰­æ›²ã€‘ä¹Ÿç®—å¾ˆæœ‰æ„ä¹‰äº†ï¼è¶æœºå¤ä¹ ä¸€æ³¢æ–œç‡ä¼˜åŒ–ã€‚ã€‚</p><p>å¯ä»¥å‘ç°ï¼Œç­”æ¡ˆå’Œåˆ†å‰²é¡ºåºå¥½åƒå¹¶æ²¡æœ‰å…³ç³»ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é»˜è®¤ä¸ºä»å·¦å‘å³åˆ†å‰²ï¼ˆè¿™æ ·æœ€æ–¹ä¾¿</p><p>è®¾ f[i, j] è¡¨ç¤ºå‰ j ä¸ªåˆ†å‰²äº† i æ¬¡ã€‚é‚£ä¹ˆæ–¹ç¨‹å°±æ˜¯ï¼šf[i, j] = max{f[i - 1][k] + s[k]Â·(s[j]Â·s[k])}<br>(å…¶ä¸­ s[i] è¡¨ç¤º a[1] ~ a[i] çš„å’Œ)</p><p>å¦‚æœå†³ç­– k1 &lt; k2ï¼ˆk2æ›´ä¼˜ï¼š</p><p>$$f[i, k1] + s[k1]*(s[j]<em>s[k1]) &lt; f[i, k2] + s[k2]</em>(s[j]*s[k2])$$</p><p>=&gt;</p><p>$$s[j] &gt; \frac{f[i, k1] - f[i, k2] + (s[k1] ^ 2) - (s[k2] ^ 2)}{s[k2] - s[k1]}$$</p><p>è¿™æ˜¯ä¸€ä¸ªæ–œç‡ä¼˜åŒ–çš„å¼å­ï¼Œç„¶åå°±æ˜¯å¥—è·¯äº†ã€‚ç¥ç©è€æ„‰å¿«ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, K, a[N], q[N], r;</span><br><span class="line">ll sum[N], f[<span class="number">2</span>][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">slope</span><span class="params">(<span class="keyword">int</span> j, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (sum[j] == sum[k]) <span class="keyword">return</span> <span class="number">-1e18</span>;</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">double</span>)(sum[k] * sum[k] - sum[j] * sum[j] + f[(r &amp; <span class="number">1</span>) ^ <span class="number">1</span>][j] - f[(r &amp; <span class="number">1</span>) ^ <span class="number">1</span>][k]) / (<span class="keyword">double</span>)(sum[k] - sum[j]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;K);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]), sum[i] = sum[i - <span class="number">1</span>] + a[i];</span><br><span class="line">    <span class="keyword">for</span> (r = <span class="number">1</span>; r &lt;= K; r++) &#123;</span><br><span class="line">        <span class="keyword">int</span> head = <span class="number">1</span>, tail = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = r; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">while</span> (head &lt; tail &amp;&amp; slope(q[head], q[head + <span class="number">1</span>]) &lt; sum[i]) head++;</span><br><span class="line">            <span class="keyword">int</span> t = q[head];</span><br><span class="line">            f[r &amp; <span class="number">1</span>][i] = f[(r &amp; <span class="number">1</span>) ^ <span class="number">1</span>][t] + (sum[i] - sum[t]) * sum[t];</span><br><span class="line">            <span class="keyword">while</span> (head &lt; tail &amp;&amp; slope(q[tail - <span class="number">1</span>], q[tail]) &gt; slope(q[tail], i)) tail--;</span><br><span class="line">            q[++tail] = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, f[K &amp; <span class="number">1</span>][n]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ–œç‡ä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 572 Div2</title>
      <link href="2019/07/05/Codeforces%20Round%20572%20Div2/"/>
      <url>2019/07/05/Codeforces%20Round%20572%20Div2/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/1189" target="_blank" rel="noopener">æ¯”èµ›é“¾æ¥</a></p><p>VP çš„ï½</p><h3 id="A-Keanu-Reeves"><a href="#A-Keanu-Reeves" class="headerlink" title="A. Keanu Reeves"></a>A. Keanu Reeves</h3><hr><p>H2O ç­¾åˆ°é¢˜ï½</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, a[<span class="number">105</span>], b[<span class="number">105</span>], c[<span class="number">105</span>];</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">105</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        c[i] = s[i] - <span class="string">'0'</span>;</span><br><span class="line">        a[i] = a[i - <span class="number">1</span>], b[i] = b[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (c[i]) a[i]++; <span class="keyword">else</span> b[i]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (a[n] != b[n]) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"1"</span>);</span><br><span class="line">        rep(i, <span class="number">1</span>, n) <span class="built_in">printf</span>(<span class="string">"%d"</span>, c[i]);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"2"</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[i] != b[i]) &#123;</span><br><span class="line">                rep(j, <span class="number">1</span>, i) <span class="built_in">printf</span>(<span class="string">"%d"</span>, c[j]);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">" "</span>);</span><br><span class="line">                rep(j, i + <span class="number">1</span>, n) <span class="built_in">printf</span>(<span class="string">"%d"</span>, c[j]);</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-Number-Circle"><a href="#B-Number-Circle" class="headerlink" title="B. Number Circle"></a>B. Number Circle</h3><hr><p>å°½é‡ä¿æŒ å¤§-&gt;å°-&gt;å¤§ çš„é¡ºåºï½</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line">ll a[N], b[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    sort(a + <span class="number">1</span>, a + n + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> l = n + <span class="number">1</span>, r = <span class="number">1</span>;</span><br><span class="line">    b[<span class="number">1</span>] = a[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>) b[++r] = a[i];</span><br><span class="line">        <span class="keyword">else</span> b[--l] = a[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> l = i - <span class="number">1</span>, r = i + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (!l) l = n;</span><br><span class="line">        <span class="keyword">if</span> (r &gt; n) r = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (b[l] + b[r] &lt;= b[i]) &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"NO"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"YES"</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, b[i]);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-Candies"><a href="#C-Candies" class="headerlink" title="C. Candies!"></a>C. Candies!</h3><hr><p>å½“æ—¶æš´åŠ›æ¨¡æ‹Ÿæ˜¯ T äº†ä¸€å‘ï¼Œç„¶åæ‰æƒ³åˆ° ST è¡¨ã€‚ã€‚ï¼ˆè¿™ç§é¢˜åº”è¯¥é¦–é€‰ ST å•Šï¼</p><p>ä¸æ˜¯å¾ˆéš¾ï¼Œå¤ä¹ ä¸€æ³¢ï¼</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> a[N], n, q, l, r, pre[N], ans, f[N][<span class="number">20</span>], g[N][<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;f[i][<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> tmp = <span class="built_in">log</span>(n + eps) / <span class="built_in">log</span>(<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tmp; j++) &#123;</span><br><span class="line">        <span class="keyword">int</span> len = (<span class="number">1</span> &lt;&lt; (j - <span class="number">1</span>));</span><br><span class="line">        <span class="keyword">int</span> k = n - (<span class="number">1</span> &lt;&lt; j) + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= k; i++) &#123;</span><br><span class="line">            f[i][j] = (f[i][j - <span class="number">1</span>] + f[i + len][j - <span class="number">1</span>]) % <span class="number">10</span>;</span><br><span class="line">            g[i][j] = (g[i][j - <span class="number">1</span>] + g[i + len][j - <span class="number">1</span>]) + (f[i][j - <span class="number">1</span>] + f[i + len][j - <span class="number">1</span>] &gt;= <span class="number">10</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; q;</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;l, &amp;r);</span><br><span class="line">        tmp = <span class="built_in">log</span>(r - l + <span class="number">1</span> + eps) / <span class="built_in">log</span>(<span class="number">2</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, g[l][tmp]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D1-Add-on-a-Tree"><a href="#D1-Add-on-a-Tree" class="headerlink" title="D1. Add on a Tree"></a>D1. Add on a Tree</h3><hr><p>å‘ç°ï¼Œæœ‰ 3 ä¸ªä»¥ä¸Šåˆ†æ”¯çš„ç‚¹ï¼Œå®ƒè¿æ¥çš„è¾¹å¯ä»¥ä»»æ„+ã€‚</p><p>æ‰€ä»¥å¦‚æœæœ‰ 2 ä¸ªåˆ†æ”¯çš„ç‚¹å°±ä¸å¯ä»¥ï¼</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, d[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        d[x]++, d[y]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">bool</span> ff = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">if</span> (d[i] == <span class="number">2</span>) &#123; ff = <span class="number">1</span>; <span class="keyword">break</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span> (ff) <span class="built_in">puts</span>(<span class="string">"no"</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"yes"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="E-Count-Pairs"><a href="#E-Count-Pairs" class="headerlink" title="E. Count Pairs"></a>E. Count Pairs</h3><hr><p>è¿™ç§é¢˜è‚¯å®šå¾— i å½’ä¸€è¾¹ï¼Œj å½’å¦ä¸€è¾¹ï¼Œå„ç®¡å„çš„æ‰å¥½ï½</p><p>å› å¼åˆ†è§£å…šè¡¨ç¤ºå¼ºè¿«ç—‡å‘ä½œï½</p><p>ä¸¤è¾¹åŒä¹˜ (ai - aj)ï¼Œå°±æ˜¯ ai^4 - aj^4 æ’ç­‰äº (ai - aj)k (mod p)</p><p>æ•´ç†å¾— ai^4 - aiK æ’ç­‰äº aj^4 - ajK (mod p)</p><p>é‚£ä¹ˆå°±å¾ˆ easy æƒ¹ï½ Eé¢˜ ACï½</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, mod, K, a[N], ans;</span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mp;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sub</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> t = a - b;</span><br><span class="line">    <span class="keyword">if</span> (t &lt; <span class="number">0</span>) t += mod;</span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">1l</span>l * a * b) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">p</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> mul(mul(x, x), mul(x, x));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; mod &gt;&gt; K;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]);</span><br><span class="line">        a[i] = sub(p(a[i]), mul(K, a[i]));</span><br><span class="line">        ans += mp[a[i]];</span><br><span class="line">        mp[a[i]]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><hr><p>æœ‰è¿›æ­¥ï¼æš‘å‡æ‹¼äº† (à¸‡ â€¢Ì€ç¬â€¢Ì)à¸‡</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠ¨æ€DP</title>
      <link href="2019/06/27/%E5%8A%A8%E6%80%81DP/"/>
      <url>2019/06/27/%E5%8A%A8%E6%80%81DP/</url>
      
        <content type="html"><![CDATA[<p>ç¥ä»™èŠå£«= =</p><p>ææ€•è®²ä¸å¥½ï¼Œè¿˜æ˜¯æŒ‚åˆ«äºº dalao çš„ blog å§ï¼</p><p><a href="https://www.cnblogs.com/RabbitHu/p/9112811.html" target="_blank" rel="noopener">è¿™ä¸ªè¶…å¥½</a></p><p>å†æŒ‚ä¸ªæ¿å­</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// luogu4719</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>, inf = <span class="number">1e9</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, dfn;</span><br><span class="line"><span class="keyword">int</span> f[N][<span class="number">2</span>], g[N][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> w[N], w2[N], sz[N], top[N], ed[N], bel[N];</span><br><span class="line"><span class="keyword">int</span> dep[N], fa[N], son[N], id[N];</span><br><span class="line"><span class="keyword">int</span> to[N &lt;&lt; <span class="number">1</span>], nxt[N &lt;&lt; <span class="number">1</span>], lnk[N], cnt;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">tree</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r;</span><br><span class="line">&#125;tr[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> m[<span class="number">5</span>][<span class="number">5</span>];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">cl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">2</span>; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">2</span>; j++) m[i][j] = -inf;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;ans[N &lt;&lt; <span class="number">2</span>], val[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    to[++cnt] = y, nxt[cnt] = lnk[x], lnk[x] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> f)</span> </span>&#123;</span><br><span class="line">    sz[x] = <span class="number">1</span>;</span><br><span class="line">    dep[x] = dep[f] + <span class="number">1</span>;</span><br><span class="line">    fa[x] = f;</span><br><span class="line">    <span class="keyword">int</span> Mx = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (y == f) <span class="keyword">continue</span>;</span><br><span class="line">        dfs1(y, x);</span><br><span class="line">        sz[x] += sz[y];</span><br><span class="line">        <span class="keyword">if</span> (sz[y] &gt; Mx) Mx = sz[y], son[x] = y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> f)</span> </span>&#123;</span><br><span class="line">    top[x] = f;</span><br><span class="line">    id[x] = ++dfn;</span><br><span class="line">    bel[dfn] = x, ed[f] = x;</span><br><span class="line">    <span class="keyword">if</span> (son[x]) dfs2(son[x], f);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (y == fa[x] || y == son[x]) <span class="keyword">continue</span>;</span><br><span class="line">        dfs2(y, y);</span><br><span class="line">    &#125;</span><br><span class="line">    ed[x] = ed[f]; <span class="comment">// !!!!!!!!</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs3</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    g[x][<span class="number">1</span>] = w[x];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (y == son[x] || y == fa[x]) <span class="keyword">continue</span>;</span><br><span class="line">        dfs3(y);</span><br><span class="line">        g[x][<span class="number">0</span>] += max(f[y][<span class="number">0</span>], f[y][<span class="number">1</span>]);</span><br><span class="line">        g[x][<span class="number">1</span>] += f[y][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    f[x][<span class="number">0</span>] += g[x][<span class="number">0</span>], f[x][<span class="number">1</span>] += g[x][<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (son[x]) &#123;</span><br><span class="line">        dfs3(son[x]);</span><br><span class="line">        f[x][<span class="number">0</span>] += max(f[son[x]][<span class="number">1</span>], f[son[x]][<span class="number">0</span>]);</span><br><span class="line">        f[x][<span class="number">1</span>] += f[son[x]][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ----------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="function">node <span class="title">mul</span><span class="params">(node x, node y)</span> </span>&#123;</span><br><span class="line">    node res;</span><br><span class="line">    res.cl();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">1</span>; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">1</span>; j++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= <span class="number">1</span>; k++)</span><br><span class="line">                res.m[i][j] = max(res.m[i][j], x.m[i][k] + y.m[k][j]);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    tr[x].l = l, tr[x].r = r;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        val[bel[l]].m[<span class="number">0</span>][<span class="number">0</span>] = g[bel[l]][<span class="number">0</span>], val[bel[l]].m[<span class="number">0</span>][<span class="number">1</span>] = g[bel[l]][<span class="number">0</span>];</span><br><span class="line">        val[bel[l]].m[<span class="number">1</span>][<span class="number">0</span>] = g[bel[l]][<span class="number">1</span>], val[bel[l]].m[<span class="number">1</span>][<span class="number">1</span>] = -inf;</span><br><span class="line">        ans[x] = val[bel[l]];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    build(x &lt;&lt; <span class="number">1</span>, l, mid), build(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">    ans[x] = mul(ans[x &lt;&lt; <span class="number">1</span>], ans[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">node <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt;= tr[x].l &amp;&amp; tr[x].r &lt;= r) <span class="keyword">return</span> ans[x];</span><br><span class="line">    <span class="keyword">int</span> mid = (tr[x].l + tr[x].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (mid &gt;= r) <span class="keyword">return</span> query(x &lt;&lt; <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">if</span> (mid &lt; l) <span class="keyword">return</span> query(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">return</span> mul(query(x &lt;&lt; <span class="number">1</span>, l, r), query(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> pos)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (tr[x].l == tr[x].r &amp;&amp; tr[x].l == pos) &#123;</span><br><span class="line">        ans[x] = val[bel[pos]];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (tr[x].l + tr[x].r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (pos &lt;= mid) upd(x &lt;&lt; <span class="number">1</span>, pos);</span><br><span class="line">    <span class="keyword">else</span> upd(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, pos);</span><br><span class="line">    ans[x] = mul(ans[x &lt;&lt; <span class="number">1</span>], ans[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> f)</span> </span>&#123;</span><br><span class="line">    val[x].m[<span class="number">1</span>][<span class="number">0</span>] += f - w[x];</span><br><span class="line">    w[x] = f;</span><br><span class="line">    <span class="keyword">while</span> (x != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = top[x];</span><br><span class="line">        node lst = query(<span class="number">1</span>, id[y], id[ed[y]]);</span><br><span class="line">        upd(<span class="number">1</span>, id[x]);</span><br><span class="line">        node now = query(<span class="number">1</span>, id[y], id[ed[y]]);</span><br><span class="line">        x = fa[y];</span><br><span class="line">        val[x].m[<span class="number">0</span>][<span class="number">0</span>] += max(now.m[<span class="number">0</span>][<span class="number">0</span>], now.m[<span class="number">1</span>][<span class="number">0</span>]) - max(lst.m[<span class="number">0</span>][<span class="number">0</span>], lst.m[<span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line">        val[x].m[<span class="number">0</span>][<span class="number">1</span>] = val[x].m[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">        val[x].m[<span class="number">1</span>][<span class="number">0</span>] += now.m[<span class="number">0</span>][<span class="number">0</span>] - lst.m[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;w[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        add(x, y), add(y, x);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs1(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    dfs2(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    dfs3(<span class="number">1</span>);</span><br><span class="line">    build(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        modify(x, y);</span><br><span class="line">        node res = query(<span class="number">1</span>, id[<span class="number">1</span>], id[ed[<span class="number">1</span>]]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, max(res.m[<span class="number">0</span>][<span class="number">0</span>], res.m[<span class="number">1</span>][<span class="number">0</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> çŸ©é˜µä¹˜æ³• </tag>
            
            <tag> æ ‘é“¾å‰–åˆ† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CRT&amp;EXCRTä¸­å›½å‰©ä½™å®šç†ä¸æ‰©å±•ä¸­å›½å‰©ä½™å®šç†</title>
      <link href="2019/06/02/CRT&amp;EXCRT%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86%E4%B8%8E%E6%89%A9%E5%B1%95%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86/"/>
      <url>2019/06/02/CRT&amp;EXCRT%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86%E4%B8%8E%E6%89%A9%E5%B1%95%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>è¿™çœŸçš„è¶…å®¹æ˜“å¿˜ã€‚ã€‚ã€‚æ‰€ä»¥ç‰¹æ­¤è®°å½•ä¸€ç¯‡åšå®¢ï¼</p><h2 id="CRTï¼ˆä¸­å›½å‰©ä½™å®šç†ï¼‰"><a href="#CRTï¼ˆä¸­å›½å‰©ä½™å®šç†ï¼‰" class="headerlink" title="CRTï¼ˆä¸­å›½å‰©ä½™å®šç†ï¼‰"></a>CRTï¼ˆä¸­å›½å‰©ä½™å®šç†ï¼‰</h2><hr><ul><li>å‰è¨€ï¼šå¿…é¡»æ˜¯æ¨¡æ•°ä¸¤ä¸¤äº’è´¨çš„æƒ…å†µå“¦ï¼</li></ul><p>ä¸­å›½å‰©ä½™å®šç†ï¼Œåˆç§°å­™å­å®šç†ï¼ˆå¤äººå¥½å‰å®³å“‡</p><p>æ˜¯ç”¨æ¥è§£å†³ä¸‹é¢è¿™ç§åŒä½™æ–¹ç¨‹ç»„çš„ï¼š</p><p>$$<br>\begin{cases}<br>x\equiv a_1(mod\ m_1)\<br>x\equiv a_2(mod\ m_2)\<br>\ \vdots\<br>x\equiv a_k(mod\ m_k)<br>\end{cases}$$</p><p>å¯ä»¥å‡è®¾ $n_1 \equiv a_1(mod\ m_1)$, $n_2 \equiv a_2(mod\ m_2)$, $\cdots$, $n_k \equiv a_k(mod\ m_k)$</p><p>è®¾ $M = m_1 * m_2 * â€¦ * m_k$. $M_i = M / m_i$.</p><p>ä¸ºäº†ä½¿å¾— $n_1 + n_2 \equiv a_1(mod\ m_1)$, n2 å¿…é¡»æ˜¯ m1 çš„å€æ•°ã€‚åŒç†å¯å¾—ï¼š</p><ul><li>n1 æ˜¯ m2 å’Œ m3 çš„å€æ•°ï¼ˆæ˜¯ M1 çš„å€æ•°</li><li>n2 æ˜¯ m1 å’Œ m3 çš„å€æ•°ï¼ˆæ˜¯ M2 çš„å€æ•°</li><li>n3 æ˜¯ m1 å’Œ m2 çš„å€æ•°ï¼ˆæ˜¯ M3 çš„å€æ•°</li></ul><p>è¿™æ ·çš„è¯ï¼Œä¸º n1 + n2 + n3 çš„è§£å°±æ»¡è¶³ä¸Šè¿°æ–¹ç¨‹å•¦ï¼</p><p>è®¾ $M_1t_1 \equiv 1(mod\ m_1)$ï¼Œåˆ™ $a_1M_1t_1 \equiv a_1(mod\ m_1)$ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ‰©æ¬§æ±‚å‡º t1. æ‰€ä»¥ $n_1 = a_1M_1t_1$.</p><p>$x = \sum_{i = 1}^k n_i = \sum_{i = 1}^ka_iM_it_i$. æ±‚å®Œå•¦ï¼å°±è¿™æ ·~</p><h2 id="EXCRTï¼ˆæ‰©å±•ä¸­å›½å‰©ä½™å®šç†ï¼‰"><a href="#EXCRTï¼ˆæ‰©å±•ä¸­å›½å‰©ä½™å®šç†ï¼‰" class="headerlink" title="EXCRTï¼ˆæ‰©å±•ä¸­å›½å‰©ä½™å®šç†ï¼‰"></a>EXCRTï¼ˆæ‰©å±•ä¸­å›½å‰©ä½™å®šç†ï¼‰</h2><hr><p>è¯´æ˜¯æ‰©å±•ï¼Œå…¶å®è¿™ä¿©ç©æ„å„¿åŠåˆ†é’±å…³ç³»ä¹Ÿæœ¨æœ‰ã€‚ã€‚</p><p>ä¸¤ä¸ªé—®é¢˜å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ï¼šEXCRT æ¨¡æ•°ä¸äº’è´¨</p><p>æ€ä¹ˆåšæï¼Ÿå‡è®¾æœ‰ n ä¸ªæ–¹ç¨‹ã€‚$x \equiv a_1(mod\ m_1)$ï¼Œå³ $x = m_1 * k_1 + a_1$; $x \equiv a_2(mod\ m_2)$, å³ $x = m_2 * k_2 + a_2$.</p><p>è”ç«‹ï¼š$m_2 * k_2 - m_1 * k_1 = r_1 - r_2$. å…¶ä¸­åªæœ‰ k1 å’Œ k2 æ˜¯æœªçŸ¥çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ‰©æ¬§åˆ¤æ–­æœ‰æ— è§£ï¼Œæ±‚å‡º k1, æ±‚å‡º xã€‚</p><p>æˆ‘ä»¬æŠŠè¿™ä¸ª x å«åš x0. x çš„é€šè§£å°±æ˜¯ $x_0 + k * lcm(m_1, m_2)$, å³ $x \equiv x_0(mod\ lcm(m_1, m_2))$</p><p>å°±è¿™æ ·ï¼Œæˆ‘ä»¬æŠŠå‰ä¸¤ä¸ªæ–¹ç¨‹å˜ä¸ºä¸€ä¸ªæ–¹ç¨‹äº†ã€‚</p><p>ç”¨è¿™æ ·çš„æ–¹æ³•åš n - 1 æ¬¡æ‰©æ¬§ï¼Œå°±å¯ä»¥æ±‚å‡ºæœ€ç»ˆçš„ x äº†ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line">ll m[N], r[N];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">exGCD</span><span class="params">(ll a, ll b, ll &amp;x, ll &amp;y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b) &#123;</span><br><span class="line">        x = <span class="number">1</span>, y = <span class="number">0</span>; <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    ll d = exGCD(b, a % b, y, x);</span><br><span class="line">    y -= (a / b) * x;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">exCRT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll M = m[<span class="number">1</span>], R = r[<span class="number">1</span>], x, y, d;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        d = exGCD(m[i], M, y, x);</span><br><span class="line">        <span class="keyword">if</span> ((R - r[i]) % d) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        x = (R - r[i]) / d * x % m[i];</span><br><span class="line">        R -= M * x;</span><br><span class="line">        M = M / d * m[i];</span><br><span class="line">        R %= M;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (R % M + M) % M;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;m[i], &amp;r[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, exCRT());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> åŒä½™æ–¹ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[NOIP2011]-è§‚å…‰å…¬äº¤</title>
      <link href="2019/05/18/%5BNOIP2011%5D-%E8%A7%82%E5%85%89%E5%85%AC%E4%BA%A4/"/>
      <url>2019/05/18/%5BNOIP2011%5D-%E8%A7%82%E5%85%89%E5%85%AC%E4%BA%A4/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.luogu.org/problemnew/show/P1315" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><h3 id="è´ªå¿ƒ"><a href="#è´ªå¿ƒ" class="headerlink" title="è´ªå¿ƒ"></a>è´ªå¿ƒ</h3><hr><p>å°±æ˜¯æ¯æ¬¡æ‰¾ä¸€æ¡ â€œå¦‚æœä½¿ç”¨åŠ é€Ÿå™¨ï¼Œèƒ½å½±å“çš„äººæœ€å¤šâ€ çš„è¾¹ï¼</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1010</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, K, d[N], pre[N], on[N], off[N], arri[N], use[N], ans;</span><br><span class="line"><span class="comment">// use[i] ï¿½ï¿½Ê¾ d[i]-- ï¿½ï¿½ï¿½Ğ¶ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//freopen("bus.in", "r", stdin);</span></span><br><span class="line">    <span class="comment">//freopen("bus.out", "w", stdout);</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;n, &amp;m, &amp;K);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;d[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> t, a, b; <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;t, &amp;a, &amp;b);</span><br><span class="line">        ans -= t;</span><br><span class="line">        on[a] = max(on[a], t);</span><br><span class="line">        off[b]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (K--) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            arri[i] = max(arri[i - <span class="number">1</span>], on[i - <span class="number">1</span>]) + d[i - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">int</span> now = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">2</span>; i--) &#123;</span><br><span class="line">            <span class="comment">// if (!d[i - 1]) use[i - 1] = 0;</span></span><br><span class="line">            <span class="comment">// else &#123;</span></span><br><span class="line">                use[i - <span class="number">1</span>] = off[i];</span><br><span class="line">                <span class="keyword">if</span> (arri[i] &gt; on[i]) use[i - <span class="number">1</span>] += use[i];</span><br><span class="line">            <span class="comment">// &#125;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> id = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++)</span><br><span class="line">            <span class="keyword">if</span> (use[i] &gt; use[id] &amp;&amp; d[i] &gt; <span class="number">0</span>) id = i;</span><br><span class="line">        d[id]--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        arri[i] = max(arri[i - <span class="number">1</span>], on[i - <span class="number">1</span>]) + d[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) ans += arri[i] * off[i];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è´¹ç”¨æµ"><a href="#è´¹ç”¨æµ" class="headerlink" title="è´¹ç”¨æµ"></a>è´¹ç”¨æµ</h3><hr><p>ç½‘ä¸Šåªæœ‰ä¸€ä¸ªè´¹ç”¨æµé¢˜è§£ T^T é‚£ä½å¤§ç¥ä¹Ÿæ˜¯è¶…çº§å‰å®³ï¼</p><p>é¦–å…ˆç”± $S$ å‘ $Sâ€™$ è¿ä¸€æ¡æµé‡ä¸º $K$ï¼Œè´¹ç”¨ä¸º $0$ çš„è¾¹ï¼ˆé™åˆ¶æ€»æµé‡ä¸º $K$ï¼‰</p><p>æŠŠæ¯ä¸ªç‚¹ $i$ æ‹†ä¸º $iâ€™$ å’Œ $iâ€™â€™$ã€‚</p><ol><li><p>$(iâ€™, iâ€™â€™, max(tim[i] - on[i], 0), 0)$ï¼Œå…¶ä¸­ $tim[i]$ è¡¨ç¤ºä¸åŠ ä»»ä½•åŠ é€Ÿå™¨æ—¶è½¦åˆ°è¾¾ $i$ ç‚¹çš„æ—¶é—´ï¼Œ$on[i]$ è¡¨ç¤º $i$ ç‚¹æœ€æ™šä¸Šè½¦çš„æ—¶é—´ã€‚ä¸€æ—¦åŠ é€Ÿå™¨ä½¿ç”¨è¶…è¿‡ $tim[i] - on[i]$ äº†ï¼Œå¤šä½™çš„éƒ¨åˆ†å°±ä¼šæ²¡ç”¨ï¼Œæ‰€ä»¥å°±åˆ«æµªè´¹äº†</p></li><li><p>$(iâ€™â€™, (i + 1)â€™, \infty, -off[i])$ï¼Œå…¶ä¸­ $off[i]$ è¡¨ç¤º $i$ ç‚¹ä¸‹è½¦çš„äºº</p></li><li><p>$(Sâ€™, iâ€™â€™, D[i]ï¼ˆè¿™åº”è¯¥ä¹Ÿæ˜¯åœ¨é™åˆ¶è¯¥è¾¹æ€»æµé‡ä¸è¶…è¿‡ D[i]ï¼‰, 0)$</p></li><li><p>$(iâ€™, T, \infty, 0)$</p></li></ol><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e3</span> + <span class="number">10</span>, M = <span class="number">1e4</span> + <span class="number">10</span>, T = <span class="number">1e5</span> + <span class="number">10</span>, inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, K, ans, s, t;</span><br><span class="line"><span class="keyword">int</span> D[N], on[T], off[T], tim[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span> <span class="keyword">int</span> t, a, b; &#125;p[M];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span> <span class="keyword">int</span> u, v, c, cost; &#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;edge&gt; edges;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> dis[N &lt;&lt; <span class="number">1</span>], inq[N &lt;&lt; <span class="number">1</span>], pre[N &lt;&lt; <span class="number">1</span>], fl[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> c, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    edges.push_back((edge)&#123;s, t, c, v&#125;);</span><br><span class="line">    edges.push_back((edge)&#123;t, s, <span class="number">0</span>, -v&#125;);</span><br><span class="line">    <span class="keyword">int</span> tot = edges.size();</span><br><span class="line">    G[s].push_back(tot - <span class="number">2</span>);</span><br><span class="line">    G[t].push_back(tot - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> &amp;flow, <span class="keyword">int</span> &amp;cost)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(dis));</span><br><span class="line">    <span class="built_in">memset</span>(inq, <span class="number">0</span>, <span class="keyword">sizeof</span>(inq));</span><br><span class="line">    q.push(s);</span><br><span class="line">    dis[s] = <span class="number">0</span>, inq[s] = <span class="number">1</span>, fl[s] = inf, pre[s] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (q.size()) &#123;</span><br><span class="line">        <span class="keyword">int</span> u = q.front(); q.pop(); inq[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[u].size(); i++) &#123;</span><br><span class="line">            edge e = edges[G[u][i]];</span><br><span class="line">            <span class="keyword">if</span> (e.c &amp;&amp; dis[e.v] &gt; dis[e.u] + e.cost) &#123;</span><br><span class="line">                dis[e.v] = dis[e.u] + e.cost;</span><br><span class="line">                pre[e.v] = G[u][i];</span><br><span class="line">                fl[e.v] = min(fl[e.u], e.c);</span><br><span class="line">                <span class="keyword">if</span> (!inq[e.v]) &#123;</span><br><span class="line">                    inq[e.v] = <span class="number">1</span>; q.push(e.v);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (dis[t] == inf) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    flow += fl[t];</span><br><span class="line">    cost += fl[t] * dis[t];</span><br><span class="line">    <span class="keyword">int</span> pos = t;</span><br><span class="line">    <span class="keyword">while</span> (pos != s) &#123;</span><br><span class="line">        edges[pre[pos]].c -= fl[t];</span><br><span class="line">        edges[pre[pos] ^ <span class="number">1</span>].c += fl[t];</span><br><span class="line">        pos = edges[pre[pos]].u;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Mincost</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> flow = <span class="number">0</span>, cost = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (spfa(s, t, flow, cost));</span><br><span class="line">    <span class="keyword">return</span> cost;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;n, &amp;m, &amp;K);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;D[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;p[i].t, &amp;p[i].a, &amp;p[i].b);</span><br><span class="line">        on[p[i].a] = max(on[p[i].a], p[i].t);</span><br><span class="line">        off[p[i].b]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) tim[i] = max(tim[i - <span class="number">1</span>], on[i - <span class="number">1</span>]) + D[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) ans += tim[p[i].b] - p[i].t;</span><br><span class="line"></span><br><span class="line">    s = n * <span class="number">2</span> + <span class="number">1</span>, t = n * <span class="number">2</span> + <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">int</span> s1 = n * <span class="number">2</span> + <span class="number">2</span>;</span><br><span class="line">    add(s, s1, K, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        add(i, i + n, max(tim[i] - on[i], <span class="number">0</span>), <span class="number">0</span>);</span><br><span class="line">        add(i + n, i + <span class="number">1</span>, inf, -off[i + <span class="number">1</span>]);</span><br><span class="line">        add(s1, i + n, D[i], <span class="number">0</span>);</span><br><span class="line">        add(i + <span class="number">1</span>, t, inf, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans + Mincost());</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¥½é¬¼ç•œå•Šã€‚ã€‚ã€‚æ˜¯ç›®å‰åšè¿‡æœ€å¥‡æŠ€æ·«å·§çš„ç½‘ç»œæµã€‚ã€‚ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> è´ªå¿ƒ </tag>
            
            <tag> è´¹ç”¨æµ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[BZOJ1030]-æ–‡æœ¬ç”Ÿæˆå™¨</title>
      <link href="2019/05/05/%5BBZOJ1030%5D-%E6%96%87%E6%9C%AC%E7%94%9F%E6%88%90%E5%99%A8/"/>
      <url>2019/05/05/%5BBZOJ1030%5D-%E6%96%87%E6%9C%AC%E7%94%9F%E6%88%90%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.lydsy.com/JudgeOnline/problem.php?id=1030" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>å¦‚æœè¦è®¡ç®—å¯è¯»æ–‡æœ¬çš„æ•°é‡ï¼Œé‚£å°±è¦ç”¨åˆ°å®¹æ–¥ï¼ˆæ²¡å°è¯•è¿‡ã€‚ã€‚åº”è¯¥ä¸å¥½ç®—ï¼Œæˆ–è€…ä¸èƒ½ç®—ï¼‰</p><p>ä¸å¦‚è®¡ç®—ä¸å¯è¯»æ–‡æœ¬æ•°é‡ï¼Œå†ç”¨æ€»æ•°å‡å»å®ƒï¼ï¼ˆè¿™å«é€†å‘æ€ç»´è¿˜æ˜¯å•¥</p><p>è¿™æ ·å°±æ¯”è¾ƒç¾æ»‹æ»‹äº†ï¼Œåªè¦ä¸è®© AC è‡ªåŠ¨æœºä¸Šèµ°åˆ°å•è¯èŠ‚ç‚¹å°±å¥½äº†ã€‚DP çš„è¯ï¼Œè®¾ $f[i, j]$ è¡¨ç¤ºæ–‡æœ¬é•¿åº¦ä¸º $i$ï¼ŒåŒ¹é…åˆ°è‡ªåŠ¨æœºä¸Šç¬¬ $j$ ä¸ªèŠ‚ç‚¹æ—¶çš„æƒ…å†µæ•°ã€‚åŒæ—¶è¦è®°å¾—æ’é™¤ä¸€ä¸ªæ¨¡å¼ä¸²åŒ…å«å¦ä¸€ä¸ªæ¨¡å¼ä¸²ï¼Œç¬¬ä¸€ä¸ªæ²¡èµ°åˆ°å•è¯èŠ‚ç‚¹ï¼Œç¬¬äºŒä¸ªå´èµ°åˆ°äº†çš„æƒ…å†µã€‚ä»£ç ä¸­ä¹Ÿæœ‰æ³¨é‡Šã€‚</p><p>Hintï¼$f[0, 0]$ ä¹Ÿæ˜¯ä¸€ç§ä¸å¯è¯»çš„æƒ…å†µå“¦ï¼Œä¸èƒ½èˆã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">6010</span>, M = <span class="number">110</span>, mod = <span class="number">10007</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, sz, ans = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> trie[N][<span class="number">30</span>], f[M][N], fail[N];</span><br><span class="line"><span class="keyword">bool</span> val[N];</span><br><span class="line"><span class="keyword">char</span> s[M];</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">idx</span><span class="params">(<span class="keyword">char</span> ch)</span> </span>&#123; <span class="keyword">return</span> ch - <span class="string">'A'</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span> *s)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">int</span> u = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> c = idx(s[i]);</span><br><span class="line">        <span class="keyword">if</span> (!trie[u][c]) trie[u][c] = ++sz;</span><br><span class="line">        u = trie[u][c];</span><br><span class="line">    &#125;</span><br><span class="line">    val[u] = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getfail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    fail[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</span><br><span class="line">        <span class="keyword">if</span> (trie[<span class="number">0</span>][i]) q.push(trie[<span class="number">0</span>][i]);</span><br><span class="line">    <span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">        <span class="keyword">int</span> r = q.front(); q.pop();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> c = <span class="number">0</span>; c &lt; <span class="number">26</span>; c++) &#123;</span><br><span class="line">            <span class="keyword">int</span> u = trie[r][c];</span><br><span class="line">            <span class="keyword">if</span> (u) &#123;</span><br><span class="line">                fail[u] = trie[fail[r]][c];</span><br><span class="line">                q.push(u);</span><br><span class="line">            &#125; <span class="keyword">else</span> trie[r][c] = trie[fail[r]][c];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (val[fail[r]]) val[r] = <span class="number">1</span>;  <span class="comment">// è¿™è¾¹è·Ÿä¼ ç»Ÿçš„è‡ªåŠ¨æœºæœ‰äº›ä¸åŒï¼Œæ˜¯ä¸ºäº†ä¸è®© â€œä¸€ä¸ªæ¨¡å¼ä¸²åŒ…å«å¦ä¸€ä¸ªæ¨¡å¼ä¸²ï¼Œä¸€ä¸ªæ²¡èµ°åˆ°å•è¯èŠ‚ç‚¹ä½†å¦ä¸€ä¸ªèµ°åˆ°äº†â€ çš„æƒ…å†µå‡ºç°</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</span><br><span class="line">        insert(s);</span><br><span class="line">    &#125;</span><br><span class="line">    getfail();</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= sz; j++) &#123;  <span class="comment">// j ä» 0 å·èŠ‚ç‚¹å¼€å§‹ï¼</span></span><br><span class="line">            <span class="keyword">if</span> (val[j] || !f[i][j]) <span class="keyword">continue</span>;  <span class="comment">// åªè¦ç¢°åˆ°ä»»æ„å•è¯èŠ‚ç‚¹å°±ä¸èµ°</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">26</span>; k++) &#123;</span><br><span class="line">                <span class="keyword">int</span> u = trie[j][k];</span><br><span class="line">                <span class="comment">// è¿™é‡Œ u å³ä½¿ == 0 ä¹Ÿæ²¡æœ‰å…³ç³»ï¼å¯ä»¥ç†è§£ä¸ºæ–‡æœ¬ç¬¬ i + 1 ä¸ªä½ç½®ä¸è‡ªåŠ¨æœºçš„æ ¹ç»“ç‚¹ï¼ˆ0 å·èŠ‚ç‚¹ï¼‰åŒ¹é…</span></span><br><span class="line">                f[i + <span class="number">1</span>][u] = (f[i + <span class="number">1</span>][u] + f[i][j]) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) ans = ans * <span class="number">26</span> % mod;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= sz; i++)  <span class="comment">// ä¸è¦å¿˜è®°ç®—ä¸Š f[0, 0]</span></span><br><span class="line">        <span class="keyword">if</span> (!val[i]) <span class="comment">// !!!</span></span><br><span class="line">            ans = (ans + mod - f[m][i]) % mod;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> ACè‡ªåŠ¨æœº </tag>
            
            <tag> çº¿æ€§DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[BZOJ1009]-GTè€ƒè¯•</title>
      <link href="2019/05/05/%5BBZOJ1009%5D-GT%E8%80%83%E8%AF%95/"/>
      <url>2019/05/05/%5BBZOJ1009%5D-GT%E8%80%83%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.lydsy.com/JudgeOnline/problem.php?id=1009" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>ä¸€ç›´åœ¨æƒ³ç»„åˆæ•°å­¦ï¼Œå®¹æ–¥æ€ä¹ˆåšã€‚ã€‚ã€‚çœ‹äº†é¢˜è§£å‘ç°æ˜¯çŸ©é˜µä¹˜æ³• + å­—ç¬¦ä¸²ã€‚ã€‚ã€‚</p><p>ä¸€èˆ¬çŸ©é˜µä¹˜æ³•çš„é¢˜éƒ½å¾—å…ˆæ‰¾é€’æ¨å¼ã€‚è¿™é¢˜çš„è½¬ç§»æ–¹ç¨‹æ˜¯:</p><p>$$f[i, j] = \sum\limits_{k = 0}^{m - 1} f[i - 1, k] * g[k][j]\ (0 \leq j &lt; m)$$</p><p>ï¼ˆ$0 \leq j &lt; m$ æ˜¯å› ä¸ºé¢˜ç›®è¦æ±‚å‡†è€ƒè¯å·ä¸å®Œå…¨å‡ºç° A çš„æ–¹æ¡ˆæ•°ï¼‰</p><p>å…¶ä¸­, $f[i, j]$ è¡¨ç¤ºå‡†è€ƒè¯å·å‰ $i$ ä½ä¸­çš„å $j$ ä½ä¸ $A$ çš„å‰ $j$ ä½ç›¸åŒçš„æ–¹æ¡ˆæ•°, $g[k, j]$ è¡¨ç¤ºå‡†è€ƒè¯å·åŒ¹é… $A$ çš„å‰ $k$ ä½æ—¶ï¼Œå‡†è€ƒè¯å·å¢åŠ ä¸€ä¸ªå­—ç¬¦ï¼Œä½¿ $A$ æ²¿ç€å¤±é…æŒ‡é’ˆæ‰¾åˆ°çš„æœ€å¤§åŒ¹é…ä½æ•° $j$ çš„æ–¹æ¡ˆæ•°ï¼ˆè®¡ç®— $g$ æ—¶è¦ä» $0$ åˆ° $9$ æšä¸¾å¢åŠ çš„é‚£ä¸ªå­—ç¬¦æ˜¯å•¥ï¼‰ã€‚</p><p>æˆ‘ä»¬å‘ç°ï¼Œ$f[i, ]$ æ¯æ¬¡éƒ½æ˜¯ç”± $f[i - 1, ]$ è½¬ç§»æ¥çš„ï¼Œæ‰€ä»¥å¯¹ $g$ çŸ©é˜µåšå¿«é€Ÿå¹‚å°±è¡Œï¼Œ$O(m^3\ log\ n)$ã€‚</p><p>æœ€åçš„ç­”æ¡ˆå°±æ˜¯ $\sum\limits_{i = 0}^{m - 1}g[0, i]$ ã€‚ä¸ºå•¥å‘¢ï¼Ÿ</p><p>æ ¹æ®çŸ©é˜µä¹˜æ³•ï¼Œæˆ‘ä»¬å¯çŸ¥ï¼šè½¬ç§» $k$ æ¬¡ï¼Œ$g[k, j]$ å°±è¡¨ç¤ºä¸€å¼€å§‹å‡†è€ƒè¯å·åŒ¹é… $A$ çš„å‰ $k$ ä½æ—¶ï¼Œå‡†è€ƒè¯å·å¢åŠ  $k$ ä¸ªå­—ç¬¦ï¼Œä½¿ $A$ æ²¿ç€å¤±é…æŒ‡é’ˆæ‰¾åˆ°çš„æœ€å¤§åŒ¹é…ä½æ•° $j$ï¼ˆç®—ä¸Šæ–°åŒ¹é…çš„ $k$ ä½ï¼‰çš„æ–¹æ¡ˆæ•°ã€‚</p><p>åŒç†ï¼Œè½¬ç§» $n$ æ¬¡ï¼Œ$g[i, j]$ å°±è¡¨ç¤ºä¸€å¼€å§‹å‡†è€ƒè¯å·åŒ¹é… $A$ çš„å‰ $i$ ä½æ—¶ï¼Œå‡†è€ƒè¯å·å¢åŠ  $n$ ä¸ªå­—ç¬¦ï¼Œä½¿ $A$ æ²¿ç€å¤±é…æŒ‡é’ˆæ‰¾åˆ°çš„æœ€å¤§åŒ¹é…ä½æ•° $j$ï¼ˆç®—ä¸Šæ–°åŒ¹é…çš„ $n$ ä½ï¼‰çš„æ–¹æ¡ˆæ•°ã€‚</p><p>æˆ‘ä»¬åˆçŸ¥é“ï¼Œä¸€å¼€å§‹å‡†è€ƒè¯å·åŒ¹é… $A$ çš„ $0$ ä½ï¼Œæ‰€ä»¥æœ€åçš„ç­”æ¡ˆå°±æ˜¯ $\sum\limits_{i = 0}^{m - 1}g[0, i]$ ã€‚</p><p>æœ‰ä¸€å®šçš„æ€ç»´éš¾åº¦ï¼Œé‡è¦çš„è¿˜æ˜¯è½¬ç§»æ–¹ç¨‹å¼å§ã€‚ã€‚é¢ï¼Œå¯¹äºæˆ‘è¿™ä¸ª DP æ¸£æ¸£æ¥è¯´ï¼ŒDP é¢˜è¿˜è¦åˆ‡å¾ˆå¤šã€‚ã€‚ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, mod;</span><br><span class="line"><span class="keyword">int</span> nxt[<span class="number">30</span>], b[<span class="number">30</span>][<span class="number">30</span>], a[<span class="number">30</span>][<span class="number">30</span>];</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">30</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> a[<span class="number">30</span>][<span class="number">30</span>], <span class="keyword">int</span> b[<span class="number">30</span>][<span class="number">30</span>], <span class="keyword">int</span> ans[<span class="number">30</span>][<span class="number">30</span>])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> tmp[<span class="number">30</span>][<span class="number">30</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; j++) &#123;</span><br><span class="line">            tmp[i][j] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; m; k++)</span><br><span class="line">                tmp[i][j] = (tmp[i][j] + a[i][k] * b[k][j]) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; j++)</span><br><span class="line">            ans[i][j] = tmp[i][j];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;n, &amp;m, &amp;mod);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">    nxt[<span class="number">0</span>] = nxt[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="keyword">while</span> (j &amp;&amp; s[j + <span class="number">1</span>] != s[i]) j = nxt[j];</span><br><span class="line">        nxt[i] = (s[j + <span class="number">1</span>] == s[i] ? ++j : <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">9</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">int</span> t = i;</span><br><span class="line">            <span class="keyword">while</span> (t &amp;&amp; s[t + <span class="number">1</span>] - <span class="string">'0'</span> != j) t = nxt[t];</span><br><span class="line">            <span class="keyword">if</span> (s[t + <span class="number">1</span>] - <span class="string">'0'</span> == j) ++t;</span><br><span class="line">            <span class="keyword">if</span> (t != m)</span><br><span class="line">                b[i][t] = (b[i][t] + <span class="number">1</span>) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) a[i][i] = <span class="number">1</span>;  <span class="comment">// å•ä½çŸ©é˜µ</span></span><br><span class="line">    <span class="keyword">for</span> (; n ; n &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n &amp; <span class="number">1</span>) mul(a, b, a);</span><br><span class="line">        mul(b, b, b);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) res = (res + a[<span class="number">0</span>][i]) % mod;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, res);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> KMP </tag>
            
            <tag> çŸ©é˜µä¹˜æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è«æ¯”ä¹Œæ–¯å‡½æ•°æ±‚æ³•</title>
      <link href="2019/05/04/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%87%BD%E6%95%B0%E6%B1%82%E6%B3%95/"/>
      <url>2019/05/04/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%87%BD%E6%95%B0%E6%B1%82%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h3 id="O-n-çº¿æ€§æ±‚æ³•"><a href="#O-n-çº¿æ€§æ±‚æ³•" class="headerlink" title="O(n) çº¿æ€§æ±‚æ³•"></a>O(n) çº¿æ€§æ±‚æ³•</h3><hr><p>ä¸éš¾ç†è§£ï¼Œå°±æ˜¯åœ¨æ¬§æ‹‰çº¿æ€§ç­›çš„æ—¶å€™é¡ºä¾¿æ±‚çš„ã€‚ä¸è¿‡æœ‰ä¸ªé…·ç‚«çš„åå­—ï¼Œå«â€œO(n) é€’æ¨æ±‚è§£â€ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> vis[N], prime[N], mu[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Mobius</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    m = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i]) &#123;</span><br><span class="line">            prime[++m] = i;</span><br><span class="line">            mu[i] = <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (prime[j] * i &gt; n) <span class="keyword">break</span>;</span><br><span class="line">            vis[i * prime[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % prime[j] == <span class="number">0</span>) &#123;</span><br><span class="line">                mu[i * prime[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            mu[i * prime[j]] = -mu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="sqrt-n-å•ç‹¬æ±‚è§£"><a href="#sqrt-n-å•ç‹¬æ±‚è§£" class="headerlink" title="sqrt(n) å•ç‹¬æ±‚è§£"></a>sqrt(n) å•ç‹¬æ±‚è§£</h3><hr><p>è¿™ä¸ªåŸºæœ¬æ“ä½œ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">get_mu</span><span class="params">(ll n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mu = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">if</span> (n % i == <span class="number">0</span>) &#123;</span><br><span class="line">            mu = -mu;</span><br><span class="line">            n /= i;</span><br><span class="line">            <span class="keyword">if</span> (n % i == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>) mu = -mu;</span><br><span class="line">    <span class="keyword">return</span> mu;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="O-nlogn-è°ƒå’Œçº§æ•°å¤æ‚åº¦æ±‚æ³•"><a href="#O-nlogn-è°ƒå’Œçº§æ•°å¤æ‚åº¦æ±‚æ³•" class="headerlink" title="O(nlogn) è°ƒå’Œçº§æ•°å¤æ‚åº¦æ±‚æ³•"></a>O(nlogn) è°ƒå’Œçº§æ•°å¤æ‚åº¦æ±‚æ³•</h3><hr><p>è¿™ä¸ªæœ‰ç‚¹å¦™ï¼<br>ï¼ˆç›®å‰ä¸çŸ¥é“åŸç†ï¼Œç•™å‘å¾…å¡«ï¼‰</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> mu[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + i; j &lt;= n; j += i) mu[j] -= mu[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> è«æ¯”ä¹Œæ–¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºäº¤äº’çš„ä¸€äº›è§£é¢˜å§¿åŠ¿</title>
      <link href="2019/05/04/%E5%85%B3%E4%BA%8E%E4%BA%A4%E4%BA%92%E7%9A%84%E4%B8%80%E4%BA%9B%E8%A7%A3%E9%A2%98%E5%A7%BF%E5%8A%BF/"/>
      <url>2019/05/04/%E5%85%B3%E4%BA%8E%E4%BA%A4%E4%BA%92%E7%9A%84%E4%B8%80%E4%BA%9B%E8%A7%A3%E9%A2%98%E5%A7%BF%E5%8A%BF/</url>
      
        <content type="html"><![CDATA[<p>Â· æŠŠäº¤äº’æ“ä½œåŒ…æˆå‡½æ•°ï¼ˆå¦‚æœå¿˜å†™ fflush(stdout) å°±ä¸è‡³äºç»æœ›é€é¡¶ã€‚ã€‚ï¼‰</p><p>Â· äº¤äº’ä¸­ï¼Œscanf å’Œ printf æ˜¯å’Œäº¤äº’åº“çš„ stdout å’Œ stdin æ¥ä¸Šçš„ï¼Œæ‰€ä»¥ä½ å¹¶ä¸èƒ½çœ‹åˆ°è¾“å‡ºçš„ä¿¡æ¯</p><p>Â· äº¤äº’æ“ä½œä¸­ï¼Œåªæœ‰è¾“å‡ºåæ‰éœ€è¦ fflush(stdout)</p><p>Â· å¦‚æœä½ æƒ³çœ‹åˆ°è¾“å‡ºä¿¡æ¯ï¼Œé‚£ä¹ˆç”¨ fprintf(stderr, â€œblabla\nâ€) å§</p><p>Â· äº¤äº’é¢˜è®©äººæ„Ÿåˆ° â€œè¸ç©ºè€Œè¡Œâ€ã€‚å¦‚æœä¸æƒ³è¿™æ ·ï¼Œå°±å†™ä¸€ä¸ª interactor.cppï¼Œè‡ªå·±é€ æ•°æ®å’Œè¿›è¡Œäº¤äº’ï¼</p><p>æ‰“äº†ä¸€åœº CodeJamï¼Œæ”¶è·äº†ä¸€ä¸ªä¼˜è´¨çš„ interactive_runner.py! ï¼ˆåœ¨æˆ‘çš„ç”µè„‘ä¸­çš„ Workspace - Programs - Template æ–‡ä»¶å¤¹ä¸­ï¼‰</p><p>ç»ˆç«¯ä¸­æ€ä¹ˆè¿è¡Œå‘¢ï¼Ÿpython interactive_runner.py ./interactor â€“ ./main</p><p>â¬†ï¸å…¶ä¸­ï¼Œinteractive_runner.py æ˜¯è¿è¡Œç¨‹åºï¼Œinteractive.cpp æ˜¯ä½ è‡ªå·±å†™çš„äº¤äº’ç¨‹åºï¼Œmain.cpp æ˜¯ä½ è‡ªå·±å†™çš„ä¸»ç¨‹åº</p>]]></content>
      
      
      
        <tags>
            
            <tag> å…¶ä»– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CodeJam2019-R1c</title>
      <link href="2019/05/04/CodeJam2019-R1c/"/>
      <url>2019/05/04/CodeJam2019-R1c/</url>
      
        <content type="html"><![CDATA[<h3 id="A-Robot-Programming-Strategy"><a href="#A-Robot-Programming-Strategy" class="headerlink" title="A. Robot Programming Strategy"></a>A. Robot Programming Strategy</h3><hr><p>åˆ†ç±»è®¨è®ºæ¯ä¸€ä½ posï¼š</p><p>å¦‚æœ pos è¿™ä½ï¼Œåªæœ‰ä¸€ç§å­—ç¬¦ï¼Œé‚£ä¹ˆæ˜¾ç„¶æœ‰è§£ï¼›</p><p>å¦‚æœæœ‰ä¸‰ç§å­—ç¬¦ï¼Œä¸ç®¡ç­”æ¡ˆä¸²å½“å‰ä½ä¸ºä»€ä¹ˆï¼Œéƒ½ä¼šè¢«æŸç§å­—ç¬¦å…‹åˆ¶ï¼Œæ˜¾ç„¶æ— è§£ï¼›</p><p>å¦‚æœæœ‰ä¸¤ç§å­—ç¬¦ï¼Œé‚£ä¹ˆå½“å‰åªæœ‰ä¸€ç§é€‰æ‹©ï¼Œå³ï¼šæ‰“å¹³ä¸€ç§å­—ç¬¦ï¼Œèµ¢è¿‡å¦ä¸€ç§å­—ç¬¦ã€‚</p><p>dfsï¼</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">505</span>;</span><br><span class="line"><span class="keyword">int</span> T, n, len[N], S[<span class="number">505</span>], a[<span class="number">505</span>], L;</span><br><span class="line"><span class="built_in">string</span> c[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> pos)</span> </span>&#123; <span class="keyword">return</span> c[i][pos % len[i]]; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> pos)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (pos == <span class="number">500</span>) <span class="keyword">return</span> <span class="number">0</span>;  <span class="comment">// è«å¿˜</span></span><br><span class="line">    L++;</span><br><span class="line">    <span class="keyword">int</span> cnt[<span class="number">3</span>];</span><br><span class="line">    <span class="built_in">memset</span>(cnt, <span class="number">0</span>, <span class="keyword">sizeof</span>(cnt));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">if</span> (S[i]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (calc(i, pos) == <span class="string">'R'</span>) cnt[<span class="number">0</span>]++;</span><br><span class="line">        <span class="keyword">if</span> (calc(i, pos) == <span class="string">'S'</span>) cnt[<span class="number">1</span>]++;</span><br><span class="line">        <span class="keyword">if</span> (calc(i, pos) == <span class="string">'P'</span>) cnt[<span class="number">2</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) <span class="keyword">if</span> (cnt[i]) num++;</span><br><span class="line">    <span class="keyword">if</span> (num == <span class="number">3</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (num == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) <span class="keyword">if</span> (cnt[i]) &#123;</span><br><span class="line">            a[pos] = (i + <span class="number">2</span>) % <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)</span><br><span class="line">        <span class="keyword">if</span> (cnt[i] &amp;&amp; cnt[(i + <span class="number">1</span>) % <span class="number">3</span>]) &#123;</span><br><span class="line">            a[pos] = i;</span><br><span class="line">            <span class="keyword">int</span> k = (i + <span class="number">1</span>) % <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (calc(j, pos) == <span class="string">'R'</span> &amp;&amp; !k) S[j] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">if</span> (calc(j, pos) == <span class="string">'S'</span> &amp;&amp; k == <span class="number">1</span>) S[j] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">if</span> (calc(j, pos) == <span class="string">'P'</span> &amp;&amp; k == <span class="number">2</span>) S[j] = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> dfs(pos + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line">        L = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) S[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; c[i];</span><br><span class="line">            len[i] = c[i].length();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: "</span>, cas);</span><br><span class="line">        <span class="keyword">if</span> (!dfs(<span class="number">0</span>)) <span class="built_in">puts</span>(<span class="string">"IMPOSSIBLE"</span>);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; L; i++)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%c"</span>, a[i] == <span class="number">0</span> ? <span class="string">'R'</span> : (a[i] == <span class="number">1</span> ? <span class="string">'S'</span> : <span class="string">'P'</span>));</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-Power-Arrangers"><a href="#B-Power-Arrangers" class="headerlink" title="B. Power Arrangers"></a>B. Power Arrangers</h3><hr><p>æ˜¯äº¤äº’é¢˜ï¼</p><p>æ€»å…± 595 ä¸ªæ•°å­—ã€‚åˆ†ä¸‰è½®ã€‚</p><ol><li><p>è¯¢é—® 119 ä¸ªåºåˆ—çš„é¦–ä½ï¼Œæˆ‘ä»¬å‘ç° A B C D E çš„æ•°é‡å¿…å®šæœ‰ä¸€ä¸ªæ˜¯æ¯”åˆ«äººå°‘ä¸€çš„ï¼Œé‚£ä¹ˆç­”æ¡ˆåºåˆ—çš„é¦–ä½å°±æ˜¯å®ƒã€‚</p></li><li><p>è¯¢é—® 23ï¼ˆ23 = (119 + 1) / 5 - 1ï¼‰ä¸ªåºåˆ—çš„æ¬¡ä½ï¼Œblaâ€¦blaâ€¦bla</p></li><li><p>è¯¢é—® 5ï¼ˆ5 = (23 + 1) / 4 - 1ï¼‰ä¸ªåºåˆ—çš„ç¬¬ä¸‰ä½ï¼Œblaâ€¦blaâ€¦bla</p></li><li><p>è¯¢é—® 1 (1 = (5 + 1) / 3 - 1) ä¸ªã€‚ã€‚ã€‚è¯¶ï¼Ÿåªæœ‰ä¸€ä¸ªäº†ï¼Ÿé‚£ä¹ˆç›´æ¥è¯¢é—®å®ƒçš„ç¬¬å››ä½ï¼Œé¡ºä¾¿ä¹Ÿèƒ½å¾—å‡ºç¬¬äº”ä½äº†ï¼</p></li></ol><p>è¿™è¾¹æœ‰ä¸ªæ˜“é”™ç‚¹ï¼šå‡è®¾è¯¢é—®çš„ç¬¬å››ä½æ˜¯ Cï¼Œç¬¬äº”ä½æ˜¯ Dï¼Œè¿™ä¸ª * * * C D åºåˆ—æ˜¯è¿˜å­˜åœ¨çš„ï¼Œæ²¡æœ‰è¢«åˆ é™¤çš„ï¼æ‰€ä»¥ç­”æ¡ˆåºåˆ—æ˜¯ * * * D C! è¿™ä¸ªä¸€å®šè¦æ³¨æ„</p><p>ç„¶åæˆ‘ä»¬ç®—ä¸€å‘â€¦ 119 + 23 + 5 + 1 + 1 = 149 ï¼ç¦» 150 æ¬¡åªæœ‰ä¸€æ­¥ä¹‹é¥â€¦ å¡çš„å¥½ç´§â€¦</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T, F;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">700</span>], ans[<span class="number">10</span>], cnt[<span class="number">10</span>];</span><br><span class="line"><span class="keyword">char</span> t[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> _count;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getn</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    _count ++;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, p);</span><br><span class="line">    fflush(<span class="built_in">stdout</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, t);</span><br><span class="line">    <span class="keyword">return</span> t[<span class="number">0</span>] - <span class="string">'A'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;T, &amp;F);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line">        _count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">3</span>; i++) &#123;</span><br><span class="line">            <span class="built_in">memset</span>(cnt, <span class="number">0</span>, <span class="keyword">sizeof</span>(cnt));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">119</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">bool</span> ff = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt; i; k++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (a[(j - <span class="number">1</span>) * <span class="number">5</span> + k] != ans[k]) &#123;</span><br><span class="line">                        ff = <span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (ff) &#123;</span><br><span class="line">                    <span class="keyword">int</span> p = (j - <span class="number">1</span>) * <span class="number">5</span> + i;</span><br><span class="line">                    a[p] = getn(p);</span><br><span class="line">                    cnt[a[p]]++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> id = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; <span class="number">5</span>; j++)</span><br><span class="line">                <span class="keyword">if</span> (!cnt[id]) id = j;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (cnt[id] &gt; cnt[j] &amp;&amp; cnt[j]) id = j;</span><br><span class="line">            <span class="comment">// fprintf(stderr, "%d\n", cnt[id]);</span></span><br><span class="line">            ans[i] = id;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">119</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> p = (i - <span class="number">1</span>) * <span class="number">5</span>;</span><br><span class="line">            <span class="keyword">bool</span> ff = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">3</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (a[p + j] != ans[j]) &#123;</span><br><span class="line">                    ff = <span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (ff == <span class="number">1</span>) &#123;</span><br><span class="line">                ans[<span class="number">5</span>] = getn(p + <span class="number">4</span>);</span><br><span class="line">                ans[<span class="number">4</span>] = getn(p + <span class="number">5</span>);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++) <span class="built_in">printf</span>(<span class="string">"%c"</span>, ans[i] + <span class="string">'A'</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">        fflush(<span class="built_in">stdout</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, t);</span><br><span class="line">        <span class="keyword">if</span> (t[<span class="number">0</span>] == <span class="string">'N'</span>) <span class="keyword">break</span>;</span><br><span class="line">        <span class="comment">// fprintf(stderr, "%d\n", _count);</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-Bacterial-Tactics"><a href="#C-Bacterial-Tactics" class="headerlink" title="C. Bacterial Tactics"></a>C. Bacterial Tactics</h3><hr><p>æ˜¯åšå¼ˆï¼</p><p>æˆ‘ä»¬å‘ç° R å’Œ C éƒ½éå¸¸å°ï¼å¯ä»¥ç”¨ SG å‡½æ•° + è®°å¿†åŒ–æœç´¢ã€‚</p><p>å¯ä»¥æŠŠæ¨ªå‘æˆ–çºµå‘æ”¾ç»†èŒï¼Œå½¢è±¡çœ‹æˆ æ¨ªç€æˆ–ç«–ç€ pia åˆ€ã€‚ã€‚ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---------------</span><br><span class="line">|      |      |</span><br><span class="line">|      |      |</span><br><span class="line">|      |      |</span><br><span class="line">|      |      |</span><br><span class="line">|      |      |</span><br><span class="line">---------------</span><br><span class="line">å›¾ <span class="number">1</span></span><br></pre></td></tr></table></figure><p>å¦‚å›¾ 1ï¼Œæˆ‘ä»¬åœ¨ä¸­é—´ç«–ç€ pia äº†ä¸€åˆ€ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">---------------</span><br><span class="line">|      |      |</span><br><span class="line">|      |      |</span><br><span class="line">|------|      |</span><br><span class="line">|      |      |</span><br><span class="line">|      |      |</span><br><span class="line">---------------</span><br><span class="line">å›¾ <span class="number">2</span></span><br></pre></td></tr></table></figure><p>å¦‚å›¾ 2ï¼Œæˆ‘ä»¬åœ¨å·¦è¾¹é‚£å—æ¨ªç€ pia äº†ä¸€åˆ€ã€‚æˆ‘ä»¬å‘ç°ï¼Œåˆ€ç—•æœ‰å¯èƒ½ä¼šè¢«ä¹‹å‰çš„åˆ€ç—•åŠè·¯æ‹¦æˆªã€‚æ‰€ä»¥å·¦è¾¹çš„æ“ä½œå¯¹å³è¾¹åŠå—æ¯«æ— å½±å“ã€‚</p><p>è¿™æ ·å¥½åŠäº†ï¼šå·¦å³åŠå—åˆ†åˆ«å¯è§†ä¸ºä¸¤ä¸ªå­é—®é¢˜ã€‚æˆ‘ä»¬ç”¨ SG[x1, y1, x2, y2] è¡¨ç¤ºå·¦ä¸Šè§’ä¸º (x1, y1)ï¼Œå³ä¸‹è§’ä¸º (x2, y2) çš„çŸ©é˜µçš„ SG å‡½æ•°å€¼ã€‚æšä¸¾ç«–ç€ pia å“ªä¸€åˆ—ï¼Œæ¨ªç€ pia å“ªä¸€è¡Œï¼ŒåŠ ä¸Šç¥å¥‡çš„ mex å‡½æ•°ï¼Œå°±æ˜¯ä¸€ä¸ªåƒæ¨¡åƒæ ·çš„åšå¼ˆè§£æ³•ã€‚åˆ«å¿˜åˆ¤å½“å‰æ“ä½œåˆæ³•æ€§ï¼</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> T, n, m, SG[<span class="number">20</span>][<span class="number">20</span>][<span class="number">20</span>][<span class="number">20</span>];</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">20</span>][<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x0, <span class="keyword">int</span> y0, <span class="keyword">int</span> x2, <span class="keyword">int</span> y2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x0 &gt; x2 || y0 &gt; y2) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (SG[x0][y0][x2][y2] != <span class="number">-1</span>) <span class="keyword">return</span> SG[x0][y0][x2][y2];  <span class="comment">// è®°å¿†åŒ–</span></span><br><span class="line">    <span class="keyword">bool</span> c[<span class="number">60</span>];</span><br><span class="line">    <span class="built_in">memset</span>(c, <span class="number">0</span>, <span class="keyword">sizeof</span>(c));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = x0; i &lt;= x2; i++) &#123;</span><br><span class="line">        <span class="comment">// åˆ¤åˆæ³•æ€§</span></span><br><span class="line">        <span class="keyword">bool</span> ff = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = y0; j &lt;= y2; j++) <span class="keyword">if</span> (s[i][j] == <span class="string">'#'</span>) &#123;</span><br><span class="line">            ff = <span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">        &#125; <span class="keyword">if</span> (!ff) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        c[dfs(x0, y0, i - <span class="number">1</span>, y2) ^ dfs(i + <span class="number">1</span>, y0, x2, y2)] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = y0; i &lt;= y2; i++) &#123;</span><br><span class="line">        <span class="keyword">bool</span> ff = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = x0; j &lt;= x2; j++) <span class="keyword">if</span> (s[j][i] == <span class="string">'#'</span>) &#123;</span><br><span class="line">            ff = <span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">        &#125; <span class="keyword">if</span> (!ff) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">        c[dfs(x0, y0, x2, i - <span class="number">1</span>) ^ dfs(x0, i + <span class="number">1</span>, x2, y2)] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">60</span>; i++) <span class="keyword">if</span> (!c[i]) &#123;</span><br><span class="line">        SG[x0][y0][x2][y2] = i; <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">        <span class="built_in">memset</span>(SG, <span class="number">-1</span>, <span class="keyword">sizeof</span>(SG));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s[i] + <span class="number">1</span>);</span><br><span class="line">        dfs(<span class="number">1</span>, <span class="number">1</span>, n, m);</span><br><span class="line">        <span class="keyword">int</span> ans;</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">bool</span> ff = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++) <span class="keyword">if</span> (s[i][j] == <span class="string">'#'</span>) &#123;</span><br><span class="line">                ff = <span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">if</span> (!ff) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> ((dfs(<span class="number">1</span>, <span class="number">1</span>, i - <span class="number">1</span>, m) ^ dfs(i + <span class="number">1</span>, <span class="number">1</span>, n, m)) == <span class="number">0</span>) ans += m;  <span class="comment">// å¯¹äºå¯¹æ‰‹æ˜¯å¿…è´¥æ€ï¼Œåˆ™å¯¹äºæˆ‘æ˜¯å¿…èƒœæ€</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">            <span class="keyword">bool</span> ff = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) <span class="keyword">if</span> (s[j][i] == <span class="string">'#'</span>) &#123;</span><br><span class="line">                ff = <span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">if</span> (!ff) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> ((dfs(<span class="number">1</span>, <span class="number">1</span>, n, i - <span class="number">1</span>) ^ dfs(<span class="number">1</span>, i + <span class="number">1</span>, n, m)) == <span class="number">0</span>) ans += n;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %d\n"</span>, cas, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[CF600E]-Lomsat gelral</title>
      <link href="2019/04/02/%5BCF600E%5D-Lomsat%20gelral/"/>
      <url>2019/04/02/%5BCF600E%5D-Lomsat%20gelral/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/600/problem/E" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>å¤§æ¦‚æ„æ€å°±æ˜¯è®©ä½ æ±‚æ¯ä¸ªå­æ ‘å†…é¢œè‰²æ•°æœ€å¤šçš„é¢œè‰²æ€»å’Œï¼ˆæœ‰ç‚¹ç»•ã€‚ã€‚</p><p>å…¶å®æ˜¯ä¸ªæ¨¡ç‰ˆé¢˜ï¼æˆ‘å…ˆç”¨æ ‘ä¸Šå¯å‘å¼åˆå¹¶ (dsu on tree) è¿‡çš„ã€‚</p><p>æ ‘ä¸Šå¯å‘å¼åˆå¹¶å…¶å®å°±æ˜¯æš´åŠ›çš„ä¼˜åŒ–ç‰ˆï¼å¤§æ¦‚æ­¥éª¤ä¸ºï¼š</p><p>å¤„ç†è½»å„¿å­(æ¸…é™¤è½»å„¿å­ä¿¡æ¯) -&gt; å¤„ç†é‡å„¿å­(ä¸æ¸…é™¤é‡å„¿å­ä¿¡æ¯) -&gt; å†åŠ å…¥è½»å„¿å­ä¿¡æ¯ï¼Œè®¡ç®—çˆ¶äº²ä¿¡æ¯ -&gt; å¦‚æœå½“å‰çˆ¶äº²ä¸ºç¥–çˆ¶çš„è½»å„¿å­ï¼Œæ¸…é™¤çˆ¶äº²åŠå…¶å­æ ‘ä¿¡æ¯.</p><p>å…¶å®å°±æ˜¯å°† $size$ è¾ƒå°çš„ï¼ˆæ­¤å¤„ä½“ç°ä¸ºè½»å„¿å­ï¼‰åˆå¹¶åˆ° $size$ è¾ƒå¤§çš„ï¼ˆæ­¤å¤„ä½“ç°ä¸ºé‡å„¿å­ï¼‰ä¸Šï¼Œä»è€Œè¾¾åˆ°é™ä½å¤æ‚åº¦çš„æ•ˆæœã€‚å¦‚ä½•åˆ†æå¤æ‚åº¦å‘¢ï¼Ÿä¸€ä¸ªè½»å„¿å­å­æ ‘é‡Œçš„ç‚¹è‡³å¤šä¼šè¢«æ¶ˆé™¤ $logN$ æ¬¡ï¼ˆå› ä¸ºè¿™ç‚¹ä¸Šé¢æœ€å¤šæœ‰ $logN$ æ¡è¾¹ï¼‰ï¼Œåˆ©ç”¨è½»é‡é“¾å‰–åˆ†çš„æ€æƒ³ï¼Œå°±èƒ½ $O(nlogn)$ è§£å†³é—®é¢˜ã€‚ï¼ˆæ­¤å¤„å‡è®¾åˆå¹¶ä¿¡æ¯æ˜¯ $O(1)$ çš„ï¼‰</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dsu on tree</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, mx;</span><br><span class="line"><span class="keyword">int</span> a[N], f[N], sz[N], son[N], vis[N];</span><br><span class="line"><span class="keyword">int</span> to[N &lt;&lt; <span class="number">1</span>], nxt[N &lt;&lt; <span class="number">1</span>], lnk[N], tot;</span><br><span class="line">ll sum, ans[N], cnt[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    to[++tot] = y, nxt[tot] = lnk[x], lnk[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    f[x] = fa;</span><br><span class="line">    sz[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (y == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(y, x);</span><br><span class="line">        sz[x] += sz[y];</span><br><span class="line">        <span class="keyword">if</span> (sz[y] &gt; sz[son[x]]) son[x] = y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    cnt[a[x]] += val;</span><br><span class="line">    <span class="keyword">if</span> (cnt[a[x]] == mx) sum += a[x];</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (cnt[a[x]] &gt; mx) sum = a[x], mx = cnt[a[x]];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i])</span><br><span class="line">        <span class="keyword">if</span> (to[i] != f[x] &amp;&amp; !vis[to[i]])</span><br><span class="line">            calc(to[i], val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (y != f[x] &amp;&amp; y != son[x]) dfs2(y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (son[x]) dfs2(son[x]), vis[son[x]] = <span class="number">1</span>;</span><br><span class="line">    calc(x, <span class="number">1</span>);</span><br><span class="line">    ans[x] = sum;</span><br><span class="line">    <span class="keyword">if</span> (son[x]) <span class="comment">// = if (son[x] &amp;&amp; son[f[x]] != x)</span></span><br><span class="line">        vis[son[x]] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (son[f[x]] != x) calc(x, <span class="number">-1</span>), sum = <span class="number">0</span>, mx = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        add(x, y), add(y, x);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    dfs2(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">"%lld "</span>, ans[i]);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰ä¸€ç§æ–¹æ³•ï¼šçº¿æ®µæ ‘åˆå¹¶ã€‚é¡¾åæ€ä¹‰ï¼Œä¹Ÿæ˜¯ä¸€ç§åˆå¹¶ã€‚è¿™æ˜¯åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šå¼€ä¸€æ£µçº¿æ®µæ ‘ï¼Œæ¯æ¬¡å°†å„¿å­çš„çº¿æ®µæ ‘åˆå¹¶åˆ°çˆ¶äº²çš„çº¿æ®µæ ‘é‡Œã€‚å‡è®¾åˆå¹¶æ“ä½œæ˜¯ logN çš„ã€‚çº¿æ®µæ ‘åˆå¹¶å¤æ‚åº¦å–å†³äºé‡åˆèŠ‚ç‚¹ä¸ªæ•°ï¼Œè€Œç°å®ä¸­ä¸€èˆ¬é‡åˆè¾ƒå°‘ï¼Œå¯ä»¥è§†ä¸º logNï¼Œå› æ­¤å¤æ‚åº¦å˜›ï¼Œï¼ŒO(nlogn)?</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// çº¿æ®µæ ‘åˆå¹¶</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> * <span class="number">20</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, c[N], id;</span><br><span class="line"><span class="keyword">int</span> to[N], nxt[N], lnk[N], tot;</span><br><span class="line"><span class="keyword">int</span> ls[N], rs[N], mx[N], rt[N];</span><br><span class="line">ll sum[N], ans[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    to[++tot] = y, nxt[tot] = lnk[x], lnk[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">    x = ++id;</span><br><span class="line">    sum[x] = val, mx[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (l == r) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (val &lt;= mid) insert(ls[x], l, mid, val);</span><br><span class="line">    <span class="keyword">else</span> insert(rs[x], mid + <span class="number">1</span>, r, val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> l = ls[x], r = rs[x];</span><br><span class="line">    mx[x] = mx[l], sum[x] = sum[l];</span><br><span class="line">    <span class="keyword">if</span> (mx[r] == mx[x]) sum[x] += sum[r];</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (mx[r] &gt; mx[x]) sum[x] = sum[r], mx[x] = mx[r];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x || !y) <span class="keyword">return</span> x | y;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123; mx[x] += mx[y]; <span class="keyword">return</span> x; &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    ls[x] = merge(ls[x], ls[y], l, mid);</span><br><span class="line">    rs[x] = merge(rs[x], rs[y], mid + <span class="number">1</span>, r);</span><br><span class="line">    upd(x);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    insert(rt[x], <span class="number">1</span>, n, c[x]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (y == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(y, x);</span><br><span class="line">        rt[x] = merge(rt[x], rt[y], <span class="number">1</span>, n);</span><br><span class="line">    &#125;</span><br><span class="line">    ans[x] = sum[rt[x]];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;c[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        add(x, y), add(y, x);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">"%lld "</span>, ans[i]);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®è¿™é¢˜ä¸¤ç§éƒ½å¾ˆå¥½å†™å•Šï¼(x</p>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘åˆå¹¶ </tag>
            
            <tag> æ ‘ä¸Šå¯å‘å¼åˆå¹¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[CF1C]-Ancient Berland Circus</title>
      <link href="2019/03/03/%5BCF1C%5D-Ancient%20Berland%20Circus/"/>
      <url>2019/03/03/%5BCF1C%5D-Ancient%20Berland%20Circus/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/problemset/problem/1/C" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>å¹³ç”Ÿç¬¬ä¸€é“è®¡ç®—å‡ ä½• ( *ï½€Ï‰Â´) æœ‰ç‚¹è¢«å“åˆ°äº†ï¼Œåˆ›ä¸–çºªåˆçš„ CF T3 éƒ½æ˜¯è¿™ç§é£æ ¼çš„å˜› âˆ‘(ï¾ŸĞ”ï¾Ÿ)</p><p>å…¶å®é¢˜ç›®è¿˜æŒºå‹å¥½ã€‚è¿™ä¸ªå¤šè¾¹å½¢ä¸­å¿ƒåˆ°ç»™å®šçš„ä¸‰ä¸ªç‚¹è·ç¦»ç›¸ç­‰ï¼Œè®¾è¿™ä¸ªè·ç¦»ä¸º disã€å¤šè¾¹å½¢ä¸­å¿ƒä¸º Oï¼Œæˆ‘ä»¬ä»¥ O ä¸ºåœ†å¿ƒï¼Œä»¥ dis ä¸ºåŠå¾„ä½œåœ†ï¼Œè¿™å°±æ˜¯ä¿—ç§°çš„â€œå¤–æ¥åœ†â€å•¦ã€‚ä¸‰ä¸ªç‚¹ä¹Ÿéƒ½åœ¨è¿™ä¸ªå¤–æ¥åœ†ä¸Šã€‚</p><p>æˆ‘ä»¬å‘ç°ï¼Œå¤šè¾¹å½¢è¾¹æ•°è¶Šå°‘ï¼Œå…¶é¢ç§¯è¶Šå°ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> è®¡ç®—å‡ ä½• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[BZOJ1123]-BLO</title>
      <link href="2019/03/03/%5BBZOJ1123%5D-BLO/"/>
      <url>2019/03/03/%5BBZOJ1123%5D-BLO/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.lydsy.com/JudgeOnline/problem.php?id=1123" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>æ ¹æ®å‰²ç‚¹çš„å®šä¹‰ï¼Œè‹¥èŠ‚ç‚¹ $i$ ä¸æ˜¯å‰²ç‚¹ï¼Œåˆ™æŠŠä¸ $i$ ç›¸è¿çš„è¾¹åˆ é™¤åï¼Œåªæœ‰ $i$ ä¸å…¶ä»– $n - 1$ ä¸ªç‚¹ä¸è¿é€šï¼Œè€Œå…¶ä»– $n - 1$ ä¸ªç‚¹ä¹‹é—´è¿˜éƒ½æ˜¯è¿é€šçš„ï¼Œï¼ˆæ³¨æ„æ˜¯æœ‰åºç‚¹å¯¹ï¼ï¼‰åˆ™æ­¤æ—¶ç­”æ¡ˆä¸º $2(n - 1)$.</p><p>å¦åˆ™ï¼Œå»æ‰ $i$ åï¼Œä¼šåˆ†æˆè‹¥å¹²ä¸ªè¿é€šå—ï¼Œæˆ‘ä»¬åº”æ±‚å‡ºæ¯ä¸ªè¿é€šå—çš„å¤§å°ï¼Œä¸¤ä¸¤ç›¸ä¹˜å†ç›¸åŠ ã€‚</p><p>æˆ‘ä»¬å¯ä»¥åœ¨ Tarjan ç®—æ³•æ‰§è¡Œæ·±åº¦ä¼˜å…ˆéå†çš„è¿‡ç¨‹ä¸­ï¼Œé¡ºä¾¿æ±‚å‡ºæœç´¢æ ‘æ¯æ£µå­æ ‘çš„å¤§å°ï¼Œè¿™æ ·ï¼Œå¦‚æœ $y \in Son(x)$, $low[y] \geq dfn[x]$, å…³äº $x$ çš„è¾¹å…¨éƒ¨æ–­äº†å $y$ åŠ $y$ çš„å­æ ‘å°±æ˜¯ä¸€ä¸ªè¿é€šåˆ†é‡ï¼Œå®ƒçš„å¤§å°åº”è¯¥å¾ˆå¥½æ±‚å§ï¼Ÿ</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>, M = <span class="number">5e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> lnk[N], nxt[M &lt;&lt; <span class="number">1</span>], to[M &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> dfn[N], low[N], size[N], cut[N];</span><br><span class="line">ll ans[N];</span><br><span class="line"><span class="keyword">int</span> n, m, tot, num;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    to[++tot] = y, nxt[tot] = lnk[x], lnk[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    dfn[x] = low[x] = ++num; size[x] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> flag = <span class="number">0</span>, sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (!dfn[y]) &#123;</span><br><span class="line">            tarjan(y);</span><br><span class="line">            size[x] += size[y];</span><br><span class="line">            low[x] = min(low[x], low[y]);</span><br><span class="line">            <span class="keyword">if</span> (low[y] &gt;= dfn[x]) &#123;</span><br><span class="line">                flag++;</span><br><span class="line">                ans[x] += (ll)size[y] * (n - size[y]);</span><br><span class="line">                sum += size[y];</span><br><span class="line">                <span class="keyword">if</span> (x != <span class="number">1</span> || flag &gt; <span class="number">1</span>) cut[x] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> low[x] = min(low[x], dfn[y]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (cut[x])</span><br><span class="line">        ans[x] += (ll)(n - sum - <span class="number">1</span>) * (sum + <span class="number">1</span>) + n - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> ans[x] = <span class="number">2</span> * (n - <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        add(x, y), add(y, x);</span><br><span class="line">    &#125;</span><br><span class="line">    tarjan(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å›¾çš„è¿é€š </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 541 Div2</title>
      <link href="2019/02/24/Codeforces%20Round%20541%20Div2/"/>
      <url>2019/02/24/Codeforces%20Round%20541%20Div2/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/1131" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>å”‰ï¼Œè¿˜æ˜¯æœ‰å¾ˆå¤§çš„è¿›æ­¥ç©ºé—´å•Šã€‚åšäº† A å’Œ Cï¼ŒB å’Œ D éƒ½è°ƒä¸å‡ºæ¥ã€‚ã€‚</p><h3 id="A-Sea-Battle"><a href="#A-Sea-Battle" class="headerlink" title="A. Sea Battle"></a>A. Sea Battle</h3><hr><p>ç­¾åˆ°é¢˜ã€‚</p><h3 id="B-Draw"><a href="#B-Draw" class="headerlink" title="B. Draw!"></a>B. Draw!</h3><hr><p>æ˜¯ min(a[i], b[i]) - max(a[i - 1], b[i - 1]) + 1 æ²¡é”™äº†ã€‚ã€‚ä½†æ˜¯è¦è€ƒè™‘ a[i - 1] = b[i - 1] çš„æƒ…å†µï¼</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    ll a = <span class="number">0</span>, b = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        ll aa, bb; <span class="built_in">cin</span> &gt;&gt; aa &gt;&gt; bb;</span><br><span class="line">        <span class="keyword">if</span> (aa == a &amp;&amp; bb == b) <span class="keyword">continue</span>;</span><br><span class="line">        ans += max(<span class="number">0L</span>L, min(aa, bb) - max(a, b) + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (a == b) ans--;</span><br><span class="line">        swap(a, aa), swap(b, bb);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-Birthday"><a href="#C-Birthday" class="headerlink" title="C. Birthday"></a>C. Birthday</h3><hr><p>è¯´å®è¯æ²¡æƒ³åˆ°å±…ç„¶ä¸€ä¸‹å°± A äº†(<em>Ë‰ï¸¶Ë‰</em>)</p><p>è®°å¾—ä»¥å‰ CF ä¸Šè§åˆ°è¿‡ C é¢˜å‡ºè¿™ç§æ„é€ æ–¹å¼çš„ï¼Œè§‰å¾—å¾ˆæ–°å¥‡ğŸ¤”</p><p>ç»™ a[] æ’åºï¼Œç„¶å i ä» 1 å¼€å§‹æšä¸¾ï¼Œæ¯æ¬¡ += 2ã€‚i å’Œ i + 1 ä¸€ä¸ªæ”¾åœ¨ ans[] ä¸­ i ä½ç½®ï¼Œä¸€ä¸ªæ”¾åœ¨ n - i + 1 çš„ä½ç½®ï¼Œå…·ä½“æ”¾å“ªè¦çœ‹å“ªç§æœ€ä¼˜ï¼ˆå³ä½¿æœ€å¤§å·®å€¼å¢åŠ å¾—æœ€æ…¢ï¼‰ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, a[<span class="number">105</span>], ans[<span class="number">105</span>], maxn;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">    sort(a + <span class="number">1</span>, a + n + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">1</span>, r = n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i += <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (l &gt; r) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">            ans[l] = a[n]; <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> x = a[i], y = a[i + <span class="number">1</span>];</span><br><span class="line">        ans[l] = a[i], ans[r] = a[i + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">int</span> tmp = max(x - ans[l - <span class="number">1</span>], y - ans[r + <span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">if</span> (tmp &lt; maxn) &#123;</span><br><span class="line">            l++, r--;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (y - ans[l - <span class="number">1</span>] &lt; tmp &amp;&amp; x - ans[r + <span class="number">1</span>] &lt; tmp)</span><br><span class="line">            swap(ans[l], ans[r]);</span><br><span class="line">        maxn = max(maxn, max(ans[l] - ans[l - <span class="number">1</span>], ans[r] - ans[r + <span class="number">1</span>]));</span><br><span class="line">        l++, r--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D-Gourmet-choice"><a href="#D-Gourmet-choice" class="headerlink" title="D. Gourmet choice"></a>D. Gourmet choice</h3><hr><p>ä¸€å¼€å§‹æ˜¯æƒ³åˆ°äº†æ‹“æ‰‘ï¼Œä½†æ²¡æƒ³åˆ°ç¼©ç‚¹æ¥ç€ï¼Œåæ¥è¶Šæ•²è¶Šä¹±ï¼Œå¼ƒç–—äº†ã€‚ã€‚</p><p>æ²¡é”™ï¼Œæ­£è§£å°±æ˜¯æš´åŠ›æ‹“æ‰‘ + ç¼©ç‚¹ã€‚ç¼©ç‚¹å…¶å®ä¸å¯æ€•ï¼Œå°±æ˜¯å¹¶æŸ¥é›†å•¦ï¼ˆæ­¤é¢˜ä¸ç”¨ Tarjanï¼‰ã€‚aij = â€˜=â€™ æ—¶ï¼Œå°† i å’Œ j å¹¶ä¸€ä¸‹ï¼›aij = â€˜&gt;â€™ æ—¶ï¼Œå»ºç«‹ä¸€æ¡ i æŒ‡å‘ j çš„è¾¹ï¼›â€™&lt;â€™ æ—¶ï¼Œå»ºç«‹ j æŒ‡å‘ i çš„è¾¹ã€‚</p><p>æ£€æŸ¥æœ‰æ²¡æœ‰è‡ªç¯ï¼ˆå³è‡ªå·±å¤§äºè‡ªå·±ï¼‰å’Œç¯ï¼ˆa1 &gt; a2 &gt; â€¦ &gt; ak &gt; a1ï¼‰ï¼Œå¦‚æœæœ‰ï¼Œè¾“å‡º Noï¼Œå¦åˆ™æ ¹æ®æ‹“æ‰‘ç»“æœè¾“å‡ºç­”æ¡ˆã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2010</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">char</span> s[N][N];</span><br><span class="line"><span class="keyword">int</span> fa[N], deg[N], vis[N], len[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> fa[x] == x ? x : fa[x] = getfa(fa[x]); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    vis[u] = <span class="number">1</span>; len[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)g[u].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = g[u][i];</span><br><span class="line">        <span class="keyword">if</span> (v == u) &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"No"</span>); <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (vis[v] == <span class="number">1</span>) &#123;  <span class="comment">// æœ‰ç¯</span></span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"No"</span>); <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (vis[v] == <span class="number">2</span>) &#123;</span><br><span class="line">            len[u] = max(len[u], len[v] + <span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            dfs(v);</span><br><span class="line">            len[u] = max(len[u], len[v] + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    vis[u] = <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n + m; i++) fa[i] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s[i] + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++)</span><br><span class="line">        <span class="keyword">if</span> (s[i][j] == <span class="string">'='</span>) fa[getfa(i)] = getfa(j + n);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (s[i][j] == <span class="string">'&gt;'</span>) g[getfa(i)].push_back(getfa(j + n)), deg[getfa(j + n)]++;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (s[i][j] == <span class="string">'&lt;'</span>) g[getfa(j + n)].push_back(getfa(i)), deg[getfa(i)]++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n + m; i++) <span class="keyword">if</span> (!deg[i]) dfs(i);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n + m; i++) <span class="keyword">if</span> (vis[i] != <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"No"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Yes"</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, len[getfa(i)]);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, len[getfa(i + n)]);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="E-String-Multiplication"><a href="#E-String-Multiplication" class="headerlink" title="E. String Multiplication"></a>E. String Multiplication</h3><hr><p>é¦–å…ˆåº”è¯¥æƒ³åˆ° DPï¼šf[i, j] è¡¨ç¤º $p_1 * p_2 * â€¦ * p_i$ çš„ç»“æœä¸­ j å­—æ¯çš„æœ€é•¿ä¸²çš„é•¿åº¦ã€‚</p><p>è®¾ $S_i = p_1 * â€¦ * p_i$ï¼Œæœ€åä¸€å®šæ˜¯ $S_{n - 1} * p_n$ã€‚æŒ‰ç…§ pn åˆ†ç±»è®¨è®ºï¼Œä¸€å…±æœ‰ä¸‰ç§æƒ…å†µï¼š</p><p>è®¾ pn çš„å¼€å¤´å­—ç¬¦æ˜¯ c0, ç»“å°¾å­—ç¬¦æ˜¯ c1ï¼ŒåŒ…å«å¼€å¤´çš„è¿ç»­æ®µçš„é•¿åº¦æ˜¯ preï¼ŒåŒ…å«ç»“å°¾çš„è¿ç»­æ®µçš„é•¿åº¦æ˜¯ sufã€‚</p><ol><li><p>$c0 \neq c1$ï¼Œç­”æ¡ˆå¯ä»¥æ˜¯ä¸‰ä¸ªï¼š(1). å¯ä»¥æ˜¯ pn ä¸­æœ€é•¿çš„è¿ç»­å­æ®µï¼›(2). å¦‚æœ $S_{n - 1}$ ä¸­å­˜åœ¨ c0ï¼Œpre + 1ï¼›(3). å¦‚æœ $S_{n - 1}$ ä¸­å­˜åœ¨ c1ï¼Œsuf + 1ã€‚</p></li><li><p>c0 = c1, å¹¶ä¸”æ•´ä¸ªä¸²ä¸åªæœ‰ä¸€ç§å­—ç¬¦ï¼šå¦‚æœ $S_{n - 1}$ ä¸­å­˜åœ¨ c0ï¼Œé‚£ä¹ˆç­”æ¡ˆå¯ä»¥æ˜¯ pre + suf + 1.</p></li><li><p>å¦‚æœ pn åªç”±ä¸€ç§å­—ç¬¦æ„æˆï¼Œé‚£ä¹ˆæ±‚ $S_{n - 1}$ ä¸­æœ€é•¿çš„å­—ç¬¦æ˜¯ c0 è¿ç»­æ®µçš„ï¼Œè®¾ä¸º tï¼Œç­”æ¡ˆå°±æ˜¯ $pre * (t + 1) + t$.</p></li></ol><p>æ³¨æ„è®°å½•è¾“å‡ºæ–¹æ¡ˆã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> f[N][<span class="number">30</span>], pre[<span class="number">30</span>], suf[N];  <span class="comment">// pre:å‰ç¼€ suf:åç¼€</span></span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> *f)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> l = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">26</span>; j++) &#123;</span><br><span class="line">        <span class="keyword">int</span> mx = <span class="number">0</span>;  <span class="comment">// p[1] çš„æœ€é•¿ç›¸åŒå­ä¸²é•¿åº¦</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, cnt = <span class="number">0</span>; i &lt;= l; i++)</span><br><span class="line">            <span class="keyword">if</span> (s[i] == j + <span class="string">'a'</span>) mx = max(mx, ++cnt);</span><br><span class="line">            <span class="keyword">else</span> cnt = <span class="number">0</span>;</span><br><span class="line">        f[j] = mx, pre[j] = suf[j] = <span class="number">0</span>;  <span class="comment">// ä¸è¦å¿˜è®°ç½® 0</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= l; i++)</span><br><span class="line">            <span class="keyword">if</span> (s[i] == j + <span class="string">'a'</span>) ++pre[j];</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i; i--)</span><br><span class="line">            <span class="keyword">if</span> (s[i] == j + <span class="string">'a'</span>) ++suf[j];</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    solve(f[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        solve(f[i]);</span><br><span class="line">        <span class="keyword">int</span> l = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">26</span>; j++)</span><br><span class="line">            <span class="keyword">if</span> (f[i - <span class="number">1</span>][j])</span><br><span class="line">                <span class="keyword">if</span> (pre[j] != l) <span class="comment">// åˆ¤æ–­ pi æ˜¯å¦å…¨ç”± j ç»„æˆ</span></span><br><span class="line">                    f[i][j] = max(f[i][j], pre[j] + suf[j] + <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">else</span> f[i][j] = max(f[i][j], l * (f[i - <span class="number">1</span>][j] + <span class="number">1</span>) + f[i - <span class="number">1</span>][j]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) ans = max(ans, f[n][i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="F-Asya-And-Kittens"><a href="#F-Asya-And-Kittens" class="headerlink" title="F. Asya And Kittens"></a>F. Asya And Kittens</h3><hr><p>è¿™é“çœ‹å¾ˆå¤šäººä¸€å¼€å§‹å°±å» A äº†å‘€ï¼Œæœç„¶æ¯” E é¢˜ç®€å• ğŸ¤” å¹¶æŸ¥é›†æ¨¡æ‹Ÿå°±å¥½å•¦ã€‚</p><p>å¯¹äºæ¯æ¬¡çš„ (x, y), â€œå¹¶â€ å…¶å®æ˜¯å¹¶ x æ‰€åœ¨çš„å—çš„æœ€å³è¾¹ä¸€ä¸ªå’Œ y æ‰€åœ¨çš„å—çš„æœ€å·¦è¾¹ä¸€ä¸ªï¼Œå°±åƒçœŸçš„åˆå¹¶ä¸€æ ·ã€‚è®°å½•æŸä¸ªå—çš„æœ€å³ç«¯å’Œæœ€å·¦ç«¯å°±å¯ä»¥äº†ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">150010</span>;</span><br><span class="line"><span class="keyword">int</span> n, d[N], pre[N], nxt[N], fa[N];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    g[u].push_back(v), g[v].push_back(u);</span><br><span class="line">    d[u]++, d[v]++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> fa[x] == x ? x : fa[x] = getfa(fa[x]); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d "</span>, x);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)g[x].size(); i++)</span><br><span class="line">        <span class="keyword">if</span> (g[x][i] != fa) print(g[x][i], x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) pre[i] = nxt[i] = fa[i] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        x = getfa(x), y = getfa(y);</span><br><span class="line">        add(nxt[x], pre[y]);</span><br><span class="line">        nxt[x] = nxt[y];</span><br><span class="line">        fa[y] = x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> root = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="keyword">if</span> (d[i] == <span class="number">1</span>) &#123;</span><br><span class="line">        root = i; <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    print(root, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦åŠ æ²¹ï¼ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[LG4314]-CPUç›‘æ§</title>
      <link href="2019/02/22/%5Bluogu4314%5D-CPU%E7%9B%91%E6%8E%A7/"/>
      <url>2019/02/22/%5Bluogu4314%5D-CPU%E7%9B%91%E6%8E%A7/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.luogu.org/problemnew/show/P4314" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>ACä¹‹æ—…çœŸæ˜¯åå·å•Šã€‚ã€‚ä¸€ä¸Šæ¥ï¼Œå’¦ï¼Œè¿™ä¸æ˜¯æ¨¡ç‰ˆé¢˜å˜›ï¼Œæ·±è“é¢˜æ˜¯ç¾¤ä¼—è¯¯è¯„å˜› qwq</p><p>ç„¶åæ•²å®Œä¸€äº¤ï¼Œå“å“Ÿå•§ï¼Œçˆ†é›¶å“‡ã€‚ã€‚ã€‚å»ç¿»äº†ç¿»é¢˜è§£ï¼Œå‘ç°è¿™ä¸ªé—®é¢˜è¿˜çœŸæ˜¯éšè”½ã€‚</p><p>é¢˜è§£é‡Œæ˜¯è¿™æ ·è¯´çš„ï¼š</p><p>â€œæŒ‰åŸæ¥çš„æ–¹æ³•ä¼šæœ‰ä¸€ç‚¹ bug  ï¼Œå°±æ˜¯å¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°è¿™æ ·çš„æƒ…å†µï¼šå¯¹äºæŸä¸ªç»“ç‚¹ i ï¼Œåœ¨å®ƒçš„æ ‡è®°è¿˜æ²¡æœ‰ä¸‹æ”¾çš„æ—¶å€™ï¼Œå®ƒçš„çˆ¶äº²åˆä¸‹æ”¾äº†æ–°çš„æ ‡è®°ç»™å®ƒï¼Œäºæ˜¯å°±å°†åŸæ¥çš„æ ‡è®°è¦†ç›–äº†ï¼Œä¸¢å¤±äº†åŸæ¥çš„é‚£ä¸€æ¬¡ä¿®æ”¹çš„å€¼ï¼Œè¿™æ ·åœ¨æŸ¥è¯¢å†å²æœ€å¤§å€¼çš„æ—¶å€™å°±æœ‰å¯èƒ½å‡ºç°é”™è¯¯çš„ç­”æ¡ˆã€‚</p><p>â€œå¦‚æœåªè®°å½•åŒºé—´å†å²æœ€å¤§å€¼æ˜¾ç„¶ä¸èƒ½ä¸‹æ”¾ï¼Œå¦‚æœå•çº¯æ›´æ–°åŒºé—´åŠ ï¼ŒåŒºé—´èµ‹å€¼æœ€å¤§å€¼ï¼Œå¯èƒ½ä¼šå‡ºç°å†å²æœ€å¤§å€¼æ›´æ–°ä¸åŠæ—¶çš„æƒ…å†µã€‚å¦‚å…ˆèµ‹å€¼å¾ˆå¤§å€¼ï¼Œæœªæ¥å¾—åŠä¸‹æ”¾ï¼Œåˆèµ‹å€¼å¾ˆå°ï¼Œå¯¼è‡´å­åŒºé—´å†å²æœ€å¤§å€¼ä¸èƒ½æ›´æ–°ã€‚åˆå¦‚å¦‚æœåŒºé—´åŠ åªå–æœ€å¤§å€¼ï¼Œå¯èƒ½ä¼šåªå–æœ€å¤§å€¼ï¼Œå¯¼è‡´å®é™…ä¸Šå¿½è§†äº†ä¸€äº›ä½¿åŒºé—´åŠ å˜å°çš„æ“ä½œã€‚â€</p><p>å¦‚æœæ¬¡æ¬¡ä¸‹æ”¾æ ‡è®°ï¼Œé‚£æ˜¾ç„¶å¤æ‚åº¦å¤ªé«˜äº†ã€‚</p><p>ä¸ºäº†ä¸é”™è¿‡æ¯ä¸€æ¬¡æ“ä½œäº§ç”Ÿçš„è´¡çŒ®ï¼Œæˆ‘ä»¬å¯¹äºæ¯ä¸€ä¸ªåŒºé—´ $x$ å­˜å‚¨å®ƒä»ä¸Šä¸€æ¬¡ pushdown åˆ°ç°åœ¨çš„æœ€å¤§åŠ æ³•æ“ä½œå’Œæœ€å¤§èµ‹å€¼æ“ä½œï¼Œè¿™æ ·æ˜¾ç„¶æ˜¯æ­£ç¡®çš„ã€‚</p><p>æ€»ä¹‹è¿˜æ˜¯å¾ˆæ£’çš„å•Šï¼Œè‡³å°‘æ¯”ä¹‹å‰çš„æ‰€ä»¥æ¨¡ç‰ˆé¢˜å¥½ï¼ï¼ï¼å°±æ˜¯è¦åšè¿™æ ·çš„ï¼ˆè™ï¼‰é¢˜ ( Â´â–½ï½€)</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>, inf = <span class="number">1e9</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    ll add, c;</span><br><span class="line">    ll mx, hx;</span><br><span class="line">    ll ha, hc;  <span class="comment">// h = history</span></span><br><span class="line">&#125;t[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    t[x].mx = max(t[x &lt;&lt; <span class="number">1</span>].mx, t[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].mx);</span><br><span class="line">    t[x].hx = max(t[x &lt;&lt; <span class="number">1</span>].hx, t[x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>].hx);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">psd</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> s = x &lt;&lt; <span class="number">1</span> | i;  <span class="comment">// s = son</span></span><br><span class="line">        t[s].hx = max(t[s].hx, max(t[s].mx + t[x].ha, t[x].hc));</span><br><span class="line">        <span class="keyword">if</span> (t[s].c != -inf)</span><br><span class="line">            t[s].hc = max(t[s].hc, t[s].c + t[x].ha);</span><br><span class="line">        <span class="keyword">else</span> t[s].ha = max(t[s].ha, t[s].add + t[x].ha);</span><br><span class="line">        <span class="keyword">if</span> (t[x].add) &#123;</span><br><span class="line">            <span class="keyword">if</span> (t[s].c != -inf) t[s].c += t[x].add;</span><br><span class="line">            <span class="keyword">else</span> t[s].add += t[x].add;</span><br><span class="line">            t[s].mx += t[x].add;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (t[x].c != -inf) &#123;</span><br><span class="line">            t[s].mx = t[s].c = t[x].c;</span><br><span class="line">            t[s].add = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        t[s].hc = max(t[s].hc, max(t[s].c, t[x].hc));</span><br><span class="line">        t[s].ha = max(t[s].ha, t[s].add);</span><br><span class="line">    &#125;</span><br><span class="line">    t[x].hc = t[x].c = -inf;</span><br><span class="line">    t[x].add = t[x].ha = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    t[x].add = t[x].ha = <span class="number">0</span>;</span><br><span class="line">    t[x].c = t[x].hc = -inf;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        ll tmp; <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;tmp);</span><br><span class="line">        t[x].mx = t[x].hx = tmp;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    build(x &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">    build(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">    pushup(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> lx, <span class="keyword">int</span> rx, ll val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt; r) psd(x);</span><br><span class="line">    <span class="keyword">if</span> (lx &lt;= l &amp;&amp; r &lt;= rx) &#123;</span><br><span class="line">        t[x].mx += val;</span><br><span class="line">        t[x].add += val;</span><br><span class="line">        t[x].ha += val;</span><br><span class="line">        t[x].hx = max(t[x].hx, t[x].mx);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (lx &lt;= mid) modify(x &lt;&lt; <span class="number">1</span>, l, mid, lx, rx, val);</span><br><span class="line">    <span class="keyword">if</span> (rx &gt; mid) modify(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, lx, rx, val);</span><br><span class="line">    pushup(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> lx, <span class="keyword">int</span> rx, ll val)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l != r) psd(x);</span><br><span class="line">    <span class="keyword">if</span> (lx &lt;= l &amp;&amp; r &lt;= rx) &#123;</span><br><span class="line">        t[x].c = val;</span><br><span class="line">        t[x].mx = val;</span><br><span class="line">        t[x].hc = val;</span><br><span class="line">        t[x].hx = max(t[x].hx, val);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (lx &lt;= mid) change(x &lt;&lt; <span class="number">1</span>, l, mid, lx, rx, val);</span><br><span class="line">    <span class="keyword">if</span> (rx &gt; mid) change(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, lx, rx, val);</span><br><span class="line">    pushup(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">queryhis</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> lx, <span class="keyword">int</span> rx)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt; r) psd(x);</span><br><span class="line">    <span class="keyword">if</span> (lx &lt;= l &amp;&amp; r &lt;= rx) <span class="keyword">return</span> t[x].hx;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    ll sum = <span class="number">-1e9</span>;</span><br><span class="line">    <span class="keyword">if</span> (lx &lt;= mid) sum = queryhis(x &lt;&lt; <span class="number">1</span>, l, mid, lx, rx);</span><br><span class="line">    <span class="keyword">if</span> (rx &gt; mid) sum = max(sum, queryhis(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, lx, rx));</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">querynow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> lx, <span class="keyword">int</span> rx)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &lt; r) psd(x);</span><br><span class="line">    <span class="keyword">if</span> (lx &lt;= l &amp;&amp; r &lt;= rx) <span class="keyword">return</span> t[x].mx;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    ll sum = <span class="number">-1e9</span>;</span><br><span class="line">    <span class="keyword">if</span> (lx &lt;= mid) sum = querynow(x &lt;&lt; <span class="number">1</span>, l, mid, lx, rx);</span><br><span class="line">    <span class="keyword">if</span> (rx &gt; mid) sum = max(sum, querynow(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r, lx, rx));</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    build(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m);</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</span><br><span class="line">        <span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'A'</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> l, r; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;l, &amp;r);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, queryhis(<span class="number">1</span>, <span class="number">1</span>, n, l, r));</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'Q'</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> l, r; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;l, &amp;r);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, querynow(<span class="number">1</span>, <span class="number">1</span>, n, l, r));</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'P'</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> l, r, z; <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;l, &amp;r, &amp;z);</span><br><span class="line">            modify(<span class="number">1</span>, <span class="number">1</span>, n, l, r, z);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> l, r, z; <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;l, &amp;r, &amp;z);</span><br><span class="line">            change(<span class="number">1</span>, <span class="number">1</span>, n, l, r, z);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 538 Div2</title>
      <link href="2019/02/11/Codeforces%20Round%20538%20Div2/"/>
      <url>2019/02/11/Codeforces%20Round%20538%20Div2/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/1114" target="_blank" rel="noopener">æ¯”èµ›é“¾æ¥</a></p><p>Div2æ€ä¹ˆè¿™ä¹ˆéš¾å‘€ï¼Œè¶‹äºæ•°å­¦åŒ–äº† ğŸ¤”ï¸</p><h3 id="A-Got-Any-Grapes"><a href="#A-Got-Any-Grapes" class="headerlink" title="A. Got Any Grapes?"></a>A. Got Any Grapes?</h3><hr><p>ç­¾åˆ°é¢˜ï¼Œç„¶è€Œç¬¬ä¸€æ¬¡æäº¤æŠŠç´«è‘¡è„å’Œé»‘è‘¡è„çš„é¡ºåºçœ‹é”™äº†ã€‚ã€‚ã€‚æˆåŠŸ -50ã€‚ã€‚ã€‚</p><h3 id="B-Yet-Another-Array-Partitioning-Task"><a href="#B-Yet-Another-Array-Partitioning-Task" class="headerlink" title="B. Yet Another Array Partitioning Task"></a>B. Yet Another Array Partitioning Task</h3><hr><p>è¿™é¢˜çœ‹ç€æœ‰ç‚¹çœ¼ç†Ÿï¼Œå¥½åƒ Global Round 1 çš„ B é¢˜å‘€ ğŸ¤”</p><p>ä¸€å¼€å§‹æƒ³å„ç§è´ªå¿ƒï¼Œå¥½åƒéƒ½ä¸å¤§å¯è¡Œã€‚å…¶å®æ³¨æ„åˆ°äº† Input æ•°æ®èŒƒå›´é‡Œæœ‰ä¸ª $m * k \leq n$, ä½†ä¸çŸ¥é“æœ‰å•¥ç”¨ã€‚åæ¥æ‰çŸ¥é“ï¼Œæ˜¯å› ä¸ºé¦–å…ˆä½ å¾—é€‰å‰ $m * k$ å¤§çš„å§ï¼è¿™æ ·ï¼Œä½ å°†å‰ $m * k$ å¤§çš„è®°å½•ä¸‹æ¥ï¼Œæ¯éš” k ä¸ªåˆ†ä¸€ç»„ï¼Œæ—¢æ»¡è¶³äº†æ¯ç»„æ•°é‡ &gt;= m, åˆæ˜¯æœ€ä¼˜è§£ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, k, a[N], mark[N], ret[N], cnt;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll tot;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> id, num;</span><br><span class="line">&#125;b[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node a, node b)</span> </span>&#123; <span class="keyword">return</span> a.num &gt; b.num; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">        b[i].num = a[i], b[i].id = i;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(b + <span class="number">1</span>, b + n + <span class="number">1</span>, cmp);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m * k; i++) &#123;</span><br><span class="line">        mark[b[i].id] = <span class="number">1</span>; tot += b[i].num;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mark[i]) sum++;</span><br><span class="line">        <span class="keyword">if</span> (sum == m) ret[++cnt] = i, sum = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, tot);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; cnt; i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, ret[i]);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-Trailing-Loves-or-Lâ€™oeufs"><a href="#C-Trailing-Loves-or-Lâ€™oeufs" class="headerlink" title="C. Trailing Loves (or Lâ€™oeufs?)"></a>C. Trailing Loves (or Lâ€™oeufs?)</h3><hr><p>å•Šï¼è¿™æ˜¯ä¸ªç„å­¦é¢˜ï¼</p><p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹ 10 è¿›åˆ¶ï¼š10 è¿›åˆ¶ä¸‹æ±‚ n! æœ«å°¾ 0 çš„ä¸ªæ•°å¾ˆå®¹æ˜“å§ï¼Œæ‰¾å‡º 1 ï½ n ä¸­ 2 å’Œ 5 ä½œä¸ºå› å­çš„ä¸ªæ•° a å’Œ bï¼Œç­”æ¡ˆå°±æ˜¯ min(a, b).</p><p>ç”±æ­¤æˆ‘ä»¬å¯ä»¥å¤§èƒ†çŒœæƒ³ï¼Œb è¿›åˆ¶ä¸‹æ±‚ n! æœ«å°¾ 0 çš„ä¸ªæ•°æ˜¯åŒæ ·åšæ³•ã€‚æˆ‘ä»¬æŠŠ b å†™æˆ $b = p_1^{a_1} * p_2^{a_2} * â€¦ * p_k^{a_k}$ çš„å½¢å¼.</p><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œ1 ï½ n ä¸­ p çš„å€æ•°çš„ä¸ªæ•°ä¸º n / p ä¸‹å–æ•´ã€‚è¿™é‡Œæˆ‘ä»¬è¦æ‰¾å‡ºå¯¹äºæ¯ä¸€ä¸ª pï¼Œå®ƒä½œä¸ºå› å­çš„ä¸ªæ•°ï¼Œå³ f(n, p). f(n, p) = n / p + n / (p ^ 2) + n / (p ^ 3). æ³¨æ„æ±‚ f(n, p) çš„æ—¶å€™ä¸èƒ½å…ˆç®— (p ^ k), è€Œåº”è¯¥ç”¨ä¸æ–­é™¤çš„å½¢å¼ï¼Œé¿å…ç²¾åº¦è¯¯å·®ï¼Œè¿™ä¸€æ®µä¸‹é¢ä»£ç ä¸­æœ‰å…·ä½“æ–¹æ³•ã€‚</p><p>f(n, pi) è®°å…¥ç­”æ¡ˆæ—¶è¦é™¤ä»¥ ai, è¿™ä¸ªè‡ªå·±ç†è§£ä¸€ä¸‹å°±å¯ä»¥ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, b, ans;</span><br><span class="line">ll ok[<span class="number">1000010</span>], prime[<span class="number">1000010</span>], cnt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Is</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= <span class="number">1000000</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!ok[i]) prime[++cnt] = i;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>; i * j &lt;= <span class="number">1000000</span>; j++) ok[i * j] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">f</span><span class="params">(ll x, ll y)</span> </span>&#123;</span><br><span class="line">    ll tmpN = x, res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (tmpN) tmpN /= y, res += tmpN;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;n, &amp;b);</span><br><span class="line">    Is();</span><br><span class="line">    ans = <span class="number">1e18</span>;</span><br><span class="line">    ll tmp = b;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++) &#123;</span><br><span class="line">        ll p = prime[i];</span><br><span class="line">        <span class="keyword">if</span> (p &gt; b) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (b % p) <span class="keyword">continue</span>;</span><br><span class="line">        ll tot = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (tmp % p == <span class="number">0</span>) tmp /= p, tot++;</span><br><span class="line">        ll now = f(n, p) / tot;</span><br><span class="line">        ans = min(ans, now);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (tmp &gt; <span class="number">1</span>) ans = min(ans, f(n, tmp));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D-Flood-Fill"><a href="#D-Flood-Fill" class="headerlink" title="D. Flood Fill"></a>D. Flood Fill</h3><hr><p>è¿™ä¸ªé¢˜æ˜¯åŒºé—´çš„é—®é¢˜ï¼Œè‚¯å®šä¸æ˜¯çº¿æ€§çš„ï¼Œè¿™æ—¶å€™åº”è¯¥è€ƒè™‘ä¸€ä¸‹åŒºé—´DPå•¦ã€‚ä¸€æƒ³åˆ°åŒºé—´DPå°±ä¼šæœ‰æƒ³æ³•äº†ï¼æ˜¯ä¸æ˜¯å¾ˆåƒçƒ¤ä¹æ»‹æ‰“è™  ğŸ¤”</p><p>è®¾ f[i, j, k] è¡¨ç¤ºåŒºé—´[i, j]å·²ç»æ˜¯åŒä¸€ä¸ªé¢œè‰² p äº†ï¼Œå…¶ä¸­å¦‚æœ k = 0ï¼Œp = c[i], å¦åˆ™ p = c[j]. å› ä¸ºä¸€æ®µåŒºé—´çš„æ”¹å˜é¢œè‰²çš„æ“ä½œè‚¯å®šæ˜¯ä¸ºäº†åƒæ»šé›ªçƒä¸€æ ·æ‰©å¤§åŒä¸€é¢œè‰²çš„åŒºé—´å˜›ï¼Œæ‰€ä»¥é¢œè‰²ä¸æ˜¯å·¦ç«¯ç‚¹çš„å°±æ˜¯å³ç«¯ç‚¹çš„ã€‚</p><p>è½¬ç§»çœ‹ä»£ç ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e3</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, c[N], f[N][N][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> sta)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt;= r) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (f[l][r][sta] != <span class="number">-1</span>) <span class="keyword">return</span> f[l][r][sta];</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1e9</span>;</span><br><span class="line">    <span class="keyword">if</span> (sta == <span class="number">0</span>) &#123;</span><br><span class="line">        res = min(res, dp(l + <span class="number">1</span>, r, <span class="number">0</span>) + (c[l] != c[l + <span class="number">1</span>]));</span><br><span class="line">        res = min(res, dp(l + <span class="number">1</span>, r, <span class="number">1</span>) + (c[l] != c[r]));</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res = min(res, dp(l, r - <span class="number">1</span>, <span class="number">0</span>) + (c[r] != c[l]));</span><br><span class="line">        res = min(res, dp(l, r - <span class="number">1</span>, <span class="number">1</span>) + (c[r] != c[r - <span class="number">1</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> f[l][r][sta] = res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;c[i]);</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">-1</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, min(dp(<span class="number">1</span>, n, <span class="number">0</span>), dp(<span class="number">1</span>, n, <span class="number">1</span>)));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Global Round 1</title>
      <link href="2019/02/08/Codeforces%20Global%20Round%201/"/>
      <url>2019/02/08/Codeforces%20Global%20Round%201/</url>
      
        <content type="html"><![CDATA[<p>åšäº† A å’Œ Bï¼Œä¹Ÿç®—ä¸é”™å•¦</p><p><a href="http://codeforces.com/contest/1110" target="_blank" rel="noopener">æ¯”èµ›é“¾æ¥</a></p><h3 id="A-Parity"><a href="#A-Parity" class="headerlink" title="A. Parity"></a>A. Parity</h3><hr><p>å¥‡å¶æ€§åˆ¤æ–­ï¼Œæ³¨æ„ $a_k$ çš„æƒ…å†µå°±å¥½å•¦ã€‚ï¼ˆå³ $b^0$ ï¼‰.</p><h3 id="B-Tape"><a href="#B-Tape" class="headerlink" title="B. Tape"></a>B. Tape</h3><hr><p>è€äº†ï¼Œè„‘å­ä¸å¥½ä½¿å•¦â€¦ æƒ³äº†åŠå¤©ï¼Œæœ€å¼€å§‹æƒ³åˆ°çš„æ˜¯éš”æ¿æ³•ï¼Œæ”¾ k - 1 ä¸ªæ¿ï¼Œä½†æ˜¯åæ¥å‘ç°åªè¦ç¨åŠ è½¬æ¢å°±èƒ½å˜ä¸ºï¼Œb[n] - b[1] + 1 - sum, å…¶ä¸­ sum ä¸ºæœ€å¤§çš„ k - 1 ä¸ªé—´éš”é•¿åº¦ä¹‹å’Œã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, k;</span><br><span class="line"><span class="keyword">int</span> b[N], c[N];</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123; <span class="keyword">return</span> a &gt; b; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;n, &amp;m, &amp;k);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;b[i]);</span><br><span class="line">    <span class="keyword">int</span> tot = b[n] - b[<span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) c[i] = b[i + <span class="number">1</span>] - b[i] - <span class="number">1</span>;</span><br><span class="line">    sort(c + <span class="number">1</span>, c + n, cmp);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; k; i++) tot -= c[i];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, tot);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-Meaningless-Operations"><a href="#C-Meaningless-Operations" class="headerlink" title="C. Meaningless Operations"></a>C. Meaningless Operations</h3><hr><p>è®¾ a çš„æœ€é«˜ä½æ˜¯ç¬¬ x ä½ï¼Œåˆ™ $2^x \leq a$, $a_{max} = 2^x - 1$. è®¾ $b = 2^x - 1\oplus a$, åˆ™ $f(a) = max{gcd(2^x - 1, 0)}$ , å³ $2^x - 1$ï¼Œä¸ºæœ€å¤§å€¼ã€‚</p><p>è‹¥ $a = 2^x - 1$ï¼Œå› ä¸º b &lt; a = $2 ^ x - 1$, æ‰€ä»¥ $f(a) = max{gcd(2^x - 1 - b, b)}$, å› ä¸º $gcd(x, y) = gcd(x, x + y)$, æ‰€ä»¥ $f(a) = max{gcd(2^x - 1, b)}$ï¼Œè¿™æ—¶æ‰¾åˆ° $2^x - 1$ çš„æœ€å°è´¨å› å­ tï¼Œç­”æ¡ˆå°±æ˜¯ $\frac{2^x - 1}{t}$.</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">10</span>, inf = <span class="number">1e9</span> + <span class="number">7</span>, mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> q, x;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;q);</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">        <span class="keyword">int</span> maxn = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (maxn &lt;= x) maxn &lt;&lt;= <span class="number">1</span>;</span><br><span class="line">        maxn--;</span><br><span class="line">        <span class="keyword">if</span> (x == maxn) &#123;</span><br><span class="line">            <span class="keyword">int</span> flag = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= maxn; i++) <span class="keyword">if</span> (maxn % i == <span class="number">0</span>) &#123; flag = maxn / i; <span class="keyword">break</span>; &#125;</span><br><span class="line">            <span class="keyword">if</span> (!flag) <span class="built_in">puts</span>(<span class="string">"1"</span>); <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, flag);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, maxn);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D-Jongmah"><a href="#D-Jongmah" class="headerlink" title="D. Jongmah"></a>D. Jongmah</h3><hr><p>ä¸€ä¸ªæŒºæš´åŠ›çš„é¢˜ï¼Œä½†å®˜æ–¹æ­£è§£æ˜¯ DPã€‚</p><p>é¦–å…ˆï¼å› ä¸º [x, x, x], [x + 1, x + 1, x + 1], [x + 2, x + 2, x + 2] æ€»èƒ½è¢«ä¸‰ç»„ [x, x + 1, x + 2] æ‰€ä»£æ›¿ï¼Œæˆ‘ä»¬è®¾è¿™æ—¶å°±å°½é‡ç”¨ [x, x + 1, x + 2].</p><p>è¿™æ—¶å¯ä»¥è¿™æ ·ï¼šè®¾ dp[i, t1, t2] è¡¨ç¤ºå‰ i ç§æ•°å­—ï¼Œæœ‰ t1 ç»„ [i - 1, i, i + 1], t2 ç»„ [i, i + 1, i + 2], æˆ‘ä»¬æšä¸¾ t3 è¡¨ç¤ºæœ‰ t3 ç»„ [i + 1, i + 2, i + 3], ç„¶åè½¬ç§»åˆ° dp[i + 1, t2, t3].</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, x, a[N], dp[N][<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x); a[x]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">3</span>; k++)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">0</span>; l &lt; <span class="number">3</span>; l++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (j + k + l &gt; a[i]) <span class="keyword">continue</span>;</span><br><span class="line">                    dp[i][k][l] = max(dp[i][k][l], dp[i - <span class="number">1</span>][j][k] + l + (a[i] - j - k - l) / <span class="number">3</span>);</span><br><span class="line">                &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, dp[m][<span class="number">0</span>][<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="E-Magic-Stones"><a href="#E-Magic-Stones" class="headerlink" title="E. Magic Stones"></a>E. Magic Stones</h3><hr><p>å¯ä»¥è¿™æ ·çœ‹ï¼šè®¾ $d_i = c_{i + 1} - c_i$, $c_i^, = c_{i + 1} + c_{i - 1} - c_{i}$.</p><p>å½“å°† $c_i$ å˜ä¸º $c_i^,$ æ—¶ï¼š</p><p>Â· $d_{i - 1} = c_i - c_{i - 1} = c_{i + 1} - c_i = d_i$</p><p>Â· $d_i = c_{i + 1} - c_i = c_i - c_{i - 1} = d_{i - 1}$</p><p>å‘ç°äº†å—ï¼Ÿ$d_i$ ä¸ $d_{i - 1}$ äº¤æ¢äº†ï¼</p><p>æ‰€ä»¥ä¸ç®¡åºåˆ— c æ€ä¹ˆå˜ï¼Œåºåˆ— d æ€»æ˜¯ä¸å˜çš„ã€‚æ‰€ä»¥åªè¦åˆ¤æ–­ä¸¤ä¸ªåºåˆ—çš„åºåˆ— d æ˜¯å¦ç›¸åŒå°±å¯ä»¥äº†ã€‚</p><p>æ³¨æ„ï¼éœ€è¦åˆ¤æ–­ s[1] æ˜¯å¦ç­‰äº t[1]ã€‚å› ä¸ºç¬¬ä¸€ä¸ªä½ç½®æ˜¯å˜ä¸äº†çš„ã€‚</p><p>code :</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, x, y) for (int i = x; i &gt;= y; i--)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, c[N], t[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;c[i]);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;t[i]);</span><br><span class="line">    <span class="keyword">if</span> (c[<span class="number">1</span>] != t[<span class="number">1</span>]) &#123; <span class="built_in">puts</span>(<span class="string">"No"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">    per(i, n, <span class="number">1</span>) c[i] -= c[i - <span class="number">1</span>];</span><br><span class="line">    per(i, n, <span class="number">1</span>) t[i] -= t[i - <span class="number">1</span>];</span><br><span class="line">    sort(c + <span class="number">1</span>, c + n + <span class="number">1</span>);</span><br><span class="line">    sort(t + <span class="number">1</span>, t + n + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">bool</span> ok = <span class="literal">true</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="keyword">if</span> (c[i] != t[i]) &#123; ok = <span class="literal">false</span>; <span class="keyword">break</span>; &#125;</span><br><span class="line">    <span class="keyword">if</span> (ok) <span class="built_in">puts</span>(<span class="string">"Yes"</span>); <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"No"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[BZOJ4542]-å¤§æ•°</title>
      <link href="2019/02/07/%5BBZOJ4542%5D-%E5%A4%A7%E6%95%B0/"/>
      <url>2019/02/07/%5BBZOJ4542%5D-%E5%A4%A7%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.lydsy.com/JudgeOnline/problem.php?id=4542" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>é¦–å…ˆï¼æˆ‘ä»¬è¦æåˆ°ä¸€ä¸ªæ¨¡è¿ç®—çš„æ€§è´¨ï¼š</p><p>$$(a + b)\ mod\ p = (a\ mod\ p + b\ mod\ p)\ mod\ p$$</p><p>ç„¶åå°±å¯ä»¥å¼€å§‹äº†ã€‚</p><h2 id="P-neq-2-5-çš„æƒ…å†µï¼š"><a href="#P-neq-2-5-çš„æƒ…å†µï¼š" class="headerlink" title="$P \neq 2, 5$ çš„æƒ…å†µï¼š"></a>$P \neq 2, 5$ çš„æƒ…å†µï¼š</h2><p>è¦è®¡ç®—ä¸€ä¸ªåŒºé—´èƒ½å¦æ•´é™¤ Pï¼Œæ˜¯ä¸å¯èƒ½çš„ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆè½¬åŒ–ï¼š</p><p>é¦–å…ˆï¼Œå¯ä»¥ $O(n)$ é¢„å¤„ç†å‡º $S[i â€¦ n] % P$, è¿™è¦ç”¨åˆ°ä¸Šé¢çš„æ€§è´¨ã€‚</p><p>å¦‚æœ $S[l â€¦ n] - S[r + 1 â€¦ n] \equiv 0\ (mod\ P)$, é‚£ä¹ˆ $S[l â€¦ r] \equiv 0\ (mod\ P)$.</p><p>è¿™æ ·ï¼Œé—®é¢˜å°±è½¬åŒ–æˆäº†ï¼šæ±‚åœ¨ [L, R] è¿™ä¸ªåŒºé—´å†…ï¼Œæœ‰å¤šå°‘ä¸ª S[i â€¦ n] % P æ˜¯ç›¸åŒçš„ï¼Œå…¶ä¸­ L &lt;= i &lt;= R. è«é˜Ÿå¥—è·¯ï¼Œæ˜¯å§ï¼Ÿ</p><h2 id="P-2-5-çš„æƒ…å†µï¼š"><a href="#P-2-5-çš„æƒ…å†µï¼š" class="headerlink" title="$P = 2, 5$ çš„æƒ…å†µï¼š"></a>$P = 2, 5$ çš„æƒ…å†µï¼š</h2><p>ç‰¹åˆ¤ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line">ll P, a = <span class="number">0</span>, b[N], c[N], sum, cnt[N], ans[N];</span><br><span class="line"><span class="keyword">int</span> n, m, unit;</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, id;</span><br><span class="line">&#125;q[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node a, node b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.l / unit == b.l / unit ? a.r &lt; b.r : a.l / unit &lt; b.l / unit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">    sum -= cnt[b[x]] * (cnt[b[x]] - <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> (t) cnt[b[x]]++;</span><br><span class="line">    <span class="keyword">else</span> cnt[b[x]]--;</span><br><span class="line">    sum += cnt[b[x]] * (cnt[b[x]] - <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        ans[i] = ans[i - <span class="number">1</span>];</span><br><span class="line">        cnt[i] = cnt[i - <span class="number">1</span>];  <span class="comment">// æ­¤å¤„çš„ cnt[i] è¡¨ç¤º 1 ï½ i ä¸­æœ‰å¤šå°‘ä¸ª s[i] æ˜¯ P çš„å€æ•°</span></span><br><span class="line">        <span class="keyword">if</span> ((s[i] - <span class="string">'0'</span>) % p == <span class="number">0</span>) ans[i] += i, cnt[i]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> l, r; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;l, &amp;r);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[r] - ans[l - <span class="number">1</span>] - (cnt[r] - cnt[l - <span class="number">1</span>]) * (l - <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;P);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">    n = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (P == <span class="number">2</span> || P == <span class="number">5</span>) &#123;</span><br><span class="line">        solve(P); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll Fac = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">1</span>; i--) &#123;</span><br><span class="line">        b[i] = c[i] = a = (a + Fac * (s[i] - <span class="string">'0'</span>)) % P;</span><br><span class="line">        Fac = Fac * <span class="number">10</span> % P;</span><br><span class="line">    &#125;</span><br><span class="line">    b[++n] = c[n] = <span class="number">0</span>;</span><br><span class="line">    sort(c + <span class="number">1</span>, c + n + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> tot = unique(c + <span class="number">1</span>, c + n + <span class="number">1</span>) - c - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) b[i] = lower_bound(c + <span class="number">1</span>, c + tot + <span class="number">1</span>, b[i]) - c;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m);</span><br><span class="line">    unit = (<span class="keyword">int</span>)<span class="built_in">sqrt</span>(n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;q[i].l, &amp;q[i].r);</span><br><span class="line">        ++q[i].r;</span><br><span class="line">        q[i].id = i;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(q + <span class="number">1</span>, q + m + <span class="number">1</span>, cmp);</span><br><span class="line">    <span class="keyword">int</span> L = <span class="number">1</span>, R = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="keyword">while</span> (R &lt; q[i].r) update(++R, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">while</span> (R &gt; q[i].r) update(R--, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">while</span> (L &gt; q[i].l) update(--L, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">while</span> (L &lt; q[i].l) update(L++, <span class="number">0</span>);</span><br><span class="line">        ans[q[i].id] = sum;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> è«é˜Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[BZOJ4160]-Exclusive Access 2</title>
      <link href="2019/02/05/%5BBZOJ4160%5D-Exclusive%20Access%202/"/>
      <url>2019/02/05/%5BBZOJ4160%5D-Exclusive%20Access%202/</url>
      
        <content type="html"><![CDATA[<p>é¢˜æ„ï¼šç»™å‡º $N$ ä¸ªç‚¹ $M$ æ¡è¾¹çš„æ— å‘å›¾ï¼Œå®šå‘å¾—åˆ°æœ‰å‘æ— ç¯å›¾ï¼Œä½¿å¾—æœ€é•¿è·¯æœ€çŸ­ã€‚$N \leq 15$, $M \leq 100$.</p><p>è¿™é¢˜çœŸå¥½å•Šï¼</p><p>æ˜¯æ¯”èµ› $T2$ã€‚ä¸€å¼€å§‹è§‰å¾—æ²¡æƒ³æ³•ï¼Œç„¶åç äº†ä¸ªæš´åŠ›ï¼Œç»“æœä¸€ä¸ªå­ä»»åŠ¡ä¸­æœ‰ä¸€ä¸ªç‚¹Täº†ï¼Œä¸€åˆ†éƒ½æ²¡æœ‰â€¦â€¦</p><p>ç°åœ¨è¦æ­£ç»åœ°è®²æ­£è§£äº†ï¼é¦–å…ˆï¼Œæœ‰å‘æ— ç¯å›¾æ˜¯ä¸€ä¸ªåˆ‡å…¥ç‚¹ã€‚æˆ‘ä»¬å¯¹äºç¬¬ i ä¸ªç‚¹ï¼Œè®¾å®ƒçš„æ·±åº¦ä¸º $di$. å› ä¸ºâ€œæ— ç¯â€ï¼Œæ‰€ä»¥å¯¹äºæ¯ä¸€æ¡è¾¹ $&lt; v1, v2 &gt;$, $d1$ æ°¸è¿œå°äº $d2$ã€‚</p><p>å‡è®¾ï¼Œè¿™æ ·çš„å›¾å­˜åœ¨ç¯ï¼Œé‚£ä¹ˆ $d1 &lt; d2 &lt; d3 &lt; â€¦ &lt; dk &lt; d1$, è¿™ä¸æˆç«‹ï¼Œæ‰€ä»¥è¯¥å›¾ä¸å­˜åœ¨ç¯ã€‚</p><p>åœ¨è¿™æ ·çš„å›¾ä¸­ï¼Œæœ€é•¿é“¾ä¸º $dmax - dmin$. Hintï¼è¦è¾“å‡º $ans - 1$ å“¦ã€‚</p><p>ä¸ºäº†ä½¿ $dmax - dmin$ æœ€å°ï¼Œæˆ‘ä»¬è¦ä½¿å›¾çš„æ·±åº¦æœ€å°ã€‚æ€ä¹ˆåŠå‘¢ï¼ŸäºŒè¿›åˆ¶DPã€‚</p><p>æˆ‘ä»¬è®¾ $f(node)$ ä¸ºé€‰æ‹©äº†ä¸€äº›ç‚¹æ—¶çš„æœ€å°æ·±åº¦ï¼Œå…¶ä¸­ $node$ ä¸º $N$ ä½äºŒè¿›åˆ¶æ•°è¡¨ç¤ºæ¯ä¸ªç‚¹æ˜¯å¦å–ã€‚è®¾ $leaves$ ä¸ºè¯¥å›¾çš„å¶å­ç»“ç‚¹ï¼Œé‚£ä¹ˆï¼Œ$f(node) = min{f(node - leaves) + 1}$.</p><p>å¶å­ç»“ç‚¹å½¼æ­¤ä¹‹é—´æ˜¯ä¸è¿è¾¹çš„ï¼Œæ‰€ä»¥å¯ä»¥é¢„å¤„ç†å‡º $ok(node)$ è¡¨ç¤ºå½“ $node$ è¿™äº›ç‚¹èƒ½å¦ä¸º $leaves$ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> m, mp[<span class="number">30</span>], cnt, G[<span class="number">30</span>][<span class="number">30</span>], f[<span class="number">1</span> &lt;&lt; <span class="number">15</span>], ok[<span class="number">1</span> &lt;&lt; <span class="number">15</span>];</span><br><span class="line"><span class="keyword">char</span> s1[<span class="number">10</span>], s2[<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m);</span><br><span class="line">    <span class="built_in">memset</span>(mp, <span class="number">-1</span>, <span class="keyword">sizeof</span>(mp));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s%s"</span>, s1, s2);</span><br><span class="line">        <span class="keyword">if</span> (mp[s1[<span class="number">0</span>] - <span class="string">'A'</span>] == <span class="number">-1</span>) mp[s1[<span class="number">0</span>] - <span class="string">'A'</span>] = cnt++;</span><br><span class="line">        <span class="keyword">if</span> (mp[s2[<span class="number">0</span>] - <span class="string">'A'</span>] == <span class="number">-1</span>) mp[s2[<span class="number">0</span>] - <span class="string">'A'</span>] = cnt++;</span><br><span class="line">        G[mp[s1[<span class="number">0</span>] - <span class="string">'A'</span>]][mp[s2[<span class="number">0</span>] - <span class="string">'A'</span>]] = G[mp[s2[<span class="number">0</span>] - <span class="string">'A'</span>]][mp[s1[<span class="number">0</span>] - <span class="string">'A'</span>]] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; cnt); i++) &#123;</span><br><span class="line">        ok[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; cnt; j++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; cnt; k++)</span><br><span class="line">                <span class="keyword">if</span> (j != k &amp;&amp; (i &amp; (<span class="number">1</span> &lt;&lt; j)) &amp;&amp; (i &amp; (<span class="number">1</span> &lt;&lt; k)) &amp;&amp; G[j][k]) &#123;</span><br><span class="line">                    ok[i] = <span class="number">0</span>; <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; cnt); i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> t = i; t; t = (t - <span class="number">1</span>) &amp; i)</span><br><span class="line">            <span class="keyword">if</span> (ok[t])</span><br><span class="line">                f[i] = min(f[i], f[i - t] + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, f[(<span class="number">1</span> &lt;&lt; cnt) - <span class="number">1</span>] - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ä½è¿ç®—(bits)</title>
      <link href="2019/01/31/%E4%BD%8D%E8%BF%90%E7%AE%97(bits)/"/>
      <url>2019/01/31/%E4%BD%8D%E8%BF%90%E7%AE%97(bits)/</url>
      
        <content type="html"><![CDATA[<h2 id="é¢˜æ„ï¼š"><a href="#é¢˜æ„ï¼š" class="headerlink" title="é¢˜æ„ï¼š"></a>é¢˜æ„ï¼š</h2><p>å®šä¹‰ G(x) ä¸º x çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­ 1 çš„ä¸ªæ•°ã€‚</p><p>å°Cæœ‰ä¸€ä¸ªå¥‡å¦™çš„æ–¹ç¨‹</p><p>$$x_1\ opt_1\ x_2\ opt_2\ x_3\ â€¦\ x_{n - 1}\ opt_{n - 1}\ x_n\ =\ c$$</p><p>å…¶ä¸­ $opt_i$ ä¸º AND, OR, XOR ä¸‰ç§ä½è¿ç®—ä¸­çš„ä¸€ç§ã€‚æˆ‘ä»¬å®šä¹‰ä¼˜å…ˆçº§æ˜¯ç›¸åŒçš„ï¼Œå³è®¡ç®—é¡ºåºä¸ºä»å·¦åˆ°å³ã€‚</p><p>æ­¤å¤–ï¼Œå¯¹äº $x_i$, é¡»æ»¡è¶³ $0 \leq x_i &lt; 2^m$ ä¸” $G(x_i) = a_i$, ä¿è¯ $0 \leq c &lt; 2^m$.</p><p>æ±‚ä¸€ç»„ $x_i$ çš„å–å€¼æ»¡è¶³ä¸Šè¿°æ‰€æœ‰çº¦æŸã€‚è‹¥ä¸å­˜åœ¨ï¼Œè¾“å‡º OvOã€‚</p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>Aæ‰äº†è¿™é“å·¨é¢˜ï¼Œçªå¾ˆå¼€å¿ƒå•Š( Â´â–½ï½€)</p><p>è¿™é“é¢˜å˜›ï¼Œé¦–å…ˆè¦ç†Ÿæ‚‰ä¸‰ç§ä½è¿ç®—çš„æ€§è´¨å•¦ã€‚</p><p>è™½ç„¶è¦ç»™å‡ºä¸€ç»„ x çš„è§£ï¼Œä½†åªè¦çŸ¥é“äº† $G(x_i)$, å°±èƒ½é€ å‡º $x_i$. æ‰€ä»¥æˆ‘ä»¬å…ˆæå‡º $G(x_i)$! é€‰æ‹©DPå•¦ï½</p><p>è®¾ $f[i, j]$ è¡¨ç¤ºå‰ i ä¸ª x ä½è¿ç®—åçš„ç»“æœä¸­çš„ä¸º 1 çš„äºŒè¿›åˆ¶ä½ä¸º j ä¸ªã€‚ä¸ºäº†æ–¹ä¾¿è®¡ç®—ç­”æ¡ˆï¼Œè®¾ $g[i, j]$ å­˜å‚¨å‰ i ä¸ª x ä½è¿ç®—åçš„ç»“æœä¸­çš„ä¸º 1 çš„äºŒè¿›åˆ¶ä½ä¸º j ä¸ªæ—¶ï¼Œè®¾å‰ i - 1 ä½ä¸ª x ä½è¿ç®—åçš„ç»“æœä¸º tï¼ŒG(t) = p ï¼Œå’Œ t ä¸ a[i] å…±åŒæœ‰ q ä½æ˜¯åŒä¸º 1 çš„ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ pair å‹çš„æ¥å­˜ (p, q).</p><p>è½¬ç§»çš„æ—¶å€™æšä¸¾ $x_i$ å’Œ $x_{i + 1}$ å…±æœ‰ k ä½åŒä¸º 1 çš„ï¼Œé‚£ä¹ˆåˆ†å¼€æ¥è®¨è®ºå°±å¥½å•¦ï¼Œå³ä» $f[i, j]$ è½¬ç§»åˆ° $f[i + 1, ?]$.</p><p>ç»Ÿè®¡ç­”æ¡ˆã€‚å¯ä»¥é€šè¿‡ç»“æœå’Œç¬¬ä¸€ä¸ªåŠ æ•°å°†ç¬¬äºŒä¸ªåŠ æ•°äºŒè¿›åˆ¶ä½ä¸Šçš„ 1 è¡¥é½ï¼Œå³æ ¹æ®ç»“æœåˆ†ä¸‰ç§æƒ…å†µè®¨è®ºã€‚</p><p>æŒºå¥½çš„ä¸€é“é¢˜å‘€ï¼Œä¸é€‚åˆæ™®åŠç»„çš„éš¾åº¦qwq</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, c, c_num;</span><br><span class="line"><span class="keyword">int</span> a[N], ans[N], f[N][<span class="number">60</span>], tmp[N];</span><br><span class="line">pii g[N][<span class="number">60</span>];</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;n, &amp;m, &amp;c);</span><br><span class="line">    c_num = c;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</span><br><span class="line">        <span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'X'</span>) tmp[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'A'</span>) tmp[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'O'</span>) tmp[i] = <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (c_num) &#123;</span><br><span class="line">        <span class="keyword">if</span> (c_num &amp; <span class="number">1</span>) cnt++; c_num &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    f[<span class="number">1</span>][a[<span class="number">1</span>]] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= m; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (f[i][j]) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= min(j, a[i + <span class="number">1</span>]); k++) &#123;  <span class="comment">// æšä¸¾ j å’Œ a[i + 1] å…±åŒä¸º 1 çš„ä½æ•°ï¼ˆkï¼‰</span></span><br><span class="line">                    <span class="keyword">if</span> (j + a[i + <span class="number">1</span>] - k &lt;= m) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (tmp[i] == <span class="number">0</span>) &#123;</span><br><span class="line">                            f[i + <span class="number">1</span>][j + a[i + <span class="number">1</span>] - <span class="number">2</span> * k] = <span class="number">1</span>;</span><br><span class="line">                            g[i + <span class="number">1</span>][j + a[i + <span class="number">1</span>] - <span class="number">2</span> * k] = make_pair(j, k);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tmp[i] == <span class="number">1</span>) &#123;</span><br><span class="line">                            f[i + <span class="number">1</span>][k] = <span class="number">1</span>;</span><br><span class="line">                            g[i + <span class="number">1</span>][k] = make_pair(j, k);</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tmp[i] == <span class="number">2</span>) &#123;</span><br><span class="line">                            f[i + <span class="number">1</span>][j + a[i + <span class="number">1</span>] - k] = <span class="number">1</span>;</span><br><span class="line">                            g[i + <span class="number">1</span>][j + a[i + <span class="number">1</span>] - k] = make_pair(j, k);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!f[n][cnt]) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"OvO"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> now = cnt, result = c;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt; <span class="number">1</span>; i--) &#123;</span><br><span class="line">        pii u = g[i][now];</span><br><span class="line">        <span class="keyword">int</span> numlst = <span class="number">0</span>, numnow = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> cntlst = u.first, cntnow = a[i], both = u.second;</span><br><span class="line">        cntlst -= both, cntnow -= both;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= m; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (tmp[i - <span class="number">1</span>] == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (result &amp; (<span class="number">1</span> &lt;&lt; j)) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (cntlst) --cntlst, numlst |= (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (cntnow) --cntnow, numnow |= (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (both) --both, numlst |= (<span class="number">1</span> &lt;&lt; j), numnow |= (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tmp[i - <span class="number">1</span>] == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (result &amp; (<span class="number">1</span> &lt;&lt; j)) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (both) --both, numlst |= (<span class="number">1</span> &lt;&lt; j), numnow |= (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (cntlst) --cntlst, numlst |= (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (cntnow) --cntnow, numnow |= (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (result &amp; (<span class="number">1</span> &lt;&lt; j)) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (both) --both, numlst |= (<span class="number">1</span> &lt;&lt; j), numnow |= (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (cntlst) --cntlst, numlst |= (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (cntnow) --cntnow, numnow |= (<span class="number">1</span> &lt;&lt; j);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ans[i] = numnow;</span><br><span class="line">        result = numlst;</span><br><span class="line">        now = u.first;</span><br><span class="line">    &#125;</span><br><span class="line">    ans[<span class="number">1</span>] = result;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NOIP2018æ™®åŠç»„é¢˜è§£</title>
      <link href="2018/11/26/NOIP2018%E6%99%AE%E5%8F%8A%E7%BB%84%E9%A2%98%E8%A7%A3/"/>
      <url>2018/11/26/NOIP2018%E6%99%AE%E5%8F%8A%E7%BB%84%E9%A2%98%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<h3 id="A-æ ‡é¢˜ç»Ÿè®¡"><a href="#A-æ ‡é¢˜ç»Ÿè®¡" class="headerlink" title="A. æ ‡é¢˜ç»Ÿè®¡"></a>A. æ ‡é¢˜ç»Ÿè®¡</h3><hr><p>ç”¨gets</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> ans;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">10</span>], ch;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    gets(s);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(s); i++) &#123;</span><br><span class="line">        ch = s[i];</span><br><span class="line">        <span class="keyword">if</span> (ch &gt;= <span class="string">'A'</span> &amp;&amp; ch &lt;= <span class="string">'Z'</span>) ans++;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (ch &gt;= <span class="string">'a'</span> &amp;&amp; ch &lt;= <span class="string">'z'</span>) ans++;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>) ans++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-é¾™è™æ–—"><a href="#B-é¾™è™æ–—" class="headerlink" title="B. é¾™è™æ–—"></a>B. é¾™è™æ–—</h3><hr><p>å…¨å¼€longlongï¼ï¼å…¨ï¼ï¼ï¼å¼€ï¼ï¼ï¼</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, c[<span class="number">100005</span>], m, p1, s1, s2, l, r;</span><br><span class="line">ll ans, minn = <span class="number">1e9</span>, tmp;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">cin</span> &gt;&gt; c[i];</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; m &gt;&gt; p1 &gt;&gt; s1 &gt;&gt; s2;</span><br><span class="line">    c[p1] += s1;</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt; m; i++) l += c[i] * (m - i);</span><br><span class="line">    <span class="keyword">for</span> (ll i = m + <span class="number">1</span>; i &lt;= n; i++) r += c[i] * (i - m);</span><br><span class="line">    ll s = <span class="built_in">abs</span>(l - r);</span><br><span class="line">    minn = s, ans = m;</span><br><span class="line">    <span class="keyword">if</span> (l &gt; r) &#123;</span><br><span class="line">        <span class="keyword">for</span> (ll i = m + <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">abs</span>(s - s2 * (i - m)) &lt; minn) &#123;</span><br><span class="line">                minn = <span class="built_in">abs</span>(s - s2 * (i - m)), ans = i;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt; m; i++)</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">abs</span>(s - s2 * (m - i)) &lt;= minn) &#123;</span><br><span class="line">                minn = <span class="built_in">abs</span>(s - s2 * (m - i)), ans = i;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-æ‘†æ¸¡è½¦"><a href="#C-æ‘†æ¸¡è½¦" class="headerlink" title="C. æ‘†æ¸¡è½¦"></a>C. æ‘†æ¸¡è½¦</h3><hr><p>ç¬¬ä¸€æ¬¡æ˜¯70åˆ†â€”â€”å¤§æ¦‚å°±æ˜¯DPæ–¹ç¨‹å¯¹å»ä½†æ²¡æœ‰ä¼˜åŒ–é‚£ç§ã€‚</p><p>è¯´å®è¯è¿™ä¸ªDPçœŸçš„æœ‰ç‚¹æ™•å•Šï¼ä¸‹æ ‡ç¢ç£¨äº†åŠå¤©ï¼Œå¯¼è‡´T4æ—¶é—´ä¸¥é‡ä¸å¤Ÿã€‚ã€ä»¥åæ‹¿åˆ°é¢˜ç›®å…ˆå…¨éƒ¨çœ‹ä¸€éå–”</p><p>è®° f[i] è¡¨ç¤ºç¬¬ i åˆ†é’Ÿåˆšå¥½ä»ä¸€è¶Ÿå›æ¥çš„æœ€å°ç­‰å¾…æ—¶é—´ï¼Œè½¬ç§»ä¹Ÿå¯ä»¥è¡¨ç¤ºæˆ $f[i] = \min_{i - 2m &lt; j \leq i - m}{f[j] + k}$, å…¶ä¸­ k æ˜¯ j åœ¨è·¯ä¸Šæ—¶ç­‰å¾…çš„æ—¶é—´ä¹‹å’ŒåŠ ä¸Š j å›æ¥åçš„ç­‰å¾…æ—¶é—´ä¹‹å’Œã€‚æ³¨æ„æ˜¯å®Œå…¨èƒŒåŒ…ï¼ï¼æ‰€ä»¥ä»å°å¾€å¤§æšä¸¾ iã€‚è¿˜æœ‰æœ€åç­”æ¡ˆä¸æ˜¯ f[t[n]] è€Œæ˜¯ f[t[n] + m - 1]!! </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, t[<span class="number">505</span>], f[<span class="number">4000005</span>], T[<span class="number">4000005</span>];</span><br><span class="line"><span class="keyword">int</span> pos = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt; r; i++) sum += (r - i) * T[i];</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">cin</span> &gt;&gt; t[i], T[t[i]]++;</span><br><span class="line">    sort(t + <span class="number">1</span>, t + n + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    f[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= t[n] + m; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> l = max(<span class="number">0</span>, i - <span class="number">2</span> * m + <span class="number">1</span>), r = max(<span class="number">0</span>, i - m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = l; j &lt;= r; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (f[i] &gt;= f[j] + calc(max(<span class="number">0</span>, j - m + <span class="number">2</span>), max(<span class="number">0</span>, i - m + <span class="number">1</span>))) &#123;</span><br><span class="line">                f[i] = f[j] + calc(max(j - m + <span class="number">2</span>, <span class="number">0</span>), max(<span class="number">0</span>, i - m + <span class="number">1</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; f[t[n] + m - <span class="number">1</span>] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>100åˆ†æ˜å¤©è¡¥ã€‚</p><h3 id="D-å¯¹ç§°äºŒå‰æ ‘"><a href="#D-å¯¹ç§°äºŒå‰æ ‘" class="headerlink" title="D. å¯¹ç§°äºŒå‰æ ‘"></a>D. å¯¹ç§°äºŒå‰æ ‘</h3><hr><p>ç„¶è€Œï¼Œï¼Œï¼Œæš´åŠ›å°±å¥½äº†ï¼</p><p>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æ¯ä¸€æ¬¡ chk æ“ä½œï¼Œå½“äºŒå‰æ ‘ä¸ºå®Œå…¨äºŒå‰æ ‘æ—¶ï¼Œæ—¶é—´å¤æ‚åº¦æœ€å¤§ï¼Œä¸ºæ ‘é«˜ï¼Œå³ä¸º $log_2\ n$ï¼›è¿›è¡Œ n æ¬¡ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º $n\ log_2\ n$ã€‚</p><p>éå®Œå…¨äºŒå‰æ ‘æ—¶å°±æ›´å¿«äº†ï¼Œå› ä¸ºå¾ˆå®¹æ˜“ä¸æ»¡è¶³å¯¹ç§°è¦æ±‚ï¼Œå°±è¢«å‰ªæå‰ªæ‰äº†ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">point</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> fa, l, r, w, num;</span><br><span class="line">&#125;p[N];</span><br><span class="line"><span class="keyword">int</span> n, x, y;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">upd</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    p[x].num = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (p[x].l &gt; <span class="number">0</span>) upd(p[x].l), p[x].num += p[p[x].l].num;</span><br><span class="line">    <span class="keyword">if</span> (p[x].r &gt; <span class="number">0</span>) upd(p[x].r), p[x].num += p[p[x].r].num;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chk</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (u &lt; <span class="number">0</span> &amp;&amp; v &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (u &gt; <span class="number">0</span> &amp;&amp; v &gt; <span class="number">0</span> &amp;&amp; p[u].w == p[v].w &amp;&amp; chk(p[u].l, p[v].r) &amp;&amp; chk(p[u].r, p[v].l))</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">cin</span> &gt;&gt; p[i].w;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y;</span><br><span class="line">        p[i].l = x;</span><br><span class="line">        <span class="keyword">if</span> (x &gt; <span class="number">0</span>) p[x].fa = i;</span><br><span class="line">        p[i].r = y;</span><br><span class="line">        <span class="keyword">if</span> (y &gt; <span class="number">0</span>) p[y].fa = i;</span><br><span class="line">    &#125;</span><br><span class="line">    upd(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">if</span> (chk(p[i].l, p[i].r)) ans = max(ans, p[i].num);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[LG1365]-WJMZBMRæ‰“osu!</title>
      <link href="2018/11/01/%5Bluogu1365%5D-WJMZBMR%E6%89%93osu%EF%BC%81/"/>
      <url>2018/11/01/%5Bluogu1365%5D-WJMZBMR%E6%89%93osu%EF%BC%81/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.luogu.org/problemnew/show/P1365" target="_blank" rel="noopener">é¢˜ç›®é“¾æ¥</a></p><p>æœŸæœ›DPï¼</p><p>è®¾ f[i] è¡¨ç¤ºåˆ°äº†ç¬¬ i ä½çš„æ€»æœŸæœ›ï¼Œg[i] è¡¨ç¤ºåˆ°äº†ç¬¬ i ä½ç»“å°¾çš„è¿ç»­ o çš„æœŸæœ›é•¿åº¦ï¼Œé‚£ä¹ˆï¼š</p><ol><li>å½“ s[i] = x, åˆ™ f[i] = f[i - 1], g[i] = 0.</li><li>å½“ s[i] = o, åˆ™ f[i] = f[i - 1] + 2g[i - 1] + 1, g[i] = g[i - 1] + 1(è¿™ä¸€æ­¥å¯ä»¥æ ¹æ®å®Œå…¨å¹³æ–¹å…¬å¼æ¨å‡º)</li><li>å½“ s[i] = ?, åˆ™ f[i] = f[i - 1] + g[i - 1] + 0.5, g[i] = (g[i - 1] + 1) / 2.</li></ol><p>æˆ‘ä»¬å‘ç°è½¬ç§»æ—¶çš„çŠ¶æ€åªä¸ä¸Šä¸€è½®çš„çŠ¶æ€æœ‰å…³ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨æ»šåŠ¨æ•°ç»„èŠ‚çœç©ºé—´ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, now;</span><br><span class="line"><span class="keyword">char</span> ch;</span><br><span class="line"><span class="keyword">double</span> f[<span class="number">2</span>], g[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; ch;</span><br><span class="line">        <span class="keyword">if</span> (ch == <span class="string">'x'</span>) f[now ^ <span class="number">1</span>] = f[now], g[now ^ <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (ch == <span class="string">'o'</span>) f[now ^ <span class="number">1</span>] = f[now] + <span class="number">2</span> * g[now] + <span class="number">1</span>, g[now ^ <span class="number">1</span>] = g[now] + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> f[now ^ <span class="number">1</span>] = f[now] + g[now] + <span class="number">0.5</span>, g[now ^ <span class="number">1</span>] = g[now] / <span class="number">2</span> + <span class="number">0.5</span>;</span><br><span class="line">        now ^= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%.4lf\n"</span>, f[now]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¦‚ç‡ä¸æœŸæœ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 518 Div2</title>
      <link href="2018/10/28/Codeforces%20Round%20518%20Div2/"/>
      <url>2018/10/28/Codeforces%20Round%20518%20Div2/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/1068" target="_blank" rel="noopener">æ¯”èµ›é“¾æ¥</a></p><p>æ˜¯vpçš„</p><h3 id="A-Birthday"><a href="#A-Birthday" class="headerlink" title="A. Birthday"></a>A. Birthday</h3><hr><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line">ll n, m, k, l;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; k &gt;&gt; l) &#123;</span><br><span class="line">        <span class="keyword">if</span> (k + l &gt; n || m &gt; n) &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"-1"</span>); <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ll tmp;</span><br><span class="line">        <span class="keyword">if</span> ((l + k) % m == <span class="number">0</span>) tmp = (l + k) / m;</span><br><span class="line">        <span class="keyword">else</span> tmp = (l + k) / m + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (tmp * m &gt; n) <span class="built_in">puts</span>(<span class="string">"-1"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; tmp &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-LCM"><a href="#B-LCM" class="headerlink" title="B. LCM"></a>B. LCM</h3><hr><p>æ•°å­¦å¦™é¢˜ï¼Œ$\frac{[a, b]}{a}=\frac{b}{gcd(a, b)}$, æ‰€ä»¥å…¶å®å°±æ˜¯æ±‚ b çš„çº¦æ•°ä¸ªæ•°ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll vis[N], prime[N], cnt = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Prime</span><span class="params">()</span> </span>&#123;  <span class="comment">// ç­›è´¨æ•°</span></span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="literal">false</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">2</span>; i &lt;= <span class="number">100000</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i]) &#123;</span><br><span class="line">            prime[cnt++] = i;</span><br><span class="line">            <span class="keyword">for</span> (ll j = i * i; j &lt;= <span class="number">100000</span>; j += i) vis[j] = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">work</span><span class="params">(ll n)</span> </span>&#123; <span class="comment">// è®¡ç®—çº¦æ•°ä¸ªæ•°</span></span><br><span class="line">    ll ans, sum;</span><br><span class="line">    ans = <span class="number">0</span>, sum = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; cnt &amp;&amp; prime[i] * prime[i] &lt;= n; i++) &#123;</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (n % prime[i] == <span class="number">0</span>) &#123;</span><br><span class="line">            ans++; n /= prime[i];</span><br><span class="line">        &#125;</span><br><span class="line">        sum *= (ans + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>) sum *= (<span class="number">1</span> + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Prime();</span><br><span class="line">    ll n;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; n) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; work(n) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-Colored-Rooks"><a href="#C-Colored-Rooks" class="headerlink" title="C. Colored Rooks"></a>C. Colored Rooks</h3><hr><p>æ„é€ é¢˜ï¼Œåº”è¯¥è¦ç”¨å°½é‡ç®€å•çš„æ–¹å¼ã€‚æ¯”å¦‚è¯´è¿™é¢˜ï¼Œå¯ä»¥åœ¨ (i, i) ä¸Šæ”¾ç¬¬ i ç§é¢œè‰²çš„è½¦ï¼Œè¿™æ ·ä¿è¯æ¯ç§é¢œè‰²éƒ½å æ®ä¸€æ ¼ä¸”äº’ä¸ç›¸è¿ã€‚æ¥ä¸‹æ¥å¯ä»¥åœ¨äº’ä¸ç›¸è¿çš„åŸºç¡€ä¸Šæ·»åŠ ç›¸è¿é¢œè‰²çš„è½¦ï¼Œå³å¦‚æœé¢œè‰² a å’Œé¢œè‰² b æ˜¯ä¸€å¯¹ï¼Œé‚£ä¹ˆå°±åœ¨ (a, j) å’Œ (b, j) ä¸Šæ”¾ä¸€å¯¹è½¦ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; pos[<span class="number">105</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) pos[i].push_back(make_pair(i, i));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y;</span><br><span class="line">        pos[x].push_back(make_pair(x, n + i));</span><br><span class="line">        pos[y].push_back(make_pair(y, n + i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; pos[i].size() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; (<span class="keyword">int</span>)pos[i].size(); j++)</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; pos[i][j].first &lt;&lt; <span class="string">' '</span> &lt;&lt; pos[i][j].second &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 514 Div2</title>
      <link href="2018/10/21/Codeforces%20Round%20514%20Div2/"/>
      <url>2018/10/21/Codeforces%20Round%20514%20Div2/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/1059" target="_blank" rel="noopener">æ¯”èµ›é“¾æ¥</a></p><p>è¿™åœºå› ä¸ºç¬¬ä¸€é¢˜é¢˜æ„ä¸æ‡‚ï¼Œå°±å¡åœ¨ç¬¬ä¸€é¢˜ä¸Šäº†ï¼Œå¯¼è‡´çˆ†é›¶ã€‚</p><h3 id="A-Cashier"><a href="#A-Cashier" class="headerlink" title="A. Cashier"></a>A. Cashier</h3><hr><p>è¿™é¢˜çš„æ„æ€æ˜¯ä¸¤ä¸ªæ—¶é—´æ®µä¹‹é—´èƒ½ä¼‘æ¯å¤šå°‘ä¸ªaã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> l[N], r[N], n, L, a;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; L &gt;&gt; a;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; l[i] &gt;&gt; r[i];</span><br><span class="line">        r[i] += l[i];</span><br><span class="line">        ret += (l[i] - r[i - <span class="number">1</span>]) / a;</span><br><span class="line">    &#125;</span><br><span class="line">    ret += (L - r[n]) / a;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ret &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-Forgery"><a href="#B-Forgery" class="headerlink" title="B. Forgery"></a>B. Forgery</h3><hr><p>Bé¢˜éœ€è¦è½¬åŒ–ä¸€æ­¥ã€‚æˆ‘ä»¬å¯ä»¥é¡ºæ€é€†æƒ³ï¼šå¯¹äº (i, j)ï¼Œè‹¥å®ƒçš„å…«ä¸ªæ–¹å‘éƒ½ä¸º #ï¼Œè¡¨ç¤º (i, j) è¿™ä¸ªä½ç½®æœ‰ä¸€æ­¥æŸ“è‰²æ“ä½œï¼›å¦åˆ™æ²¡æœ‰ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1000</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> d[<span class="number">8</span>][<span class="number">2</span>] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">-1</span>&#125;;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">char</span> s[N][N], a[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chk</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    rep(i, <span class="number">0</span>, <span class="number">7</span>) <span class="keyword">if</span> (s[x + d[i][<span class="number">0</span>]][y + d[i][<span class="number">1</span>]] != <span class="string">'#'</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">cin</span> &gt;&gt; (s[i] + <span class="number">1</span>);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) rep(j, <span class="number">1</span>, m) a[i][j] = <span class="string">'.'</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        rep(j, <span class="number">1</span>, m)</span><br><span class="line">            <span class="keyword">if</span> (chk(i, j))</span><br><span class="line">                rep(k, <span class="number">0</span>, <span class="number">7</span>) a[i + d[k][<span class="number">0</span>]][j + d[k][<span class="number">1</span>]] = <span class="string">'#'</span>;</span><br><span class="line">    rep(i, <span class="number">1</span>, n)</span><br><span class="line">        rep(j, <span class="number">1</span>, m)</span><br><span class="line">            <span class="keyword">if</span> (a[i][j] != s[i][j]) &#123;</span><br><span class="line">                <span class="built_in">puts</span>(<span class="string">"NO"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"YES"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-Sequence-Transformation"><a href="#C-Sequence-Transformation" class="headerlink" title="C. Sequence Transformation"></a>C. Sequence Transformation</h3><hr><p>å› ä¸ºä¸¤ä¸ªå¥‡æ•°çš„gcdè‚¯å®šæ˜¯1ï¼Œæˆ‘ä»¬ç¬¬ä¸€è½®è¦å…ˆåˆ æ‰æ‰€æœ‰å¥‡æ•°ï¼Œç„¶åæ¥ä¸‹æ¥æ¯ä¸€è½®éƒ½åˆ æ‰2çš„å¹‚æ¬¡æ–¹ï¼Œè¿™æ ·ä½¿gcdåºåˆ—å˜å¤§çš„é€Ÿåº¦æ˜¯æœ€å¿«çš„ï¼Œè€Œä¸”å¢å¤§çš„å¹…åº¦ä¹Ÿæ˜¯æœ€å¤§çš„ã€‚</p><p>å”¯ä¸€ä¸€ä¸ªç‰¹ä¾‹å°±æ˜¯ = 3çš„æ—¶å€™ï¼Œæ˜¯ 1 1 3.</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i * <span class="number">4</span> &gt; n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i * <span class="number">2</span> &gt; n) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, i);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (i * <span class="number">3</span> &gt; n) <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>, i, i * <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d %d %d\n"</span>, i, i, i * <span class="number">3</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt;= n; j += (i &lt;&lt; <span class="number">1</span>)) <span class="built_in">printf</span>(<span class="string">"%d "</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 516 Div2</title>
      <link href="2018/10/15/Codeforces%20Round%20516%20Div2/"/>
      <url>2018/10/15/Codeforces%20Round%20516%20Div2/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/1064" target="_blank" rel="noopener">æ¯”èµ›é“¾æ¥</a></p><h3 id="A-Make-a-triangle"><a href="#A-Make-a-triangle" class="headerlink" title="A. Make a triangle!"></a>A. Make a triangle!</h3><hr><p>å­¦è¿‡ä¸‰è§’å½¢å°±è¡Œäº†ï½</p><h3 id="B-Equations-of-Mathematical-Magic"><a href="#B-Equations-of-Mathematical-Magic" class="headerlink" title="B. Equations of Mathematical Magic"></a>B. Equations of Mathematical Magic</h3><hr><p>a - (a ^ x) - x = 0 ===&gt; a ^ x = a - x, å³ x äºŒè¿›åˆ¶ä½ä¸­çš„ 1 æ˜¯ a ä¸­çš„å­é›†ã€‚è¿™ä¹Ÿå¯ä»¥é€šè¿‡æ‰“è¡¨å‘ç°ã€‚æ‰€ä»¥å°±æ˜¯è®° cnt ä¸º a ä¸­äºŒè¿›åˆ¶ä½ä¸º 1 çš„ä¸ªæ•°ï¼Œç­”æ¡ˆå°±æ˜¯ $2^{cnt}$.</p><h3 id="C-Oh-Those-Palindromes"><a href="#C-Oh-Those-Palindromes" class="headerlink" title="C. Oh Those Palindromes"></a>C. Oh Those Palindromes</h3><hr><p>å¯ä»¥å‘ç°ï¼Œå°†ç›¸åŒçš„æ•°å­—æ’åˆ—åœ¨ä¸€èµ·ï¼Œå›æ–‡å­—ä¸²æ•°ç›®æœ€å¤§ã€‚</p><h3 id="D-Labyrinth"><a href="#D-Labyrinth" class="headerlink" title="D. Labyrinth"></a>D. Labyrinth</h3><hr><p>è£¸çš„BFSåº”è¯¥è¿‡ä¸å»ï¼Œå¯ä»¥ç”¨åŒç«¯é˜Ÿåˆ—ä¼˜åŒ–ã€‚å› ä¸ºæˆ‘ä»¬å¸Œæœ›å·¦å³çš„æ­¥æ•°å°½é‡ä¸è¦å‡å°‘ï¼Œæˆ‘ä»¬æŠŠå·¦å³çš„èµ°æ­¥push_backï¼Œä¸Šä¸‹çš„èµ°æ­¥push_frontã€‚å¯¹dequeåˆæœ‰äº†æ·±ä¸€å±‚çš„äº†è§£ï¼</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2010</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, r, c, nx, ny;</span><br><span class="line"><span class="keyword">char</span> s[N][N];</span><br><span class="line"><span class="keyword">bool</span> vis[N][N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> x, y, nx, ny;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">deque</span>&lt;node&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bfs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">        node now = q.front(); q.pop_front();</span><br><span class="line">        <span class="keyword">int</span> x = now.x, y = now.y;</span><br><span class="line">        <span class="keyword">int</span> nx = now.nx, ny = now.ny;</span><br><span class="line">        <span class="keyword">if</span> (vis[x][y]) <span class="keyword">continue</span>;</span><br><span class="line">        vis[x][y] = <span class="number">1</span>;</span><br><span class="line">        cnt++;</span><br><span class="line">        <span class="keyword">if</span> (x - <span class="number">1</span> &gt; <span class="number">0</span> &amp;&amp; s[x - <span class="number">1</span>][y] != <span class="string">'*'</span>) q.push_front((node)&#123;x - <span class="number">1</span>, y, nx, ny&#125;);</span><br><span class="line">        <span class="keyword">if</span> (x + <span class="number">1</span> &lt;= n &amp;&amp; s[x + <span class="number">1</span>][y] != <span class="string">'*'</span>) q.push_front((node)&#123;x + <span class="number">1</span>, y, nx, ny&#125;);</span><br><span class="line">        <span class="keyword">if</span> (y - <span class="number">1</span> &gt; <span class="number">0</span> &amp;&amp; s[x][y - <span class="number">1</span>] != <span class="string">'*'</span> &amp;&amp; nx) q.push_back((node)&#123;x, y - <span class="number">1</span>, nx - <span class="number">1</span>, ny&#125;);</span><br><span class="line">        <span class="keyword">if</span> (y + <span class="number">1</span> &lt;= m &amp;&amp; s[x][y + <span class="number">1</span>] != <span class="string">'*'</span> &amp;&amp; ny) q.push_back((node)&#123;x, y + <span class="number">1</span>, nx, ny - <span class="number">1</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; r &gt;&gt; c &gt;&gt; nx &gt;&gt; ny;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">cin</span> &gt;&gt; (s[i] + <span class="number">1</span>);</span><br><span class="line">    q.push_front((node)&#123;r, c, nx, ny&#125;);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; bfs() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 513 Div2</title>
      <link href="2018/10/04/Codeforces%20Round%20513%20Div2/"/>
      <url>2018/10/04/Codeforces%20Round%20513%20Div2/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/1060" target="_blank" rel="noopener">æ¯”èµ›é“¾æ¥</a></p><p>è¿™æ¬¡æ‰“äº†ä¸¤é“ï¼Œä½†T2è™½ç„¶æ€è·¯æ²¡é”™ï¼Œä½†ç»†èŠ‚å¤„ç†é”™è¯¯ï¼ŒGGäº†ã€‚ã€‚ã€‚ä¸è¿‡è¿™æ¬¡é¢˜ç›®è¿˜æ˜¯å¾ˆæœ‰è¶£çš„ï¼ï¼è¡¥äº†4é“ï¼ï¼</p><h3 id="A-Phone-Numbers"><a href="#A-Phone-Numbers" class="headerlink" title="A. Phone Numbers"></a>A. Phone Numbers</h3><hr><p>H2Oé¢˜ã€‚ans = min(n / 11, sum)ï¼Œå…¶ä¸­ sum æ˜¯ 8 çš„ä¸ªæ•°ã€‚</p><h3 id="B-Maximum-Sum-of-Digits"><a href="#B-Maximum-Sum-of-Digits" class="headerlink" title="B. Maximum Sum of Digits"></a>B. Maximum Sum of Digits</h3><hr><p>æš´åŠ›æ‰¾ä¸€ä¸‹è§„å¾‹ï¼Œå‘ç°å¦‚æœ n æœ‰ x ä½ï¼Œé‚£ä¹ˆ a å°±æ˜¯ x ä½çš„ï¼š(n æœ€é«˜ä½æ•°å­— - 1) + 9 + 9 + 9 â€¦ + 9. å…¶ä¸­æœ‰ x - 1 ä¸ª 9. b = n - a.</p><p>ä¸è¦å¿˜äº†åˆ¤æ–­ï¼Œå¦‚æœ n æœ¬èº«å°±æ˜¯ k + 9 + 9 â€¦ + 9 å½¢å¼çš„ï¼Œa = k, b = 0. (å•Šå•Šå•Šåœ¨è¿™é‡Œç©è„±äº†ã€‚ã€‚ã€‚ç›´æ¥è¾“å‡º n äº†ã€‚ã€‚ã€‚åº”è¯¥æ˜¯ S(n) å•Š</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">get</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">    ll sum = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (x) &#123;</span><br><span class="line">        sum *= <span class="number">10</span>; x /= <span class="number">10</span>;</span><br><span class="line">    &#125; <span class="keyword">return</span> sum / <span class="number">10</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">S</span><span class="params">(ll x)</span> </span>&#123;</span><br><span class="line">    ll sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (x) &#123;</span><br><span class="line">        sum += x % <span class="number">10</span>; x /= <span class="number">10</span>;</span><br><span class="line">    &#125; <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">10</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, n); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ll bound = get(n);</span><br><span class="line">        ll x = n - (n % bound);</span><br><span class="line">        <span class="keyword">if</span> (n == x + bound - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, S(n)); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ll a = n - (n % bound) - <span class="number">1</span>, b = n - a;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, S(a) + S(b));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-Maximum-Subrectangle"><a href="#C-Maximum-Subrectangle" class="headerlink" title="C. Maximum Subrectangle"></a>C. Maximum Subrectangle</h3><hr><p>æ¯”èµ›æ—¶æƒ³åˆ°äº† $c_{i, j}$ æ˜¯ä¸ªæ‘†è®¾ï¼Œè¦æ‹†çš„ï¼Œä½†ä¸€ç›´åœ¨æƒ³æ€ä¹ˆæšä¸¾ x1, x2, y1, y2, å®é™…ä¸ç”¨è¿™æ ·çš„ã€‚</p><p>é¦–å…ˆæ‹†å…¬å¼ï¼š</p><p>$$\sum\limits_{i = x1}^{x2} \sum\limits_{j = y1}^{y2} c_{i, j} = (\sum\limits_{i = x1}^{x2}a_i) * (\sum\limits_{j = y1}^{y2}b_j)$$</p><p>ç„¶åæˆ‘ä»¬å¯ä»¥ $O(n^2)$ é¢„å¤„ç†å‡ºæ¯ä¸€æ®µ a çš„åŒºé—´ [l, r]ã€‚è®° $\sum\limits_{i = l}^r a_i$ ä¸º Sï¼Œåˆ™æˆ‘ä»¬å¼€ä¸€ä¸ª $2000 ^ 2$ çš„æ•°ç»„ Aï¼ŒA[S] = max(A[S], r - l + 1). å³ä»¥åŒºé—´å’Œä¸ºä¸‹æ ‡ï¼Œé•¿åº¦ä¸ºæ•°å€¼ã€‚å¯¹äº b æ•°ç»„ä¸€æ ·çš„æ“ä½œã€‚</p><p>ç„¶åç”¨ two pointersï¼Œi ä» $2000 ^ 2$ å¼€å§‹å¾€å°æ‰«ï¼Œposåªä¼šè¶Šæ¥è¶Šå¤§ã€‚åº”è¯¥æ˜¯ O(n)ã€‚åŒæ—¶ç»Ÿè®¡ç­”æ¡ˆã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2010</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> a[N], b[N], A[N * N], B[N * N];</span><br><span class="line">ll x;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;b[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt;= n; j++)</span><br><span class="line">            sum += a[j], A[sum] = max(A[sum], j - i + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt;= m; j++)</span><br><span class="line">            sum += b[j], B[sum] = max(B[sum], j - i + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;x);</span><br><span class="line">    <span class="keyword">int</span> MAXSUM = <span class="number">2000</span> * <span class="number">2000</span>, pos = <span class="number">1</span>, ans = <span class="number">0</span>, now = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = MAXSUM; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">        <span class="keyword">if</span> (A[i]) &#123;</span><br><span class="line">            <span class="keyword">while</span> (pos &lt;= MAXSUM &amp;&amp; <span class="number">1l</span>l * i * pos &lt;= x) now = max(now, B[pos++]);</span><br><span class="line">            ans = max(ans, A[i] * now);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D-Social-Circles"><a href="#D-Social-Circles" class="headerlink" title="D. Social Circles"></a>D. Social Circles</h3><hr><p>è¿™é¢˜è¶…å¥½ç©ï¼ï¼</p><p>æ˜¯è¿™æ ·çš„ï¼Œæ¯ä¸ªäººçš„ $l_i$ å¿…å®šè¦å’Œè‡ªå·±æˆ–å¦ä¸€ä¸ªäººçš„ $r_i$ åŒ¹é…ï¼Œè´¡çŒ®æ˜¯ $max(l_i, r_i)$. æ‰€ä»¥æˆ‘ä»¬è¦æœ€å°åŒ– $max(l_i, r_i)$. è¿™æ—¶å€™å°±ä¸è¦å°†ç¬¬ i ä¸ªäººçš„ l å’Œ r ç»‘å®šäº†ã€‚</p><p>åˆ†åˆ«æ’åº l å’Œ rã€‚ç­”æ¡ˆå°±æ˜¯ $\sum_{i = 1}^n max(l_i, r_i)$.</p><p>æˆ‘ä»¬å¯ä»¥è¿™æ ·è€ƒè™‘ï¼šè‹¥ $l_n$ æ˜¯ l æ•°ç»„å’Œ r æ•°ç»„ä¸­çš„æœ€å¤§å€¼ï¼Œå®ƒçš„åŒ¹é…å€¼å¿…ç„¶æ˜¯å°½é‡å¤§çš„ã€æ¥è¿‘å®ƒçš„ï¼Œå³ $r_n$ã€‚å‰©ä¸‹çš„ $2 * (n - 1)$ ä¸ªå…ƒç´ åˆæ˜¯è¿™æ ·ä¸€ä¸ªå­é—®é¢˜ï¼Œç”¨æ•°å­¦å½’çº³æ³•å³å¯è¯æ˜ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, l[N], r[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;l[i], &amp;r[i]);</span><br><span class="line">    sort(l + <span class="number">1</span>, l + n + <span class="number">1</span>);</span><br><span class="line">    sort(r + <span class="number">1</span>, r + n + <span class="number">1</span>);</span><br><span class="line">    ll ans = n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) ans += max(l[i], r[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="E-Sergey-and-Subway"><a href="#E-Sergey-and-Subway" class="headerlink" title="E. Sergey and Subway"></a>E. Sergey and Subway</h3><hr><p>è¿™é¢˜çš„æ„æ€å¾ˆå¥½ç†è§£ã€‚æ˜¯ä¸€é“æ ‘å½¢DPï¼Œè¿˜æ²¡æœ‰æ¶‰åŠè¿‡çš„ã€‚</p><p>é¦–å…ˆæ¥è€ƒè™‘ä¸€ä¸ªåŸºç¡€é—®é¢˜ï¼šç»™å®šä¸€æ£µæ ‘ï¼Œæ±‚å…¶ä¸­æ¯å¯¹èŠ‚ç‚¹çš„è·ç¦»åªå’Œï¼Œå³ $\sum\limits_{i = 1}^n \sum\limits_{j = 1}^n dist(i, j)$.</p><p>æˆ‘ä»¬å…ˆå®šä¹‰ä¸€äº›é‡ï¼šsum[x] è¡¨ç¤º x å­æ ‘ä¸­çš„ç‚¹åˆ° x çš„è·ç¦»ä¹‹å’Œï¼Œcnt[x] è¡¨ç¤º x å­æ ‘ä¸­çš„ç‚¹çš„æ•°é‡ï¼Œanså³ç­”æ¡ˆï¼Œvå³ x çš„å„¿å­èŠ‚ç‚¹ã€‚</p><p>ä¼ªä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(è¿›å…¥ x å­æ ‘)</span><br><span class="line"><span class="number">1.</span> sum[x] = <span class="number">0</span>, cnt[x] = <span class="number">1</span></span><br><span class="line"><span class="number">2.</span> dfs(v)</span><br><span class="line"><span class="number">3.</span> sum[v] += cnt[v]  <span class="comment">// v åˆ° x ä¹‹é—´æœ‰ä¸€æ­¥ä¹‹å·®ï¼Œå…ˆç»Ÿè®¡åˆ° sum[v] ä¸Šå»</span></span><br><span class="line"><span class="number">4.</span> ans += sum[x] * cnt[v] + sum[v] * cnt[x]  <span class="comment">// sum[x] æ­¤æ—¶æ˜¯ x ä¸€éƒ¨åˆ†å„¿å­çš„è·ç¦»ä¹‹å’Œã€‚è¿™ä¸€æ­¥å¯ä»¥è§†ä¸ºä¸¤ä¸ªé›†åˆåˆå¹¶çš„è¿‡ç¨‹</span></span><br><span class="line"><span class="number">5.</span> sum[x] += sum[v], cnt[x] += cnt[v]</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆ E é¢˜æ˜¯ä¸€é“è¿›é˜¶ç‰ˆçš„ã€‚å¯¹äºç‚¹ (u, v), ç°åœ¨çš„ dist(u, v) (è¡¨ç¤ºä¸º Now)ç­‰äºåŸºç¡€é—®é¢˜ä¸­ dist(u, v) (è¡¨ç¤ºä¸º Bef)é™¤ä»¥äºŒä¸Šå–æ•´ã€‚æœ‰çš„ Bef = 2Nowï¼Œæœ‰çš„ Bef = 2Now - 1.</p><p>ä¸å¯èƒ½æ•´ä½“é™¤ä»¥äºŒä¸Šå–æ•´ï¼Œä½†æ­£å› ä¸ºæ˜¯é™¤ä»¥äºŒï¼Œæ•°æ®å°‘ï¼Œå¯ä»¥æ‰‹åŠ¨å¤„ç†ã€‚æˆ‘ä»¬æ–°å»ºä¸€äº›é‡ï¼šsum[x, 0] è¡¨ç¤º x å­æ ‘ä¸­åˆ° x çš„è·ç¦»ä¸ºå¶æ•°çš„ç‚¹åˆ° x çš„è·ç¦»ï¼Œsum[x, 1] å¯¹åº”çš„å°±æ˜¯å¥‡æ•°ï¼›cnt[x, 0] è¡¨ç¤º x å­æ ‘ä¸­åˆ° x çš„è·ç¦»ä¸ºå¶æ•°çš„ç‚¹æ•°ï¼Œcnt[x, 1] å¯¹åº”çš„å°±æ˜¯å¥‡æ•°ï¼›ans[0] è¡¨ç¤ºè·ç¦»ä¸ºå¶æ•°çš„ç‚¹å¯¹çš„è·ç¦»ä¹‹å’Œï¼Œans[1] å¯¹åº”çš„å°±æ˜¯å¥‡æ•°ã€‚</p><p>ç”±äºç­”æ¡ˆ = (ans[0] / 2) + (ans[1] + è·ç¦»ä¸ºå¥‡æ•°çš„ç‚¹å¯¹æ•°é‡) / 2ï¼Œæˆ‘ä»¬å†å¼€ä¸€ä¸ªæ•°ç»„ C[], C[1] è¡¨ç¤ºè·ç¦»ä¸ºå¥‡æ•°çš„ç‚¹å¯¹æ•°é‡ï¼Œæ–¹ä¾¿æœ€åè®¡ç®—ã€‚</p><p>äº”æ­¥åˆ†åˆ«å¯¹åº”ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> sum[x][<span class="number">0</span>] = sum[x][<span class="number">1</span>] = cnt[x][<span class="number">1</span>] = <span class="number">0</span>, cnt[x][<span class="number">0</span>] = <span class="number">1.</span></span><br><span class="line"><span class="number">2.</span> dfs(v)</span><br><span class="line"><span class="number">3.</span> sum[v][<span class="number">0</span>] += cnt[v][<span class="number">0</span>], sum[v][<span class="number">1</span>] += cnt[v][<span class="number">1</span>].</span><br><span class="line">   swap(sum[v][<span class="number">0</span>], sum[v][<span class="number">1</span>]), swap(cnt[v][<span class="number">0</span>], cnt[v][<span class="number">1</span>])  <span class="comment">// å› ä¸ºå¢åŠ äº† v åˆ° x çš„ä¸€æ­¥ä¹‹å·®ï¼Œè·¯å¾„å¥‡å¶æ”¹å˜</span></span><br><span class="line"><span class="number">4.</span> ans[(j + k) &amp; <span class="number">1</span>] += sum[x][j] * cnt[v][k] + sum[x][k] * cnt[v][j]</span><br><span class="line">   C[(j + k) &amp; <span class="number">1</span>] += cnt[x][j] * cnt[v][k]</span><br><span class="line"><span class="number">5.</span> sum[x][j] += sum[v][j], cnt[x][j] += cnt[v][j].</span><br></pre></td></tr></table></figure><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> nxt, to;</span><br><span class="line">&#125;e[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> n, lnk[N], tot;</span><br><span class="line">ll sum[N][<span class="number">2</span>], cnt[N][<span class="number">2</span>], ans[<span class="number">2</span>], C[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    e[++tot].to = v, e[tot].nxt = lnk[u], lnk[u] = tot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    cnt[x][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = e[i].nxt) <span class="keyword">if</span> (e[i].to != fa) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = e[i].to;</span><br><span class="line">        dfs(v, x);</span><br><span class="line">        sum[v][<span class="number">0</span>] += cnt[v][<span class="number">0</span>], sum[v][<span class="number">1</span>] += cnt[v][<span class="number">1</span>];</span><br><span class="line">        swap(sum[v][<span class="number">0</span>], sum[v][<span class="number">1</span>]);</span><br><span class="line">        swap(cnt[v][<span class="number">0</span>], cnt[v][<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">2</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">2</span>; k++) &#123;</span><br><span class="line">                ans[(j + k) &amp; <span class="number">1</span>] += sum[x][j] * cnt[v][k] + cnt[x][j] * sum[v][k];</span><br><span class="line">                C[(j + k) &amp; <span class="number">1</span>] += cnt[x][j] * cnt[v][k];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">2</span>; j++) sum[x][j] += sum[v][j], cnt[x][j] += cnt[v][j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> u, v;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v);</span><br><span class="line">        add(u, v), add(v, u);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, (ans[<span class="number">1</span>] + C[<span class="number">1</span>]) / <span class="number">2</span> + ans[<span class="number">0</span>] / <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 512 Div2</title>
      <link href="2018/10/01/Codeforces%20Round%20512%20Div2/"/>
      <url>2018/10/01/Codeforces%20Round%20512%20Div2/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/1058" target="_blank" rel="noopener">æ¯”èµ›é“¾æ¥</a></p><p>é¢˜ç›®æ¯”è¾ƒç®€å•ï¼Œåšäº†å››é“å–”å“ˆå“ˆå“ˆï½</p><h3 id="A-In-Search-of-an-Easy-Problem"><a href="#A-In-Search-of-an-Easy-Problem" class="headerlink" title="A. In Search of an Easy Problem"></a>A. In Search of an Easy Problem</h3><hr><p>$H_2O$ ç­¾åˆ°é¢˜</p><h3 id="B-Vasya-and-Cornfield"><a href="#B-Vasya-and-Cornfield" class="headerlink" title="B. Vasya and Cornfield"></a>B. Vasya and Cornfield</h3><hr><p>ä¸çŸ¥é“æœ‰æ²¡æœ‰ä¼˜ç¾çš„æ–¹æ³•ï½ä¸è¿‡æˆ‘çš„æ¯”è¾ƒå®¹æ˜“æƒ³åˆ°ï¼Œå°±æ˜¯æŠŠ {(0, d), (d, 0), (n, n - d), (n - d, n)} åŒºåŸŸæŸ“è‰²ï¼Œç„¶å O(1) å›ç­”è¯¢é—®ï½</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> mark[<span class="number">110</span>][<span class="number">110</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, d, m, x, y;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;n, &amp;d, &amp;m);</span><br><span class="line">    <span class="keyword">int</span> dx, dy;</span><br><span class="line">    dx = dy = <span class="number">1</span>;</span><br><span class="line">    x = <span class="number">-1</span>, y = d + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= d; i++) &#123;</span><br><span class="line">        x++, y--;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= n - d; j++) mark[x + j][y + j] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (x != d &amp;&amp; y != <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n - d; j++) mark[x + j + <span class="number">1</span>][y + j] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (m--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</span><br><span class="line">        <span class="keyword">if</span> (mark[x][y]) <span class="built_in">puts</span>(<span class="string">"YES"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"NO"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-Vasya-and-Golden-Ticket"><a href="#C-Vasya-and-Golden-Ticket" class="headerlink" title="C. Vasya and Golden Ticket"></a>C. Vasya and Golden Ticket</h3><hr><p>å› ä¸ºæ•°æ®å¾ˆå°ï¼Œ$\sum_{i = 1}^n a_i$ æœ€å¤šæ˜¯ 900ï¼Œæ‰€ä»¥å¯ä»¥ä» 0 åˆ° tot æšä¸¾å•å—çš„æ•°å€¼å’Œï¼Œchkå‡½æ•°åˆ¤æ–­ã€‚è™½ç„¶ä¸èƒ½ç”¨äºŒåˆ†ï¼Œä½†æš´åŠ›æšä¸¾ä¹Ÿå¯ä»¥è¿‡ï¼</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, a[<span class="number">110</span>], tot;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">110</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chk</span><span class="params">(<span class="keyword">int</span> limit)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>, cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        sum += a[i];</span><br><span class="line">        <span class="keyword">if</span> (sum == limit) sum -= limit, ++cnt;</span><br><span class="line">        <span class="keyword">if</span> (sum &gt; limit) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (sum) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        a[i] = s[i] - <span class="string">'0'</span>;</span><br><span class="line">        tot += a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!tot) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"YES"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tot; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp; tot % i &gt; <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span> (chk(i)) &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"YES"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"NO"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D-Vasya-and-Triangle"><a href="#D-Vasya-and-Triangle" class="headerlink" title="D. Vasya and Triangle"></a>D. Vasya and Triangle</h3><hr><p>å› ä¸ºå­˜åœ¨å¤šä¸ªç­”æ¡ˆï¼Œæ˜¯æ„é€ é¢˜ï¼Œæ‰€ä»¥æŒ‘æœ€å®¹æ˜“æ„çš„ç›´è§’ä¸‰è§’å½¢å°±å¯ä»¥è¿‡ã€‚</p><p>é¦–å…ˆâ€“ä¸‰è§’å½¢å‘é‡é¢ç§¯å…¬å¸â€“å‰ç§¯å…¬å¼äº†è§£ä¸€ä¸‹ï¼š$S = \frac{1}{2} |x_1y_2 - x_2y_1|$, å…¶ä¸­ $(x_1, y_1)$ $(x_2, y_2)$ åˆ†åˆ«æ˜¯ä¸‰è§’å½¢ä¸¤è¾¹æ‰€è¡¨ç¤ºå‘é‡çš„åæ ‡ã€‚</p><p>é¦–å…ˆï¼Œæ ¹æ®å‰ç§¯å…¬å¼ç®—å‡ºæ¥çš„ 2S ä¸€å®šæ˜¯æ•´æ•°ï¼Œé‚£ä¹ˆ $\frac{nm}{k}$ ä¸€å®šæ˜¯ 0.5 çš„å€æ•°ï¼Œå³ $\frac{2nm}{k}$ åº”è¯¥æ˜¯æ•´æ•°ï¼Œåä¹‹è‹¥ $2 * n * m\ mod\ k \neq 0$, æ— è§£.</p><p>æ¥ä¸‹æ¥æ˜¯æœ‰è§£çš„æƒ…å†µã€‚</p><p>æ„é€ ç›´è§’ä¸‰è§’å½¢ï¼Œç›¸å½“äºæ„é€ ä¸€ä¸ª (0, 0) (X, 0) (Y, 0) å½¢å¼çš„ç›´è§’ä¸‰è§’å½¢ï¼Œé‚£ä¹ˆ XY = 2S = 2nm / k = nm / (k / 2). ä»¤ d = gcd(n, k), x1 = n / d, y1 = 0, x2 = 0, y2  = m / (k / d), x3 = y3 = 0.</p><p>ä½†æ˜¯å› ä¸º k % 2 ä¸ä¸€å®š = 0, æ‰€ä»¥å¦‚æœ k % 2 = 0, k /= 2; å¦åˆ™ï¼Œå¦‚æœ x1 &lt;= n / 2, x1 = 2x1, å¦åˆ™ y2 = 2y2.</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, m, k;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a, ll b)</span> </span>&#123; <span class="keyword">return</span> !b ? a : gcd(b, a % b); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>, &amp;n, &amp;m, &amp;k);</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">2</span> * n * m % k != <span class="number">0</span>) &#123; <span class="built_in">puts</span>(<span class="string">"NO"</span>); <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"YES"</span>);</span><br><span class="line">    <span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (k % <span class="number">2</span> == <span class="number">0</span>) k /= <span class="number">2</span>, flag = <span class="literal">true</span>;</span><br><span class="line">    ll d = gcd(n, k), x, y, x2, y2, x3, y3;</span><br><span class="line">    x = n / d, y = <span class="number">0</span>, x2 = <span class="number">0</span>, y2 = m / (k / d), x3 = y3 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt;= n / <span class="number">2</span>) x *= <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">else</span> y2 *= <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld %lld\n%lld %lld\n%lld %lld\n"</span>, x, y, x2, y2, x3, y3);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 511 Div2</title>
      <link href="2018/09/24/Codeforces%20Round%20511%20Div2/"/>
      <url>2018/09/24/Codeforces%20Round%20511%20Div2/</url>
      
        <content type="html"><![CDATA[<p><a href="https://codeforces.com/contest/1047" target="_blank" rel="noopener">æ¯”èµ›é“¾æ¥</a></p><p>emmmmï¼Œè¿™æ¬¡åšäº†ä¸¤é“ï¼Œä½†ç”±äºæ‰‹é€Ÿè„‘é€Ÿä¸å¤Ÿä»¥åŠ WA äº†å‡ å‘ï¼ŒæˆåŠŸå‡‰å‡‰ï¼Œï¼Œï¼Œï¼Œ</p><p>æ„Ÿè§‰å¾ˆæ´»ï¼ï¼è¦å¤šæ‰“ï¼ï¼</p><h3 id="A-Little-C-Loves-3-I"><a href="#A-Little-C-Loves-3-I" class="headerlink" title="A. Little C Loves 3 I"></a>A. Little C Loves 3 I</h3><hr><p>å•Šï¼Œæœ‰ä¸ªå¾ˆæ¸…æ¥šçš„åšæ³•ï¼ša = b = c = n / 3ï¼ˆä¸‹å–æ•´ï¼‰ï¼Œå¦‚æœ b % 3 == 0 æˆ– c % 3 == 0, a++, b/c â€“.</p><p>è¿™æ ·å°±å…ˆä¿è¯äº† b å’Œ c ä¸æ˜¯ 3 çš„å€æ•°ï¼Œç„¶åå†å¤„ç† aï¼Œåˆ¤æ–­ b å’Œ c % 3 = 1 è¿˜æ˜¯ 2 å°±è¡Œäº†ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, a[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    a[<span class="number">0</span>] = a[<span class="number">1</span>] = a[<span class="number">2</span>] = n / <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">int</span> sum = n - (n / <span class="number">3</span>) * <span class="number">3</span>;</span><br><span class="line">    a[<span class="number">0</span>] += sum;</span><br><span class="line">    <span class="keyword">if</span> (a[<span class="number">1</span>] % <span class="number">3</span> == <span class="number">0</span>) a[<span class="number">1</span>]--, a[<span class="number">0</span>]++;</span><br><span class="line">    <span class="keyword">if</span> (a[<span class="number">2</span>] % <span class="number">3</span> == <span class="number">0</span>) a[<span class="number">2</span>]--, a[<span class="number">0</span>]++;</span><br><span class="line">    <span class="keyword">if</span> (a[<span class="number">0</span>] % <span class="number">3</span> == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[<span class="number">1</span>] % <span class="number">3</span> == <span class="number">1</span>) a[<span class="number">1</span>]++, a[<span class="number">0</span>]--;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (a[<span class="number">2</span>] % <span class="number">3</span> == <span class="number">1</span>) a[<span class="number">2</span>]++, a[<span class="number">0</span>]--;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (a[<span class="number">1</span>] % <span class="number">3</span> == <span class="number">2</span>) a[<span class="number">1</span>]--, a[<span class="number">0</span>]++;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (a[<span class="number">2</span>] % <span class="number">3</span> == <span class="number">2</span>) a[<span class="number">2</span>]--, a[<span class="number">0</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d %d %d\n"</span>, a[<span class="number">0</span>], a[<span class="number">1</span>], a[<span class="number">2</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-Cover-Points"><a href="#B-Cover-Points" class="headerlink" title="B. Cover Points"></a>B. Cover Points</h3><hr><p>å¯ä»¥å‘ç°ï¼Œç­”æ¡ˆå°±æ˜¯ $max_{1 \leq i \leq n}{x_i + y_i}$.</p><h3 id="C-Enlarge-GCD"><a href="#C-Enlarge-GCD" class="headerlink" title="C. Enlarge GCD"></a>C. Enlarge GCD</h3><hr><p>è¦çœ‹æ¸…é¢˜ç›®è¦æ±‚ï¼Œåªè¦æ¯”æ•´ä½“gcdå¤§å°±è¡Œäº†ã€‚</p><p>è®¾æ•´ä½“gcdä¸º Gã€‚å¯¹äºæ¯ä¸ª &gt; G çš„è´¨æ•° xï¼Œè®° cnt ä¸º ai ä¸­ % x = 0 çš„æ•°çš„ä¸ªæ•°ï¼Œans å¯¹ n - cnt å– minã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1.5e7</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, a[N], G, x;</span><br><span class="line"><span class="keyword">bool</span> pri[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !b ? a : gcd(b, a % b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">        a[x]++;</span><br><span class="line">        <span class="keyword">if</span> (!G) G = x;</span><br><span class="line">        <span class="keyword">else</span> G = gcd(G, x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> ans = n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = G + <span class="number">1</span>; i &lt; N; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!pri[i]) &#123;</span><br><span class="line">            <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; N; j += i)</span><br><span class="line">                pri[j] = <span class="number">1</span>, cnt += a[j];</span><br><span class="line">            ans = min(ans, n - cnt);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ans &lt; n) <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D-Little-C-Loves-3-II"><a href="#D-Little-C-Loves-3-II" class="headerlink" title="D. Little C Loves 3 II"></a>D. Little C Loves 3 II</h3><hr><p>é¦–å…ˆï¼Œ$1 * 6$, $2 * 4$, $2 * 5$, $3 * 4$ éƒ½æ˜¯èƒ½è¢«æ„é€ å‡ºæ¥çš„ã€‚</p><p>å¦‚æœ n = 1ï¼Œ é‚£ä¹ˆç­”æ¡ˆå°±æ˜¯ $6 * \lfloor \frac{m}{6} \rfloor + 2 * max((m\ mod\ 6) - 3, 0)$.</p><p>å¦‚æœ n = 2ï¼Œåªæœ‰ $2 * 2$ï¼Œ$2 * 3$ å’Œ $2 * 7$ ä¸èƒ½è¢«æ„é€ ï¼Œå…¶ä»–çš„éƒ½å¯ä»¥ç”¨ $1 * 6$ï¼Œ$2 * 4$ å’Œ $2 * 5$ æ„é€ å‡ºæ¥ã€‚</p><p>å¦åˆ™ï¼Œ$4 * x$ å¯ä»¥ç”¨ $2 * 4$ å’Œ $3 * 4$ æ„é€ ï¼Œ$6 * x$ å¯ä»¥ç”¨ $1 * 6$ æ„é€ ã€‚$x * y$ å¯ä»¥ç”¨ $4 * x$ å’Œ $6 * y$ æ„é€ ï¼Œå…¶ä¸­ y æ˜¯å¶æ•°ä¸” xã€y &gt; 2.</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœ $n * m\ mod\ 2 = 0$, é‚£ä¹ˆç­”æ¡ˆå°±æ˜¯ $n * m$. å¦åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€äº› $x * y$ çš„çŸ©é˜µï¼ˆå…¶ä¸­ x æˆ– y æ˜¯å¶æ•°ï¼‰å°† $n * m$ çš„çŸ©é˜µå˜ä¸ºå¦‚ä¸‹ä¸‰ä¸ªä¹‹ä¸€ï¼š $3 * 3$, $3 * 5$, $5 * 5$ã€‚è€Œè¿™ä¸‰ä¸ªéƒ½æ˜¯æœ‰ä¸€ä¸ªç©ºçš„ã€‚å³ç­”æ¡ˆä¸º $n * m - 1$.</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, m, ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">if</span> (n &gt; m) swap(n, m);</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, (m / <span class="number">6</span> * <span class="number">3</span> + max(m % <span class="number">6</span> - <span class="number">3</span>, <span class="number">0</span>)) &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (n == <span class="number">2</span>) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, m == <span class="number">2</span> ? <span class="number">0</span> : m == <span class="number">3</span> ? <span class="number">4</span> : m == <span class="number">7</span> ? <span class="number">12</span> : m &lt;&lt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, <span class="number">1l</span>l * n * m / <span class="number">2</span> * <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Atcoder Regular Contest 102</title>
      <link href="2018/09/09/Atcoder%20Regular%20Contest%20102/"/>
      <url>2018/09/09/Atcoder%20Regular%20Contest%20102/</url>
      
        <content type="html"><![CDATA[<p><a href="https://arc102.contest.atcoder.jp/assignments" target="_blank" rel="noopener">æ¯”èµ›é“¾æ¥</a></p><h3 id="C-Triangular-Relationship"><a href="#C-Triangular-Relationship" class="headerlink" title="C. Triangular Relationship"></a>C. Triangular Relationship</h3><hr><p>å› ä¸ºåªæ˜¯ä¸¤ä¸ªæ•°ç›¸åŠ ï¼Œæ‰€ä»¥å¯ä»¥åˆ†æˆä¸¤ç§æƒ…å†µï¼š</p><ol><li>a å’Œ b éƒ½æ˜¯ k çš„å€æ•°ã€‚å³ï¼Œ!(a % k) &amp;&amp; !(b % k).</li><li>a å’Œ b ä¹‹å’Œæ˜¯ k çš„å€æ•°ã€‚å³ï¼Œ(a + b) % k = 0, </li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 502 Div2</title>
      <link href="2018/08/29/Codeforces%20Round%20502%20Div2/"/>
      <url>2018/08/29/Codeforces%20Round%20502%20Div2/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/1017" target="_blank" rel="noopener">æ¯”èµ›é“¾æ¥</a></p><h3 id="A-The-Rank"><a href="#A-The-Rank" class="headerlink" title="A. The Rank"></a>A. The Rank</h3><hr><p>æ°´é¢˜ï¼Œstruct æ’åºã€‚</p><h3 id="B-The-Bits"><a href="#B-The-Bits" class="headerlink" title="B. The Bits"></a>B. The Bits</h3><hr><p>é¢˜æ„ï¼šç»™ä¸¤ä¸ª01å­—ç¬¦ä¸² aã€bï¼Œåªèƒ½äº¤æ¢ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„ä¸¤ä¸ªå­—æ¯ï¼Œé—®æœ‰å¤šå°‘ç§äº¤æ¢æ–¹æ¡ˆä½¿å¾—äº¤æ¢å a | b ä¸åŒäºäº¤æ¢å‰çš„ a | b.</p><p>åªéœ€è¦è€ƒè™‘è¿ç®—æˆ–çš„æ€§è´¨å°±å¥½äº†ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, a1, a0;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll ans;</span><br><span class="line"><span class="keyword">char</span> a[<span class="number">100005</span>], b[<span class="number">100005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s%s"</span>, a + <span class="number">1</span>, b + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[i] == <span class="string">'1'</span>) a1++;</span><br><span class="line">        <span class="keyword">if</span> (a[i] == <span class="string">'0'</span> &amp;&amp; b[i] == <span class="string">'1'</span>) a0++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[i] == <span class="string">'1'</span> &amp;&amp; b[i] == <span class="string">'0'</span>) ans += a0;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (a[i] == <span class="string">'0'</span> &amp;&amp; b[i] == <span class="string">'0'</span>) ans += a1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-The-Phone-Number"><a href="#C-The-Phone-Number" class="headerlink" title="C. The Phone Number"></a>C. The Phone Number</h3><hr><p>é¢˜æ„ï¼šç»™å®š nï¼Œè¦æ±‚æ„é€ ä¸€ä¸ªé•¿åº¦ä¸º n çš„åºåˆ—ä½¿å¾—è¿™ä¸ªåºåˆ—çš„ LIS + LDS é•¿åº¦æœ€å°ã€‚</p><p>åˆ†å—æ€æƒ³ï¼Œåˆ†æˆ k å—æ—¶ç­”æ¡ˆä¸º n / k + k, å› æ­¤ k å– sqrt(n) æœ€ä¼˜ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´å›¾å¤§è‡´å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">            <span class="number">1</span></span><br><span class="line">              <span class="number">1</span></span><br><span class="line">                <span class="number">1</span></span><br><span class="line">      <span class="number">1</span></span><br><span class="line">        <span class="number">1</span></span><br><span class="line">          <span class="number">1</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line">  <span class="number">1</span></span><br><span class="line">    <span class="number">1</span></span><br></pre></td></tr></table></figure><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a[<span class="number">100005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">int</span> S = (<span class="keyword">int</span>)<span class="built_in">sqrt</span>(n + <span class="number">0.5</span>);</span><br><span class="line">    <span class="keyword">int</span> ps = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (ps &lt;= n) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = min(ps + S - <span class="number">1</span>, n); j &gt;= ps; --j) a[++a[<span class="number">0</span>]] = j;</span><br><span class="line">        ps += S;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= a[<span class="number">0</span>]; ++i) <span class="built_in">printf</span>(<span class="string">"%d "</span>, a[i]); <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Atcoder Regular Contest 101</title>
      <link href="2018/08/26/Atcoder%20Regular%20Contest%20101/"/>
      <url>2018/08/26/Atcoder%20Regular%20Contest%20101/</url>
      
        <content type="html"><![CDATA[<p><a href="https://arc101.contest.atcoder.jp/assignments" target="_blank" rel="noopener">æ¯”èµ›é“¾æ¥</a></p><h3 id="C-Candles"><a href="#C-Candles" class="headerlink" title="C. Candles"></a>C. Candles</h3><hr><p>åˆ†ä¸‰ç§æƒ…å†µè®¨è®ºï¼š</p><ol><li><p>é€‰çš„ä½ç½®å…¨éƒ¨ &gt;= 0ã€‚</p></li><li><p>é€‰çš„ä½ç½®å…¨éƒ¨ &lt;= 0ã€‚</p></li><li><p>é€‰çš„ä½ç½®åŒ…å« &lt; 0 çš„å’Œ &gt; 0 çš„ã€‚</p></li></ol><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, k, a[<span class="number">100005</span>], flag;</span><br><span class="line">ll sum, ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;n, &amp;k);</span><br><span class="line">    a[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]);</span><br><span class="line">        <span class="keyword">if</span> (a[i] &gt;= <span class="number">0</span> &amp;&amp; a[i - <span class="number">1</span>] &lt; <span class="number">0</span>) flag = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!flag) flag = n + <span class="number">1</span>;</span><br><span class="line">    ans = <span class="number">1e18</span>;</span><br><span class="line">    <span class="keyword">if</span> (flag + k - <span class="number">1</span> &lt;= n) ans = min(ans, a[flag + k - <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span> (flag - k &gt; <span class="number">0</span>) ans = min(ans, -a[flag - k]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; flag; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> j = i + k - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (j &lt; flag || j &gt; n) <span class="keyword">continue</span>;</span><br><span class="line">        ans = min(ans, min(-a[i] - a[i] + a[j], a[j] * <span class="number">2</span> - a[i]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D-Median-of-Medians"><a href="#D-Median-of-Medians" class="headerlink" title="D. Median of Medians"></a>D. Median of Medians</h3><hr><p>æˆ‘æ„Ÿè§‰æˆ‘ç”¨äº†ä¸€ä¸ªå°æ—¶çš„æ€è€ƒè¯æ˜äº†è¿™é¢˜ä¸æ˜¯ä¸­ä½æ•°ã€‚ã€‚ã€‚ã€‚ï¼ˆå¥½åƒä¸­ä½æ•°æœ€ä½å¤æ‚åº¦ä¹Ÿè¦ $n^2$ å‘¢ï¼‰åªèƒ½åœ¨ä¸æ±‚è§£ m çš„æƒ…å†µä¸‹æ±‚å‡ºä¸­ä½æ•°äº†ã€‚</p><p>è§‚æ‘©äº†å¤§ç¥çš„è§£é¢˜æ€è·¯è§‰å¾—å¾ˆå¦™ï¼è½¬åŒ–éå¸¸è‡ªç„¶ï¼Œä½†æ˜¯ä¹Ÿå¾ˆéš¾æƒ³åˆ°ã€‚ã€‚ã€‚</p><p>é¦–å…ˆäºŒåˆ†æœ€åç­”æ¡ˆ xï¼ˆè¿™ä¸€æ­¥æƒ³åˆ°äº†ï¼ï½¡Ã¬ _ Ã­ï½¡ï¼‰</p><h3 id="é—®é¢˜è½¬åŒ–ä¸ºï¼šæœ‰å¤šå°‘ä¸ªåŒºé—´çš„ä¸­ä½æ•°å°äºç­‰äº-x"><a href="#é—®é¢˜è½¬åŒ–ä¸ºï¼šæœ‰å¤šå°‘ä¸ªåŒºé—´çš„ä¸­ä½æ•°å°äºç­‰äº-x" class="headerlink" title="é—®é¢˜è½¬åŒ–ä¸ºï¼šæœ‰å¤šå°‘ä¸ªåŒºé—´çš„ä¸­ä½æ•°å°äºç­‰äº x"></a><strong>é—®é¢˜è½¬åŒ–ä¸ºï¼šæœ‰å¤šå°‘ä¸ªåŒºé—´çš„ä¸­ä½æ•°å°äºç­‰äº x</strong></h3><p>å°†åŒºé—´ä¸­æ‰€æœ‰ &lt;= x çš„èµ‹ä¸º 1ï¼Œ&gt; x çš„èµ‹ä¸º -1. </p><h3 id="é—®é¢˜è½¬åŒ–ä¸ºï¼šæœ‰å¤šå°‘ä¸ªåŒºé—´è‡³å°‘æœ‰ï¼ˆåŒºé—´é•¿åº¦-2-1ï¼‰ä¸ª-1"><a href="#é—®é¢˜è½¬åŒ–ä¸ºï¼šæœ‰å¤šå°‘ä¸ªåŒºé—´è‡³å°‘æœ‰ï¼ˆåŒºé—´é•¿åº¦-2-1ï¼‰ä¸ª-1" class="headerlink" title="é—®é¢˜è½¬åŒ–ä¸ºï¼šæœ‰å¤šå°‘ä¸ªåŒºé—´è‡³å°‘æœ‰ï¼ˆåŒºé—´é•¿åº¦/2 + 1ï¼‰ä¸ª 1"></a><strong>é—®é¢˜è½¬åŒ–ä¸ºï¼šæœ‰å¤šå°‘ä¸ªåŒºé—´è‡³å°‘æœ‰ï¼ˆåŒºé—´é•¿åº¦/2 + 1ï¼‰ä¸ª 1</strong></h3><h3 id="ç­‰ä»·äºï¼šæœ‰å¤šå°‘ä¸ªåŒºé—´çš„å’Œæ˜¯æ­£æ•°"><a href="#ç­‰ä»·äºï¼šæœ‰å¤šå°‘ä¸ªåŒºé—´çš„å’Œæ˜¯æ­£æ•°" class="headerlink" title="ç­‰ä»·äºï¼šæœ‰å¤šå°‘ä¸ªåŒºé—´çš„å’Œæ˜¯æ­£æ•°"></a><strong>ç­‰ä»·äºï¼šæœ‰å¤šå°‘ä¸ªåŒºé—´çš„å’Œæ˜¯æ­£æ•°</strong></h3><p>å³ï¼Œå¯¹äº 1/-1 åºåˆ—æ±‚å‰ç¼€å’Œ sum[], è‹¥ sum[r] - sum[l - 1] &gt; 0ï¼Œåˆ™è¿™å°±æ˜¯ä¸€ä¸ªç¬¦åˆè¦æ±‚çš„åŒºé—´ã€‚</p><p>é‚£ä¹ˆå¯¹äºæ‰€æœ‰çš„ sum[x] &gt; sum[y], å¦‚æœå†æ»¡è¶³ x &gt; y, åˆ™ [y + 1, x] å°±æ˜¯ä¸€ä¸ªåˆæ³•åŒºé—´ã€‚æˆ‘ä»¬å¯ä»¥ç”¨æ ‘çŠ¶æ•°ç»„æ±‚é¡ºåºå¯¹çš„æ–¹æ³•è§£å†³æ­¤é¢˜ã€‚</p><p>è‹¥äºŒåˆ†åˆ¤å®šå‡½æ•° chk(x) çš„è¿”å›å€¼ä¸º trueï¼Œä»…å½“åŒºé—´å’Œä¸ºæ­£æ•°çš„åŒºé—´æ•°é‡ &gt; n * (n + 1) / 4. å› ä¸ºåŒºé—´æ€»æ•°å…±æœ‰ n * (n + 1) / 2 ä¸ªï¼Œï¼ˆä½ç½® 0 ä¹Ÿç®—è¿›å»ï¼‰ï¼Œè¿™äº›åŒºé—´ä¸­ä½æ•°ç»„æˆçš„åºåˆ—çš„ä¸­ä½æ•°å°±è¦å†é™¤ä»¥ 2.</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lowbit(x) ((x) &amp; (-(x)))</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>, inf = (<span class="keyword">int</span>)<span class="number">1e9</span>;</span><br><span class="line"><span class="keyword">int</span> n, a[N], sum[N * <span class="number">10</span>], C[N * <span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (; x &lt;= <span class="number">2</span> * N; x += lowbit(x)) C[x]++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (; x; x -= lowbit(x)) ret += C[x];</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chk</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">2</span> * N; i++) C[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) sum[i] = sum[i - <span class="number">1</span>] + (a[i] &lt;= x ? <span class="number">1</span> : <span class="number">-1</span>);</span><br><span class="line">    ll tot = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        tot += query(sum[i] + N - <span class="number">1</span>);</span><br><span class="line">        add(sum[i] + N);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> tot &gt; <span class="number">1l</span>l * n * (n + <span class="number">1</span>) / <span class="number">4</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">int</span> l = inf, r = -inf;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">        l = min(l, a[i]), r = max(r, a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (chk(mid)) r = mid;</span><br><span class="line">        <span class="keyword">else</span> l = mid + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, r);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="E-Ribbons-on-Tree"><a href="#E-Ribbons-on-Tree" class="headerlink" title="E. Ribbons on Tree"></a>E. Ribbons on Tree</h3><hr><p>è¿™é¢˜è¿˜æ˜¯å¾ˆæƒ³å¼„æ‡‚ã€‚ã€‚ã€‚ç„¶è€Œç›®å‰å®˜æ–¹é¢˜è§£æ—¥æ–‡ç‰ˆçœ‹ä¸æ‡‚ï¼Œç½‘ä¸Šé¢˜è§£æ‰¾ä¸åˆ°ã€‚ã€‚ã€‚æ‰“ç®—ç•™å‘å¾…å¡«äº†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 504 Div2</title>
      <link href="2018/08/23/Codeforces%20Round%20504%20Div2/"/>
      <url>2018/08/23/Codeforces%20Round%20504%20Div2/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/1023" target="_blank" rel="noopener">æ¯”èµ›é“¾æ¥</a></p><h3 id="A-Single-Wildcard-Pattern-Matching"><a href="#A-Single-Wildcard-Pattern-Matching" class="headerlink" title="A. Single Wildcard Pattern Matching"></a>A. Single Wildcard Pattern Matching</h3><hr><p>å•Šå•Šå•Šï¼Œè¿™é¢˜è¢« hack äº†å¾ˆç—›è‹¦ï¼Œé‡ç”³é¢˜æ„åå‘ç°æ˜Ÿå·éƒ¨åˆ†åªèƒ½ç”¨å°å†™è‹±æ–‡å­—æ¯ä»£æ›¿ã€‚é‡æ–°å†™äº†ä»£ç åˆäº¤ï¼Œäº¤äº†ä¸¤å‘ï¼Œè¿‡ä¸å»å°±å¼ƒç–—äº†ã€‚ç°åœ¨çœ‹æ¥ï¼Œæ˜¯æ²¡æœ‰åˆ¤æ–­éæ˜Ÿå·éƒ¨åˆ†æ˜¯å¦å®Œå…¨ç›¸åŒçš„åŸå› ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="built_in">string</span> s1, s2;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; s1 &gt;&gt; s2;</span><br><span class="line">    <span class="keyword">int</span> flag = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) <span class="keyword">if</span> (s1[i] == <span class="string">'*'</span>) &#123;</span><br><span class="line">        flag = i; <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag == <span class="number">-1</span> &amp;&amp; s1 == s2) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"YES"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (flag == <span class="number">-1</span> || m &lt; n - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"NO"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; flag; i++) <span class="keyword">if</span> (s1[i] != s2[i]) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"NO"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>, j = m - <span class="number">1</span>; i &gt; flag; i--, j--) <span class="keyword">if</span> (s1[i] != s2[j]) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"NO"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) <span class="keyword">if</span> (s2[i] &lt; <span class="string">'a'</span> || s2[i] &gt; <span class="string">'z'</span>) &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"NO"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"YES"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-Pair-of-Toys"><a href="#B-Pair-of-Toys" class="headerlink" title="B. Pair of Toys"></a>B. Pair of Toys</h3><hr><p>é¦–å…ˆæ•°æ®éå¸¸å¤§ï¼Œå¿…é¡» O(1). è‹¥æ‰€æœ‰æ–¹æ¡ˆéƒ½å°äº nï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯ (k - 1) / 2.</p><p>å¦åˆ™åœ¨æ­¤åŸºç¡€ä¸Šå†å‡å» min(k - n - 1, (k - 1) / 2)ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, k, ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;n, &amp;k);</span><br><span class="line">    ll tmp = (k - <span class="number">1</span>) / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; k) tmp -= min(k - n - <span class="number">1</span>, (k - <span class="number">1</span>) / <span class="number">2</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, tmp);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-Bracket-Subsequence"><a href="#C-Bracket-Subsequence" class="headerlink" title="C.Bracket Subsequence"></a>C.Bracket Subsequence</h3><hr><p>çœŸæ˜¯é“å‡é¢˜ã€‚ã€‚ã€‚ç›´æ¥åˆ å»å¤´ k / 2 ä¸ªå·¦æ‹¬å·å’Œå¤´ k / 2 ä¸ªå³æ‹¬å·å°±è¡Œäº†ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hashé¢˜ç›®é€‰è®²</title>
      <link href="2018/08/20/Hash%E9%A2%98%E7%9B%AE%E9%80%89%E8%AE%B2/"/>
      <url>2018/08/20/Hash%E9%A2%98%E7%9B%AE%E9%80%89%E8%AE%B2/</url>
      
        <content type="html"><![CDATA[<h3 id="POJ3349-Snowflake-Snow-Snowflakes"><a href="#POJ3349-Snowflake-Snow-Snowflakes" class="headerlink" title="[POJ3349]-Snowflake Snow Snowflakes"></a>[POJ3349]-Snowflake Snow Snowflakes</h3><hr><p>é¢˜æ„ï¼šç»™ä½  n ä¸ªé›ªèŠ±ï¼Œæ±‚è§£å…¶ä¸­æ˜¯å¦å­˜åœ¨ 2 ä¸ªé›ªèŠ±ä»ä»»æ„ä½ç½®é¡ºæ—¶é’ˆæˆ–é€†æ—¶é’ˆå½¢çŠ¶æ˜¯ç›¸åŒçš„ã€‚</p><p>å®šä¹‰ Hash å‡½æ•° $H(a_{i, 1}, a_{i, 2}, â€¦ a_{i, 6}) = (\sum_{j = 1}^6a_{i, j} + \prod_{j = 1}^6a_{i, j}\ mod\ P$, å…¶ä¸­ P æ˜¯ä¸€ä¸ªå¤§è´¨æ•°ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>, P = <span class="number">99991</span>;</span><br><span class="line"><span class="keyword">int</span> n, tot, snow[N][<span class="number">10</span>], head[N], next[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Hash</span><span class="params">(<span class="keyword">int</span> a[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>, mul = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">        sum = (sum + a[i]) % P;</span><br><span class="line">        mul = (ll)mul * a[i] % P;</span><br><span class="line">    &#125; <span class="keyword">return</span> (sum + mul) % P;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">equal</span><span class="params">(<span class="keyword">int</span> a[], <span class="keyword">int</span> b[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">6</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">bool</span> eq = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">6</span>; k++)</span><br><span class="line">                <span class="keyword">if</span> (a[(i + k) % <span class="number">6</span>] != b[(j + k) % <span class="number">6</span>]) eq = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (eq) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            eq = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">6</span>; k++)</span><br><span class="line">                <span class="keyword">if</span> (a[(i + k) % <span class="number">6</span>] != b[(j - k + <span class="number">6</span>) % <span class="number">6</span>]) eq = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (eq) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> a[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> val = Hash(a);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[val]; i; i = next[i]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (equal(snow[i], a)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ++tot;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">6</span>; i++) snow[tot][i] = a[i];</span><br><span class="line">    next[tot] = head[val];</span><br><span class="line">    head[val] = tot;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> a[<span class="number">10</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">6</span>; j++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[j]);</span><br><span class="line">        <span class="keyword">if</span> (insert(a)) &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"Twin snowflakes found."</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"No two snowflakes are alike."</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…”å­ä¸å…”å­"><a href="#å…”å­ä¸å…”å­" class="headerlink" title="å…”å­ä¸å…”å­"></a>å…”å­ä¸å…”å­</h3><hr><p>é¢˜æ„ï¼šæœ‰ 1 ä¸ªDNAåºåˆ—ï¼Œæ¯æ¬¡è¯¢é—®å…¶ä¸­çš„ä¸¤æ®µï¼Œæ±‚è¿™ä¸¤æ®µæ˜¯å¦ç›¸åŒã€‚</p><p>è£¸çš„å­—ç¬¦ä¸²Hashã€‚éœ€è¦äº†è§£çš„æ˜¯ï¼Œè‹¥å­—ç¬¦ä¸² S çš„ Hash å€¼æ˜¯ H(S), å­—ç¬¦ä¸² S + T çš„ Hash å€¼æ˜¯ H(S + T), é‚£ä¹ˆå­—ç¬¦ä¸² T çš„ Hash å€¼å°±æ˜¯ $H(T) = (H(S + T) - H(S) * P^{length(T)})\ mod\ M$, å…¶ä¸­ä¹˜ P å°±ç›¸å½“äº P è¿›åˆ¶ä¸‹çš„å·¦ç§»è¿ç®—ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> s[<span class="number">1000010</span>];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> f[<span class="number">1000010</span>], p[<span class="number">1000010</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, q;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;q);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">    p[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        f[i] = f[i - <span class="number">1</span>] * <span class="number">131</span> + (s[i] - <span class="string">'a'</span> + <span class="number">1</span>);</span><br><span class="line">        p[i] = p[i - <span class="number">1</span>] * <span class="number">131</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        <span class="keyword">int</span> l1, r1, l2, r2;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d%d"</span>, &amp;l1, &amp;r1, &amp;l2, &amp;r2);</span><br><span class="line">        <span class="keyword">if</span> (f[r1] - f[l1 - <span class="number">1</span>] * p[r1 - l1 + <span class="number">1</span>] == f[r2] - f[l2 - <span class="number">1</span>] * p[r2 - l2 + <span class="number">1</span>])</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">"Yes"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"No"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="POJ3974-Palindrome"><a href="#POJ3974-Palindrome" class="headerlink" title="[POJ3974]-Palindrome"></a>[POJ3974]-Palindrome</h3><hr><p>é¢˜æ„ï¼šå¯»æ‰¾ä¸€ä¸ªé•¿åº¦ä¸º N çš„å­—ç¬¦ä¸² S çš„æœ€é•¿å›æ–‡å­—ä¸²ã€‚</p><p>æœ€é•¿å›æ–‡å­—ä¸²åˆ†ä¸ºé•¿åº¦ä¸ºå¥‡æ•°çš„å’Œé•¿åº¦ä¸ºå¶æ•°çš„ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†æƒ…å†µè®¨è®ºï¼Œæ­£ç€å€’ç€åˆ†åˆ«å¤„ç†ä¸€é Hash å‰ç¼€å’Œã€‚å‡è®¾æœ€é•¿å›æ–‡å­—ä¸²çš„é•¿åº¦ä¸º lenï¼ŒäºŒåˆ†ä¸€åŠé•¿åº¦ã€‚æœ€åå– maxã€‚æ—¶é—´å¤æ‚åº¦ $O(N\ log\ N)$. æ®è¯´æœ‰ä¸ªå« Manacher çš„ç®—æ³•å¯ä»¥ $O(N)$.</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> P = <span class="number">131</span>, N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line">ull p[N], h1[N], h2[N];</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"><span class="keyword">int</span> len, Case;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chk</span><span class="params">(<span class="keyword">int</span> l1, <span class="keyword">int</span> r1, <span class="keyword">int</span> l2, <span class="keyword">int</span> r2)</span> </span>&#123;</span><br><span class="line">    ull val1 = h1[r1] - h1[l1 - <span class="number">1</span>] * p[r1 - l1 + <span class="number">1</span>];</span><br><span class="line">    ull val2 = h2[r2] - h2[l2 + <span class="number">1</span>] * p[l2 - r2 + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> val1 == val2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    p[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i++) p[i] = p[i - <span class="number">1</span>] * P;</span><br><span class="line">    <span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>) &amp;&amp; s[<span class="number">1</span>] != <span class="string">'E'</span>) &#123;</span><br><span class="line">        len = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">        h1[<span class="number">0</span>] = h2[len + <span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; i++) h1[i] = h1[i - <span class="number">1</span>] * P + (s[i] - <span class="string">'a'</span> + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &gt;= <span class="number">1</span>; i--) h2[i] = h2[i + <span class="number">1</span>] * P + (s[i] - <span class="string">'a'</span> + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">int</span> ans, l, r, maxn = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= len; i++) &#123;</span><br><span class="line">            l = <span class="number">1</span>, r = min(len - i, i - <span class="number">1</span>), ans = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">                <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (chk(i - mid, i - <span class="number">1</span>, i + mid, i + <span class="number">1</span>))</span><br><span class="line">                    l = mid + <span class="number">1</span>, ans = mid;</span><br><span class="line">                <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            maxn = max(maxn, <span class="number">2</span> * ans + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (s[i] != s[i + <span class="number">1</span>]) <span class="keyword">continue</span>;</span><br><span class="line">            l = <span class="number">1</span>, r = min(i - <span class="number">1</span>, len - (i + <span class="number">1</span>)), ans = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">                <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (chk(i - mid, i - <span class="number">1</span>, i + <span class="number">1</span> + mid, i + <span class="number">2</span>))</span><br><span class="line">                    ans = mid, l = mid + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">else</span> r = mid - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            maxn = max(maxn, <span class="number">2</span> * ans + <span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Case %d: %d\n"</span>, ++Case, maxn);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Hash </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¡å¸¸å°è®°</title>
      <link href="2018/08/20/%E5%8D%A1%E5%B8%B8%E5%B0%8F%E8%AE%B0/"/>
      <url>2018/08/20/%E5%8D%A1%E5%B8%B8%E5%B0%8F%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h3 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h3><hr><p>æœ‰ gcd çš„é¢„å¤„ç†ï¼Œ__gcd() å‡½æ•°æ˜¯ log çš„ã€‚</p><h3 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h3><hr><p>æœ‰å–æ¨¡çš„å¯ä»¥ä¼˜åŒ–ï¼Œå–æ¨¡æ˜¯ log çš„ã€‚</p><p>mod çº§åˆ«çš„æ•° xï¼ˆåŠ ã€å‡ï¼‰ï¼š if (x &gt; mod) x -= mod.</p><p>$mod^2$ çº§åˆ«çš„æ•° x (ä¹˜ã€é™¤) ï¼šconst ll mod2 = mod * mod * 1LL.   if (x &gt; mod2) x -= mod2.  å¾ªç¯ç»“æŸæ—¶ x %= mod.</p>]]></content>
      
      
      
        <tags>
            
            <tag> å…¶ä»– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 505 Div2</title>
      <link href="2018/08/20/Codeforces%20Round%20505%20Div2/"/>
      <url>2018/08/20/Codeforces%20Round%20505%20Div2/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/1025" target="_blank" rel="noopener">æ¯”èµ›é“¾æ¥</a></p><p>åœ¨æ¯”èµ›å‰ç¡äº†ä¸€ä¼šï¼Œæœç„¶ç²¾ç¥ä¸å°‘ï¼æ®è¯´è¿™æ˜¯åœºæ•°å­¦å¤§èµ›ï¼Ÿæ¯”è¾ƒè€ƒæ€ç»´ï¼Bé¢˜å·®ä¸€ç‚¹åšå‡ºæ¥å•¦ï¼specialiståçš„ç¬¬1åœºæ¯”èµ›ï¼</p><h3 id="A-Doggo-Recoloring"><a href="#A-Doggo-Recoloring" class="headerlink" title="A. Doggo Recoloring"></a>A. Doggo Recoloring</h3><hr><p>é¢˜æ„ï¼šæœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ŒåŒ…å«å°å†™è‹±æ–‡å­—æ¯ã€‚æ¯æ¬¡ä½ å¯ä»¥é€‰æ‹©ä¸€ç§ä¸ªæ•°å¤§äº1çš„å­—æ¯å°†å®ƒä»¬ç»Ÿç»Ÿå˜ä¸ºå¦ä¸€ç§å­—æ¯ï¼Œæ±‚èƒ½å¦ç»Ÿä¸€å­—ç¬¦ä¸²ã€‚</p><p>åªè¦æœ‰ä¸€ç§ä¸ªæ•°å¤§äº1çš„å­—æ¯å°±è¡Œäº†ï¼Œå¯ä»¥26ç§å­—æ¯ç»Ÿè®¡æ•°é‡åæ’åºåˆ¤æ–­ã€‚</p><h3 id="B-Weakened-Common-Divisor"><a href="#B-Weakened-Common-Divisor" class="headerlink" title="B. Weakened Common Divisor"></a>B. Weakened Common Divisor</h3><hr><p>é¢˜æ„ï¼šæœ‰ n å¯¹æ•°å­—ï¼Œè¦æ±‚æ±‚å‡ºä¸€ä¸ªWCDï¼Œè¦å¤§äº1ï¼Œè€Œä¸”æ¯å¯¹æ•°å­—é‡Œæœ‰è‡³å°‘ä¸€ä¸ªæ˜¯å®ƒçš„å€æ•°ã€‚</p><p>ä¸€å¼€å§‹æƒ³äº†ä¸€ä¸ªè´¨å› æ•°åˆ†è§£ï¼Œæ˜¯å°†æ¯å¯¹æ•°å­—éƒ½åˆ†è§£ä¸€ä¸‹ï¼ŒTæ‰äº†ã€‚åæ¥çŸ¥é“å¦‚æœæ ¹æ®ç¬¬ä¸€å¯¹æ•°å­—çš„è´¨å› æ•°åˆ†è§£åº”è¯¥ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p><p>ç¬¬äºŒæ¬¡æƒ³äº†<strong>æ¥è¿‘</strong>æ­£è§£çš„æ–¹æ³•ã€‚å°±æ˜¯æ±‚å‡ºæ¯é˜Ÿæ•°å­—lcmçš„gcdï¼Œç„¶åæ‰¾å‡ºè¿™ä¸ªgcdçš„æœ€å°è´¨å› å­ã€‚ä¸€æäº¤å°±å‘ç°é”™äº†ï¼Œè‡ªå·±éƒ½èƒ½é€ å‡ºæ•°æ®æ¥hackã€‚ã€‚ï¼ˆåæ¥æœç„¶è¢«hackå•¦ï¼‰â€”â€” gcdæ˜¯ $10^{18}$ çº§åˆ«çš„ï¼Œè´¨å› å­æœ€å¤§æ˜¯ $10^9$ çš„ï¼Œæ€ä¹ˆæ‰¾ï¼Ÿ</p><p>åæ¥å‘ç°è‡ªå·±å‚»äº†ã€‚ã€‚ã€‚gcdæ˜¯ $10^{18}$ çš„ï¼Œä½†æ¯å¯¹æ•°å­—æ˜¯ $10^9$ çš„å‘€ï¼Œè€Œé‚£ä¸ªæœ€å°è´¨å› å­å¿…å®šæ˜¯ç¬¬ä¸€å¯¹æ•°å­—å…¶ä¸­ä¹‹ä¸€çš„çº¦æ•°ï¼Œè€ƒè™‘ç¬¬ä¸€å¯¹æ•°å­—å°±å¥½äº†ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line">ll a[<span class="number">150010</span>], b[<span class="number">150010</span>], sum;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;a[<span class="number">1</span>], &amp;b[<span class="number">1</span>]);</span><br><span class="line">    sum = a[<span class="number">1</span>] / (__gcd(a[<span class="number">1</span>], b[<span class="number">1</span>])) * b[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;a[i], &amp;b[i]);</span><br><span class="line">        sum = __gcd(sum, a[i] / (__gcd(a[i], b[i])) * b[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (sum == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"-1\n"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= a[<span class="number">1</span>]; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!ans &amp;&amp; sum % i == <span class="number">0</span>) &#123;</span><br><span class="line">            ans = i; <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (a[<span class="number">1</span>] % i == <span class="number">0</span>) a[<span class="number">1</span>] /= i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!ans &amp;&amp; a[<span class="number">1</span>] &gt; <span class="number">1</span> &amp;&amp; sum % a[<span class="number">1</span>] == <span class="number">0</span>) ans = a[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i * i &lt;= b[<span class="number">1</span>]; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!ans &amp;&amp; sum % i == <span class="number">0</span>) &#123;</span><br><span class="line">            ans = i; <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (b[<span class="number">1</span>] % i == <span class="number">0</span>) b[<span class="number">1</span>] /= i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!ans &amp;&amp; b[<span class="number">1</span>] &gt; <span class="number">1</span> &amp;&amp; sum % b[<span class="number">1</span>] == <span class="number">0</span>) ans = b[<span class="number">1</span>];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-Plasticine-zebra"><a href="#C-Plasticine-zebra" class="headerlink" title="C. Plasticine zebra"></a>C. Plasticine zebra</h3><hr><p>é¢˜æ„ï¼šæœ‰ä¸€ä¸ªç”± â€˜bâ€™ â€˜wâ€™ ä¸¤ç§å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œæ¯æ¬¡ä½ å¯ä»¥é€‰æ‹©ä¸€ä¸ªä½ç½® xï¼Œç¿»è½¬ 1 ~ x å’Œ x + 1 ~ n, æ±‚èƒ½è¾¾åˆ°çš„æœ€é•¿äº¤é”™å­—ä¸²ï¼ˆå³ä¸€ä¸ª b ä¸€ä¸ª wï¼‰é•¿åº¦ã€‚</p><p>ä¸€ä¸ªé•¿åº¦ä¸º 8 çš„å­—ç¬¦ä¸²ï¼Œä½ç½®åˆ†åˆ«ä¸º 12345678ï¼Œå¯ä»¥å‘ç°å¦‚æœåœ¨ç¬¬ 4 ä¸ªä½ç½®ç¿»è½¬ï¼Œå˜æˆäº† 43218765ï¼Œåœ¨ç¬¬ 5 ä¸ªä½ç½®ç¿»è½¬å˜æˆäº† 81234567ï¼Œæœ‰æ²¡æœ‰å‘ç°ï¼Œè¿™æ˜¯ä¸€ä¸ª 12345678 çš„å˜å½¢ï¼Œå³æŠŠ 8 ç§»åˆ°é¦–ä½ï¼Ÿ</p><p>åŒæ ·ç¬¬ä¸€æ¬¡ç¿»è½¬æ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å°† 43218765 å€’è¿‡æ¥ï¼Œçœ‹ä½œ 56781234ï¼Œ åˆæ˜¯ 12345678 çš„å˜å½¢ã€‚</p><p>è¿™æ ·æˆ‘ä»¬å¯ä»¥å°†å­—ç¬¦ä¸²å¤åˆ¶ä¸€ä»½æ¥åœ¨æœ«å°¾ï¼Œç„¶åå¯»æ‰¾æœ€é•¿äº¤é”™å­—ä¸²ã€‚ä¸è¦å¿˜è®°ä¸ n å– maxã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> s[<span class="number">200010</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> n = <span class="built_in">strlen</span>(s + <span class="number">1</span>), tmp = <span class="number">0</span>, ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) s[i + n] = s[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">2</span> * n - <span class="number">1</span>; i++)</span><br><span class="line">        <span class="keyword">if</span> (s[i] != s[i + <span class="number">1</span>]) tmp++;</span><br><span class="line">        <span class="keyword">else</span> ans = max(ans, tmp), tmp = <span class="number">1</span>;</span><br><span class="line">    ans = max(ans, tmp);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, min(ans, n));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D-Recovering-BST"><a href="#D-Recovering-BST" class="headerlink" title="D. Recovering BST"></a>D. Recovering BST</h3><hr><p>é¢˜æ„ï¼šæ±‚ç”¨ç»™å®šçš„æ•°å­—ï¼Œèƒ½å¦åšæˆä¸€æ£µâ€œæœ‰è¾¹ç›¸é‚»çš„ä¸¤ä¸ªèŠ‚ç‚¹éƒ½ä¸äº’è´¨â€çš„äºŒå‰æœç´¢æ ‘ã€‚</p><p>å¯ä»¥å‘ç°ï¼Œè‹¥ i å·æ˜¯æ ¹ï¼Œæ ¹çš„å·¦å­æ ‘å°±æ˜¯ 1 ~ i - 1 å·ï¼Œå³å­æ ‘å°±æ˜¯ i + 1 ~ n å·ã€‚æ‰€ä»¥è¯´ï¼ŒäºŒå‰æœç´¢æ ‘ä¸­çš„å­æ ‘æ˜¯å¯ä»¥å’ŒåŒºé—´åˆ’ä¸Šç­‰å·çš„ã€‚</p><p>æˆ‘ä»¬è®¾ f[l, r, 0] è¡¨ç¤º l ~ r è¿™ä¸ªåŒºé—´æ˜¯ l - 1 å·çš„å³å­æ ‘ï¼Œf[l, r, 1] è¡¨ç¤º l ~ r è¿™ä¸ªåŒºé—´æ˜¯ r + 1 å·çš„å·¦å­æ ‘ã€‚f[l, r, 0/1] çš„å–å€¼ä¸º 0 æˆ– 1ï¼Œåˆ†åˆ«è¡¨ç¤º ä¸å­˜åœ¨/å­˜åœ¨ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ç¬¬ä¸€æ¬¡Täº†ï¼Œä½† n &lt;= 700, $n^3$ æ²¡é—®é¢˜çš„å•Šã€‚é‚£ä¹ˆå°±æ˜¯å¸¸æ•°å¤§äº†ï¼Œéœ€è¦å¡å¸¸ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œc++ algorithm åº“ä¸­çš„ __gcd() å‡½æ•°æ˜¯ log çš„ï¼Œ$n^3\ log\ n$ å¯èƒ½å¤ªå¤§äº†ï¼Œæˆ‘ä»¬å°†æ¯ä¸€å¯¹ç‚¹çš„gcdå…ˆé¢„å¤„ç†å‡ºæ¥ï¼Œ$n^2\ log\ n$ å°±å¯ä»¥è¿‡äº†ï¼Œç¾æ»‹æ»‹ï¼</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, a[<span class="number">710</span>], f[<span class="number">710</span>][<span class="number">710</span>][<span class="number">2</span>], g[<span class="number">710</span>][<span class="number">710</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    a[<span class="number">0</span>] = a[n + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n + <span class="number">1</span>; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt;= n + <span class="number">1</span>; j++)</span><br><span class="line">            g[i][j] = g[j][i] = (__gcd(a[i], a[j]) &gt; <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n + <span class="number">1</span>; i++) &#123;</span><br><span class="line">        f[i][i][<span class="number">0</span>] = g[i][i - <span class="number">1</span>];</span><br><span class="line">        f[i][i][<span class="number">1</span>] = g[i][i + <span class="number">1</span>];</span><br><span class="line">        f[i][i - <span class="number">1</span>][<span class="number">1</span>] = f[i + <span class="number">1</span>][i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> len = <span class="number">1</span>; len &lt;= n; len++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">1</span>; l &lt;= n - len + <span class="number">1</span>; l++) &#123;</span><br><span class="line">            <span class="keyword">int</span> r = l + len - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = l; k &lt;= r; k++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (g[k][l - <span class="number">1</span>] &amp;&amp; f[l][k - <span class="number">1</span>][<span class="number">1</span>] &amp;&amp; f[k + <span class="number">1</span>][r][<span class="number">0</span>])</span><br><span class="line">                    f[l][r][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (g[k][r + <span class="number">1</span>] &amp;&amp; f[l][k - <span class="number">1</span>][<span class="number">1</span>] &amp;&amp; f[k + <span class="number">1</span>][r][<span class="number">0</span>])</span><br><span class="line">                    f[l][r][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">if</span> (f[<span class="number">1</span>][i - <span class="number">1</span>][<span class="number">1</span>] &amp;&amp; f[i + <span class="number">1</span>][n][<span class="number">0</span>]) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"Yes\n"</span>); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"No\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2018â€œç™¾åº¦ä¹‹æ˜Ÿâ€ç¨‹åºè®¾è®¡å¤§èµ› - å¤èµ›</title>
      <link href="2018/08/19/2018%E2%80%9C%E7%99%BE%E5%BA%A6%E4%B9%8B%E6%98%9F%E2%80%9D%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%A4%A7%E8%B5%9B%20-%20%E5%A4%8D%E8%B5%9B/"/>
      <url>2018/08/19/2018%E2%80%9C%E7%99%BE%E5%BA%A6%E4%B9%8B%E6%98%9F%E2%80%9D%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%A4%A7%E8%B5%9B%20-%20%E5%A4%8D%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<p><a href="http://bestcoder.hdu.edu.cn/contests/contest_show.php?cid=827" target="_blank" rel="noopener">æ¯”èµ›é“¾æ¥</a></p><h3 id="A-æ²¡æœ‰å…„å¼Ÿçš„èˆä¼š"><a href="#A-æ²¡æœ‰å…„å¼Ÿçš„èˆä¼š" class="headerlink" title="A. æ²¡æœ‰å…„å¼Ÿçš„èˆä¼š"></a>A. æ²¡æœ‰å…„å¼Ÿçš„èˆä¼š</h3><hr><p>ä¸€çœ‹è¿™é¢˜ç›®å°±è®©æˆ‘æƒ³åˆ°â€˜cv-æ²¡æœ‰ä¸Šå¸çš„èˆä¼šâ€™ã€‚ã€‚ã€‚</p><p>çœ‹å®Œé¢˜ç›®ç¬¬ä¸€ååº”æ˜¯æ ‘å½¢DPå—ï¼Ÿ</p><p>å¥½åƒæ˜¯è´ªå¿ƒã€‚ã€‚ã€‚å…ˆä¸è€ƒè™‘å…„å¼ŸèŠ‚ç‚¹ï¼Œæœ€å°å€¼æ˜¯æ‰€æœ‰ç‚¹çš„å­èŠ‚ç‚¹ä¸­æœ€å°çš„ vi çš„å’Œï¼Œæœ€å¤§å€¼æ˜¯æ‰€æœ‰ç‚¹çš„å­èŠ‚ç‚¹ä¸­æœ€å¤§çš„ vi çš„å’Œã€‚ç„¶åæšä¸¾å…„å¼ŸèŠ‚ç‚¹ï¼Œè®¡ç®—å¹¶è¾“å‡ºã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> ll inf = <span class="number">1e18</span>;</span><br><span class="line">ll T, n, a[<span class="number">100005</span>], fa[<span class="number">100005</span>], maxn, minn;</span><br><span class="line">ll Max[<span class="number">100005</span>][<span class="number">2</span>], Min[<span class="number">100005</span>][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;ll&gt; nxt[<span class="number">100005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;fa[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) nxt[i].clear();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]);</span><br><span class="line">            nxt[fa[i]].push_back(a[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            sort(nxt[i].begin(), nxt[i].end());</span><br><span class="line">        <span class="keyword">int</span> pos1 = <span class="number">0</span>, pos2 = <span class="number">0</span>;</span><br><span class="line">        maxn = -inf, minn = inf;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> size = (<span class="keyword">int</span>)nxt[i].size();</span><br><span class="line">            <span class="keyword">if</span> (size &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (maxn &lt; nxt[i][size - <span class="number">2</span>])</span><br><span class="line">                    maxn = nxt[i][size - <span class="number">2</span>], pos1 = i;</span><br><span class="line">                <span class="keyword">if</span> (minn &gt; nxt[i][<span class="number">1</span>])</span><br><span class="line">                    minn = nxt[i][<span class="number">1</span>], pos2 = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ll ans1 = <span class="number">0</span>, ans2 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> size = (<span class="keyword">int</span>)nxt[i].size();</span><br><span class="line">            <span class="keyword">if</span> (size &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                ans1 = max(ans1, ans1 + nxt[i][size - <span class="number">1</span>]);</span><br><span class="line">                ans2 = min(ans2, ans2 + nxt[i][<span class="number">0</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (pos1) &#123;</span><br><span class="line">            ans1 = max(ans1, ans1 + maxn);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (pos2) &#123;</span><br><span class="line">            ans2 = min(ans2, ans2 + minn);</span><br><span class="line">        &#125;</span><br><span class="line">        ans1 = max(ans1, ans1 + a[<span class="number">1</span>]);</span><br><span class="line">        ans2 = min(ans2, ans2 + a[<span class="number">1</span>]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld %lld\n"</span>, ans1, ans2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-åºåˆ—æœŸæœ›"><a href="#B-åºåˆ—æœŸæœ›" class="headerlink" title="B. åºåˆ—æœŸæœ›"></a>B. åºåˆ—æœŸæœ›</h3><hr><p>$(\prod_{l_i \le h \le r_i} \sum_{x_i = l_i}^{h} h - x_i) (\prod_{r_i &lt; h} \sum_{x_i = l_i}^{r_i} h - x_i)$</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2018 â€œç™¾åº¦ä¹‹æ˜Ÿâ€ç¨‹åºè®¾è®¡å¤§èµ› - åˆèµ›ï¼ˆBï¼‰</title>
      <link href="2018/08/13/2018%20%E2%80%9C%E7%99%BE%E5%BA%A6%E4%B9%8B%E6%98%9F%E2%80%9D%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%A4%A7%E8%B5%9B%20-%20%E5%88%9D%E8%B5%9B%EF%BC%88B%EF%BC%89/"/>
      <url>2018/08/13/2018%20%E2%80%9C%E7%99%BE%E5%BA%A6%E4%B9%8B%E6%98%9F%E2%80%9D%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%A4%A7%E8%B5%9B%20-%20%E5%88%9D%E8%B5%9B%EF%BC%88B%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p><a href="http://bestcoder.hdu.edu.cn/contests/contest_show.php?cid=826" target="_blank" rel="noopener">æ¯”èµ›é“¾æ¥</a></p><p>å› ä¸ºåˆèµ›Aæ²¡è¿‡ï¼Œæ‰€ä»¥ä¹Ÿæ¥ä½“éªŒäº†Bç»„ï¼Œæ„Ÿè§‰è¿˜è¦éš¾ä¸€äº›ï¼Œä¹Ÿæ›´å¦™ä¸€äº›ã€‚å¾ˆæœ‰æ”¶è·ï¼</p><h3 id="A-degree"><a href="#A-degree" class="headerlink" title="A. degree"></a>A. degree</h3><hr><p>é¦–å…ˆç¡®å®šæ˜¯æ£®æ—ï¼Œä¹Ÿå°±æ˜¯å¤šæ£µæ ‘ã€‚æˆ‘ä»¬æšä¸¾ä½œä¸ºç­”æ¡ˆçš„é‚£ä¸ªç‚¹ï¼Œé¦–å…ˆå¯ä»¥åœ¨åŸæ¥çš„åŸºç¡€ä¸Šå‘å‰©ä½™çš„è¿é€šå—å„è¿ä¸€æ¡ï¼ˆå³ n - 1 - mï¼Œå¯ä»¥è„‘è¡¥ä¸€ä¸‹ï¼Œå¦‚æœå°†å‰©ä½™çš„åŸæ¥æ˜¯è¿æ¥è¿é€šå—çš„è¾¹åŠ ä¸Šï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€æ£µ n - 1 æ¡è¾¹çš„æ ‘ï¼Œè€Œæ¯ä¸ªè¿é€šå—å¿…ç„¶åªæœ‰ä¸€æ¡è¾¹è¿å‡ºæ¥ï¼Œæ•… n - 1 - m æ˜¯å¯è¿çš„è¿é€šå—æ•°é‡ï¼‰ã€‚æœ€åå†åŠ ä¸Šåˆ«å¤„è¢«ç§»é™¤çš„è¾¹çš„æ•°é‡ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, k, a, b, T;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nxt[<span class="number">200005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;n, &amp;m, &amp;k);</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) nxt[i].clear();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;a, &amp;b);</span><br><span class="line">            nxt[a].push_back(b);</span><br><span class="line">            nxt[b].push_back(a);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = nxt[i].size();</span><br><span class="line">            ans = max(ans, x + (n - <span class="number">1</span>) - m + min(k, m - x));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-hex"><a href="#B-hex" class="headerlink" title="B. hex"></a>B. hex</h3><hr><p>æ‰›äº†æ‰›ï¼Œæ ·ä¾‹æœªè¿‡ï¼Œä¸äº†äº†ä¹‹ï¼Œç•™å‘å¾…å¡«ã€‚</p><h3 id="C-odds"><a href="#C-odds" class="headerlink" title="C. odds"></a>C. odds</h3><hr><p>æ²¡ä»”ç»†çœ‹è¿‡ï¼Œç•™å‘å¾…å¡«ã€‚</p><h3 id="D-p1m2"><a href="#D-p1m2" class="headerlink" title="D. p1m2"></a>D. p1m2</h3><hr><p>äºŒåˆ†ç­”æ¡ˆï¼ï¼</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll T, n, a[<span class="number">300005</span>], tmp[<span class="number">300005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">chk</span><span class="params">(ll limit)</span> </span>&#123;</span><br><span class="line">    ll t = <span class="number">0</span>, sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) tmp[i] = a[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (tmp[i] &lt; limit) &#123;</span><br><span class="line">            t += limit - tmp[i];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            sum += (tmp[i] - limit) / <span class="number">2</span>;  <span class="comment">// attention!!ä¸æ˜¯ sum += tmp[i] - limit.</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (sum &gt;= t) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;a[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        sort(a + <span class="number">1</span>, a + n + <span class="number">1</span>);</span><br><span class="line">        ll l = <span class="number">0</span>, r = (<span class="keyword">int</span>)<span class="number">1e8</span>, ans = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">            ll mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (chk(mid + <span class="number">1</span>))   <span class="comment">// ATTENTION!! WA 3 times for this mistake -- "mid + 1"</span></span><br><span class="line">                l = mid + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> r = mid;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, l);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="E-ratio"><a href="#E-ratio" class="headerlink" title="E. ratio"></a>E. ratio</h3><hr><p>å¹¶æ²¡æœ‰åšï¼Œç•™å‘å¾…å¡«ã€‚</p><h3 id="F-rect"><a href="#F-rect" class="headerlink" title="F. rect"></a>F. rect</h3><hr><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">----------------</span><br><span class="line">|\            /|</span><br><span class="line">| \     <span class="number">1</span>    / |</span><br><span class="line">|  \        /  |</span><br><span class="line">|   \      /   |</span><br><span class="line">|    \    /    |</span><br><span class="line">|     \  /     |</span><br><span class="line">|  <span class="number">2</span>   \/   <span class="number">3</span>  |</span><br><span class="line">|      /\      |</span><br><span class="line">|     /  \     |</span><br><span class="line">|    /    \    |</span><br><span class="line">|   /      \   |</span><br><span class="line">|  /    <span class="number">4</span>   \  |</span><br><span class="line">| /          \ |</span><br><span class="line">|/            \|</span><br><span class="line">---------------</span><br></pre></td></tr></table></figure><p>å¦‚å›¾ï¼Œä½äº 1 åŒºçš„çº¿æ®µç­”æ¡ˆæ˜¯ xï¼Œä½äº 2 åŒºçš„çº¿æ®µç­”æ¡ˆæ˜¯ yï¼Œä½äº 3 åŒºçš„çº¿æ®µç­”æ¡ˆæ˜¯ my - yï¼Œä½äº 4 åŒºçš„çº¿æ®µç­”æ¡ˆæ˜¯ mx - xï¼Œå¯ä»¥è¯æ˜ï¼Œç»å¯¹ä¸ä¼šç›¸äº¤ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll mx, my, n, T, x, y, ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>, &amp;mx, &amp;my, &amp;n);</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;x, &amp;y);</span><br><span class="line">            ans += min(x, min(y, min(mx - x, my - y)));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‰500å¯ä»¥è¿›å¤èµ›ã€‚åœ¨è¿˜æœ‰çº¦30åˆ†é’Ÿæ—¶æˆ‘æ˜¯448åå·¦å³ã€‚å½“æ—¶å¤§æ¦‚å¤§è„‘çŠ¯æŠ½ï¼Œä¸€ç›´åœ¨æƒ³â€œå•Šè¿˜æœ‰12åâ€ï¼Œç›´åˆ°æˆ‘å‘ç°äº†490è¿™ä¸ªæ•°å­—çš„å­˜åœ¨ã€‚ã€‚ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2018 â€œç™¾åº¦ä¹‹æ˜Ÿâ€ç¨‹åºè®¾è®¡å¤§èµ› - åˆèµ›ï¼ˆAï¼‰</title>
      <link href="2018/08/12/2018%20%E2%80%9C%E7%99%BE%E5%BA%A6%E4%B9%8B%E6%98%9F%E2%80%9D%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%A4%A7%E8%B5%9B%20-%20%E5%88%9D%E8%B5%9B%EF%BC%88A%EF%BC%89/"/>
      <url>2018/08/12/2018%20%E2%80%9C%E7%99%BE%E5%BA%A6%E4%B9%8B%E6%98%9F%E2%80%9D%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E5%A4%A7%E8%B5%9B%20-%20%E5%88%9D%E8%B5%9B%EF%BC%88A%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<p><a href="http://bestcoder.hdu.edu.cn/contests/contest_show.php?cid=825" target="_blank" rel="noopener">http://bestcoder.hdu.edu.cn/contests/contest_show.php?cid=825</a></p><p>ACä¸€é“ã€‚ã€‚ã€‚rank1959ã€‚ã€‚ã€‚åˆå‚åŠ äº†æœ‰è¶£çš„Båœºï¼Œè¿˜æ˜¯å¾ˆå€¼å¾—ä¸€è®°çš„ï¼</p><h3 id="A-åº¦åº¦ç†Šæ‹¼ä¸‰è§’"><a href="#A-åº¦åº¦ç†Šæ‹¼ä¸‰è§’" class="headerlink" title="A. åº¦åº¦ç†Šæ‹¼ä¸‰è§’"></a>A. åº¦åº¦ç†Šæ‹¼ä¸‰è§’</h3><hr><p>é¢˜æ„ç•¥ã€‚</p><p>ä¸‰è§’å½¢ï¼Œä¸¤è¾¹ä¹‹å’Œå¤§äºç¬¬ä¸‰è¾¹ï¼Œä¸¤è¾¹ä¹‹å·®å°äºç¬¬ä¸‰è¾¹ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬æŠŠè¾¹çš„é•¿åº¦æ’åºï¼Œæšä¸¾æœ€å°çš„ä¸¤æ¡è¾¹ l, r, æ‰¾åˆ°æœ€å¤§çš„ä¸€æ¡å°äºä¸¤è¾¹ä¹‹å’Œçš„è¾¹ã€‚ç”¨ two-pointers.</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, a[<span class="number">1005</span>], ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n)) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">        sort(a + <span class="number">1</span>, a + n + <span class="number">1</span>);</span><br><span class="line">        ans = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> r;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">2</span>; j &lt; n; j++) &#123;</span><br><span class="line">            r = j + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; j; i++) &#123;</span><br><span class="line">                <span class="keyword">while</span> (r &lt; n &amp;&amp; a[i] + a[j] &gt; a[r + <span class="number">1</span>]) ++r;</span><br><span class="line">                <span class="keyword">if</span> (a[i] + a[j] &gt; a[r])</span><br><span class="line">                    ans = max(ans, a[i] + a[j] + a[r]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-åº¦åº¦ç†Šå­¦é˜Ÿåˆ—"><a href="#B-åº¦åº¦ç†Šå­¦é˜Ÿåˆ—" class="headerlink" title="B. åº¦åº¦ç†Šå­¦é˜Ÿåˆ—"></a>B. åº¦åº¦ç†Šå­¦é˜Ÿåˆ—</h3><hr><p>é¢˜æ„ç•¥ã€‚</p><p>å¯ä»¥ç”¨STLä¸­çš„mapæ¨¡æ‹ŸåŒå‘é“¾è¡¨ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, Q, flag, u, v, w, val;</span><br><span class="line"></span><br><span class="line"><span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="built_in">deque</span>&lt;<span class="keyword">int</span>&gt; &gt;a;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> &amp;x)</span></span>&#123;</span><br><span class="line"><span class="keyword">char</span> ch = getchar();x = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (; ch &lt; <span class="string">'0'</span> || ch &gt; <span class="string">'9'</span>; ch = getchar());</span><br><span class="line"><span class="keyword">for</span> (; ch &gt;=<span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>; ch = getchar()) x = x * <span class="number">10</span> + ch - <span class="string">'0'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; Q) &#123;</span><br><span class="line">        a.clear();</span><br><span class="line">        <span class="keyword">while</span> (Q--) &#123;</span><br><span class="line">            read(flag);</span><br><span class="line">            <span class="keyword">if</span> (flag == <span class="number">1</span>) &#123;</span><br><span class="line">                read(u), read(w), read(val);</span><br><span class="line">                <span class="keyword">if</span> (w == <span class="number">0</span>) a[u].push_front(val);</span><br><span class="line">                <span class="keyword">else</span> a[u].push_back(val);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (flag == <span class="number">2</span>) &#123;</span><br><span class="line">                read(u), read(w);</span><br><span class="line">                <span class="keyword">if</span> (!a[u].empty()) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (w == <span class="number">0</span>) &#123;</span><br><span class="line">                        <span class="built_in">cout</span> &lt;&lt; a[u].front() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">                        a[u].pop_front();</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="built_in">cout</span> &lt;&lt; a[u].back() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">                        a[u].pop_back();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                read(u), read(v), read(w);</span><br><span class="line">                <span class="keyword">if</span> (w == <span class="number">0</span>) &#123;</span><br><span class="line">                    a[u].insert(a[u].end(), a[v].begin(), a[v].end());</span><br><span class="line">                    a[v].clear();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    a[u].insert(a[u].end(), a[v].rbegin(), a[v].rend());</span><br><span class="line">                    a[v].clear();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-åº¦åº¦ç†Šå‰ªçº¸æ¡"><a href="#C-åº¦åº¦ç†Šå‰ªçº¸æ¡" class="headerlink" title="C. åº¦åº¦ç†Šå‰ªçº¸æ¡"></a>C. åº¦åº¦ç†Šå‰ªçº¸æ¡</h3><hr><p>é¢˜æ„ç•¥ã€‚</p><p>å®˜æ–¹é¢˜è§£å¾ˆæœ‰é“ç†ï¼å¯¹äºæ¯ä¸€æ®µè¿ç»­çš„1ï¼Œå¦‚æœå·¦è¾¹å³è¾¹éƒ½æœ‰æ•°å­—ï¼Œé‚£å°±æ˜¯äºŒå…ƒç»„ [1, 1]ï¼Œå«ä¹‰æ˜¯å·¦è¾¹åˆ‡ä¸€åˆ€ã€å³è¾¹åˆ‡ä¸€åˆ€ï¼›å¦‚æœåªæœ‰å·¦è¾¹æœ‰æ•°å­—ï¼Œé‚£å°±æ˜¯ [1, 0], åä¹‹æ˜¯ [0, 1]ï¼Œ æˆ–è€…æ˜¯ [0, 0]ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬è¦åœ¨è¿™äº›é›†åˆé‡ŒæŒ‘é€‰ä¸€äº›æ®µï¼Œä½¿å¾—ä¸­æ‹¬å·é‡Œä»£ä»·å’Œä¸è¶…è¿‡ Kï¼Œæ’åºåä»å¤§åˆ°å°é€‰ï¼ŒO(N log N).</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> n, k, cnt, cnt1, ans, b[<span class="number">4</span>];</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span><span class="keyword">int</span> d, w;&#125;kk[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(node a, node b)</span> </span>&#123;<span class="keyword">return</span> a.d == b.d ? a.w &lt; b.w : a.d &gt; b.d;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> tmp)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++)</span><br><span class="line">        <span class="keyword">if</span> (k &gt;= kk[i].w) &#123;</span><br><span class="line">            tmp += kk[i].d, k -= kk[i].w;</span><br><span class="line">        &#125;</span><br><span class="line">    ans = max(ans, tmp);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;k)) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (k == <span class="number">0</span>) &#123;</span><br><span class="line">            ans = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (s[i] == <span class="string">'1'</span>) ans++;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">        cnt = cnt1 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[i] == <span class="string">'1'</span>) &#123;</span><br><span class="line">                num++;</span><br><span class="line">                <span class="keyword">if</span> (i == n) b[++cnt1] = num;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (num) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i - <span class="number">1</span> == num) b[++cnt1] = num;</span><br><span class="line">                <span class="keyword">else</span> kk[++cnt].d = num, kk[cnt].w = <span class="number">2</span>;</span><br><span class="line">                num = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        k++;</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        sort(kk + <span class="number">1</span>, kk + <span class="number">1</span> + cnt, cmp);</span><br><span class="line">        <span class="keyword">if</span> (cnt1 == <span class="number">2</span>) &#123;</span><br><span class="line">            work(k, <span class="number">0</span>), work(k - <span class="number">1</span>, b[<span class="number">1</span>]), work(k - <span class="number">1</span>, b[<span class="number">2</span>]), work(k - <span class="number">2</span>, b[<span class="number">1</span>] + b[<span class="number">2</span>]);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cnt1 == <span class="number">1</span>) &#123;</span><br><span class="line">            work(k, <span class="number">0</span>), work(k - <span class="number">1</span>, b[<span class="number">1</span>]);</span><br><span class="line">        &#125; <span class="keyword">else</span> work(k, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D-åº¦åº¦ç†Šçœ‹çƒèµ›"><a href="#D-åº¦åº¦ç†Šçœ‹çƒèµ›" class="headerlink" title="D. åº¦åº¦ç†Šçœ‹çƒèµ›"></a>D. åº¦åº¦ç†Šçœ‹çƒèµ›</h3><hr><p>é¢˜æ„ç•¥ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªä¼ªçš„æ¦‚ç‡ã€‚(2N)! æŒ‡çš„æ˜¯æƒ…å†µæ•°ï¼Œæ¯ç§æƒ…å†µå¯¹ansçš„è´¡çŒ®æ˜¯ $D^K$ï¼Œå…¶ä¸­ k è¡¨ç¤ºè¯¥æƒ…å†µä¸‹æœ‰ K å¯¹æƒ…ä¾£åº§ä½ç›¸é‚»ã€‚</p><p>è®¾ $F_{i, j}$ è¡¨ç¤ºå…±æœ‰ i å¯¹æƒ…ä¾£ï¼Œä¸”æ­£å¥½æœ‰ j å¯¹æ˜¯æŒ¨ç€åçš„ã€‚æ¯æ¬¡è€ƒè™‘æŠŠç¬¬ i + 1 å¯¹æ”¾è¿›å»ï¼š</p><p>(1). è¿™å¯¹æƒ…ä¾£åˆåœ¨ä¸€èµ·æ”¾ã€‚</p><p>â‘  æ‹†æ•£ä¸€å¯¹æƒ…ä¾£ï¼š$F_{i + 1, j} += F_{i, j} * j$</p><p>â‘¡ æ”¾åœ¨æƒ…ä¾£ä¹‹é—´çš„ç©ºéš™é—´ï¼š$F_{i + 1, j + 1} += F_{i, j} * (2 * i + 1 - j)$</p><p>(2). è¿™å¯¹æƒ…ä¾£åˆ†å¼€æ”¾ã€‚</p><p>â‘  ä»–ä»¬å„è‡ªæ‹†æ•£äº†ä¸€å¯¹æƒ…ä¾£ï¼š$F_{i + 1, j - 2} += F_{i, j} * (j * \frac{(j - 1)}{2})$</p><p>â‘¡ åªæœ‰ä¸€ä¸ªäººæ‹†æ•£äº†ä¸€å¯¹æƒ…ä¾£ï¼š$F_{i + 1, j - 1} += F_{i, j} * (2 * i + 1 - j)$</p><p>â‘¢ æ²¡æœ‰æƒ…ä¾£è¢«æ‹†æ•£ï¼š$F_{i + 1, j} += F_{i, j} * ((2 * i + 1 - j) * \frac{2 * i - j}{2})$</p><p>$O(N^2)$ é¢„å¤„ç†ã€‚å¯¹äºæ¯ä¸€ç»„è¯¢é—®ï¼Œæˆ‘ä»¬åªè¦ O(N) æ‰«ä¸€éè®¡ç®—ä¸€ä¸‹ç­”æ¡ˆå³å¯ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>, N = <span class="number">1010</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll f[N][N], n, d;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quick_pow</span><span class="params">(ll a, ll b)</span> </span>&#123;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ret = ret * a % mod;</span><br><span class="line">        a = a * a % mod;</span><br><span class="line">    &#125; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">C</span><span class="params">(ll a, ll b = <span class="number">2</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a * (a - <span class="number">1</span>) % mod * quick_pow(b, mod - <span class="number">2</span>) % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ycl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    f[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">1000</span>; i++) &#123;</span><br><span class="line">        f[i + <span class="number">1</span>][<span class="number">0</span>] = <span class="number">2</span> * f[i][<span class="number">0</span>] % mod * C(<span class="number">2</span> * i + <span class="number">1</span>, <span class="number">2</span>) % mod +</span><br><span class="line">                      <span class="number">2</span> * f[i][<span class="number">1</span>] % mod * <span class="number">2</span> * i % mod + </span><br><span class="line">                      <span class="number">2</span> * f[i][<span class="number">2</span>] % mod;</span><br><span class="line">        f[i + <span class="number">1</span>][<span class="number">0</span>] %= mod;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i + <span class="number">1</span>; j++) &#123;</span><br><span class="line">            f[i + <span class="number">1</span>][j] = <span class="number">2</span> * f[i][j - <span class="number">1</span>] % mod * (<span class="number">2</span> * i + <span class="number">1</span> - (j - <span class="number">1</span>)) % mod +</span><br><span class="line">                          <span class="number">2</span> * f[i][j] % mod * (j + C(<span class="number">2</span> * i + <span class="number">1</span> - j, <span class="number">2</span>)) % mod +</span><br><span class="line">                          <span class="number">2</span> * f[i][j + <span class="number">1</span>] % mod * ((j + <span class="number">1</span>) * (<span class="number">2</span> * i + <span class="number">1</span> - (j + <span class="number">1</span>)) % mod) % mod +</span><br><span class="line">                          <span class="number">2</span> * f[i][j + <span class="number">2</span>] % mod * C(j + <span class="number">2</span>, <span class="number">2</span>) % mod;</span><br><span class="line">            f[i + <span class="number">1</span>][j] %= mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ycl();</span><br><span class="line">    <span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>, &amp;n, &amp;d)) &#123;</span><br><span class="line">        ll ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, <span class="number">2</span> * d % mod);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            ans = (ans + f[n][i] * quick_pow(d, i) % mod) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 503 Div2</title>
      <link href="2018/08/12/Codeforces%20Round%20503%20Div2/"/>
      <url>2018/08/12/Codeforces%20Round%20503%20Div2/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/1020" target="_blank" rel="noopener">http://codeforces.com/contest/1020</a></p><h3 id="A-New-Building-for-SIS"><a href="#A-New-Building-for-SIS" class="headerlink" title="A. New Building for SIS"></a>A. New Building for SIS</h3><hr><p>é¢˜æ„ç•¥ã€‚</p><p>è¦æ³¨æ„åŒå¹¢æ¥¼çš„æƒ…å†µï¼</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, h, a, b, k, t1, t2, f1, f2;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld%lld%lld"</span>, &amp;n, &amp;h, &amp;a, &amp;b, &amp;k);</span><br><span class="line">    <span class="keyword">while</span> (k--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld%lld"</span>, &amp;t1, &amp;f1, &amp;t2, &amp;f2);</span><br><span class="line">        <span class="keyword">if</span> (f1 &gt; f2) swap(f1, f2);</span><br><span class="line">        <span class="keyword">if</span> (t1 &gt; t2) swap(t1, t2);</span><br><span class="line">        ll dis = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (t1 == t2) &#123;</span><br><span class="line">            dis += (f2 - f1);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (f1 &lt; a) dis += a - f1, f1 = a;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (f1 &gt; b) dis += f1 - b, f1 = b;</span><br><span class="line">            <span class="keyword">if</span> (f2 &lt; a) dis += a - f2, f2 = a;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (f2 &gt; b) dis += f2 - b, f2 = b;</span><br><span class="line">            dis += (f2 - f1) + (t2 - t1);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, dis);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-Badge"><a href="#B-Badge" class="headerlink" title="B. Badge"></a>B. Badge</h3><hr><p>é¢˜æ„ç•¥ã€‚</p><p>æ— è„‘ n^2 æ¨¡æ‹Ÿï¼ˆï¼Ÿï¼Ÿï¼‰</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, p[<span class="number">1005</span>], mark[<span class="number">1005</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;p[i]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(mark, <span class="number">0</span>, <span class="keyword">sizeof</span>(mark));</span><br><span class="line">        <span class="keyword">int</span> start = i;</span><br><span class="line">        mark[i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (!mark[p[start]]) &#123;</span><br><span class="line">            start = p[start], mark[start] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        start = p[start];</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, start);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-Elections"><a href="#C-Elections" class="headerlink" title="C. Elections"></a>C. Elections</h3><hr><p>é¢˜æ„ç•¥ã€‚</p><p>æ­¤é¢˜å¡äº†å¥½ä¹…ï¼åæ¥å¹²è„†å¼ƒç–—ã€‚ã€‚ã€‚</p><p>æˆ‘ä¸€ç›´åœ¨æƒ³æ˜¯ä¸æ˜¯è¦è®¾ä»€ä¹ˆæ€§ä»·æ¯”ï¼Œæˆ–è€…åº”è¯¥æŒ‘å½“å‰ç¥¨æœ€å¤šçš„å¯¹æ‰‹ï¼Œæ‹¿taä¸€å¼ ç¥¨ç›¸ç­‰äºä¸¤å¼ ä¹‹ç±»ï¼Œä½†ç”±äºå¾ˆå®¹æ˜“è¯æ˜æ˜¯é”™çš„ï¼Œä¹Ÿå°±ggäº†ã€‚ã€‚ã€‚</p><p>æ­£è§£åœ¨æ­¤ï¼šå¿…å®šå­˜åœ¨ä¸€ä¸ª xï¼Œä½¿å¾— 1 çš„ç¥¨æ•° &gt;= x, 2 ï½ m çš„ç¥¨æ•° &lt; x. 1 &lt;= x &lt;= 3000ï¼Œæšä¸¾å°±è¡Œã€‚n^2ã€‚</p><p>ä½¿æ‰€æœ‰ 2 ï½ m çš„æ•°é‡éƒ½é™è‡³ x ä»¥ä¸‹ï¼Œæœ€åè‹¥ 1 çš„ç¥¨æ•°è¿˜æ˜¯ä¸ &gt;= xï¼Œå°±æŒ‘å‰©ä¸‹æ¥æœ€å°çš„è¡¥ä¸Šã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, x, y) for (int i = x; i &lt;= y; i++)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> ll inf = <span class="number">1e16</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, c[<span class="number">3010</span>], b[<span class="number">3010</span>];</span><br><span class="line">ll ans, sum;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span><span class="keyword">int</span> p; ll c;&#125;a[<span class="number">3010</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node a, node b)</span> </span>&#123;<span class="keyword">return</span> a.c &gt; b.c;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    rep(i, <span class="number">1</span>, n) <span class="built_in">scanf</span>(<span class="string">"%d%lld"</span>, &amp;a[i].p, &amp;a[i].c);</span><br><span class="line">    sort(a + <span class="number">1</span>, a + n + <span class="number">1</span>, cmp);</span><br><span class="line">    ans = inf;</span><br><span class="line">    rep(i, <span class="number">1</span>, n) &#123;</span><br><span class="line">        rep(j, <span class="number">1</span>, m) c[j] = <span class="number">0</span>;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        rep(j, <span class="number">1</span>, n) b[j] = <span class="number">0</span>;</span><br><span class="line">        rep(j, <span class="number">1</span>, n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[j].p == <span class="number">1</span>) c[<span class="number">1</span>]++;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (c[a[j].p] + <span class="number">1</span> &gt;= i) sum += a[j].c, c[<span class="number">1</span>]++, b[j] = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">else</span> c[a[j].p]++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = n; j &gt;= <span class="number">1</span>; j--)</span><br><span class="line">            <span class="keyword">if</span> (a[j].p != <span class="number">1</span> &amp;&amp; b[j] == <span class="number">0</span> &amp;&amp; c[<span class="number">1</span>] &lt; i) b[j] = <span class="number">1</span>, sum += a[j].c, c[<span class="number">1</span>]++;</span><br><span class="line">        <span class="keyword">if</span> (c[<span class="number">1</span>] &gt;= i) ans = min(ans, sum);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D-The-hat"><a href="#D-The-hat" class="headerlink" title="D. The hat"></a>D. The hat</h3><hr><p>æ˜¯ä¸ªäº¤äº’é¢˜ï¼Ÿï¼Ÿå‘å…ˆç•™ç€</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[POJ1737]-Connected Graph</title>
      <link href="2018/08/10/%5BPOJ1737%5D-Connected%20Graph/"/>
      <url>2018/08/10/%5BPOJ1737%5D-Connected%20Graph/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vjudge.net/problem/POJ-1737" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>é¢˜æ„ï¼šæ±‚ $N$ ä¸ªèŠ‚ç‚¹çš„æ— å‘è¿é€šå›¾æœ‰å¤šå°‘ä¸ªï¼ŒèŠ‚ç‚¹æœ‰æ ‡å·ï¼Œä¸º $1$ ï½ $N$ï¼Œ$1 \leq N \leq 50$.</p><p>ï¼ˆè¯¶æˆ‘è®°å¾—æœ‰ä¸€å¹´çš„åˆèµ›é—®é¢˜æ±‚è§£ $T2$ æ˜¯è¿™ä¸ªï¼ï¼‰</p><p>å½“æ—¶é‚£é“åˆèµ›ï¼Œ4 ä¸ªç‚¹ï¼Œæˆ‘æ˜¯å…ˆç®—å‡ºäº† $C_6^3 + C_6^4 + C_6^5 + C_6^6$ï¼Œå†å‡å»ä¸‰ä¸ªç‚¹ä¹‹é—´æœ‰ä¸‰æ¡è¾¹ã€ä¸€ä¸ªç‚¹å­¤ç«‹çš„ä¸‰ç§æƒ…å†µï¼Œå…±æ˜¯38ï¼Œä¸é¢˜ä¾‹4ç›¸åŒã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ç±»ä¼¼å®¹æ–¥çš„æ–¹æ³•ï¼Œæ¥åšè¿™é¢˜ã€‚</p><p>$N$ ä¸ªç‚¹çš„æ— å‘å›¾æ€»æ•°æ˜¯ $2^{N * (N - 1) / 2}$ã€‚</p><p>æ¥ä¸‹æ¥è®¡ç®— $N$ ä¸ªç‚¹çš„ä¸è¿é€šæ— å‘å›¾çš„æ•°é‡ã€‚ä¸€ä¸ªä¸è¿é€šæ— å‘å›¾å¿…å®šç”±è‹¥å¹²è¿é€šå—ç»„æˆã€‚æ ¹æ® â€œæ ¹æ®å›´ç»•åŸºå‡†ç‚¹æ„é€ ä¸€ä¸ªæ•´ä½“â€ çš„æ€æƒ³ï¼Œæˆ‘ä»¬å¯ä»¥æšä¸¾æ ‡å·ä¸º $1$ çš„èŠ‚ç‚¹æ‰€åœ¨çš„è¿é€šå—åŒ…å«çš„èŠ‚ç‚¹ä¸ªæ•° $k$ï¼Œä» $2$ ~ $i$ è¿™ $i - 1$ ä¸ªèŠ‚ç‚¹ä¸­é€‰å‡º $k - 1$ ä¸ªèŠ‚ç‚¹æ„æˆä»»æ„æ— å‘å›¾ï¼Œæœ‰ $2 ^ {(i - k) * (i - k - 1) / 2}$ ç§æ–¹æ³•ã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œè®¾ $F[i]$ è¡¨ç¤º $i$ ä¸ªèŠ‚ç‚¹çš„æ— å‘è¿é€šå›¾ä¸ªæ•°ï¼š</p><p>$$F[i] = 2^{i * (i - 1) / 2} - \sum\limits_{j = 1}^{i - 1} F[j] * C_{i - 1}^{j - 1} * 2^{(i - j) * (i - j - 1) / 2}$$</p><p>å¯æ˜¯ï¼Œè¿™é¢˜éœ€è¦é«˜ç²¾åº¦ï¼Œæ‰€ä»¥ç›®å‰æˆ‘è¿˜æœªACï¼Œä»¥ä¸Šåªæ˜¯æ­¤é¢˜ä¸»è¦æ€è·¯ï¼</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line">ll f[<span class="number">60</span>], C[<span class="number">60</span>][<span class="number">60</span>], sum[<span class="number">60</span>];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;<span class="keyword">return</span> <span class="number">1l</span>l &lt;&lt; (x * (x - <span class="number">1</span>) / <span class="number">2</span>);&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    f[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    C[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">50</span>; i++) &#123;</span><br><span class="line">        C[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; j++) C[i][j] = C[i - <span class="number">1</span>][j] + C[i - <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= <span class="number">50</span>; i++) &#123;</span><br><span class="line">        sum[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; j++)</span><br><span class="line">            sum[i] += C[i - <span class="number">1</span>][j - <span class="number">1</span>] * f[j] * calc(i - j);</span><br><span class="line">        f[i] = calc(i) - sum[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) &amp;&amp; n) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, f[n]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰©å±•é¢˜ç›®ï¼š<a href="https://vjudge.net/problem/HDU-5729" target="_blank" rel="noopener">$HDU5729-Rigid\ Frameworks$</a></p><p>é¢˜æ„ï¼šå› ä¸ºçŸ©å½¢æ˜¯ä¸ç¨³å®šçš„ï¼Œä¼šå˜æˆå¹³è¡Œå››è¾¹å½¢ï¼Œä½†æ˜¯å¯ä»¥åœ¨çŸ©å½¢å¯¹è§’çº¿åŠ è¾¹ï¼Œé€šè¿‡æ„æˆä¸‰è§’å½¢ä½¿è¿™ä¸ªçŸ©å½¢ç¨³å®šä¸‹æ¥ã€‚ç»™ä¸€ $n * m$ çš„çŸ©å½¢ï¼Œå¯ä»¥åœ¨å•ä½çŸ©å½¢é‡ŒåŠ ä¸¤ç§å¯¹è§’çº¿ï¼ˆä»å·¦ä¸Šåˆ°å³ä¸‹ï¼Œä»å·¦ä¸‹åˆ°å³ä¸Šä¸¤ç§ï¼‰ï¼Œæˆ–è€…ä¸åŠ å¯¹è§’çº¿ï¼Œæˆ–è€…ä¸¤æ¡ã€‚é—®ä½¿è¿™ä¸ª $n * m$ çš„çŸ©å½¢ç¨³å®šä¸‹æ¥çš„æ–¹æ¡ˆæ•°ã€‚</p><p>åŸé—®é¢˜ç­‰ä»·äºæ±‚å·¦è¾¹æœ‰ $n$ ä¸ªç‚¹ï¼Œå³è¾¹æœ‰ $m$ ä¸ªç‚¹çš„è¿é€šçš„äºŒåˆ†å›¾çš„æ•°ç›®ï¼Œå¯ä»¥ç”¨ç±»ä¼¼è¿é€šå›¾è®¡æ•°çš„æ–¹æ³• dp å¾—åˆ°ã€‚</p><p>æ¯ä¸ªå•ä½çŸ©é˜µå¯ä»¥åŠ ä¸¤ç§å¯¹è§’çº¿ï¼ˆä»å·¦ä¸Šåˆ°å³ä¸‹ï¼Œä»å·¦ä¸‹åˆ°å³ä¸Šä¸¤ç§ï¼‰ï¼Œæˆ–è€…ä¸åŠ å¯¹è§’çº¿ï¼Œå…± $3$ ç§é€‰æ‹©ï¼Œåˆ™ä¸€ä¸ª $n * m$ çŸ©é˜µçš„æ€»æ–¹æ¡ˆæ•°æ˜¯ $3^{nm}$ã€‚</p><p>æˆ‘ä»¬è®¾ $f[i, j]$ è¡¨ç¤ºä½¿ $i * j$ çŸ©é˜µå›ºå®šä¸‹æ¥çš„åˆæ³•æ–¹æ¡ˆæ•°ã€‚</p><p>ä¸ POJ1737 ç±»ä¼¼ï¼Œè¯¥é¢˜è½¬ç§»æ–¹ç¨‹ä¸ºï¼š</p><p>$$f[n, m] = 3^{n * m} - C_{n - 1}^{i - 1} * C_m^j * f[i, j] * 3^{(n - i) * (m - j)}$$</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">40</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line">ll C[N][N], g[N * N], f[N][N], inv[N * N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    g[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">110</span>; i++) g[i] = g[i - <span class="number">1</span>] * <span class="number">3</span> % mod;</span><br><span class="line">    C[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i++) &#123;</span><br><span class="line">        C[i][<span class="number">0</span>] = C[i][i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; j++) C[i][j] = C[i - <span class="number">1</span>][j] + C[i - <span class="number">1</span>][j - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= <span class="number">10</span>; j++) &#123;</span><br><span class="line">            f[i][j] = g[i * j];</span><br><span class="line">            <span class="keyword">if</span> (i == <span class="number">1</span> &amp;&amp; j == <span class="number">0</span>) f[i][j] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> n = <span class="number">1</span>; n &lt;= i; n++)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> m = <span class="number">0</span>; m &lt;= j; m++) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (i == n &amp;&amp; j == m) <span class="keyword">continue</span>;</span><br><span class="line">                    f[i][j] -= C[i - <span class="number">1</span>][n - <span class="number">1</span>] * C[j][m] % mod * f[n][m] % mod * g[(i - n) * (j - m)] % mod;</span><br><span class="line">                    f[i][j] = (f[i][j] % mod + mod) % mod;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="keyword">while</span> (~<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m)) <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, f[n][m]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ’åˆ—ç»„åˆ </tag>
            
            <tag> è®¡æ•°DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[SPOJ-CMPLS]-Complete the Sequence!</title>
      <link href="2018/08/08/%5BSPOJ-CMPLS%5D-Complete%20the%20Sequence!/"/>
      <url>2018/08/08/%5BSPOJ-CMPLS%5D-Complete%20the%20Sequence!/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vjudge.net/problem/SPOJ-CMPLS" target="_blank" rel="noopener">https://vjudge.net/problem/SPOJ-CMPLS</a></p><p>é¢˜æ„ï¼šç»™å‡ºäº†ä¸€ä¸ªæ•°åˆ—çš„å‰ s é¡¹ï¼Œè¦æ±‚æ¨å‡ºåé¢çš„ c é¡¹ã€‚</p><p>å¾ˆåƒæ‰¾è§„å¾‹ï¼Œä¸è¦è¢«é‚£ä¸ª P(x) çš„å¼å­å”¬ä½äº†å“ˆã€‚ã€‚ã€‚</p><p>è¿™ä¸ªåŠæ³•å°±æ˜¯ï¼Œå·®åˆ†æ±‚å¤šé¡¹å¼å€¼ã€‚</p><p>ç»™å®š f(x) æ˜¯å…³äº x çš„ä¸€ä¸ªå¤šé¡¹å¼ï¼Œè®¾ f(x) çš„æ¬¡æ•°æ˜¯ nã€‚</p><p>åˆ™è§„å®š:</p><p>$a_x = f(x) - f(x - 1)$, ç§°ä¸ºä¸€é˜¶å·®åˆ†.</p><p>$b_x = a_x - a_{x - 1}$, ç§°ä¸ºäºŒé˜¶å·®åˆ†.</p><p>$c_x = b_x - b_{x - 1}$, ç§°ä¸ºä¸‰é˜¶å·®åˆ†.</p><p>ä»¥æ­¤ç±»æ¨ï¼Œç›´è‡³ n é˜¶å·®åˆ†ã€‚</p><p>æ ¹æ®ä»¥ä¸Šå®šä¹‰ï¼Œç»™å®š n + 1 ç»„åˆå§‹çš„ x å’Œ f(x) çš„æ˜ å°„ï¼Œå³å¯é€šè¿‡å·®åˆ†æ³•å¾—åˆ°å¾€åçš„æ‰€æœ‰å¤šé¡¹å¼å€¼ã€‚</p><p>ä¾‹ï¼š$f(x) = x^3 + x^2 + x + 1$.</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">x  <span class="title">f</span><span class="params">(x)</span>   ax   bx   cx</span></span><br><span class="line"><span class="function">0    1</span></span><br><span class="line"><span class="function">1    4    3</span></span><br><span class="line"><span class="function">2    15   11   8</span></span><br><span class="line"><span class="function">3    40   25   14   6</span></span><br><span class="line"><span class="function">4    85   45   20   6</span></span><br><span class="line">5   156   71   26   5   &lt;- f(x) = f(x - 1) + a_&#123;x - 1&#125; + b_&#123;x - 1&#125; + c_&#123;x - 1&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ï¼Œè¿™ä¸ªä¸‰æ¬¡çš„å¤šé¡¹å¼åœ¨ä¸‰é˜¶å·®åˆ†æ—¶ç›¸ç­‰ã€‚</p><p>å¦‚ä¸Šæ‰€è¿°ï¼Œè¿™æ˜¯ä¸ªæ¨¡æ¿é¢˜ã€‚æˆ‘ä»¬æ ¹æ®å‰ s é¡¹é€†æ¨å›å»ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">110</span>;</span><br><span class="line"><span class="keyword">int</span> T, S, C, X[N], f[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;S, &amp;C);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; S; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;f[<span class="number">0</span>][i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; S; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; S - i; j++)</span><br><span class="line">                f[i][j] = f[i - <span class="number">1</span>][j + <span class="number">1</span>] - f[i - <span class="number">1</span>][j];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= C; i++) f[S - <span class="number">1</span>][i] = f[S - <span class="number">1</span>][i - <span class="number">1</span>];  <span class="comment">// é€†æ¨è‡³æ­¤</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = S - <span class="number">2</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = S - i; j &lt; S - i + C; j++)</span><br><span class="line">                f[i][j] = f[i + <span class="number">1</span>][j - <span class="number">1</span>] + f[i][j - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = S; i &lt;= S + C - <span class="number">1</span>; i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, f[<span class="number">0</span>][i]);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å·®åˆ† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[IPSC2016C]-Counting Swaps</title>
      <link href="2018/08/07/%5BIPSC2016C%5D-Counting%20Swaps/"/>
      <url>2018/08/07/%5BIPSC2016C%5D-Counting%20Swaps/</url>
      
        <content type="html"><![CDATA[<p><a href="https://www.luogu.org/problemnew/show/P4778#sub" target="_blank" rel="noopener">https://www.luogu.org/problemnew/show/P4778#sub</a></p><p>é¢˜æ„ï¼šç»™å®šä¸€ä¸ª $1$ ~ $n$ çš„æ’åˆ— $p_1, p_2, â€¦ p_n$ï¼Œå¯è¿›è¡Œè‹¥å¹²æ¬¡æ“ä½œï¼Œæ¯æ¬¡é€‰æ‹©ä¸¤ä¸ªæ•´æ•° $x$ï¼Œ$y$ï¼Œäº¤æ¢ $p_x, p_y$ã€‚è®¾æŠŠ $p_1, p_2, â€¦ p_n$ å˜æˆå•è°ƒé€’å¢çš„æ’åˆ— $1$, $2$, â€¦ $n$ è‡³å°‘éœ€è¦ $m$ æ¬¡äº¤æ¢ï¼Œæ±‚æœ‰å¤šå°‘ç§æ“ä½œæ–¹æ³•å¯ä»¥åªç”¨ $m$ æ¬¡äº¤æ¢è¾¾åˆ°ä¸Šè¿°ç›®æ ‡ã€‚ç­”æ¡ˆå¯¹ $10^9 + 9$ å–æ¨¡ã€‚</p><p>å¯¹äºä¸€ä¸ªæ’åˆ—ï¼Œå¦‚æœä»æ¯ä¸ª $i$ åˆ° $p_i$ è¿ä¸€æ¡è¾¹ï¼Œé‚£ä¹ˆå¯ä»¥å¾—åˆ°ä¸€å¼  $n$ ä¸ªç‚¹ $n$ æ¡è¾¹çš„å›¾ï¼Œä¸”ç”±è‹¥å¹²ä¸ªç¯ç»„æˆã€‚</p><p>å¯ä»¥è¯æ˜ï¼ŒæŠŠä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„ç¯å˜æˆ $n$ ä¸ªè‡ªç¯ï¼Œè‡³å°‘éœ€è¦ $n - 1$ æ¬¡äº¤æ¢ã€‚</p><p>è¯æ˜ï¼š<br>é¦–å…ˆï¼ŒæŠŠä¸€ä¸ªé•¿åº¦ä¸º $2$ çš„ç¯å˜æˆ $2$ ä¸ªè‡ªç¯æ˜¾ç„¶éœ€è¦ä¸€æ¬¡ã€‚å‡è®¾ $\forall k \leq n - 1$ï¼ŒæŠŠé•¿åº¦ä¸è¶…è¿‡ $k$ çš„ç¯å˜æˆ $k$ ä¸ªè‡ªç¯æœ€å°‘éœ€è¦ $k - 1$ æ¬¡æ“ä½œã€‚å½“ $k = n$ æ—¶ï¼ŒæŠŠè¯¥ç¯æ‹†æˆé•¿åº¦ä¸º $j - i$ å’Œ $n - (j - i)$ çš„ä¸¤ä¸ªç¯($i &lt; j &lt; n$) ã€‚æŠŠäºŒè€…åˆ†åˆ«æ‹†æˆè‡ªç¯æ‰€éœ€çš„æœ€å°äº¤æ¢æ¬¡æ•°ä¸º $(j - i - 1) + (n - (j - i) - 1) = n - 2$ï¼Œå†åŠ ä¸Šç¬¬ä¸€æ¬¡çš„æ‹†å¼€ï¼Œå…±éœ€ $n - 1$. é€šè¿‡æ•°å­¦å½’çº³æ³•å¯çŸ¥ï¼ŒåŸå‘½é¢˜æˆç«‹ã€‚</p><p>è¯æ¯•ã€‚</p><p>è®¾ $F_n$ è¡¨ç¤ºç”¨æœ€å°‘çš„æ­¥æ•°æŠŠä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„ç¯å˜æˆ $n$ ä¸ªè‡ªç¯ï¼Œå…±æœ‰å¤šå°‘ç§æ“ä½œæ–¹æ³•ã€‚ç”±ä¸Šè¯æ˜å¯çŸ¥ï¼Œå¯ä»¥å°†é•¿åº¦ä¸º $n$ çš„ç¯æ‹†æˆé•¿åº¦ä¸º $x$ å’Œ $y$ çš„ä¸¤ä¸ªç¯ï¼Œå…¶ä¸­ $x + y = n$ã€‚è®¾ $T(x, y)$ è¡¨ç¤ºæœ‰å¤šå°‘ç§äº¤æ¢æ–¹æ³•å¯ä»¥æŠŠé•¿åº¦ä¸º $n$ çš„ç¯å˜æˆé•¿åº¦ä¸º $x$ å’Œ $y$ çš„ä¸¤ä¸ªç¯ï¼Œå®¹æ˜“å‘ç°ï¼Œ$T(x, y)$ åœ¨ $n$ æ˜¯å¶æ•°ä¸” $x = y$ æ—¶æ˜¯ $n / 2$, åœ¨ $n$ æ˜¯å¥‡æ•°æˆ– $x \neq y$ æ—¶ç­‰äº $n$ã€‚</p><p>ä¸¤è€…å˜ä¸ºè‡ªç¯çš„æ­¥æ•°ä¸º $x - 1$ å’Œ $y - 1$.</p><p>æ ¹æ®å¤šé‡é›†çš„æ’åˆ—æ•°ã€åŠ æ³•åŸç†å’Œä¹˜æ³•åŸç†ï¼š</p><p>$$F_n = \sum_{x + y = n} T(x, y) * F_x * F_y * \frac{(n - 2)!}{(x - 1)!(y - 1)!}$$</p><p>å¦‚æœæœ€åˆçš„æ’åˆ— $p_1, p_2, â€¦ p_n$ ç”±é•¿åº¦ä¸º $l_1, l_2, â€¦ l_k$ çš„ k ä¸ªç¯æ„æˆï¼Œå…¶ä¸­ $l_1 + l_2 + â€¦ + l_k = n$ï¼Œé‚£ä¹ˆæœ€ç»ˆçš„ç­”æ¡ˆå°±æ˜¯ï¼š</p><p>$$F_{l_1} * F_{l_2} * â€¦ * F_{l_k} * \frac{(n - k)!}{(l_1 - 1)!(l_2 - 1)! * â€¦ * (l_k - 1)!}$$</p><p>1e9 + 9 æ˜¯è´¨æ•°ï¼Œå¯ä»¥ç”¨ä¹˜æ³•é€†å…ƒå¤„ç†å…¬å¼ä¸­çš„é™¤æ³•ã€‚$O(n^2)$ã€‚</p><p>äº‹å®ä¸Šï¼Œæˆ‘ä»¬é€šè¿‡æ‰¾è§„å¾‹å¯ä»¥å‘ç°é€šé¡¹å…¬å¼ $F_n = n^{n - 2}$ï¼Œä»è€Œä¼˜åŒ–åˆ° $O(n\ log\ n)$ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, mod = <span class="number">1e9</span> + <span class="number">9</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> n, lnk[N], cnt, to[N &lt;&lt; <span class="number">1</span>], nxt[N &lt;&lt; <span class="number">1</span>], T, colo[N], d, F[N];</span><br><span class="line">ll Fac[N], ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    to[++cnt] = v, nxt[cnt] = lnk[u], lnk[u] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> color)</span> </span>&#123;</span><br><span class="line">    colo[x] = color;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (!colo[y]) dfs(y, color);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quick_pow</span><span class="params">(ll b, ll p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!b || p &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; p; p &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p &amp; <span class="number">1</span>) ret = ret * b % mod;</span><br><span class="line">        b = b * b % mod;</span><br><span class="line">    &#125; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    Fac[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">100000</span>; i ++) Fac[i] = Fac[i - <span class="number">1</span>] * i % mod;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(F, <span class="number">0</span>, <span class="keyword">sizeof</span>(F));</span><br><span class="line">        <span class="built_in">memset</span>(lnk, <span class="number">0</span>, <span class="keyword">sizeof</span>(lnk));</span><br><span class="line">        <span class="built_in">memset</span>(colo, <span class="number">0</span>, <span class="keyword">sizeof</span>(colo));</span><br><span class="line">        cnt = d = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> u;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; u;</span><br><span class="line">            add(i, u), add(u, i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            <span class="keyword">if</span> (!colo[i]) dfs(i, ++d);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) F[colo[i]]++;</span><br><span class="line">        ans = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= d; i++)</span><br><span class="line">            ans = ans * quick_pow(F[i], F[i] - <span class="number">2</span>) % mod;</span><br><span class="line">        ans = ans * Fac[n - d] % mod;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= d; i++)</span><br><span class="line">            ans = ans * quick_pow(Fac[F[i] - <span class="number">1</span>], mod - <span class="number">2</span>) % mod;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ’åˆ—ç»„åˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[BZOJ1013]-çƒå½¢ç©ºé—´äº§ç”Ÿå™¨</title>
      <link href="2018/08/07/%5BBZOJ1013%5D-%E7%90%83%E5%BD%A2%E7%A9%BA%E9%97%B4%E4%BA%A7%E7%94%9F%E5%99%A8/"/>
      <url>2018/08/07/%5BBZOJ1013%5D-%E7%90%83%E5%BD%A2%E7%A9%BA%E9%97%B4%E4%BA%A7%E7%94%9F%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vjudge.net/problem/HYSBZ-1013" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>é¢˜æ„ç•¥ã€‚</p><p>å¯¹äºæ¯ä¸ªç‚¹ï¼Œä»–ä»¬åˆ°çƒå¿ƒçš„è·ç¦»éƒ½æ˜¯ç›¸ç­‰çš„ã€‚</p><p>æ ¹æ®æ¬§å‡ é‡Œå¾—è·ç¦»ï¼Œæ­¤æ—¶åªéœ€æ±‚å‡ºä¸€ç‚¹ $(x_1, x_2, â€¦ x_n)$ï¼Œä½¿å¾—ï¼š</p><p>$$\sum\limits_{j = 1}^n (a_{i, j} - x_j) ^ 2 = C$$</p><p>å…¶ä¸­ $C$ ä¸ºå¸¸æ•°ã€‚è¯¥æ–¹ç¨‹ç»„æ˜¯ç”± $n + 1$ ä¸ª $n$ å…ƒäºŒæ¬¡æ–¹ç¨‹ç»„æˆçš„ï¼Œä¸æ˜¯çº¿æ€§æ–¹ç¨‹ç»„ï¼ˆçº¿æ€§æ–¹ç¨‹ç»„è¦æ±‚å‡ä¸ºä¸€æ¬¡ï¼‰ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ç›¸é‚»ä¸¤ä¸ªæ–¹ç¨‹ä½œå·®ï¼ŒæŠŠå®ƒå˜æˆ $n$ ä¸ª $n$ å…ƒä¸€æ¬¡æ–¹ç¨‹ï¼ŒåŒæ—¶æ¶ˆå»å¸¸æ•° $C$ï¼š</p><p>$$\sum\limits_{j = 1}^n (a_{i, j}^2 - a_{i + 1, j}^2 - 2x_j(a_{i, j} - a_{i + 1, j})) = 0\ \ \ \ (i = 1, 2, â€¦ , n)$$</p><p>æŠŠå˜é‡æ”¾åœ¨å·¦è¾¹ï¼Œå¸¸æ•°æ”¾åœ¨å³è¾¹ï¼š</p><p>$$\sum\limits_{j = 1}^n 2(a_{i, j} - a_{i + 1, j})x_j = \sum\limits_{j = 1}^n (a_{i, j}^2 - a_{i + 1, j}^2)\ \ \ \ (i = 1, 2, â€¦ , n)$$</p><p>è¿™å°±æ˜¯ä¸€ä¸ªçº¿æ€§æ–¹ç¨‹ç»„äº†ï¼Œé¢˜ç›®ä¿è¯æ–¹ç¨‹ç»„æœ‰å”¯ä¸€è§£ï¼Œæˆ‘ä»¬ç›´æ¥å¯¹ä¸‹é¢çš„å¢å¹¿çŸ©é˜µè¿›è¡Œé«˜æ–¯æ¶ˆå…ƒï¼Œå˜ä¸ºç®€åŒ–é˜¶æ¢¯å½¢çŸ©é˜µã€‚</p><p>$$<br>\begin{bmatrix}<br>2(a_{1, 1} - a_{2, 1}) &amp; 2(a_{1, 2} - a_{2, 2}) &amp; \cdots &amp; 2(a_{1, n} - a_{2, n}) &amp; \sum_{j = 1}^n(a_{1, j}^2 - a_{2, j}^2) \<br>2(a_{2, 1} - a_{3, 1}) &amp; 2(a_{2, 2} - a_{3, 2}) &amp; \cdots &amp; 2(a_{2, n} - a_{3, n}) &amp; \sum_{j = 1}^n(a_{2, j}^2 - a_{3, j}^2) \<br>\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \<br>2(a_{n, 1} - a_{n + 1, 1}) &amp; 2(a_{n, 2} - a_{n + 1, 2}) &amp; \cdots &amp; 2(a_{n, n} - a_{n + 1, n}) &amp; \sum_{j = 1}^n(a_{n, j}^2 - a_{n + 1, j}^2) \<br>\end{bmatrix}<br>$$</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> a[<span class="number">20</span>][<span class="number">20</span>], b[<span class="number">20</span>], c[<span class="number">20</span>][<span class="number">20</span>];</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n + <span class="number">1</span>; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;a[i][j]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">            c[i][j] = <span class="number">2</span> * (a[i][j] - a[i + <span class="number">1</span>][j]);</span><br><span class="line">            b[i] += a[i][j] * a[i][j] - a[i + <span class="number">1</span>][j] * a[i + <span class="number">1</span>][j];</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt;= n; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">fabs</span>(c[j][i]) &gt; <span class="number">1e-8</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= n; k++) swap(c[i][k], c[j][k]);</span><br><span class="line">                swap(b[i], b[j]);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i == j) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">double</span> rate = c[j][i] / c[i][i];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = i; k &lt;= n; k++) c[j][k] -= c[i][k] * rate;</span><br><span class="line">            b[j] -= b[i] * rate;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">"%.3lf "</span>, b[i] / c[i][i]);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é«˜æ–¯æ¶ˆå…ƒä¸æ€ä¹ˆå¥½å†™ï¼Œé‡ç‚¹æ˜¯æ€ä¹ˆæŠŠé¢˜æ„è½¬åŒ–ä¸ºå¼å­ï¼Œè¿˜æœ‰æ¨å¼å­çš„æ—¶å€™è¦å‹¤å¿«ï¼</p>]]></content>
      
      
      
        <tags>
            
            <tag> é«˜æ–¯æ¶ˆå…ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Atcoder Regular Contest 097</title>
      <link href="2018/08/04/Atcoder%20Regular%20Contest%20097/"/>
      <url>2018/08/04/Atcoder%20Regular%20Contest%20097/</url>
      
        <content type="html"><![CDATA[<h3 id="C-K-th-Substring"><a href="#C-K-th-Substring" class="headerlink" title="C. K-th Substring"></a>C. K-th Substring</h3><hr><p>æ•°æ®å¾ˆå°ï¼Œæš´åŠ›å³å¯ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5010</span>;</span><br><span class="line"><span class="built_in">string</span> str[N * <span class="number">6</span>];</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"><span class="keyword">int</span> n, k, cnt;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; s &gt;&gt; k;</span><br><span class="line">    n = <span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, T; i &lt; n; i++) &#123;</span><br><span class="line">        str[++cnt] = s[i];</span><br><span class="line">        T = min(k, n - i);  <span class="comment">// è¿™é‡Œå¾ˆé‡è¦ï¼æ²¡æœ‰å°±ä¼šTLEï¼</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; T; j++, cnt++) str[cnt + <span class="number">1</span>] = str[cnt] + s[i + j];</span><br><span class="line">    &#125;</span><br><span class="line">    sort(str + <span class="number">1</span>, str + cnt + <span class="number">1</span>);</span><br><span class="line">    unique(str + <span class="number">1</span>, str + cnt + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; str[k] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D-Equals"><a href="#D-Equals" class="headerlink" title="D. Equals"></a>D. Equals</h3><hr><p>ç”¨å¹¶æŸ¥é›†ç»´æŠ¤ï¼š$x_j$ å’Œ $y_j$ æ˜¯åœ¨åŒä¸€è¿é€šå—é‡Œçš„ã€‚</p><p>è‹¥ i å’Œ p[i] åœ¨åŒä¸€è¿é€šå—é‡Œï¼Œé‚£ä¹ˆ ans + 1ï¼Œå³åŒä¸€è¿é€šå—é‡Œçš„å…ƒç´ æ˜¯å¯ä»¥éšæ„è°ƒæ¢ä½ç½®çš„ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, p[N], fa[N], ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;<span class="keyword">return</span> fa[x] == x ? x : fa[x] = getfa(fa[x]);&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) fa[i] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">cin</span> &gt;&gt; p[i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> x, y;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y;</span><br><span class="line">        <span class="keyword">int</span> fx = getfa(x), fy = getfa(y);</span><br><span class="line">        <span class="keyword">if</span> (fx != fy) fa[fx] = fy;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">if</span> (getfa(i) == getfa(p[i])) ans++;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Atcoder Regular Contest 098</title>
      <link href="2018/08/04/Atcoder%20Regular%20Contest%20098/"/>
      <url>2018/08/04/Atcoder%20Regular%20Contest%20098/</url>
      
        <content type="html"><![CDATA[<h3 id="C-Attention"><a href="#C-Attention" class="headerlink" title="C. Attention"></a>C. Attention</h3><hr><p>å¾ˆç®€å•çš„å‰ç¼€å’Œï¼Œä¸è®²ï¼Œ</p><h3 id="D-Xor-Sum-2"><a href="#D-Xor-Sum-2" class="headerlink" title="D. Xor Sum 2"></a>D. Xor Sum 2</h3><hr><p>ç”±é¢˜æ„å¯ä»¥å¾—åˆ°ï¼Œæ ¹æ®xorçš„æ¶ˆå»å¾‹ï¼Œè¿ç»­å­åºåˆ—ï¼Œå¦‚æœ $a_i$ è¿™ä¸ªæ•°ä¸ç¬¦åˆï¼Œä¹‹åçš„å¯¹æ•°ä¸­å°†ä¸å†éœ€è¦è¿™ä¸ªå…ƒç´ ï¼Œå³ä» $a_{i + 1}$ å¼€å§‹ã€‚æ ¹æ®æ¶ˆå»å¾‹å¯å¾—ï¼Œå¼‚æˆ–ç­‰æ•ˆäºåŠ æ³•ä¸å‡æ³•ï¼Œå¯æ®æ­¤è®¡ç®—åŒºé—´çš„å¼‚æˆ–å’Œã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">10</span>;</span><br><span class="line">ll n, f[N], s[N], x, ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">        f[i] = f[i - <span class="number">1</span>] + x;</span><br><span class="line">        s[i] = s[i - <span class="number">1</span>] ^ x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">1</span>; r &lt;= n; r++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (; f[r] - f[l - <span class="number">1</span>] != (s[r] ^ s[l - <span class="number">1</span>]); l++);</span><br><span class="line">        ans += r - l + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Atcoder Regular Contest 099</title>
      <link href="2018/08/04/Atcoder%20Regular%20Contest%20099/"/>
      <url>2018/08/04/Atcoder%20Regular%20Contest%20099/</url>
      
        <content type="html"><![CDATA[<p><a href="https://arc099.contest.atcoder.jp/assignments" target="_blank" rel="noopener">https://arc099.contest.atcoder.jp/assignments</a></p><p>ä¸€å¦‚æ—¢å¾€åœ°ç®€æ´ï¼</p><h3 id="C-Minimization"><a href="#C-Minimization" class="headerlink" title="C. Minimization"></a>C. Minimization</h3><hr><p>é¢˜æ„ï¼šç»™å®š n çš„æ’åˆ—ï¼Œæ¯æ¬¡é€‰æ‹©è¿ç»­çš„ k ä¸ªå…ƒç´ ï¼Œèµ‹ä¸ºè¿™ k ä¸ªå…ƒç´ çš„æœ€å°å€¼ï¼Œé‡å¤æ­¤æ“ä½œï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ ç›¸åŒã€‚</p><p>å³æ‰€æœ‰å…ƒç´ éƒ½æ˜¯ 1 å’¯ï¼</p><p>æ˜¾ç„¶æˆ‘ä»¬æ¯æ¬¡æ“ä½œçš„åŒºé—´éƒ½ä¼šåŒ…å« 1ã€‚å› æ­¤ $Ans = 1 + \lceil \frac{N - K}{K - 1} \rceil$ã€‚$O(1)$</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, k, x;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">1</span>;</span><br><span class="line">    n -= k;</span><br><span class="line">    ans += n / (k - <span class="number">1</span>);</span><br><span class="line">    n %= (k - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (n) ans++;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Atcoder Regular Contest 100</title>
      <link href="2018/08/04/Atcoder%20Regular%20Contest%20100/"/>
      <url>2018/08/04/Atcoder%20Regular%20Contest%20100/</url>
      
        <content type="html"><![CDATA[<p><a href="https://arc100.contest.atcoder.jp/assignments" target="_blank" rel="noopener">https://arc100.contest.atcoder.jp/assignments</a></p><p>è¯è¯´ atcoder çš„é¢˜ç›®éƒ½è¶…çŸ­æ˜“æ‡‚æœ‰æ²¡æœ‰ï¼</p><h3 id="C-Linear-Approximation"><a href="#C-Linear-Approximation" class="headerlink" title="C. Linear Approximation"></a>C. Linear Approximation</h3><hr><p>é¢˜æ„ç•¥ã€‚</p><p>$A_i - (b + i)$ å‡ ä½•æ„ä¹‰å°±æ˜¯ $A_i - i$ åœ¨æ•°è½´ä¸Šåˆ° b çš„è·ç¦»å•¦ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, a[<span class="number">200005</span>], num, tot;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">iabs</span><span class="params">(ll a)</span> </span>&#123;<span class="keyword">return</span> a &gt; <span class="number">0</span> ? a : -a;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">cin</span> &gt;&gt; a[i], a[i] -= i;</span><br><span class="line">    sort(a + <span class="number">1</span>, a + n + <span class="number">1</span>);</span><br><span class="line">    num = a[(n + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) tot += iabs(a[i] - num);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; tot &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D-Equal-Cut"><a href="#D-Equal-Cut" class="headerlink" title="D. Equal Cut"></a>D. Equal Cut</h3><hr><p>é¢˜æ„ï¼šç»™ä½  N ä¸ªæ•°ï¼Œå­˜ä¸º Aiï¼Œåˆ‡ä¸‰åˆ€ï¼Œåˆ†ä¸ºå››ç»„ï¼Œæ¯ä¸€ç»„çš„å’Œåˆ†åˆ«ä¸º bã€cã€dã€eï¼Œè¦æ±‚è¿™å››ä¸ªæ•°çš„æå·®ï¼ˆæœ€å¤§æ•°å’Œæœ€å°æ•°çš„å·®ï¼‰æœ€å°ï¼Œè¾“å‡ºè¿™ä¸ªæœ€å°å€¼ã€‚</p><p>å…ˆé¢„å¤„ç†å‡ºå‰ç¼€å’Œï¼Œæš´åŠ›ä¸­é—´çš„æ–­ç‚¹ï¼Œåœ¨å¾ªç¯ä¸­æ‰¾ä¸€å‰ä¸€åä¸¤ä¸ªæ–­ç‚¹ï¼Œå¦‚æœç§»åŠ¨èƒ½ä½¿å¾—å‰åä¸¤ä¸ªåŒºåŸŸä¹‹é—´çš„å·®å˜å°ä¾¿ç§»åŠ¨ï¼Œå¦åˆ™ä¸ç§»åŠ¨ã€‚ç”¨ä¸€ä¸ªå˜é‡å­˜å‚¨æ‰€æœ‰å¾ªç¯ä¸­é—´æ–­ç‚¹æ—¶å‡ºç°çš„æœ€å°å€¼ï¼Œè¾“å‡ºå³å¯ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, a[N], pre[N], t[<span class="number">5</span>], ans = <span class="number">1e9</span>;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">iabs</span><span class="params">(ll a)</span> </span>&#123;<span class="keyword">return</span> a &gt; <span class="number">0</span> ? a : -a;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">cin</span> &gt;&gt; a[i], pre[i] = pre[i - <span class="number">1</span>] + a[i];</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">1</span>, r = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; n - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">while</span> (l &lt; i &amp;&amp; iabs(pre[l] - pre[<span class="number">0</span>] - (pre[i] - pre[l])) &gt;= iabs(pre[l + <span class="number">1</span>] - pre[<span class="number">0</span>] - (pre[i] - pre[l + <span class="number">1</span>])))</span><br><span class="line">            l++;</span><br><span class="line">        <span class="keyword">while</span> (r &lt; n &amp;&amp; iabs(pre[r] - pre[i] - (pre[n] - pre[r])) &gt;= iabs(pre[r + <span class="number">1</span>] - pre[i] - (pre[n] - pre[r + <span class="number">1</span>])))</span><br><span class="line">            r++;</span><br><span class="line">        t[<span class="number">1</span>] = pre[l] - pre[<span class="number">0</span>];</span><br><span class="line">        t[<span class="number">2</span>] = pre[i] - pre[l];</span><br><span class="line">        t[<span class="number">3</span>] = pre[r] - pre[i];</span><br><span class="line">        t[<span class="number">4</span>] = pre[n] - pre[r];</span><br><span class="line">        ans = min(ans, max(t[<span class="number">1</span>], max(t[<span class="number">2</span>], max(t[<span class="number">3</span>], t[<span class="number">4</span>]))) - min(t[<span class="number">1</span>], min(t[<span class="number">2</span>], min(t[<span class="number">3</span>], t[<span class="number">4</span>]))));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[BZOJ1101]-Zap</title>
      <link href="2018/08/01/%5BBZOJ1101%5D-Zap/"/>
      <url>2018/08/01/%5BBZOJ1101%5D-Zap/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vjudge.net/problem/HYSBZ-1101" target="_blank" rel="noopener">https://vjudge.net/problem/HYSBZ-1101</a></p><p>é¢˜æ„ç•¥ã€‚</p><p>æ±‚ $gcd(x, y) = d$, ç›¸å½“äºæ±‚ $gcd(x / d, y / d) = 1$ çš„ä¸ªæ•°ã€‚ç›¸å½“äºæ±‚ $1 \leq x \leq a / d$, $1 \leq y \leq b / d$ ä¸­ $x$, $y$ äº’è´¨å¯¹æ•°ã€‚</p><p>ä»¤ $n = \lfloor a / d \rfloor$, $m = \lfloor b / d \rfloor$.</p><p>å³</p><p>$$\sum\limits_{i = 1}^a \sum\limits_{j = 1}^b [gcd(i, j) == d]$$</p><p>$$= \sum\limits_{i = 1}^n \sum\limits_{j = 1}^m [gcd(i, j) == 1]$$</p><p>ç°åœ¨å¿…é¡»æåˆ°ä¸€ä¸ªè«æ¯”ä¹Œæ–¯å‡½æ•°çš„æ€§è´¨ï¼š<br>å½“ $n &gt; 1$ æ—¶ï¼Œ<br>$\sum\limits_{d | n} \mu(d) = 0$ï¼›$n = 1$ æ—¶ï¼Œ$\sum\limits_{d | n} \mu(d) = 1$ã€‚</p><p>è¯æ˜ï¼š</p><p>$n = 1$ æ—¶æ˜¾ç„¶ã€‚</p><p>$n &gt; 1$ æ—¶ï¼Œè®¾ $n = p_1^{c_1} * p_2^{c_2} * p_3^{c_3} * â€¦ * p_k^{c_k}$ ï¼Œ$d$ æœ‰å…¶ä¸­ä¸€éƒ¨åˆ†ã€‚</p><p>æ˜¾ç„¶æ ¹æ®è«æ¯”ä¹Œæ–¯å‡½æ•°çš„å®šä¹‰ï¼Œ$d$ çš„æ¯ä¸ªè´¨å› å­æŒ‡æ•°ä¸º $1$ æ‰æœ‰è´¡çŒ®ï¼Œå¦åˆ™ $\mu(d) = 0$ã€‚</p><p>é‚£ä¹ˆè®¾ $d$ ä¸­æœ‰ $r$ ä¸ªè´¨å› å­ã€‚</p><p>$\mu(d) = (-1)^r$ ï¼Œè¿™æ ·çš„ $d$ æœ‰ $C_m^r$ ä¸ªã€‚</p><p>æ‰€ä»¥</p><p>$$\sum\limits_{d | n} \mu(d) = \sum\limits_{r = 0}^m (-1)^rC_m^r$$</p><p>æˆ‘ä»¬æ ¹æ®äºŒé¡¹å¼å®šç†ï¼Œé€†æ¨å›å»ï¼š</p><p>$$\sum\limits_{r = 0}^m(-1)^rC_m^r = \sum\limits_{r = 0}^mC_m^r(-1)^r1^{m - r} = (-1 + 1)^m = 0$$</p><p>è¯æ¯•ã€‚</p><p>æˆ‘ä»¬ç”¨è¿™ä¸ªæ€§è´¨æŠŠæ±‚å’Œçš„å¼å­å˜æˆï¼š</p><p>$$\sum\limits_{i = 1}^n \sum\limits_{j = 1}^m \sum\limits_{d | gcd(i, j)} \mu(d)$$</p><p>å…¶ä¸­ $d | gcd(i, j)$ å¯ä»¥å˜ä¸º $d | i\ \ and\ \ d | j$ ï¼Œæ›´æ¢æ±‚å’ŒæŒ‡æ ‡ï¼Œ</p><p>$$= \sum\limits_{d = 1}^n \mu(d) * \lfloor \frac{n}{d} \rfloor * \lfloor \frac{m}{d} \rfloor$$</p><p>å®¹æ˜“çŸ¥é“ $\lfloor n / d \rfloor$ å•è°ƒä¸ä¸Šå‡ï¼Œæ ¹æ®æ•´æ•°åˆ†å—çš„çŸ¥è¯†ï¼Œæœ€å¤šæœ‰ $2\sqrt{n}$ ç§ä¸åŒçš„å–å€¼ã€‚æ‰€ä»¥æŒ‰å–å€¼åˆ†æˆ $O(\sqrt{n})$ ä¸ªæ®µåˆ†åˆ«å¤„ç†ï¼Œä¸€ä¸ªè¿ç»­çš„æ®µå†…çš„å’Œå¯ä»¥ç”¨é¢„å¤„ç†å‡ºçš„è«æ¯”ä¹Œæ–¯å‡½æ•°å‰ç¼€å’Œæ±‚å‡ºã€‚</p><p>åˆæ¬¡æ¶‰åŠï¼Œè§‰å¾—éå¸¸å¦™ï¼Œè‡ªå·±æƒ³æ˜¯ç»ä¸å¯èƒ½æƒ³åˆ°çš„ï¼Œåªèƒ½çœ‹é¢˜è§£ï¼Œä½†æ®è¯´æ˜¯å¥—è·¯é¢˜ï¼Œå¤šåšåšï¼Œè¦æœ‰ä¿¡å¿ƒã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e4</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">int</span> T, a, b, d, tot;</span><br><span class="line"><span class="keyword">int</span> miu[N], sum[N], pri[N];</span><br><span class="line"><span class="keyword">bool</span> vis[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_prefix</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    miu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= <span class="number">50000</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i]) pri[++tot] = i, miu[i] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; i * pri[j] &lt;= <span class="number">50000</span>; j++) &#123;</span><br><span class="line">            vis[i * pri[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % pri[j] == <span class="number">0</span>) &#123;</span><br><span class="line">                miu[i * pri[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> miu[i * pri[j]] = -miu[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">50000</span>; i++) sum[i] = sum[i - <span class="number">1</span>] + miu[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cal</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; m) swap(n, m);</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>, pos;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i = pos + <span class="number">1</span>) &#123;</span><br><span class="line">        pos = min(n / (n / i), m / (m / i));</span><br><span class="line">        ans += (sum[pos] - sum[i - <span class="number">1</span>]) * (n / i) * (m / i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    get_prefix();</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b &gt;&gt; d;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, cal(a / d, b / d));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> è«æ¯”ä¹Œæ–¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Codeforces Round 500 Div2</title>
      <link href="2018/07/31/Codeforces%20Round%20500%20Div2/"/>
      <url>2018/07/31/Codeforces%20Round%20500%20Div2/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/1013" target="_blank" rel="noopener">http://codeforces.com/contest/1013</a></p><h3 id="A-Piles-With-Stones"><a href="#A-Piles-With-Stones" class="headerlink" title="A. Piles With Stones"></a>A. Piles With Stones</h3><hr><p>é¢˜æ„ï¼šæœ‰ n å †çŸ³å­ï¼Œæ¯æ¬¡ä½ å¯ä»¥ç§»èµ°ä»»æ„ä¸€å †é‡Œçš„ä¸€é¢—çŸ³å­æˆ–å°†ä¸€å †é‡Œçš„éƒ¨åˆ†çŸ³å­ç§»åˆ°å¦ä¸€å †ã€‚ç»™å‡ºæ“ä½œå‰çš„çŸ³å­å †å’Œæ“ä½œåçš„çŸ³å­å †ï¼Œåˆ¤æ–­æ“ä½œæ˜¯å¦åˆç†ã€‚</p><p>å› ä¸ºæ“ä½œä¸èƒ½å¢åŠ çŸ³å­çš„æ€»æ•°ï¼Œæ‰€ä»¥å¦‚æœæ“ä½œåçš„çŸ³å­æ•°å¤§äºæ“ä½œå‰çš„å°±è¾“å‡ºâ€Noâ€ï¼Œå¦åˆ™è¾“å‡ºâ€Yesâ€ã€‚</p><h3 id="B-And"><a href="#B-And" class="headerlink" title="B. And"></a>B. And</h3><hr><p>é¢˜æ„ï¼šæœ‰ n ä¸ªæ•°ï¼Œxï¼Œæ¯ä¸ªæ•°å¯ä»¥ xor xï¼Œæ±‚è‡³å°‘éœ€è¦å¤šå°‘æ¬¡å¼‚æˆ–ï¼Œæ‰èƒ½æœ‰è‡³å°‘ä¸¤ä¸ªæ•°ç›¸ç­‰ã€‚</p><p>åªå­˜åœ¨ 4 ç§æƒ…å†µï¼š-1ï¼Œ0ï¼Œ1ï¼Œ2. å¯¹äºæ¯ä¸ªæ•° aiï¼Œå¦‚æœå¼‚æˆ–åç­‰äºå¼‚æˆ–å‰ï¼Œé‚£ä¹ˆ C[ai]++ ; å¦åˆ™ C[ai]++, D[ai ^ x]++ã€‚</p><p>ä» 0 åˆ° 100000 æšä¸¾ iï¼Œå¦‚æœ C[i] &gt;= 2, ans æœ€å°ï¼Œæ˜¯ 0ï¼›å¦‚æœ C[i] = 1, D[i] &gt; 0, ans å¯èƒ½æ˜¯ 1ï¼›å¦‚æœ C[i] = 0, D[i] &gt;= 2, ans å¯èƒ½æ˜¯ 2.</p><h3 id="C-Photo-of-The-Sky"><a href="#C-Photo-of-The-Sky" class="headerlink" title="C. Photo of The Sky"></a>C. Photo of The Sky</h3><hr><p>é¢˜æ„ï¼šæœ‰ n ä¸ªåæ ‡ç³»ä¸Šçš„ç‚¹ï¼Œè¿™äº›ç‚¹éƒ½åœ¨ä¸€ä¸ªçŸ©é˜µé‡Œã€‚å° A è®°å½•äº†å®ƒä»¬çš„ x åæ ‡å’Œ y åæ ‡ï¼Œä½†é¡ºåºæ‰“ä¹±äº†ï¼Œç°åœ¨è¦æ±‚ä½ æ ¹æ®è¿™äº›è®°å½•ç¡®å®šçŸ©é˜µå¯èƒ½çš„æœ€å°é¢ç§¯ã€‚</p><p>æœ‰ 2n ä¸ªæ•°æ®ï¼Œå…¶ä¸­å¿…å®šæœ‰ n ä¸ª x åæ ‡ï¼Œn ä¸ª y åæ ‡ã€‚å…ˆæ’åºã€‚ä¸¤ç§åæ ‡å¿…å®šå„è‡ªåœ¨ç»™å‡ºæ•°æ®çš„ä¸€ä¸ªåŒºé—´å†…ï¼Œè®¾ x åæ ‡çš„åŒºé—´ä¸º [l, r], y åæ ‡çš„åŒºé—´ä¸º [p, q]ã€‚</p><p>è‹¥ l &gt; 1, r &lt; 2n, é‚£ä¹ˆ y åæ ‡çš„è·ç¦»å°±æ˜¯ a[2n] - a[1]ï¼Œx åæ ‡çš„è·ç¦»å°±æ˜¯ a[r] - a[l]ã€‚å› ä¸º y åæ ‡çš„è·ç¦»å·²ç»ç¡®å®šäº†ï¼Œl å’Œ r å¿…ç„¶æ˜¯è¶Šè¿‘è¶Šå¥½ï¼Œå³ r = l + n - 1.</p><p>è‹¥ l = 1, è‚¯å®šæ˜¯ r = l + n - 1, p = r + 1, q = 2n æœ€ä¼˜ã€‚</p><p>æ¯”èµ›æ—¶è¿˜å‰©40åˆ†é’Ÿçš„æ ·å­ï¼Œè¿˜æ˜¯æƒ³å‡ºäº†å…³äºåŒºé—´çš„é“ç†çš„ï¼Œä½†æ‰“æŒ‚äº†ï¼šâ€œl å’Œ r å¿…ç„¶æ˜¯è¶Šè¿‘è¶Šå¥½â€çš„æœ€ä¼˜æ€§æ²¡æœ‰è€ƒè™‘ï¼Œå¯¼è‡´äº†ä¸€ç³»åˆ—å¥‡å¥‡æ€ªæ€ªæ— æ³•åˆ†æçš„é—®é¢˜ã€‚ã€‚ã€‚</p><p>codeï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll a[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n * <span class="number">2</span>; i++) <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">    sort(a + <span class="number">1</span>, a + <span class="number">2</span> * n + <span class="number">1</span>);</span><br><span class="line">    ll ans = (a[n] - a[<span class="number">1</span>]) * (a[<span class="number">2</span> * n] - a[n + <span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) ans = min(ans, (a[i + n - <span class="number">1</span>] - a[i]) * (a[<span class="number">2</span> * n] - a[<span class="number">1</span>]));</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D-Chemical-table"><a href="#D-Chemical-table" class="headerlink" title="D. Chemical table"></a>D. Chemical table</h3><hr><p>é¢˜æ„ï¼šç»™å‡ºä¸€ä¸ª $n * m$ çš„è¡¨æ ¼ï¼Œè¡¨æ ¼ä¸Šæœ‰ä¸€äº›åˆå§‹ç‚¹ã€‚è‹¥æœ‰è¿™æ ·çš„ä¸‰ä¸ªç‚¹ï¼š(r1, c1), (r1, c2), (r2, c1)ï¼Œåˆ™ç”±è¿™ä¸‰ä¸ªç‚¹èƒ½ç”Ÿæˆå‡ºç‚¹ (r2, c2)ã€‚ç°é—®åœ¨åˆå§‹ç‚¹çš„åŸºç¡€ä¸Šæœ€å°‘æ·»åŠ å¤šå°‘ä¸ªç‚¹ï¼Œèƒ½ä½¿å¾—åˆå§‹ç‚¹å’Œæ·»åŠ çš„ç‚¹åŠå®ƒä»¬ç”Ÿæˆå‡ºæ¥çš„ç‚¹èƒ½å¡«æ»¡æ•´ä¸ªè¡¨æ ¼ã€‚</p><p>å¯ä»¥å°†æ¯ä¸€ä¸ªç‚¹çœ‹æˆæ˜¯å°†æ‰€åœ¨çš„è¡Œå’Œåˆ—è”ç³»èµ·æ¥ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œå¯¹äº (r1, c1) + (r1, c2) + (r2, c1) â‡’ (r2, c2)ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºï¼šå› ä¸º r1 å’Œ c1ï¼Œr1 å’Œ c2ï¼Œr2 å’Œ c1 éƒ½ç›¸åº”åœ°è”ç³»èµ·æ¥äº†ï¼Œé‚£ä¹ˆ r2 å’Œ c2 ä¹Ÿè”ç³»èµ·æ¥äº†ã€‚æ‰€ä»¥æˆ‘ä»¬åªè¦æŠŠæ‰€æœ‰çš„è¡Œå’Œåˆ—éƒ½è”ç³»èµ·æ¥ï¼Œç”Ÿæˆå‡ºæ¥çš„ç‚¹å°±èƒ½å¡«æ»¡æ•´ä¸ªè¡¨æ ¼ã€‚é‚£ä¹ˆé—®é¢˜å°±è½¬æ¢æˆé—®æœ€å°‘å»ºç«‹å¤šå°‘è”ç»“ï¼Œèƒ½å°†æ‰€æœ‰çš„è¡Œå’Œåˆ—éƒ½è”ç³»èµ·æ¥ã€‚å¯ä»¥ç”¨å¹¶æŸ¥é›†è§£å†³ã€‚</p><p>codeï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> fa[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;<span class="keyword">return</span> fa[x] == x ? x : fa[x] = getfa(fa[x]);&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">int</span> n, m, q;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; q;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n + m; i++) fa[i] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= q; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> r, c;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; r &gt;&gt; c;</span><br><span class="line">        <span class="keyword">int</span> fr = getfa(r), fc = getfa(c + n);</span><br><span class="line">        <span class="keyword">if</span> (fr != fc) fa[fr] = fc;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> root = getfa(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n + m; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> tmp = getfa(i);</span><br><span class="line">        <span class="keyword">if</span> (tmp != root) ans++, fa[tmp] = root;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="E-Hills"><a href="#E-Hills" class="headerlink" title="E. Hills"></a>E. Hills</h3><hr><p>é¢˜æ„ï¼šæœ‰ä¸€åº§åŸå¸‚ï¼ŒåŸå¸‚ä¸­æœ‰ n åº§å±±ï¼Œæ˜¯ä»å·¦åˆ°å³æŒ‰ä¸€è¡Œæ’åˆ—çš„ï¼Œæ¯åº§å±±æœ‰ä¸€ä¸ªå·²çŸ¥çš„é«˜åº¦ hï¼Œä¸€åº§æˆ¿å­èƒ½åœ¨ç¬¬ i åº§å±±ä¸Šå»ºé€ ï¼Œå½“ä¸”ä»…å½“ $h_{i - 1} &lt; h_i$ ä¸” $h_i &gt; h_{i + 1}$ï¼Œç°åœ¨è¿™åº§åŸå¸‚çš„å¸‚é•¿æƒ³å¯¹è¿™äº›å±±è¿›è¡Œä¿®æ•´ï¼Œä»–ä»¬å¯ä»¥èŠ±ä¸€å¤©çš„æ—¶é—´å°†æŸä¸€åº§å±±çš„é«˜åº¦å‡æ‰1ã€‚ç°åœ¨ï¼Œå¯¹äºæ‰€æœ‰çš„k($1 \leq k \leq \lceil \frac{n}{2} \rceil$)ï¼Œä»–ä»¬æƒ³çŸ¥é“æœ€å°‘éœ€è¦å¤šå°‘å¤©å¯ä»¥å»ºé€ å‡º k å¹¢æˆ¿å­ï¼ˆé™¤äº†è°ƒæ•´å±±çš„é«˜åº¦å¤–ï¼Œå…¶ä»–æ—¶é—´ä¸€å¾‹ä¸è®¡ï¼‰ã€‚</p><p>DPï¼Œè®¾ $f[i][j][k]$ è¡¨ç¤ºç°åœ¨ DP åˆ°ç¬¬ i åº§å±±ï¼Œå‰ i åº§å±±é‡Œæœ‰ j åº§å¯ä»¥å»ºæˆ¿å­ï¼ŒçŠ¶æ€ä¸º kã€‚</p><p>k = 0ï¼Œè¡¨ç¤ºç¬¬ i åº§å±±å’Œç¬¬ i - 1 åº§å±±éƒ½ä¸å»ºæˆ¿å­ï¼›</p><p>k = 1ï¼Œè¡¨ç¤ºç¬¬ i åº§ä¸å»ºï¼Œç¬¬ i - 1 å»ºï¼›</p><p>k = 2ï¼Œè¡¨ç¤ºç¬¬ i åº§å»ºï¼Œç¬¬ i - 1 ä¸å»ºæˆ–ç¬¬ i åº§å»ºã€‚</p><p>ä¸è¿‡ä¸ºäº†æ–¹ä¾¿ç¼–å†™ï¼Œå½“æˆ‘ä»¬åœ¨ç¬¬ i åº§å±±å»ºæˆ¿å­æ—¶ï¼Œå¯¹ç¬¬ i + 1 åº§å±±çš„å½±å“æ”¾åœ¨ç¬¬ i + 1 ä½è¿›è¡Œè®¡ç®—ã€‚</p><p>$f_{i, j, 0} = min(f_{i - 1, j, 0}, f_{i - 1, j, 1})$ å¦‚æœè¿™ä¸€åº§å±±å’Œå‰ä¸€åº§å±±éƒ½ä¸æ˜¯å±±å³°çš„è½¬ç§»ã€‚ </p><p>$f_{i, j, 1} = f_{i - 1, j, 2} + max(0, h_i - (h_{i - 1} - 1))$ è¿™é‡Œæ˜¯è®¡ç®—ç¬¬ i âˆ’ 1 åº§å»ºæˆ¿å­æ˜¯å¯¹ç¬¬ i åº§å±±çš„å½±å“ã€‚ </p><p>$f_{i, j, 2} = min(f_{i - 1, j - 1, 0} + max(0, h_{i - 1} - (h_i - 1)), f_{i - 1, j - 1, 1} + max(0, min(h_{i - 2} - 1, h_{i - 1}) - (h_i - 1)))$ è¿™é‡Œæ˜¯åˆ†ä¸¤ç§æƒ…å†µè€ƒè™‘ï¼Œå½“ç¬¬ i âˆ’ 2 åº§å±±ä¹Ÿè¢«æ‹¿æ¥å»ºæˆ¿å­æ—¶ï¼Œè¦è€ƒè™‘ç¬¬ i âˆ’ 2 åº§å±±å¯¹ç¬¬ i âˆ’ 1 åº§å±±çš„å½±å“ä¸ç¬¬ i åº§å±±æ‹¿æ¥å»ºæˆ¿å­æ˜¯å¯¹ç¬¬ i âˆ’ 1 åº§å±±çš„å½±å“ã€‚å¦‚æœç¬¬ i âˆ’ 2 åº§å±±ä¸æ‹¿æ¥å»ºæˆ¿å­ï¼Œé‚£å°±ä¸ç”¨è€ƒè™‘äº†ã€‚</p><p>code:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5005</span>;</span><br><span class="line"><span class="keyword">int</span> n, h[N], f[N][N][<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;h[i]);</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; j++) &#123;</span><br><span class="line">            f[i][j][<span class="number">0</span>] = min(f[i - <span class="number">1</span>][j][<span class="number">0</span>], f[i - <span class="number">1</span>][j][<span class="number">1</span>]);</span><br><span class="line">            f[i][j][<span class="number">1</span>] = f[i - <span class="number">1</span>][j][<span class="number">2</span>] + max(<span class="number">0</span>, h[i] - (h[i - <span class="number">1</span>] - <span class="number">1</span>));</span><br><span class="line">            <span class="keyword">if</span> (j)</span><br><span class="line">                f[i][j][<span class="number">2</span>] = min(f[i - <span class="number">1</span>][j - <span class="number">1</span>][<span class="number">0</span>] + max(<span class="number">0</span>, h[i - <span class="number">1</span>] - (h[i] - <span class="number">1</span>)), f[i - <span class="number">1</span>][j - <span class="number">1</span>][<span class="number">1</span>] + max(<span class="number">0</span>, min(h[i - <span class="number">2</span>] - <span class="number">1</span>, h[i - <span class="number">1</span>]) - (h[i] - <span class="number">1</span>)));</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= (n + <span class="number">1</span>) / <span class="number">2</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, min(f[n][i][<span class="number">0</span>], min(f[n][i][<span class="number">1</span>], f[n][i][<span class="number">2</span>])));</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[BZOJ1951]-å¤ä»£çŒªæ–‡</title>
      <link href="2018/07/27/%5BBZOJ1951%5D-%E5%8F%A4%E4%BB%A3%E7%8C%AA%E6%96%87/"/>
      <url>2018/07/27/%5BBZOJ1951%5D-%E5%8F%A4%E4%BB%A3%E7%8C%AA%E6%96%87/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vjudge.net/problem/HYSBZ-1951" target="_blank" rel="noopener">https://vjudge.net/problem/HYSBZ-1951</a></p><p>é¢˜æ„ï¼šç»™å®šæ•´æ•° q, n($1 \leq q, n \leq 10^9$)ï¼Œè®¡ç®— $q^{\sum_{d | n} C_{n}^d}\ mod\ 999911659$ ã€‚</p><p>æ•°è®ºç»å…¸é¢˜ï¼å‡ºç°äº†å¾ˆå¤šçŸ¥è¯†ç‚¹ï¼Œå€¼å¾—å›é¡¾ï¼</p><p>è‹¥ q = 999911659, åˆ™ä¸Šå¼ç»“æœä¸º 0. å¦åˆ™ï¼Œå› ä¸º 999911659 æ˜¯è´¨æ•°ï¼Œæ‰€ä»¥ q, 999911659 äº’è´¨ã€‚ç”±æ¬§æ‹‰å®šç†çš„æ¨è®ºå¾—ï¼š</p><p>$$q^{\sum_{d | n} C_n^d}\ mod\ 999911659 \equiv q^{\sum_{d | n} C_n^d\ mod\ 999911658}\ (mod\ 999911659)$$</p><p>å› æ­¤ï¼Œæœ¬é¢˜çš„å…³é”®æ˜¯è®¡ç®— $q^{\sum_{d | n} C_n^d\ mod\ 999911658}\ (mod\ 999911659)$</p><p>å°è¯•åˆ†è§£è´¨å› æ•°ï¼Œå¯ä»¥å‘ç° $999911658 = 2 * 3 * 4679 * 35617$ ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æšä¸¾ n çš„çº¦æ•° dï¼Œç„¶åè¿ç”¨ Lucas å®šç†æ±‚ç»„åˆæ•° $C_n^d$ ï¼Œåˆ†åˆ«è®¡ç®—å‡º $\sum_{d | n} C_n^d$ å¯¹ 2, 3, 4679, 35617 å››ä¸ªè´¨æ•°çš„å–æ¨¡ç»“æœï¼Œè®°ä¸º a1, a2, a3, a4ã€‚æ±‚ç»„åˆæ•°æ—¶ï¼Œå¯ä»¥å¯¹äºè´¨æ•° pï¼Œé¢„å¤„ç† p ä»¥å†…çš„æ‰€æœ‰é˜¶ä¹˜ä»¥åŠé˜¶ä¹˜çš„æ¨¡ p ä¹˜æ³•é€†å…ƒï¼Œå°±èƒ½å¿«é€Ÿè®¡ç®—ã€‚</p><p>æœ€åç”¨ä¸­å›½å‰©ä½™å®šç†æ±‚è§£çº¿æ€§åŒä½™æ–¹ç¨‹ç»„ï¼š</p><p>$$ \left{<br>\begin{aligned}<br>x\ mod\ 2\ =\ a1 \<br>x\ mod\ 3\ =\ a2 \<br>x\ mod\ 4679\ =\ a3 \<br>x\ mod\ 35617\ =\ a4 \<br>\end{aligned}<br>\right.<br>$$</p><p>å†ç”¨å¿«é€Ÿå¹‚æ±‚ $q^x$ å³å¯ã€‚</p><p>æƒ³äº†æƒ³è¿˜çœŸæ˜¯ç”¨äº†ä¸å°‘å®šç†å•Šå…¬å¼çš„ï¼å¿«é€Ÿå¹‚ï¼ŒLucas å®šç†ï¼Œæ‰©å±•æ¬§å‡ é‡Œå¾—ï¼Œä¸­å›½å‰©ä½™å®šç†ï¼Œè´¹é©¬å°å®šç†æ±‚ä¹˜æ³•é€†å…ƒï¼ŒæƒŠå¹â—ï¸</p><p>CODEï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">999911659</span>, N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> T[<span class="number">4</span>] = &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">4679</span>, <span class="number">35617</span>&#125;;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll Q, n, Fac[<span class="number">4</span>][N], r[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">quick_pow</span><span class="params">(ll a, ll b, ll c)</span> </span>&#123;</span><br><span class="line">    a %= c;</span><br><span class="line">    ll ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>) ret = ret * a % c;</span><br><span class="line">        a = a * a % c;</span><br><span class="line">    &#125; <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">C</span><span class="params">(ll n, ll m, ll p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (m &lt; n) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> (Fac[p][m] * quick_pow(Fac[p][n] * Fac[p][m - n], T[p] - <span class="number">2</span>, T[p])) % T[p];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">Lucas</span><span class="params">(ll a, ll b, ll p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> C(a % T[p], b % T[p], p) * Lucas(a / T[p], b / T[p], p) % T[p];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">exGcd</span><span class="params">(ll a, ll b, ll &amp;x, ll &amp;y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>) &#123;</span><br><span class="line">        x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    ll d = exGcd(b, a % b, y, x);</span><br><span class="line">    y -= (a / b) * x;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">CRT</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ll M = <span class="number">999911658</span>, ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">        ll x, y, Mi = M / T[i];</span><br><span class="line">        exGcd(Mi, T[i], x, y);</span><br><span class="line">        ans = (ans + Mi * x * r[i]) % M;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (ans &lt; <span class="number">0</span>) ans += M;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; Q;</span><br><span class="line">    <span class="keyword">if</span> (Q == mod) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"0\n"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">        Fac[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= T[i]; j++) Fac[i][j] = Fac[i][j - <span class="number">1</span>] * j % T[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j * j &lt;= n; j++)</span><br><span class="line">            <span class="keyword">if</span> (n % j == <span class="number">0</span>) &#123;</span><br><span class="line">                r[i] = (r[i] + Lucas(j, n, i)) % T[i];</span><br><span class="line">                <span class="keyword">if</span> (j * j != n) r[i] = (r[i] + Lucas(n / j, n, i)) % T[i];</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, quick_pow(Q, CRT(), mod));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ•°è®º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[POJ1733]-Parity game</title>
      <link href="2018/07/17/%5BPOJ1733%5D-Parity%20game/"/>
      <url>2018/07/17/%5BPOJ1733%5D-Parity%20game/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vjudge.net/problem/POJ-1733" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>å¦‚æœæˆ‘ä»¬ç”¨ $sum$ æ•°ç»„è¡¨ç¤ºåºåˆ— $S$ çš„å‰ç¼€å’Œï¼Œ é‚£ä¹ˆåœ¨æ¯ä¸ªå›ç­”ä¸­ï¼š</p><ol><li>$S[l ~ r]$ æœ‰å¶æ•°ä¸ª $1$ï¼Œç­‰ä»·äº $sum[l - 1]$ ä¸ $sum[r]$ å¥‡å¶æ€§ç›¸åŒã€‚</li><li>$S[l ~ r]$ æœ‰å¥‡æ•°ä¸ª $1$ï¼Œç­‰ä»·äº $sum[l - 1]$ ä¸ $sum[r]$ å¥‡å¶æ€§ä¸åŒã€‚</li></ol><p>å¥½äº†ï¼Œåˆæ˜¯â€œç›¸åŒâ€å’Œâ€œä¸åŒâ€ï¼Œå¯ä»¥è”ç³»åˆ°â€œç¨‹åºè‡ªåŠ¨åˆ†æâ€é‚£é¢˜ï¼Œéƒ½æ˜¯ç»™å®šè‹¥å¹²ä¸ªå˜é‡å’Œå…³ç³»ã€‚</p><p>åºåˆ—é•¿åº¦ $N$ å¾ˆå¤§ï¼Œä½†é—®é¢˜æ•° $M$ è¾ƒå°ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¯å¥è¯çš„ä¸¤ä¸ªæ•´æ•° $l - 1$ å’Œ $r$ ç¦»æ•£åŒ–ï¼Œç¼©å°åˆ°ç­‰ä»·çš„ $1$ ï½ $2M$ ä»¥å†…çš„èŒƒå›´ã€‚</p><p>è§£å†³æœ¬é¢˜æœ‰ä¸¤ç§å¾ˆå¥½çš„æ–¹æ³•ï¼Œç¬¬ä¸€ç§è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨â€œè¾¹å¸¦æƒâ€çš„å¹¶æŸ¥é›†ã€‚<br>è¾¹æƒ $d[x]$ ä¸º $0$ï¼Œè¡¨ç¤º $x$ ä¸ $fa[x]$ å¥‡å¶æ€§ç›¸åŒï¼›ä¸º $1$ï¼Œè¡¨ç¤º $x$ ä¸ $fa[x]$ å¥‡å¶æ€§ä¸åŒã€‚åœ¨è·¯å¾„å‹ç¼©æ—¶ï¼Œå¯¹ $x$ åˆ°æ ‘æ ¹è·¯å¾„ä¸Šçš„æ‰€æœ‰è¾¹æƒåšå¼‚æˆ–æ“ä½œï¼Œå³å¯æ±‚å‡º $x$ ä¸æ ‘æ ¹çš„å¥‡å¶æ€§å…³ç³»ã€‚</p><p>å¯¹äºæ¯å¥è¯ï¼Œè®¾åœ¨ç¦»æ•£åŒ–å $l - 1$ å’Œ $r$ çš„å€¼åˆ†åˆ«æ˜¯ $x$ å’Œ $y$ï¼Œè®¾ $ans$ è¡¨ç¤ºè¿™å¥è¯çš„å¥‡å¶æ€§ã€‚</p><p>å…ˆæ£€æŸ¥ $x$ å’Œ $y$ æ˜¯å¦åœ¨åŒä¸€ä¸ªé›†åˆå†…ï¼ˆå¥‡å¶å…³ç³»æ˜¯å¦å·²çŸ¥ï¼‰ã€$getfa(x)$ã€$getfa(y)$ éƒ½æ‰§è¡Œå®Œæˆåï¼Œ$d[x]$ xor $d[y]$ å³ä¸º $x$ å’Œ $y$ çš„å¥‡å¶æ€§å…³ç³»ã€‚è‹¥ $d[x]$ xor $d[y]$ ä¸ç­‰äº $ans$ï¼Œåˆ™åœ¨è¯¥é—®é¢˜ä¹‹åå³å¯ç¡®å®šæ˜¯å‡è¯ã€‚</p><p>è‹¥ $x$ å’Œ $y$ ä¸åœ¨åŒä¸€ä¸ªé›†åˆå†…ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦åˆå¹¶ã€‚è®¾ä¸¤ä¸ªé›†åˆçš„æ ‘æ ¹ä¸º $p$ å’Œ $q$ï¼Œè¦ä»¤ $p$ ä¸º $q$ çš„å­èŠ‚ç‚¹ã€‚å·²çŸ¥ $d[x]$ ä¸ $d[y]$ åˆ†åˆ«è¡¨ç¤ºè·¯å¾„ $x$ ~ $p$ ä¸ $y$ ~ $q$ ä¹‹é—´æ‰€æœ‰è¾¹æƒçš„ xor å’Œï¼Œ$p$ ~ $q$ ä¹‹é—´çš„ $d[p]$ æ˜¯å¾…æ±‚çš„å€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç”¨ $ans$ å»å¼‚æˆ– $d[x]$ xor $d[y]$ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">10010</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, ans;</span><br><span class="line">&#125; query[N];</span><br><span class="line"><span class="keyword">int</span> a[N &lt;&lt; <span class="number">1</span>], fa[N &lt;&lt; <span class="number">1</span>], d[N &lt;&lt; <span class="number">1</span>], n, m, t;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (w == fa[w]) <span class="keyword">return</span> w;</span><br><span class="line">    <span class="keyword">int</span> root = getfa(fa[w]);</span><br><span class="line">    d[w] ^= d[fa[w]];</span><br><span class="line">    <span class="keyword">return</span> fa[w] = root;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">read_discrete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="keyword">char</span> str[<span class="number">5</span>];</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%s"</span>, &amp;query[i].l, &amp;query[i].r, str);</span><br><span class="line">        query[i].ans = (str[<span class="number">0</span>] == <span class="string">'o'</span> ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">        a[++t] = query[i].l - <span class="number">1</span>;</span><br><span class="line">        a[++t] = query[i].r;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(a + <span class="number">1</span>, a + t + <span class="number">1</span>);</span><br><span class="line">    n = unique(a + <span class="number">1</span>, a + t + <span class="number">1</span>) - a - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    read_discrete();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) fa[i] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = lower_bound(a + <span class="number">1</span>, a + n + <span class="number">1</span>, query[i].l - <span class="number">1</span>) - a;</span><br><span class="line">        <span class="keyword">int</span> y = lower_bound(a + <span class="number">1</span>, a + n + <span class="number">1</span>, query[i].r) - a;</span><br><span class="line">        <span class="keyword">int</span> fx = getfa(x), fy = getfa(y);</span><br><span class="line">        <span class="keyword">if</span> (fx == fy) &#123;</span><br><span class="line">            <span class="keyword">if</span> ((d[x] ^ d[y]) != query[i].ans) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, i - <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            fa[fx] = fy, d[fx] = d[x] ^ d[y] ^ query[i].ans;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, m);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•æ›´ç›´è§‚ï¼Œæ˜¯â€œæ‰©å±•åŸŸâ€çš„å¹¶æŸ¥é›†ã€‚</p><p>æŠŠæ¯ä¸ªå˜é‡çš„ä¿¡æ¯æ‹†æˆä¸¤ä¸ªèŠ‚ç‚¹ $x_{odd}$ å’Œ $x_{even}$ ï¼Œå…¶ä¸­ $x_{odd}$ è¡¨ç¤º sum[x] æ˜¯å¥‡æ•°ï¼Œ$x_{even}$ è¡¨ç¤º sum[x] æ˜¯å¶æ•°ã€‚å®ƒä¿©ä¹Ÿåˆ†åˆ«ç§°ä¸º x çš„å¥‡æ•°åŸŸå’Œå¶æ•°åŸŸã€‚</p><p>å¯¹äºæ¯å¥è¯ï¼Œè®¾åœ¨ç¦»æ•£åŒ–å l - 1 å’Œ r çš„å€¼åˆ†åˆ«æ˜¯ x å’Œ yï¼Œè®¾ ans è¡¨ç¤ºè¿™å¥è¯çš„å¥‡å¶æ€§ã€‚</p><p>è‹¥ ans = 0ï¼Œåˆ™åˆå¹¶ $x_{odd}$ ä¸ $y_{odd}$ ã€$x_{even}$ ä¸ $y_{even}$ ï¼Œè¡¨ç¤º â€œx ä¸ºå¶æ•°â€ ä¸ â€œy ä¸ºå¶æ•°â€ã€â€œx ä¸ºå¥‡æ•°â€ ä¸ â€œy ä¸ºå¥‡æ•°â€ å¯ä»¥äº’ç›¸æ¨å‡ºã€‚</p><p>è‹¥ ans = 1ï¼Œåˆ™åˆå¹¶ $x_{odd}$ ä¸ $y_{even}$ ã€$x_{even}$ ä¸ $y_{odd}$ ï¼Œè¡¨ç¤º â€œx ä¸ºå¥‡æ•°â€ ä¸ â€œy ä¸ºå¶æ•°â€ã€â€œx ä¸ºå¶æ•°â€ ä¸ â€œy ä¸ºå¥‡æ•°â€ å¯ä»¥äº’ç›¸æ¨å‡ºã€‚</p><p>è€ƒè™‘çŸ›ç›¾çš„è¯ï¼Œè·Ÿä¸Šé¢ä¸€æ ·çš„å’¯ã€‚</p><p>CODEï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">10010</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> l, r, ans;</span><br><span class="line">&#125; query[N];</span><br><span class="line"><span class="keyword">int</span> a[N &lt;&lt; <span class="number">1</span>], fa[N &lt;&lt; <span class="number">1</span>], d[N &lt;&lt; <span class="number">1</span>], n, m, t;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> w)</span> </span>&#123;<span class="keyword">return</span> fa[w] == w ? w : fa[w] = getfa(fa[w]);&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">read_discrete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="keyword">char</span> str[<span class="number">5</span>];</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%s"</span>, &amp;query[i].l, &amp;query[i].r, str);</span><br><span class="line">        query[i].ans = (str[<span class="number">0</span>] == <span class="string">'o'</span> ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">        a[++t] = query[i].l - <span class="number">1</span>;</span><br><span class="line">        a[++t] = query[i].r;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(a + <span class="number">1</span>, a + t + <span class="number">1</span>);</span><br><span class="line">    n = unique(a + <span class="number">1</span>, a + t + <span class="number">1</span>) - a - <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    read_discrete();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">2</span> * n; i++) fa[i] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> x = lower_bound(a + <span class="number">1</span>, a + n + <span class="number">1</span>, query[i].l - <span class="number">1</span>) - a;</span><br><span class="line">        <span class="keyword">int</span> y = lower_bound(a + <span class="number">1</span>, a + n + <span class="number">1</span>, query[i].r) - a;</span><br><span class="line">        <span class="keyword">int</span> x_odd = x, x_even = x + n;</span><br><span class="line">        <span class="keyword">int</span> y_odd = y, y_even = y + n;</span><br><span class="line">        <span class="keyword">if</span> (query[i].ans == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (getfa(x_odd) == getfa(y_even)) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, i - <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            fa[getfa(x_odd)] = getfa(y_odd);</span><br><span class="line">            fa[getfa(x_even)] = getfa(y_even);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (getfa(x_odd) == getfa(y_odd)) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, i - <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            fa[getfa(x_odd)] = getfa(y_even);</span><br><span class="line">            fa[getfa(x_even)] = getfa(y_odd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, m);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å¹¶æŸ¥é›† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Educational Codeforces Round 47</title>
      <link href="2018/07/15/Educational%20Codeforces%20Round%2047/"/>
      <url>2018/07/15/Educational%20Codeforces%20Round%2047/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codeforces.com/contest/1009" target="_blank" rel="noopener">http://codeforces.com/contest/1009</a></p><p>æ€»ç»“ï¼šcodeforcesæ¯”èµ›æ‰“å¾—æŒºå°‘ï¼Œè¿™æ¬¡æœ‰å‡ ä¸ªé—®é¢˜ï¼Œä¸€æ˜¯æ—¶é—´åˆ†é…ï¼ŒäºŒæ˜¯å¿ƒæ€ã€‚T3åæ¥åœ¨æ¯”èµ›ç»“æŸä¸€åˆ†é’Ÿå·¦å³æ•²å¥½äº†ï¼Œä½†äº‹åæƒ³èµ·æ¥å› ä¸ºå¤ªç´§å¼ å¯¼è‡´å¥½å‡ æ¬¡æäº¤é”™è¯¯ï¼Œæµªè´¹æ—¶é—´ã€‚è¿˜æœ‰å› ä¸ºæ˜¯è‹±æ–‡é¢˜é¢ï¼Œä¸èƒ½åƒä¸­æ–‡é¢˜é¢é‚£æ ·å¾ˆå¿«åœ°æ¥å›åå¤æ‰¾ä¿¡æ¯ï¼Œåœ¨é¢„è§ˆé¢˜ç›®æ—¶å¿½ç•¥äº†éƒ¨åˆ†ä¿¡æ¯å¯¼è‡´æˆ‘å¯¹é¢˜ç›®éš¾åº¦é¢„ä¼°å‡ºé”™ï¼Œåœ¨T2ä¸ŠèŠ±äº†å¤§é‡çš„æ—¶é—´åæ‰æ„è¯†åˆ°T3æ˜¯æ°´é¢˜ã€‚</p><h3 id="A-Game-Shopping"><a href="#A-Game-Shopping" class="headerlink" title="A. Game Shopping"></a>A. Game Shopping</h3><hr><p>é¢˜æ„ä¸æƒ³æ”¾ã€‚ã€‚å‚»é¢˜ï¼Œä¸¤ä¸ªæŒ‡é’ˆä»å·¦åˆ°å³å°±å¥½äº†ã€‚</p><h3 id="B-Minimum-Ternary-String"><a href="#B-Minimum-Ternary-String" class="headerlink" title="B. Minimum Ternary String"></a>B. Minimum Ternary String</h3><hr><p>é¢˜æ„ï¼šæœ‰ä¸€ä¸ªä¸‰è¿›åˆ¶çš„å­—ç¬¦ä¸²ç”± â€˜0â€™ ï¼Œâ€™1â€™ï¼Œ â€˜2â€™ ç»„æˆã€‚æˆ‘ä»¬æ¯æ¬¡å¯ä»¥äº¤æ¢ç›¸é‚»çš„ä¸¤ä¸ªå­—ç¬¦çš„æ¡ä»¶æ˜¯è¿™ä¸¤ä¸ªä¸º â€˜0â€™, â€˜1â€™ æˆ–ä¸º â€˜1â€™, â€˜2â€™ã€‚<br>æ±‚è¯¥å­—ç¬¦ä¸²çš„æœ€å°å­—å…¸åºã€‚ä¾‹å¦‚ï¼Œ201 çš„æœ€å°å­—å…¸åºä¸º 120ã€‚</p><p>è¢«é¢˜ç›®ç»•äº†å·®ä¸å¤šä¸€ä¸ªå°æ—¶ï¼Ÿã€‚ã€‚ã€‚ã€‚ã€‚æ€»æ—¶é—´åªæœ‰2å°æ—¶å•Šã€‚ã€‚ã€‚ã€‚ã€‚<br>è¿™ç§è´ªå¿ƒé¢˜ç›®å®¹æ˜“äº§ç”Ÿå¾ˆå¤šå…·æœ‰è¯¯å¯¼æ€§çš„é”™è¯¯è´ªå¿ƒç®—æ³•ï¼Œä¸€å¼€å§‹æˆ‘æƒ³çš„æ˜¯æ‰¾åˆ°è¿ç»­çš„ä¸€ä¸ªå—ç”± â€˜0â€™, â€˜1â€™ ç»„æˆæˆ– â€˜1â€™, â€˜2â€™ ç»„æˆï¼Œå°†å—é‡Œæ‰€æœ‰è¾ƒå°çš„å­—ç¬¦å½’åˆ°å·¦è¾¹ï¼Œè¾ƒå¤§çš„å­—ç¬¦å½’åˆ°å³è¾¹ã€‚</p><p>è¿™é¢˜è¿˜æœ‰ä¸€ä¸ªå‘ç‚¹å°±æ˜¯ï¼Œå¦‚æœä¸æ‰¾åˆ°æ­£ç¡®è´ªå¿ƒç®—æ³•ï¼Œé‚£ä¹ˆæ€è€ƒæ—¶ï¼ŒåŒºé—´ä¼šè¢«å¤šæ¬¡è¿›è¡Œæ‰¾å—ã€æ¢ä½çš„æ“ä½œï¼Œè¿™ä¸ªå¼¯ç»•ä¸è¿‡å»ï¼Œè¿™åº”è¯¥ä¹Ÿæ˜¯å¤šæ•°è´ªå¿ƒå…·æœ‰çš„ç‰¹ç‚¹ã€‚æˆ‘æ ¹æ®ä¸€å¼€å§‹çš„æƒ³æ³•å†™ï¼Œå¤šæ¬¡åŒºé—´çš„æ“ä½œè¿™ç‚¹è¾¾ä¸åˆ°ï¼Œå°±waäº†ã€‚ã€‚ã€‚</p><p>æ­£è§£éå¸¸ä¼˜ç¾ï¼Œå‘ç° 1 ç•…é€šæ— é˜»ï¼Œå¯ä»¥ä»»æ„ç§»åŠ¨ï¼Œ0 å’Œ 2 ä¸å¯èƒ½äº¤æ¢ç›¸å¯¹ä½ç½®ï¼Œä¾‹å¦‚ 0 åœ¨ 2 å‰é¢ï¼Œé‚£ä¹ˆå°±ä¸å¯èƒ½é€šè¿‡ç§»åŠ¨è¾¾åˆ° 0 åœ¨ 2 åé¢ã€‚</p><p>ä¸ºäº†è¾¾åˆ°å­—å…¸åºæœ€å°ï¼Œç¬¬ä¸€ä¸ª 2 å‰çš„ 0 ä»¬åº”è¯¥ç§»åˆ°æœ€å‰é¢ï¼Œæ‰€æœ‰çš„ 1 éƒ½è¦ç§»åˆ°ç¬¬ä¸€ä¸ª 2 å‰é¢ï¼Œç¬¬ä¸€ä¸ª 2 å‰é¢çš„ 0 ä»¬çš„åé¢ï¼Œç¬¬ä¸€ä¸ª 2 åé¢çš„ 0 å’Œ 2 ä¿æŒä¸å˜ã€‚</p><p>ç„¶åï¼Œè¦æ³¨æ„æ•´ä¸ªåºåˆ—æ²¡æœ‰ 2 çš„æƒ…å†µã€‚</p><p>ç»“æœï¼ŒçŸ¥é“ç®—æ³•è¿˜å†™æŒ‚äº†ã€‚ã€‚ã€‚ã€‚è¢« hack çš„æ„Ÿè§‰å°±æ˜¯è¿™æ ·çš„å—ï¼Ÿï¼ˆå› ä¸ºæˆ‘åˆ¤æ–­ï¼Œå¦‚æœåºåˆ—é‡Œæœ‰ 2 ï¼Œå°±åœ¨è¾“å‡ºç¬¬ä¸€ä¸ª 2 å‰é¢çš„å…ƒç´ åè¾“å‡ºä¸€ä¸ª 2ã€‚æœ‰æ—  2 éƒ½ä»ç¬¬ä¸€ä¸ª 2 çš„ä½ç½®ï¼ˆå¦‚æœæ²¡æœ‰å°±æ˜¯ nï¼‰å¼€å§‹ for åˆ° nï¼Œè¾“å‡ºæ‰€æœ‰ä¸æ˜¯ 1 çš„å…ƒç´ ï¼Œä½†å¦‚æœåºåˆ—é‡Œæ²¡æœ‰ 2ï¼Œn çš„ä½ç½®ä¸Šåˆæ˜¯ 0ï¼Œå²‚ä¸æ˜¯å¤šè¾“äº†ä¸€ä¸ª 0ã€‚ï¼‰</p><h3 id="C-Annoying-Present"><a href="#C-Annoying-Present" class="headerlink" title="C. Annoying Present"></a>C. Annoying Present</h3><hr><p>é¢˜æ„ï¼šä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•°ç»„ï¼ˆåˆå§‹å…¨ä¸º0ï¼‰ï¼Œè¿›è¡Œ m æ¬¡æ“ä½œã€‚<br>æ“ä½œï¼šç»™ä½  m ä¸ª xã€dï¼Œä½ ä»»æ„æŒ‘é€‰ä¸€ä¸ª i (1~n)ï¼Œæ¯ä¸ªæ•°å­—åŠ ä¸Š x + |i - j| * dï¼ˆ j è¡¨ç¤ºå¯¹åº”æ•°å­—çš„ä¸‹æ ‡ï¼‰<br>é—® m æ¬¡æ“ä½œåçš„æœ€å¤§ç®—æœ¯å¹³å‡å€¼ä¸ºå¤šå°‘ï¼Ÿ</p><p>æ°´é¢˜ï¼Œä¸€çœ‹å°±æœ‰æƒ³æ³•ï¼ˆã€‚ã€‚ã€‚ï¼‰é¦–å…ˆæ¯ä¸ªä½ç½®çš„æ•°ç»„éƒ½åº”åŠ ä¸Š $\sum_{i = 1}^n x_i$ ï¼Œç„¶åè€ƒè™‘ 1 ï½ m çš„ dï¼Œè‹¥ &lt; 0 ï¼Œé‚£ä¹ˆåªèƒ½å¯¹æ•´ä¸ªåºåˆ—çš„å¹³å‡å€¼äº§ç”Ÿä¸å¥½çš„å½±å“ï¼Œæˆ‘ä»¬åº”è¯¥æŠŠè¿™ç§å½±å“é™åˆ°æœ€ä½ï¼Œä¹Ÿå°±æ˜¯ $d * (\sum_{j = 1}^n |pos - j|)$ æœ€å°ï¼Œé‚£ä¹ˆ pos è‚¯å®šæ˜¯è¶Šé ä¸­é—´è¶Šå¥½ï¼Œå³ n æˆ– 1ï¼›è‹¥ d &gt; 0 ï¼Œé‚£ä¹ˆè‚¯å®š pos è¶Šé ä¸¤è¾¹è¶Šå¥½ã€‚æå‰è®°å½• n åˆ°æ¯ä¸ªä½ç½®çš„è·ç¦»å’Œä¸ (n + 1) / 2 åˆ°æ¯ä¸ªä½ç½®çš„è·ç¦»å’Œå³å¯ã€‚æ³¨æ„ long longã€‚</p><h3 id="D-Relatively-Prime-Graph"><a href="#D-Relatively-Prime-Graph" class="headerlink" title="D. Relatively Prime Graph"></a>D. Relatively Prime Graph</h3><hr><p>é¢˜æ„ï¼šæ„é€ ä¸€ä¸ª n ä¸ªç‚¹ m æ¡è¾¹çš„å›¾ï¼Œè¦æ±‚ï¼šå›¾è”é€šï¼ŒGCD(uï¼Œv) = 1ï¼Œ u ã€ vä¹‹é—´æ‰å¯ä»¥å»ºè¾¹ã€‚èŠ‚ç‚¹åˆ†åˆ«ä¸º 1 ï½ nã€‚</p><p>ç”±æ¬§æ‹‰å‡½æ•°è¡¨ $\phi(n)$ å¯å¾—ï¼Œ573ä»¥å†…äº’è´¨çš„å¯¹æ•°å°±å·²ç»è¶…è¿‡ 1e5 äº†ï¼Œæš´åŠ›æšä¸¾å³å¯ã€‚</p><p>é¦–å…ˆ 1 åˆ°ä»»ä½•ç‚¹éƒ½å¯ä»¥è¿ä¸€æ¡è¾¹ï¼Œè¿™æ ·å°±èƒ½ä¿è¯å›¾è¿é€šäº†ã€‚æ¥ç€å†æ ¹æ®ä¸Šé¢çš„ç»“è®ºï¼Œç¡®å®šè¯¥ç®—æ³•ä¸ä¼šè¶…æ—¶ã€‚</p><p>å½“ç„¶è¿™éœ€è¦è¶³å¤Ÿçš„æ•°æ„Ÿå’Œä¼°ç®—æŠ€å·§(?)</p><p>CODEï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="built_in">vector</span>&lt;pii&gt; ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n &amp;&amp; ans.size() &lt; m; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= n &amp;&amp; ans.size() &lt; m; j++)</span><br><span class="line">            <span class="keyword">if</span> (__gcd(i, j) == <span class="number">1</span>)</span><br><span class="line">                ans.push_back(make_pair(i, j));</span><br><span class="line">    <span class="keyword">if</span> (m &lt; n - <span class="number">1</span> || ans.size() &lt; m) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Impossible\n"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Possible\n"</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)ans.size(); i++)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>, ans[i].first, ans[i].second);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="E-Intercity-Travelling"><a href="#E-Intercity-Travelling" class="headerlink" title="E. Intercity Travelling"></a>E. Intercity Travelling</h3><hr><p>é¢˜æ„ï¼šLehaä»æ•°è½´çš„ 0 åˆ° n ï¼Œä¸­é—´çš„æ•´æ•°ç‚¹éƒ½æœ‰å¯èƒ½æœ‰ä¼‘æ¯ç‚¹ä¹Ÿå¯èƒ½æ²¡æœ‰ä¼‘æ¯ç‚¹ã€‚å½“ä½ è¿ç»­å k ç«™æ—¶ï¼Œæ¯ä¸¤ç«™é—´çš„ç–²åŠ³å€¼ä¸º a1, a2 â€¦â€¦ akï¼Œå¦‚æœç¬¬ k ç«™æœ‰ä¼‘æ¯ç‚¹ï¼Œé‚£ä¹ˆä½ å¯ä»¥åœ¨æ­¤å¤„ä¼‘æ¯ï¼Œç„¶åæ¥ä¸‹æ¥çš„ç«™ç‚¹çš„ç–²åŠ³å€¼åˆä» a1 å¼€å§‹ï¼Œå¦åˆ™ç»§ç»­ä¸º ak + 1ã€‚é¢˜ç›®ç»™ä½  n å’Œ aiï¼Œæ¯ä¸ªç«™ç‚¹æœ‰ä¼‘æ¯ç‚¹çš„æ¦‚ç‡éƒ½æ˜¯ 1/2ï¼Œé—®ä½ æœŸæœ›å€¼ * 2 ^ (n - 1) çš„å€¼ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ä» 0 åˆ° 1 çš„ç–²åŠ³å€¼å¿…å®šä¸º a1ï¼Œä» 1 åˆ° 2 çš„ç–²åŠ³å€¼ä¸º a1(1 / 2) æˆ– a2(1 / 2) ï¼Œä» 2 åˆ° 3 çš„ç–²åŠ³å€¼ä¸º a1(1 / 2) , a2(1 / 4), </p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[POJ1201]-Intervals</title>
      <link href="2018/07/11/%5BPOJ1201%5D-Intervals/"/>
      <url>2018/07/11/%5BPOJ1201%5D-Intervals/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vjudge.net/problem/POJ-1201" target="_blank" rel="noopener">https://vjudge.net/problem/POJ-1201</a></p><p>é¢˜æ„ï¼šä» 0 ï½ 50000 ä¸­é€‰å‡ºå°½é‡å°‘çš„æ•´æ•°ï¼Œä½¿æ¯ä¸ªåŒºé—´ $[a_i, b_i]$ å†…éƒ½æœ‰è‡³å°‘ $c_i$ ä¸ªæ•°è¢«é€‰ã€‚</p><p>åˆ†ææ¡ä»¶ï¼š<br>è®¾ $s[k]$ è¡¨ç¤º 0 ï½ k ä¹‹é—´æœ€å°‘é€‰å‡ºå¤šå°‘ä¸ªæ•°ï¼Œé‚£ä¹ˆï¼š</p><p>$$s[b_i] - s[a_i - 1] \geq c_i$$</p><p>è¶…çº§æ˜æ˜¾çš„å·®åˆ†çº¦æŸç³»ç»Ÿï¼Ÿ</p><p>é‚£ä¹ˆï¼Œæˆ‘ä»¬è¿˜è¦åˆ›é€ ä¸€äº›åˆå§‹åŒ–çš„æ¡ä»¶ï¼Œå¯ä»¥æ ¹æ®é¢˜ç›®ä¸­éšå«çš„æ¡ä»¶æ¥ï¼š</p><ol><li>$s[k] - s[k - 1] \geq 0$</li><li>$s[k] - s[k - 1] \leq 1$</li></ol><p>å› æ­¤ï¼Œæˆ‘ä»¬æŠŠ -1 ï½ 50000 è¿™ 50002 ä¸ªæ•´æ•°åˆ†åˆ«ä½œä¸ºå›¾ä¸­çš„èŠ‚ç‚¹ï¼Œä»æ¯ä¸ª k - 1 åˆ° k è¿é•¿åº¦ä¸º 0 çš„æœ‰å‘è¾¹ï¼Œ k åˆ° k - 1 è¿é•¿åº¦ä¸º -1 çš„æœ‰å‘è¾¹ï¼Œä»æ¯ä¸ª $a_i - 1$ åˆ° $b_i$ è¿é•¿åº¦ä¸º $c_i$ çš„æœ‰å‘è¾¹ã€‚</p><p>å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å– $a_i - 1$ çš„æœ€å°å€¼ Minï¼Œ$b_i$ çš„æœ€å¤§å€¼ Maxï¼Œç„¶åä» Min åˆ° Max è¿åˆå§‹è¾¹ã€‚æ±‚å®Œåï¼Œs[Max] å³ä¸ºç­”æ¡ˆã€‚</p><p>ä¸è¿‡ï¼Œæ—¢ç„¶ä¸åŒºé—´æœ‰å…³ï¼Œåº”è¯¥ä¹Ÿå¯ä»¥ç”¨è´ªå¿ƒæ±‚è§£ï¼Œå¹¶ç”¨æ•°æ®ç»“æ„è¿›è¡Œä¼˜åŒ–ï¼Œå¯ä»¥è€ƒè™‘ä¸€ä¸‹ã€‚</p><p>CODEï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e4</span> + <span class="number">5</span>, inf = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> n, dis[N], inq[N], Min = inf, Max = -inf;</span><br><span class="line"><span class="keyword">int</span> to[N &lt;&lt; <span class="number">1</span>], nxt[N &lt;&lt; <span class="number">1</span>], val[N &lt;&lt; <span class="number">1</span>], lnk[N], cnt;</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v, <span class="keyword">int</span> w)</span> </span>&#123;</span><br><span class="line">    to[++cnt] = v, nxt[cnt] = lnk[u], lnk[u] = cnt, val[cnt] = w;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">spfa</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Min; i &lt;= Max; i++) dis[i] = -inf;</span><br><span class="line">    dis[Min] = <span class="number">0</span>;</span><br><span class="line">    inq[Min] = <span class="number">0</span>;</span><br><span class="line">    q.push(Min);</span><br><span class="line">    <span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">        <span class="keyword">int</span> u = q.front();</span><br><span class="line">        q.pop();</span><br><span class="line">        inq[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[u]; i; i = nxt[i]) &#123;</span><br><span class="line">            <span class="keyword">int</span> y = to[i];</span><br><span class="line">            <span class="keyword">if</span> (dis[y] &lt; dis[u] + val[i]) &#123;</span><br><span class="line">                dis[y] = dis[u] + val[i];</span><br><span class="line">                <span class="keyword">if</span> (!inq[y]) &#123;</span><br><span class="line">                    q.push(y);</span><br><span class="line">                    inq[y] = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> a, b, c;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;a, &amp;b, &amp;c);</span><br><span class="line">        add(a, b + <span class="number">1</span>, c);</span><br><span class="line">        Min = min(Min, a);</span><br><span class="line">        Max = max(Max, b + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = Min; i &lt; Max; i++) &#123;</span><br><span class="line">        add(i, i + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        add(i + <span class="number">1</span>, i, <span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    spfa();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, dis[Max]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å·®åˆ† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[NOIP2012]-ç–«æƒ…æ§åˆ¶</title>
      <link href="2018/07/10/%5BNOIP2012%5D-%E7%96%AB%E6%83%85%E6%8E%A7%E5%88%B6/"/>
      <url>2018/07/10/%5BNOIP2012%5D-%E7%96%AB%E6%83%85%E6%8E%A7%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<p>æŒºå¦™ï¼ˆçƒ¦ï¼‰çš„ï¼</p><p>å¤§è‡´æ€è·¯å¾ˆå¥½æ„å»ºï¼šäºŒåˆ†ç­”æ¡ˆï¼Œè´ªå¿ƒä¸Šè·³ã€‚è·³ä¸åˆ°æ ¹çš„å°±è®©å®ƒåœåœ¨é‚£ï¼Œèƒ½è·³åˆ°çš„å°±è¦è€ƒè™‘äº’ç›¸æ•‘åŠ©äº†ã€‚</p><p>ä½†æ˜¯æ€ä¹ˆçŸ¥é“ï¼Œå¦‚æœæˆ‘é€‰æ‹©æ•‘åŠ©åˆ«çš„å­æ ‘ï¼Œæƒ…å†µä¼šä¸ä¼šå˜åŠ£ï¼Ÿ</p><p>æœ‰ä¸ªå¾ˆé‡è¦çš„ç»“è®ºï¼šå¦‚æœæˆ‘åˆ°æ ¹åå‰©ä½™çš„æ­¥æ•°å°äºæˆ‘ä»æ ¹èµ°å›åˆ°æ‰€åœ¨å­æ ‘çš„è·ç¦»ï¼Œé‚£æˆ‘å°±ä¸è·³åˆ°æ ¹ï¼Œç•™åœ¨å·®ä¸€æ­¥çš„å­æ ‘é¡¶ã€‚è¿™ä¸ªè¿˜æŒºå®¹æ˜“ yyï¼Œå› ä¸ºä¼šä½¿åé¢æ›´å¤§çš„å‰©ä½™æ­¥æ•°æµªè´¹æ‰ã€‚å¦åˆ™é‚£æˆ‘å°±è·³å‘—ã€‚</p><p>å¯æ˜¯ä¸ºä»€ä¹ˆæˆ‘è·³ï¼Œç­”æ¡ˆä¸ä¼šå˜åŠ£ï¼Ÿ</p><p>å…¶å®æ˜¯è¦åˆ†ç±»è®¨è®ºçš„ã€‚å°†éœ€è¦æ•‘åŠ©çš„å­æ ‘é¡¶åˆ°æ ¹çš„è·ç¦»æ’åºï¼Œå°†å‰©ä½™æ­¥æ•°æ’åºã€‚å‰©ä½™æ­¥æ•°æ’åå’Œéœ€è¦æ•‘åŠ©çš„æ­¥æ•°æ’åä¸€ä¸€å¯¹åº”ï¼Œæ˜¾ç„¶ä¸åŠ£ï¼›é”™å¼€ï¼Œå‘ç°å°±å½±å“ä¸­é—´ä¸€æ®µï¼›è€Œå‰è€…æ¯”åè€…å¥½çš„æ—¶å€™æ˜¾ç„¶ä¸åŠ£ï¼›å‰è€…æ¯”åè€…å·®çš„æƒ…å†µæ ¹æœ¬å°±ä¸å­˜åœ¨ï¼Œå› ä¸ºå¤§å°å…³ç³»ä¸å¯¹åŠ²ã€‚</p><p>æ‰€ä»¥å°±è·³ï¼</p><p>è¯æ˜è¿˜æŒºå®¹æ˜“ï¼Œä½†æ˜¯æ€ä¹ˆæƒ³åˆ°å•Š /kk</p><p><a href="https://www.luogu.com.cn/record/42699241" target="_blank" rel="noopener">$Code$</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> æœ€è¿‘å…¬å…±ç¥–å…ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[BZOJ1977]-æ¬¡å°ç”Ÿæˆæ ‘</title>
      <link href="2018/07/10/%5BBZOJ1977%5D-%E6%AC%A1%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/"/>
      <url>2018/07/10/%5BBZOJ1977%5D-%E6%AC%A1%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vjudge.net/problem/HYSBZ-1977" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>é¢˜æ„ï¼šç»™å®šä¸€å¼  $n$ ç‚¹ $m$ è¾¹çš„æ— å‘å›¾ï¼Œæ±‚æ— å‘å›¾çš„ä¸¥æ ¼æ¬¡å°ç”Ÿæˆæ ‘çš„è¾¹æƒä¹‹å’Œã€‚</p><p>é¦–å…ˆæ±‚å‡ºæœ€å°ç”Ÿæˆæ ‘çš„è¾¹æƒä¹‹å’Œ $sum$ã€‚æˆ‘ä»¬ç§°æœ€å°ç”Ÿæˆæ ‘çš„ $n - 1$ æ¡è¾¹ä¸ºæ ‘è¾¹ï¼Œå‰©ä½™ $m - n + 1$ æ¡è¾¹ä¸ºéæ ‘è¾¹ã€‚</p><p>æŠŠä¸€æ¡éæ ‘è¾¹ $(x, y, z)$ åŠ å…¥åˆ°æœ€å°ç”Ÿæˆæ ‘ä¸­ï¼Œä¼šä¸æ ‘ä¸Š $x$, $y$ ä¹‹é—´çš„è·¯å¾„å½¢æˆä¸€ä¸ªç¯ã€‚è®¾æ ‘ä¸Š $x$, $y$ ä¹‹é—´çš„è·¯å¾„ä¸Šçš„æœ€å¤§è¾¹æƒä¸º $val1$ï¼Œä¸¥æ ¼æ¬¡å¤§è¾¹æƒä¸º $val2$ã€‚</p><p>è‹¥ $z &gt; val1$, åˆ™æŠŠ $val1$ å¯¹åº”çš„é‚£æ¡è¾¹æ›¿æ¢æˆ $(x, y, z)$ è¿™æ¡è¾¹ï¼Œå°±å¾—åˆ°äº†ä¸¥æ ¼æ¬¡å°ç”Ÿæˆæ ‘çš„ä¸€ä¸ªå€™é€‰ç­”æ¡ˆï¼Œè¾¹æƒä¹‹å’Œä¸º $sum - val1 + z$ ã€‚</p><p>è‹¥ $z = val1$, åˆ™æŠŠ $val2$ å¯¹åº”çš„é‚£æ¡è¾¹æ›¿æ¢æˆ $(x, y, z)$ è¿™æ¡è¾¹ï¼Œå°±å¾—åˆ°äº†ä¸¥æ ¼æ¬¡å°ç”Ÿæˆæ ‘çš„ä¸€ä¸ªå€™é€‰ç­”æ¡ˆï¼Œè¾¹æƒä¹‹å’Œä¸º $sum - val2 + z$ ã€‚</p><p>å¦‚ä¸Šè¿°æšä¸¾æ‰€æœ‰éæ ‘è¾¹ï¼Œè®¡ç®—å‡ºæ‰€æœ‰å€™é€‰ç­”æ¡ˆï¼Œå–æœ€å°å€¼å³ä¸ºæœ¬é¢˜æ‰€æ±‚ã€‚</p><p>é‚£ä¹ˆç°åœ¨çš„é—®é¢˜å°±æ˜¯ï¼šå¦‚ä½•å¿«é€Ÿæ±‚å‡ºä¸€æ¡è·¯å¾„ä¸Šçš„æœ€å¤§è¾¹æƒä¸ä¸¥æ ¼æ¬¡å¤§è¾¹æƒã€‚</p><p>å¯ä»¥ç”¨æ ‘ä¸Šå€å¢ç®—æ³•æ¥è¿›è¡Œé¢„å¤„ç†ã€‚è®¾ $F[x, k]$ è¡¨ç¤º $x$ çš„ $2^k$ ç¥–å…ˆï¼Œ$G[x, k, 0]$ ä¸ $G[x, k, 1]$ åˆ†åˆ«è¡¨ç¤º $x$ åˆ° $F[x, k]$ çš„è·¯å¾„ä¸Šçš„æœ€å¤§è¾¹æƒå’Œä¸¥æ ¼æ¬¡å¤§è¾¹æƒã€‚äºæ˜¯ $k \in [1, log\ N]$ æœ‰ï¼š</p><p>$$F[x, k] = F[F[x, k - 1], k - 1]$$</p><p>$$G[x, k, 0] = max(G[x, k - 1, 0], G[F[x, k - 1], k - 1, 0])$$</p><p>$$G[x, k, 1] = max(G[x, k - 1, 1], G[F[x, k - 1], k - 1, 1])$$</p><p>å¦‚æœ $G[x, k - 1, 0] \neq G[F[x, k - 1], k - 1, 0]$ ï¼Œ é‚£ä¹ˆï¼š</p><p>$$G[x, k, 1] = max(G[x, k, 1], min(G[x, k - 1, 0], G[F[x, k - 1], k - 1, 0]))$$</p><p>å½“ $k = 0$ æ—¶ï¼Œæœ‰åˆå€¼ï¼š</p><p>$$F[x, 0] = father(x)$$</p><p>$$G[x, 0, 0] = edge(x, father(x))$$</p><p>$$G[x, 0, 1] = -\infty$$</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è€ƒè™‘æ¯æ¡éæ ‘è¾¹ $(x, y, z)$ ï¼Œé‡‡ç”¨å€å¢ LCA çš„æ¡†æ¶ï¼Œ$x$ã€$y$ æ¯å‘ä¸Šç§»åŠ¨ä¸€æ®µè·¯å¾„ï¼Œå°±å°†è¯¥è·¯å¾„å¯¹åº”çš„æœ€å¤§è¾¹æƒå’Œä¸¥æ ¼æ¬¡å¤§è¾¹æƒæŒ‰ç…§ä¸æ±‚ $G$ æ•°ç»„ç±»ä¼¼çš„æ–¹æ³•åˆå¹¶åˆ°ç­”æ¡ˆä¸­ã€‚</p><p>$O(M\ log\ N)$.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> M 300010</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> inf 0x7fffffff</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, o, minn = inf;</span><br><span class="line"><span class="keyword">int</span> to[M &lt;&lt; <span class="number">1</span>], nxt[M &lt;&lt; <span class="number">1</span>], val[M &lt;&lt; <span class="number">1</span>], lnk[N], cnt;</span><br><span class="line"><span class="keyword">int</span> fa[N], d[N], f[N][<span class="number">20</span>], G[N][<span class="number">20</span>][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">bool</span> vis[M];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> sum;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> x, y, z;</span><br><span class="line">&#125;e[M];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span> </span>&#123;</span><br><span class="line">    to[++cnt] = y, val[cnt] = z, nxt[cnt] = lnk[x], lnk[x] = cnt;</span><br><span class="line">    to[++cnt] = x, val[cnt] = z, nxt[cnt] = lnk[y], lnk[y] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getfa</span><span class="params">(<span class="keyword">int</span> w)</span> </span>&#123;<span class="keyword">return</span> fa[w] == w ? w : fa[w] = getfa(fa[w]);&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(edge a, edge b)</span> </span>&#123;<span class="keyword">return</span> a.z &lt; b.z;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">kruskal</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    sort(e + <span class="number">1</span>, e + m + <span class="number">1</span>, cmp);</span><br><span class="line">    <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> fx = getfa(e[i].x), fy = getfa(e[i].y);</span><br><span class="line">        <span class="keyword">if</span> (fx == fy) <span class="keyword">continue</span>;</span><br><span class="line">        fa[fx] = fy;</span><br><span class="line">        sum += e[i].z;</span><br><span class="line">        add(e[i].x, e[i].y, e[i].z);</span><br><span class="line">        vis[i] = <span class="number">1</span>;</span><br><span class="line">        num++;</span><br><span class="line">        <span class="keyword">if</span> (num == n - <span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    f[x][<span class="number">0</span>] = fa;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = nxt[i]) &#123;</span><br><span class="line">        <span class="keyword">int</span> y = to[i];</span><br><span class="line">        <span class="keyword">if</span> (y != fa) &#123;</span><br><span class="line">            d[y] = d[x] + <span class="number">1</span>;</span><br><span class="line">            G[y][<span class="number">0</span>][<span class="number">0</span>] = val[i];</span><br><span class="line">            G[y][<span class="number">0</span>][<span class="number">1</span>] = -inf;</span><br><span class="line">            dfs(y, x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">beizeng</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">18</span>; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</span><br><span class="line">            f[j][i] = f[f[j][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">            G[j][i][<span class="number">0</span>] = max(G[j][i - <span class="number">1</span>][<span class="number">0</span>], G[f[j][i - <span class="number">1</span>]][i - <span class="number">1</span>][<span class="number">0</span>]);</span><br><span class="line">            G[j][i][<span class="number">1</span>] = max(G[j][i - <span class="number">1</span>][<span class="number">1</span>], G[f[j][i - <span class="number">1</span>]][i - <span class="number">1</span>][<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">if</span> (G[j][i - <span class="number">1</span>][<span class="number">0</span>] != G[f[j][i - <span class="number">1</span>]][i - <span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line">                G[j][i][<span class="number">1</span>] = max(G[j][i][<span class="number">1</span>], min(G[f[j][i - <span class="number">1</span>]][i - <span class="number">1</span>][<span class="number">0</span>], G[j][i - <span class="number">1</span>][<span class="number">0</span>]));</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (d[x] &lt; d[y]) swap(x, y);</span><br><span class="line">    <span class="keyword">int</span> t = d[x] - d[y];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">18</span>; i++)</span><br><span class="line">        <span class="keyword">if</span> ((<span class="number">1</span> &lt;&lt; i) &amp; t) x = f[x][i];</span><br><span class="line">    <span class="keyword">if</span> (x == y) <span class="keyword">return</span> x;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">18</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">        <span class="keyword">if</span> (f[x][i] != f[y][i]) x = f[x][i], y = f[y][i];</span><br><span class="line">    <span class="keyword">return</span> f[x][<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> xy, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mx1 = <span class="number">0</span>, mx2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> dis = d[x] - d[xy];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">20</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dis &amp; (<span class="number">1</span> &lt;&lt; i)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (G[x][i][<span class="number">0</span>] &gt; mx1) mx2 = mx1, mx1 = G[x][i][<span class="number">0</span>];</span><br><span class="line">            mx2 = max(mx2, G[x][i][<span class="number">1</span>]);</span><br><span class="line">            x = f[x][i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (mx1 != v) minn = min(minn, v - mx1);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        minn = min(minn, v - mx2);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) fa[i] = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;e[i].x, &amp;e[i].y, &amp;e[i].z);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">    kruskal();</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    beizeng();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (vis[i] == <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">int</span> x = e[i].x, y = e[i].y, xy = lca(x, y);</span><br><span class="line">        calc(x, xy, e[i].z), calc(y, xy, e[i].z);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, sum + minn);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å”‰ï¼Œè¯è¯´è¿™ç¯‡ä»£ç çœŸè®©æˆ‘è°ƒå¾—å¤Ÿå‘›ã€‚ã€‚ã€‚WAäº†å…­å‘ä¸æ­¢ã€‚ã€‚ã€‚æœ€åå‘ç°å¤§æ¦‚æ˜¯è®¡ç®— F æ•°ç»„å’Œ G æ•°ç»„è¿˜æœ‰ beizeng() é¢„å¤„ç†å‡½æ•°çš„é—®é¢˜ï¼Œå¦å¤– lca åˆšå¼€å¤´æ·±åº¦çš„æ¯”è¾ƒä¸è°ƒæ¢ä¹Ÿé”™äº†ã€‚ã€‚ã€‚</p><p>ä¸è¿‡ï¼è¶æœºå­¦ä¹ äº†ä¸€å‘å¯¹æ‹ï½ï½ï½è¿˜æ˜¯å¾ˆæœ‰æ”¶è·æ»´ï½ï½ï½</p><p>è°ƒè¯•å˜éš¾äº†ä¸ä»…æ˜¯é”™è¯¯ç™¾å‡ºçš„åŸå› ï¼Œè¿˜æœ‰æœ€è¿‘å›¾è®ºä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œå› ä¸ºå›¾è®ºæœ¬å°±æ˜¯æŠ½è±¡çš„æ¦‚å¿µï¼Œä½†å¤šåšé¢˜ä¸€å®šä¼šæœ‰æ‰€æ”¹å–„çš„ï¼å·²ç»æ„Ÿè§‰åˆ°äº†= =</p>]]></content>
      
      
      
        <tags>
            
            <tag> æœ€è¿‘å…¬å…±ç¥–å…ˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[NOIP2007]-æ ‘ç½‘çš„æ ¸</title>
      <link href="2018/07/10/%5BNOIP2007%5D-%E6%A0%91%E7%BD%91%E7%9A%84%E6%A0%B8/"/>
      <url>2018/07/10/%5BNOIP2007%5D-%E6%A0%91%E7%BD%91%E7%9A%84%E6%A0%B8/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vjudge.net/problem/HYSBZ-1999" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>é¢˜æ„ï¼šè¯´ä¸æ¸…ã€‚ã€‚ã€‚çœ‹åŸé¢˜å§?</p><p>NOIP æ•°æ®å¯ä»¥ç›´æ¥ä¸Šæœ´ç´ ç®—æ³•ï¼Œ$O(n^3)$ ã€‚é¦–å…ˆé€šè¿‡ä¸¤æ¬¡ BFS æˆ– DFS æ±‚å‡ºæ ‘çš„ç›´å¾„ï¼Œç„¶ååœ¨ç›´å¾„ä¸Šæšä¸¾è·ç¦»ä¸è¶…è¿‡ $s$ çš„ä¸¤ä¸ªç‚¹ $p$ å’Œ $q$ ï¼Œ$p$ã€$q$ ä¹‹é—´çš„è·¯å¾„å°±æ˜¯æ ‘ç½‘çš„æ ¸ã€‚å…ˆå°†æ ¸ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹æ ‡è®°ä¸ºâ€œå·²è®¿é—®â€ï¼Œç„¶åä»æ ¸ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹å‡ºå‘ï¼Œæ‰§è¡Œæ·±æœï¼Œæ±‚å‡ºåå¿ƒè·æœ€å¤§å€¼å³ä¸ºåå¿ƒè·ã€‚</p><p>ç¨åŠ è§‚å¯Ÿï¼Œ$p$ã€$q$ ä¹‹é—´çš„è·ç¦»è‚¯å®šæ˜¯è¶Šå¤§è¶Šå¥½ï¼Œæ‰€ä»¥åªè¦æšä¸¾ $p$ å°±è¡Œäº†ï¼Œ$q = p + s$ã€‚ $O(n^2)$ ã€‚</p><p>ç„¶é¹…è¿™æ ·è¿˜æ˜¯è¿‡ä¸äº† BZ çš„æ•°æ®ã€‚ã€‚</p><p>å‘ç°ï¼Œæœ¬é¢˜çš„ç­”æ¡ˆå…·æœ‰å•è°ƒæ€§ï¼Œå¯ä»¥äºŒåˆ†ç­”æ¡ˆï¼ŒæŠŠé—®é¢˜è½¬åŒ–ä¸ºâ€œéªŒè¯æ˜¯å¦å­˜åœ¨ä¸€ä¸ªæ ¸ï¼Œå…¶åå¿ƒè·ä¸è¶…è¿‡äºŒåˆ†çš„å€¼ $mid$â€ ã€‚</p><p>è®¾ç›´å¾„çš„ä¸¤ä¸ªç«¯ç‚¹ä¸º $u$ å’Œ $v$ ï¼Œåœ¨ç›´å¾„ä¸Šæ‰¾åˆ°ä¸ $u$ çš„è·ç¦»ä¸è¶…è¿‡ $mid$ çš„å‰æä¸‹ï¼Œè·ç¦»æœ€è¿œçš„èŠ‚ç‚¹ï¼Œä½œä¸ºèŠ‚ç‚¹ $p$ã€‚ç±»ä¼¼åœ°æ‰¾åˆ°ä¸ $v$ çš„è·ç¦»ä¸è¶…è¿‡ $mid$ çš„å‰æä¸‹ï¼Œè·ç¦»æœ€è¿œçš„èŠ‚ç‚¹ï¼Œä½œä¸ºèŠ‚ç‚¹ $q$ã€‚</p><p>æ ¹æ®ç›´å¾„çš„æœ€é•¿æ€§ï¼ˆæ ‡é»‘åŠ ç²—ï¼ï¼‰ï¼Œä»»ä½•ä» $u$ã€$p$ ä¹‹é—´åˆ†å‰ç¦»å¼€ç›´å¾„çš„å­æ ‘ï¼Œå…¶æœ€è¿œç‚¹ä¸ $p$ çš„è·ç¦»éƒ½ä¸ä¼šæ¯” $u$ æ›´è¿œã€‚æ‰€ä»¥ $p$ã€$q$ å°±æ˜¯æ»¡è¶³ç›´å¾„ä¸¤ä¾§çš„é‚£éƒ¨åˆ†èŠ‚ç‚¹åå¿ƒè·ä¸è¶…è¿‡ $mid$ çš„å‰æä¸‹ã€å°½é‡é è¿‘æ ‘ç½‘ä¸­å¿ƒçš„èŠ‚ç‚¹ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯æ£€æŸ¥ $p$ã€$q$ çš„è·ç¦»æ˜¯å¦ä¸è¶…è¿‡ $$s ï¼ŒåŒæ—¶ç”¨æ·±æœæ£€æŸ¥ç¦»æ ¸æœ€è¿œçš„ç‚¹çš„è·ç¦»æ˜¯å¦ä¹Ÿä¸è¶…è¿‡ $s$ã€‚å¦‚æœä¸¤ä¸ªæ¡ä»¶éƒ½æ»¡è¶³ï¼Œ$p$ã€$q$ ä¹‹é—´çš„è·¯å¾„å°±æ˜¯åå¿ƒè·ä¸è¶…è¿‡ $mid$ çš„ä¸€ä¸ªåˆæ³•çš„æ ¸ã€‚</p><p>è¯¥ç®—æ³• $O(n log SUM)$ ï¼Œå…¶ä¸­ $SUM$ è¡¨ç¤ºæ ‘ç½‘æ‰€æœ‰è¾¹çš„é•¿åº¦ä¹‹å’Œã€‚</p><p>æ®è¯´è¿˜æœ‰ä¸€ä¸ª $O(n)$ çš„ç®—æ³•ã€‚ç®—å‡º $d[u_i]$ ï¼Œè¡¨ç¤ºä»æ¯ä¸€ä¸ªç›´å¾„ä¸Šçš„èŠ‚ç‚¹ $u1$ ~ $ut$ ï¼Œä¸ç»è¿‡ç›´å¾„ä¸Šçš„å…¶ä»–èŠ‚ç‚¹ï¼Œèƒ½å¤Ÿåˆ°è¾¾çš„æœ€è¿œç‚¹çš„è·ç¦»ã€‚</p><p>æ‰€ä»¥å®é™…ä¸Šç­”æ¡ˆæ˜¯ï¼š</p><p>$$max(max_{i \leq k \leq j}{d[u_k]}, dist(u_1, u_i), dist(u_j, u_t))$$</p><p>ç”±äºç›´å¾„çš„æœ€é•¿æ€§ï¼ˆæ ‡é»‘åŠ ç²—ï¼ï¼‰ï¼Œä¸Šå¼å…¶å®å¯ç®€åŒ–ä¸ºï¼š</p><p>$$max(max_{1 \leq k \leq t}{d[u_k]}, dist(u_1, u_i), dist(u_j, u_t))$$</p><p>$max_{1 \leq k \leq t}{d[u_k]}$ æ˜¯å®šå€¼ï¼Œå¯ä»¥ç›´æ¥ç®—å‡ºã€‚</p><p>æ‰€ä»¥æœ€ååªè¦ç”¨æŒ‡é’ˆè®¡ç®—åä¸¤é¡¹ï¼Œå•è°ƒé€’å¢ï¼Œ$O(n)$ ï¼ï¼</p><p>æ‰€ä»¥è¯´ï¼Œç®—æ³•ä»æŸç§ç¨‹åº¦ä¸Šï¼Œè®¾è®¡ã€ä¼˜åŒ–æ˜¯æ°¸æ— æ­¢å¢ƒçš„å•Šï¼Œä¸€å®šè¦å¤šåŠ¨è„‘ï¼Œä¸è¦æ»¡è¶³äºACã€‚</p><p>$O(n log SUM)$.</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">5e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, s, cnt, fa[N], fc[N], dep[N], idx[N], sum[N];</span><br><span class="line"><span class="keyword">bool</span> used[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span><span class="keyword">int</span> to, val;&#125;;</span><br><span class="line"><span class="built_in">vector</span>&lt;edge&gt; nxt[N];</span><br><span class="line"><span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (!q.empty()) &#123;</span><br><span class="line">        <span class="keyword">int</span> u = q.front();</span><br><span class="line">        q.pop();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)nxt[u].size(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (dep[nxt[u][i].to] &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                dep[nxt[u][i].to] = dep[u] + nxt[u][i].val;</span><br><span class="line">                fa[nxt[u][i].to] = u, fc[nxt[u][i].to] = nxt[u][i].val;</span><br><span class="line">                q.push(nxt[u][i].to);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find_dia</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dep, <span class="number">-1</span>, <span class="keyword">sizeof</span>(dep));</span><br><span class="line">    q.push(x), dep[x] = <span class="number">0</span>;</span><br><span class="line">    bfs();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (dep[x] &lt; dep[i]) x = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">1</span>, r = cnt;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> y = x; l &lt; cnt &amp;&amp; y &gt;= sum[l + <span class="number">1</span>] - sum[l]; l++)</span><br><span class="line">        y -= sum[l + <span class="number">1</span>] - sum[l];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> y = x; r &gt; <span class="number">1</span> &amp;&amp; y &gt;= sum[r] - sum[r - <span class="number">1</span>]; r--)</span><br><span class="line">        y -= sum[r] - sum[r - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> sum[r] - sum[l] &lt;= s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; s;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> u, v, w;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v &gt;&gt; w;</span><br><span class="line">        nxt[u].push_back((edge)&#123;v, w&#125;), nxt[v].push_back((edge)&#123;u, w&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> s = find_dia(<span class="number">1</span>), t = find_dia(s), k = t;</span><br><span class="line">    <span class="keyword">for</span> (idx[++cnt] = k; k != s; k = fa[k]) &#123;</span><br><span class="line">        idx[++cnt] = fa[k], sum[cnt] = sum[cnt - <span class="number">1</span>] + fc[k];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> l = <span class="number">0</span>, r = dep[t];</span><br><span class="line">    <span class="built_in">memset</span>(dep, <span class="number">-1</span>, <span class="keyword">sizeof</span>(dep));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= cnt; i++) q.push(idx[i]), dep[idx[i]] = <span class="number">0</span>;</span><br><span class="line">    bfs();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) l = max(l, dep[i]);</span><br><span class="line">    <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (!check(mid)) l = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            r = mid;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; l &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ ‘çš„ç›´å¾„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[APIO2010]-å·¡é€»</title>
      <link href="2018/07/10/%5BAPIO2010%5D-%E5%B7%A1%E9%80%BB/"/>
      <url>2018/07/10/%5BAPIO2010%5D-%E5%B7%A1%E9%80%BB/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vjudge.net/problem/HYSBZ-1912" target="_blank" rel="noopener">https://vjudge.net/problem/HYSBZ-1912</a></p><p>é¢˜æ„ï¼šæœ‰ n ä¸ªæ‘åº„ç¼–å· 1 ï½ n ï¼Œæœ‰ n - 1 æ¡åŒå‘é“è·¯è¿æ¥å®ƒä»¬ï¼Œé•¿åº¦å‡ä¸º 1 ä¸ªå•ä½ã€‚ç¼–å·ä¸º 1 çš„æ‘åº„é‡Œè®¾ç«‹äº†è­¦å¯Ÿå±€ï¼Œå·¡è­¦è½¦æ¯å¤©ä»è­¦å¯Ÿå±€å‡ºå‘ï¼Œåˆ°æ‰€æœ‰çš„è·¯ä¸Šå·¡é€»ï¼Œæœ€åå›åˆ°è­¦å¯Ÿå±€ã€‚æ¯æ¡é“è·¯éƒ½éœ€è¦ç»è¿‡ä¸¤æ¬¡ã€‚ç°åœ¨ä¸ºäº†å‡å°‘æ€»çš„å·¡é€»è·ç¦»ï¼Œè¯¥åœ°åŒºå‡†å¤‡åœ¨è¿™äº›æ‘åº„ä¹‹é—´å»ºç«‹ K æ¡æ–°çš„é“è·¯ï¼Œä¸€æ¡æ–°é“è·¯ç”šè‡³å¯ä»¥æ˜¯ä¸€ä¸ªç¯ã€‚ç”±äºèµ„é‡‘æœ‰é™ï¼ŒK åªèƒ½æ˜¯ 1 æˆ– 2ã€‚å·¡è­¦è½¦å¿…é¡»ç»è¿‡æ–°å»ºçš„é“è·¯æ­£å¥½ä¸€æ¬¡ã€‚</p><p>ä¸å»ºç«‹æ–°çš„é“è·¯æ—¶ï¼Œè·¯çº¿æ€»é•¿åº¦ä¸º 2(n - 1) ã€‚å»ºç«‹ä¸€æ¡æ–°é“è·¯åï¼Œå› ä¸ºæ–°é“è·¯å¿…é¡»ç»è¿‡åˆšå¥½ä¸€æ¬¡ï¼Œæ‰€ä»¥åœ¨æ²¿ç€æ–°é“è·¯ (x, y) å·¡é€»åï¼Œå°±å¿…é¡»æ²¿ç€æ ‘ä¸Šä» y åˆ° x çš„è·¯å¾„å·¡é€»ä¸€éï¼Œæœ€ç»ˆå½¢æˆä¸€ä¸ªç¯ã€‚ç›¸å½“äºæ ‘ä¸Š x ä¸ y ä¹‹é—´çš„ä¸¤æ¡è·¯å¾„éƒ½åªéœ€ç»è¿‡ä¸€æ¬¡äº†ã€‚</p><p>å› æ­¤ï¼Œå½“ K = 1 æ—¶ï¼Œæˆ‘ä»¬æ‰¾åˆ°æ ‘çš„æœ€é•¿é“¾ï¼ˆ$L_1$ï¼‰ï¼Œåœ¨ä¸¤ä¸ªç«¯ç‚¹ä¹‹é—´åŠ ä¸€æ¡æ–°é“è·¯ï¼Œå°±æ˜¯ç­”æ¡ˆã€‚è‹¥æ ‘çš„ç›´å¾„ä¸º L ï¼Œç­”æ¡ˆå°±æ˜¯ 2(n - 1) - (L - 1) ã€‚</p><p>å½“ K = 2 æ—¶ï¼Œæˆ‘ä»¬è¦å†æ‰¾ä¸€æ¡æœ€é•¿é“¾ï¼ˆ$L_2$ï¼‰ã€‚ä½†è¿™æ—¶å¦‚æœä¸¤æ¡æ–°é“è·¯å½¢æˆçš„ç¯é‡å ï¼Œé‡å éƒ¨åˆ†å°±ä¸ä¼šè¢«å·¡é€»åˆ°ã€‚ä½†ç”±äºé¢˜ç›®è¯´æ¯æ¡é“è·¯å¿…é¡»è¢«å·¡é€»ï¼Œæ‰€ä»¥åœ¨æ°å½“çš„æ—¶åˆ»é‡å éƒ¨åˆ†ä¼šè¢«å·¡é€»ä¸¤éï¼Œå¯¹ç­”æ¡ˆæ²¡æœ‰è´¡çŒ®ã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å¾—åˆ°å¦‚ä¸‹ç®—æ³•ï¼š</p><ol><li>å†æœ€åˆçš„æ ‘ä¸Šæ±‚ç›´å¾„ï¼Œè®°ä¸º $L_1$ ï¼Œç„¶åæŠŠç›´å¾„ä¸Šçš„æ ‡è®°å–åï¼ˆä» 1 æ”¹ä¸º -1ï¼‰ï¼›</li><li>å†æœ€é•¿é“¾æ ‡è®°å–åçš„æ ‘ä¸Šå†æ¬¡æ±‚ç›´å¾„ï¼Œè®°ä¸º $L_2$ ã€‚</li></ol><p>ç­”æ¡ˆå°±æ˜¯ $2(n - 1) - (L_1 - 1) - (L_2 - 1)$ ã€‚</p><p>ä¸ºä»€ä¹ˆå–åèƒ½æ­£ç¡®å¤„ç†é‡å éƒ¨åˆ†å‘¢ï¼Ÿ</p><p>å› ä¸ºå¦‚æœ $L_2$ åŒ…å« $L_1$ å–åçš„éƒ¨åˆ†ï¼Œå°±ç›¸å½“äºä¸¤ä¸ªç¯é‡å ï¼Œæœ€åˆé‡å çš„éƒ¨åˆ†éœ€è¦ç»è¿‡ä¸¤æ¬¡ï¼›å‡æ‰ $L_1 - 1$ åï¼Œé‡å çš„éƒ¨åˆ†å˜æˆäº†åªéœ€ç»è¿‡ä¸€æ¬¡ï¼›å‡æ‰ $L_2 - 1$ åï¼Œè´Ÿè´Ÿå¾—æ­£ï¼Œç›¸å½“äºæŠŠé‡å çš„éƒ¨åˆ†åŠ å›æ¥ï¼Œå˜å›äº†â€œéœ€è¦ç»è¿‡ä¸¤æ¬¡â€ã€‚</p><p>$O(n)$</p><p>è¿™é¢˜ä¸»è¦æ˜¯æ³¨æ„ dfs å–æ ‘ç›´å¾„éƒ¨åˆ†çš„ä»£ç ï¼Œè¿˜æœ‰è®°å½•ç›´å¾„çš„æ–¹æ³•ï¼Œæ€ç»´ä¸Šæ³¨æ„å–åæŠµæ¶ˆçš„æ–¹æ³•ã€‚</p><p>CODEï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100005</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, K, tot, cnt = <span class="number">1</span>, dia, mx;</span><br><span class="line"><span class="keyword">int</span> lnk[N];</span><br><span class="line"><span class="keyword">int</span> s1[N], s2[N];  <span class="comment">// å­˜ç¬¬ä¸€æ¬¡æ ‘ç›´å¾„çš„è·¯å¾„</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> to, next, v;</span><br><span class="line">&#125;e[<span class="number">2</span> * N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    e[++cnt].to = v, e[cnt].next = lnk[u], lnk[u] = cnt, e[cnt].v = <span class="number">1</span>;</span><br><span class="line">    e[++cnt].to = u, e[cnt].next = lnk[v], lnk[v] = cnt, e[cnt].v = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mx1 = <span class="number">0</span>, mx2 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = lnk[x]; i; i = e[i].next)</span><br><span class="line">        <span class="keyword">if</span> (e[i].to != fa) &#123;</span><br><span class="line">            <span class="keyword">int</span> v = e[i].v + dfs(e[i].to, x);</span><br><span class="line">            <span class="keyword">if</span> (v &gt; mx1) mx2 = mx1, mx1 = v, s2[x] = s1[x], s1[x] = i;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (v &gt; mx2) mx2 = v, s2[x] = i;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (mx1 + mx2 &gt; dia) dia = mx1 + mx2, mx = x;</span><br><span class="line">    <span class="keyword">return</span> mx1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; K;</span><br><span class="line">    tot = <span class="number">2</span> * (n - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> u, v;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; u &gt;&gt; v;</span><br><span class="line">        add(u, v);</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    tot = tot - dia + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (K == <span class="number">2</span>) &#123;</span><br><span class="line">        dia = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = s1[mx]; i; i = s1[e[i].to]) e[i].v = e[i ^ <span class="number">1</span>].v = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = s2[mx]; i; i = s1[e[i].to]) e[i].v = e[i ^ <span class="number">1</span>].v = <span class="number">-1</span>;</span><br><span class="line">        dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        tot = tot - dia + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; tot &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ ‘çš„ç›´å¾„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NOIP 2018 Training 2</title>
      <link href="2018/07/02/NOIP%202018%20Training%202/"/>
      <url>2018/07/02/NOIP%202018%20Training%202/</url>
      
        <content type="html"><![CDATA[<h3 id="A-ksum"><a href="#A-ksum" class="headerlink" title="A. ksum"></a>A. ksum</h3><hr><p>é¢˜æ„ï¼šæœ‰ä¸€ä¸ªå¤§å°ä¸º n çš„æ­£æ•´æ•°æ•°ç»„ï¼Œç®—å‡ºè¿™ä¸ªæ•°ç»„çš„æ‰€æœ‰å­—æ®µå’Œï¼Œå¹¶å°†è¿™ n(n + 1) / 2 ä¸ªæ•°é™åºæ’åˆ—ï¼Œè¾“å‡ºå‰ k ä¸ªæ•°ã€‚</p><p>ä¼˜å…ˆé˜Ÿåˆ—å­˜å‚¨å­æ®µå’Œï¼Œå› ä¸ºæ˜¯æ­£æ•´æ•°ï¼Œæ‰€ä»¥ç”¨ç¼©å‡çš„æ–¹æ³•ï¼Œæ¯æ¬¡å–é˜Ÿé¦–ï¼Œå‰ç¼€å’Œç®—å‡º (L + 1, R) å’Œ (L, R - 1)ï¼Œå†æ¬¡å…¥é˜Ÿã€‚</p><p>CODEï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100005</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line">ll n, k, tot, a[N];</span><br><span class="line">ll sum[N], ans[N];</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    ll l, r;</span><br><span class="line">    ll val;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node &amp; x) <span class="keyword">const</span> &#123;<span class="keyword">return</span> val &lt; x.val;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">map</span>&lt;ll, ll&gt; mp;</span><br><span class="line">priority_queue&lt;node&gt; pq;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_heap</span><span class="params">(node x)</span> </span>&#123;</span><br><span class="line">    ll num = <span class="number">1l</span>l * x.l + <span class="number">1l</span>l * x.r * <span class="number">1000000</span>;</span><br><span class="line">    <span class="keyword">if</span> (!mp.count(num)) &#123;</span><br><span class="line">        mp[num] = <span class="number">1</span>;</span><br><span class="line">        pq.push(x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(ll a, ll b)</span> </span>&#123;<span class="keyword">return</span> a &gt; b;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">in</span><span class="params">(ll x, ll y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">1</span> &lt;= x &amp;&amp; x &lt;= n &amp;&amp; <span class="number">1</span> &lt;= y &amp;&amp; y &lt;= n);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// freopen("ksum.in", "r", stdin);</span></span><br><span class="line">    <span class="comment">// freopen("ksum.out", "w", stdout);</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">memset</span>(ans, <span class="number">0</span>, <span class="keyword">sizeof</span>(ans));</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;k);</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</span><br><span class="line">        sum[i] = sum[i - <span class="number">1</span>] + a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    node x;</span><br><span class="line">    x.l = <span class="number">1</span>, x.r = n, x.val = sum[n];</span><br><span class="line">    push_heap(x);</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        node u = pq.top();</span><br><span class="line">        pq.pop();</span><br><span class="line">        ans[++tot] = u.val;</span><br><span class="line">        <span class="keyword">if</span> (tot == k) <span class="keyword">break</span>;</span><br><span class="line">        ll l = u.l, r = u.r;</span><br><span class="line">        node x, y;</span><br><span class="line">        x.l = l + <span class="number">1</span>, x.r = r, x.val = sum[x.r] - sum[x.l - <span class="number">1</span>];</span><br><span class="line">        y.l = l, y.r = r - <span class="number">1</span>, y.val = sum[y.r] - sum[y.l - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span> (l + <span class="number">1</span> &lt;= r &amp;&amp; in(l + <span class="number">1</span>, r)) push_heap(x);</span><br><span class="line">        <span class="keyword">if</span> (l &lt;= r - <span class="number">1</span> &amp;&amp; in(l, r - <span class="number">1</span>)) push_heap(y);</span><br><span class="line">    &#125;</span><br><span class="line">    sort(ans + <span class="number">1</span>, ans + tot + <span class="number">1</span>, cmp);</span><br><span class="line">    <span class="keyword">for</span> (ll i = <span class="number">1</span>; i &lt;= k; i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, ans[i]);</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-label"><a href="#B-label" class="headerlink" title="B. label"></a>B. label</h3><hr><p>é¢˜æ„ï¼šæœ‰ä¸€æ£µå¤§å°ä¸º n çš„æ ‘ï¼ŒèŠ‚ç‚¹ç¼–å·ä¸º 1 ï½ nï¼Œæˆ‘ä»¬ç»™æ ‘ä¸Šçš„æ¯ä¸€ä¸ªèŠ‚ç‚¹èµ‹ä¸€ä¸ª [1, m] ä¹‹é—´çš„æƒå€¼ï¼Œå¹¶ä½¿å¾—æœ‰è¾¹ç›´æ¥ç›¸è¿çš„ä¸¤ä¸ªèŠ‚ç‚¹çš„æƒå€¼ä¹‹å·®çš„ç»å¯¹å€¼ &gt;= Kã€‚æ±‚æœ‰å¤šå°‘ç§ä¸åŒçš„èµ‹å€¼æ–¹æ³•ï¼Œç­”æ¡ˆå¯¹ $10^9 + 7$ å–æ¨¡ã€‚</p><p>å…ˆè€ƒè™‘ç¬¬ä¸€æ¡£éƒ¨åˆ†åˆ†ï¼Œå¾ˆæ˜æ˜¾çš„æ ‘å½¢DPï¼Œ$F_{i, j}$ è¡¨ç¤ºç¬¬ i ä¸ªèŠ‚ç‚¹èµ‹å€¼ä¸º j çš„æ–¹æ¡ˆæ•°ã€‚å¯å¾—ï¼š</p><p>$$F_{i, j} = \prod (\sum F_{Son(i), k})$$</p><p>å…¶ä¸­ $|j - k| \geq K$</p><p>ç¬¬äºŒæ¡£ä¹Ÿå¾ˆå¥½åŠï¼Œå‰ç¼€å’Œä¼˜åŒ–ï¼Œæ¯æ¬¡å‡å» (j - K) ~ (j + K) çš„ä¸ç¬¦åˆåŒºé—´ã€‚</p><p>ç„¶è€Œ $m \leq 10^9$ å®åœ¨å¤ªå¤§äº†ã€‚<br>æˆ‘ä»¬å‘ç°ï¼Œå¯¹äºå¶èŠ‚ç‚¹ï¼Œ$F_{i, j}$ å‡ä¸º 1ï¼›å¯¹äºå¶èŠ‚ç‚¹çš„çˆ¶äº²èŠ‚ç‚¹ï¼ŒF çš„å€¼åœ¨ä¸‹æ ‡ä¸º [K, m - K] èŒƒå›´å†…ç›¸åŒï¼Œè€Œåœ¨ä¸¤è¾¹å¯¹ç§°ã€‚è¿›è€Œå‘ç°ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹çš„ F å€¼éƒ½æ˜¯è¿™æ ·åˆ†å¸ƒçš„ã€‚ä¸¤è¾¹å¯¹ç§°å€¼çš„ä¸ªæ•°ä¸å®ƒåˆ°è·ç¦»æœ€è¿œçš„åä»£å¶å­èŠ‚ç‚¹æœ‰å…³ã€‚å‡è®¾è¿™ä¸ªè·ç¦»æ˜¯ x ï¼Œé‚£ä¹ˆå¯¹ç§°å€¼çš„ä¸ªæ•°ä¸è¶…è¿‡ xKã€‚</p><p>äºæ˜¯æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªä¼˜åŒ–çš„æ–¹æ³•ï¼Œj çš„èŒƒå›´åªè¦å–åˆ° $min(m, (n - 1) * k)$</p><p>$O(n^2*k)$ </p><p>CODEï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mo = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">int</span> T, n, m, k, x, y, l, ans, f[<span class="number">105</span>][<span class="number">10005</span>], u[<span class="number">105</span>];</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nxt[<span class="number">105</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">quick_pow</span><span class="params">(<span class="keyword">int</span> b, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; p; p &gt;&gt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (p &amp; <span class="number">1</span>) res = res * b % mo;</span><br><span class="line">        b = b * b % mo;</span><br><span class="line">    &#125; <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;  <span class="comment">// è®¡ç®—f[x][y],f[x][y + 1]...f[x][m]</span></span><br><span class="line">    <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = y; i &lt;= l; i++) sum = (sum + f[x][i]) % mo;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = m; i &gt;= m - l + <span class="number">1</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &lt;= l || i &lt; y) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            sum = (sum + f[x][m - i + <span class="number">1</span>]) % mo;  <span class="comment">// å¯¹ç§°è®¡ç®—</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> L = max(y, l + <span class="number">1</span>), R = m - l;</span><br><span class="line">    <span class="keyword">if</span> (R &gt;= L) sum = (sum + <span class="number">1l</span>l * (R - L + <span class="number">1</span>) * f[x][l]) % mo;  <span class="comment">// ä¸­é—´éƒ¨åˆ†</span></span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= l; i++) f[x][i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="keyword">int</span>)nxt[x].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nxt[x][i] == fa) <span class="keyword">continue</span>;</span><br><span class="line">        dfs(nxt[x][i], x);</span><br><span class="line">        y = calc(nxt[x][i], k + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= l; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (j &gt; k) y += f[nxt[x][i]][j - k], y %= mo;</span><br><span class="line">            f[x][j] = <span class="number">1l</span>l * f[x][j] * y % mo;</span><br><span class="line">            <span class="keyword">if</span> (j + k &lt;= m) &#123;</span><br><span class="line">                <span class="keyword">if</span> (j + k &lt;= l) y -= f[nxt[x][i]][j + k];</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (j + k &gt; m - l) y -= f[nxt[x][i]][m - j - k + <span class="number">1</span>];</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    y -= f[nxt[x][i]][l];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// freopen("label.in", "r", stdin);</span></span><br><span class="line">    <span class="comment">// freopen("label.out", "w", stdout);</span></span><br><span class="line"></span><br><span class="line">    ios::sync_with_stdio(<span class="literal">false</span>);</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(nxt, <span class="number">0</span>, <span class="keyword">sizeof</span>(nxt));</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; k;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; x &gt;&gt; y;</span><br><span class="line">            nxt[x].push_back(y), nxt[y].push_back(x);</span><br><span class="line">        &#125;</span><br><span class="line">        l = min(m, (n - <span class="number">1</span>) * k);</span><br><span class="line">        <span class="keyword">if</span> (k &lt; <span class="number">0</span>) ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (!k) ans = quick_pow(m, n);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            dfs(<span class="number">1</span>, <span class="number">0</span>);  <span class="comment">//  å°†1ä½œä¸ºæ ¹</span></span><br><span class="line">            ans = calc(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-square"><a href="#C-square" class="headerlink" title="C. square"></a>C. square</h3><hr><p>é¢˜æ„ï¼šæœ‰ä¸€ä¸ªå¤§å°ä¸º $n * m$ çš„æ–¹æ ¼å›¾ï¼Œæœ‰çš„æ–¹æ ¼ä¸º 1ï¼Œæœ‰çš„æ–¹æ ¼ä¸º 0ã€‚Tæ¬¡è¯¢é—®ä¸€ä¸ªåŒºé—´ï¼ŒåŒºé—´å·¦ä¸Šè§’(x1, y1) ï¼Œå³ä¸‹è§’(x2, y2) ã€‚æ±‚ç»™å‡ºåŒºé—´ä¸­æœ€å¤§çš„å…¨ä¸º 1 çš„æ­£æ–¹å½¢çš„è¾¹é•¿ã€‚</p><p>åˆ†æƒ…å†µè®¨è®ºï¼Œ1.æ­£æ–¹å½¢å››è¾¹ä¸é ç»™å®šåŒºé—´ 2.æ­£æ–¹å½¢ä¸¤è¾¹é ç»™å®šåŒºé—´ã€‚ç”¨DPï¼Œæˆ–è€…äºŒåˆ†åˆ¤å®šè¾¹é•¿ï¼Œå¥½åƒæ˜¯è¿™æ ·ã€‚ã€‚</p><p>æ²¡æœ‰å†™ï¼Œæœ‰æƒ³æ³•å†å›æ¥ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NOIP 2018 Training 1</title>
      <link href="2018/06/23/NOIP%202018%20Training%201/"/>
      <url>2018/06/23/NOIP%202018%20Training%201/</url>
      
        <content type="html"><![CDATA[<h3 id="A-Count-Good-Prefixes"><a href="#A-Count-Good-Prefixes" class="headerlink" title="A. Count Good Prefixes"></a>A. Count Good Prefixes</h3><p><a href="https://vjudge.net/problem/CodeChef-GOODPREF" target="_blank" rel="noopener">https://vjudge.net/problem/CodeChef-GOODPREF</a></p><p>ç»™å®šæ•´æ•° n å’Œå­—ç¬¦ä¸² sï¼Œå­—ç¬¦ä¸²ä»…åŒ…å«â€˜aâ€™å’Œâ€˜bâ€™ä¸¤ç§å­—ç¬¦ã€‚è€ƒè™‘å­—ç¬¦ä¸² t = s + s + Â· Â· Â· + sï¼Œå³å°† s é‡å¤ n éå¾—åˆ°çš„å­—ç¬¦ä¸²ã€‚<br>è¯·æ±‚å‡º t æœ‰å¤šå°‘éç©ºå‰ç¼€æ»¡è¶³å…¶ä¸­â€˜aâ€™çš„å‡ºç°æ¬¡æ•°ä¸¥æ ¼å¤šä½™â€˜bâ€™çš„å‡ºç°æ¬¡æ•°ã€‚$1 \leq n \leq 10^9$ ã€‚</p><p>å¯ä»¥è¯æ˜ä»£ç ä¸­çš„åšæ³•æ˜¯ä¸ä¼šè¶…æ—¶çš„ï¼šå¯ä»¥å‘ç°å­—ç¬¦ä¸²é•¿åº¦å¾ˆå°ï¼Œ$10^3$ ï¼Œå¦‚æœä¸€éä¸‹æ¥ a å­—ç¬¦æ•°å·²ç»å¤§äº b å­—ç¬¦æ•°äº†ï¼Œé‚£ä¹ˆé•¿åº¦éè¿‡å b å­—ç¬¦æ•°æ— è®ºåœ¨å­—ç¬¦çš„å“ªä¸€ä¸ªä½ç½®éƒ½ä¸èƒ½èµ¶ä¸Š a äº†ï¼Œè·³å‡ºå¾ªç¯ï¼›è‹¥ b å­—ç¬¦æ•°å¤§äº a å­—ç¬¦æ•°äº†ï¼Œä¸€æ ·æ“ä½œï¼›è‹¥ç›¸ç­‰ï¼Œé‚£ä¹ˆåªè¦å°†å­—ç¬¦æ‰€æœ‰ä½ç½®ä¸­ a å­—ç¬¦æ•°å¤§äº b å­—ç¬¦æ•°çš„æƒ…å†µæ•°ä¹˜ä¸Šå‰©ä¸‹çš„éæ•°å³å¯ï¼Œè·³å‡ºå¾ªç¯ã€‚</p><p>CODEï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1005</span>;</span><br><span class="line"><span class="keyword">char</span> s[N];</span><br><span class="line"><span class="keyword">int</span> n, freq;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">0</span>, b = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (freq--) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[i] == <span class="string">'a'</span>) a++;</span><br><span class="line">            <span class="keyword">else</span> b++;</span><br><span class="line">            <span class="keyword">if</span> (a &gt; b) ret++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (a == b) &#123;</span><br><span class="line">            ret *= freq + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (a - b &gt; n) &#123;</span><br><span class="line">            ret += <span class="number">1l</span>l * n * freq;  <span class="comment">// freq åœ¨ while å¾ªç¯ä¸­æ˜¯é€’å‡çš„ï¼</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (b - a &gt; n) <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ret);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%s%d"</span>, s + <span class="number">1</span>, &amp;freq);</span><br><span class="line">        n = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">        solve();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-Andryusha-and-Colored-Balloons"><a href="#B-Andryusha-and-Colored-Balloons" class="headerlink" title="B. Andryusha and Colored Balloons"></a>B. Andryusha and Colored Balloons</h3><p><a href="https://vjudge.net/problem/CodeForces-781A" target="_blank" rel="noopener">https://vjudge.net/problem/CodeForces-781A</a></p><p>å¤§æ¦‚å°±æ˜¯ç”¨å°½é‡å°‘çš„é¢œè‰²ç»™ä¸€æ£µæ ‘æŸ“è‰²ï¼Œç›¸é‚»ä¸‰ä¸ªèŠ‚ç‚¹é¢œè‰²ä¸èƒ½ç›¸åŒã€‚è®°å½•ä¸€ä¸‹çˆ¶èŠ‚ç‚¹å’Œç¥–çˆ¶èŠ‚ç‚¹çš„é¢œè‰²å°±å¥½äº†ã€‚</p><p>CODEï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mo = <span class="number">1e9</span> + <span class="number">7</span>, N = <span class="number">200005</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; nxt[N];</span><br><span class="line"><span class="keyword">int</span> color[N], n, ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> fa)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nxt[x].size(); i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nxt[x][i] != fa) &#123;</span><br><span class="line">            <span class="keyword">while</span> (cnt == color[x] || cnt == color[fa]) cnt++;</span><br><span class="line">            color[nxt[x][i]] = cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nxt[x].size(); i++)</span><br><span class="line">        <span class="keyword">if</span> (nxt[x][i] != fa) dfs(nxt[x][i], x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> u, v;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;u, &amp;v);</span><br><span class="line">        nxt[u].push_back(v);</span><br><span class="line">        nxt[v].push_back(u);</span><br><span class="line">    &#125;</span><br><span class="line">    color[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    dfs(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) ans = max(ans, color[i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, color[i]);</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-Median-Sum"><a href="#C-Median-Sum" class="headerlink" title="C. Median Sum"></a>C. Median Sum</h3><p><a href="https://vjudge.net/problem/AtCoder-3857" target="_blank" rel="noopener">https://vjudge.net/problem/AtCoder-3857</a></p><p>æœ‰ n ä¸ªæ•°ï¼Œé‚£ä¹ˆè€ƒè™‘æ¯ä¸€ä¸ªæ•°å–æˆ–ä¸å–ï¼Œå…±æœ‰ $2^n - 1$ ç§å’Œï¼Œæ±‚å…¶ä¸­çš„ä¸­å€¼ã€‚</p><p>ç”¨ bitset æ¥è¡¨ç¤ºæ¯ä¸€ä¸ªæ•°èƒ½å¦è¢«è¡¨ç¤ºæˆ n ä¸ªæ•°ä¸­ä»»æ„ä¸ªæ•°çš„å’Œçš„å½¢å¼ï¼Œèƒ½ï¼Œ1ï¼›ä¸èƒ½ï¼Œ0ã€‚<br>ä¾‹å¦‚ n = 2 ï¼Œä¸¤ä¸ªæ•°åˆ†åˆ«ä¸º 3 å’Œ 5ï¼Œé‚£ä¹ˆè¿™ä¸ª bitset ä¸­ç¬¬ 3 ä½å’Œç¬¬ 5 ä½ä¸º 1ï¼Œç¬¬ 8 ä½ä¹Ÿä¸º 1ï¼Œè€Œç¬¬ 8 ä½èµ‹å€¼æ–¹æ³•æ˜¯ 3 &lt;&lt; 5ã€‚</p><p>ä¸­ä½æ•°åœ¨ $\lceil \frac{\sum\limits_{i=1}^nA_i}{2} \rceil$ åé¢ä¸€ç‚¹ç‚¹çš„è¯æ˜ï¼š<a href="https://blog.csdn.net/zzzzone/article/details/79115522" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>CODEï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, x, tot, ans;</span><br><span class="line"><span class="built_in">bitset</span>&lt;4000005&gt; bit;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">    bit.<span class="built_in">set</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">        bit = bit | (bit &lt;&lt; x);</span><br><span class="line">        tot += x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (ans = (tot + <span class="number">1</span>) / <span class="number">2</span>; !bit[ans]; ans++);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="D-Salvage-Robots"><a href="#D-Salvage-Robots" class="headerlink" title="D. Salvage Robots"></a>D. Salvage Robots</h3><p><a href="https://vjudge.net/problem/AtCoder-2045" target="_blank" rel="noopener">https://vjudge.net/problem/AtCoder-2045</a></p><p>æœ‰ä¸€å¼  $h * w$ çš„åœ°å›¾ï¼Œä¸Šé¢æœ‰ $h * w$ ä¸ªæ ¼å­ï¼Œæ ¼å­é‡Œä¸º o çš„è¡¨ç¤ºæœ‰æœºå™¨äººï¼Œä¸º E çš„è¡¨ç¤ºæ˜¯å‡ºå£ã€‚æ¯æ¬¡ä½ å¯ä»¥å°†æ‰€æœ‰æœºå™¨äººå‘ä¸Šä¸‹å·¦å³ä»»æ„ä¸€ä¸ªæ–¹å‘ç§»åŠ¨ä¸€æ­¥ï¼ˆæ³¨æ„æ˜¯æ‰€æœ‰æœºå™¨äººï¼‰ï¼Œç¢°åˆ°å‡ºå£çš„æœºå™¨äººè·æ•‘ï¼Œç¢°åˆ°å¢™å£çš„æˆ–åœ¨å¢™å£å¤–é¢çš„æœºå™¨äººæ­»äº¡ã€‚æ±‚æœ€å¤šå¯ä»¥æ•‘å¤šå°‘ä¸ªæœºå™¨äººï¼Œæ— æ­¥æ•°é™åˆ¶ã€‚</p><p>å› ä¸ºè¿åŠ¨æ˜¯ç›¸äº’çš„ï¼Œæ‰€ä»¥ç§»åŠ¨æœºå™¨äººå°±ç›¸å½“äºç§»åŠ¨å¢™å£å’Œå‡ºå£ã€‚</p><p>file:///Users/imily/Desktop/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-06-23%20%E4%B8%8B%E5%8D%882.29.45.png</p><p>ç”±æ­¤å›¾å¾—ï¼š</p><p>file:///Users/imily/Desktop/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-06-23%20%E4%B8%8B%E5%8D%882.35.03.png</p><p>çº¢è‰²éƒ¨åˆ†è¡¨ç¤ºå·²ç»æ­»äº¡çš„åŒºåŸŸã€‚æœ€ç»ˆæˆ‘ä»¬ç”¨ $f_{a, b, c, d}$ è¡¨ç¤ºåæ ‡(a, b) åˆ°åæ ‡(c, d) å¾—çŸ©é˜µå·²ç»èµ°å®Œè·å¾—çš„æœºå™¨äººï¼Œæ¯æ¬¡è½¬ç§»æ—¶å‘ä¸Šä¸‹å·¦å³æŸä¸ªæ–¹å‘æ‰©å±•ä¸€è¡Œå³å¯ã€‚</p><p>CODEï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">105</span>;</span><br><span class="line"><span class="keyword">char</span> s[N][N];</span><br><span class="line"><span class="keyword">int</span> r[N][N], c[N][N];</span><br><span class="line"><span class="keyword">int</span> f[N * N &gt;&gt; <span class="number">2</span>][N * N &gt;&gt; <span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> h, w, X, Y;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">encode</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> M)</span> </span>&#123;<span class="keyword">return</span> r * M + l;&#125;  <span class="comment">// ç¼–ç </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">chkmax</span><span class="params">(<span class="keyword">int</span>&amp; x, <span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    x = max(x, v);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> lX, <span class="keyword">int</span> rX, <span class="keyword">int</span> lY, <span class="keyword">int</span> rY)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cX = encode(lX, rX, X), cY = encode(lY, rY, Y);</span><br><span class="line">    <span class="keyword">if</span> (f[cX][cY] &gt;= <span class="number">0</span>) <span class="keyword">return</span> f[cX][cY];</span><br><span class="line">    f[cX][cY] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (lX &lt; X - <span class="number">1</span>)</span><br><span class="line">        chkmax(f[cX][cY], dfs(lX + <span class="number">1</span>, rX, lY, rY) + (rX + <span class="number">1</span> &lt;= X - lX - <span class="number">1</span> ? max(<span class="number">0</span>, r[X - lX - <span class="number">1</span>][min(Y + rY, w - lY)] - r[X - lX - <span class="number">1</span>][max(Y - lY, rY + <span class="number">1</span>) - <span class="number">1</span>]) : <span class="number">0</span>));</span><br><span class="line">    <span class="keyword">if</span> (rX &lt; h - X)</span><br><span class="line">        chkmax(f[cX][cY], dfs(lX, rX + <span class="number">1</span>, lY, rY) + (X + rX + <span class="number">1</span> &lt;= h - lX ? max(<span class="number">0</span>, r[X + rX + <span class="number">1</span>][min(Y + rY, w - lY)] - r[X + rX + <span class="number">1</span>][max(Y - lY, rY + <span class="number">1</span>) - <span class="number">1</span>]) : <span class="number">0</span>));</span><br><span class="line">    <span class="keyword">if</span> (lY &lt; Y - <span class="number">1</span>)</span><br><span class="line">        chkmax(f[cX][cY], dfs(lX, rX, lY + <span class="number">1</span>, rY) + (rY + <span class="number">1</span> &lt;= Y - lY - <span class="number">1</span> ? max(<span class="number">0</span>, c[min(X + rX, h - lX)][Y - lY - <span class="number">1</span>] - c[max(X - lX, rX + <span class="number">1</span>) - <span class="number">1</span>][Y - lY - <span class="number">1</span>]) : <span class="number">0</span>));</span><br><span class="line">    <span class="keyword">if</span> (rY &lt; w - Y)</span><br><span class="line">        chkmax(f[cX][cY], dfs(lX, rX, lY, rY + <span class="number">1</span>) + (Y + rY + <span class="number">1</span> &lt;= w - lY ? max(<span class="number">0</span>, c[min(X + rX, h - lX)][Y + rY + <span class="number">1</span>] - c[max(X - lX, rX + <span class="number">1</span>) - <span class="number">1</span>][Y + rY + <span class="number">1</span>]) : <span class="number">0</span>));</span><br><span class="line">    <span class="keyword">return</span> f[cX][cY];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;h, &amp;w);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= h; i++) <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s[i] + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= h; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= w; j++)</span><br><span class="line">            <span class="keyword">if</span> (s[i][j] == <span class="string">'E'</span>) X = i, Y = j;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= h; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= w; j++) &#123;</span><br><span class="line">            r[i][j] = r[i][j - <span class="number">1</span>] + (s[i][j] == <span class="string">'o'</span>);</span><br><span class="line">            c[i][j] = c[i - <span class="number">1</span>][j] + (s[i][j] == <span class="string">'o'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">-1</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, dfs(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[CF-Gym-101775B]-Scapegoat</title>
      <link href="2018/06/17/%5BCF-Gym-101775B%5D-Scapegoat/"/>
      <url>2018/06/17/%5BCF-Gym-101775B%5D-Scapegoat/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vjudge.net/problem/Gym-101775B" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>é¢˜æ„ï¼šæœ‰ $N$ ä¸ªå¤§ç‚¹ï¼Œ$M$ ä¸ªå°ç‚¹ï¼Œæ¯ä¸ªå¤§ç‚¹å¯ä»¥è¿å¤šä¸ªå°ç‚¹ï¼Œä¸”è‡³å°‘å¾—è¿ä¸€ä¸ªå°ç‚¹ï¼Œæ¯ä¸ªå°ç‚¹å¿…é¡»è¢«ä¸€ä¸ªå¤§ç‚¹è¿ã€‚æ¯ä¸ªå¤§ç‚¹æœ‰ä¸€ä¸ªæƒå€¼ $c_i$ï¼Œè¢«è¿™ä¸ªå¤§ç‚¹è¿çš„å°ç‚¹çš„æƒå€¼ä¹‹å’Œå³ä¸ºå¤§ç‚¹æƒå€¼ã€‚éœ€è¦æ±‚å‡ºæ€ä¹ˆè¿ï¼Œåœ¨æ»¡è¶³é¢˜æ„çš„æƒ…å†µä¸‹å°ç‚¹æƒå€¼æ–¹å·®æœ€å°ï¼Ÿ<br>Hintï¼šæ–¹å·®å…¬å¼ï¼š</p><p>$$\sigma^2 = \frac{1}{n}\sum(x_i - \frac{1}{n}\sum x_j)^2$$</p><p>çœŸæ˜¯æƒ­æ„§ â—‘ï¹â— å½“æ—¶é¢˜æ„éƒ½æ²¡è¯»æ‡‚â€¦<br>å¯ä»¥å‘ç°ï¼Œå°ç‚¹è¿™ä¹ˆæ±‚ï¼š</p><p>$$\sigma^2 = \frac{1}{m}\sum(x_i - \frac{1}{m}\sum x_j)^2$$</p><p>å¯ä»¥å‘ç°ï¼Œå°ç‚¹çš„æ€»æƒå€¼ä¹‹å’Œå³ä¸ºå¤§ç‚¹æ€»æƒå€¼ä¹‹å’Œï¼Œæ˜¯ä¸€ä¸ªå·²çŸ¥çš„å¸¸æ•°ï¼Œæˆ‘ä»¬ç”¨ $S$ è¡¨ç¤ºã€‚<br>å®Œå…¨å¹³æ–¹å…¬å¼å¾—ï¼š</p><p>$$\sigma^2 = \frac{1}{m}\sum({x_i}^2 - \frac{2}{m}Sx_i + \frac{1}{m^2}S^2)$$</p><p>æ‹†å¼€æ¥åŒ–ç®€å¾—ï¼š</p><p>$$\frac{1}{m}\sum{x_i}^2 - \frac{S^2}{m^2}$$</p><p>ç”±äº $\frac{1}{m}$ ã€ $\frac{S^2}{m^2}$ å…¨æ˜¯å¸¸æ•°ï¼Œå¯ä»¥ç›´æ¥å¾—åˆ°ï¼Œæˆ‘ä»¬å°±ä¸å»è€ƒè™‘ï¼Œç°åœ¨è¦è§£å†³ $\sum{x_i}^2$ çš„é—®é¢˜ã€‚</p><p>å®åœ¨æ˜¯å¤ªéš¾è€ƒè™‘äº† â—‘ï¹â— é‚£æ¢ä¸€ä¸ªè§’åº¦å§</p><p>æˆ‘ä»¬å‘ç°ï¼Œä¸€ä¸ªå¤§ç‚¹è¿ç€å°ç‚¹ï¼Œæ¯ä¸ªå°ç‚¹è·å¾—çš„å¤§ç‚¹åˆ†å‡ºçš„æƒå€¼è‚¯å®šæ˜¯è¶Šå‡åŒ€è¶Šå¥½ï¼ˆå‡åˆ†å’¯ï¼‰ï¼Œè®¾å¤§ç‚¹æƒå€¼ä¸º $C$ ï¼Œå°ç‚¹ä¸ªæ•°ä¸º $M$ ï¼Œåˆ™ $x_i$ ä¸º $\frac{C}{M}$ ã€‚</p><p>$\sum{x_i}^2$ åˆ™ä¸º $M(\frac{C}{M})^2$ å³ä¸º $\frac{C^2}{M}$ ã€‚</p><p>$C^2$ æˆ‘ä»¬ä¹ŸçŸ¥é“äº†ï¼Œç°åœ¨æˆ‘ä»¬è€ƒè™‘çš„å±€éƒ¨é—®é¢˜å°±æ˜¯ä¸åŒå¤§ç‚¹çš„å°ç‚¹æ•°ã€‚å¯¹äºæ¯ä¸ªå¤§ç‚¹æ¥è¯´ï¼Œ$M$ è‚¯å®šæ˜¯è¶Šå¤§è¶Šå¥½å’¯ï¼Œä½†ä¸ºäº†è®©å¯¹ç­”æ¡ˆçš„å‡å°‘é‡æ›´å¤šï¼Œæˆ‘ä»¬è¦è€ƒè™‘çš„æ˜¯å“ªä¸€ä¸ªå¤§ç‚¹çš„ $M$ å˜å¤§å¯¹ç­”æ¡ˆçš„è´¡çŒ®è¶Šå¤šã€‚</p><p>ä»”ç»†è§‚å¯Ÿå‘ç°ï¼Œ$\frac{C^2}{1}$ å˜ä¸º $\frac{C^2}{2}$ çš„å‡å°‘é‡æ˜¯ $\frac{C^2}{2}$ ï¼Œ$\frac{C^2}{2}$ å˜ä¸º $\frac{C^2}{3}$ çš„å‡å°‘é‡æ˜¯ $\frac{C^2}{2} - \frac{C^2}{3}$ ï¼Œä¹Ÿå°±æ˜¯è¯´å‡å°‘é‡åœ¨é€’å‡ï¼Œè€Œæˆ‘ä»¬å´è¦é€‰å‡å°‘é‡å°†ä¼šæœ€å¤šçš„ä¸€ä¸ªï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆä¼˜çš„æ€§è´¨ã€‚</p><p>æœ€ç»ˆåšæ³•ï¼Œæ¯ä¸ªå¤§ç‚¹çš„ $M$ åˆå§‹æ˜¯ $1$ï¼Œå¾ªç¯ $m - n$ æ¬¡ï¼Œç”¨ä¼˜å…ˆé˜Ÿåˆ—ç»™å‡†å‡å°‘é‡é™åºæ’åˆ—ï¼Œæ¯æ¬¡å–é˜Ÿé¦–ï¼Œç»™å®ƒçš„ $M$ åŠ  $1$ã€‚</p><p>æœ€ååˆ«å¿˜äº†åŠ ä¸Šä¹‹å‰ä¸ºäº†æ–¹ä¾¿æ€è€ƒå‡å»çš„ä¸€å †å¸¸æ•°ã€‚</p><p>CODEï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">double</span>, <span class="keyword">int</span>&gt; pdi;</span><br><span class="line"><span class="keyword">int</span> T, n, m;</span><br><span class="line"><span class="keyword">double</span> a[N];</span><br><span class="line"></span><br><span class="line">priority_queue&lt;pair&lt;<span class="keyword">double</span>, <span class="keyword">int</span>&gt; &gt; pq;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> cas = <span class="number">1</span>; cas &lt;= T; cas++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">        <span class="keyword">double</span> ans = <span class="number">0</span>, S = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;a[i]);</span><br><span class="line">            S += a[i];</span><br><span class="line">            pq.push(make_pair(a[i] * a[i] / <span class="number">2</span>, <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n + <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">            pdi x = pq.top();</span><br><span class="line">            pq.pop();</span><br><span class="line">            <span class="keyword">double</span> square = x.first * (x.second * (x.second + <span class="number">1</span>));</span><br><span class="line">            x.second += <span class="number">1</span>;</span><br><span class="line">            x.first = (square / x.second) - (square / (x.second + <span class="number">1</span>));</span><br><span class="line">            pq.push(x);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (!pq.empty()) &#123;</span><br><span class="line">            pdi x = pq.top();</span><br><span class="line">            pq.pop();</span><br><span class="line">            ans += x.first * x.second * (x.second + <span class="number">1</span>) / x.second;</span><br><span class="line">        &#125;</span><br><span class="line">        ans /= m;</span><br><span class="line">        ans -= S * S / m / m;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %.12lf\n"</span>, cas, max(<span class="number">0.0</span>, ans));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ€»ç»“ï¼Œæœ¬é¢˜åœ¨äºå±•å¼€ï¼Œç„¶åçœç•¥æ˜“æ±‚çš„å¸¸æ•°ï¼Œè¿˜æœ‰ä¸€ä¸ªå‡å°‘é‡çš„è§„å¾‹ï¼Œä¹Ÿå°±æ˜¯é€æ¸å‡å°ï¼Œé€æ¸ä¸ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ã€‚æ­¤å¤–æœ€å¯å€Ÿé‰´çš„å°±æ˜¯æ€è€ƒç­–ç•¥â€”â€”å±€éƒ¨é—®é¢˜è§£æ³•æ¨å¹¿åˆ°æ•´ä½“ï¼Œæ¯”å¦‚è¿™é“é¢˜ä¸­å¾ˆéš¾è€ƒè™‘æ—¶æˆ‘ä»¬è·³å‡ºå»ï¼Œå…ˆå»å‘ç°å‡å°‘é‡è¿™ä¸ªæœ‰è¶£çš„æ€§è´¨ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ•°å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[CODEVS1172]-Hanksonçš„è¶£å‘³é¢˜</title>
      <link href="2018/06/16/%5BCODEVS1172%5D-Hankson%E7%9A%84%E8%B6%A3%E5%91%B3%E9%A2%98/"/>
      <url>2018/06/16/%5BCODEVS1172%5D-Hankson%E7%9A%84%E8%B6%A3%E5%91%B3%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p><a href="http://codevs.cn/problem/1172/" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>é¢˜æ„ï¼šæœ‰ n ä¸ªè¯¢é—®ï¼Œæ¯ä¸ªè¯¢é—®ä¸­æœ‰å››ä¸ªè‡ªç„¶æ•° a, b, c, d, ç„¶åæ±‚æœ‰å¤šå°‘ä¸ª x æ»¡è¶³ $gcd(a, x) = c$ ä¸” $lcm(b, x) = d$ ã€‚<br>$n \leq 2000$ , $1 \leq a, b, c, d \leq 2 * 10^9$ ã€‚</p><p>è§£æ³•ä¸€ï¼š</p><p>d çš„çº¦æ•°ä¸ªæ•°ä¸Šç•Œæ˜¯ $\sqrt{d}$ ï¼Œä½† 1 ~ d ä¸­æ¯ä¸ªæ•°çº¦æ•°ä¸ªæ•°å¤§æ¦‚åªæœ‰ $log d$ ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é¢„å¤„ç†å‡º 1ï½$\sqrt{2 * 10^5}$ çš„æ‰€æœ‰è´¨æ•°ï¼Œç„¶åç”¨æœç´¢ç®—æ³•ç»„æˆ d çš„æ‰€æœ‰çº¦æ•°ï¼Œå†åˆ¤æ–­æ˜¯å¦æ»¡è¶³é¢˜ç›®æ¡ä»¶ï¼Œå³å¯å¾—åˆ°100åˆ†ã€‚<br>â€”â€”lyd</p><p>è€Œæˆ‘å†™çš„æ˜¯è¿™ä¸ªï¼š</p><p>è§£æ³•äºŒï¼š</p><p>å› ä¸º x æ˜¯ d çš„çº¦æ•°ï¼Œæ‰€ä»¥ x çš„è´¨å› å­ p ä¸€å®šä¹Ÿæ˜¯ d çš„è´¨å› å­ã€‚æˆ‘ä»¬å¯ä»¥å¯¹ d çš„æ¯ä¸ªè´¨å› å­ p åˆ†åˆ«è®¡ç®— x å¯èƒ½åŒ…å«å¤šå°‘ä¸ª p ã€‚</p><p>è®¾ a, b, c, d, x åˆ†åˆ«åŒ…å« $m_a$ , $m_b$ , $m_c$ , $m_d$ , $m_x$ ä¸ªè´¨å› å­ p ï¼Œå…¶ä¸­ $m_x$ æ˜¯æœªçŸ¥é‡ã€‚</p><p>å¦‚æœ $m_a == m_c$ ä¸” $m_b == m_d$ ä¸” $m_c \leq m_d$ é‚£ä¹ˆ $m_x$ åªè¦æ»¡è¶³ $m_c \leq m_x \leq m_d$ å°±å¯ä»¥äº†ï¼Œæ–¹æ¡ˆæ•°ä¸º $m_d - m_c + 1$ï¼›<br>è‹¥ $m_c &gt; m_d$ é‚£æœ¬æ¬¡è¯¢é—®ç­”æ¡ˆæ— è§£ï¼Œä¸º0ã€‚</p><p>è‹¥ $m_a \neq m_c$ ä¸” $m_b \neq m_d$ ï¼Œé‚£ä¹ˆ $m_x$ å¿…é¡»ç­‰äº $m_c$ å’Œ $m_d$ ï¼Œè‹¥ $m_c \neq m_d$ åˆ™æ— è§£ã€‚</p><p>æˆ‘ä»¬æŠŠ $m_x$ çš„å–æ³•æ•°è®°ä¸º $cnt_p$ ï¼Œä¹Ÿå°±æ˜¯ x åŒ…å«è´¨å› å­ p çš„æ–¹æ¡ˆæœ‰ $cnt_p$ ç§ã€‚æ ¹æ®ä¹˜æ³•åŸç†ï¼Œæ»¡è¶³é¢˜æ„çš„ x æ•°é‡å³ä¸ºè¿ä¹˜ç§¯ï¼š</p><p>$$\prod_{p | d} cnt_p$$</p><p>åŒæ ·æˆ‘ä»¬é¢„å¤„ç†å‡º 1ï½$\sqrt{2 * 10^5}$ çš„æ‰€æœ‰è´¨æ•°ï¼Œå› ä¸º d è‡³å¤šåŒ…å« 10 ä¸ªè´¨å› å­ï¼Œæ‰€ä»¥è®¡ç®—é‡å¾ˆå°ï¼Œæ·±æœè§£å†³ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n\sqrt{d} / logd)$ ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">50005</span>;</span><br><span class="line">ll n, a0, a1, b0, b1, tot, ans;</span><br><span class="line"><span class="keyword">int</span> prime[N];</span><br><span class="line"><span class="keyword">bool</span> mark[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Euler_prime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!mark[i]) prime[++tot] = i;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= tot &amp;&amp; prime[j] * i &lt;= N; j++) &#123;</span><br><span class="line">            mark[prime[j] * i] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % prime[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m0, m1, m2, m3;</span><br><span class="line">    m0 = m1 = m2 = m3 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (a0 % x == <span class="number">0</span>) &#123;a0 /= x, m0++;&#125;</span><br><span class="line">    <span class="keyword">while</span> (a1 % x == <span class="number">0</span>) &#123;a1 /= x, m1++;&#125;</span><br><span class="line">    <span class="keyword">while</span> (b0 % x == <span class="number">0</span>) &#123;b0 /= x, m2++;&#125;</span><br><span class="line">    <span class="keyword">while</span> (b1 % x == <span class="number">0</span>) &#123;b1 /= x, m3++;&#125;</span><br><span class="line">    <span class="keyword">if</span> (m0 == m1 &amp;&amp; m2 == m3) &#123;</span><br><span class="line">        <span class="keyword">if</span> (m1 &lt;= m3) ans *= (m3 - m1 + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">else</span> ans = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (m0 != m1 &amp;&amp; m2 != m3 &amp;&amp; m1 != m3) ans = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Euler_prime();</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;n);</span><br><span class="line">    <span class="keyword">while</span> (n--) &#123;</span><br><span class="line">        ans = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld%lld"</span>, &amp;a0, &amp;a1, &amp;b0, &amp;b1);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= tot; i++) solve(prime[i]);</span><br><span class="line">        <span class="keyword">if</span> (b1 != <span class="number">1</span>) solve(b1);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æœ€å¤§å…¬çº¦æ•°ä¸æœ€å°å…¬å€æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æšä¸¾å­é›†çš„é£˜é€¸å†™æ³•</title>
      <link href="2018/05/28/%E6%9E%9A%E4%B8%BE%E5%AD%90%E9%9B%86%E7%9A%84%E9%A3%98%E9%80%B8%E5%86%99%E6%B3%95/"/>
      <url>2018/05/28/%E6%9E%9A%E4%B8%BE%E5%AD%90%E9%9B%86%E7%9A%84%E9%A3%98%E9%80%B8%E5%86%99%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>è¦äºŒè¿›åˆ¶æšä¸¾å­é›†å•¦ï¼ˆå‡†ç¡®åœ°è¯´æ˜¯å…ˆæšä¸¾é›†åˆ S å†æšä¸¾ S çš„å­é›† Tï¼‰ï¼Œå…¶ä¸­ S æœ€å¤šæœ‰ n ä¸ªå…ƒç´ ã€‚</p><p>å¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œæ¯ä¸ªç‰©ä½“æœ‰å–ï¼ˆ1ï¼‰å’Œä¸å–ï¼ˆ0ï¼‰ä¸¤ç§æƒ…å†µï¼Œé‚£ä¹ˆæ€»å…±æœ‰ $2^n$ ç§æƒ…å†µã€‚<br>è¦ä¸€æ¬¡æ¦‚æ‹¬æ‰€æœ‰ç‰©ä½“çš„é€‰æ‹©æƒ…å†µï¼ŒäºŒè¿›åˆ¶å°±æ˜¯å¾ˆå¥½çš„é€‰æ‹©ã€‚</p><p>CODEï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; n); ++i) &#123;  <span class="comment">// i æšä¸¾æ‰€æœ‰ç‰©ä½“çš„é€‰æ‹©æƒ…å†µ</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j; j = (j - <span class="number">1</span>) &amp; i) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>, i, j);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆç¬¬äºŒå±‚å¾ªç¯ä¸­æ˜¯ j = (j - 1) &amp; i å‘¢ï¼Ÿ<br>è¿™æ ·èµ·åˆ°äº†å°† j ä¸­æœ‰æ•ˆä½ï¼ˆä¸º1ï¼‰é€æ¸åˆ é™¤çš„æ•ˆæœã€‚<br>ä¾‹å¦‚ï¼Œå½“ i = 101000 æ—¶ï¼Œj åˆå§‹ä¸º 101000ï¼Œç¬¬ä¸€è½®å˜ä¸º 100111ï¼Œ&amp; i åå˜ä¸º 100000ï¼ŒæˆåŠŸå°†æœ€åä¸€ä¸ª1åˆ é™¤ã€‚</p><p>æ—¶é—´å¤æ‚åº¦è®¡ç®—å¾ˆç„å­¦ï¼Œå¯ä»¥å‘ç° S æœ‰ $\binom{n}{i}$ ç§é€‰æ³•ï¼Œi ä¸ªä¸­è¿˜æœ‰ $2^i$ ç§é€‰å–æƒ…å†µã€‚<br>æ‰€ä»¥å°±æ˜¯ï¼š</p><p>$$\sum_{i=0}^n{\binom{n}{i} * 2^i}$$</p><p>å†é€šè¿‡æŸç§ç„å­¦è¯æ˜å¯å¾—è¯¥å¼ = $3^n$ã€‚(20.02.07upd: å°±æ˜¯äºŒé¡¹å¼å®šç†å•¦ï¼ï¼ï¼å³ (1 + 2) ^ n) </p><p>åŒæ ·çš„ï¼Œè‹¥æšä¸¾ S çš„å­é›† Tï¼Œå†æšä¸¾ T çš„å­é›† T1ï¼Œæ—¶é—´å¤æ‚åº¦å°±æ˜¯ $4^n$ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒO($3^n$) è¡¨ç¤º &lt;= $3^n$ï¼Œè€Œ $3^n$ å°±æ˜¯ $3^n$ï¼Œæ˜¯ä¸€ä¸ªå‡†ç¡®å€¼ã€‚</p><p>é¡ºå¸¦çš„ï¼Œè‹¥è¦æšä¸¾é›†åˆ U ä¸­çš„å­é›† S å’Œ Tï¼Œå…¶ä¸­ S ä¸ T æ— é‡å¤å…ƒç´ ï¼Œåªéœ€æšä¸¾ Sï¼Œå†åœ¨ U ä¸­é™¤ S çš„å…ƒç´ ä¸­æšä¸¾ Tã€‚</p><p>è¿™æ˜¯ä¸€ç§å¾ˆå¥½çš„äºŒè¿›åˆ¶æ€æƒ³ï¼Œåˆ©ç”¨ä½è¿ç®—ï¼Œå·§å¦™åœ°å°†å†—ä½™é™åˆ°äº†æœ€ä½ï¼Œå› æ­¤æ˜¯æœ€ä¼˜çš„è¯¥ç±»ç®—æ³•ã€‚å°½ç®¡æœ€ä¼˜ï¼Œå› ä¸ºæ˜¯æŒ‡æ•°çº§ç®—æ³•ï¼Œn ä¹Ÿåªèƒ½æœ€å¤šå–åˆ°15å·¦å³ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æŠ€å·§ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CodeJam2018-R1c</title>
      <link href="2018/05/07/CodeJam2018-R1c/"/>
      <url>2018/05/07/CodeJam2018-R1c/</url>
      
        <content type="html"><![CDATA[<h3 id="A-A-Whole-New-Word"><a href="#A-A-Whole-New-Word" class="headerlink" title="A. A Whole New Word"></a>A. A Whole New Word</h3><hr><p><a href="https://codejam.withgoogle.com/2018/challenges/0000000000007765/dashboard" target="_blank" rel="noopener">https://codejam.withgoogle.com/2018/challenges/0000000000007765/dashboard</a></p><p>setè®°é¢˜ç›®ç»™å®šçš„å­—ç¬¦ä¸²å‡ºç°è¿‡ï¼Œç„¶ådfsæšä¸¾å­—ç¬¦ä¸²ï¼Œ26^Lï¼Œåœ¨æ‰¾åˆ°ç¬¬ä¸€ä¸ªåˆæ³•çš„å­—ç¬¦ä¸²åç«‹åˆ»è¿”å›ã€‚</p><p>CODEï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">set</span>&lt;<span class="built_in">string</span>&gt; h;</span><br><span class="line"><span class="keyword">int</span> c[<span class="number">26</span>][<span class="number">26</span>];</span><br><span class="line"><span class="built_in">string</span> ret;</span><br><span class="line"><span class="keyword">int</span> n, L;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (x &gt;= L) &#123;</span><br><span class="line">        <span class="keyword">if</span> (h.count(ret)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; ret &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; ++i) <span class="keyword">if</span> (c[x][i]) &#123;</span><br><span class="line">        ret[x] = <span class="string">'A'</span> + i;</span><br><span class="line">        <span class="keyword">if</span> (dfs(x + <span class="number">1</span>)) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> kase;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; L;</span><br><span class="line">    h.clear();</span><br><span class="line">    <span class="built_in">memset</span>(c, <span class="number">0</span>, <span class="keyword">sizeof</span>(c));</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="built_in">string</span> s;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; s;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; L; ++j) c[j][s[j] - <span class="string">'A'</span>] = <span class="number">1</span>;</span><br><span class="line">        h.insert(s);</span><br><span class="line">    &#125;</span><br><span class="line">    ret = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; L; ++j) ret += <span class="string">'0'</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"Case #"</span> &lt;&lt; ++kase &lt;&lt; <span class="string">": "</span>;</span><br><span class="line">    <span class="keyword">if</span> (!dfs(<span class="number">0</span>)) <span class="built_in">cout</span> &lt;&lt; <span class="string">"-"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</span><br><span class="line">    <span class="keyword">while</span> (T--) solve();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="B-Lollipop-Shop"><a href="#B-Lollipop-Shop" class="headerlink" title="B. Lollipop Shop"></a>B. Lollipop Shop</h3><hr><p><a href="https://codejam.withgoogle.com/2018/challenges/0000000000007765/dashboard" target="_blank" rel="noopener">https://codejam.withgoogle.com/2018/challenges/0000000000007765/dashboard</a></p><p>è¿™æ˜¯ä¸€é“äº¤äº’é¢˜ï¼Œç»™å‡ºæ¯ç§æ£’æ£’ç³–è¢«å–œæ¬¢çš„æ¦‚ç‡ï¼Œè¦æ±‚æœ€åç­”æ¡ˆæ˜¯æ­£è§£çš„90%ä»¥ä¸Šã€‚<br>ä¹ä¸€çœ‹å¾ˆä¸å¯åšã€‚ä¸çŸ¥é“å¤§å®¶å–œæ¬¢çš„ç³–ï¼Œæ€ä¹ˆåšå‘¢ï¼Ÿ<br>è´ªå¿ƒæ€æƒ³ï¼Œå°†æ¦‚ç‡æœ€å°çš„ç³–ç»™ä»–ã€‚/ä¸æ˜¯æ¦‚ç‡å¤§çš„ï¼šæ¦‚ç‡å¤§å°±æœ‰å¾ˆå¤šäººå–œæ¬¢äº†ï¼Œæ€ä¹ˆç»™å‘¢ï¼Ÿ<br>cnt[]è®°å½•æ¦‚ç‡ï¼Œè‹¥æ¦‚ç‡ç›¸åŒï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ<br>æ¦‚ç‡æ€§çš„ï¼Œå½“ç„¶å°‘ä¸äº†éšæœºå•¦ï¼/éšæœºå¤§æ³•å¥½<br>åœ¨è¿™ç§å„ä¸º50%çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éšä¸€ä¸ªæ•°ï¼Œé€šè¿‡å¥‡å¶æ€§æ¥å†³å®šåˆ†ç»™ä¸¤è€…ä¸­å“ªä¸€ä½ã€‚<br>æœ€å fflush(stdout) åˆ·æ–°è¾“å…¥ã€‚<br>è¿™ä¸ªç®—æ³•çš„æ¦‚ç‡æ€§ä½“ç°åœ¨â€œéšä¸€ä¸ªæ•°ï¼Œåˆ¤æ–­å¥‡å¶æ€§â€ä¸­ï¼Œå¦‚æœä¸æ˜¯äº¤äº’é¢˜ï¼Œå°±ä¸å­˜åœ¨æ¦‚ç‡çš„é—®é¢˜ï¼Œå°±æ˜¯æ­£ç¡®çš„ç®—æ³•ã€‚</p><p>CODEï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> cnt[<span class="number">205</span>], mk[<span class="number">205</span>], biu[<span class="number">205</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="built_in">memset</span>(mk, <span class="number">0</span>, <span class="keyword">sizeof</span>(mk));</span><br><span class="line">    <span class="built_in">memset</span>(cnt, <span class="number">0</span>, <span class="keyword">sizeof</span>(cnt));</span><br><span class="line">    cnt[<span class="number">0</span>] = <span class="number">233</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> K;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; K;</span><br><span class="line">        <span class="built_in">memset</span>(biu, <span class="number">0</span>, <span class="keyword">sizeof</span>(biu));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= K; ++j) &#123;</span><br><span class="line">            <span class="keyword">int</span> x;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line">            ++cnt[x + <span class="number">1</span>], biu[x + <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> p = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; ++j) <span class="keyword">if</span> (biu[j] &amp;&amp; !mk[j]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (cnt[j] &lt; cnt[p]) p = j;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (cnt[j] == cnt[p] &amp;&amp; (rand() &amp; <span class="number">1</span>)) p = j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!p) <span class="built_in">cout</span> &lt;&lt; <span class="number">-1</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in">cout</span> &lt;&lt; p - <span class="number">1</span> &lt;&lt; <span class="built_in">endl</span>, mk[p] = <span class="number">1</span>;</span><br><span class="line">        fflush(<span class="built_in">stdout</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">    srand(time(<span class="number">0</span>) * clock());</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) solve();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="C-Ant-Stack"><a href="#C-Ant-Stack" class="headerlink" title="C. Ant Stack"></a>C. Ant Stack</h3><hr><p><a href="https://codejam.withgoogle.com/2018/challenges/0000000000007765/dashboard/000000000003e0a8" target="_blank" rel="noopener">https://codejam.withgoogle.com/2018/challenges/0000000000007765/dashboard/000000000003e0a8</a></p><p>å¾ˆæ˜¾ç„¶å“‡ï¼Œæ˜¯LISçš„æ”¹ç¼–ï¼Œæœ´ç´ çš„LISï¼ŒTask1å¯ä»¥è¿‡ã€‚<br>Task2å‘¢ï¼Ÿ<br>ä¹‹å‰æˆ‘ä»¬æƒ³åˆ°çš„æ˜¯è¡¨ç¤ºé•¿åº¦ï¼Œä½†é‡é‡é‚£ä¸€ç»´å¤ªå¤§äº†ï¼Œæˆ‘ä»¬å°†é•¿åº¦ä¸é‡é‡æ¢ä¸€æ¢ã€‚<br>f[i][j] è¡¨ç¤ºï¼Œå‰ i ä¸ªä¸­ï¼Œ<br>å¯ä»¥å‘ç°ï¼Œa = 6b æ—¶ï¼Œa + b = 7b / 6ã€‚åˆå› ä¿è¯ wi &lt;= 10 ^ 9ï¼Œå¯ä»¥å‘ç° (7 / 6) ^ 150 &gt; 10 ^ 9ï¼Œå› æ­¤æœ€å¤š150äººã€‚é‚£ä¹ˆæˆ‘ä»¬1ï½150å¾ªç¯æšä¸¾é•¿åº¦ã€‚å‘ç°æ¯ä¸€æ¬¡å¾ªç¯ï¼ŒDPåªéœ€è¦ä¸Šä¸€æ¬¡DPçš„æ¶ˆæ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨æ»šåŠ¨æ•°ç»„ã€‚</p><p>CODEï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = (<span class="keyword">int</span>)(<span class="number">1e5</span>) + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> LL inf = (LL)(<span class="number">1e18</span>) + <span class="number">100</span>;</span><br><span class="line">LL f[<span class="number">2</span>][maxn], a[maxn];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> kase;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) <span class="built_in">cin</span> &gt;&gt; a[i];</span><br><span class="line">    <span class="keyword">int</span> now = <span class="number">0</span>, lst = <span class="number">0</span>, mx = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= n; ++j) f[<span class="number">0</span>][j] = f[<span class="number">1</span>][j] = inf;</span><br><span class="line">    f[now][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= <span class="number">150</span>; ++j) &#123;</span><br><span class="line">        now = lst ^ <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)  f[now][i] = inf;</span><br><span class="line">        LL ww = f[lst][<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (ww &lt;= a[i] * <span class="number">6</span>) f[now][i] = ww + a[i];</span><br><span class="line">            ww = min(ww, f[lst][i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; ++i)</span><br><span class="line">            <span class="keyword">if</span> (f[now][i] &lt; inf) mx = j;</span><br><span class="line">        lst = now;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"Case #"</span> &lt;&lt; ++kase &lt;&lt; <span class="string">": "</span> &lt;&lt; mx &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::sync_with_stdio(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; T;</span><br><span class="line">    <span class="keyword">while</span> (T--) solve();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¯”èµ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>[CF-Gym-100340A]-Cookies</title>
      <link href="2018/05/01/%5BCF-Gym-100340A%5D-Cookies/"/>
      <url>2018/05/01/%5BCF-Gym-100340A%5D-Cookies/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vjudge.net/problem/Gym-100340A" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>é¢˜æ„ï¼šåœ£è¯è€äººè¦å°† $m$ ä¸ªé¥¼å¹²å…¨éƒ¨åˆ†ç»™ $n$ ä¸ªå­©å­ï¼Œæ¯ä¸ªå­©å­æœ‰ä¸€ä¸ªè´ªå©ªåº¦ï¼Œç¬¬ $i$ ä¸ªå­©å­çš„è´ªå©ªåº¦ä¸º $g[i]$ã€‚å¦‚æœæœ‰ $a[i]$ ä¸ªå­©å­æ‹¿åˆ°çš„é¥¼å¹²æ ‘æ¯”ç¬¬ $i$ ä¸ªå­©å­å¤šï¼Œé‚£ä¹ˆç¬¬ $i$ ä¸ªå­©å­ä¼šäº§ç”Ÿ $a[i]g[i]$ çš„æ€¨æ°”ã€‚$1 \leq n \leq 30$, $n \leq m \leq 5000$.</p><p>å¦‚æœè¦è®¡ç®—ç¬¬ $i$ ä¸ªå­©å­çš„æ€¨æ°”å€¼ï¼Œå°±å¿…é¡»è¦çŸ¥é“ $a[i]$ã€‚ä¸€ä¸ªå­©å­çš„æ€¨æ°”å¤§å°ä¸å…¶ä»–å­©å­è·å¾—çš„é¥¼å¹²æ•°æœ‰å…³ã€‚</p><p>ä»”ç»†æ€è€ƒå¯ä»¥å‘ç°ï¼Œè´ªå©ªåº¦å¤§çš„å­©å­åº”è¯¥è·å¾—æ›´å¤šçš„é¥¼å¹²ã€‚æ­£å¦‚ã€Œå›½ç‹æ¸¸æˆã€ä¸ã€Œçš‡åæ¸¸æˆã€ä¸€èˆ¬ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨é‚»é¡¹äº¤æ¢çš„æ–¹å¼æ¥è¯æ˜ã€‚å› æ­¤ï¼Œå¯ä»¥å°†å­©å­æŒ‰è´ªå©ªåº¦é™åºæ’åˆ—ã€‚</p><p>è®¾ $f[i][j]$ ä¸ºå‰ $i$ ä¸ªå­©å­åˆ†é… $j$ å—é¥¼å¹²æ—¶ï¼Œæ€¨æ°”æ€»å’Œçš„æœ€å°å€¼ã€‚æœ‰ä¸¤ç§æƒ…å†µï¼š</p><ol><li>ç¬¬ $i + 1$ ä¸ªå­©å­è·å¾—çš„é¥¼å¹²æ•°æ¯”ç¬¬ $i$ ä¸ªå­©å­å°‘ï¼Œæ­¤æ—¶ $a[i + 1] = i$</li><li>ç¬¬ $i + 1$ ä¸ªå­©å­è·å¾—çš„é¥¼å¹²æ•°ä¸ç¬¬ $i$ ä¸ªå­©å­ç›¸åŒï¼Œæ­¤æ—¶è¿˜éœ€è¦çŸ¥é“ $i$ å‰é¢æœ‰å‡ ä¸ªå­©å­ä¸iè·å¾—çš„é¥¼å¹²æ•°ç›¸åŒï¼Œæ‰èƒ½ç®—å‡º $a[i + 1]$ã€‚</li></ol><p>æ—¢è¦çŸ¥é“ç¬¬ $i$ ä¸ªå­©å­è·å¾—çš„é¥¼å¹²æ•°ï¼Œåˆè¦çŸ¥é“ $i$ å‰é¢æœ‰å‡ ä¸ªå­©å­ä¸ $i$ è·å¾—çš„é¥¼å¹²æ•°ç›¸åŒï¼Œå¾ˆéš¾é«˜æ•ˆåœ°ç»´æŠ¤ dpã€‚</p><p>è§‚å¯Ÿ dpï¼Œå¯å‘ç°â€œæ¯ä¸ªå­©å­è‡³å°‘åˆ†åˆ°ä¸€å—é¥¼å¹²â€ã€‚</p><ol><li>è‹¥ç¬¬ $i$ ä¸ªå­©å­çš„é¥¼å¹²æ•°å¤§äº$1$ï¼Œ$f[i][j] = f[i][j - i]$ï¼ˆå³æ¯ä¸ªå­©å­å°‘æ‹¿ä¸€å—é¥¼å¹²ï¼‰ã€‚</li><li>è‹¥ç¬¬ $i$ ä¸ªå­©å­çš„é¥¼å¹²æ•°ç­‰äº$1$ï¼Œåˆ™æšä¸¾iå‰é¢æœ‰å¤šå°‘ä¸ªå­©å­ä¹Ÿè·å¾—äº†ä¸€å—é¥¼å¹²ã€‚</li></ol><p>çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹ï¼š</p><p>$$f[i][j]=min(f[i][j-i], min(f[k, j - (i - k)] + k * {\sum_{p = k + 1}^{i} g[p]}))$$</p><p>åˆå§‹ï¼š$f[0][0] = 0$ï¼Œ ç›®æ ‡ï¼š$f[n][m]$ã€‚</p><p>æ–¹æ¡ˆè½¬ç§»ï¼Œå°±åƒã€ŒI-countryã€ä¸€æ ·ï¼Œå¼€ä¸¤ä¸ªæ•°ç»„è®°å½•â€œè½¬ç§»æ¥æºâ€ï¼Œä¸€æ¬¡é€’å½’å›å»ï¼Œæ‰¾åˆ°æœ€ä¼˜è·¯å¾„ã€‚</p><p>CODE:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">35</span>, M = <span class="number">5005</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, pre[N], f[N][M], res[N];</span><br><span class="line"><span class="keyword">int</span> lstN[N][M], lstM[N][M];  <span class="comment">// è®°å½•æ–¹æ¡ˆ</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> sum, id;</span><br><span class="line">&#125;g[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(node a, node b)</span> </span>&#123;<span class="keyword">return</span> a.sum &gt; b.sum;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">record</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x || !y) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">int</span> L = lstN[x][y], R = lstM[x][y];</span><br><span class="line">    <span class="keyword">if</span> (x == L) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= x; i++) res[g[i].id]++;</span><br><span class="line">        record(L, R);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = L + <span class="number">1</span>; i &lt;= x; i++) res[g[i].id]++;</span><br><span class="line">        record(L, R);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    freopen(<span class="string">"cookies.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    freopen(<span class="string">"cookies.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;g[i].sum);</span><br><span class="line">        g[i].id = i;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(g + <span class="number">1</span>, g + n + <span class="number">1</span>, cmp);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) pre[i] = pre[i - <span class="number">1</span>] + g[i].sum;</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0x3f</span>, <span class="keyword">sizeof</span>(f));</span><br><span class="line">    f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt;= m; j++) &#123;</span><br><span class="line">            f[i][j] = min(f[i][j], f[i][j - i]);</span><br><span class="line">            lstN[i][j] = i, lstM[i][j] = j - i;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; i; k++) &#123;</span><br><span class="line">                <span class="keyword">int</span> sum = f[k][j - (i - k)] + k * (pre[i] - pre[k]);</span><br><span class="line">                <span class="keyword">if</span> (f[i][j] &gt; sum) &#123;</span><br><span class="line">                    f[i][j] = sum;</span><br><span class="line">                    lstN[i][j] = k, lstM[i][j] = (j - (i - k));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, f[n][m]);</span><br><span class="line">    record(n, m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) <span class="built_in">printf</span>(<span class="string">"%d "</span>, res[i]);</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœŸæ˜¯ä¸€é“å¥½é¢˜ã€‚åœ¨æ•°æ®æ— åºçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸çŸ¥é“æ€ä¹ˆDPï¼Œä½†å¯ä»¥é€šè¿‡é¢å¤–çš„ç®—æ³•ï¼ˆæœ¬é¢˜ä¸­æ˜¯é‚»é¡¹äº¤æ¢ï¼‰æ¥ç¡®å®šDPçŠ¶æ€çš„è®¡ç®—é¡ºåºï¼Œè¿˜å¯ä»¥åœ¨çŠ¶æ€ç©ºé—´ä¸­è¿ç”¨ç­‰æ•ˆæ‰‹æ³•æ¥å¯¹çŠ¶æ€è¿›è¡Œç¼©æ”¾ã€‚<br>æœ¬é¢˜ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨è´ªå¿ƒç­–ç•¥ï¼Œåˆ©ç”¨ç›¸å¯¹å¤§å°çš„ä¸å˜æ€§ï¼Œå°†ç¬¬i + 1ä¸ªå­©å­çš„é¥¼å¹²æ•°å…ˆç¼©æ”¾åˆ°1ï¼Œä½¿é—®é¢˜å¾—åˆ°ç®€åŒ–ï¼Œå®¹æ˜“ç»´æŠ¤ã€è½¬ç§»ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿æ€§DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>KMP-å­—ç¬¦ä¸²åŒ¹é…</title>
      <link href="2018/04/22/KMP-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8C%B9%E9%85%8D/"/>
      <url>2018/04/22/KMP-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8C%B9%E9%85%8D/</url>
      
        <content type="html"><![CDATA[<p>ä»Šå¤©æ¥å­¦KMPç®—æ³•å•¦ï¼<br>KMPæ˜¯ç”¨æ¥åšå­—ç¬¦ä¸²åŒ¹é…çš„ï¼Œæ¯”å¦‚ï¼Œç»™å®šSåºåˆ—ï¼šabababaï¼Œ Tåºåˆ—ï¼šbaï¼Œ<br>é—®Tåºåˆ—åœ¨Såºåˆ—é‡Œå‡ºç°çš„ä½ç½®ï¼Œå¦‚é¢˜åˆ™ä¸º3ã€5ã€7ã€‚</p><p>é‚£ä¹ˆï¼Œæœ‰ä¸€ç§æš´åŠ›ç®—æ³•ï¼Œæšä¸¾ç»“å°¾ï¼ŒO(nm)ï¼Œå½“ç„¶ä»…é™äºæš´åŠ›ã€‚ã€‚<br>KMPæ˜¯æ”¹è¿›ç‰ˆï¼Œç®€æ´å¥½æ‰“ï¼ŒO(n + m)!!<br>æœ´ç´ ç®—æ³•ä¸­æœ‰è®¸å¤šä¸å¿…è¦çš„æšä¸¾ï¼Œå¦‚æœå¤±é…äº†ï¼Œä¼šå›å½’åŸç‚¹ï¼Œä»ä¸‹ä¸€ä½å†æ¬¡å¼€å§‹ï¼›<br>è€ŒKMPå……åˆ†åˆ©ç”¨åŒ¹é…å¤±è´¥çš„ä¿¡æ¯ï¼Œå°½é‡å‡å°‘åŒ¹é…æ¬¡æ•°ã€‚</p><p>ç®—æ³•ä¸­æ¶‰åŠåˆ°ä¸€ä¸ªnextæ•°ç»„ï¼Œè¿™ä¹Ÿæ˜¯KMPä¸­æœ€é‡è¦çš„éƒ¨åˆ†ã€‚<br>next[i]è¡¨ç¤ºå‰iä½ä¸­ï¼Œå‰ç¼€ä¸åç¼€ç›¸åŒçš„æœ€é•¿éƒ¨åˆ†ï¼Œ<br>æ¯”å¦‚ï¼Œåºåˆ—abcabï¼Œnext[5] = 2(â€˜abâ€™), next[4] = 1(â€˜aâ€™)ã€‚<br>è¿™æ ·ï¼Œåˆ©ç”¨next[]ï¼Œä¸€ä¸ªåºåˆ—ä¸­åç¼€åŒ¹é…ä¸ä¸Šï¼Œå°±ç”¨å‰ç¼€å»åŒ¹é…ã€‚</p><p>CODEï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100005</span>;</span><br><span class="line"><span class="keyword">char</span> s[N], t[N];</span><br><span class="line"><span class="keyword">int</span> next[N];  <span class="comment">// å‰ç¼€ä¸åç¼€ç›¸åŒçš„æœ€å¤§é•¿åº¦</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s%s"</span>, s + <span class="number">1</span>, t + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> n = <span class="built_in">strlen</span>(s + <span class="number">1</span>), m = <span class="built_in">strlen</span>(t + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>, k = <span class="number">0</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">while</span> (k &amp;&amp; t[i] != t[k + <span class="number">1</span>]) k = next[k];  <span class="comment">// è·³å›å»ï¼Œå¾€å‰å›æº¯</span></span><br><span class="line">        <span class="keyword">if</span> (t[i] == t[k + <span class="number">1</span>]) k++;  <span class="comment">// ç›¸åŒçš„æƒ…å†µä¸‹</span></span><br><span class="line">        next[i] = k;</span><br><span class="line">    &#125;  <span class="comment">// å…ˆå¤„ç†next[]</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, k = <span class="number">0</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">while</span> (k &amp;&amp; s[i] != t[k + <span class="number">1</span>]) k = next[k];</span><br><span class="line">        <span class="keyword">if</span> (s[i] == t[k + <span class="number">1</span>]) k++;</span><br><span class="line">        <span class="keyword">if</span> (k == m) <span class="built_in">printf</span>(<span class="string">"%d "</span>, i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ„Ÿè§‰KMPå……åˆ†å°†æ—¶é—´ç”¨åœ¨åˆ€åˆƒä¸Šäº†ã€‚ã€‚å¥½å¦™çš„KMPã€‚ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> KMP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€å­¦ä¹ ç¬”è®°ã€‘æ¬§å‡ é‡Œå¾—ä¸æ‰©å±•æ¬§å‡ é‡Œå¾—</title>
      <link href="2018/02/03/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E4%B8%8E%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97/"/>
      <url>2018/02/03/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E4%B8%8E%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97/</url>
      
        <content type="html"><![CDATA[<h2 id="Gcd"><a href="#Gcd" class="headerlink" title="Gcd"></a>Gcd</h2><hr><p>æ¬§å‡ é‡Œå¾—ç®—æ³•åˆç§°è¾—è½¬ç›¸é™¤æ³•ï¼Œç”¨äºè®¡ç®—ä¸¤ä¸ªæ•´æ•°çš„æœ€å¤§å…¬çº¦æ•°.</p><p>å¼•ç†ï¼š<br>    æ±‚æ•´æ•° aã€b çš„æœ€å¤§å…¬çº¦æ•°ï¼Œè¡¨ç¤ºæˆ gcd(a,b)ï¼Œè®¾ r = a % bï¼Œåˆ™ gcd(a, b) = gcd(b, a % b).</p><p>è¯æ˜:<br>    a = kb + r, r = a % b.<br>    å‡è®¾ c æ˜¯ aã€b çš„å…¬çº¦æ•°ï¼Œåˆ™ c | a, c | b, r = a - kbï¼Œå› æ­¤ c | r.<br>    å› æ­¤ c ä¹Ÿæ˜¯ (b, a % b) çš„å…¬çº¦æ•°.<br>    c | b, c | r, a = kb + r.<br>    æ‰€ä»¥ c ä¹Ÿæ˜¯ (a, b) çš„å…¬çº¦æ•°.<br>    æ—¢ç„¶ (a, bï¼‰ä¸ (b, a % b) çš„å…¬çº¦æ•°ç›¸ç­‰ï¼Œå…¶æœ€å¤§å…¬çº¦æ•°ä¹Ÿå¿…ç„¶ç›¸ç­‰ï¼Œå¾—è¯.<br>    (gcd(a, 0) = a)</p><h2 id="exGcd"><a href="#exGcd" class="headerlink" title="exGcd"></a>exGcd</h2><hr><p>æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼Œä¸€èˆ¬ç”¨æ¥æ±‚è§£ä¸å®šæ–¹ç¨‹ã€çº¿æ€§åŒä½™æ–¹ç¨‹ã€æ¨¡çš„é€†å…ƒç­‰.</p><p>å¯ä»¥æ ¹æ®è£´èœ€å®šç†é‚£ä¸€è¯¾çš„è¯æ˜æ¥å­¦ä¸€å­¦ï¼Œè¿™é‡Œå°±ä¸å†å¤šè¯´ï¼Œä¸è¿‡ä»æœ‰å€¼å¾—ä¸€æçš„ï¼šä»¥ä¸‹ç¨‹åºæ±‚å‡º ax + by = gcd(a, b) çš„ä¸€ç»„ç‰¹è§£ x0, y0ï¼Œå¹¶è¿”å› aï¼Œb çš„æœ€å¤§å…¬çº¦æ•° dã€‚å¯¹äºæ›´ä¸ºä¸€èˆ¬çš„æ–¹ç¨‹ ax + by = cï¼Œå®ƒæœ‰è§£å½“ä¸”ä»…å½“ d | cã€‚æˆ‘ä»¬å¯ä»¥å…ˆæ±‚å‡º x0, y0ï¼Œç„¶åä»¤ x0, y0 åŒä¹˜ä»¥ c / dï¼Œå°±å¾—åˆ°äº† ax + by = c çš„ä¸€ç»„ç‰¹è§£ (c / d)x0, (c / d)y0ã€‚</p><p>äº‹å®ä¸Šï¼Œæ–¹ç¨‹ ax + by = c çš„é€šè§£å¯ä»¥è¡¨ç¤ºä¸ºï¼šx = (c / d)x0 + k(b / d), y = (c / d)y0 + k(a / d)ï¼Œå…¶ä¸­ k å–éæ•´æ•°é›†åˆã€‚</p><p>CODE:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exGcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>) &#123;x = <span class="number">1</span>, y = <span class="number">0</span>; <span class="keyword">return</span> a;&#125;</span><br><span class="line">    <span class="keyword">int</span> d = exGcd(b, a % b, x, y);</span><br><span class="line">    <span class="keyword">int</span> z = x;</span><br><span class="line">    x = y, y = z - y * (a / b);</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ¬§å‡ é‡Œå¾—ä¸æ‰©å±•æ¬§å‡ é‡Œå¾— </tag>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Bezout(è£´èœ€)å®šç†</title>
      <link href="2018/02/03/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E8%A3%B4%E8%9C%80%E5%AE%9A%E7%90%86/"/>
      <url>2018/02/03/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E8%A3%B4%E8%9C%80%E5%AE%9A%E7%90%86/</url>
      
        <content type="html"><![CDATA[<p>Bezout å®šç†ï¼šå¯¹äºä»»æ„æ•´æ•° aï¼Œbï¼Œå­˜åœ¨ä¸€å¯¹æ•´æ•° xï¼Œyï¼Œæ»¡è¶³ ax + by = gcd(a, b).</p><p>è¯æ˜ï¼šåœ¨æ¬§å‡ é‡Œå¾—ç®—æ³•çš„æœ€åä¸€æ­¥ï¼Œå³ b = 0 æ—¶ï¼Œæ˜¾ç„¶æœ‰ä¸€å¯¹æ•´æ•° x = 1, y = 0 ï¼Œä½¿å¾— $a * 1 + 0 * 0 = gcd(a, 0)$ ã€‚è‹¥ b &gt; 0, åˆ™ gcd(a, b) = gcd(b, a mod b)ã€‚å‡è®¾å­˜åœ¨ä¸€å¯¹æ•´æ•° xï¼Œyï¼Œæ»¡è¶³ $b * x + (a\ mod\ b) * y = gcd(b, a\ mod\ b)$ ï¼Œå› ä¸º $bx + (a\ mod\ b)y = bx + (a - b\lfloor{a / b}\rfloor)y = ay - b(x - \lfloor{a / b}\rfloor y)$ ï¼Œæ‰€ä»¥ä»¤ $x^{â€˜} = x$ ï¼Œ$y^{â€˜} = x - \lfloor{a / b}\rfloor y$ ï¼Œå°±å¾—åˆ°äº† $ax^{â€˜} + by^{â€˜} = gcd(a, b)$ ã€‚</p><p>è¯æ¯•ã€‚</p><p>Bezoutå®šç†æ˜¯æŒ‰ç…§æ¬§å‡ é‡Œå¾—ç®—æ³•çš„æ€è·¯è¯æ˜çš„ï¼Œä¸”ä¸Šè¿°è¯æ˜åŒæ—¶ç»™å‡ºäº†æ•´æ•° x å’Œ y çš„è®¡ç®—æ–¹æ³•ï¼Œå³æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ¬§å‡ é‡Œå¾—ä¸æ‰©å±•æ¬§å‡ é‡Œå¾— </tag>
            
            <tag> å­¦ä¹ ç¬”è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Eulerçº¿æ€§ç­›</title>
      <link href="2018/01/21/Euler%E7%BA%BF%E6%80%A7%E7%AD%9B/"/>
      <url>2018/01/21/Euler%E7%BA%BF%E6%80%A7%E7%AD%9B/</url>
      
        <content type="html"><![CDATA[<h3 id="æ¬§æ‹‰ç­›æ³•æ±‚è´¨æ•°"><a href="#æ¬§æ‹‰ç­›æ³•æ±‚è´¨æ•°" class="headerlink" title="æ¬§æ‹‰ç­›æ³•æ±‚è´¨æ•°"></a>æ¬§æ‹‰ç­›æ³•æ±‚è´¨æ•°</h3><hr><p>å½“æˆ‘ä»¬çŸ¥é“ä¸€ä¸ªæ•°ä¸ºè´¨æ•°æ—¶ï¼Œå®ƒçš„å€æ•°è‚¯å®šä¸æ˜¯è´¨æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä» 2 å¼€å§‹é€šè¿‡ä¹˜ç§¯ç­›æ‰æ‰€æœ‰çš„åˆæ•°.</p><p>æ¬§æ‹‰ç­›æ³•ä¿è¯æ‰€æœ‰åˆæ•°éƒ½æ˜¯è¢«å®ƒçš„æœ€å°è´¨å› å­ç­›æ‰çš„ï¼Œæ—¶é—´å¤æ‚åº¦ O(N).</p><p>ä»£ç ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> vis[N], prime[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">primes</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="keyword">sizeof</span>(vis));</span><br><span class="line">    m = <span class="number">0</span>;  <span class="comment">// è´¨æ•°æ•°é‡</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vis[i]) &#123;</span><br><span class="line">            prime[++m] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (prime[j] * i &gt; n) <span class="keyword">break</span>;</span><br><span class="line">            vis[i * prime[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (i % prime[j] == <span class="number">0</span>) <span class="keyword">break</span>;  <span class="comment">// ä¿è¯æ¯ä¸ªæ•°åªä¼šè¢«å®ƒçš„æœ€å°è´¨å› å­ç­›å»</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> æ•°å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello</title>
      <link href="2017/06/06/Hello/"/>
      <url>2017/06/06/Hello/</url>
      
        <content type="html"><![CDATA[<h2 id="Hello"><a href="#Hello" class="headerlink" title="Hello"></a>Hello</h2><p>æ•°å­¦å…¬å¼æµ‹è¯•</p><p>$$x ^ 2 + 2x + 1 = 0$$</p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
